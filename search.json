[{"title":"å¹¿å‘Šï¼ˆ7ï¼‰-å¹¿å‘Šå½’å› å’Œè¯„ä¼°æ–¹æ³•","url":"/2026/02/19/å¹¿å‘Š7-å¹¿å‘Šå½’å› å’Œè¯„ä¼°æ–¹æ³•/","content":"å¹¿å‘Šå½’å› ä¸è¯„ä¼°æ–¹æ³•ç»ˆæå®Œæ•´æ¸…å•ä¸€ã€å½’å› æ¨¡å‹ç±»ï¼ˆAttribution Modelsï¼‰ åºå· æœ¯è¯­ å®šä¹‰ æ¥æº&#x2F;åº”ç”¨ 1 Last Click æœ«æ¬¡ç‚¹å‡»å½’å›  é€šç”¨åŸºç¡€ 2 First Click é¦–æ¬¡ç‚¹å‡»å½’å›  é€šç”¨åŸºç¡€ 3 Linear çº¿æ€§å½’å›  é€šç”¨åŸºç¡€ 4 Time Decay æ—¶é—´è¡°å‡å½’å›  é€šç”¨åŸºç¡€ 5 Position-Based (U-Shaped) ä½ç½®&#x2F;Uå‹å½’å›  Google Ads 6 W-Shaped Wå‹å½’å›  HubSpot 7 Full Path å…¨è·¯å¾„å½’å›  HubSpot 8 Z-Shaped Zå‹å½’å›  å’¨è¯¢å®šåˆ¶ 9 J-Shaped Jå‹å½’å›  å’¨è¯¢å®šåˆ¶ 10 Custom Weighted è‡ªå®šä¹‰æƒé‡å½’å›  ä¼ä¸šè‡ªå»º 11 MTA (Multi-Touch Attribution) å¤šè§¦ç‚¹å½’å›  è¡Œä¸šæ ‡å‡† 12 Data-Driven Attribution æ•°æ®é©±åŠ¨å½’å›  Google&#x2F;Meta 13 Markov Chain Attribution é©¬å°”å¯å¤«é“¾å½’å›  å­¦æœ¯ç ”ç©¶ 14 Shapley Value Attribution æ²™æ™®åˆ©å€¼å½’å›  åšå¼ˆè®º 15 Removal Effect Attribution ç§»é™¤æ•ˆåº”å½’å›  å­¦æœ¯ç ”ç©¶ 16 LSTM Attribution æ·±åº¦å­¦ä¹ å½’å›  AIç ”ç©¶ 17 Transformer Attribution æ³¨æ„åŠ›æœºåˆ¶å½’å›  AIç ”ç©¶ 18 Survival Analysis Attribution ç”Ÿå­˜åˆ†æå½’å›  å­¦æœ¯ç ”ç©¶ 19 Bayesian Attribution è´å¶æ–¯å½’å›  ç»Ÿè®¡ç ”ç©¶ 20 Game Theory Attribution åšå¼ˆè®ºå½’å›  å­¦æœ¯ç ”ç©¶ 21 Attention-Weighted Attribution æ³¨æ„åŠ›åŠ æƒå½’å›  æ–°å…´æŠ€æœ¯ 22 Cross-Channel Attribution è·¨æ¸ é“å½’å›  è¡Œä¸šæ ‡å‡† 23 Cross-Device Attribution è·¨è®¾å¤‡å½’å›  è¡Œä¸šæ ‡å‡† 24 Probabilistic Attribution æ¦‚ç‡å½’å›  éšç§ä¿æŠ¤ 25 Deterministic Attribution ç¡®å®šæ€§å½’å›  ä¼ ç»Ÿæ–¹æ³• 26 Fingerprinting Attribution è®¾å¤‡æŒ‡çº¹å½’å›  æ›¿ä»£æ–¹æ¡ˆ 27 Cookieless Attribution æ— Cookieå½’å›  æ–°å…´è¶‹åŠ¿ 28 Server-Side Attribution æœåŠ¡å™¨ç«¯å½’å›  æŠ€æœ¯è¶‹åŠ¿ 29 Self-Attribution è‡ªå½’å›  åº”ç”¨å•†åº— 30 Exposure Attribution æ›å…‰å½’å›  å“ç‰Œå¹¿å‘Š 31 Click Attribution ç‚¹å‡»å½’å›  æ•ˆæœå¹¿å‘Š 32 View-Through Attribution æµè§ˆå½’å›  å±•ç¤ºå¹¿å‘Š 33 Engagement Attribution äº’åŠ¨å½’å›  ç¤¾äº¤å¹¿å‘Š 34 Video Completion Attribution è§†é¢‘å®Œæˆå½’å›  è§†é¢‘å¹¿å‘Š 35 Audio Attribution éŸ³é¢‘å½’å›  æ’­å®¢&#x2F;éŸ³ä¹ 36 CTV Attribution è”ç½‘ç”µè§†å½’å›  æ–°å…´æ¸ é“ 37 DOOH Attribution æ•°å­—æˆ·å¤–å½’å›  æˆ·å¤–å¹¿å‘Š 38 In-Store Attribution åº—å†…å½’å›  é›¶å”® 39 O2O Attribution çº¿ä¸Šåˆ°çº¿ä¸‹å½’å›  å…¨æ¸ é“ 40 Phygital Attribution ç‰©ç†æ•°å­—èåˆå½’å›  æ–°å…´æ¦‚å¿µ 41 Blockchain Attribution åŒºå—é“¾å½’å›  å®éªŒæ€§ 42 Web3 Attribution Web3å½’å›  å®éªŒæ€§ 43 NFT Campaign Attribution NFTæ´»åŠ¨å½’å›  å®éªŒæ€§ 44 Metaverse Attribution å…ƒå®‡å®™å½’å›  å®éªŒæ€§ 45 Voice Search Attribution è¯­éŸ³æœç´¢å½’å›  æ–°å…´æ¸ é“ äºŒã€æ•ˆæœè¯„ä¼°æŒ‡æ ‡ç±»ï¼ˆPerformance Metricsï¼‰ åºå· æœ¯è¯­ å®šä¹‰ åº”ç”¨åœºæ™¯ 46 Impression (Imp) æ›å…‰ åŸºç¡€æŒ‡æ ‡ 47 Click ç‚¹å‡» åŸºç¡€æŒ‡æ ‡ 48 CTR (Click-Through Rate) ç‚¹å‡»ç‡ åŸºç¡€æŒ‡æ ‡ 49 CPC (Cost Per Click) å•æ¬¡ç‚¹å‡»æˆæœ¬ åŸºç¡€æŒ‡æ ‡ 50 CPM (Cost Per Mille) åƒæ¬¡æ›å…‰æˆæœ¬ åŸºç¡€æŒ‡æ ‡ 51 CPV (Cost Per View) å•æ¬¡è§‚çœ‹æˆæœ¬ è§†é¢‘å¹¿å‘Š 52 CPA (Cost Per Action) å•æ¬¡è¡ŒåŠ¨æˆæœ¬ æ•ˆæœå¹¿å‘Š 53 CPL (Cost Per Lead) å•æ¡çº¿ç´¢æˆæœ¬ B2B 54 CPS (Cost Per Sale) å•æ¬¡é”€å”®æˆæœ¬ ç”µå•† 55 CPI (Cost Per Install) å•æ¬¡å®‰è£…æˆæœ¬ åº”ç”¨æ¨å¹¿ 56 CPE (Cost Per Engagement) å•æ¬¡äº’åŠ¨æˆæœ¬ ç¤¾äº¤å¹¿å‘Š 57 CPD (Cost Per Download) å•æ¬¡ä¸‹è½½æˆæœ¬ åº”ç”¨æ¨å¹¿ 58 CPR (Cost Per Registration) å•æ¬¡æ³¨å†Œæˆæœ¬ ç”¨æˆ·è·å– 59 CPSale (Cost Per Sale) å•æ¬¡é”€å”®æˆæœ¬ ç”µå•† 60 CPOrder (Cost Per Order) å•æ¬¡è®¢å•æˆæœ¬ ç”µå•† 61 ROAS (Return on Ad Spend) å¹¿å‘Šæ”¯å‡ºå›æŠ¥ç‡ æ ¸å¿ƒæŒ‡æ ‡ 62 ROI (Return on Investment) æŠ•èµ„å›æŠ¥ç‡ æ ¸å¿ƒæŒ‡æ ‡ 63 ACOS (Advertising Cost of Sales) å¹¿å‘Šé”€å”®æˆæœ¬æ¯” äºšé©¬é€Š 64 TACOS (Total ACOS) æ€»å¹¿å‘Šé”€å”®æˆæœ¬æ¯” äºšé©¬é€Š 65 LTV (Lifetime Value) ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ é•¿æœŸè¯„ä¼° 66 CAC (Customer Acquisition Cost) è·å®¢æˆæœ¬ æ ¸å¿ƒæŒ‡æ ‡ 67 LTV:CAC Ratio ç”Ÿå‘½å‘¨æœŸè·å®¢æˆæœ¬æ¯” å¥åº·åº¦ 68 Payback Period å›æœ¬å‘¨æœŸ è´¢åŠ¡è¯„ä¼° 69 Conversion Rate (CVR) è½¬åŒ–ç‡ æ ¸å¿ƒæŒ‡æ ‡ 70 Revenue Per User (RPU) æ¯ç”¨æˆ·æ”¶å…¥ æ”¶å…¥åˆ†æ 71 ARPU (Average Revenue Per User) å¹³å‡æ¯ç”¨æˆ·æ”¶å…¥ æ”¶å…¥åˆ†æ 72 ARPPU (Average Revenue Per Paying User) å¹³å‡æ¯ä»˜è´¹ç”¨æˆ·æ”¶å…¥ æ”¶å…¥åˆ†æ 73 AOV (Average Order Value) å¹³å‡è®¢å•ä»·å€¼ ç”µå•† 74 Cart Abandonment Rate è´­ç‰©è½¦æ”¾å¼ƒç‡ ç”µå•† 75 Bounce Rate è·³å‡ºç‡ ç½‘ç«™åˆ†æ 76 Exit Rate é€€å‡ºç‡ ç½‘ç«™åˆ†æ 77 Session Duration ä¼šè¯æ—¶é•¿ ç½‘ç«™åˆ†æ 78 Pages Per Session æ¯ä¼šè¯é¡µæ•° ç½‘ç«™åˆ†æ 79 Return Visitor Rate å›è®¿ç‡ å¿ è¯šåº¦ 80 Churn Rate æµå¤±ç‡ è®¢é˜…æœåŠ¡ 81 Retention Rate ç•™å­˜ç‡ ç”¨æˆ·è¿è¥ 82 D1&#x2F;D7&#x2F;D30 Retention 1&#x2F;7&#x2F;30æ—¥ç•™å­˜ç‡ åº”ç”¨è¿è¥ 83 Engagement Rate äº’åŠ¨ç‡ ç¤¾äº¤å¹¿å‘Š 84 Completion Rate å®Œæ’­ç‡ è§†é¢‘å¹¿å‘Š 85 Viewability Rate å¯è§æ›å…‰ç‡ å¹¿å‘Šè´¨é‡ 86 Quality Score è´¨é‡å¾—åˆ† Google Ads 87 Relevance Score ç›¸å…³åº¦å¾—åˆ† Meta Ads 88 Frequency é¢‘æ¬¡ é¢‘æ¬¡ç®¡ç† 89 Reach è§¦è¾¾äººæ•° è¦†ç›–èŒƒå›´ 90 Impression Share æ›å…‰ä»½é¢ ç«äº‰åˆ†æ 91 Share of Voice (SOV) å£°é‡ä»½é¢ å“ç‰Œåˆ†æ 92 Share of Search æœç´¢ä»½é¢ å“ç‰Œåˆ†æ 93 Brand Search Volume å“ç‰Œæœç´¢é‡ å“ç‰Œåˆ†æ 94 Direct Traffic ç›´æ¥æµé‡ ç½‘ç«™åˆ†æ 95 Organic Traffic è‡ªç„¶æµé‡ SEO 96 Paid Traffic ä»˜è´¹æµé‡ ä»˜è´¹å¹¿å‘Š 97 Referral Traffic å¼•èæµé‡ æ¸ é“åˆ†æ 98 Social Traffic ç¤¾äº¤æµé‡ ç¤¾äº¤åˆ†æ 99 Email Traffic é‚®ä»¶æµé‡ é‚®ä»¶è¥é”€ 100 Display Traffic å±•ç¤ºæµé‡ å±•ç¤ºå¹¿å‘Š 101 Video Traffic è§†é¢‘æµé‡ è§†é¢‘å¹¿å‘Š 102 Mobile Traffic ç§»åŠ¨æµé‡ è®¾å¤‡åˆ†æ 103 Desktop Traffic æ¡Œé¢æµé‡ è®¾å¤‡åˆ†æ 104 Tablet Traffic å¹³æ¿æµé‡ è®¾å¤‡åˆ†æ 105 CTV Traffic è”ç½‘ç”µè§†æµé‡ æ–°å…´æ¸ é“ 106 New User Rate æ–°ç”¨æˆ·ç‡ ç”¨æˆ·è·å– 107 Returning User Rate å›è®¿ç”¨æˆ·ç‡ ç”¨æˆ·ç•™å­˜ 108 Active User Rate æ´»è·ƒç”¨æˆ·ç‡ ç”¨æˆ·æ´»è·ƒ 109 DAU (Daily Active Users) æ—¥æ´»è·ƒç”¨æˆ· ç”¨æˆ·æ´»è·ƒ 110 MAU (Monthly Active Users) æœˆæ´»è·ƒç”¨æˆ· ç”¨æˆ·æ´»è·ƒ 111 WAU (Weekly Active Users) å‘¨æ´»è·ƒç”¨æˆ· ç”¨æˆ·æ´»è·ƒ 112 DAU&#x2F;MAU Ratio æ—¥æ´»æœˆæ´»æ¯” ç”¨æˆ·ç²˜æ€§ 113 Stickiness ç²˜æ€§æŒ‡æ ‡ ç”¨æˆ·ç²˜æ€§ 114 Viral Coefficient ç—…æ¯’ç³»æ•° ç—…æ¯’ä¼ æ’­ 115 K-Factor Kå› å­ ç—…æ¯’ä¼ æ’­ 116 Referral Rate æ¨èç‡ æ¨èè¥é”€ 117 NPS (Net Promoter Score) å‡€æ¨èå€¼ ç”¨æˆ·æ»¡æ„åº¦ 118 CSAT (Customer Satisfaction) å®¢æˆ·æ»¡æ„åº¦ ç”¨æˆ·æ»¡æ„åº¦ 119 CES (Customer Effort Score) å®¢æˆ·è´¹åŠ›ç¨‹åº¦ ç”¨æˆ·ä½“éªŒ 120 CLV (Customer Lifetime Value) å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ é•¿æœŸä»·å€¼ 121 MRR (Monthly Recurring Revenue) æœˆåº¦ç»å¸¸æ€§æ”¶å…¥ è®¢é˜…æœåŠ¡ 122 ARR (Annual Recurring Revenue) å¹´åº¦ç»å¸¸æ€§æ”¶å…¥ è®¢é˜…æœåŠ¡ 123 Churn Cost æµå¤±æˆæœ¬ è´¢åŠ¡åˆ†æ 124 Expansion Revenue æ‰©å¼ æ”¶å…¥ è®¢é˜…æœåŠ¡ 125 Contraction Revenue æ”¶ç¼©æ”¶å…¥ è®¢é˜…æœåŠ¡ 126 Net Revenue Retention å‡€æ”¶å…¥ç•™å­˜ç‡ è®¢é˜…æœåŠ¡ 127 Gross Revenue Retention æ€»æ”¶å…¥ç•™å­˜ç‡ è®¢é˜…æœåŠ¡ ä¸‰ã€è½¬åŒ–è¿½è¸ªç±»ï¼ˆConversion Trackingï¼‰ åºå· æœ¯è¯­ å®šä¹‰ åº”ç”¨åœºæ™¯ 128 Click-Through Conversion (CTC) ç‚¹å‡»åè½¬åŒ– åŸºç¡€è¿½è¸ª 129 View-Through Conversion (VTC) æ›å…‰åè½¬åŒ– å±•ç¤ºå¹¿å‘Š 130 Attribution Window å½’å› çª—å£ æ—¶é—´è®¾å®š 131 Conversion API (CAPI) è½¬åŒ–å›ä¼ API æœåŠ¡å™¨ç«¯ 132 Pixel Tracking Pixelè¿½è¸ª å®¢æˆ·ç«¯ 133 Offline Conversion ç¦»çº¿è½¬åŒ– çº¿ä¸‹åœºæ™¯ 134 Store Visit Attribution åˆ°åº—å½’å›  é›¶å”® 135 Call Tracking ç”µè¯è¿½è¸ª ç”µè¯é”€å”® 136 QR Code Attribution äºŒç»´ç å½’å›  çº¿ä¸‹æ‰«ç  137 Coupon Code Attribution ä¼˜æƒ ç å½’å›  ä¿ƒé”€è¿½è¸ª 138 UTM Parameter Tracking UTMå‚æ•°è¿½è¸ª URLæ ‡è®° 139 Deep Link Attribution æ·±åº¦é“¾æ¥å½’å›  Appè·³è½¬ 140 Universal Link Attribution é€šç”¨é“¾æ¥å½’å›  iOSæ·±åº¦é“¾æ¥ 141 App Install Attribution åº”ç”¨å®‰è£…å½’å›  åº”ç”¨æ¨å¹¿ 142 In-App Event Attribution åº”ç”¨å†…äº‹ä»¶å½’å›  Appå†…è¡Œä¸º 143 SKAN (StoreKit Ad Network) è‹¹æœå¹¿å‘Šå½’å› æ¡†æ¶ iOSéšç§ 144 SKAN 4.0&#x2F;5.0 è‹¹æœå½’å› æ–°ç‰ˆ iOSéšç§ 145 AdAttributionKit è‹¹æœå½’å› å·¥å…·åŒ… iOS 2025+ 146 AEM (Advanced Event Measurement) é«˜çº§äº‹ä»¶è¡¡é‡ Meta iOS 147 Enhanced Conversions å¢å¼ºè½¬åŒ– Google 148 Consent Mode åŒæ„æ¨¡å¼ Googleéšç§ 149 Server-Side Tagging æœåŠ¡å™¨ç«¯æ ‡è®° æ•°æ®æ”¶é›† 150 Google Ads Conversion Tracking Googleè½¬åŒ–è¿½è¸ª Google Ads 151 Meta Conversions API Metaè½¬åŒ–API Metaå¹¿å‘Š 152 TikTok Pixel TikTokåƒç´  TikTokå¹¿å‘Š 153 TikTok Events API TikTokäº‹ä»¶API TikTokæœåŠ¡å™¨ç«¯ 154 LinkedIn Insight Tag LinkedInæ´å¯Ÿæ ‡ç­¾ LinkedInå¹¿å‘Š 155 Pinterest Tag Pinterestæ ‡ç­¾ Pinterestå¹¿å‘Š 156 Snap Pixel Snapåƒç´  Snapchatå¹¿å‘Š 157 Twitter&#x2F;X Conversion API Twitterè½¬åŒ–API Xå¹³å° 158 Amazon Attribution äºšé©¬é€Šå½’å›  äºšé©¬é€Šç«™å¤– 159 Apple Search Ads Attribution è‹¹æœæœç´¢å¹¿å‘Šå½’å›  App Store 160 Microsoft Advertising UET å¾®è½¯å¹¿å‘ŠUET Microsoft Ads 161 AppsFlyer Attribution AppsFlyerå½’å›  MMPå¹³å° 162 Adjust Attribution Adjustå½’å›  MMPå¹³å° 163 Branch Attribution Branchå½’å›  æ·±åº¦é“¾æ¥ 164 Kochava Attribution Kochavaå½’å›  MMPå¹³å° 165 Singular Attribution Singularå½’å›  MMPå¹³å° 166 Airbridge Attribution Airbridgeå½’å›  MMPå¹³å° 167 Tenjin Attribution Tenjinå½’å›  æ¸¸æˆå½’å›  168 GameAnalytics Attribution æ¸¸æˆåˆ†æå½’å›  æ¸¸æˆè¡Œä¸š 169 Firebase Attribution Firebaseå½’å›  Googleç§»åŠ¨ 170 OneLink Attribution OneLinkå½’å›  Branch 171 Deferred Deep Linking å»¶è¿Ÿæ·±åº¦é“¾æ¥ Appå®‰è£…å 172 Re-engagement Attribution å†äº’åŠ¨å½’å›  è€ç”¨æˆ·æ¿€æ´» 173 Web-to-App Attribution ç½‘é¡µåˆ°Appå½’å›  è·¨å¹³å° 174 App-to-Web Attribution Appåˆ°ç½‘é¡µå½’å›  è·¨å¹³å° 175 Cross-Platform Attribution è·¨å¹³å°å½’å›  å…¨æ¸ é“ 176 Identity Graph Attribution èº«ä»½å›¾è°±å½’å›  èº«ä»½è§£æ 177 Device Graph Attribution è®¾å¤‡å›¾è°±å½’å›  è®¾å¤‡åŒ¹é… 178 Probabilistic Matching æ¦‚ç‡åŒ¹é… éšç§ä¿æŠ¤ 179 Deterministic Matching ç¡®å®šæ€§åŒ¹é… ç²¾ç¡®åŒ¹é… 180 Hashed Email Matching å“ˆå¸Œé‚®ç®±åŒ¹é… éšç§åŒ¹é… å››ã€å¢é‡ä¸å®éªŒç±»ï¼ˆIncrementality & Testingï¼‰ åºå· æœ¯è¯­ å®šä¹‰ åº”ç”¨åœºæ™¯ 181 Incrementality å¢é‡æ•ˆæœ æ ¸å¿ƒè¯„ä¼° 182 Ghost Ads å¹½çµå¹¿å‘Š å¢é‡æµ‹è¯• 183 Holdout Group Testing å¯¹ç…§ç»„æµ‹è¯• å®éªŒè®¾è®¡ 184 Geo Experiments åœ°ç†åŒºåŸŸå®éªŒ åŒºåŸŸæµ‹è¯• 185 Conversion Lift è½¬åŒ–æå‡æµ‹è¯• Meta&#x2F;Google 186 Search Lift æœç´¢æå‡ç ”ç©¶ å“ç‰Œæœç´¢ 187 Brand Lift Study å“ç‰Œæå‡ç ”ç©¶ å“ç‰Œè¯„ä¼° 188 A&#x2F;B Testing A&#x2F;Bæµ‹è¯• åŸºç¡€å®éªŒ 189 A&#x2F;B&#x2F;n Testing å¤šå˜é‡æµ‹è¯• å¤šç‰ˆæœ¬å¯¹æ¯” 190 Multivariate Testing å¤šå˜é‡æµ‹è¯• å› ç´ ç»„åˆ 191 Split Testing åˆ†æµæµ‹è¯• æµé‡åˆ†å‰² 192 Randomized Controlled Trial (RCT) éšæœºå¯¹ç…§è¯•éªŒ ç§‘å­¦å®éªŒ 193 Causal Impact Analysis å› æœå½±å“åˆ†æ å› æœæ¨æ–­ 194 Synthetic Control Method åˆæˆæ§åˆ¶æ³• è™šæ‹Ÿå¯¹ç…§ 195 Difference-in-Differences (DiD) åŒé‡å·®åˆ†æ³• å› æœæ¨æ–­ 196 Regression Discontinuity å›å½’æ–­ç‚¹è®¾è®¡ é˜ˆå€¼åˆ†æ 197 Instrumental Variables å·¥å…·å˜é‡æ³• å†…ç”Ÿæ€§å¤„ç† 198 Propensity Score Matching å€¾å‘å¾—åˆ†åŒ¹é… æ ·æœ¬åŒ¹é… 199 CUPED æ–¹å·®å‡å°‘æŠ€æœ¯ å®éªŒä¼˜åŒ– 200 Sequential Testing åºè´¯æµ‹è¯• æŒç»­ç›‘æµ‹ 201 Bayesian Testing è´å¶æ–¯æµ‹è¯• æ¦‚ç‡æ¨æ–­ 202 Multi-Armed Bandit å¤šè‡‚è€è™æœº åŠ¨æ€åˆ†é… 203 Thompson Sampling æ±¤æ™®æ£®é‡‡æ · åŠ¨æ€åˆ†é… 204 Epsilon-Greedy Îµ-è´ªå©ªç®—æ³• åŠ¨æ€åˆ†é… 205 Interference Testing å¹²æ‰°æµ‹è¯• ç½‘ç»œæ•ˆåº” 206 Cluster Randomization èšç±»éšæœºåŒ– ç¾¤ä½“å®éªŒ 207 Switchback Testing åˆ‡æ¢æµ‹è¯• æ—¶é—´åºåˆ— 208 Factorial Design å› å­è®¾è®¡ å¤šå› ç´ å®éªŒ 209 Latin Square Design æ‹‰ä¸æ–¹è®¾è®¡ å¹³è¡¡å®éªŒ 210 Crossover Design äº¤å‰è®¾è®¡ å‰åå¯¹æ¯” 211 Stepped Wedge Design é˜¶æ¢¯æ¥”å½¢è®¾è®¡ é€æ­¥æ¨å¹¿ 212 Interrupted Time Series ä¸­æ–­æ—¶é—´åºåˆ— æ”¿ç­–è¯„ä¼° 213 Natural Experiment è‡ªç„¶å®éªŒ å¤–ç”Ÿå†²å‡» 214 Quasi-Experiment å‡†å®éªŒ ééšæœºå®éªŒ 215 Shadow Bidding å½±å­å‡ºä»· å‡ºä»·æµ‹è¯• äº”ã€è¥é”€ç»„åˆå»ºæ¨¡ç±»ï¼ˆMMM & Modelingï¼‰ åºå· æœ¯è¯­ å®šä¹‰ åº”ç”¨åœºæ™¯ 216 MMM (Marketing Mix Modeling) è¥é”€ç»„åˆå»ºæ¨¡ å®è§‚è¯„ä¼° 217 Bayesian MMM è´å¶æ–¯MMM æ¦‚ç‡å»ºæ¨¡ 218 Time Series MMM æ—¶é—´åºåˆ—MMM æ—¶é—´åˆ†æ 219 Geo-MMM åœ°ç†MMM åŒºåŸŸå»ºæ¨¡ 220 Channel Contribution Model æ¸ é“è´¡çŒ®æ¨¡å‹ æ¸ é“åˆ†æ 221 Media Efficiency Model åª’ä½“æ•ˆç‡æ¨¡å‹ åª’ä½“è¯„ä¼° 222 Budget Optimization Model é¢„ç®—ä¼˜åŒ–æ¨¡å‹ é¢„ç®—åˆ†é… 223 Response Curve Modeling å“åº”æ›²çº¿å»ºæ¨¡ æŠ•å…¥äº§å‡º 224 Adstock Modeling å¹¿å‘Šè¡°å‡å»ºæ¨¡ æ•ˆæœå»¶è¿Ÿ 225 Saturation Curve Modeling é¥±å’Œæ›²çº¿å»ºæ¨¡ è¾¹é™…æ•ˆåº” 226 Halo Effect Modeling å…‰ç¯æ•ˆåº”å»ºæ¨¡ å“ç‰ŒååŒ 227 Cross-Media Modeling è·¨åª’ä½“å»ºæ¨¡ åª’ä½“ååŒ 228 Unified MMM+MTA ç»Ÿä¸€MMM+MTA å®å¾®ç»“åˆ 229 AI-Powered MMM AIé©±åŠ¨MMM æœºå™¨å­¦ä¹  230 LightweightMMM è½»é‡çº§MMM Googleå¼€æº 231 Robyn MMM Robynå»ºæ¨¡ Metaå¼€æº 232 Meridian MMM Meridianå»ºæ¨¡ Googleæ–°ä¸€ä»£ 233 Prophet MMM Prophetå»ºæ¨¡ Facebookå¼€æº 234 ARIMA Modeling ARIMAå»ºæ¨¡ æ—¶é—´åºåˆ— 235 VAR Modeling VARå»ºæ¨¡ å‘é‡è‡ªå›å½’ 236 State Space Modeling çŠ¶æ€ç©ºé—´å»ºæ¨¡ åŠ¨æ€ç³»ç»Ÿ 237 Kalman Filter å¡å°”æ›¼æ»¤æ³¢ çŠ¶æ€ä¼°è®¡ 238 Hierarchical Modeling å±‚æ¬¡å»ºæ¨¡ å¤šå±‚ç»“æ„ 239 Multilevel Modeling å¤šçº§å»ºæ¨¡ åµŒå¥—æ•°æ® 240 Panel Data Modeling é¢æ¿æ•°æ®å»ºæ¨¡ æ¨ªçºµæ•°æ® 241 Structural Equation Modeling ç»“æ„æ–¹ç¨‹å»ºæ¨¡ å› æœè·¯å¾„ 242 Path Analysis è·¯å¾„åˆ†æ å˜é‡å…³ç³» 243 Mediation Analysis ä¸­ä»‹åˆ†æ é—´æ¥æ•ˆåº” 244 Moderation Analysis è°ƒèŠ‚åˆ†æ äº¤äº’æ•ˆåº” 245 Elasticity Modeling å¼¹æ€§å»ºæ¨¡ ä»·æ ¼æ•æ„Ÿåº¦ 246 Price Optimization Modeling ä»·æ ¼ä¼˜åŒ–å»ºæ¨¡ å®šä»·ç­–ç•¥ 247 Promotion Modeling ä¿ƒé”€å»ºæ¨¡ ä¿ƒé”€æ•ˆæœ 248 Seasonality Modeling å­£èŠ‚æ€§å»ºæ¨¡ å­£èŠ‚å› ç´  249 Trend Modeling è¶‹åŠ¿å»ºæ¨¡ é•¿æœŸè¶‹åŠ¿ 250 Event Modeling äº‹ä»¶å»ºæ¨¡ ç‰¹æ®Šäº‹ä»¶ 251 Competitor Response Modeling ç«äº‰å“åº”å»ºæ¨¡ ç«äº‰åˆ†æ 252 Market Share Modeling å¸‚åœºä»½é¢å»ºæ¨¡ ç«äº‰æ ¼å±€ 253 Demand Forecasting éœ€æ±‚é¢„æµ‹ é”€é‡é¢„æµ‹ 254 Supply Chain Modeling ä¾›åº”é“¾å»ºæ¨¡ ä¾›åº”é“¾ä¼˜åŒ– 255 Customer Journey Modeling ç”¨æˆ·æ—…ç¨‹å»ºæ¨¡ è·¯å¾„åˆ†æ å…­ã€å“ç‰Œä¸è®¤çŸ¥è¯„ä¼°ç±»ï¼ˆBrand & Awarenessï¼‰ åºå· æœ¯è¯­ å®šä¹‰ åº”ç”¨åœºæ™¯ 256 Ad Recall Lift å¹¿å‘Šå›æƒ³æå‡ å“ç‰Œè®°å¿† 257 Awareness Lift è®¤çŸ¥åº¦æå‡ å“ç‰Œè®¤çŸ¥ 258 Consideration Lift è€ƒè™‘åº¦æå‡ è´­ä¹°è€ƒè™‘ 259 Purchase Intent Lift è´­ä¹°æ„å‘æå‡ è´­ä¹°æ„æ„¿ 260 Brand Favorability Lift å“ç‰Œå¥½æ„Ÿåº¦æå‡ å“ç‰Œæ€åº¦ 261 Share of Voice (SOV) å£°é‡ä»½é¢ å“ç‰Œå£°é‡ 262 Share of Search æœç´¢ä»½é¢ æœç´¢çƒ­åº¦ 263 Net Promoter Score (NPS) å‡€æ¨èå€¼ ç”¨æˆ·å¿ è¯š 264 Brand Equity å“ç‰Œèµ„äº§ å“ç‰Œä»·å€¼ 265 Brand Health Tracking å“ç‰Œå¥åº·è¿½è¸ª æŒç»­ç›‘æµ‹ 266 Sentiment Analysis æƒ…æ„Ÿåˆ†æ èˆ†æƒ…åˆ†æ 267 Social Listening ç¤¾äº¤è†å¬ ç¤¾äº¤ç›‘æµ‹ 268 Brand Mention Tracking å“ç‰ŒæåŠè¿½è¸ª å“ç‰Œæ›å…‰ 269 Earned Media Value å…è´¹åª’ä½“ä»·å€¼ è‡ªç„¶ä¼ æ’­ 270 PR Impact Measurement å…¬å…³å½±å“æµ‹é‡ å…¬å…³æ•ˆæœ 271 Message Resonance ä¿¡æ¯å…±é¸£åº¦ ä¿¡æ¯æ•ˆæœ 272 Brand Association å“ç‰Œè”æƒ³ å“ç‰Œè®¤çŸ¥ 273 Brand Personality å“ç‰Œä¸ªæ€§ å“ç‰Œå®šä½ 274 Brand Loyalty å“ç‰Œå¿ è¯šåº¦ ç”¨æˆ·å¿ è¯š 275 Brand Switching å“ç‰Œè½¬æ¢ ç«äº‰åˆ†æ 276 Top of Mind Awareness ç¬¬ä¸€æåŠè®¤çŸ¥ å“ç‰Œè®°å¿† 277 Unaided Awareness æ— æç¤ºè®¤çŸ¥ è‡ªç„¶è®¤çŸ¥ 278 Aided Awareness æœ‰æç¤ºè®¤çŸ¥ æç¤ºè®¤çŸ¥ 279 Brand Preference å“ç‰Œåå¥½ è´­ä¹°åå¥½ 280 Brand Trust å“ç‰Œä¿¡ä»» ä¿¡ä»»åº¦ 281 Brand Reputation å“ç‰Œå£°èª‰ å£°èª‰ç®¡ç† 282 Brand Crisis Monitoring å“ç‰Œå±æœºç›‘æµ‹ å±æœºç®¡ç† 283 Influencer Impact ç½‘çº¢å½±å“åŠ› KOLæ•ˆæœ 284 Word of Mouth Tracking å£ç¢‘è¿½è¸ª è‡ªç„¶ä¼ æ’­ 285 Dark Social Attribution æš—ç¤¾äº¤å½’å›  ç§åŸŸåˆ†äº« 286 Brand Community Engagement å“ç‰Œç¤¾åŒºäº’åŠ¨ ç¤¾åŒºè¿è¥ 287 Brand Advocacy å“ç‰Œå€¡å¯¼ ç”¨æˆ·å€¡å¯¼ 288 Customer Lifetime Brand Value å®¢æˆ·ç»ˆèº«å“ç‰Œä»·å€¼ é•¿æœŸä»·å€¼ 289 Brand Premium å“ç‰Œæº¢ä»· ä»·æ ¼æº¢ä»· 290 Brand Dilution å“ç‰Œç¨€é‡Š å“ç‰Œé£é™© ä¸ƒã€æ³¨æ„åŠ›ä¸è´¨é‡ç±»ï¼ˆAttention & Qualityï¼‰ åºå· æœ¯è¯­ å®šä¹‰ åº”ç”¨åœºæ™¯ 291 Viewability å¯è§æ›å…‰ç‡ å¹¿å‘Šè´¨é‡ 292 Active View ä¸»åŠ¨è§‚çœ‹ Googleæ ‡å‡† 293 Attention Time æ³¨æ„åŠ›æ—¶é•¿ æ³¨æ„åŠ›æŒ‡æ ‡ 294 Attention Score æ³¨æ„åŠ›å¾—åˆ† æ³¨æ„åŠ›æŒ‡æ ‡ 295 Dwell Time åœç•™æ—¶é—´ é¡µé¢è´¨é‡ 296 Scroll Depth æ»šåŠ¨æ·±åº¦ é¡µé¢å‚ä¸ 297 Video Completion Rate è§†é¢‘å®Œæ’­ç‡ è§†é¢‘è´¨é‡ 298 Quartile Completion å››åˆ†ä¹‹ä¸€å®Œæˆåº¦ è§†é¢‘è¿›åº¦ 299 Skip Rate è·³è¿‡ç‡ å¯è·³è¿‡å¹¿å‘Š 300 Mute Rate é™éŸ³ç‡ è§†é¢‘å£°éŸ³ 301 Interaction Rate äº’åŠ¨ç‡ å¯äº’åŠ¨å¹¿å‘Š 302 Hover Rate æ‚¬åœç‡ é¼ æ ‡äº¤äº’ 303 Eye Tracking Metrics çœ¼åŠ¨è¿½è¸ªæŒ‡æ ‡ æ³¨æ„åŠ›ç ”ç©¶ 304 Heatmap Analysis çƒ­åŠ›å›¾åˆ†æ ç”¨æˆ·è¡Œä¸º 305 In-View Time å¯è§†æ—¶é•¿ å¯è§æ—¶é—´ 306 Audible & Viewable å¯å¬å¯è§ è§†é¢‘æ ‡å‡† 307 MRC Standard MRCæ ‡å‡† è¡Œä¸šæ ‡å‡† 308 IAB Standard IABæ ‡å‡† è¡Œä¸šæ ‡å‡† 309 Ads.txt æˆæƒå–å®¶ å¹¿å‘Šé€æ˜ 310 App-ads.txt åº”ç”¨æˆæƒå–å®¶ åº”ç”¨å¹¿å‘Š 311 Sellers.json å–å®¶ä¿¡æ¯ å¹¿å‘Šé€æ˜ 312 Supply Chain Object ä¾›åº”é“¾å¯¹è±¡ å¹¿å‘Šé€æ˜ 313 Brand Safety Score å“ç‰Œå®‰å…¨è¯„åˆ† å“ç‰Œå®‰å…¨ 314 Content Suitability å†…å®¹é€‚å®œæ€§ å†…å®¹åŒ¹é… 315 Fraud Detection Rate æ¬ºè¯ˆæ£€æµ‹ç‡ åæ¬ºè¯ˆ 316 Invalid Traffic Rate æ— æ•ˆæµé‡ç‡ æµé‡è´¨é‡ 317 Bot Traffic Rate æœºå™¨äººæµé‡ç‡ åæœºå™¨äºº 318 Click Fraud Rate ç‚¹å‡»æ¬ºè¯ˆç‡ åæ¬ºè¯ˆ 319 Impression Fraud Rate æ›å…‰æ¬ºè¯ˆç‡ åæ¬ºè¯ˆ 320 Domain Quality Score åŸŸåè´¨é‡å¾—åˆ† ç½‘ç«™è´¨é‡ 321 Page Load Time é¡µé¢åŠ è½½æ—¶é—´ ç”¨æˆ·ä½“éªŒ 322 Core Web Vitals æ ¸å¿ƒç½‘é¡µæŒ‡æ ‡ ç”¨æˆ·ä½“éªŒ 323 Mobile Usability ç§»åŠ¨å¯ç”¨æ€§ ç§»åŠ¨ä½“éªŒ 324 Accessibility Score å¯è®¿é—®æ€§å¾—åˆ† æ— éšœç¢ 325 SEO Score SEOå¾—åˆ† æœç´¢ä¼˜åŒ– 326 Content Quality Score å†…å®¹è´¨é‡å¾—åˆ† å†…å®¹è¯„ä¼° 327 Creative Effectiveness åˆ›æ„æ•ˆæœ åˆ›æ„è¯„ä¼° 328 Ad Fatigue Rate å¹¿å‘Šç–²åŠ³ç‡ é¢‘æ¬¡ç®¡ç† 329 Creative Refresh Rate åˆ›æ„æ›´æ–°ç‡ åˆ›æ„ç®¡ç† 330 Ad Placement Quality å¹¿å‘Šä½è´¨é‡ ä½ç½®è¯„ä¼° å…«ã€éšç§ä¸åˆè§„ç±»ï¼ˆPrivacy & Complianceï¼‰ åºå· æœ¯è¯­ å®šä¹‰ åº”ç”¨åœºæ™¯ 331 GDPR Compliance GDPRåˆè§„ æ¬§ç›Ÿ 332 CCPA Compliance CCPAåˆè§„ åŠ å· 333 CPRA Compliance CPRAåˆè§„ åŠ å·æ–°ç‰ˆ 334 PIPL Compliance PIPLåˆè§„ ä¸­å›½ 335 LGPD Compliance LGPDåˆè§„ å·´è¥¿ 336 PIPEDA Compliance PIPEDAåˆè§„ åŠ æ‹¿å¤§ 337 APPI Compliance APPIåˆè§„ æ—¥æœ¬ 338 PDPA Compliance PDPAåˆè§„ æ–°åŠ å¡&#x2F;æ³°å›½ 339 Privacy-Safe Attribution éšç§å®‰å…¨å½’å›  éšç§ä¿æŠ¤ 340 Clean Room Attribution æ•°æ®æ´å‡€å®¤å½’å›  å®‰å…¨åŒ¹é… 341 Differential Privacy å·®åˆ†éšç§ éšç§ä¿æŠ¤ 342 Federated Learning è”é‚¦å­¦ä¹  åˆ†å¸ƒå¼è®­ç»ƒ 343 Aggregated Attribution èšåˆå½’å›  æ±‡æ€»æ•°æ® 344 Identity Resolution èº«ä»½è§£æ ç”¨æˆ·è¯†åˆ« 345 Unified ID 2.0 ç»Ÿä¸€ID 2.0 The Trade Desk 346 Retail Media Network ID é›¶å”®åª’ä½“ç½‘ç»œID é›¶å”®å•† 347 Contextual Targeting ä¸Šä¸‹æ–‡å®šå‘ å†…å®¹åŒ¹é… 348 Cohort Targeting ç¾¤ä½“å®šå‘ ç¾¤ä½“åˆ†æ 349 FLoC (Federated Learning of Cohorts) è”é‚¦å­¦ä¹ ç¾¤ä½“ Googleæ²™ç›’ 350 Topics API ä¸»é¢˜API Googleæ²™ç›’ 351 Protected Audience API ä¿æŠ¤å—ä¼—API Googleæ²™ç›’ 352 Attribution Reporting API å½’å› æŠ¥å‘ŠAPI Googleæ²™ç›’ 353 First-Party Data Strategy ç¬¬ä¸€æ–¹æ•°æ®ç­–ç•¥ æ•°æ®èµ„äº§ 354 Zero-Party Data é›¶æ–¹æ•°æ® ç”¨æˆ·ä¸»åŠ¨æä¾› 355 Consent Management åŒæ„ç®¡ç† åˆè§„ç®¡ç† 356 Cookie Consent CookieåŒæ„ ç½‘ç«™åˆè§„ 357 Do Not Track ä¸è¿½è¸ª ç”¨æˆ·é€‰æ‹© 358 Do Not Sell ä¸å‡ºå”® ç”¨æˆ·é€‰æ‹© 359 Data Minimization æ•°æ®æœ€å°åŒ– éšç§åŸåˆ™ 360 Purpose Limitation ç›®çš„é™åˆ¶ éšç§åŸåˆ™ 361 Storage Limitation å­˜å‚¨é™åˆ¶ éšç§åŸåˆ™ 362 Data Subject Rights æ•°æ®ä¸»ä½“æƒåˆ© ç”¨æˆ·æƒåˆ© 363 Right to Access è®¿é—®æƒ ç”¨æˆ·æƒåˆ© 364 Right to Erasure åˆ é™¤æƒ ç”¨æˆ·æƒåˆ© 365 Right to Portability å¯æºå¸¦æƒ ç”¨æˆ·æƒåˆ© 366 Right to Rectification æ›´æ­£æƒ ç”¨æˆ·æƒåˆ© 367 Data Processing Agreement æ•°æ®å¤„ç†åè®® æ³•å¾‹æ–‡ä»¶ 368 Privacy Impact Assessment éšç§å½±å“è¯„ä¼° é£é™©è¯„ä¼° 369 Data Protection Officer æ•°æ®ä¿æŠ¤å®˜ ç»„ç»‡è§’è‰² 370 Cross-Border Data Transfer è·¨å¢ƒæ•°æ®ä¼ è¾“ æ•°æ®æµåŠ¨ 371 Standard Contractual Clauses æ ‡å‡†åˆåŒæ¡æ¬¾ è·¨å¢ƒåˆè§„ 372 Binding Corporate Rules çº¦æŸæ€§ä¼ä¸šè§„åˆ™ è·¨å¢ƒåˆè§„ 373 Privacy Shield éšç§ç›¾ ç¾æ¬§ä¼ è¾“ 374 Data Localization æ•°æ®æœ¬åœ°åŒ– æ•°æ®å­˜å‚¨ 375 Anonymization åŒ¿ååŒ– éšç§ä¿æŠ¤ 376 Pseudonymization å‡ååŒ– éšç§ä¿æŠ¤ 377 Encryption åŠ å¯† æ•°æ®å®‰å…¨ 378 Tokenization ä»¤ç‰ŒåŒ– æ•°æ®å®‰å…¨ 379 Secure Multi-Party Computation å®‰å…¨å¤šæ–¹è®¡ç®— éšç§è®¡ç®— 380 Homomorphic Encryption åŒæ€åŠ å¯† éšç§è®¡ç®— ä¹ã€å¹³å°ä¸“æœ‰æŠ€æœ¯ç±»ï¼ˆPlatform-Specificï¼‰ åºå· æœ¯è¯­ å®šä¹‰ å¹³å° 381 Google Ads Attribution Googleå¹¿å‘Šå½’å›  Google 382 Google Analytics 4 GA4åˆ†æ Google 383 Google Marketing Platform Googleè¥é”€å¹³å° Google 384 DV360 Attribution DV360å½’å›  Google DSP 385 CM360 Attribution CM360å½’å›  Google CM 386 SA360 Attribution SA360å½’å›  Googleæœç´¢ 387 Meta Conversions API Metaè½¬åŒ–API Meta 388 Meta Pixel Metaåƒç´  Meta 389 Meta Advanced Matching Metaé«˜çº§åŒ¹é… Meta 390 Meta Aggregated Event Measurement Metaèšåˆäº‹ä»¶è¡¡é‡ Meta 391 Amazon Attribution äºšé©¬é€Šå½’å›  Amazon 392 Amazon Marketing Cloud äºšé©¬é€Šè¥é”€äº‘ Amazon 393 Amazon DSP Attribution äºšé©¬é€ŠDSPå½’å›  Amazon 394 Amazon Advertising Console äºšé©¬é€Šå¹¿å‘Šæ§åˆ¶å° Amazon 395 TikTok Pixel TikTokåƒç´  TikTok 396 TikTok Events API TikTokäº‹ä»¶API TikTok 397 TikTok Marketing API TikTokè¥é”€API TikTok 398 LinkedIn Insight Tag LinkedInæ´å¯Ÿæ ‡ç­¾ LinkedIn 399 LinkedIn Conversion API LinkedInè½¬åŒ–API LinkedIn 400 LinkedIn Marketing API LinkedInè¥é”€API LinkedIn 401 Pinterest Tag Pinterestæ ‡ç­¾ Pinterest 402 Pinterest Conversion API Pinterestè½¬åŒ–API Pinterest 403 Snap Pixel Snapåƒç´  Snapchat 404 Snap Conversion API Snapè½¬åŒ–API Snapchat 405 Twitter&#x2F;X Conversion API Twitterè½¬åŒ–API X 406 Twitter&#x2F;X Pixel Twitteråƒç´  X 407 Apple Search Ads Attribution è‹¹æœæœç´¢å¹¿å‘Šå½’å›  Apple 408 Apple AdAttributionKit è‹¹æœå½’å› å·¥å…·åŒ… Apple 409 Apple SKAdNetwork è‹¹æœå¹¿å‘Šç½‘ç»œ Apple 410 Apple Private Click Measurement è‹¹æœç§å¯†ç‚¹å‡»è¡¡é‡ Apple 411 Microsoft Advertising UET å¾®è½¯å¹¿å‘ŠUET Microsoft 412 Microsoft Clarity å¾®è½¯æ¸…æ™°åº¦ Microsoft 413 Bing Ads Attribution Bingå¹¿å‘Šå½’å›  Microsoft 414 Trade Desk Unified ID Trade Deskç»Ÿä¸€ID The Trade Desk 415 Trade Desk Koa Trade Desk AI The Trade Desk 416 LiveRamp IdentityLink LiveRampèº«ä»½é“¾æ¥ LiveRamp 417 LiveRamp Safe Haven LiveRampå®‰å…¨æ¸¯ LiveRamp 418 Adobe Analytics Adobeåˆ†æ Adobe 419 Adobe Experience Platform Adobeä½“éªŒå¹³å° Adobe 420 Adobe Audience Manager Adobeå—ä¼—ç®¡ç† Adobe 421 Salesforce Marketing Cloud Salesforceè¥é”€äº‘ Salesforce 422 Salesforce DMP Salesforce DMP Salesforce 423 Oracle Advertising Oracleå¹¿å‘Š Oracle 424 Oracle Data Cloud Oracleæ•°æ®äº‘ Oracle 425 Yahoo Ads Attribution Yahooå¹¿å‘Šå½’å›  Yahoo 426 Yahoo DSP Attribution Yahoo DSPå½’å›  Yahoo 427 Roku Advertising Rokuå¹¿å‘Š Roku 428 Roku Attribution Rokuå½’å›  Roku 429 Samsung Ads Attribution ä¸‰æ˜Ÿå¹¿å‘Šå½’å›  Samsung 430 LG Ads Attribution LGå¹¿å‘Šå½’å›  LG 431 Hulu Ads Attribution Huluå¹¿å‘Šå½’å›  Hulu 432 Spotify Ads Attribution Spotifyå¹¿å‘Šå½’å›  Spotify 433 Pandora Ads Attribution Pandoraå¹¿å‘Šå½’å›  Pandora 434 YouTube Ads Attribution YouTubeå¹¿å‘Šå½’å›  YouTube 435 Connected TV Attribution è”ç½‘ç”µè§†å½’å›  CTVå¹³å° 436 Programmatic Attribution ç¨‹åºåŒ–å½’å›  ç¨‹åºåŒ–å¹³å° 437 SSP Attribution SSPå½’å›  ä¾›åº”æ–¹å¹³å° 438 DSP Attribution DSPå½’å›  éœ€æ±‚æ–¹å¹³å° 439 Ad Exchange Attribution å¹¿å‘Šäº¤æ˜“å½’å›  å¹¿å‘Šäº¤æ˜“æ‰€ 440 Ad Network Attribution å¹¿å‘Šç½‘ç»œå½’å›  å¹¿å‘Šç½‘ç»œ åã€æ–°å…´æŠ€æœ¯ä¸è¶‹åŠ¿ç±»ï¼ˆEmerging & Trendsï¼‰ åºå· æœ¯è¯­ å®šä¹‰ æˆç†Ÿåº¦ 441 AI-Powered Attribution AIé©±åŠ¨å½’å›  å‘å±•ä¸­ 442 Predictive Attribution é¢„æµ‹å½’å›  å‘å±•ä¸­ 443 Real-Time Attribution å®æ—¶å½’å›  å‘å±•ä¸­ 444 Blockchain Attribution åŒºå—é“¾å½’å›  å®éªŒæ€§ 445 Web3 Attribution Web3å½’å›  å®éªŒæ€§ 446 NFT Campaign Tracking NFTæ´»åŠ¨è¿½è¸ª å®éªŒæ€§ 447 Metaverse Attribution å…ƒå®‡å®™å½’å›  å®éªŒæ€§ 448 CTV Attribution è”ç½‘ç”µè§†å½’å›  å‘å±•ä¸­ 449 DOOH Attribution æ•°å­—æˆ·å¤–å½’å›  å‘å±•ä¸­ 450 Audio Attribution éŸ³é¢‘å¹¿å‘Šå½’å›  å‘å±•ä¸­ 451 Voice Search Attribution è¯­éŸ³æœç´¢å½’å›  å‘å±•ä¸­ 452 Influencer Attribution ç½‘çº¢å½’å›  å‘å±•ä¸­ 453 Affiliate Attribution è”ç›Ÿå½’å›  æˆç†Ÿ 454 Referral Attribution æ¨èå½’å›  æˆç†Ÿ 455 Word-of-Mouth Tracking å£ç¢‘è¿½è¸ª å‘å±•ä¸­ 456 Dark Social Attribution æš—ç¤¾äº¤å½’å›  å‘å±•ä¸­ 457 Generative AI Attribution ç”Ÿæˆå¼AIå½’å›  æ–°å…´ 458 Large Language Model Attribution å¤§è¯­è¨€æ¨¡å‹å½’å›  æ–°å…´ 459 Multi-Modal Attribution å¤šæ¨¡æ€å½’å›  æ–°å…´ 460 Edge Computing Attribution è¾¹ç¼˜è®¡ç®—å½’å›  æ–°å…´ 461 5G Attribution 5Gå½’å›  æ–°å…´ 462 IoT Attribution ç‰©è”ç½‘å½’å›  æ–°å…´ 463 Smart Home Attribution æ™ºèƒ½å®¶å±…å½’å›  æ–°å…´ 464 Wearable Attribution å¯ç©¿æˆ´è®¾å¤‡å½’å›  æ–°å…´ 465 AR&#x2F;VR Attribution å¢å¼º&#x2F;è™šæ‹Ÿç°å®å½’å›  æ–°å…´ 466 Gaming Attribution æ¸¸æˆå½’å›  å‘å±•ä¸­ 467 Esports Attribution ç”µç«å½’å›  å‘å±•ä¸­ 468 Live Streaming Attribution ç›´æ’­å½’å›  å‘å±•ä¸­ 469 Social Commerce Attribution ç¤¾äº¤ç”µå•†å½’å›  å‘å±•ä¸­ 470 Shoppable Content Attribution å¯è´­ç‰©å†…å®¹å½’å›  å‘å±•ä¸­ 471 Interactive Video Attribution äº’åŠ¨è§†é¢‘å½’å›  å‘å±•ä¸­ 472 Personalized Attribution ä¸ªæ€§åŒ–å½’å›  å‘å±•ä¸­ 473 Dynamic Attribution åŠ¨æ€å½’å›  å‘å±•ä¸­ 474 Adaptive Attribution è‡ªé€‚åº”å½’å›  å‘å±•ä¸­ 475 Self-Learning Attribution è‡ªå­¦ä¹ å½’å›  æ–°å…´ 476 Autonomous Attribution è‡ªä¸»å½’å›  æ–°å…´ 477 Quantum Attribution é‡å­å½’å›  ç†è®ºæ€§ 478 Neuromarketing Attribution ç¥ç»è¥é”€å½’å›  å®éªŒæ€§ 479 Biometric Attribution ç”Ÿç‰©è¯†åˆ«å½’å›  å®éªŒæ€§ 480 Emotion AI Attribution æƒ…æ„ŸAIå½’å›  æ–°å…´ åä¸€ã€è¡Œä¸šç‰¹å®šæ–¹æ³•ç±»ï¼ˆIndustry-Specificï¼‰ åºå· æœ¯è¯­ å®šä¹‰ è¡Œä¸š 481 E-commerce Attribution ç”µå•†å½’å›  ç”µå•† 482 Gaming Attribution æ¸¸æˆå½’å›  æ¸¸æˆ 483 Finance Attribution é‡‘èå½’å›  é‡‘è 484 Travel Attribution æ—…æ¸¸å½’å›  æ—…æ¸¸ 485 B2B Attribution B2Bå½’å›  B2B 486 Healthcare Attribution åŒ»ç–—å½’å›  åŒ»ç–— 487 Automotive Attribution æ±½è½¦å½’å›  æ±½è½¦ 488 Real Estate Attribution æˆ¿äº§å½’å›  æˆ¿äº§ 489 Education Attribution æ•™è‚²å½’å›  æ•™è‚² 490 Retail Attribution é›¶å”®å½’å›  é›¶å”® 491 SaaS Attribution SaaSå½’å›  SaaS 492 Subscription Attribution è®¢é˜…å½’å›  è®¢é˜… 493 Marketplace Attribution å¹³å°å½’å›  å¹³å° 494 O2O Attribution O2Oå½’å›  å…¨æ¸ é“ 495 Phygital Attribution ç‰©ç†æ•°å­—èåˆå½’å›  å…¨æ¸ é“ 496 D2C Attribution D2Cå½’å›  ç›´é”€ 497 CPG Attribution CPGå½’å›  å¿«æ¶ˆå“ 498 Luxury Attribution å¥¢ä¾ˆå“å½’å›  å¥¢ä¾ˆå“ 499 FMCG Attribution FMCGå½’å›  å¿«æ¶ˆ 500 Pharmaceutical Attribution è¯å“å½’å›  åˆ¶è¯ 501 Insurance Attribution ä¿é™©å½’å›  ä¿é™© 502 Banking Attribution é“¶è¡Œå½’å›  é“¶è¡Œ 503 Telecommunications Attribution ç”µä¿¡å½’å›  ç”µä¿¡ 504 Energy Attribution èƒ½æºå½’å›  èƒ½æº 505 Utilities Attribution å…¬ç”¨äº‹ä¸šå½’å›  å…¬ç”¨äº‹ä¸š 506 Government Attribution æ”¿åºœå½’å›  æ”¿åºœ 507 Non-Profit Attribution éè¥åˆ©å½’å›  éè¥åˆ© 508 Political Attribution æ”¿æ²»å½’å›  æ”¿æ²» 509 Entertainment Attribution å¨±ä¹å½’å›  å¨±ä¹ 510 Media Attribution åª’ä½“å½’å›  åª’ä½“ 511 Publishing Attribution å‡ºç‰ˆå½’å›  å‡ºç‰ˆ 512 Sports Attribution ä½“è‚²å½’å›  ä½“è‚² 513 Fitness Attribution å¥èº«å½’å›  å¥èº« 514 Food & Beverage Attribution é¤é¥®å½’å›  é¤é¥® 515 Hospitality Attribution é…’åº—å½’å›  é…’åº— 516 Airlines Attribution èˆªç©ºå½’å›  èˆªç©º 517 Cruise Attribution é‚®è½®å½’å›  é‚®è½® 518 Events Attribution æ´»åŠ¨å½’å›  æ´»åŠ¨ 519 Wedding Attribution å©šç¤¼å½’å›  å©šç¤¼ 520 Pet Industry Attribution å® ç‰©è¡Œä¸šå½’å›  å® ç‰© åäºŒã€æ•°æ®ä¸åˆ†æå·¥å…·ç±»ï¼ˆData & Analyticsï¼‰ åºå· æœ¯è¯­ å®šä¹‰ ç±»å‹ 521 Google Analytics 4 GA4åˆ†æ ç½‘ç«™åˆ†æ 522 Adobe Analytics Adobeåˆ†æ ç½‘ç«™åˆ†æ 523 Mixpanel Mixpanel ç”¨æˆ·è¡Œä¸º 524 Amplitude Amplitude äº§å“åˆ†æ 525 Segment Segment CDP 526 mParticle mParticle CDP 527 Tealium Tealium æ ‡ç­¾ç®¡ç† 528 Google Tag Manager GTM æ ‡ç­¾ç®¡ç† 529 Looker Studio Looker Studio æ•°æ®å¯è§†åŒ– 530 Tableau Tableau æ•°æ®å¯è§†åŒ– 531 Power BI Power BI æ•°æ®å¯è§†åŒ– 532 Data Warehouse æ•°æ®ä»“åº“ æ•°æ®å­˜å‚¨ 533 CDP (Customer Data Platform) å®¢æˆ·æ•°æ®å¹³å° æ•°æ®ç®¡ç† 534 DMP (Data Management Platform) æ•°æ®ç®¡ç†å¹³å° æ•°æ®ç®¡ç† 535 BI Dashboard BIä»ªè¡¨æ¿ æ•°æ®å¯è§†åŒ– 536 Snowflake Snowflake æ•°æ®ä»“åº“ 537 BigQuery BigQuery æ•°æ®ä»“åº“ 538 Redshift Redshift æ•°æ®ä»“åº“ 539 Databricks Databricks æ•°æ®æ¹– 540 Apache Spark Apache Spark æ•°æ®å¤„ç† 541 Apache Kafka Apache Kafka æ•°æ®æµ 542 Apache Airflow Apache Airflow æ•°æ®ç¼–æ’ 543 dbt dbt æ•°æ®è½¬æ¢ 544 Fivetran Fivetran æ•°æ®é›†æˆ 545 Stitch Stitch æ•°æ®é›†æˆ 546 Airbyte Airbyte æ•°æ®é›†æˆ 547 Supermetrics Supermetrics æ•°æ®æå– 548 Funnel Funnel æ•°æ®æå– 549 Porter Metrics Porter Metrics æ•°æ®æå– 550 Windsor.ai Windsor.ai æ•°æ®æå– 551 Metabase Metabase BIå·¥å…· 552 Redash Redash BIå·¥å…· 553 Superset Superset BIå·¥å…· 554 Mode Analytics Mode Analytics BIå·¥å…· 555 Domo Domo BIå¹³å° 556 Sisense Sisense BIå¹³å° 557 Qlik Qlik BIå¹³å° 558 SAS SAS ç»Ÿè®¡åˆ†æ 559 SPSS SPSS ç»Ÿè®¡åˆ†æ 560 R Rè¯­è¨€ ç»Ÿè®¡åˆ†æ 561 Python Python æ•°æ®åˆ†æ 562 Jupyter Jupyter æ•°æ®ç§‘å­¦ 563 Colab Colab æ•°æ®ç§‘å­¦ 564 DataRobot DataRobot AutoML 565 H2O.ai H2O.ai AutoML 566 Dataiku Dataiku æ•°æ®ç§‘å­¦ 567 Alteryx Alteryx æ•°æ®åˆ†æ 568 Knime Knime æ•°æ®åˆ†æ 569 RapidMiner RapidMiner æ•°æ®åˆ†æ 570 MATLAB MATLAB ç§‘å­¦è®¡ç®— åä¸‰ã€å­¦æœ¯ç ”ç©¶æ–¹æ³•ç±»ï¼ˆAcademic Researchï¼‰ åºå· æœ¯è¯­ å®šä¹‰ æ¥æº 571 Structural Equation Modeling ç»“æ„æ–¹ç¨‹æ¨¡å‹ å­¦æœ¯ç ”ç©¶ 572 Latent Class Analysis æ½œåœ¨ç±»åˆ«åˆ†æ å­¦æœ¯ç ”ç©¶ 573 Conjoint Analysis è”åˆåˆ†æ å¸‚åœºç ”ç©¶ 574 Discrete Choice Modeling ç¦»æ•£é€‰æ‹©æ¨¡å‹ å­¦æœ¯ç ”ç©¶ 575 Hierarchical Bayes å±‚æ¬¡è´å¶æ–¯ å­¦æœ¯ç ”ç©¶ 576 Machine Learning Attribution æœºå™¨å­¦ä¹ å½’å›  AIç ”ç©¶ 577 Deep Learning Attribution æ·±åº¦å­¦ä¹ å½’å›  AIç ”ç©¶ 578 Reinforcement Learning Attribution å¼ºåŒ–å­¦ä¹ å½’å›  AIç ”ç©¶ 579 Graph Neural Network Attribution å›¾ç¥ç»ç½‘ç»œå½’å›  AIç ”ç©¶ 580 Attention Mechanism Attribution æ³¨æ„åŠ›æœºåˆ¶å½’å›  AIç ”ç©¶ 581 Counterfactual Attribution åäº‹å®å½’å›  å› æœæ¨æ–­ 582 Causal Forest å› æœæ£®æ— å› æœæ¨æ–­ 583 Double Machine Learning åŒé‡æœºå™¨å­¦ä¹  å› æœæ¨æ–­ 584 Meta-Learning Attribution å…ƒå­¦ä¹ å½’å›  AIç ”ç©¶ 585 Transfer Learning Attribution è¿ç§»å­¦ä¹ å½’å›  AIç ”ç©¶ 586 Multi-Task Learning Attribution å¤šä»»åŠ¡å­¦ä¹ å½’å›  AIç ”ç©¶ 587 Federated Attribution è”é‚¦å½’å›  éšç§ç ”ç©¶ 588 Privacy-Preserving Attribution éšç§ä¿æŠ¤å½’å›  éšç§ç ”ç©¶ 589 Secure Attribution å®‰å…¨å½’å›  å®‰å…¨ç ”ç©¶ 590 Verifiable Attribution å¯éªŒè¯å½’å›  åŒºå—é“¾ç ”ç©¶ 591 Explainable AI Attribution å¯è§£é‡ŠAIå½’å›  AIç ”ç©¶ 592 Fair Attribution å…¬å¹³å½’å›  ä¼¦ç†ç ”ç©¶ 593 Robust Attribution é²æ£’å½’å›  ç»Ÿè®¡ç ”ç©¶ 594 Uncertainty Quantification ä¸ç¡®å®šæ€§é‡åŒ– ç»Ÿè®¡ç ”ç©¶ 595 Bayesian Optimization è´å¶æ–¯ä¼˜åŒ– ä¼˜åŒ–ç ”ç©¶ 596 Multi-Objective Optimization å¤šç›®æ ‡ä¼˜åŒ– ä¼˜åŒ–ç ”ç©¶ 597 Game Theoretic Attribution åšå¼ˆè®ºå½’å›  åšå¼ˆç ”ç©¶ 598 Mechanism Design Attribution æœºåˆ¶è®¾è®¡å½’å›  ç»æµç ”ç©¶ 599 Auction Theory Attribution æ‹å–ç†è®ºå½’å›  ç»æµç ”ç©¶ 600 Behavioral Economics Attribution è¡Œä¸ºç»æµå­¦å½’å›  è¡Œä¸ºç ”ç©¶ åå››ã€å’¨è¯¢å…¬å¸ä¸“æœ‰æ–¹æ³•ç±»ï¼ˆConsulting Proprietaryï¼‰ åºå· æœ¯è¯­ å®šä¹‰ å…¬å¸ 601 McKinsey Marketing Analytics éº¦è‚¯é”¡è¥é”€åˆ†æ McKinsey 602 McKinsey Customer Journey Analytics éº¦è‚¯é”¡å®¢æˆ·æ—…ç¨‹åˆ†æ McKinsey 603 BCG Marketing Mix Optimization BCGè¥é”€ç»„åˆä¼˜åŒ– BCG 604 BCG Customer Analytics BCGå®¢æˆ·åˆ†æ BCG 605 Bain Marketing Effectiveness è´æ©è¥é”€æ•ˆæœ Bain 606 Bain Customer Loyalty Analytics è´æ©å®¢æˆ·å¿ è¯šåˆ†æ Bain 607 Deloitte Marketing Analytics å¾·å‹¤è¥é”€åˆ†æ Deloitte 608 Deloitte Customer Experience Analytics å¾·å‹¤å®¢æˆ·ä½“éªŒåˆ†æ Deloitte 609 PwC Marketing ROI PwCè¥é”€ROI PwC 610 PwC Customer Analytics PwCå®¢æˆ·åˆ†æ PwC 611 EY Marketing Analytics å®‰æ°¸è¥é”€åˆ†æ EY 612 EY Customer Insights å®‰æ°¸å®¢æˆ·æ´å¯Ÿ EY 613 KPMG Marketing Effectiveness æ¯•é©¬å¨è¥é”€æ•ˆæœ KPMG 614 KPMG Customer Analytics æ¯•é©¬å¨å®¢æˆ·åˆ†æ KPMG 615 Accenture Marketing Analytics åŸƒæ£®å“²è¥é”€åˆ†æ Accenture 616 Accenture Customer Experience åŸƒæ£®å“²å®¢æˆ·ä½“éªŒ Accenture 617 Oliver Wyman Marketing Analytics å¥¥çº¬è¥é”€åˆ†æ Oliver Wyman 618 Kearney Marketing Effectiveness ç§‘å°”å°¼è¥é”€æ•ˆæœ Kearney 619 L.E.K. Marketing Analytics L.E.K.è¥é”€åˆ†æ L.E.K. 620 Roland Berger Marketing Analytics ç½—å…°è´æ ¼è¥é”€åˆ†æ Roland Berger 621 A.T. Kearney Marketing Analytics A.T.ç§‘å°”å°¼è¥é”€åˆ†æ A.T. Kearney 622 Strategy& Marketing Analytics Strategy&è¥é”€åˆ†æ Strategy& 623 Monitor Deloitte Marketing Analytics Monitorå¾·å‹¤è¥é”€åˆ†æ Monitor Deloitte 624 Parthenon Marketing Analytics Parthenonè¥é”€åˆ†æ Parthenon 625 LEK Customer Analytics LEKå®¢æˆ·åˆ†æ LEK åäº”ã€åŒºåŸŸç‰¹å®šå®è·µç±»ï¼ˆRegional Specificï¼‰ åºå· æœ¯è¯­ å®šä¹‰ åŒºåŸŸ 626 China PIPL Attribution ä¸­å›½PIPLå½’å›  ä¸­å›½ 627 China ICP Attribution ä¸­å›½ICPå½’å›  ä¸­å›½ 628 China Great Firewall Attribution ä¸­å›½é˜²ç«å¢™å½’å›  ä¸­å›½ 629 WeChat Attribution å¾®ä¿¡å½’å›  ä¸­å›½ 630 Alipay Attribution æ”¯ä»˜å®å½’å›  ä¸­å›½ 631 Douyin Attribution æŠ–éŸ³å½’å›  ä¸­å›½ 632 Kuaishou Attribution å¿«æ‰‹å½’å›  ä¸­å›½ 633 Baidu Attribution ç™¾åº¦å½’å›  ä¸­å›½ 634 EU GDPR Attribution æ¬§ç›ŸGDPRå½’å›  æ¬§ç›Ÿ 635 EU ePrivacy Attribution æ¬§ç›Ÿç”µå­éšç§å½’å›  æ¬§ç›Ÿ 636 EU DSA Attribution æ¬§ç›Ÿæ•°å­—æœåŠ¡æ³•å½’å›  æ¬§ç›Ÿ 637 EU DMA Attribution æ¬§ç›Ÿæ•°å­—å¸‚åœºæ³•å½’å›  æ¬§ç›Ÿ 638 US CCPA Attribution ç¾å›½CCPAå½’å›  ç¾å›½ 639 US CPRA Attribution ç¾å›½CPRAå½’å›  ç¾å›½ 640 US COPPA Attribution ç¾å›½COPPAå½’å›  ç¾å›½ 641 US HIPAA Attribution ç¾å›½HIPAAå½’å›  ç¾å›½ 642 Brazil LGPD Attribution å·´è¥¿LGPDå½’å›  å·´è¥¿ 643 Canada PIPEDA Attribution åŠ æ‹¿å¤§PIPEDAå½’å›  åŠ æ‹¿å¤§ 644 Japan APPI Attribution æ—¥æœ¬APPIå½’å›  æ—¥æœ¬ 645 Singapore PDPA Attribution æ–°åŠ å¡PDPAå½’å›  æ–°åŠ å¡ 646 Thailand PDPA Attribution æ³°å›½PDPAå½’å›  æ³°å›½ 647 India PDPB Attribution å°åº¦PDPBå½’å›  å°åº¦ 648 Australia Privacy Act Attribution æ¾³å¤§åˆ©äºšéšç§æ³•å½’å›  æ¾³å¤§åˆ©äºš 649 South Korea PIPA Attribution éŸ©å›½PIPAå½’å›  éŸ©å›½ 650 Russia Data Localization Attribution ä¿„ç½—æ–¯æ•°æ®æœ¬åœ°åŒ–å½’å›  ä¿„ç½—æ–¯ 651 Middle East Data Protection Attribution ä¸­ä¸œæ•°æ®ä¿æŠ¤å½’å›  ä¸­ä¸œ 652 Africa Data Protection Attribution éæ´²æ•°æ®ä¿æŠ¤å½’å›  éæ´² 653 LATAM Data Protection Attribution æ‹‰ç¾æ•°æ®ä¿æŠ¤å½’å›  æ‹‰ç¾ 654 ASEAN Data Protection Attribution ä¸œç›Ÿæ•°æ®ä¿æŠ¤å½’å›  ä¸œç›Ÿ 655 Global Cross-Border Attribution å…¨çƒè·¨å¢ƒå½’å›  å…¨çƒ åå…­ã€è¡Œä¸šåä¼šæ ‡å‡†ç±»ï¼ˆIndustry Standardsï¼‰ åºå· æœ¯è¯­ å®šä¹‰ ç»„ç»‡ 656 IAB Attribution Standards IABå½’å› æ ‡å‡† IAB 657 IAB Tech Lab Attribution IABæŠ€æœ¯å®éªŒå®¤å½’å›  IAB Tech Lab 658 IAB OpenRTB Attribution IAB OpenRTBå½’å›  IAB Tech Lab 659 IAB VAST Attribution IAB VASTå½’å›  IAB Tech Lab 660 IAB VPAID Attribution IAB VPAIDå½’å›  IAB Tech Lab 661 IAB OM Attribution IAB Open Measurementå½’å›  IAB Tech Lab 662 MRC Attribution Standards MRCå½’å› æ ‡å‡† MRC 663 MRC Viewability Standards MRCå¯è§æ€§æ ‡å‡† MRC 664 MRC Invalid Traffic Standards MRCæ— æ•ˆæµé‡æ ‡å‡† MRC 665 TAG Certification TAGè®¤è¯ TAG 666 ESOMAR Attribution Guidelines ESOMARå½’å› æŒ‡å— ESOMAR 667 ICC Advertising Codes ICCå¹¿å‘Šå‡†åˆ™ ICC 668 ANA Attribution Standards ANAå½’å› æ ‡å‡† ANA 669 4Aâ€™s Attribution Guidelines 4Aâ€™så½’å› æŒ‡å— 4Aâ€™s 670 WFA Attribution Standards WFAå½’å› æ ‡å‡† WFA 671 DMA Attribution Guidelines DMAå½’å› æŒ‡å— DMA 672 DAA Attribution Standards DAAå½’å› æ ‡å‡† DAA 673 NAI Attribution Standards NAIå½’å› æ ‡å‡† NAI 674 IAB China Attribution ä¸­å›½IABå½’å›  IAB China 675 MMA Attribution Standards MMAå½’å› æ ‡å‡† MMA 676 Mobile Marketing Attribution ç§»åŠ¨è¥é”€å½’å›  MMA 677 Programmatic Attribution Standards ç¨‹åºåŒ–å½’å› æ ‡å‡† ç¨‹åºåŒ–è”ç›Ÿ 678 CTV Attribution Standards CTVå½’å› æ ‡å‡† CTVè”ç›Ÿ 679 Retail Media Attribution Standards é›¶å”®åª’ä½“å½’å› æ ‡å‡† é›¶å”®åª’ä½“è”ç›Ÿ 680 Cross-Media Attribution Standards è·¨åª’ä½“å½’å› æ ‡å‡† è·¨åª’ä½“è”ç›Ÿ ğŸ’¡ ä½¿ç”¨å»ºè®® ä¸šåŠ¡åœºæ™¯ æ¨èæ–¹æ³•ç»„åˆ ç”µå•†çŸ­æœŸè½¬åŒ– MTA + ROAS + Last Click + CAPI + GA4 å“ç‰Œé•¿æœŸå»ºè®¾ MMM + Brand Lift + SOV + NPS + Meridian éšç§åˆè§„ç¯å¢ƒ Clean Room + Probabilistic + Aggregated + SKAN 5.0 åº”ç”¨æ¨å¹¿ SKAN + MMP (AppsFlyer&#x2F;Adjust) + LTV + AEM B2Bé•¿å‘¨æœŸ Multi-Touch + Lead Scoring + Attribution Windowå»¶é•¿ + Salesforce å…¨æ¸ é“é›¶å”® O2O + Store Visit + MMM+MTAç»Ÿä¸€ + CDP å†…å®¹è¥é”€ Engagement + Dwell Time + Social Listening + Dark Social è§†é¢‘å¹¿å‘Š Viewability + Completion Rate + VTC + CTV Attribution å‡ºæµ·ä¸šåŠ¡ åŒºåŸŸåˆè§„ (GDPR&#x2F;PIPL&#x2F;CCPA) + Cross-Border + Local MMP","date":"2026-02-19","categories":["å¹¿å‘Š"],"tags":["å¹¿å‘Š"]},{"title":"å¹¿å‘Šï¼ˆ6ï¼‰-å¹¿å‘Šä¼˜åŒ–å’Œå‡ºä»·ç­–ç•¥","url":"/2026/02/19/å¹¿å‘Š6-å¹¿å‘Šä¼˜åŒ–å’Œå‡ºä»·ç­–ç•¥/","content":"ğŸ“‹ å¹¿å‘Šå‡ºä»·ä¸ä¼˜åŒ–ç­–ç•¥å®Œæ•´å…¨æ™¯å›¾ (2026 ç‰ˆ)ä¸€ã€ç«ä»·æœºåˆ¶ä¸æ‹å–ç±»å‹ (Auction Mechanisms & Types) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ First Price Auction (GFP) ç¬¬ä¸€ä»·æ ¼æ‹å– æœ€é«˜å‡ºä»·è€…æŒ‰è‡ªå·±å‡ºä»·æ”¯ä»˜ ç¨‹åºåŒ–å¹¿å‘Šã€Header Bidding Second Price Auction (GSP) ç¬¬äºŒä»·æ ¼æ‹å– æœ€é«˜å‡ºä»·è€…æŒ‰æ¬¡é«˜å‡ºä»· +0.01 æ”¯ä»˜ Google æœç´¢å¹¿å‘Š VCG Auction VCG æ‹å–æœºåˆ¶ æŒ‰ç¤¾ä¼šæˆæœ¬è®¡è´¹ï¼Œé¼“åŠ±çœŸå®å‡ºä»· Facebook éƒ¨åˆ†åœºæ™¯ Generalized First Price (GFP) å¹¿ä¹‰ç¬¬ä¸€ä»·æ ¼ ç¬¬ä¸€ä»·æ ¼æ‹å–çš„å˜ä½“ éƒ¨åˆ†ç¨‹åºåŒ–å¹³å° Generalized Second Price (GSP) å¹¿ä¹‰ç¬¬äºŒä»·æ ¼ ç¬¬äºŒä»·æ ¼æ‹å–çš„å˜ä½“ï¼Œè€ƒè™‘è´¨é‡åˆ† Google&#x2F;Bing æœç´¢ Expressive Auction è¡¨è¾¾æ€§æ‹å– å…è®¸å¹¿å‘Šä¸»æäº¤å¤æ‚å‡ºä»·è¡¨è¾¾å¼ é«˜çº§ç¨‹åºåŒ– Combinatorial Auction ç»„åˆæ‹å– å…è®¸å¯¹å¹¿å‘Šä½ç»„åˆå‡ºä»· å¤šä½ç½®æ‰“åŒ… Sequential Auction åºåˆ—æ‹å– å¤šä¸ªå¹¿å‘Šä½ä¾æ¬¡æ‹å– å¤šå¹¿å‘Šä½åœºæ™¯ Simultaneous Auction åŒæ—¶æ‹å– å¤šä¸ªå¹¿å‘Šä½åŒæ—¶æ‹å– å¤šå¹¿å‘Šä½åœºæ™¯ RTB (Real-Time Bidding) å®æ—¶ç«ä»· æ¯«ç§’çº§ç¨‹åºåŒ–ç«ä»·ï¼Œæ¯æ¬¡å±•ç¤ºç‹¬ç«‹æ‹å– ç¨‹åºåŒ–å±•ç¤ºå¹¿å‘Š Header Bidding å¤´éƒ¨ç«ä»· è®©å¤šä¸ªå¹¿å‘Šäº¤æ˜“æ‰€åŒæ—¶ç«ä»· åª’ä½“æ–¹æ”¶ç›Šä¼˜åŒ– Unified Auction ç»Ÿä¸€æ‹å– Google Ad Manager çš„ç»Ÿä¸€ç«ä»·æœºåˆ¶ è°·æ­Œå¹¿å‘Šç”Ÿæ€ Floor Price Strategy åº•ä»·ç­–ç•¥ è®¾ç½®æœ€ä½å¯æ¥å—å‡ºä»·ï¼Œè¿‡æ»¤ä½è´¨æµé‡ åª’ä½“æ–¹&#x2F;SSP Dynamic Floor Price åŠ¨æ€åº•ä»· æ ¹æ®æµé‡è´¨é‡åŠ¨æ€è°ƒæ•´åº•ä»· ç¨‹åºåŒ–äº¤æ˜“ Hard Floor ç¡¬åº•ä»· ç»å¯¹ä¸å¯ä½äºçš„æœ€ä½ä»·æ ¼ åª’ä½“æ–¹ä¿æŠ¤ Soft Floor è½¯åº•ä»· å¯åå•†çš„æœ€ä½ä»·æ ¼å‚è€ƒ åª’ä½“æ–¹ä¼˜åŒ– Bid Ceiling å‡ºä»·ä¸Šé™ è®¾ç½®æœ€é«˜å‡ºä»·é™åˆ¶ï¼Œé˜²æ­¢è¶…é¢„ç®— å¹¿å‘Šä¸»ä¾§ Bid Floor å‡ºä»·åº•ä»· ç¨‹åºåŒ–äº¤æ˜“ä¸­çš„æœ€ä½å‡ºä»·é—¨æ§› DSP&#x2F;ADX Reserve Price ä¿ç•™ä»·æ ¼ åª’ä½“æ–¹è®¾ç½®çš„æœ€ä½æˆäº¤ä»·æ ¼ SSP&#x2F;Ad Exchange Spot Market ç°è´§å¸‚åœº å³æ—¶äº¤æ˜“çš„å¹¿å‘Šåº“å­˜å¸‚åœº ç¨‹åºåŒ–äº¤æ˜“ Forward Market è¿œæœŸå¸‚åœº æå‰é”å®šæœªæ¥å¹¿å‘Šåº“å­˜ å“ç‰Œå¹¿å‘Š äºŒã€åŸºç¡€è®¡è´¹æ¨¡å¼ (Basic Pricing Models) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ CPM (Cost Per Mille) åƒæ¬¡å±•ç¤ºæˆæœ¬ å“ç‰Œæ›å…‰å¯¼å‘ å“ç‰Œå¹¿å‘Šã€å±•ç¤ºå¹¿å‘Š vCPM (Viewable CPM) å¯è§åƒæ¬¡å±•ç¤ºæˆæœ¬ ä»…è®¡ç®—å¯è§å±•ç¤º å“ç‰Œå¹¿å‘Š CPC (Cost Per Click) å•æ¬¡ç‚¹å‡»æˆæœ¬ æµé‡å¯¼å‘ æœç´¢å¹¿å‘Šã€ä¿¡æ¯æµ CPA (Cost Per Action) å•æ¬¡è½¬åŒ–æˆæœ¬ æ•ˆæœå¯¼å‘ æ•ˆæœå¹¿å‘Š CPV (Cost Per View) å•æ¬¡è§‚çœ‹æˆæœ¬ è§†é¢‘å¹¿å‘Šä¸“ç”¨ YouTubeã€æŠ–éŸ³è§†é¢‘ CPV (Cost Per Visit) å•æ¬¡è®¿é—®æˆæœ¬ ç½‘ç«™è®¿é—®å¯¼å‘ å¼•æµå¹¿å‘Š CPL (Cost Per Lead) å•æ¬¡çº¿ç´¢æˆæœ¬ è¡¨å•&#x2F;ç•™èµ„å¯¼å‘ B2Bã€æ•™è‚²ã€é‡‘è CPS (Cost Per Sale) å•æ¬¡é”€å”®æˆæœ¬ ç”µå•†æˆäº¤å¯¼å‘ ç”µå•†å¹¿å‘Šã€è”ç›Ÿè¥é”€ CPI (Cost Per Install) å•æ¬¡å®‰è£…æˆæœ¬ åº”ç”¨ä¸‹è½½å¯¼å‘ APP æ¨å¹¿ CPH (Cost Per Hour) å•æ¬¡é€šè¯æˆæœ¬ ç”µè¯è½¬åŒ–å¯¼å‘ æœ¬åœ°æœåŠ¡ã€ç”µè¯å’¨è¯¢ CPE (Cost Per Engagement) å•æ¬¡äº’åŠ¨æˆæœ¬ ç¤¾äº¤äº’åŠ¨å¯¼å‘ ç¤¾äº¤åª’ä½“å¹¿å‘Š CPCV (Cost Per Completed View) å•æ¬¡å®Œæ•´è§‚çœ‹æˆæœ¬ è§†é¢‘å®Œæ’­å¯¼å‘ è§†é¢‘å¹¿å‘Š CPD (Cost Per Day) å•æ—¥æˆæœ¬ åŒ…å¤©å¹¿å‘Š å¼€å±å¹¿å‘Šã€é¦–é¡µä½ CPW (Cost Per Week) å•å‘¨æˆæœ¬ åŒ…å‘¨å¹¿å‘Š é•¿æœŸå±•ç¤ºä½ CPM+ (CPM Plus) CPM åŠ åˆ†æˆ åŸºç¡€ CPM åŠ æ”¶å…¥åˆ†æˆ æ··åˆè®¡è´¹ Revenue Share æ”¶å…¥åˆ†æˆ æŒ‰æ”¶å…¥æ¯”ä¾‹åˆ†æˆ è”ç›Ÿè¥é”€ã€ç½‘çº¢åˆä½œ Hybrid Pricing æ··åˆè®¡è´¹ å¤šç§è®¡è´¹æ¨¡å¼ç»„åˆ å¤æ‚åœºæ™¯ Performance-Based æ•ˆæœè®¡è´¹ åŸºäºå®é™…æ•ˆæœä»˜è´¹ æ•ˆæœå¹¿å‘Š Flat Fee å›ºå®šè´¹ç”¨ å›ºå®šé‡‘é¢è´­ä¹°å¹¿å‘Šä½ å“ç‰Œå¹¿å‘Š Cost Per Conversation å•æ¬¡å¯¹è¯æˆæœ¬ èŠå¤©&#x2F;å®¢æœå¯¹è¯å¯¼å‘ å®¢æœå¹¿å‘Š ä¸‰ã€æ™ºèƒ½å‡ºä»·ç­–ç•¥ (Smart Bidding Strategies) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ oCPM (Optimized CPM) ä¼˜åŒ–åƒæ¬¡å±•ç¤ºæˆæœ¬ åŸºäºè½¬åŒ–æ¦‚ç‡åŠ¨æ€è°ƒæ•´å‡ºä»· æŠ–éŸ³ã€è…¾è®¯å¹¿å‘Š oCPC (Optimized CPC) ä¼˜åŒ–å•æ¬¡ç‚¹å‡»æˆæœ¬ åŸºäºè½¬åŒ–æ¦‚ç‡åŠ¨æ€è°ƒæ•´ç‚¹å‡»å‡ºä»· ç™¾åº¦ã€ä¿¡æ¯æµ oCPA (Optimized CPA) ä¼˜åŒ–å•æ¬¡è½¬åŒ–æˆæœ¬ åŸºäºè½¬åŒ–æ¦‚ç‡åŠ¨æ€è°ƒæ•´å‡ºä»· æ•ˆæœå¹¿å‘Š oCPX æ™ºèƒ½å‡ºä»·ç»Ÿç§° å›½å†…å¯¹ oCPM&#x2F;oCPA çš„æ³›ç§° ä¸­å›½å¹¿å‘Šå¹³å° tCPA (Target CPA) ç›®æ ‡è½¬åŒ–æˆæœ¬ è®¾å®šç›®æ ‡ CPAï¼Œç³»ç»Ÿè‡ªåŠ¨ä¼˜åŒ– Googleã€Meta tROAS (Target ROAS) ç›®æ ‡å¹¿å‘Šæ”¯å‡ºå›æŠ¥ç‡ è®¾å®šç›®æ ‡ ROIï¼Œç³»ç»Ÿè‡ªåŠ¨ä¼˜åŒ– Googleã€Meta Maximize Conversions æœ€å¤§åŒ–è½¬åŒ– é¢„ç®—å†…è·å–æœ€å¤šè½¬åŒ– Google Ads Maximize Conversion Value æœ€å¤§åŒ–è½¬åŒ–ä»·å€¼ é¢„ç®—å†…è·å–æœ€é«˜è½¬åŒ–æ€»ä»·å€¼ Google Ads Maximize Clicks æœ€å¤§åŒ–ç‚¹å‡» é¢„ç®—å†…è·å–æœ€å¤šç‚¹å‡» æµé‡å¯¼å‘ Target Impression Share ç›®æ ‡å±•ç¤ºä»½é¢ äº‰å–ç‰¹å®šæ’å&#x2F;ä½ç½®çš„å±•ç¤ºå æ¯” Google æœç´¢ Target Search Page Location ç›®æ ‡æœç´¢é¡µé¢ä½ç½® äº‰å–æœç´¢ç»“æœé¡µç‰¹å®šä½ç½® Google æœç´¢ Target Outrank Share ç›®æ ‡è¶…è¶Šä»½é¢ äº‰å–è¶…è¶Šç‰¹å®šç«äº‰å¯¹æ‰‹ ç«äº‰ç­–ç•¥ Enhanced CPC (ECPC) å¢å¼ºå‹ CPC æ‰‹åŠ¨ CPC åŸºç¡€ä¸Šæ™ºèƒ½æµ®åŠ¨Â±30% Google Ads Portfolio Bid Strategy ç»„åˆå‡ºä»·ç­–ç•¥ å¤šå¹¿å‘Šç»„å…±äº«åŒä¸€å‡ºä»·ç­–ç•¥ Google Ads Value-Based Bidding ä»·å€¼å‡ºä»· åŸºäºç”¨æˆ· LTV å·®å¼‚åŒ–å‡ºä»· ç”µå•†ã€é«˜å®¢å•ä»· AI Agent Bidding AI ä»£ç†å‡ºä»· è‡ªä¸» AI ä»£ç†æ‰§è¡Œå¤æ‚å‡ºä»·å†³ç­– å‰æ²¿åº”ç”¨ Dynamic Bid Adjustment åŠ¨æ€å‡ºä»·è°ƒæ•´ åŸºäºå®æ—¶ä¿¡å·è‡ªåŠ¨è°ƒæ•´å‡ºä»· ç¨‹åºåŒ–å¹¿å‘Š Deep Conversion Bidding æ·±åº¦è½¬åŒ–å‡ºä»· åŸºäºæ·±åº¦è½¬åŒ–äº‹ä»¶ä¼˜åŒ–å‡ºä»· å·¨é‡å¼•æ“ Dual-Objective Bidding åŒç›®æ ‡å‡ºä»· åŒæ—¶ä¼˜åŒ–ä¸¤ä¸ªç›®æ ‡ (å¦‚è½¬åŒ– +ROAS) å¤æ‚ç›®æ ‡ Multi-Goal Bidding å¤šç›®æ ‡å‡ºä»· åŒæ—¶ä¼˜åŒ–å¤šä¸ªç›®æ ‡ å¤æ‚åœºæ™¯ Sequential Bidding åºåˆ—å‡ºä»· åŸºäºç”¨æˆ·æ—…ç¨‹é˜¶æ®µå·®å¼‚åŒ–å‡ºä»· å…¨æ¼æ–—è¥é”€ Lifetime Value Bidding ç”Ÿå‘½å‘¨æœŸä»·å€¼å‡ºä»· åŸºäºç”¨æˆ· LTV é¢„æµ‹å‡ºä»· é•¿æœŸä»·å€¼ Margin-Based Bidding åˆ©æ¶¦ç‡å‡ºä»· åŸºäºäº§å“åˆ©æ¶¦ç‡å·®å¼‚åŒ–å‡ºä»· ç”µå•† Inventory-Based Bidding åº“å­˜é©±åŠ¨å‡ºä»· åŸºäºåº“å­˜æ°´å¹³è°ƒæ•´å‡ºä»· ç”µå•†æ¸…ä»“ å››ã€å‡ºä»·æ§åˆ¶æŠ€æœ¯ (Bid Control Techniques) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ Bid Shading å‡ºä»·é®è”½ åœ¨ç¬¬äºŒä»·æ ¼æ‹å–ä¸­æ™ºèƒ½é™ä½å‡ºä»·ï¼Œç•¥é«˜äºæ¬¡é«˜å‡ºä»·å³å¯è·èƒœ ç¨‹åºåŒ–å¹¿å‘Šã€DSP Bid Multiplier å‡ºä»·ç³»æ•°&#x2F;å‡ºä»·è°ƒèŠ‚å™¨ å¯¹ç‰¹å®šç»´åº¦ (æ—¶æ®µ&#x2F;åœ°åŸŸ&#x2F;è®¾å¤‡&#x2F;äººç¾¤) è®¾ç½®Â±% å‡ºä»·è°ƒæ•´ æ‰€æœ‰ä¸»æµå¹³å° Bid Adjustment å‡ºä»·è°ƒæ•´ å¹¿ä¹‰çš„å‡ºä»·ç³»æ•°è°ƒæ•´ é€šç”¨æœ¯è¯­ Device Bid Adjustment è®¾å¤‡å‡ºä»·è°ƒæ•´ é’ˆå¯¹æ‰‹æœº&#x2F;å¹³æ¿&#x2F;ç”µè„‘å·®å¼‚åŒ–å‡ºä»· å¤šè®¾å¤‡æŠ•æ”¾ Location Bid Adjustment åœ°åŸŸå‡ºä»·è°ƒæ•´ é’ˆå¯¹ä¸åŒåœ°ç†ä½ç½®è°ƒæ•´å‡ºä»· æœ¬åœ°&#x2F;å…¨å›½æŠ•æ”¾ Time Bid Adjustment æ—¶æ®µå‡ºä»·è°ƒæ•´ é’ˆå¯¹ä¸åŒæ—¶é—´æ®µè°ƒæ•´å‡ºä»· Dayparting Audience Bid Adjustment äººç¾¤å‡ºä»·è°ƒæ•´ é’ˆå¯¹ä¸åŒäººç¾¤åŒ…è°ƒæ•´å‡ºä»· ç²¾ç»†åŒ–å®šå‘ Browser&#x2F;OS Bid Adjustment æµè§ˆå™¨&#x2F;ç³»ç»Ÿå‡ºä»·è°ƒæ•´ é’ˆå¯¹ç‰¹å®šæµè§ˆå™¨æˆ–æ“ä½œç³»ç»Ÿ æŠ€æœ¯å®šå‘ Connection Type Adjustment ç½‘ç»œç±»å‹è°ƒæ•´ WiFi&#x2F;4G&#x2F;5G ç­‰ä¸åŒç½‘ç»œç¯å¢ƒ ç§»åŠ¨ç«¯ä¼˜åŒ– Placement Bid Adjustment ç‰ˆä½å‡ºä»·è°ƒæ•´ é’ˆå¯¹ä¸åŒå±•ç¤ºä½ç½®è°ƒæ•´å‡ºä»· å±•ç¤ºå¹¿å‘Š Keyword Match Type Adjustment å…³é”®è¯åŒ¹é…ç±»å‹è°ƒæ•´ é’ˆå¯¹ä¸åŒåŒ¹é…ç±»å‹è°ƒæ•´å‡ºä»· æœç´¢å¹¿å‘Š Ad Schedule Adjustment å¹¿å‘Šæ—¶é—´è¡¨è°ƒæ•´ æŒ‰å°æ—¶&#x2F;æ˜ŸæœŸè°ƒæ•´å‡ºä»· æ—¶æ®µä¼˜åŒ– Demographic Adjustment äººå£ç»Ÿè®¡è°ƒæ•´ æŒ‰å¹´é¾„&#x2F;æ€§åˆ«&#x2F;æ”¶å…¥è°ƒæ•´å‡ºä»· äººç¾¤å®šå‘ Weather-Based Adjustment å¤©æ°”é©±åŠ¨è°ƒæ•´ æ ¹æ®å¤©æ°”æ¡ä»¶è°ƒæ•´å‡ºä»· æœ¬åœ°æœåŠ¡ Event-Based Adjustment äº‹ä»¶é©±åŠ¨è°ƒæ•´ æ ¹æ®ç‰¹æ®Šäº‹ä»¶è°ƒæ•´å‡ºä»· è¥é”€æ´»åŠ¨ Competitor-Based Adjustment ç«äº‰é©±åŠ¨è°ƒæ•´ æ ¹æ®ç«äº‰å¯¹æ‰‹æ´»åŠ¨è°ƒæ•´å‡ºä»· ç«äº‰ç­–ç•¥ Real-Time Bid Adjustment å®æ—¶å‡ºä»·è°ƒæ•´ åŸºäºå®æ—¶ä¿¡å·åŠ¨æ€è°ƒæ•´ ç¨‹åºåŒ–å¹¿å‘Š Predictive Bid Adjustment é¢„æµ‹æ€§å‡ºä»·è°ƒæ•´ åŸºäºé¢„æµ‹æ¨¡å‹è°ƒæ•´å‡ºä»· AI ä¼˜åŒ– Constraint-Based Bidding çº¦æŸå‡ºä»· åœ¨å¤šé‡çº¦æŸæ¡ä»¶ä¸‹ä¼˜åŒ–å‡ºä»· å¤æ‚åœºæ™¯ Risk-Adjusted Bidding é£é™©è°ƒæ•´å‡ºä»· è€ƒè™‘é£é™©å› ç´ çš„å‡ºä»·ç­–ç•¥ ä¿å®ˆç­–ç•¥ äº”ã€é¢„ç®—ä¸æ¶ˆè€—æ§åˆ¶ (Budget & Pacing Control) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ Budget Pacing é¢„ç®—å¹³æ»‘ æ§åˆ¶é¢„ç®—åœ¨å‘¨æœŸå†…å‡åŒ€&#x2F;æ™ºèƒ½æ¶ˆè€— æ‰€æœ‰å¹¿å‘ŠæŠ•æ”¾ Standard Pacing æ ‡å‡†å¹³æ»‘ å‡åŒ€åˆ†é…é¢„ç®—åˆ°æ¯ä¸ªæ—¶é—´æ®µ ç¨³å®šæŠ•æ”¾éœ€æ±‚ Accelerated Pacing åŠ é€Ÿæ¶ˆè€— å°½å¿«èŠ±å®Œé¢„ç®—ï¼ŒæŠ¢å æµé‡ ä¿ƒé”€&#x2F;ç´§æ€¥ campaign Predictive Pacing é¢„æµ‹æ€§å¹³æ»‘ åŸºäºå†å²æ•°æ®é¢„æµ‹æœ€ä¼˜æ¶ˆè€—èŠ‚å¥ æ™ºèƒ½æŠ•æ”¾ç³»ç»Ÿ Adaptive Pacing è‡ªé€‚åº”å¹³æ»‘ æ ¹æ®å®æ—¶è¡¨ç°åŠ¨æ€è°ƒæ•´æ¶ˆè€—èŠ‚å¥ æ™ºèƒ½ä¼˜åŒ– End-of-Day Rush æ—¥æœ«å†²åˆº é¿å…é¢„ç®—åœ¨æ—¥æœ«æœªèŠ±å®Œçš„åŠ é€Ÿç­–ç•¥ æ¯æ—¥é¢„ç®—åœºæ™¯ Front-Loading å‰ç½®æ¶ˆè€— åœ¨å‘¨æœŸå‰æœŸé›†ä¸­æ¶ˆè€—é¢„ç®— æ–°å“å‘å¸ƒ Back-Loading åç½®æ¶ˆè€— åœ¨å‘¨æœŸåæœŸé›†ä¸­æ¶ˆè€—é¢„ç®— ä¿ƒé”€æ”¶å°¾ CBO (Campaign Budget Optimization) å¹¿å‘Šç³»åˆ—é¢„ç®—ä¼˜åŒ– åœ¨å¹¿å‘Šç»„é—´åŠ¨æ€åˆ†é…é¢„ç®— Metaã€Google ABO (Ad Set Budget Optimization) å¹¿å‘Šç»„é¢„ç®—ä¼˜åŒ– æ‰‹åŠ¨åˆ†é…å„å¹¿å‘Šç»„é¢„ç®— Meta æ‰‹åŠ¨æ§åˆ¶ Daily Budget æ¯æ—¥é¢„ç®— å•æ—¥é¢„ç®—ä¸Šé™ å¸¸è§„æŠ•æ”¾ Lifetime Budget ç”Ÿå‘½å‘¨æœŸé¢„ç®— æ•´ä¸ªå¹¿å‘Šå‘¨æœŸæ€»é¢„ç®— çŸ­æœŸæ´»åŠ¨ Shared Budget å…±äº«é¢„ç®— å¤šä¸ªå¹¿å‘Šç³»åˆ—å…±ç”¨é¢„ç®—æ±  å¤šè®¡åˆ’ååŒ Budget Reallocation é¢„ç®—é‡æ–°åˆ†é… æ ¹æ®è¡¨ç°åŠ¨æ€è½¬ç§»é¢„ç®— ä¼˜åŒ–é˜¶æ®µ Seasonal Budget Adjustment å­£èŠ‚æ€§é¢„ç®—è°ƒæ•´ æ ¹æ®ä¿ƒé”€&#x2F;èŠ‚æ—¥ä¸´æ—¶è°ƒæ•´é¢„ç®— ç”µå•†å¤§ä¿ƒ Budget Smoothing é¢„ç®—å¹³æ»‘ é¿å…é¢„ç®—æ¶ˆè€—æ³¢åŠ¨è¿‡å¤§ ç¨³å®šæŠ•æ”¾ Budget Guardrails é¢„ç®—æŠ¤æ  è®¾ç½®é¢„ç®—ä¸Šä¸‹é™ä¿æŠ¤ é£é™©æ§åˆ¶ Spend Cap èŠ±è´¹ä¸Šé™ è®¾ç½®æ€»èŠ±è´¹ç»å¯¹ä¸Šé™ é¢„ç®—ä¿æŠ¤ Minimum Spend æœ€ä½èŠ±è´¹ ç¡®ä¿é¢„ç®—æœ€ä½æ¶ˆè€— åˆçº¦å¹¿å‘Š Budget Flexibility é¢„ç®—çµæ´»æ€§ å…è®¸é¢„ç®—åœ¨ä¸€å®šèŒƒå›´å†…æµ®åŠ¨ æ™ºèƒ½æŠ•æ”¾ Cross-Campaign Budget è·¨ç³»åˆ—é¢„ç®— å¤šä¸ªå¹¿å‘Šç³»åˆ—å…±äº«é¢„ç®— æ•´åˆè¥é”€ Rolling Budget æ»šåŠ¨é¢„ç®— æœªä½¿ç”¨é¢„ç®—å¯æ»šå…¥ä¸‹ä¸€å‘¨æœŸ é•¿æœŸæŠ•æ”¾ å…­ã€é¢‘æ§ä¸æ›å…‰ç®¡ç† (Frequency & Exposure Management) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ Frequency Capping é¢‘æ¬¡æ§åˆ¶ é™åˆ¶ç”¨æˆ·å•ä½æ—¶é—´å†…çš„å¹¿å‘Šæ›å…‰æ¬¡æ•° å“ç‰Œå¹¿å‘Šã€é¿å…éªšæ‰° Recency Capping è¿‘æœŸé¢‘æ§ é™åˆ¶ç‰¹å®šæ—¶é—´çª—å£å†…çš„æ›å…‰æ¬¡æ•°ï¼Œå¦‚â€7 å¤©æœ€å¤š 3 æ¬¡â€ å†è¥é”€ã€è½¬åŒ–åç”¨æˆ· Global Frequency Cap å…¨å±€é¢‘æ§ è·¨å¹¿å‘Šç³»åˆ—&#x2F;è´¦æˆ·çº§åˆ«çš„é¢‘æ§ å¤šè®¡åˆ’ååŒæŠ•æ”¾ Per-User Frequency å•ç”¨æˆ·é¢‘æ§ é’ˆå¯¹å•ä¸ªç”¨æˆ·çš„æ›å…‰é™åˆ¶ ç²¾å‡†è¥é”€ Per-Session Frequency å•æ¬¡ä¼šè¯é¢‘æ§ ç”¨æˆ·å•æ¬¡è®¿é—®æœŸé—´çš„æ›å…‰é™åˆ¶ ç§»åŠ¨ç«¯ APP Daily Frequency Cap æ¯æ—¥é¢‘æ§ å•ç”¨æˆ·æ¯æ—¥æ›å…‰ä¸Šé™ å¸¸è§„æ§åˆ¶ Weekly Frequency Cap æ¯å‘¨é¢‘æ§ å•ç”¨æˆ·æ¯å‘¨æ›å…‰ä¸Šé™ é•¿æœŸæŠ•æ”¾ Monthly Frequency Cap æ¯æœˆé¢‘æ§ å•ç”¨æˆ·æ¯æœˆæ›å…‰ä¸Šé™ é•¿æœŸå“ç‰Œ Lifetime Frequency Cap ç”Ÿå‘½å‘¨æœŸé¢‘æ§ å•ç”¨æˆ·æ•´ä¸ªæ´»åŠ¨å‘¨æœŸæ›å…‰ä¸Šé™ çŸ­æœŸæ´»åŠ¨ Reach vs Frequency Trade-off è§¦è¾¾ä¸é¢‘æ¬¡æƒè¡¡ åœ¨è¦†ç›–æ›´å¤šç”¨æˆ· vs é‡å¤æ›å…‰ä¹‹é—´å¹³è¡¡ é¢„ç®—åˆ†é…ç­–ç•¥ Effective Frequency æœ‰æ•ˆé¢‘æ¬¡ è¾¾æˆè¥é”€ç›®æ ‡æ‰€éœ€çš„æœ€å°æ›å…‰æ¬¡æ•° åª’ä½“è®¡åˆ’ Frequency Distribution é¢‘æ¬¡åˆ†å¸ƒ åˆ†æä¸åŒæ›å…‰æ¬¡æ•°ç”¨æˆ·çš„å æ¯” æ•ˆæœåˆ†æ Optimal Frequency æœ€ä¼˜é¢‘æ¬¡ é€šè¿‡æµ‹è¯•æ‰¾åˆ°çš„æœ€ä½³æ›å…‰æ¬¡æ•° ä¼˜åŒ–ç›®æ ‡ Frequency Weighting é¢‘æ¬¡åŠ æƒ ä¸åŒæ›å…‰æ¬¡æ•°èµ‹äºˆä¸åŒæƒé‡ å½’å› åˆ†æ Cross-Platform Frequency è·¨å¹³å°é¢‘æ§ å¤šå¹³å°ç»Ÿä¸€é¢‘æ§ç®¡ç† å…¨æ¸ é“è¥é”€ Sequential Frequency åºåˆ—é¢‘æ§ æŒ‰ç”¨æˆ·æ—…ç¨‹é˜¶æ®µè®¾ç½®ä¸åŒé¢‘æ¬¡ æ¼æ–—è¥é”€ Dynamic Frequency åŠ¨æ€é¢‘æ§ æ ¹æ®ç”¨æˆ·è¡Œä¸ºåŠ¨æ€è°ƒæ•´é¢‘æ¬¡ æ™ºèƒ½ä¼˜åŒ– Negative Frequency è´Ÿå‘é¢‘æ§ è½¬åŒ–åé™ä½æˆ–åœæ­¢æ›å…‰ æ•ˆç‡ä¼˜åŒ– Incremental Frequency å¢é‡é¢‘æ§ ä»…è®¡ç®—å¢é‡æ›å…‰çš„é¢‘æ¬¡ å¢é‡åˆ†æ View-Through Frequency æµè§ˆé¢‘æ§ åŸºäºæµè§ˆè€Œéç‚¹å‡»çš„é¢‘æ§ å±•ç¤ºå¹¿å‘Š Engagement Frequency äº’åŠ¨é¢‘æ§ åŸºäºç”¨æˆ·äº’åŠ¨çš„é¢‘æ§ ç¤¾äº¤å¹¿å‘Š ä¸ƒã€å—ä¼—ä¸å®šå‘ç­–ç•¥ (Audience & Targeting Strategies) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ Lookalike Audience ç›¸ä¼¼äººç¾¤æ‰©å±• åŸºäºç§å­ç”¨æˆ·æ‰¾ç›¸ä¼¼äººç¾¤ æ‹‰æ–°ã€æ‰©é‡ Seed Audience Quality ç§å­å—ä¼—è´¨é‡ Lookalike çš„æ•ˆæœå–å†³äºç§å­ç”¨æˆ·è´¨é‡ äººç¾¤åŒ…ä¼˜åŒ– Lookalike Similarity % ç›¸ä¼¼åº¦ç™¾åˆ†æ¯” 1%-10% å¯é€‰ï¼Œè¶Šä½è¶Šç²¾å‡† äººç¾¤ç²¾åº¦è°ƒèŠ‚ 1% Lookalike 1% ç›¸ä¼¼äººç¾¤ æœ€ç›¸ä¼¼çš„å‰ 1% ç”¨æˆ· é«˜ç²¾åº¦å®šå‘ 10% Lookalike 10% ç›¸ä¼¼äººç¾¤ è¾ƒå¹¿æ³›çš„å‰ 10% ç”¨æˆ· æ‰©é‡å®šå‘ Retargeting&#x2F;Remarketing å†è¥é”€&#x2F;é‡å®šå‘ é’ˆå¯¹å·²æœ‰äº’åŠ¨ç”¨æˆ·å†æ¬¡æŠ•æ”¾ è½¬åŒ–æŒ½å› Dynamic Remarketing åŠ¨æ€å†è¥é”€ å±•ç¤ºç”¨æˆ·æµè§ˆè¿‡çš„å…·ä½“å•†å“ ç”µå•† Cart Abandonment Remarketing è´­ç‰©è½¦æ”¾å¼ƒå†è¥é”€ é’ˆå¯¹åŠ è´­æœªè´­ä¹°ç”¨æˆ· ç”µå•†æŒ½å› Browse Abandonment Remarketing æµè§ˆæ”¾å¼ƒå†è¥é”€ é’ˆå¯¹æµè§ˆæœªåŠ è´­ç”¨æˆ· ç”µå•†æŒ½å› Post-Purchase Remarketing è´­åå†è¥é”€ é’ˆå¯¹å·²è´­ä¹°ç”¨æˆ·äº¤å‰é”€å”® ç”µå•†å¤è´­ Exclusion Audience æ’é™¤å—ä¼— æ’é™¤å·²è½¬åŒ–&#x2F;ä½ä»·å€¼ç”¨æˆ· æ•ˆç‡ä¼˜åŒ– Customer Match å®¢æˆ·åŒ¹é… ä¸Šä¼ è‡ªæœ‰å®¢æˆ·æ•°æ®è¿›è¡Œå®šå‘ ç¬¬ä¸€æ–¹æ•°æ® In-Market Audience æ„å‘å—ä¼— é’ˆå¯¹æœ‰è´­ä¹°æ„å‘çš„ç”¨æˆ·ç¾¤ä½“ é«˜è½¬åŒ–æ„å‘ Affinity Audience å…´è¶£å—ä¼— åŸºäºé•¿æœŸå…´è¶£æ ‡ç­¾å®šå‘ å“ç‰Œæ›å…‰ Custom Affinity è‡ªå®šä¹‰å…´è¶£ è‡ªå®šä¹‰å…´è¶£æ ‡ç­¾å®šå‘ ç²¾ç»†å®šå‘ Predictive Audiences é¢„æµ‹æ€§å—ä¼— AI é¢„æµ‹é«˜è½¬åŒ–æ¦‚ç‡ç”¨æˆ· æ™ºèƒ½å®šå‘ Zero-Party Data é›¶æ–¹æ•°æ® ç”¨æˆ·ä¸»åŠ¨æä¾›çš„åå¥½æ•°æ® éšç§åˆè§„ First-Party Data ç¬¬ä¸€æ–¹æ•°æ® ä¼ä¸šè‡ªæœ‰ç”¨æˆ·æ•°æ® æ•°æ®èµ„äº§ Second-Party Data ç¬¬äºŒæ–¹æ•°æ® åˆä½œä¼™ä¼´å…±äº«æ•°æ® æ•°æ®åˆä½œ Third-Party Data ç¬¬ä¸‰æ–¹æ•°æ® æ•°æ®ä¾›åº”å•†æä¾›çš„æ•°æ® é€æ¸æ·˜æ±° Contextual Targeting ä¸Šä¸‹æ–‡å®šå‘ åŸºäºé¡µé¢å†…å®¹è€Œéç”¨æˆ·æ•°æ®å®šå‘ éšç§æ—¶ä»£ Semantic Targeting è¯­ä¹‰å®šå‘ åŸºäºå†…å®¹è¯­ä¹‰ç†è§£å®šå‘ é«˜çº§ä¸Šä¸‹æ–‡ Geo-Targeting åœ°ç†å®šå‘ åŸºäºåœ°ç†ä½ç½®ç²¾å‡†æŠ•æ”¾ æœ¬åœ°å•†å®¶ Geo-Fencing åœ°ç†å›´æ  ç‰¹å®šåœ°ç†åŒºåŸŸè§¦å‘å¹¿å‘ŠæŠ•æ”¾ çº¿ä¸‹å¼•æµ Geo-Conquesting åœ°ç†äº‰å¤º åœ¨ç«äº‰å¯¹æ‰‹ä½ç½®é™„è¿‘æŠ•æ”¾ ç«äº‰ç­–ç•¥ Radius Targeting åŠå¾„å®šå‘ ä»¥æŸç‚¹ä¸ºä¸­å¿ƒè®¾å®šåŠå¾„èŒƒå›´ æœ¬åœ°å•†å®¶ Location Groups ä½ç½®ç»„ æ‰¹é‡ç®¡ç†å¤šä¸ªåœ°ç†ä½ç½® è¿é”åº— Audience Overlap Check å—ä¼—é‡å æ£€æŸ¥ é¿å…å¤šä¸ªäººç¾¤åŒ…äº’ç›¸ç«äº‰ å¤šè®¡åˆ’æŠ•æ”¾ Audience Exclusion Layer å—ä¼—æ’é™¤å±‚ å±‚å±‚æ’é™¤å·²è½¬åŒ–&#x2F;ä½ä»·å€¼ç”¨æˆ· æ•ˆç‡ä¼˜åŒ– Custom Intent Audience è‡ªå®šä¹‰æ„å‘å—ä¼— åŸºäºæœç´¢è¡Œä¸ºè‡ªå®šä¹‰äººç¾¤ YouTube Life Event Targeting äººç”Ÿäº‹ä»¶å®šå‘ é’ˆå¯¹ç»“å©šã€æ¬å®¶ç­‰äººç”ŸèŠ‚ç‚¹ ç‰¹å®šå“ç±» Household Targeting å®¶åº­å®šå‘ ä»¥å®¶åº­ä¸ºå•ä½å®šå‘ CTVã€å®¶åº­æ¶ˆè´¹ Device Targeting è®¾å¤‡å®šå‘ é’ˆå¯¹æ‰‹æœº&#x2F;å¹³æ¿&#x2F;ç”µè„‘å®šå‘ å¤šè®¾å¤‡ OS&#x2F;Browser Targeting ç³»ç»Ÿ&#x2F;æµè§ˆå™¨å®šå‘ é’ˆå¯¹ç‰¹å®šæ“ä½œç³»ç»Ÿæˆ–æµè§ˆå™¨ æŠ€æœ¯å®šå‘ Connection Type Targeting ç½‘ç»œç±»å‹å®šå‘ WiFi&#x2F;4G&#x2F;5G ç­‰ä¸åŒç½‘ç»œç¯å¢ƒ ç§»åŠ¨ç«¯ Carrier Targeting è¿è¥å•†å®šå‘ é’ˆå¯¹ç‰¹å®šç§»åŠ¨è¿è¥å•† ç§»åŠ¨å¹¿å‘Š Behavioral Targeting è¡Œä¸ºå®šå‘ åŸºäºç”¨æˆ·è¡Œä¸ºå†å²å®šå‘ ç²¾å‡†è¥é”€ Psychographic Targeting å¿ƒç†å®šå‘ åŸºäºå¿ƒç†ç‰¹å¾å®šå‘ é«˜ç«¯å“ç‰Œ Intent Targeting æ„å‘å®šå‘ åŸºäºè´­ä¹°æ„å‘ä¿¡å·å®šå‘ é«˜è½¬åŒ– Moment Targeting æ—¶åˆ»å®šå‘ åŸºäºç‰¹å®šæ—¶åˆ»&#x2F;åœºæ™¯å®šå‘ åœºæ™¯è¥é”€ Weather Targeting å¤©æ°”å®šå‘ åŸºäºå¤©æ°”æ¡ä»¶å®šå‘ æœ¬åœ°æœåŠ¡ Event Targeting äº‹ä»¶å®šå‘ åŸºäºç‰¹æ®Šäº‹ä»¶å®šå‘ è¥é”€æ´»åŠ¨ å…«ã€åˆ›æ„ä¸å†…å®¹ä¼˜åŒ– (Creative & Content Optimization) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ Creative Fatigue åˆ›æ„ç–²åŠ³ åŒä¸€åˆ›æ„åå¤æ›å…‰å¯¼è‡´ CTR&#x2F;CVR ä¸‹é™ æ‰€æœ‰åˆ›æ„æŠ•æ”¾ Fatigue Detection ç–²åŠ³æ£€æµ‹ ç›‘æ§ CTR ä¸‹é™æ›²çº¿ï¼Œè¯†åˆ«ç–²åŠ³ç‚¹ åˆ›æ„ç®¡ç† Creative Refresh Rate åˆ›æ„æ›´æ–°é¢‘ç‡ å®šæœŸæ›´æ¢åˆ›æ„é¿å…ç–²åŠ³ é•¿æœŸæŠ•æ”¾ Creative Lifespan åˆ›æ„ç”Ÿå‘½å‘¨æœŸ å•ä¸ªåˆ›æ„çš„æœ‰æ•ˆæŠ•æ”¾æ—¶é•¿ ç´ æè§„åˆ’ DCO (Dynamic Creative Optimization) åŠ¨æ€åˆ›æ„ä¼˜åŒ– æ ¹æ®ç”¨æˆ·ç‰¹å¾å®æ—¶ç»„åˆåˆ›æ„å…ƒç´  ç¨‹åºåŒ–åˆ›æ„ Creative Element Testing åˆ›æ„å…ƒç´ æµ‹è¯• å•ç‹¬æµ‹è¯•æ ‡é¢˜&#x2F;å›¾ç‰‡&#x2F;CTA ç­‰å…ƒç´  A&#x2F;B æµ‹è¯• Ad Variation å¹¿å‘Šå˜ä½“ åŒä¸€å¹¿å‘Šçš„å¤šç‰ˆæœ¬è‡ªåŠ¨è½®æ’­æµ‹è¯• å¹³å°è‡ªåŠ¨æµ‹è¯• Responsive Ads è‡ªé€‚åº”å¹¿å‘Š ç³»ç»Ÿè‡ªåŠ¨ç»„åˆç´ æé€‚é…ä¸åŒç‰ˆä½ Google RSA Creative Rotation åˆ›æ„è½®æ’­ æ§åˆ¶å¤šä¸ªåˆ›æ„çš„å±•ç¤ºé¢‘ç‡å’Œé¡ºåº å¤šåˆ›æ„ç®¡ç† Optimize for Rotations ä¼˜åŒ–è½®æ’­ è‡ªåŠ¨ä¼˜åŒ–åˆ›æ„è½®æ’­ç­–ç•¥ æ™ºèƒ½åˆ›æ„ Personalization Engine ä¸ªæ€§åŒ–å¼•æ“ åŸºäºç”¨æˆ·è¡Œä¸ºç”Ÿæˆä¸ªæ€§åŒ–å¹¿å‘Šå†…å®¹ é«˜çº§å®šå‘ Generative AI Creative ç”Ÿæˆå¼ AI åˆ›æ„ AI ç”Ÿæˆæ–‡æ¡ˆ&#x2F;å›¾ç‰‡&#x2F;è§†é¢‘ç´ æ 2025-2026 è¶‹åŠ¿ Video Ad Optimization è§†é¢‘å¹¿å‘Šä¼˜åŒ– å‰ 5 ç§’ hookã€æ—¶é•¿ã€å­—å¹•ç­‰ä¼˜åŒ– è§†é¢‘å¹³å° Interactive Ads äº’åŠ¨å¹¿å‘Š å¯äº¤äº’çš„å¹¿å‘Šå½¢å¼æå‡å‚ä¸ ç¤¾äº¤åª’ä½“ Playable Ads è¯•ç©å¹¿å‘Š æ¸¸æˆç±»å¯äº’åŠ¨è¯•ç©å¹¿å‘Š æ¸¸æˆæ¨å¹¿ Shoppable Ads å¯è´­ç‰©å¹¿å‘Š ç›´æ¥ç‚¹å‡»è´­ä¹°çš„å•†å“å¹¿å‘Š ç”µå•† AR&#x2F;VR Ads å¢å¼º&#x2F;è™šæ‹Ÿç°å®å¹¿å‘Š æ²‰æµ¸å¼å¹¿å‘Šä½“éªŒ å‰æ²¿åº”ç”¨ 360 Video Ads 360 åº¦è§†é¢‘å¹¿å‘Š å…¨æ™¯è§†é¢‘å¹¿å‘Šä½“éªŒ æ²‰æµ¸å¼è¥é”€ Vertical Video ç«–ç‰ˆè§†é¢‘ é€‚é…ç§»åŠ¨ç«¯çš„ç«–ç‰ˆè§†é¢‘å¹¿å‘Š çŸ­è§†é¢‘å¹³å° Story Ads å¿«æ‹å¹¿å‘Š 24 å°æ—¶æ¶ˆå¤±çš„çŸ­è§†é¢‘å¹¿å‘Š Instagram&#x2F;Snapchat Collection Ads åˆé›†å¹¿å‘Š å±•ç¤ºå¤šä¸ªå•†å“çš„å¹¿å‘Šå½¢å¼ ç”µå•† Carousel Ads è½®æ’­å¹¿å‘Š å¯æ»‘åŠ¨å±•ç¤ºå¤šå¼ å›¾çš„å¹¿å‘Š ç¤¾äº¤&#x2F;æœç´¢ Lead Ads çº¿ç´¢å¹¿å‘Š ç›´æ¥åœ¨å¹¿å‘Šå†…æ”¶é›†çº¿ç´¢ ç¤¾äº¤åª’ä½“ Instant Experience å³æ—¶ä½“éªŒ ç§»åŠ¨ç«¯å…¨å±å¿«é€ŸåŠ è½½é¡µé¢ Facebook Canvas Ads ç”»å¸ƒå¹¿å‘Š ç§»åŠ¨ç«¯æ²‰æµ¸å¼å¹¿å‘Šä½“éªŒ Facebook ä¹ã€å…³é”®è¯ä¸æœç´¢ä¼˜åŒ– (Keyword & Search Optimization) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ Negative Keywords å¦å®šå…³é”®è¯ æ’é™¤ä¸ç›¸å…³æœç´¢ï¼Œå‡å°‘æµªè´¹ æœç´¢å¹¿å‘Š Negative Exact å¦å®šç²¾ç¡® ç²¾ç¡®åŒ¹é…å¦å®šå…³é”®è¯ æœç´¢å¹¿å‘Š Negative Phrase å¦å®šè¯ç»„ è¯ç»„åŒ¹é…å¦å®šå…³é”®è¯ æœç´¢å¹¿å‘Š Long-Tail Keywords é•¿å°¾å…³é”®è¯ ç«äº‰ä½ã€è½¬åŒ–é«˜çš„é•¿è¯ æœç´¢å¹¿å‘Š Broad Match å¹¿æ³›åŒ¹é… åŒ¹é…ç›¸å…³å˜ä½“å’ŒåŒä¹‰è¯ æœç´¢å¹¿å‘Š Broad Match Modifier å¹¿æ³›åŒ¹é…ä¿®é¥°ç¬¦ å¸¦ + å·çš„å¹¿æ³›åŒ¹é… Google(å·²æ·˜æ±°) Phrase Match è¯ç»„åŒ¹é… åŒ¹é…åŒ…å«è¯¥è¯ç»„çš„æœç´¢ æœç´¢å¹¿å‘Š Exact Match ç²¾ç¡®åŒ¹é… ä»…åŒ¹é…å®Œå…¨ç›¸åŒçš„æœç´¢ æœç´¢å¹¿å‘Š Close Variant è¿‘ä¼¼å˜ä½“ å…è®¸æ‹¼å†™é”™è¯¯ç­‰å˜ä½“ ç²¾ç¡®åŒ¹é…æ‰©å±• Search Term Report Analysis æœç´¢è¯æŠ¥å‘Šåˆ†æ å‘ç°æ–°å…³é”®è¯å’Œå¦å®šè¯æœºä¼š æœç´¢å¹¿å‘Šä¼˜åŒ– Keyword Expansion å…³é”®è¯æ‰©å±• æŒç»­å‘ç°æ–°çš„é«˜ä»·å€¼å…³é”®è¯ æŒç»­ä¼˜åŒ– Brand Protection Bidding å“ç‰Œä¿æŠ¤å‡ºä»· ç«ä»·å“ç‰Œè¯é˜²æ­¢ç«äº‰å¯¹æ‰‹æˆªæµ å“ç‰Œä¿æŠ¤ Competitor Keyword Bidding ç«å“è¯ç«ä»· ç«ä»·ç«äº‰å¯¹æ‰‹å“ç‰Œè¯ ç«äº‰ç­–ç•¥ Query Intent Matching æœç´¢æ„å›¾åŒ¹é… æ ¹æ®æœç´¢æ„å›¾åˆ†ç±»ä¼˜åŒ– æœç´¢å¹¿å‘Š Keyword Clustering å…³é”®è¯èšç±» å°†ç›¸ä¼¼å…³é”®è¯åˆ†ç»„ç®¡ç† è´¦æˆ·ç»“æ„ Quality Score Optimization è´¨é‡å¾—åˆ†ä¼˜åŒ– æå‡ Google è´¨é‡å¾—åˆ†é™ä½ CPC æœç´¢å¹¿å‘Š Keyword Gap Analysis å…³é”®è¯å·®è·åˆ†æ åˆ†æç«äº‰å¯¹æ‰‹å…³é”®è¯è¦†ç›– ç«äº‰åˆ†æ Seasonal Keywords å­£èŠ‚æ€§å…³é”®è¯ ç‰¹å®šå­£èŠ‚&#x2F;èŠ‚æ—¥çš„å…³é”®è¯ å­£èŠ‚æ€§è¥é”€ Local Keywords æœ¬åœ°å…³é”®è¯ åŒ…å«åœ°ç†ä½ç½®çš„å…³é”®è¯ æœ¬åœ° SEO&#x2F;SEM Voice Search Keywords è¯­éŸ³æœç´¢å…³é”®è¯ é€‚é…è¯­éŸ³æœç´¢çš„é•¿å°¾è¯ è¯­éŸ³æœç´¢ Visual Search Keywords è§†è§‰æœç´¢å…³é”®è¯ é€‚é…å›¾ç‰‡æœç´¢çš„å…³é”®è¯ è§†è§‰æœç´¢ Zero-Click Keywords é›¶ç‚¹å‡»å…³é”®è¯ ç›´æ¥åœ¨æœç´¢ç»“æœé¡µå±•ç¤ºç­”æ¡ˆ å“ç‰Œæ›å…‰ åã€è´¦æˆ·ç»“æ„ä¸å±‚çº§ä¼˜åŒ– (Account Structure Optimization) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ 5-Layer Structure äº”å±‚è´¦æˆ·ä½“ç³» Accountâ†’Campaignâ†’Ad Groupâ†’Adâ†’Keyword Google Ads SKAG (Single Keyword Ad Group) å•å…³é”®è¯å¹¿å‘Šç»„ æ¯ä¸ªå¹¿å‘Šç»„åªå« 1 ä¸ªæ ¸å¿ƒå…³é”®è¯ ç²¾ç»†æ§åˆ¶ STAG (Single Topic Ad Group) å•ä¸»é¢˜å¹¿å‘Šç»„ æ¯ä¸ªå¹¿å‘Šç»„å›´ç»• 1 ä¸ªä¸»é¢˜ ä¸»é¢˜ç®¡ç† SLAG (Single Landing Page Ad Group) å•è½åœ°é¡µå¹¿å‘Šç»„ æ¯ä¸ªå¹¿å‘Šç»„å¯¹åº” 1 ä¸ªè½åœ°é¡µ è½¬åŒ–ä¼˜åŒ– Campaign Segmentation å¹¿å‘Šç³»åˆ—ç»†åˆ† æŒ‰äº§å“&#x2F;åœ°åŸŸ&#x2F;è®¾å¤‡&#x2F;ç›®æ ‡æ‹†åˆ† è´¦æˆ·è§„åˆ’ Ad Group Consolidation å¹¿å‘Šç»„åˆå¹¶ å‡å°‘ç¢ç‰‡åŒ–ï¼Œæå‡æœºå™¨å­¦ä¹ æ•ˆç‡ æ™ºèƒ½å‡ºä»· Account Health Monitoring è´¦æˆ·å¥åº·ç›‘æ§ å®šæœŸæ£€æŸ¥è¿è§„ã€æ‹’å®¡ã€é™æµé—®é¢˜ è´¦æˆ·ç®¡ç† Policy Compliance Check æ”¿ç­–åˆè§„æ£€æŸ¥ ç¡®ä¿ç¬¦åˆå¹³å°å¹¿å‘Šæ”¿ç­– é£é™©é˜²æ§ Campaign Hierarchy å¹¿å‘Šç³»åˆ—å±‚çº§ åˆç†çš„è´¦æˆ·å±‚çº§ç»“æ„è®¾è®¡ è´¦æˆ·è§„åˆ’ Portfolio Structure ç»„åˆç»“æ„ å¤šè´¦æˆ·ç»Ÿä¸€ç®¡ç†çš„ç»“æ„ å¤§å‹ä¼ä¸š MCC (My Client Center) å®¢æˆ·ç®¡ç†ä¸­å¿ƒ Google å¤šè´¦æˆ·ç®¡ç† ä»£ç†å•† Business Manager å•†åŠ¡ç®¡ç†å¹³å° Meta å¤šè´¦æˆ·ç®¡ç† ä»£ç†å•† Account Linking è´¦æˆ·å…³è” å…³è”å¤šä¸ªå¹¿å‘Šå¹³å°è´¦æˆ· è·¨å¹³å°ç®¡ç† User Permission Management ç”¨æˆ·æƒé™ç®¡ç† ç®¡ç†è´¦æˆ·è®¿é—®æƒé™ å›¢é˜Ÿåä½œ Billing Structure è®¡è´¹ç»“æ„ è®¾ç½®è´¦æˆ·è®¡è´¹æ–¹å¼ è´¢åŠ¡ç®¡ç† Conversion Tracking Setup è½¬åŒ–è¿½è¸ªè®¾ç½® é…ç½®è½¬åŒ–è¿½è¸ªä»£ç  æ•ˆæœæµ‹é‡ Tag Management æ ‡ç­¾ç®¡ç† ç®¡ç†ç½‘ç«™è¿½è¸ªæ ‡ç­¾ æ•°æ®æ”¶é›† URL Parameter Structure URL å‚æ•°ç»“æ„ è®¾ç½®è¿½è¸ªå‚æ•°è§„èŒƒ æ•°æ®åˆ†æ Naming Convention å‘½åè§„èŒƒ ç»Ÿä¸€çš„è´¦æˆ·&#x2F;å¹¿å‘Šå‘½åè§„åˆ™ å›¢é˜Ÿç®¡ç† åä¸€ã€è´¨é‡å¾—åˆ†ä¸ç›¸å…³æ€§ (Quality Score & Relevance) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ Quality Score (QS) è´¨é‡å¾—åˆ† Google 1-10 åˆ†ï¼Œå½±å“æ’åå’Œ CPC Google æœç´¢ Expected CTR é¢„ä¼°ç‚¹å‡»ç‡ QS ä¸‰è¦ç´ ä¹‹ä¸€ï¼ŒåŸºäºå†å²è¡¨ç°é¢„æµ‹ Google Ads Ad Relevance å¹¿å‘Šç›¸å…³æ€§ QS ä¸‰è¦ç´ ä¹‹ä¸€ï¼Œå…³é”®è¯ä¸å¹¿å‘ŠåŒ¹é…åº¦ Google Ads Landing Page Experience ç€é™†é¡µä½“éªŒ QS ä¸‰è¦ç´ ä¹‹ä¸€ï¼Œé¡µé¢åŠ è½½&#x2F;å†…å®¹&#x2F;è½¬åŒ– Google Ads Ad Rank å¹¿å‘Šæ’å QSÃ—å‡ºä»·å†³å®šæœ€ç»ˆå±•ç¤ºä½ç½® Google Ads Keyword-Ad-Landing Consistency å…³é”®è¯ - å¹¿å‘Š - è½åœ°é¡µä¸€è‡´æ€§ ä¸‰è€…ä¸»é¢˜ä¸€è‡´æå‡ QS æœç´¢å¹¿å‘Š Ad Strength å¹¿å‘Šå¼ºåº¦ Google Responsive Search Ads è´¨é‡æŒ‡æ ‡ RSA å¹¿å‘Š Relevance Score ç›¸å…³æ€§å¾—åˆ† Meta å¹¿å‘Šè´¨é‡æŒ‡æ ‡ Meta Ads Quality Ranking è´¨é‡æ’å å¹¿å‘Šè´¨é‡ç›¸å¯¹äºå…¶ä»–å¹¿å‘Šçš„æ’å Meta Ads Engagement Rate Ranking äº’åŠ¨ç‡æ’å å¹¿å‘Šäº’åŠ¨ç‡ç›¸å¯¹äºå…¶ä»–å¹¿å‘Šçš„æ’å Meta Ads Conversion Rate Ranking è½¬åŒ–ç‡æ’å å¹¿å‘Šè½¬åŒ–ç‡ç›¸å¯¹äºå…¶ä»–å¹¿å‘Šçš„æ’å Meta Ads Historical Performance å†å²è¡¨ç° è´¦æˆ·å†å²è¡¨ç°å½±å“è´¨é‡å¾—åˆ† æ‰€æœ‰å¹³å° Account Level Quality è´¦æˆ·çº§è´¨é‡ æ•´ä½“è´¦æˆ·è´¨é‡å½±å“æ–°å¹¿å‘Š æ‰€æœ‰å¹³å° Domain Quality åŸŸåè´¨é‡ è½åœ°é¡µåŸŸåä¿¡èª‰å½±å“è´¨é‡ æœç´¢å¹¿å‘Š Page Load Speed é¡µé¢åŠ è½½é€Ÿåº¦ å½±å“ç€é™†é¡µä½“éªŒå¾—åˆ† æ‰€æœ‰å¹³å° Mobile Optimization ç§»åŠ¨ç«¯ä¼˜åŒ– ç§»åŠ¨ç«¯ä½“éªŒå½±å“è´¨é‡å¾—åˆ† ç§»åŠ¨å¹¿å‘Š Content Relevance å†…å®¹ç›¸å…³æ€§ å¹¿å‘Šå†…å®¹ä¸ç”¨æˆ·éœ€æ±‚åŒ¹é… æ‰€æœ‰å¹³å° User Experience Score ç”¨æˆ·ä½“éªŒå¾—åˆ† ç»¼åˆè¯„ä¼°ç”¨æˆ·ä½“éªŒ æ‰€æœ‰å¹³å° åäºŒã€å½’å› ä¸æ•ˆæœæµ‹é‡ (Attribution & Measurement) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ Last Click Attribution æœ€åç‚¹å‡»å½’å›  è½¬åŒ–å…¨éƒ¨å½’å› äºæœ€åä¸€æ¬¡ç‚¹å‡» ç”µå•†ä¿ƒé”€ First Click Attribution é¦–æ¬¡ç‚¹å‡»å½’å›  è½¬åŒ–å…¨éƒ¨å½’å› äºé¦–æ¬¡ç‚¹å‡» æ‹‰æ–°åˆ†æ Linear Attribution çº¿æ€§å½’å›  æ‰€æœ‰è§¦ç‚¹å¹³å‡åˆ†é…è´¡çŒ® å…¨æ¸ é“åˆ†æ Time Decay Attribution æ—¶é—´è¡°å‡å½’å›  è¶Šæ¥è¿‘è½¬åŒ–çš„è§¦ç‚¹æƒé‡è¶Šé«˜ çŸ­å‘¨æœŸè½¬åŒ– Position Based Attribution ä½ç½®å½’å›  é¦–å°¾è§¦ç‚¹æƒé‡é«˜ (å„ 40%)ï¼Œä¸­é—´ä½ (20%) å…¨æ¼æ–—åˆ†æ U-Shaped Attribution U å‹å½’å›  åŒä½ç½®å½’å›  å…¨æ¼æ–—åˆ†æ W-Shaped Attribution W å‹å½’å›  é¦–å°¾ + å•†æœºåˆ›å»ºç‚¹æƒé‡é«˜ B2B é”€å”® Full Path Attribution å…¨è·¯å¾„å½’å›  è€ƒè™‘å®Œæ•´ç”¨æˆ·è·¯å¾„ å¤æ‚æ—…ç¨‹ Data-Driven Attribution æ•°æ®é©±åŠ¨å½’å›  åŸºäºç®—æ³•è‡ªåŠ¨åˆ†é…å½’å› æƒé‡ Google Ads Multi-Touch Attribution å¤šè§¦ç‚¹å½’å›  åˆ†é…å„è§¦ç‚¹çš„è½¬åŒ–è´¡çŒ®æƒé‡ å…¨æ¸ é“è¥é”€ Markov Chain Attribution é©¬å°”å¯å¤«é“¾å½’å›  åŸºäºæ¦‚ç‡è½¬ç§»æ¨¡å‹å½’å›  é«˜çº§åˆ†æ Shapley Value Attribution æ²™æ™®åˆ©å€¼å½’å›  åŸºäºåšå¼ˆè®ºçš„å…¬å¹³å½’å›  å­¦æœ¯ç ”ç©¶ Algorithmic Attribution ç®—æ³•å½’å›  æœºå™¨å­¦ä¹ é©±åŠ¨çš„å½’å› æ¨¡å‹ å¤§å‹ä¼ä¸š Media Mix Modeling (MMM) åª’ä½“ç»„åˆæ¨¡å‹ åŸºäºç»Ÿè®¡å»ºæ¨¡çš„å½’å› æ–¹æ³• å®è§‚åˆ†æ Lift Testing å¢é‡æµ‹è¯• æµ‹é‡å¹¿å‘Šå¸¦æ¥çš„çœŸå®å¢é‡æ•ˆæœ æ•ˆæœéªŒè¯ Brand Lift Study å“ç‰Œæå‡ç ”ç©¶ è¡¡é‡å“ç‰Œè®¤çŸ¥&#x2F;å¥½æ„Ÿåº¦æå‡ å“ç‰Œå¹¿å‘Š Conversion Lift Study è½¬åŒ–æå‡ç ”ç©¶ è¡¡é‡å¹¿å‘Šå¯¹è½¬åŒ–çš„çœŸå®è´¡çŒ® æ•ˆæœå¹¿å‘Š Search Lift Study æœç´¢æå‡ç ”ç©¶ è¡¡é‡å¹¿å‘Šå¯¹å“ç‰Œæœç´¢çš„å½±å“ å“ç‰Œ + æ•ˆæœ Geo Lift Test åœ°ç†å¢é‡æµ‹è¯• é€šè¿‡åœ°ç†åŒºåŸŸå¯¹æ¯”æµ‹è¯•å¢é‡ å¤§èŒƒå›´æµ‹è¯• Ghost Ads å¹½çµå¹¿å‘Š æ§åˆ¶ç»„ä¸å±•ç¤ºå¹¿å‘Šç”¨äºå¢é‡æµ‹è¯• å¢é‡æµ‹é‡ Holdout Group å¯¹ç…§ç»„ ä¸æ¥æ”¶å¹¿å‘Šçš„å¯¹æ¯”ç»„ å¢é‡æµ‹è¯• Conversion Window è½¬åŒ–çª—å£ å®šä¹‰ç‚¹å‡»&#x2F;å±•ç¤ºåå½’å› çš„æ—¶é—´èŒƒå›´ å½’å› è®¾ç½® Click-Through Window ç‚¹å‡»è½¬åŒ–çª—å£ ç‚¹å‡»åå½’å› çš„æ—¶é—´èŒƒå›´ å½’å› è®¾ç½® View-Through Window æµè§ˆè½¬åŒ–çª—å£ å±•ç¤ºåå½’å› çš„æ—¶é—´èŒƒå›´ å½’å› è®¾ç½® Cross-Device Attribution è·¨è®¾å¤‡å½’å›  è¿½è¸ªç”¨æˆ·å¤šè®¾å¤‡è½¬åŒ–è·¯å¾„ å¤šè®¾å¤‡ç”¨æˆ· Offline Conversion Tracking çº¿ä¸‹è½¬åŒ–è¿½è¸ª å°†çº¿ä¸‹è¡Œä¸ºå…³è”åˆ°çº¿ä¸Šå¹¿å‘Š O2O ä¸šåŠ¡ Server-Side Tracking æœåŠ¡å™¨ç«¯è¿½è¸ª ç»•è¿‡æµè§ˆå™¨é™åˆ¶çš„è¿½è¸ªæ–¹å¼ éšç§æ—¶ä»£ Privacy Sandbox Compliance éšç§æ²™ç›’åˆè§„ é€‚é… Google éšç§æ²™ç›’æŠ€æœ¯ Chrome ç”Ÿæ€ SKAN (StoreKit Ad Network) è‹¹æœå¹¿å‘Šå½’å›  iOS éšç§æ¡†æ¶ä¸‹çš„å½’å› æ–¹æ¡ˆ iOS åº”ç”¨ SKAN 4.0 è‹¹æœå½’å›  4.0 SKAN å‡çº§ç‰ˆæœ¬ï¼Œæ”¯æŒå¤šè½¬åŒ–å€¼ iOS åº”ç”¨ MMP (Mobile Measurement Partner) ç§»åŠ¨æµ‹é‡åˆä½œä¼™ä¼´ AppsFlyer&#x2F;Adjust ç­‰å½’å› å¹³å° åº”ç”¨æ¨å¹¿ Viewability Measurement å¯è§åº¦æµ‹é‡ æµ‹é‡å¹¿å‘Šå®é™…å¯è§æ¯”ä¾‹ å±•ç¤ºå¹¿å‘Š MRC Standard MRC æ ‡å‡† åª’ä½“è¯„çº§å§”å‘˜ä¼šå¯è§åº¦æ ‡å‡† (50% åƒç´  1 ç§’) è¡Œä¸šæ ‡å‡† Invalid Traffic (IVT) æ— æ•ˆæµé‡ è¯†åˆ«å¹¶è¿‡æ»¤è™šå‡æµé‡ åä½œå¼Š General IVT ä¸€èˆ¬æ— æ•ˆæµé‡ å·²çŸ¥çš„æœºå™¨äºº&#x2F;æ¬ºè¯ˆæµé‡ åä½œå¼Š Sophisticated IVT å¤æ‚æ— æ•ˆæµé‡ éš¾ä»¥è¯†åˆ«çš„é«˜çº§æ¬ºè¯ˆæµé‡ åä½œå¼Š Ad Verification å¹¿å‘ŠéªŒè¯ ç¬¬ä¸‰æ–¹éªŒè¯å¹¿å‘Šå±•ç¤ºçœŸå®æ€§ å“ç‰Œå®‰å…¨ Brand Safety å“ç‰Œå®‰å…¨ é¿å…å¹¿å‘Šå‡ºç°åœ¨ä¸å½“å†…å®¹æ— å“ç‰Œä¿æŠ¤ Suitability å†…å®¹é€‚å®œæ€§ æ¯”å“ç‰Œå®‰å…¨æ›´ç»†ç²’åº¦çš„å†…å®¹æ§åˆ¶ ç²¾ç»†æ§åˆ¶ Attention Measurement æ³¨æ„åŠ›æµ‹é‡ æµ‹é‡ç”¨æˆ·å®é™…æ³¨æ„åŠ›æŠ•å…¥ æ•ˆæœè¯„ä¼° Dwell Time åœç•™æ—¶é—´ ç”¨æˆ·è§‚çœ‹å¹¿å‘Šçš„æ—¶é•¿ è§†é¢‘å¹¿å‘Š Active View ä¸»åŠ¨æµè§ˆ Google çš„å¯è§åº¦æµ‹é‡æŒ‡æ ‡ å±•ç¤ºå¹¿å‘Š åä¸‰ã€æŠ•æ”¾ç¯å¢ƒä¸åº“å­˜ä¼˜åŒ– (Inventory & Supply Optimization) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ DSP (Demand-Side Platform) éœ€æ±‚æ–¹å¹³å° å¹¿å‘Šä¸»è‡ªåŠ¨åŒ–è´­ä¹°å¹¿å‘Šåº“å­˜çš„ç³»ç»Ÿ ç¨‹åºåŒ–å¹¿å‘Š SSP (Supply-Side Platform) ä¾›åº”æ–¹å¹³å° åª’ä½“æ–¹ç®¡ç†ã€ä¼˜åŒ–å’Œå‡ºå”®å¹¿å‘Šåº“å­˜çš„ç³»ç»Ÿ åª’ä½“å˜ç° ADX&#x2F;Ad Exchange å¹¿å‘Šäº¤æ˜“å¹³å° è¿æ¥ SSP ä¸ DSP çš„å®æ—¶ç«ä»·å¹³å° ç¨‹åºåŒ–äº¤æ˜“ Ad Network å¹¿å‘Šç½‘ç»œ å°†å¤šä¸ªåª’ä½“æ–¹çš„åº“å­˜æ‰“åŒ…é”€å”® æµé‡èšåˆ Ad Server å¹¿å‘ŠæœåŠ¡å™¨ å­˜å‚¨ã€åˆ†å‘å’Œç»Ÿè®¡å¹¿å‘Šåˆ›æ„ å¹¿å‘ŠæŠ•æ”¾ DMP (Data Management Platform) æ•°æ®ç®¡ç†å¹³å° æ•´åˆå’Œç®¡ç†ç”¨æˆ·æ•°æ®çš„å¹³å° å—ä¼—å®šå‘ CDP (Customer Data Platform) å®¢æˆ·æ•°æ®å¹³å° æ•´åˆç¬¬ä¸€æ–¹å®¢æˆ·æ•°æ®çš„å¹³å° ç¬¬ä¸€æ–¹æ•°æ® CRM (Customer Relationship Management) å®¢æˆ·å…³ç³»ç®¡ç† ç®¡ç†å®¢æˆ·å…³ç³»çš„ç³»ç»Ÿ å®¢æˆ·ç®¡ç† Supply Path Optimization (SPO) ä¾›åº”è·¯å¾„ä¼˜åŒ– å‡å°‘ä¸­é—´ç¯èŠ‚ï¼Œæé«˜é¢„ç®—æ•ˆç‡ ç¨‹åºåŒ–è´­ä¹° Programmatic Guaranteed ç¨‹åºåŒ–æ‹…ä¿ æå‰é”å®šä¼˜è´¨å¹¿å‘Šåº“å­˜ å“ç‰Œå¹¿å‘Š Private Marketplace (PMP) ç§æœ‰äº¤æ˜“å¸‚åœº é‚€è¯·åˆ¶çš„ä¼˜è´¨æµé‡äº¤æ˜“ ä¼˜è´¨æµé‡ Preferred Deals ä¼˜å…ˆäº¤æ˜“ PMP çš„å›ºå®šä»·æ ¼ç‰ˆæœ¬ ä¼˜å…ˆè´­ä¹° Open Auction å…¬å¼€æ‹å– å¼€æ”¾çš„å®æ—¶ç«ä»·å¸‚åœº ç¨‹åºåŒ–å¹¿å‘Š Placement Exclusion ç‰ˆä½æ’é™¤ æ’é™¤ä½è´¨é‡&#x2F;ä¸ç›¸å…³å±•ç¤ºä½ç½® å“ç‰Œå®‰å…¨ Inventory Quality Score åº“å­˜è´¨é‡è¯„åˆ† è¯„ä¼°æµé‡æ¥æºçš„å¯ä¿¡åº¦ æµé‡ç­›é€‰ Brand Safety Controls å“ç‰Œå®‰å…¨æ§åˆ¶ é¿å…å¹¿å‘Šå‡ºç°åœ¨ä¸å½“å†…å®¹æ— å“ç‰Œä¿æŠ¤ Suitability Controls å†…å®¹é€‚å®œæ€§æ§åˆ¶ æ¯”å“ç‰Œå®‰å…¨æ›´ç»†ç²’åº¦çš„å†…å®¹æ§åˆ¶ ç²¾ç»†æ§åˆ¶ Viewability Optimization å¯è§åº¦ä¼˜åŒ– ç¡®ä¿å¹¿å‘Šåœ¨å¯è§†åŒºåŸŸå†…å±•ç¤º å±•ç¤ºæ•ˆæœ Fraud Prevention åä½œå¼Š è¯†åˆ«å¹¶è¿‡æ»¤è™šå‡æµé‡ é¢„ç®—ä¿æŠ¤ Ads.txt æˆæƒå–å®¶æ–‡æœ¬ é˜²æ­¢åŸŸåæ¬ºéª—çš„è®¤è¯æ–‡ä»¶ ç¨‹åºåŒ–å¹¿å‘Š App-ads.txt åº”ç”¨æˆæƒå–å®¶æ–‡æœ¬ ç§»åŠ¨åº”ç”¨çš„ ads.txt ç‰ˆæœ¬ ç§»åŠ¨å¹¿å‘Š Sellers.json å–å®¶ä¿¡æ¯æ–‡ä»¶ é€æ˜åŒ–å¹¿å‘Šä¾›åº”é“¾ ç¨‹åºåŒ–é€æ˜ OMID (Open Measurement SDK) å¼€æ”¾æµ‹é‡ SDK è·¨å¹³å°å¹¿å‘Šå¯è§åº¦æµ‹é‡æ ‡å‡† æµ‹é‡æ ‡å‡† Pre-bid ç«å‰è¿‡æ»¤ ç«ä»·å‰è¿‡æ»¤ä½è´¨æµé‡ ç¨‹åºåŒ–è´­ä¹° Post-bid ç«åè¿‡æ»¤ ç«ä»·åè¿‡æ»¤ä½è´¨æµé‡ ç¨‹åºåŒ–è´­ä¹° Blocklist é»‘åå• æ’é™¤çš„ç½‘ç«™&#x2F;åº”ç”¨åˆ—è¡¨ å“ç‰Œå®‰å…¨ Whitelist ç™½åå• å…è®¸çš„ç½‘ç«™&#x2F;åº”ç”¨åˆ—è¡¨ ä¼˜è´¨æµé‡ Graylist ç°åå• éœ€è¦å®¡æŸ¥çš„ç½‘ç«™&#x2F;åº”ç”¨åˆ—è¡¨ é£é™©æ§åˆ¶ Category Exclusion ç±»åˆ«æ’é™¤ æ’é™¤ç‰¹å®šå†…å®¹ç±»åˆ« å“ç‰Œå®‰å…¨ Keyword Blocking å…³é”®è¯å±è”½ å±è”½åŒ…å«ç‰¹å®šå…³é”®è¯çš„é¡µé¢ å“ç‰Œå®‰å…¨ Sentiment Analysis æƒ…æ„Ÿåˆ†æ åˆ†æé¡µé¢å†…å®¹æƒ…æ„Ÿå€¾å‘ å“ç‰Œå®‰å…¨ åå››ã€ç«äº‰ä¸å¸‚åœºç­–ç•¥ (Competitive & Market Strategy) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ Share of Voice (SOV) å£°éŸ³ä»½é¢ ä½ çš„å¹¿å‘Šå±•ç¤ºå å¸‚åœºæ€»å±•ç¤ºçš„æ¯”ä¾‹ å“ç‰Œç›‘æµ‹ Share of Search æœç´¢ä»½é¢ å“ç‰Œæœç´¢é‡å å“ç±»æ€»æœç´¢é‡çš„æ¯”ä¾‹ å“ç‰Œå¥åº· Share of Wallet é’±åŒ…ä»½é¢ å“ç‰Œæ”¯å‡ºå ç”¨æˆ·æ€»æ”¯å‡ºçš„æ¯”ä¾‹ å®¢æˆ·ä»·å€¼ Competitor Bid Monitoring ç«å“å‡ºä»·ç›‘æ§ è¿½è¸ªç«äº‰å¯¹æ‰‹å‡ºä»·ç­–ç•¥ ç«äº‰æƒ…æŠ¥ Auction Insights ç«ä»·æ´å¯Ÿ Google æä¾›çš„ç«äº‰å¯¹æ‰‹å¯¹æ¯”æ•°æ® Google Ads Market Penetration Bidding å¸‚åœºæ¸—é€å‡ºä»· æ¿€è¿›å‡ºä»·æŠ¢å å¸‚åœºä»½é¢ æ‰©å¼ æœŸ Defensive Bidding é˜²å¾¡æ€§å‡ºä»· ä¿æŠ¤ç°æœ‰å¸‚åœºä»½é¢ æˆç†ŸæœŸ Category Mindset Monopoly å“ç±»å¿ƒæ™ºå„æ–­ é€šè¿‡é«˜é¢‘æ›å…‰å æ®ç”¨æˆ·å¿ƒæ™º å“ç‰Œé¢†å¯¼ Competitor Targeting ç«å“å®šå‘ å®šå‘ç«äº‰å¯¹æ‰‹çš„å—ä¼— ç«äº‰ç­–ç•¥ Conquesting Campaign äº‰å¤º campaign ä¸»åŠ¨äº‰å¤ºç«äº‰å¯¹æ‰‹å®¢æˆ· æ¿€è¿›ç­–ç•¥ Price Matching ä»·æ ¼åŒ¹é… åŒ¹é…ç«äº‰å¯¹æ‰‹ä»·æ ¼ ç”µå•†ç«äº‰ Bid to Beat è¶…è¶Šå‡ºä»· è®¾ç½®å‡ºä»·ä»¥è¶…è¶Šç‰¹å®šç«äº‰å¯¹æ‰‹ ç«äº‰ç­–ç•¥ Market Share Goal å¸‚åœºä»½é¢ç›®æ ‡ ä»¥å¸‚åœºä»½é¢ä¸ºä¼˜åŒ–ç›®æ ‡ æ‰©å¼ ç­–ç•¥ Competitive Intelligence ç«äº‰æƒ…æŠ¥ æ”¶é›†åˆ†æç«äº‰å¯¹æ‰‹ä¿¡æ¯ æˆ˜ç•¥è§„åˆ’ åäº”ã€å¹³å°ç‰¹å®šç­–ç•¥ (Platform-Specific Strategies) å¹³å° ç‰¹æœ‰ç­–ç•¥&#x2F;åŠŸèƒ½ è¯´æ˜ Google Ads Quality Scoreã€RSAã€PMaxã€DSAã€Performance Max æœç´¢ + å±•ç¤º + è§†é¢‘ + è´­ç‰©å…¨æ¸ é“ Meta Ads Advantage+ã€CBOã€åŠ¨æ€åˆ›æ„ã€åƒç´ ã€Conversions API ç¤¾äº¤+ins+audience network Amazon Ads SP&#x2F;SB&#x2F;SD å¹¿å‘Šã€ACOS ä¼˜åŒ–ã€å“ç‰Œæ——èˆ°åº—ã€DSP ç”µå•†ç«™å†…å¹¿å‘Š TikTok Ads Spark Adsã€TopViewã€å“ç‰ŒæŒ‘æˆ˜èµ›ã€Pangleã€Pangle MAX çŸ­è§†é¢‘åŸç”Ÿå¹¿å‘Š å¾®ä¿¡å¹¿å‘Š æœ‹å‹åœˆç¬¬äº”æ¡ã€å°ç¨‹åºå¹¿å‘Šã€ä¼ä¸šå¾®ä¿¡å¼•æµã€è§†é¢‘å·å¹¿å‘Š ç¤¾äº¤ç”Ÿæ€å†…å¹¿å‘Š æŠ–éŸ³&#x2F;å·¨é‡å¼•æ“ oCPMã€DOU+ã€æ˜Ÿå›¾ã€åƒå·ã€æ·±åº¦è½¬åŒ–å‡ºä»· çŸ­è§†é¢‘ + ç›´æ’­ç”µå•† LinkedIn Ads èŒä¸šå®šå‘ã€Lead Gen Formsã€Matched Audiencesã€ABM B2B ä¸“ä¸šç½‘ç»œå¹¿å‘Š Pinterest Ads è´­ç‰©å¹¿å‘Šã€çµæ„Ÿå®šå‘ã€Actalikeã€Collection Ads è§†è§‰å‘ç°å¹³å°å¹¿å‘Š Snapchat Ads AR æ»¤é•œå¹¿å‘Šã€Story å¹¿å‘Šã€Dynamic Ads å¹´è½»ç”¨æˆ·ç¤¾äº¤å¹¿å‘Š Twitter&#x2F;X Ads æ¨æ–‡æ¨å¹¿ã€è¶‹åŠ¿è¯é¢˜ã€Fleet å¹¿å‘Šã€Conversation Ads å®æ—¶ç¤¾äº¤å¹¿å‘Š Reddit Ads ç¤¾åŒºå®šå‘ã€å…´è¶£å®šå‘ã€Promoted Posts ç¤¾åŒºè®¨è®ºå¹³å°å¹¿å‘Š Quora Ads é—®é¢˜å®šå‘ã€è¯é¢˜å®šå‘ã€Promoted Answers é—®ç­”å¹³å°å¹¿å‘Š Bing Ads ç±»ä¼¼ Google ä½†ç«äº‰è¾ƒä½ã€LinkedIn å®šå‘æ•´åˆ å¾®è½¯æœç´¢å¹¿å‘Š Apple Search Ads ASAã€æœç´¢æ ‡ç­¾å¹¿å‘Šã€Product Pages iOS åº”ç”¨æœç´¢å¹¿å‘Š å¿«æ‰‹å¹¿å‘Š ç£åŠ›å¼•æ“ã€ç²‰æ¡ã€å°åº—é€šã€ç”Ÿæˆå¼å¼ºåŒ–å­¦ä¹ å‡ºä»· çŸ­è§†é¢‘è€é“ç»æµ B ç«™å¹¿å‘Š èŠ±ç«å¹³å°ã€ä¿¡æ¯æµã€UP ä¸»åˆä½œã€èµ·é£ Z ä¸–ä»£è§†é¢‘ç¤¾åŒº å°çº¢ä¹¦å¹¿å‘Š ä¿¡æ¯æµã€æœç´¢å¹¿å‘Šã€å“ç‰Œå·ã€ç§è‰æŒ‡æ•°ã€èšå…‰å¹³å° ç”Ÿæ´»æ–¹å¼ç¤¾åŒº YouTube Ads TrueViewã€Bumperã€Mastheadã€Shorts å¹¿å‘Š è§†é¢‘å¹³å°å¹¿å‘Š Connected TV ç¨‹åºåŒ– CTVã€åœ°å€able TVã€è·¨å±å½’å›  è”ç½‘ç”µè§†å¹¿å‘Š åå…­ã€ç”µå•†ä¸åº”ç”¨ç‰¹æœ‰ç­–ç•¥ (E-commerce & App Specific) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ ACOS (Advertising Cost of Sales) å¹¿å‘Šé”€å”®æˆæœ¬æ¯” äºšé©¬é€Šå¹¿å‘Šæ ¸å¿ƒæŒ‡æ ‡ (å¹¿å‘ŠèŠ±è´¹&#x2F;å¹¿å‘Šé”€å”®é¢) Amazon Ads TACOS (Total ACOS) æ€»å¹¿å‘Šé”€å”®æˆæœ¬æ¯” å¹¿å‘ŠèŠ±è´¹å æ€»é”€å”®é¢æ¯”ä¾‹ Amazon Ads ROAS (Return on Ad Spend) å¹¿å‘Šæ”¯å‡ºå›æŠ¥ç‡ å¹¿å‘Šæ”¶å…¥&#x2F;å¹¿å‘ŠèŠ±è´¹ é€šç”¨ç”µå•† MER (Marketing Efficiency Ratio) è¥é”€æ•ˆç‡æ¯” æ€»æ”¶å…¥&#x2F;æ€»è¥é”€èŠ±è´¹ æ•´ä½“è¥é”€ Product Rating Impact å•†å“è¯„åˆ†å½±å“ è¯„åˆ†å½±å“å¹¿å‘Šæ’åºå’Œè½¬åŒ– ç”µå•†å¹¿å‘Š Return Rate Optimization é€€è´§ç‡ä¼˜åŒ– é™ä½é€€è´§æå‡å¹¿å‘Šæ•ˆç›Š ç”µå•†è¿è¥ Cart Abandonment Remarketing è´­ç‰©è½¦æ”¾å¼ƒå†è¥é”€ é’ˆå¯¹åŠ è´­æœªè´­ä¹°ç”¨æˆ· ç”µå•†æŒ½å› Product Feed Optimization å•†å“ feed ä¼˜åŒ– ä¼˜åŒ–å•†å“ä¿¡æ¯æå‡è´­ç‰©å¹¿å‘Šæ•ˆæœ è´­ç‰©å¹¿å‘Š App Store Optimization (ASO) åº”ç”¨å•†åº—ä¼˜åŒ– ä¸åº”ç”¨å¹¿å‘ŠååŒä¼˜åŒ– åº”ç”¨æ¨å¹¿ SKAN (StoreKit Ad Network) è‹¹æœå¹¿å‘Šå½’å›  iOS éšç§æ¡†æ¶ä¸‹çš„å½’å› æ–¹æ¡ˆ iOS åº”ç”¨ ATT (App Tracking Transparency) åº”ç”¨è¿½è¸ªé€æ˜åº¦ iOS ç”¨æˆ·æˆæƒè¿½è¸ªæ¡†æ¶ iOS éšç§ Deep Linking æ·±åº¦é“¾æ¥ ç›´æ¥è·³è½¬åˆ° APP å†…ç‰¹å®šé¡µé¢ åº”ç”¨æ¨å¹¿ Deferred Deep Linking å»¶è¿Ÿæ·±åº¦é“¾æ¥ å®‰è£…åè·³è½¬åˆ°ç‰¹å®šé¡µé¢ åº”ç”¨æ¨å¹¿ Install Referrer å®‰è£…æ¥æºè¿½è¸ª Android åº”ç”¨å®‰è£…æ¥æºè¿½è¸ª Android åº”ç”¨ App Event Optimization åº”ç”¨äº‹ä»¶ä¼˜åŒ– ä¼˜åŒ–ç‰¹å®šåº”ç”¨å†…äº‹ä»¶ åº”ç”¨å¹¿å‘Š Re-engagement Campaign å†äº’åŠ¨æ´»åŠ¨ å”¤é†’æ²‰ç¡ç”¨æˆ· åº”ç”¨ç•™å­˜ App Install Campaign åº”ç”¨å®‰è£…æ´»åŠ¨ è·å–æ–°ç”¨æˆ·å®‰è£… åº”ç”¨æ‹‰æ–° åä¸ƒã€å†·å¯åŠ¨ä¸å­¦ä¹ æœŸç®¡ç† (Cold Start & Learning Phase) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ Cold Start Problem å†·å¯åŠ¨é—®é¢˜ æ–°è®¡åˆ’æ— å†å²æ•°æ®ï¼Œæ¨¡å‹æ— æ³•é¢„ä¼° æ–°å¹¿å‘Š&#x2F;æ–°è´¦æˆ· Learning Phase å­¦ä¹ æœŸ æ–°è®¡åˆ’éœ€è¦ç§¯ç´¯ä¸€å®šè½¬åŒ–æ‰èƒ½ç¨³å®š Meta&#x2F;Google ç­‰ Learning Phase Exit å­¦ä¹ æœŸé€€å‡º ç§¯ç´¯è¶³å¤Ÿæ•°æ®åè¿›å…¥ç¨³å®šæœŸ é€šå¸¸ 50+ è½¬åŒ– Learning Limited å­¦ä¹ å—é™ è½¬åŒ–é‡ä¸è¶³å¯¼è‡´æ— æ³•é€€å‡ºå­¦ä¹ æœŸ ä¼˜åŒ–è­¦ç¤º Learning Reset å­¦ä¹ é‡ç½® å¤§å¹…ä¿®æ”¹å¯¼è‡´é‡æ–°è¿›å…¥å­¦ä¹ æœŸ ä¼˜åŒ–æ³¨æ„ Warm Start Strategy çƒ­å¯åŠ¨ç­–ç•¥ å€Ÿç”¨è€è®¡åˆ’æ•°æ®åŠ é€Ÿæ–°è®¡åˆ’å­¦ä¹  æ‰©é‡åœºæ™¯ Transfer Learning è¿ç§»å­¦ä¹  å°†å·²æœ‰æ¨¡å‹çŸ¥è¯†è¿ç§»åˆ°æ–°åœºæ™¯ AI è¿›é˜¶åº”ç”¨ Exploration vs Exploitation æ¢ç´¢ä¸åˆ©ç”¨æƒè¡¡ åœ¨æµ‹è¯•æ–°æ–¹å‘ vs ä¼˜åŒ–å·²çŸ¥æœ‰æ•ˆä¹‹é—´å¹³è¡¡ æ‰€æœ‰æ™ºèƒ½ç³»ç»Ÿ Multi-Armed Bandit å¤šè‡‚è€è™æœº å¹³è¡¡æ¢ç´¢ä¸åˆ©ç”¨çš„ç®—æ³•ç­–ç•¥ æ™ºèƒ½ä¼˜åŒ– Thompson Sampling æ±¤æ™®æ£®é‡‡æ · åŸºäºè´å¶æ–¯çš„å¤šè‡‚è€è™æœºç®—æ³• æ™ºèƒ½ä¼˜åŒ– Upper Confidence Bound ç½®ä¿¡ä¸Šé™ å¦ä¸€ç§å¤šè‡‚è€è™æœºç®—æ³• æ™ºèƒ½ä¼˜åŒ– A&#x2F;B&#x2F;n Testing A&#x2F;B&#x2F;n æµ‹è¯• åŒæ—¶æµ‹è¯•å¤šä¸ªå˜ä½“ åˆ›æ„&#x2F;è½åœ°é¡µ Multivariate Testing å¤šå˜é‡æµ‹è¯• åŒæ—¶æµ‹è¯•å¤šä¸ªå˜é‡çš„ç»„åˆ é«˜çº§æµ‹è¯• Sequential Testing åºè´¯æµ‹è¯• æŒ‰é¡ºåºè¿›è¡Œæµ‹è¯• èµ„æºæœ‰é™ Bayesian Testing è´å¶æ–¯æµ‹è¯• åŸºäºè´å¶æ–¯ç»Ÿè®¡çš„æµ‹è¯•æ–¹æ³• é«˜çº§åˆ†æ åå…«ã€æ—¶é—´ä¸ç©ºé—´ä¼˜åŒ– (Time & Space Optimization) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ Dayparting æ—¶æ®µä¼˜åŒ– ç‰¹å®šæ—¶é—´æ®µæŠ•æ”¾&#x2F;è°ƒæ•´å‡ºä»· æ‰€æœ‰å¹³å° Ad Scheduling å¹¿å‘ŠæŠ•æ”¾æ—¶é—´è¡¨ è®¾ç½®å¹¿å‘Šå±•ç¤ºçš„å…·ä½“æ—¶é—´ Google Ads Time Zone Optimization æ—¶åŒºä¼˜åŒ– æ ¹æ®ç›®æ ‡æ—¶åŒºä¼˜åŒ–æŠ•æ”¾æ—¶é—´ è·¨å›½æŠ•æ”¾ Seasonal Timing å­£èŠ‚æ€§æ—¶æœº æ ¹æ®å­£èŠ‚è°ƒæ•´æŠ•æ”¾ç­–ç•¥ å­£èŠ‚æ€§äº§å“ Real-Time Optimization å®æ—¶ä¼˜åŒ– åŸºäºå®æ—¶æ•°æ®è°ƒæ•´ç­–ç•¥ ç¨‹åºåŒ–å¹¿å‘Š Geo-Targeting åœ°ç†å®šå‘ åŸºäºåœ°ç†ä½ç½®ç²¾å‡†æŠ•æ”¾ æœ¬åœ°&#x2F;å…¨å›½ Geo-Fencing åœ°ç†å›´æ  ç‰¹å®šåœ°ç†åŒºåŸŸè§¦å‘å¹¿å‘ŠæŠ•æ”¾ çº¿ä¸‹å¼•æµ Geo-Conquesting åœ°ç†äº‰å¤º åœ¨ç«äº‰å¯¹æ‰‹ä½ç½®é™„è¿‘æŠ•æ”¾ ç«äº‰ç­–ç•¥ Radius Targeting åŠå¾„å®šå‘ ä»¥æŸç‚¹ä¸ºä¸­å¿ƒè®¾å®šåŠå¾„èŒƒå›´ æœ¬åœ°å•†å®¶ Location Groups ä½ç½®ç»„ æ‰¹é‡ç®¡ç†å¤šä¸ªåœ°ç†ä½ç½® è¿é”åº— Device Targeting è®¾å¤‡å®šå‘ é’ˆå¯¹æ‰‹æœº&#x2F;å¹³æ¿&#x2F;ç”µè„‘å®šå‘ å¤šè®¾å¤‡ OS&#x2F;Browser Targeting ç³»ç»Ÿ&#x2F;æµè§ˆå™¨å®šå‘ é’ˆå¯¹ç‰¹å®šæ“ä½œç³»ç»Ÿæˆ–æµè§ˆå™¨ æŠ€æœ¯å®šå‘ Connection Type Targeting ç½‘ç»œç±»å‹å®šå‘ WiFi&#x2F;4G&#x2F;5G ç­‰ä¸åŒç½‘ç»œç¯å¢ƒ ç§»åŠ¨ç«¯ Carrier Targeting è¿è¥å•†å®šå‘ é’ˆå¯¹ç‰¹å®šç§»åŠ¨è¿è¥å•† ç§»åŠ¨å¹¿å‘Š IP Targeting IP å®šå‘ é’ˆå¯¹ç‰¹å®š IP åœ°å€å®šå‘ B2B&#x2F;ä¼ä¸š ZIP Code Targeting é‚®ç¼–å®šå‘ é’ˆå¯¹ç‰¹å®šé‚®ç¼–åŒºåŸŸå®šå‘ æœ¬åœ°è¥é”€ åä¹ã€2025-2026 æ–°å…´è¶‹åŠ¿ (Emerging Trends 2025-2026) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ Generative Reinforcement Learning Bidding ç”Ÿæˆå¼å¼ºåŒ–å­¦ä¹ å‡ºä»· ç»“åˆç”Ÿæˆæ¨¡å‹å’Œå¼ºåŒ–å­¦ä¹ çš„å‡ºä»·æŠ€æœ¯ å¿«æ‰‹ç­‰å‰æ²¿å¹³å° AI Agent Bidding AI ä»£ç†å‡ºä»· è‡ªä¸» AI ä»£ç†æ‰§è¡Œå¤æ‚å‡ºä»·å†³ç­– å‰æ²¿åº”ç”¨ Generative AI Creative ç”Ÿæˆå¼ AI åˆ›æ„ AI ç”Ÿæˆæ–‡æ¡ˆ&#x2F;å›¾ç‰‡&#x2F;è§†é¢‘ç´ æ åˆ›æ„ç”Ÿäº§ Privacy-Preserving Tech éšç§ä¿æŠ¤æŠ€æœ¯ è”é‚¦å­¦ä¹ ã€å·®åˆ†éšç§ç­‰åˆè§„æŠ€æœ¯ éšç§åˆè§„ Federated Learning è”é‚¦å­¦ä¹  æ•°æ®ä¸å‡ºæœ¬åœ°çš„åˆ†å¸ƒå¼å­¦ä¹  éšç§æŠ€æœ¯ Differential Privacy å·®åˆ†éšç§ æ·»åŠ å™ªå£°ä¿æŠ¤ä¸ªä½“éšç§ éšç§æŠ€æœ¯ First-Party Data Strategy ç¬¬ä¸€æ–¹æ•°æ®ç­–ç•¥ æ„å»ºè‡ªæœ‰æ•°æ®èµ„äº§å‡å°‘ä¾èµ–ç¬¬ä¸‰æ–¹ æ•°æ®æˆ˜ç•¥ Cross-Channel Orchestration è·¨æ¸ é“ååŒ å¤šæ¸ é“é¢„ç®—å’Œç­–ç•¥ç»Ÿä¸€ä¼˜åŒ– å…¨æ¸ é“è¥é”€ Real-Time Creative Optimization å®æ—¶åˆ›æ„ä¼˜åŒ– æ ¹æ®å®æ—¶åé¦ˆåŠ¨æ€è°ƒæ•´åˆ›æ„ åŠ¨æ€åˆ›æ„ Cookieless Targeting æ—  Cookie å®šå‘ é€‚åº”å Cookie æ—¶ä»£çš„å®šå‘æ–¹æ¡ˆ éšç§æ—¶ä»£ Connected TV (CTV) Optimization è”ç½‘ç”µè§†å¹¿å‘Šä¼˜åŒ– OTT&#x2F;CTV å¹³å°å¹¿å‘Šç­–ç•¥ ç”µè§†å¹¿å‘Š Retail Media Network é›¶å”®åª’ä½“ç½‘ç»œ ç”µå•†å¹³å°ç«™å†…å¹¿å‘Šç½‘ç»œ ç”µå•†å¹¿å‘Š Influencer Ads Integration ç½‘çº¢å¹¿å‘Šæ•´åˆ ç½‘çº¢å†…å®¹ä¸ä»˜è´¹å¹¿å‘ŠååŒ ç¤¾äº¤è¥é”€ Shoppable Video å¯è´­ç‰©è§†é¢‘ è§†é¢‘ä¸­ç›´æ¥è´­ä¹° è§†é¢‘ç”µå•† Live Commerce Ads ç›´æ’­ç”µå•†å¹¿å‘Š ç›´æ’­é—´å¼•æµå’Œè½¬åŒ– ç›´æ’­ç”µå•† Voice Search Ads è¯­éŸ³æœç´¢å¹¿å‘Š é’ˆå¯¹è¯­éŸ³æœç´¢çš„å¹¿å‘Š æ™ºèƒ½éŸ³ç®± Metaverse Ads å…ƒå®‡å®™å¹¿å‘Š è™šæ‹Ÿä¸–ç•Œä¸­çš„å¹¿å‘Šå½¢å¼ å‰æ²¿æ¢ç´¢ Blockchain Ad Verification åŒºå—é“¾å¹¿å‘ŠéªŒè¯ ç”¨åŒºå—é“¾éªŒè¯å¹¿å‘Šå±•ç¤ºçœŸå®æ€§ åä½œå¼Š Neural Network Bidding ç¥ç»ç½‘ç»œå‡ºä»· åŸºäºæ·±åº¦å­¦ä¹ çš„å‡ºä»·æ¨¡å‹ AI ä¼˜åŒ– Transformer-Based Bidding Transformer å‡ºä»· åŸºäº Transformer æ¶æ„çš„å‡ºä»·æ¨¡å‹ å‰æ²¿ AI Multi-Modal AI å¤šæ¨¡æ€ AI ç»“åˆæ–‡æœ¬&#x2F;å›¾åƒ&#x2F;è§†é¢‘çš„ AI ä¼˜åŒ– åˆ›æ„ä¼˜åŒ– Conversational AI Ads å¯¹è¯å¼ AI å¹¿å‘Š åŸºäºå¯¹è¯äº¤äº’çš„å¹¿å‘Šå½¢å¼ æ–°å…´å½¢å¼ Predictive Analytics é¢„æµ‹åˆ†æ åŸºäº AI é¢„æµ‹æœªæ¥è¶‹åŠ¿ æˆ˜ç•¥è§„åˆ’ Autonomous Marketing è‡ªä¸»è¥é”€ AI è‡ªä¸»æ‰§è¡Œè¥é”€ç­–ç•¥ å‰æ²¿åº”ç”¨ äºŒåã€B2B ç‰¹å®šç­–ç•¥ (B2B Specific Strategies) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ Account-Based Marketing (ABM) åŸºäºè´¦æˆ·çš„è¥é”€ é’ˆå¯¹ç‰¹å®šä¼ä¸šè´¦æˆ·çš„ç²¾å‡†è¥é”€ B2B å¤§å®¢æˆ· Account-Based Advertising (ABA) åŸºäºè´¦æˆ·çš„å¹¿å‘Š é’ˆå¯¹ç‰¹å®šä¼ä¸šè´¦æˆ·çš„å¹¿å‘ŠæŠ•æ”¾ B2B å¹¿å‘Š Lead Scoring çº¿ç´¢è¯„åˆ† æ ¹æ®è¡Œä¸ºå’Œæ•°æ®ç»™çº¿ç´¢æ‰“åˆ† é”€å”®çº¿ç´¢ Marketing Qualified Lead (MQL) è¥é”€åˆæ ¼çº¿ç´¢ è¥é”€éƒ¨é—¨è®¤å®šçš„åˆæ ¼çº¿ç´¢ çº¿ç´¢ç®¡ç† Sales Qualified Lead (SQL) é”€å”®åˆæ ¼çº¿ç´¢ é”€å”®éƒ¨é—¨è®¤å®šçš„åˆæ ¼çº¿ç´¢ çº¿ç´¢ç®¡ç† Pipeline Attribution é”€å”®ç®¡é“å½’å›  å½’å› åˆ°é”€å”®ç®¡é“å„é˜¶æ®µ B2B é”€å”® Revenue Attribution æ”¶å…¥å½’å›  å½’å› åˆ°å®é™…æˆäº¤æ”¶å…¥ B2B æ•ˆæœ Contact Targeting è”ç³»äººå®šå‘ é’ˆå¯¹ç‰¹å®šèŒä½&#x2F;éƒ¨é—¨äººå‘˜ LinkedIn Company Targeting å…¬å¸å®šå‘ é’ˆå¯¹ç‰¹å®šå…¬å¸å®šå‘ LinkedIn Intent Data æ„å‘æ•°æ® åŸºäºæœç´¢å’Œè¡Œä¸ºçš„ä¼ä¸šè´­ä¹°æ„å‘ B2B å®šå‘ Technographic Targeting æŠ€æœ¯ç”»åƒå®šå‘ åŸºäºä¼ä¸šä½¿ç”¨æŠ€æœ¯å®šå‘ B2B å®šå‘ Firmographic Targeting ä¼ä¸šç”»åƒå®šå‘ åŸºäºä¼ä¸šç‰¹å¾å®šå‘ B2B å®šå‘ Decision Maker Targeting å†³ç­–è€…å®šå‘ é’ˆå¯¹ä¼ä¸šå†³ç­–è€…å®šå‘ B2B è¥é”€ Multi-Touch B2B B2B å¤šè§¦ç‚¹ B2B é•¿å‘¨æœŸçš„å¤šè§¦ç‚¹è¥é”€ B2B è¥é”€ äºŒåä¸€ã€è§†é¢‘ä¸ CTV ç­–ç•¥ (Video & CTV Strategies) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ TrueView TrueView å¹¿å‘Š YouTube å¯è·³è¿‡è§†é¢‘å¹¿å‘Š YouTube Bumper Ads Bumper å¹¿å‘Š 6 ç§’ä¸å¯è·³è¿‡çŸ­è§†é¢‘å¹¿å‘Š YouTube Pre-Roll å‰è´´ç‰‡å¹¿å‘Š è§†é¢‘æ’­æ”¾å‰çš„å¹¿å‘Š è§†é¢‘å¹³å° Mid-Roll ä¸­æ’å¹¿å‘Š è§†é¢‘æ’­æ”¾ä¸­çš„å¹¿å‘Š é•¿è§†é¢‘ Post-Roll åè´´ç‰‡å¹¿å‘Š è§†é¢‘æ’­æ”¾åçš„å¹¿å‘Š è§†é¢‘å¹³å° Outstream Video æµå¤–è§†é¢‘å¹¿å‘Š éè§†é¢‘å†…å®¹ä¸­çš„è§†é¢‘å¹¿å‘Š ä¿¡æ¯æµ Instream Video æµå†…è§†é¢‘å¹¿å‘Š è§†é¢‘å†…å®¹ä¸­çš„å¹¿å‘Š è§†é¢‘å¹³å° Completion Rate å®Œæ’­ç‡ è§†é¢‘å®Œæ•´è§‚çœ‹çš„æ¯”ä¾‹ è§†é¢‘æ•ˆæœ Quartile Reporting å››åˆ†ä¹‹ä¸€æŠ¥å‘Š 25%&#x2F;50%&#x2F;75%&#x2F;100% è§‚çœ‹è¿›åº¦æŠ¥å‘Š è§†é¢‘åˆ†æ CTV (Connected TV) è”ç½‘ç”µè§† æ™ºèƒ½ç”µè§†&#x2F;æµåª’ä½“è®¾å¤‡å¹¿å‘Š å®¶åº­åœºæ™¯ OTT (Over-The-Top) ç½‘ç»œç”µè§† é€šè¿‡äº’è”ç½‘ä¼ è¾“çš„ç”µè§†å†…å®¹ æµåª’ä½“ Addressable TV å¯å¯»å€ç”µè§† é’ˆå¯¹ä¸åŒå®¶åº­æŠ•æ”¾ä¸åŒå¹¿å‘Š ç²¾å‡†ç”µè§† Programmatic TV ç¨‹åºåŒ–ç”µè§† ç¨‹åºåŒ–è´­ä¹°çš„ç”µè§†å¹¿å‘Š ç”µè§†å¹¿å‘Š Dynamic Ad Insertion åŠ¨æ€å¹¿å‘Šæ’å…¥ åœ¨è§†é¢‘æµä¸­åŠ¨æ€æ’å…¥å¹¿å‘Š æµåª’ä½“ Interactive Video Ads äº’åŠ¨è§†é¢‘å¹¿å‘Š å¯äº¤äº’çš„è§†é¢‘å¹¿å‘Š è§†é¢‘è¥é”€ Vertical Video Ads ç«–ç‰ˆè§†é¢‘å¹¿å‘Š é€‚é…ç§»åŠ¨ç«¯çš„ç«–ç‰ˆè§†é¢‘ çŸ­è§†é¢‘ Short-Form Video çŸ­è§†é¢‘å¹¿å‘Š 60 ç§’ä»¥å†…çš„çŸ­è§†é¢‘å¹¿å‘Š TikTok&#x2F;Shorts Long-Form Video é•¿è§†é¢‘å¹¿å‘Š 60 ç§’ä»¥ä¸Šçš„é•¿è§†é¢‘å¹¿å‘Š YouTube&#x2F;CTV äºŒåäºŒã€åˆè§„ä¸éšç§ç­–ç•¥ (Compliance & Privacy Strategies) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ GDPR Compliance GDPR åˆè§„ æ¬§ç›Ÿé€šç”¨æ•°æ®ä¿æŠ¤æ¡ä¾‹åˆè§„ æ¬§æ´²å¸‚åœº CCPA Compliance CCPA åˆè§„ åŠ å·æ¶ˆè´¹è€…éšç§æ³•åˆè§„ ç¾å›½å¸‚åœº CPRA åŠ å·éšç§æƒæ³• CCPA çš„å‡çº§ç‰ˆ ç¾å›½å¸‚åœº PIPL Compliance ä¸ªä¿æ³•åˆè§„ ä¸­å›½ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•åˆè§„ ä¸­å›½å¸‚åœº LGPD å·´è¥¿é€šç”¨æ•°æ®ä¿æŠ¤æ³• å·´è¥¿éšç§æ³•è§„ å·´è¥¿å¸‚åœº Consent Management åŒæ„ç®¡ç† ç®¡ç†ç”¨æˆ·æ•°æ®ä½¿ç”¨åŒæ„ éšç§åˆè§„ CMP (Consent Management Platform) åŒæ„ç®¡ç†å¹³å° ç®¡ç†ç”¨æˆ·åŒæ„çš„æŠ€æœ¯å¹³å° éšç§åˆè§„ Data Minimization æ•°æ®æœ€å°åŒ– ä»…æ”¶é›†å¿…è¦çš„æ•°æ® éšç§åŸåˆ™ Purpose Limitation ç›®çš„é™åˆ¶ æ•°æ®ä»…ç”¨äºå£°æ˜çš„ç›®çš„ éšç§åŸåˆ™ Right to Be Forgotten è¢«é—å¿˜æƒ ç”¨æˆ·è¦æ±‚åˆ é™¤æ•°æ®çš„æƒåˆ© éšç§æƒåˆ© Data Portability æ•°æ®å¯æºå¸¦æƒ ç”¨æˆ·è·å–å’Œè½¬ç§»æ•°æ®çš„æƒåˆ© éšç§æƒåˆ© Anonymization åŒ¿ååŒ– å»é™¤ä¸ªäººè¯†åˆ«ä¿¡æ¯ éšç§ä¿æŠ¤ Pseudonymization å‡ååŒ– ç”¨å‡åæ›¿ä»£çœŸå®èº«ä»½ éšç§ä¿æŠ¤ Federated Learning è”é‚¦å­¦ä¹  æ•°æ®ä¸å‡ºæœ¬åœ°çš„åˆ†å¸ƒå¼å­¦ä¹  éšç§æŠ€æœ¯ Differential Privacy å·®åˆ†éšç§ æ·»åŠ å™ªå£°ä¿æŠ¤ä¸ªä½“éšç§ éšç§æŠ€æœ¯ Clean Room æ•°æ®æ¸…æ´å®¤ å®‰å…¨çš„æ•°æ®åä½œç¯å¢ƒ æ•°æ®åˆä½œ Privacy Sandbox éšç§æ²™ç›’ Google çš„éšç§ä¿æŠ¤æ¡†æ¶ Chrome&#x2F;Android Topics API ä¸»é¢˜ API åŸºäºå…´è¶£ä¸»é¢˜çš„å®šå‘ API Privacy Sandbox Protected Audience å—ä¿æŠ¤å—ä¼— å†è¥é”€çš„éšç§ä¿æŠ¤ API Privacy Sandbox Attribution Reporting API å½’å› æŠ¥å‘Š API éšç§ä¿æŠ¤çš„å½’å›  API Privacy Sandbox Private Aggregation ç§æœ‰èšåˆ éšç§ä¿æŠ¤çš„æ•°æ®èšåˆ Privacy Sandbox FLEDGE é¦–æ¬¡æœ¬åœ°å®éªŒ Protected Audience çš„æ—©æœŸåç§° Privacy Sandbox IDFA å¹¿å‘Šæ ‡è¯†ç¬¦ iOS è®¾å¤‡å¹¿å‘Šæ ‡è¯†ç¬¦ iOS è¿½è¸ª IDFV ä¾›åº”å•†æ ‡è¯†ç¬¦ iOS ä¾›åº”å•†æ ‡è¯†ç¬¦ iOS è¿½è¸ª GAID è°·æ­Œå¹¿å‘Š ID Android è®¾å¤‡å¹¿å‘Šæ ‡è¯†ç¬¦ Android è¿½è¸ª OAID å¼€æ”¾å¹¿å‘Šæ ‡è¯†ç¬¦ ä¸­å›½ç§»åŠ¨å®‰å…¨è”ç›Ÿæ ‡è¯†ç¬¦ Android è¿½è¸ª ATT Framework åº”ç”¨è¿½è¸ªé€æ˜åº¦ iOS ç”¨æˆ·æˆæƒè¿½è¸ªæ¡†æ¶ iOS éšç§ Limited Ad Tracking é™åˆ¶å¹¿å‘Šè¿½è¸ª ç”¨æˆ·é€‰æ‹©é™åˆ¶è¿½è¸ª iOS éšç§ Do Not Sell ç¦æ­¢å‡ºå”® ç”¨æˆ·é€‰æ‹©ç¦æ­¢æ•°æ®å‡ºå”® CCPA Opt-In é€‰æ‹©åŠ å…¥ ç”¨æˆ·ä¸»åŠ¨åŒæ„ éšç§åˆè§„ Opt-Out é€‰æ‹©é€€å‡º ç”¨æˆ·ä¸»åŠ¨æ‹’ç» éšç§åˆè§„ äºŒåä¸‰ã€é«˜çº§ AI ä¸æœºå™¨å­¦ä¹ ç­–ç•¥ (Advanced AI & ML Strategies) æœ¯è¯­ å®šä¹‰ è¯´æ˜ åº”ç”¨åœºæ™¯ Deep Learning Bidding æ·±åº¦å­¦ä¹ å‡ºä»· åŸºäºæ·±åº¦ç¥ç»ç½‘ç»œçš„å‡ºä»·æ¨¡å‹ AI ä¼˜åŒ– Reinforcement Learning Bidding å¼ºåŒ–å­¦ä¹ å‡ºä»· åŸºäºå¼ºåŒ–å­¦ä¹ çš„å‡ºä»·æ¨¡å‹ AI ä¼˜åŒ– Generative Reinforcement Learning ç”Ÿæˆå¼å¼ºåŒ–å­¦ä¹  ç»“åˆç”Ÿæˆæ¨¡å‹å’Œå¼ºåŒ–å­¦ä¹  å¿«æ‰‹ç­‰å‰æ²¿ Multi-Task Learning å¤šä»»åŠ¡å­¦ä¹  åŒæ—¶å­¦ä¹ å¤šä¸ªç›¸å…³ä»»åŠ¡ AI ä¼˜åŒ– Transfer Learning è¿ç§»å­¦ä¹  å°†çŸ¥è¯†è¿ç§»åˆ°æ–°åœºæ™¯ AI ä¼˜åŒ– Few-Shot Learning å°‘æ ·æœ¬å­¦ä¹  å°‘é‡æ•°æ®å¿«é€Ÿå­¦ä¹  å†·å¯åŠ¨ Zero-Shot Learning é›¶æ ·æœ¬å­¦ä¹  æ— éœ€è®­ç»ƒæ•°æ®å­¦ä¹  å‰æ²¿ AI Online Learning åœ¨çº¿å­¦ä¹  å®æ—¶æŒç»­å­¦ä¹ æ›´æ–° åŠ¨æ€ä¼˜åŒ– Batch Learning æ‰¹é‡å­¦ä¹  å®šæœŸæ‰¹é‡æ›´æ–°æ¨¡å‹ ä¼ ç»Ÿ ML Ensemble Learning é›†æˆå­¦ä¹  å¤šä¸ªæ¨¡å‹ç»„åˆä¼˜åŒ– é«˜çº§ä¼˜åŒ– Gradient Boosting æ¢¯åº¦æå‡ ä¸€ç§é›†æˆå­¦ä¹ æ–¹æ³• é¢„æµ‹æ¨¡å‹ Random Forest éšæœºæ£®æ— ä¸€ç§é›†æˆå­¦ä¹ æ–¹æ³• é¢„æµ‹æ¨¡å‹ Neural Collaborative Filtering ç¥ç»ååŒè¿‡æ»¤ åŸºäºç¥ç»ç½‘ç»œçš„æ¨è å®šå‘ä¼˜åŒ– Attention Mechanism æ³¨æ„åŠ›æœºåˆ¶ èšç„¦é‡è¦ç‰¹å¾çš„æœºåˆ¶ æ·±åº¦å­¦ä¹  Transformer Architecture Transformer æ¶æ„ åŸºäºè‡ªæ³¨æ„åŠ›çš„æ¶æ„ å‰æ²¿ AI Large Language Model å¤§è¯­è¨€æ¨¡å‹ ç”¨äºåˆ›æ„å’Œå®šå‘çš„ LLM ç”Ÿæˆå¼ AI Computer Vision è®¡ç®—æœºè§†è§‰ ç”¨äºå›¾åƒ&#x2F;è§†é¢‘åˆ†æ åˆ›æ„ä¼˜åŒ– Natural Language Processing è‡ªç„¶è¯­è¨€å¤„ç† ç”¨äºæ–‡æœ¬åˆ†æç”Ÿæˆ åˆ›æ„ä¼˜åŒ– Predictive Modeling é¢„æµ‹å»ºæ¨¡ é¢„æµ‹æœªæ¥ç»“æœ æˆ˜ç•¥è§„åˆ’ Causal Inference å› æœæ¨æ–­ è¯†åˆ«å› æœå…³ç³» å¢é‡åˆ†æ Uplift Modeling å¢é‡å»ºæ¨¡ é¢„æµ‹å¹¿å‘Šå¢é‡æ•ˆæœ ç²¾å‡†è¥é”€ Propensity Modeling å€¾å‘å»ºæ¨¡ é¢„æµ‹ç”¨æˆ·è¡Œä¸ºå€¾å‘ å®šå‘ä¼˜åŒ– Churn Prediction æµå¤±é¢„æµ‹ é¢„æµ‹ç”¨æˆ·æµå¤±é£é™© ç•™å­˜ä¼˜åŒ– Lifetime Value Prediction ç”Ÿå‘½å‘¨æœŸä»·å€¼é¢„æµ‹ é¢„æµ‹ç”¨æˆ· LTV ä»·å€¼å‡ºä»· æ‰€æœ‰åŸå§‹è¦†ç›–åˆ†æ åºå· æ‚¨åŸå§‹æœ¯è¯­ è¦†ç›–ä½ç½® çŠ¶æ€ 1 CPM &#x2F; CPC &#x2F; CPA ç¬¬äºŒéƒ¨åˆ† - åŸºç¡€è®¡è´¹æ¨¡å¼ âœ… 2 oCPM &#x2F; oCPC &#x2F; oCPA ç¬¬ä¸‰éƒ¨åˆ† - æ™ºèƒ½å‡ºä»·ç­–ç•¥ âœ… 3 oCPX ç¬¬ä¸‰éƒ¨åˆ† - æ™ºèƒ½å‡ºä»·ç­–ç•¥ âœ… 4 tCPA &#x2F; tROAS ç¬¬ä¸‰éƒ¨åˆ† - æ™ºèƒ½å‡ºä»·ç­–ç•¥ âœ… 5 Bid Shading ç¬¬å››éƒ¨åˆ† - å‡ºä»·æ§åˆ¶æŠ€æœ¯ âœ… 6 Budget Pacing ç¬¬äº”éƒ¨åˆ† - é¢„ç®—ä¸æ¶ˆè€—æ§åˆ¶ âœ… 7 Frequency Capping ç¬¬å…­éƒ¨åˆ† - é¢‘æ§ä¸æ›å…‰ç®¡ç† âœ… 8 Recency Capping ç¬¬å…­éƒ¨åˆ† - é¢‘æ§ä¸æ›å…‰ç®¡ç† âœ… 9 Bid Multiplier ç¬¬å››éƒ¨åˆ† - å‡ºä»·æ§åˆ¶æŠ€æœ¯ âœ… 10 Auto Bidding ç¬¬ä¸‰éƒ¨åˆ† - æ™ºèƒ½å‡ºä»·ç­–ç•¥ âœ… 11 CBO ç¬¬äº”éƒ¨åˆ† - é¢„ç®—ä¸æ¶ˆè€—æ§åˆ¶ âœ… 12 Lookalike Audience ç¬¬ä¸ƒéƒ¨åˆ† - å—ä¼—ä¸å®šå‘ç­–ç•¥ âœ… 13 Creative Fatigue ç¬¬å…«éƒ¨åˆ† - åˆ›æ„ä¸å†…å®¹ä¼˜åŒ– âœ… 14 Cold Start Problem ç¬¬åä¸ƒéƒ¨åˆ† - å†·å¯åŠ¨ä¸å­¦ä¹ æœŸç®¡ç† âœ… æ€»ç»“ä¸Šé¢è¿™äº›åŸºæœ¬ä¸Šæ˜¯å¸‚é¢ä¸Šå¹¿å‘Šè¡Œä¸šå¯ä»¥æ‹¥æœ‰çš„æ‰€æœ‰çš„ä¼˜åŒ–å’Œå‡ºä»·ç­–ç•¥äº†ã€‚","date":"2026-02-19","categories":["å¹¿å‘Š"],"tags":["å¹¿å‘Š"]},{"title":"å¹¿å‘Šï¼ˆ5ï¼‰-å¹¿å‘Šåè®®å’Œæ ‡å‡†","url":"/2026/02/19/å¹¿å‘Š5-å¹¿å‘Šåè®®å’Œæ ‡å‡†/","content":"ğŸ“‹ å¹¿å‘Šç³»ç»Ÿåè®®ä¸æ ‡å‡†å®Œæ•´æ±‡æ€» (å…¨çƒ+ä¸­å›½) æ–‡æ¡£ç‰ˆæœ¬: 2026å¹´2æœˆæ›´æ–°è¦†ç›–èŒƒå›´: å…¨çƒæ•°å­—å¹¿å‘Šå¸‚åœº 99%+é€‚ç”¨å¯¹è±¡: å¹¿å‘Šå¹³å°ã€DSPã€SSPã€Ad Exchangeã€åª’ä½“æ–¹ ä¸€ã€å®Œæ•´åè®®ä¸æ ‡å‡†æ€»è¡¨ğŸ”´ æ ¸å¿ƒå¿…å¤‡æ ‡å‡† (è¦†ç›–ç‡ 85%+) æœ¯è¯­ å®šä¹‰ é€‚ç”¨èŒƒå›´ è¦†ç›–ç‡ å‘å¸ƒæœºæ„ OpenRTB 2.5&#x2F;3.0 å¼€æ”¾å®æ—¶ç«ä»·åè®® å…¨çƒç¨‹åºåŒ–äº¤æ˜“ 95%+ IAB Tech Lab VAST 4.x è§†é¢‘å¹¿å‘ŠæœåŠ¡æ¨¡æ¿ å…¨çƒè§†é¢‘å¹¿å‘Š 98%+ IAB Tech Lab Ads.txt &#x2F; App-ads.txt å¹¿å‘Šæˆæƒæ–‡ä»¶ å…¨çƒWeb&#x2F;App 90%+ IAB Tech Lab OAID åŒ¿åè®¾å¤‡æ ‡è¯†ç¬¦ ä¸­å›½Android 95%+ MSAç§»åŠ¨å®‰å…¨è”ç›Ÿ IDFA &#x2F; GAID Apple&#x2F;Googleå¹¿å‘Šæ ‡è¯†ç¬¦ iOS&#x2F;Androidæµ·å¤– 90%+ Apple&#x2F;Google ã€Šäº’è”ç½‘å¹¿å‘Šç®¡ç†åŠæ³•ã€‹ äº’è”ç½‘å¹¿å‘Šç›‘ç®¡æ³•è§„ ä¸­å›½å¤§é™† 100% å¸‚åœºç›‘ç®¡æ€»å±€ ã€Šä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•ã€‹(PIPL) ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•å¾‹ ä¸­å›½å¤§é™† 100% å…¨å›½äººå¤§ ğŸŸ  é‡è¦æ ‡å‡† (è¦†ç›–ç‡ 70-85%) æœ¯è¯­ å®šä¹‰ é€‚ç”¨èŒƒå›´ è¦†ç›–ç‡ å‘å¸ƒæœºæ„ VMAP è§†é¢‘å¤šå¹¿å‘Šæ’­æ”¾åˆ—è¡¨ å…¨çƒè§†é¢‘å¹¿å‘Š 85%+ IAB Tech Lab MRAID ç§»åŠ¨å¯Œåª’ä½“æ¥å£å®šä¹‰ å…¨çƒç§»åŠ¨å¹¿å‘Š 85%+ IAB Tech Lab Seller.json å–å®¶èº«ä»½å£°æ˜æ–‡ä»¶ å…¨çƒç¨‹åºåŒ–äº¤æ˜“ 80%+ IAB Tech Lab OMID &#x2F; OM SDK å¼€æ”¾æµ‹é‡æ¥å£&#x2F;SDK å…¨çƒå¹¿å‘Šæµ‹é‡ 80%+ IAB Tech Lab TCF v2.2 é€æ˜åº¦ä¸åŒæ„æ¡†æ¶ æ¬§æ´²(GDPR) 85%(EU) IAB Europe è…¾è®¯MKT API è…¾è®¯å¹¿å‘Šè¥é”€API ä¸­å›½è…¾è®¯ç”Ÿæ€ 90%+ è…¾è®¯å¹¿å‘Š å·¨é‡å¼•æ“API å­—èŠ‚è·³åŠ¨å¹¿å‘ŠAPI ä¸­å›½å­—èŠ‚ç”Ÿæ€ 90%+ å­—èŠ‚è·³åŠ¨ T&#x2F;CAAAD 003â€”2020 ç§»åŠ¨äº’è”ç½‘å¹¿å‘Šæ ‡è¯†æŠ€æœ¯è§„èŒƒ ä¸­å›½å¤§é™† 90%+ ä¸­å›½å¹¿å‘Šåä¼š T&#x2F;CAAAD 010â€”2024 äº’è”ç½‘å¹¿å‘Šéœ€æ±‚æ–¹å¹³å°æŠ€æœ¯è¦æ±‚ ä¸­å›½å¤§é™† 75%+ ä¸­å›½å¹¿å‘Šåä¼š ğŸŸ¡ åŒºåŸŸ&#x2F;æ–°å…´æ ‡å‡† (è¦†ç›–ç‡ 50-70%) æœ¯è¯­ å®šä¹‰ é€‚ç”¨èŒƒå›´ è¦†ç›–ç‡ å‘å¸ƒæœºæ„ SIMID å®‰å…¨äº’åŠ¨åª’ä½“æ¥å£å®šä¹‰ å…¨çƒäº’åŠ¨è§†é¢‘ 60%+ IAB Tech Lab SupplyChain Object æµé‡æ¥æºé€æ˜åŒ–å¯¹è±¡ å…¨çƒç¨‹åºåŒ–äº¤æ˜“ 70%+ IAB Tech Lab GPP &#x2F; USTS å…¨çƒéšç§å¹³å°&#x2F;ç¾å›½éšç§ä¿¡å· ç¾å›½(CCPAç­‰) 60%(US) IAB Tech Lab Privacy Sandbox éšç§æ²™ç›’ å…¨çƒ(Chromeä¸»å¯¼) 50%+ Google ads.cert å¹¿å‘Šç­¾åè®¤è¯åè®® å…¨çƒç¨‹åºåŒ–äº¤æ˜“ 30%+ IAB Tech Lab VAID &#x2F; AAID å¼€å‘è€…&#x2F;åº”ç”¨çº§åŒ¿åæ ‡è¯† ä¸­å›½Android 60%+ MSAç§»åŠ¨å®‰å…¨è”ç›Ÿ é˜¿é‡Œå¦ˆå¦ˆAPI é˜¿é‡Œå·´å·´å¹¿å‘ŠAPI ä¸­å›½é˜¿é‡Œç”Ÿæ€ 85%+ é˜¿é‡Œå·´å·´ ç™¾åº¦è¥é”€API ç™¾åº¦æœç´¢å¹¿å‘ŠAPI ä¸­å›½ç™¾åº¦ç”Ÿæ€ 80%+ ç™¾åº¦ ğŸŸ¢ è·Ÿè¸ªå…³æ³¨æ ‡å‡† (è¦†ç›–ç‡ <50%) æœ¯è¯­ å®šä¹‰ é€‚ç”¨èŒƒå›´ è¦†ç›–ç‡ å‘å¸ƒæœºæ„ OpenRTB 3.0 å¼€æ”¾å®æ—¶ç«ä»·åè®®v3.0 å…¨çƒç¨‹åºåŒ–äº¤æ˜“ 40%+ IAB Tech Lab CAID ä¸­å›½å¹¿å‘Šæ ‡è¯†ç¬¦ ä¸­å›½éƒ¨åˆ†ç”Ÿæ€ 30% ä¸­å›½ä¿¡é€šé™¢ T&#x2F;CAAAD 041â€”2025 AIé©±åŠ¨å“ç‰ŒåŠ›æå‡æ•ˆæœè¯„ä¼° ä¸­å›½å¤§é™† 40%+ ä¸­å›½å¹¿å‘Šåä¼š AIç”Ÿæˆå¹¿å‘Šå†…å®¹è§„èŒƒ AIGCå¹¿å‘Šæ ‡è¯†è¦æ±‚ ä¸­å›½å¤§é™† 60%+ ç½‘ä¿¡åŠ ç›´æ’­è¥é”€å¹¿å‘Šè§„èŒƒ ç›´æ’­å¹¿å‘Šç›‘ç®¡è¦æ±‚ ä¸­å›½å¤§é™† 75%+ å¸‚åœºç›‘ç®¡æ€»å±€ äºŒã€æŒ‰åŠŸèƒ½åˆ†ç±»æ±‡æ€»1ï¸âƒ£ ç«ä»·äº¤æ˜“åè®® åè®® ç‰ˆæœ¬ è¦†ç›–ç‡ è¯´æ˜ OpenRTB 2.5&#x2F;3.0 95%+ ç¨‹åºåŒ–äº¤æ˜“æ ¸å¿ƒåè®® Prebid - 85%+ å¼€æºå¤´éƒ¨ç«ä»·è§£å†³æ–¹æ¡ˆ è…¾è®¯ADXåè®® - 80%+ åŸºäºOpenRTBçš„è…¾è®¯æ‰©å±• 2ï¸âƒ£ è§†é¢‘å¹¿å‘Šæ ‡å‡† åè®® ç‰ˆæœ¬ è¦†ç›–ç‡ è¯´æ˜ VAST 4.x 98%+ è§†é¢‘å¹¿å‘Šè¯·æ±‚&#x2F;è¿”å›æ ‡å‡† VMAP 1.0 85%+ å¤šæ®µè§†é¢‘å¹¿å‘Šæ’­æ”¾é¡ºåºæ§åˆ¶ VPAID 2.0 30%â†“ å·²æ·˜æ±°ï¼Œè¢«SIMIDæ›¿ä»£ SIMID 1.0 60%+ VPAIDç»§ä»»è€…ï¼Œæ›´å®‰å…¨ 3ï¸âƒ£ è®¾å¤‡æ ‡è¯†ä½“ç³» æ ‡è¯† é€‚ç”¨èŒƒå›´ è¦†ç›–ç‡ è·å–æ–¹å¼ IDFA iOSæµ·å¤– 90%+ Appleç³»ç»ŸAPI GAID Androidæµ·å¤– 90%+ Google GMSæœåŠ¡ OAID ä¸­å›½Android 95%+ MSAç»Ÿä¸€SDK VAID ä¸­å›½Android 60%+ MSAç»Ÿä¸€SDK AAID ä¸­å›½Android 60%+ MSAç»Ÿä¸€SDK CAID ä¸­å›½éƒ¨åˆ† 30% ä¸­å›½ä¿¡é€šé™¢SDK 4ï¸âƒ£ å®‰å…¨è®¤è¯æ ‡å‡† åè®® è¦†ç›–ç‡ è¯´æ˜ Ads.txt 90%+ WebåŸŸåæˆæƒè®¤è¯ App-ads.txt 90%+ ç§»åŠ¨åº”ç”¨æˆæƒè®¤è¯ Seller.json 80%+ å–å®¶èº«ä»½å£°æ˜ SupplyChain Object 70%+ æµé‡æ¥æºé€æ˜åŒ– ads.cert 30%+ ç«ä»·è¯·æ±‚åŠ å¯†ç­¾å 5ï¸âƒ£ éšç§åˆè§„æ¡†æ¶ æ¡†æ¶ é€‚ç”¨èŒƒå›´ è¦†ç›–ç‡ è¯´æ˜ TCF v2.2 æ¬§æ´² 85%(EU) GDPRç”¨æˆ·æˆæƒæ¡†æ¶ GPP&#x2F;USTS ç¾å›½ 60%(US) ç¾å›½å¤šå·éšç§ä¿¡å· Privacy Sandbox å…¨çƒ 50%+ åCookieæ—¶ä»£æ–¹æ¡ˆ PIPLåˆè§„ ä¸­å›½ 100% ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³• 6ï¸âƒ£ æµ‹é‡éªŒè¯æ ‡å‡† æ ‡å‡† è¦†ç›–ç‡ è¯´æ˜ OMID&#x2F;OM SDK 80%+ å¹¿å‘Šå¯è§æ€§æµ‹é‡ MRCå¯è§æ€§æ ‡å‡† 90%+ 50%åƒç´ â‰¥1ç§’åŸºå‡† ä¸­å›½å¹¿å‘Šç›‘æµ‹æ ‡å‡† 75%+ å›½å†…æ•ˆæœéªŒè¯æ ‡å‡† 7ï¸âƒ£ å¯Œåª’ä½“äº¤äº’æ ‡å‡† åè®® è¦†ç›–ç‡ è¯´æ˜ MRAID 85%+ ç§»åŠ¨ç«¯å¯Œåª’ä½“å¹¿å‘Šæ¥å£ IABåˆ›æ„å°ºå¯¸æ ‡å‡† 95%+ æ ‡å‡†å¹¿å‘Šå°ºå¯¸è§„èŒƒ 8ï¸âƒ£ ä¸­å›½å¹³å°ç§æœ‰åè®® å¹³å° API è¦†ç›–ç‡ è¯´æ˜ è…¾è®¯å¹¿å‘Š MKT API 90%+ å¾®ä¿¡&#x2F;è…¾è®¯ç”Ÿæ€ç»Ÿä¸€æ¥å£ å·¨é‡å¼•æ“ Ocean API 90%+ æŠ–éŸ³&#x2F;å¤´æ¡å¹¿å‘Šæ¥å£ é˜¿é‡Œå¦ˆå¦ˆ Tanx API 85%+ æ·˜å®&#x2F;å¤©çŒ«å¹¿å‘Šæ¥å£ ç™¾åº¦è¥é”€ Baidu API 80%+ æœç´¢+ä¿¡æ¯æµæ¥å£ 9ï¸âƒ£ ä¸­å›½è¡Œä¸šæ ‡å‡† (T&#x2F;CAAADç³»åˆ—) æ ‡å‡†å· åç§° è¦†ç›–ç‡ è¯´æ˜ T&#x2F;CAAAD 003â€”2020 ç§»åŠ¨äº’è”ç½‘å¹¿å‘Šæ ‡è¯†æŠ€æœ¯è§„èŒƒ 90%+ å›½å†…æ ‡è¯†åŸºç¡€æ ‡å‡† T&#x2F;CAAAD 007â€”2024 æ•°å­—æˆ·å¤–è”ç½‘å±å¹¿å‘ŠæŠ•æ”¾ç›‘æµ‹ 50%+ æˆ·å¤–å¹¿å‘Šç›‘æµ‹ T&#x2F;CAAAD 010â€”2024 äº’è”ç½‘å¹¿å‘Šéœ€æ±‚æ–¹å¹³å°æŠ€æœ¯è¦æ±‚ 75%+ DSPæŠ€æœ¯è§„èŒƒ T&#x2F;CAAAD 011â€”2024 åˆ›æ„ç®¡ç†å¹³å°æŠ€æœ¯è¦æ±‚ 55%+ åˆ›æ„ç®¡ç†è§„èŒƒ T&#x2F;CAAAD 013â€”2024 å®¢æˆ·æ•°æ®å¹³å°(CDP)æŠ€æœ¯è¦æ±‚ 60%+ ç¬¬ä¸€æ–¹æ•°æ®ç®¡ç† T&#x2F;CAAAD 041â€”2025 AIé©±åŠ¨å“ç‰ŒåŠ›æå‡æ•ˆæœè¯„ä¼° 40%+ AIå¹¿å‘Šè¯„ä¼°æ ‡å‡† ğŸ”Ÿ ä¸­å›½æ³•å¾‹æ³•è§„ (å¼ºåˆ¶éµå®ˆ) æ³•è§„ å®æ–½æ—¶é—´ è¯´æ˜ ã€Šå¹¿å‘Šæ³•ã€‹ 1995å¹´(å¤šæ¬¡ä¿®è®¢) å¹¿å‘Šæ´»åŠ¨æ ¹æœ¬å¤§æ³• ã€Šäº’è”ç½‘å¹¿å‘Šç®¡ç†åŠæ³•ã€‹ 2023å¹´5æœˆ äº’è”ç½‘å¹¿å‘Šä¸“é¡¹ç›‘ç®¡ ã€Šä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•ã€‹(PIPL) 2021å¹´11æœˆ ä¸ªäººä¿¡æ¯ä¿æŠ¤åŸºæœ¬æ³• ã€Šäº’è”ç½‘å¹¿å‘Šå®¡æŸ¥ä¸å‘å¸ƒè§„èŒƒæŒ‡å—ã€‹ 2025å¹´æœ€æ–°ç‰ˆ å¹¿å‘Šå®¡æŸ¥æ“ä½œæŒ‡å— ã€Šç®—æ³•æ¨èå¹¿å‘Šè§„èŒƒã€‹ 2024å¹´ ç®—æ³•å¹¿å‘Šé€æ˜åº¦è¦æ±‚ ä¸‰ã€å¸‚åœºè¦†ç›–ç‡æ€»è§ˆ å››ã€å®æ–½ä¼˜å…ˆçº§å»ºè®®ğŸ”´ P0 - å¿…é¡»å®æ–½ (ä¸Šçº¿å‰å®Œæˆ) é¡¹ç›® è¯´æ˜ å·¥æœŸä¼°ç®— OpenRTB 2.5æ”¯æŒ ç¨‹åºåŒ–äº¤æ˜“åŸºç¡€ 2-4å‘¨ VAST 4.xæ”¯æŒ è§†é¢‘å¹¿å‘ŠåŸºç¡€ 1-2å‘¨ Ads.txt&#x2F;App-ads.txt å®‰å…¨è®¤è¯åŸºç¡€ 1å‘¨ OAIDé›†æˆ (ä¸­å›½) MSA SDKæ¥å…¥ 1-2å‘¨ PIPLåˆè§„ (ä¸­å›½) éšç§æ”¿ç­–+ç”¨æˆ·åŒæ„ 2-3å‘¨ å¹¿å‘Šæ ‡è¯†æ ‡æ³¨ â€œå¹¿å‘Šâ€å­—æ ·+ä¸€é”®å…³é—­ 1å‘¨ ğŸŸ  P1 - é‡è¦å®æ–½ (3ä¸ªæœˆå†…å®Œæˆ) é¡¹ç›® è¯´æ˜ å·¥æœŸä¼°ç®— Seller.jsonæ”¯æŒ å–å®¶èº«ä»½å£°æ˜ 1å‘¨ OMID&#x2F;OM SDKé›†æˆ å¹¿å‘Šæµ‹é‡éªŒè¯ 2å‘¨ TCF&#x2F;GPPæ”¯æŒ éšç§ä¿¡å·ä¼ é€’ 2-3å‘¨ ä¸»æµå¹³å°APIå¯¹æ¥ è…¾è®¯&#x2F;å­—èŠ‚&#x2F;é˜¿é‡Œ&#x2F;ç™¾åº¦ 4-8å‘¨ SupplyChain Object æµé‡æ¥æºé€æ˜åŒ– 1-2å‘¨ ğŸŸ¡ P2 - ä¼˜åŒ–å®æ–½ (6ä¸ªæœˆå†…å®Œæˆ) é¡¹ç›® è¯´æ˜ å·¥æœŸä¼°ç®— SIMIDæ”¯æŒ äº’åŠ¨è§†é¢‘å¹¿å‘Š 2å‘¨ ads.certæ”¯æŒ åŠ å¯†è®¤è¯åè®® 2-3å‘¨ Privacy Sandboxé€‚é… åCookieæ–¹æ¡ˆ 4-6å‘¨ T&#x2F;CAAADæ ‡å‡†å¯¹é½ ä¸­å›½è¡Œä¸šæ ‡å‡† 2-4å‘¨ ğŸŸ¢ P3 - è·Ÿè¸ªå…³æ³¨ (æŒç»­è·Ÿè¿›) é¡¹ç›® è¯´æ˜ å»ºè®® OpenRTB 3.0 æ–°ç‰ˆæœ¬åè®® å…³æ³¨ç”Ÿæ€é‡‡ç”¨ç‡ AIå¹¿å‘Šè§„èŒƒ AIGCæ ‡è¯†è¦æ±‚ è·Ÿè¸ªæ”¿ç­–æ›´æ–° ç›´æ’­å¹¿å‘Šè§„èŒƒ ç›´æ’­è¥é”€ç›‘ç®¡ è·Ÿè¸ªæ”¿ç­–æ›´æ–° äº”ã€æŠ€æœ¯æ¶æ„å»ºè®® å…­ã€å…³é”®æ³¨æ„äº‹é¡¹âš ï¸ ä¸­å›½åˆè§„çº¢çº¿ ç¦æ­¢æ”¶é›†IMEI&#x2F;MACåœ°å€ç”¨äºå¹¿å‘Šè¿½è¸ª å¹¿å‘Šå¿…é¡»æ ‡æ³¨â€å¹¿å‘Šâ€å­—æ ·ï¼Œæ˜¾è‘—å¯è¯†åˆ« å¼¹çª—å¹¿å‘Šå¿…é¡»æä¾›ä¸€é”®å…³é—­åŠŸèƒ½ åŒ»ç–—&#x2F;è¯å“&#x2F;ä¿å¥é£Ÿå“å¹¿å‘Šéœ€äº‹å‰è¡Œæ”¿å®¡æŸ¥ ä¸ªäººä¿¡æ¯æ”¶é›†éµå¾ªæœ€å°åŒ–åŸåˆ™ ç®—æ³•æ¨èå¹¿å‘Šéœ€æä¾›å…³é—­é€‰é¡¹ âš ï¸ æµ·å¤–åˆè§„è¦ç‚¹ æ¬§æ´²GDPR: å¿…é¡»é€šè¿‡TCFæ¡†æ¶è·å–ç”¨æˆ·åŒæ„ ç¾å›½CCPA&#x2F;CPRA: éœ€æ”¯æŒGPPéšç§ä¿¡å· å„¿ç«¥éšç§(COPPA): 13å²ä»¥ä¸‹ç”¨æˆ·ç‰¹æ®Šä¿æŠ¤ ç¬¬ä¸‰æ–¹Cookieæ·˜æ±°: 2024å¹´èµ·Chromeé€æ­¥ç¦ç”¨ ä¸ƒã€æ€»ç»“ ç»´åº¦ å…¨çƒæ ‡å‡† ä¸­å›½æ ‡å‡† å åŠ è¦†ç›– ç«ä»·äº¤æ˜“ OpenRTB 95%+ å¹³å°API 90%+ 99%+ è§†é¢‘å¹¿å‘Š VAST 98%+ å›½å†…ç›‘æµ‹ 75%+ 99%+ è®¾å¤‡æ ‡è¯† IDFA&#x2F;GAID 90%+ OAID 95%+ 99%+ å®‰å…¨è®¤è¯ Ads.txtç³»åˆ— 90%+ å¹³å°è®¤è¯ 85%+ 99%+ éšç§åˆè§„ TCF&#x2F;GPP 60%+ PIPL 100% 99%+ æµ‹é‡éªŒè¯ OMID 80%+ å›½å†…æ ‡å‡† 75%+ 95%+ æ•´ä½“è¦†ç›– 90%+ 95%+ 99%+ âœ… ç»“è®º: é€šè¿‡æ•´åˆå…¨çƒIABæ ‡å‡†ä¸ä¸­å›½æœ¬åœŸæ ‡å‡†(OAID&#x2F;CAAAD&#x2F;å¹³å°API&#x2F;æ³•å¾‹æ³•è§„)ï¼Œå¹¿å‘Šç³»ç»Ÿå¯å®ç°å…¨çƒ99%+çš„å¸‚åœºè¦†ç›–ç‡ï¼Œæ»¡è¶³å…¨çƒåŒ–è¿è¥éœ€æ±‚ã€‚","date":"2026-02-19","categories":["å¹¿å‘Š"],"tags":["å¹¿å‘Š"]},{"title":"å¹¿å‘Šï¼ˆ4ï¼‰-å¹¿å‘Šçš„äº¤æ˜“æ¨¡å¼","url":"/2026/02/19/å¹¿å‘Š4-å¹¿å‘Šçš„äº¤æ˜“æ¨¡å¼/","content":"ğŸ¯ å¹¿å‘Šäº¤æ˜“æ¨¡å¼2026å¹´ æ•´ç†1 - æŒ‰äº¤æ˜“è‡ªåŠ¨åŒ–ç¨‹åº¦ ä¸€çº§ äºŒçº§ ä¸‰çº§ å››çº§ ä¿é‡ ä¿ä»· è‡ªåŠ¨åŒ– è¯´æ˜ ä¼ ç»Ÿäº¤æ˜“ çº¿ä¸‹ç›´æŠ• åˆçº¦å¹¿å‘Š Direct Deal âœ… âœ… 0% äººå·¥è°ˆåˆ¤ç­¾çº¦ èµåŠ©å¹¿å‘Š Sponsorship âœ… âœ… 0% ç‹¬å ä½ç½®&#x2F;æ—¶æ®µ é¢„è´­å¹¿å‘Š Upfront âœ… âœ… 0% å­£åº¦&#x2F;å¹´åº¦é¢„è´­ æ¡†æ¶åˆåŒ Framework Agreement âš ï¸ âš ï¸ 0% å¹´åº¦æ¡†æ¶åè®® ç¨‹åºåŒ–äº¤æ˜“ ç¨‹åºåŒ–ä¿é‡ä¿ä»· PDB Programmatic Direct Buy âœ… âœ… 100% ç¨‹åºåŒ–æ‰§è¡Œç›´æŠ• PG Programmatic Guaranteed âœ… âœ… 100% IABæ ‡å‡†ä¿é‡ PPB Preferred Programmatic Buy âœ… âœ… 100% ä¼˜å…ˆç¨‹åºåŒ–è´­ä¹° ç¨‹åºåŒ–ä¿ä»·ä¸ä¿é‡ PD Preferred Deal âŒ âœ… 100% å›ºå®šä»·æ ¼ä¼˜å…ˆé€‰ FPD First-Look Preferred Deal âŒ âœ… 100% ç¬¬ä¸€ä¼˜å…ˆæŸ¥çœ‹æƒ ç¨‹åºåŒ–ä¸ä¿é‡ä¿ä»· PA Private Auction âŒ âœ… 100% é‚€è¯·åˆ¶ç«ä»· PMP Private Marketplace âŒ âœ… 100% ç§æœ‰äº¤æ˜“å¸‚åœº PMP-Deal PMP with Deal ID âŒ âœ… 100% å¸¦äº¤æ˜“IDçš„PMP ç¨‹åºåŒ–ä¸ä¿é‡ä¸ä¿ä»· OA Open Auction âŒ âŒ 100% å…¬å¼€ç«ä»· RTB Real-Time Bidding âŒ âŒ 100% å®æ—¶ç«ä»· OpenRTB OpenRTB Protocol âŒ âŒ 100% å¼€æ”¾ç«ä»·åè®® æ··åˆäº¤æ˜“ ç¨‹åºåŒ–+ç›´æŠ• Hybrid Deal æ··åˆäº¤æ˜“ âš ï¸ âš ï¸ 50% ç›´æŠ•ä¸ç¨‹åºåŒ–ç»„åˆ ç€‘å¸ƒæµ+ç«ä»· Waterfall+Bidding æ··åˆè¯·æ±‚ âš ï¸ âš ï¸ 50% ä¼˜å…ˆçº§+ç«ä»· 2 - æŒ‰ç«ä»·æŠ€æœ¯å®ç° åˆ†ç±» å­åˆ†ç±» å…·ä½“æ¨¡å¼ åè®®&#x2F;æ ‡å‡† è¯´æ˜ å®¢æˆ·ç«¯ç«ä»· æµè§ˆå™¨ç«¯ Header Bidding Prebid.js ç½‘é¡µå¤´éƒ¨å¹¶è¡Œç«ä»· Prebid Mobile Prebid.org ç§»åŠ¨ç«¯å¤´éƒ¨ç«ä»· Amazon UAM Unified Ad Marketplace äºšé©¬é€Šç»Ÿä¸€å¸‚åœº åº”ç”¨ç«¯ In-App Bidding OpenRTB 2.6+ Appå†…ç«ä»· Mobile Header Bidding Prebid Mobile ç§»åŠ¨å¤´éƒ¨ç«ä»· SDK Bidding å„å¹³å°SDK SDKé›†æˆç«ä»· æœåŠ¡å™¨ç«¯ç«ä»· å¹³å°ç«¯ Open Bidding Google EBDA è°·æ­ŒæœåŠ¡å™¨ç«¯ç«ä»· Server-Side Bidding è‡ªå®šä¹‰ æœåŠ¡ç«¯èšåˆ Unified Auction Google GAM ç»Ÿä¸€ç«ä»·æ±  äº¤æ¢ç«¯ Ad Exchange å„äº¤æ˜“æ‰€ å¹¿å‘Šäº¤æ˜“æ‰€ SSP Auction å„SSP ä¾›åº”æ–¹ç«ä»· æ··åˆç«ä»· åŠ¨æ€åˆ†é… Dynamic Allocation Google AdX ç›´æŠ•ä¸ç¨‹åºåŒ–æ¯”è¾ƒ ä»·æ ¼ä¼˜å…ˆ Price Priority è‡ªå®šä¹‰ ä»·æ ¼ä¼˜å…ˆæ’åº æ—¶é—´ä¼˜å…ˆ Time Priority è‡ªå®šä¹‰ æ—¶é—´ä¼˜å…ˆæ’åº åè®®æ ‡å‡† ç«ä»·åè®® OpenRTB 2.5&#x2F;2.6 IAB Tech Lab å¼€æ”¾å®æ—¶ç«ä»·åè®® MRAID IAB ç§»åŠ¨å¯Œåª’ä½“å¹¿å‘Š VAST&#x2F;VPAID IAB è§†é¢‘å¹¿å‘Šåè®® Ads.txt IAB æˆæƒå–å®¶æ–‡æœ¬ Sellers.json IAB å–å®¶ä¿¡æ¯æ–‡ä»¶ SupplyChain Object IAB ä¾›åº”é“¾å¯¹è±¡ ads.cert IAB å¹¿å‘Šè®¤è¯åè®® 3 - æŒ‰åª’ä½“ç±»å‹ åª’ä½“å¤§ç±» ä¸­ç±» å°ç±» äº¤æ˜“æ¨¡å¼ ä»£è¡¨å¹³å° å±•ç¤ºå¹¿å‘Š æ¨ªå¹… æ ‡å‡†æ¨ªå¹… Display RTB Google DV360 å¯Œåª’ä½“ Rich Media RTB Sizmek æ’å± Interstitial RTB AppNexus ä¿¡æ¯æµ åŸç”Ÿä¿¡æ¯æµ Native RTB Taboola ç¤¾äº¤ä¿¡æ¯æµ Social Feed Ads Meta æ–°é—»ä¿¡æ¯æµ News Feed Ads ä»Šæ—¥å¤´æ¡ åŸç”Ÿ å†…å®¹æ¨è Content Recommendation Outbrain åŸç”Ÿæœç´¢ Native Search Google Native è§†é¢‘å¹¿å‘Š é•¿è§†é¢‘ å‰è´´å¹¿å‘Š Pre-roll RTB YouTube ä¸­è´´å¹¿å‘Š Mid-roll RTB Hulu åè´´å¹¿å‘Š Post-roll RTB çˆ±å¥‡è‰º çŸ­è§†é¢‘ ä¿¡æ¯æµè§†é¢‘ In-Feed Video TikTok å¼€å±è§†é¢‘ Splash Video æŠ–éŸ³ CTV&#x2F;OTT è”ç½‘ç”µè§† CTV Programmatic Roku PODç«ä»· POD Auction NBCUniversal ACRæ•°æ®äº¤æ˜“ ACR Data Deal Inscape æš‚åœå¹¿å‘Š Pause Ad 2025æ–°å…´ äº’åŠ¨è§†é¢‘ Interactive Video å¯è´­ç‰©è§†é¢‘ éŸ³é¢‘å¹¿å‘Š éŸ³ä¹æµåª’ä½“ éŸ³é¢‘æ’æ’­ Audio Insertion Spotify æ’­å®¢ åŠ¨æ€æ’å…¥ Dynamic Ad Insertion Megaphone ä¸»æŒäººå£æ’­ Host Read æ’­å®¢èµåŠ© å¹¿æ’­ ç¨‹åºåŒ–å¹¿æ’­ Programmatic Radio iHeartRadio æ™ºèƒ½éŸ³ç®± è¯­éŸ³å¹¿å‘Š Voice Ads Alexa Skills æœç´¢å¹¿å‘Š é€šç”¨æœç´¢ å…³é”®è¯ç«ä»· Search Auction Google Ads ç”µå•†æœç´¢ å•†å“æœç´¢ç«ä»· Product Search Amazon åº”ç”¨æœç´¢ åº”ç”¨å•†åº—ç«ä»· ASA Apple Search Ads æœ¬åœ°æœç´¢ æœ¬åœ°æœåŠ¡å¹¿å‘Š LSA Google LSA ç¤¾äº¤å¹¿å‘Š ç¤¾äº¤å¹³å° ä¿¡æ¯æµç«ä»· Feed Auction Meta å¿«æ‹å¹¿å‘Š Stories Ads Instagram çŸ­è§†é¢‘å¹¿å‘Š Reels&#x2F;TikTok Ads TikTok ä¸“ä¸šç¤¾äº¤ B2Bç«ä»· LinkedIn Auction LinkedIn è¾¾äººåˆä½œ Influencer Deal å°çº¢ä¹¦ é›¶å”®åª’ä½“ ç”µå•†å¹³å° ç«™å†…æœç´¢ Sponsored Products Amazon å±•ç¤ºå¹¿å‘Š Sponsored Display Amazon å“ç‰Œæ——èˆ°åº— Brand Store å¤©çŒ« çº¿ä¸‹é›¶å”® æ•°å­—è´§æ¶ Digital Shelf æ²ƒå°”ç› ç”µå­ä»·ç­¾ ESL Ads 2026æ–°å…´ è´­ç‰©è½¦å¹¿å‘Š Cart Ads Instacart æ•°å­—æˆ·å¤– æ¥¼å®‡ç”µæ¢¯ ç”µæ¢¯å±ç¨‹åºåŒ– DOOH Programmatic åˆ†ä¼—ä¼ åª’ äº¤é€šåª’ä½“ åœ°é“å±ç¨‹åºåŒ– Transit DOOH JCDecaux å…¬äº¤å±ç¨‹åºåŒ– Bus DOOH Clear Channel æœºåœºåª’ä½“ æœºåœºå±ç¨‹åºåŒ– Airport DOOH å¾·é«˜ å•†åœˆåª’ä½“ å•†åœˆå¤§å±ç¨‹åºåŒ– Mall DOOH ä¸‡è¾¾ åŠ æ²¹ç«™ åŠ æ²¹å±ç¨‹åºåŒ– Gas Station DOOH 2026æ–°å…´ æ¸¸æˆå¹¿å‘Š æ‰‹æ¸¸ æ¿€åŠ±è§†é¢‘ Rewarded Video Unity Ads æ’å±å¹¿å‘Š Interstitial IronSource åŸç”Ÿå¹¿å‘Š Native In-Game AdColony ä¸»æœºæ¸¸æˆ æ¸¸æˆå†…å¹¿å‘Š In-Game Ads Activision åŠ è½½å¹¿å‘Š Loading Screen Ads EA Sports PCæ¸¸æˆ å¯åŠ¨å™¨å¹¿å‘Š Launcher Ads Steam å…ƒå®‡å®™ è™šæ‹Ÿåœ°äº§å¹¿å‘Š Metaverse Land Ads Decentraland å…¶ä»–æ–°å…´ è½¦è”ç½‘ è½¦è½½å±å¹¿å‘Š Connected Car Ads Tesla æ™ºèƒ½å®¶å±… IoTè®¾å¤‡å¹¿å‘Š Smart Home Ads Google Nest å¯ç©¿æˆ´ æ‰‹è¡¨å¹¿å‘Š Wearable Ads Apple Watch AR&#x2F;VR æ²‰æµ¸å¼å¹¿å‘Š Immersive Ads Meta Quest 4 - æŒ‰ä»˜è´¹æ¨¡å¼ å¤§ç±» å…·ä½“æ¨¡å¼ è®¡ç®—å…¬å¼ é€‚ç”¨åœºæ™¯ é£é™©æ‰¿æ‹…æ–¹ å±•ç¤ºç±» CPM æˆæœ¬&#x2F;åƒæ¬¡å±•ç¤º å“ç‰Œæ›å…‰ å¹¿å‘Šä¸» vCPM æˆæœ¬&#x2F;åƒæ¬¡å¯è§å±•ç¤º å¯è§åº¦ä¿è¯ åª’ä½“ CPM Viewable æˆæœ¬&#x2F;åƒæ¬¡å¯è§å±•ç¤º å¯è§åº¦ä¿è¯ åª’ä½“ ç‚¹å‡»ç±» CPC æˆæœ¬&#x2F;ç‚¹å‡» æ•ˆæœå¹¿å‘Š åª’ä½“ CPC Viewable æˆæœ¬&#x2F;å¯è§ç‚¹å‡» é«˜è´¨é‡ç‚¹å‡» åª’ä½“ è¡ŒåŠ¨ç±» CPA æˆæœ¬&#x2F;è¡ŒåŠ¨ è½¬åŒ–å¯¼å‘ åª’ä½“ CPL æˆæœ¬&#x2F;çº¿ç´¢ B2Bè·å®¢ åª’ä½“ CPS æˆæœ¬&#x2F;é”€å”® ç”µå•†å¹¿å‘Š åª’ä½“ CPI æˆæœ¬&#x2F;å®‰è£… åº”ç”¨æ¨å¹¿ åª’ä½“ CPE æˆæœ¬&#x2F;äº’åŠ¨ ç¤¾äº¤å¹¿å‘Š åª’ä½“ CPDownload æˆæœ¬&#x2F;ä¸‹è½½ åº”ç”¨ä¸‹è½½ åª’ä½“ CPRegistration æˆæœ¬&#x2F;æ³¨å†Œ ç”¨æˆ·æ³¨å†Œ åª’ä½“ CPActivation æˆæœ¬&#x2F;æ¿€æ´» ç”¨æˆ·æ¿€æ´» åª’ä½“ è§†é¢‘ç±» CPV æˆæœ¬&#x2F;è§‚çœ‹ è§†é¢‘å¹¿å‘Š åª’ä½“ CPV 30s æˆæœ¬&#x2F;30ç§’è§‚çœ‹ é•¿è§†é¢‘ åª’ä½“ CPCV æˆæœ¬&#x2F;å®Œæ•´è§‚çœ‹ å®Œæ•´æ’­æ”¾ åª’ä½“ æ—¶é—´ç±» CPD æˆæœ¬&#x2F;å¤© å¼€å±å¹¿å‘Š å¹¿å‘Šä¸» CPW æˆæœ¬&#x2F;å‘¨ å‘¨åŒ…æ–­ å¹¿å‘Šä¸» CPMonth æˆæœ¬&#x2F;æœˆ æœˆåŒ…æ–­ å¹¿å‘Šä¸» æ”¶å…¥ç±» Revenue Share æ”¶å…¥åˆ†æˆæ¯”ä¾‹ è”ç›Ÿè¥é”€ å…±æ‹… Profit Share åˆ©æ¶¦åˆ†æˆæ¯”ä¾‹ æ·±åº¦åˆä½œ å…±æ‹… Hybrid CPM+CPAæ··åˆ é£é™©å…±æ‹… å…±æ‹… ä¿è¯ç±» Guarantee CPA ä¿è¯CPAä»·æ ¼ æ•ˆæœä¿è¯ åª’ä½“ Guarantee ROAS ä¿è¯ROAS å›æŠ¥ä¿è¯ åª’ä½“ Guarantee Lift ä¿è¯æå‡æ•ˆæœ å“ç‰Œæå‡ åª’ä½“ 5 - æŒ‰æ•°æ®ä¸å®šå‘æ–¹å¼ æ•°æ®å±‚çº§ å®šå‘ç±»å‹ å…·ä½“æ¨¡å¼ éšç§åˆè§„ æŠ€æœ¯å®ç° ä¸€æ–¹æ•°æ® å®¢æˆ·æ•°æ® CRM Match âœ… é«˜åˆè§„ Customer Match Email Hash âœ… é«˜åˆè§„ é‚®ç®±å“ˆå¸Œ Phone Hash âœ… é«˜åˆè§„ ç”µè¯å“ˆå¸Œ è¡Œä¸ºæ•°æ® ç½‘ç«™è¡Œä¸º âœ… é«˜åˆè§„ Pixel&#x2F;SDK Appè¡Œä¸º âœ… é«˜åˆè§„ SDKè¿½è¸ª è´­ä¹°å†å² âœ… é«˜åˆè§„ äº¤æ˜“æ•°æ® äºŒæ–¹æ•°æ® åª’ä½“æ•°æ® åª’ä½“ä¸€æ–¹æ•°æ® âš ï¸ éœ€åè®® æ•°æ®åˆä½œ åˆä½œä¼™ä¼´ æ•°æ®å…±äº« âš ï¸ éœ€åè®® æ•°æ®äº¤æ¢ ä¸‰æ–¹æ•°æ® æ•°æ®ä¾›åº”å•† DMPæ ‡ç­¾ âŒ æ·˜æ±°ä¸­ ç¬¬ä¸‰æ–¹Cookie æ•°æ®å¸‚åœº Data Marketplace âŒ æ·˜æ±°ä¸­ æ•°æ®äº¤æ˜“ ä¸Šä¸‹æ–‡ å†…å®¹å®šå‘ é¡µé¢å†…å®¹åˆ†æ âœ… åˆè§„ NLPåˆ†æ å…³é”®è¯ å…³é”®è¯åŒ¹é… âœ… åˆè§„ å…³é”®è¯åº“ è¯­ä¹‰åˆ†æ è¯­ä¹‰ç†è§£ âœ… åˆè§„ AIè¯­ä¹‰ æƒ…æ„Ÿåˆ†æ å†…å®¹æƒ…æ„Ÿåˆ¤æ–­ âœ… åˆè§„ æƒ…æ„ŸAI äººç¾¤ äººå£ç»Ÿè®¡ å¹´é¾„&#x2F;æ€§åˆ«&#x2F;æ”¶å…¥ âš ï¸ éœ€åŒæ„ ç”¨æˆ·ç”»åƒ å…´è¶£æ ‡ç­¾ å…´è¶£åˆ†ç±» âš ï¸ éœ€åŒæ„ å…´è¶£å›¾è°± è¡Œä¸ºæ ‡ç­¾ è¡Œä¸ºåˆ†ç±» âš ï¸ éœ€åŒæ„ è¡Œä¸ºåˆ†æ Lookalike ç›¸ä¼¼äººç¾¤æ‰©å±• âš ï¸ éœ€åŒæ„ æœºå™¨å­¦ä¹  åœ°ç† ä½ç½®å®šå‘ å›½å®¶&#x2F;çœ&#x2F;å¸‚ âœ… åˆè§„ IP&#x2F;GPS åœ°ç†å›´æ  ç‰¹å®šåŒºåŸŸè§¦å‘ âœ… åˆè§„ GPSå›´æ  POIå®šå‘ å…´è¶£ç‚¹å®šå‘ âœ… åˆè§„ POIæ•°æ®åº“ å¤©æ°”å®šå‘ å¤©æ°”æ¡ä»¶è§¦å‘ âœ… åˆè§„ å¤©æ°”API è®¾å¤‡ è®¾å¤‡ç±»å‹ æ‰‹æœº&#x2F;å¹³æ¿&#x2F;PC âœ… åˆè§„ User Agent OSç‰ˆæœ¬ iOS&#x2F;Androidç‰ˆæœ¬ âœ… åˆè§„ è®¾å¤‡ä¿¡æ¯ ç½‘ç»œç¯å¢ƒ WiFi&#x2F;4G&#x2F;5G âœ… åˆè§„ ç½‘ç»œæ£€æµ‹ è¿è¥å•† ç§»åŠ¨&#x2F;è”é€š&#x2F;ç”µä¿¡ âœ… åˆè§„ è¿è¥å•†è¯†åˆ« æ—¶é—´ æ—¶æ®µå®šå‘ å°æ—¶&#x2F;å·¥ä½œæ—¥ âœ… åˆè§„ æ—¶é—´è®¾ç½® å­£èŠ‚å®šå‘ å­£èŠ‚&#x2F;èŠ‚æ—¥ âœ… åˆè§„ æ—¥å†åŒ¹é… å®æ—¶äº‹ä»¶ çƒ­ç‚¹äº‹ä»¶è§¦å‘ âœ… åˆè§„ äº‹ä»¶ç›‘æµ‹ éšç§å¢å¼º Clean Room æ•°æ®æ´å‡€å®¤ âœ… é«˜åˆè§„ å®‰å…¨è®¡ç®— Privacy Sandbox è°·æ­Œéšç§æ²™ç›’ âœ… é«˜åˆè§„ Topics API å·®åˆ†éšç§ éšç§ä¿æŠ¤ç»Ÿè®¡ âœ… é«˜åˆè§„ å·®åˆ†éšç§ è”é‚¦å­¦ä¹  åˆ†å¸ƒå¼å­¦ä¹  âœ… é«˜åˆè§„ è”é‚¦å­¦ä¹  åŒæ€åŠ å¯† åŠ å¯†è®¡ç®— âœ… é«˜åˆè§„ åŠ å¯†æŠ€æœ¯ 6 - æŒ‰å¹³å°ä¸“æœ‰æ¨¡å¼ å¹³å° æ¨¡å¼åˆ†ç±» å…·ä½“æ¨¡å¼ æ¥å…¥è¦æ±‚ æœ€å°é¢„ç®— Google æœç´¢ Search Ads Google Adsè´¦æˆ· $0 å±•ç¤º Display Network Google Adsè´¦æˆ· $0 è§†é¢‘ YouTube Ads Google Adsè´¦æˆ· $0 ç¨‹åºåŒ– DV360 è®¤è¯ä»£ç†å•† $50K&#x2F;æœˆ æŠ€æœ¯ Open Bidding GAMè´¦æˆ· varies æ•°æ® Google ADH æ´å‡€å®¤å‡†å…¥ $50K+ Amazon æœç´¢ Sponsored Products å–å®¶è´¦æˆ· $0 å±•ç¤º Sponsored Display å–å®¶&#x2F;å“ç‰Œè´¦æˆ· $0 è§†é¢‘ Sponsored TV å“ç‰Œè´¦æˆ· $35K+ ç¨‹åºåŒ– Amazon DSP DSPè´¦æˆ· $35K&#x2F;æœˆ æ•°æ® AMC æ´å‡€å®¤å‡†å…¥ $50K+ Meta ç¤¾äº¤ Feed Ads Ads Manager $0 è§†é¢‘ Reels Ads Ads Manager $0 ä¿é‡ Reach & Frequency å“ç‰Œè´¦æˆ· $100K+ AI Advantage+ Ads Manager $0 æ•°æ® Conversions API æŠ€æœ¯å¯¹æ¥ $0 è…¾è®¯ ç¤¾äº¤ æœ‹å‹åœˆå¹¿å‘Š è…¾è®¯å¹¿å‘Š $0 è§†é¢‘ è§†é¢‘å·å¹¿å‘Š è…¾è®¯å¹¿å‘Š $0 ä¿é‡ ä¼˜é€‰æµé‡ ç›´å®¢å›¢é˜Ÿ $100K+ æŠ€æœ¯ RTAå¯¹æ¥ æŠ€æœ¯å¯¹æ¥ $500K+ å­—èŠ‚ ä¿¡æ¯æµ æŠ–éŸ³ä¿¡æ¯æµ å·¨é‡å¼•æ“ $0 æœç´¢ æŠ–éŸ³æœç´¢ å·¨é‡å¼•æ“ $0 ä¿é‡ ç¨‹åºåŒ–ä¿é‡ ç›´å®¢å›¢é˜Ÿ $100K+ ç”µå•† æŠ–éŸ³å°åº— å°åº—è´¦æˆ· $0 å…¶ä»– è‹¹æœ Apple Search Ads App Store Connect $0 LinkedIn B2Bå¹¿å‘Š LinkedIn Ads $0 TikTok çŸ­è§†é¢‘å¹¿å‘Š TikTok Ads $0 Pinterest å›¾ç‰‡å¹¿å‘Š Pinterest Ads $0 Snapchat å¿«æ‹å¹¿å‘Š Snapchat Ads $0 7 - æŒ‰åœ°åŸŸ&#x2F;å¸‚åœºç‰¹æ®Šæ€§ åœ°åŒº ç‰¹æ®Šæ¨¡å¼ è¯´æ˜ åˆè§„æ¡†æ¶ ä»£è¡¨å¹³å° ä¸­å›½å¤§é™† å¼€å±GD å¼€å±ä¿é‡æŠ•æ”¾ ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³• å„å¤§App ä¿¡æ¯æµä¿é‡ å¤´æ¡&#x2F;æŠ–éŸ³ä¿é‡ ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³• å·¨é‡å¼•æ“ è”ç›Ÿå¹¿å‘Š ç½‘ç«™è”ç›Ÿæµé‡ å¹¿å‘Šæ³• ç™¾åº¦è”ç›Ÿ åˆ†ä¼—ç¨‹åºåŒ– ç”µæ¢¯å±ç¨‹åºåŒ– æˆ·å¤–å¹¿å‘Šç®¡ç† åˆ†ä¼—ä¼ åª’ å¾®ä¿¡ç”Ÿæ€ å°ç¨‹åº&#x2F;å…¬ä¼—å· å¾®ä¿¡å¹³å°è§„åˆ™ å¾®ä¿¡å¹¿å‘Š ç›´æ’­ç”µå•† ç›´æ’­å¸¦è´§åˆ†æˆ ç”µå•†æ³• æŠ–éŸ³&#x2F;å¿«æ‰‹ æ¬§æ´² GDPRäº¤æ˜“ éšç§ä¼˜å…ˆäº¤æ˜“ GDPR Criteo TCFæ¡†æ¶ åŒæ„ç®¡ç†æ¡†æ¶ IAB TCF å„DSP DMAåˆè§„ æ•°å­—å¸‚åœºæ³•æ¡ˆ DMA å„å¹³å° ç¾å›½ Upfront ç”µè§†å­£åº¦é¢„è´­ FCCè§„å®š NBC&#x2F;Disney NewFront æ•°å­—è§†é¢‘é¢„è´­ è‡ªå¾‹è§„èŒƒ YouTube&#x2F;Hulu CCPA åŠ å·éšç§äº¤æ˜“ CCPA&#x2F;CPRA å„å¹³å° æ—¥æœ¬ Yahoo!ç›´æŠ• æœ¬åœŸç¨‹åºåŒ– ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³• Yahoo! JAPAN LINEå¹¿å‘Š ç¤¾äº¤å¹¿å‘Š ç”µä¿¡äº‹ä¸šæ³• LINE ä¸œå—äºš Super App è¶…çº§åº”ç”¨å¹¿å‘Š å„å›½æ³•è§„ Grab&#x2F;Gojek ç”µå•†è”ç›Ÿ ç”µå•†è”ç›Ÿè¥é”€ å„å›½ç”µå•†æ³• Shopee&#x2F;Lazada ä¸­ä¸œ æœ¬åœ°åŒ–å†…å®¹ é˜¿æ‹‰ä¼¯è¯­å†…å®¹ ä¼Šæ–¯å…°æ³•è§„ Snapchat æ‹‰ç¾ ç§»åŠ¨æ”¯ä»˜ ç§»åŠ¨ä¼˜å…ˆäº¤æ˜“ å„å›½æ³•è§„ Mercado Libre 8 - æŒ‰è¡Œä¸šå‚ç›´é¢†åŸŸ è¡Œä¸š ç‰¹æ®Šè¦æ±‚ äº¤æ˜“æ¨¡å¼ åˆè§„è¦æ±‚ ä»£è¡¨æ¡ˆä¾‹ é‡‘è ç™½åå•åª’ä½“ è®¤è¯åª’ä½“äº¤æ˜“ é‡‘èç›‘ç®¡ é“¶è¡Œ&#x2F;ä¿é™© ç«å“æ’é™¤ æ’é™¤ç«å“åª’ä½“ å“ç‰Œå®‰å…¨ ä¿¡ç”¨å¡å…¬å¸ åˆè§„å®¡æ ¸ å¹¿å‘Šå†…å®¹å®¡æ ¸ é‡‘èå¹¿å‘Šè§„èŒƒ æŠ•èµ„äº§å“ åŒ»ç–— è®¤è¯åª’ä½“ åŒ»ç–—è®¤è¯åª’ä½“ HIPAA&#x2F;GDPR åˆ¶è¯å…¬å¸ å¤„æ–¹è¯é™åˆ¶ åœ°åŒºé™åˆ¶æŠ•æ”¾ è¯å“å¹¿å‘Šæ³• å¤„æ–¹è¯ æ‚£è€…éšç§ éšç§ä¿æŠ¤äº¤æ˜“ åŒ»ç–—éšç§æ³• åŒ»ç–—æœºæ„ æ±½è½¦ åœ°åŸŸç‹¬å  ç»é”€å•†åŒºåŸŸä¿æŠ¤ ç»é”€åè®® æ±½è½¦å“ç‰Œ è½¦å‹å®šå‘ æŒ‰è½¦å‹å®šå‘ å“ç‰Œç­–ç•¥ æ–°è½¦å‘å¸ƒ ç«å“æ’é™¤ æ’é™¤ç«å“å“ç‰Œ å“ç‰Œä¿æŠ¤ è±ªåè½¦ å¿«æ¶ˆ é›¶å”®ä¼˜å…ˆ é›¶å”®åª’ä½“ä¼˜å…ˆ é›¶å”®åè®® å®æ´&#x2F;è”åˆåˆ©å ä¿ƒé”€è”åŠ¨ ä¿ƒé”€æ´»åŠ¨è”åŠ¨ ä¿ƒé”€æ³•è§„ èŠ‚æ—¥ä¿ƒé”€ æ¸¸æˆ å¹´é¾„é™åˆ¶ æœªæˆå¹´äººä¿æŠ¤ æ¸¸æˆåˆ†çº§ æ‰‹æ¸¸å…¬å¸ IAPåˆ†æˆ åº”ç”¨å†…è´­ä¹°åˆ†æˆ å¹³å°æ”¿ç­– æ¸¸æˆå¼€å‘å•† B2B ABMå®šå‘ è´¦æˆ·åŸºè¥é”€ ä¼ä¸šæ•°æ®åˆè§„ Salesforce å†³ç­–è€…å®šå‘ é«˜ç®¡&#x2F;å†³ç­–è€… èŒä¸šæ•°æ®åˆè§„ LinkedIn ç”µå•† å•†å“çº§ç«ä»· å•†å“ç»´åº¦ç«ä»· ç”µå•†æ”¿ç­– Amazon è½¬åŒ–è¿½è¸ª å…¨é“¾è·¯è¿½è¸ª éšç§åˆè§„ å„ç”µå•†å¹³å° æ•™è‚² å¹´é¾„é™åˆ¶ æœªæˆå¹´äººä¿æŠ¤ æ•™è‚²å¹¿å‘Šè§„èŒƒ åœ¨çº¿æ•™è‚² èµ„è´¨å®¡æ ¸ æ•™è‚²æœºæ„èµ„è´¨ æ•™è‚²æ³•è§„ åŸ¹è®­æœºæ„ æˆ¿åœ°äº§ åœ°åŸŸå®šå‘ æ¥¼ç›˜åŒºåŸŸå®šå‘ æˆ¿åœ°äº§å¹¿å‘Šæ³• æˆ¿äº§ä¸­ä»‹ èµ„è´¨å®¡æ ¸ å¼€å‘å•†èµ„è´¨ æˆ¿åœ°äº§æ³•è§„ å¼€å‘å•† 9 - è”ç›Ÿè¥é”€ä¸Affiliate ç±»å‹ å…·ä½“æ¨¡å¼ ä»˜è´¹æ–¹å¼ ä»£è¡¨å¹³å° ä½£é‡‘èŒƒå›´ CPSè”ç›Ÿ é”€å”®åˆ†æˆ é”€å”®é¢% Amazon Associates 3-10% ç”µå•†è”ç›Ÿ é”€å”®é¢% æ·˜å®å®¢ 5-20% æ¯”ä»·è”ç›Ÿ é”€å”®é¢% Google Shopping 5-15% CPLè”ç›Ÿ çº¿ç´¢ä»˜è´¹ æ¯çº¿ç´¢$ MaxBounty $5-100 è¡¨å•æäº¤ æ¯è¡¨å•$ ClickDealer $10-50 è¯•ç”¨æ³¨å†Œ æ¯æ³¨å†Œ$ å„SaaS $20-200 CPIè”ç›Ÿ åº”ç”¨å®‰è£… æ¯å®‰è£…$ Adjust $1-10 åº”ç”¨æ¿€æ´» æ¯æ¿€æ´»$ AppsFlyer $2-20 å†…å®¹è”ç›Ÿ å†…å®¹æ¨è CPC&#x2F;CPM Taboola $0.1-1 åŸç”Ÿå¹¿å‘Š CPC&#x2F;CPM Outbrain $0.1-1 è¿”åˆ©è”ç›Ÿ æ¶ˆè´¹è¿”åˆ© æ¶ˆè´¹é¢% è¿”åˆ©ç½‘ 1-10% ç°é‡‘è¿”è¿˜ æ¶ˆè´¹é¢% Rakuten 1-15% ç¤¾äº¤è”ç›Ÿ ç¤¾äº¤å¸¦è´§ é”€å”®é¢% æŠ–éŸ³å¸¦è´§ 10-30% KOLåˆ†æˆ é”€å”®é¢% å°çº¢ä¹¦ 15-40% ç›´æ’­åˆ†æˆ é”€å”®é¢% å¿«æ‰‹è”ç›Ÿ 20-50% é‚®ä»¶è”ç›Ÿ EDMè¥é”€ CPC&#x2F;CPA Mailchimp varies è®¢é˜…æ¨å¹¿ æ¯è®¢é˜…$ å„é‚®ä»¶å¹³å° $1-5 æœç´¢è”ç›Ÿ æœç´¢å¼•æµ CPC ç™¾åº¦è”ç›Ÿ $0.1-5 åŸŸååœæ”¾ ç‚¹å‡»åˆ†æˆ Google AdSense varies 10 - ç¦»çº¿&#x2F;ä¼ ç»Ÿåª’ä½“ç¨‹åºåŒ– åª’ä½“ç±»å‹ ç¨‹åºåŒ–ç¨‹åº¦ äº¤æ˜“æ¨¡å¼ æŠ€æœ¯å®ç° ä»£è¡¨å…¬å¸ æ¥¼å®‡ç”µæ¢¯ é«˜ åˆ†ä¼—ç¨‹åºåŒ– äº‘ç«¯æŠ•æ”¾ åˆ†ä¼—ä¼ åª’ é«˜ æ–°æ½®ç¨‹åºåŒ– äº‘ç«¯æŠ•æ”¾ æ–°æ½®ä¼ åª’ å½±é™¢å¹¿å‘Š ä¸­ æ˜ å‰ç¨‹åºåŒ– æ•°å­—æ‹·è´ ä¸‡è¾¾ç”µå½± ä¸­ è´´ç‰‡ç¨‹åºåŒ– æ•°å­—æŠ•æ”¾ çŒ«çœ¼å¨±ä¹ äº¤é€šåª’ä½“ ä¸­ åœ°é“å±ç¨‹åºåŒ– è¿œç¨‹æ›´æ–° å¾·é«˜ ä¸­ å…¬äº¤å±ç¨‹åºåŒ– è¿œç¨‹æ›´æ–° Clear Channel ä½ å‡ºç§Ÿè½¦å±ç¨‹åºåŒ– 4Gä¼ è¾“ å„åœ°è¿è¥å•† æœºåœºåª’ä½“ ä¸­ æœºåœºå±ç¨‹åºåŒ– äº‘ç«¯æŠ•æ”¾ å¾·é«˜ ä¸­ ç™»æœºå£å±ç¨‹åºåŒ– è¿œç¨‹æ›´æ–° é›…ä»•ç»´ æ•°å­—å°åˆ· ä½ ç¨‹åºåŒ–ç›´é‚® æ•°æ®é©±åŠ¨ USPS ä½ ä¸ªæ€§åŒ–å°åˆ· æ•°æ®åŒ¹é… å„å°åˆ·å•† å¹¿æ’­å¹¿å‘Š ä¸­ ç¨‹åºåŒ–å¹¿æ’­ æ•°å­—éŸ³é¢‘ iHeartRadio ä¸­ æ’­å®¢ç¨‹åºåŒ– åŠ¨æ€æ’å…¥ Spotify æ™ºèƒ½éŸ³ç®± ä½ è¯­éŸ³å¹¿å‘Š æŠ€èƒ½è§¦å‘ Alexa ä½ éŸ³é¢‘æ’æ’­ å†…å®¹é—´éš™ å°çˆ±åŒå­¦ é›¶å”®ç»ˆç«¯ ä¸­ æ•°å­—è´§æ¶ äº‘ç«¯æ›´æ–° æ²ƒå°”ç› ä¸­ ç”µå­ä»·ç­¾ æ— çº¿æ›´æ–° å„é›¶å”®å•† é«˜ è‡ªåŠ©ç»“è´¦å± å®æ—¶è§¦å‘ å„è¶…å¸‚ 11 - æµ‹é‡ä¸å½’å› ç›¸å…³äº¤æ˜“ ç±»å‹ å…·ä½“æ¨¡å¼ æµ‹é‡æŒ‡æ ‡ ä»˜è´¹ä¾æ® ä»£è¡¨æ–¹æ¡ˆ æ•ˆæœä¿é‡ CPAä¿é‡ è½¬åŒ–æ•° ä¿è¯CPA å„DSP ROASä¿é‡ å¹¿å‘Šå›æŠ¥ç‡ ä¿è¯ROAS Google&#x2F;Meta çº¿ç´¢ä¿é‡ çº¿ç´¢æ•°é‡ ä¿è¯CPL B2Bå¹³å° å½’å› åˆ†æˆ å•è§¦ç‚¹å½’å›  æœ€åç‚¹å‡» å½’å› ç»“æœ Google Analytics å¤šè§¦ç‚¹å½’å›  å¤šè§¦ç‚¹åˆ†é… å½’å› ç»“æœ Adobe Analytics æ•°æ®é©±åŠ¨å½’å›  ç®—æ³•åˆ†é… å½’å› ç»“æœ Google DDA å¢é‡æµ‹é‡ Geo Lift åœ°ç†å®éªŒ å¢é‡æ•ˆæœ Meta Geo Lift Conversion Lift è½¬åŒ–å®éªŒ å¢é‡è½¬åŒ– Google Lift Brand Lift å“ç‰Œè°ƒç ” å“ç‰Œæå‡ å„å¹³å° å¯è§åº¦ä¿è¯ Viewability å¯è§ç‡ MRCæ ‡å‡† IAS&#x2F;DV Active View è°·æ­Œå¯è§åº¦ è°·æ­Œæ ‡å‡† Google åæ¬ºè¯ˆä¿è¯ IVTæ£€æµ‹ æ— æ•ˆæµé‡ åæ¬ºè¯ˆè®¤è¯ IAS&#x2F;DV&#x2F;Moat å“ç‰Œå®‰å…¨ å†…å®¹å®‰å…¨ å®‰å…¨åˆ†çº§ å„éªŒè¯å•† å“ç‰Œæµ‹é‡ å“ç‰Œæå‡ å“ç‰ŒæŒ‡æ ‡ è°ƒç ”ç»“æœ Nielsen å¹¿å‘Šå›å¿† è®°å¿†åº¦ è°ƒç ”ç»“æœ Kantar è´­ä¹°æ„å‘ æ„å‘åº¦ è°ƒç ”ç»“æœ Ipsos 12 - æ–°å…´æŠ€æœ¯é©±åŠ¨äº¤æ˜“ æŠ€æœ¯ äº¤æ˜“æ¨¡å¼ æˆç†Ÿåº¦ ä»£è¡¨æ¡ˆä¾‹ é¢„è®¡æ™®åŠ AIç”Ÿæˆåˆ›æ„ DCOç¨‹åºåŒ– ğŸŸ¢ æˆç†Ÿ Google DCO 2025æ™®åŠ AIç«ä»·ä¼˜åŒ– æ™ºèƒ½å‡ºä»· ğŸŸ¢ æˆç†Ÿ Google PMax å·²æ™®åŠ AIå—ä¼—æ‰©å±• ç›¸ä¼¼äººç¾¤ ğŸŸ¢ æˆç†Ÿ Meta LAL å·²æ™®åŠ Clean Room æ•°æ®æ´å‡€å®¤ ğŸŸ¡ æˆé•¿ Amazon AMC 2026æ™®åŠ éšç§æ²™ç›’ Topics API ğŸŸ¡ æˆé•¿ Google Chrome 2026æ™®åŠ è·¨è®¾å¤‡ID ç»Ÿä¸€ID ğŸŸ¡ æˆé•¿ UID2.0 2026æ™®åŠ CTVç¨‹åºåŒ– è”ç½‘ç”µè§† ğŸŸ¢ çˆ†å‘ Roku 2025çˆ†å‘ é›¶å”®åª’ä½“ RMNç¨‹åºåŒ– ğŸŸ¢ çˆ†å‘ Walmart 2025çˆ†å‘ DOOHç¨‹åºåŒ– æ•°å­—æˆ·å¤– ğŸŸ¡ æˆé•¿ JCDecaux 2026æˆé•¿ æ¸¸æˆå†…ç¨‹åºåŒ– æ¸¸æˆå¹¿å‘Š ğŸŸ¡ æˆé•¿ Unity 2026æˆé•¿ å¯è´­ç‰©å¹¿å‘Š è¾¹çœ‹è¾¹ä¹° ğŸŸ¢ çˆ†å‘ TikTok Shop 2025çˆ†å‘ æš‚åœå¹¿å‘Š CTVæš‚åœ ğŸ”´ æ–°å…´ NBCU 2027æ–°å…´ åŒºå—é“¾éªŒè¯ é“¾ä¸ŠéªŒè¯ ğŸ”´ æ¢ç´¢ BAT 2028+ Web3å¹¿å‘Š å»ä¸­å¿ƒåŒ– ğŸ”´ æ¢ç´¢ å…ƒå®‡å®™ 2028+ æ•°å­—äººå¹¿å‘Š è™šæ‹Ÿå¶åƒ ğŸŸ¡ æˆé•¿ æŸ³å¤œç†™ 2026æˆé•¿ 5Gæ¶ˆæ¯å¹¿å‘Š çŸ­ä¿¡ç¨‹åºåŒ– ğŸŸ¡ æˆé•¿ ä¸­å›½ç§»åŠ¨ 2026æˆé•¿ è½¦è”ç½‘å¹¿å‘Š è½¦è½½å±å¹• ğŸŸ¡ æˆé•¿ Tesla 2026æˆé•¿ æ™ºèƒ½å®¶å±…å¹¿å‘Š IoTè®¾å¤‡ ğŸ”´ æ—©æœŸ Google Nest 2027+ ARå¹¿å‘Š å¢å¼ºç°å® ğŸŸ¡ æˆé•¿ Snapchat 2026æˆé•¿ VRå¹¿å‘Š è™šæ‹Ÿç°å® ğŸ”´ æ—©æœŸ Meta Quest 2027+ 13 - åˆåŒæ¡æ¬¾ç»´åº¦ æ¡æ¬¾ç±»å‹ å…·ä½“æ¨¡å¼ è¯´æ˜ é€‚ç”¨åœºæ™¯ ä¿é‡æ¡æ¬¾ 100%ä¿é‡ å®Œå…¨ä¿é‡ å“ç‰Œå¹¿å‘Š 80%ä¿é‡ éƒ¨åˆ†ä¿é‡ æ•ˆæœå¹¿å‘Š ä¸ä¿é‡ æŒ‰å®é™…æŠ•æ”¾ ç«ä»·å¹¿å‘Š ä¿ä»·æ¡æ¬¾ å›ºå®šä»·æ ¼ ä»·æ ¼é”å®š PDB&#x2F;PD æµ®åŠ¨ä»·æ ¼ ä»·æ ¼æµ®åŠ¨ PA&#x2F;RTB ä»·æ ¼ä¸Šé™ æœ€é«˜é™ä»· é¢„ç®—æ§åˆ¶ æ—¶é—´æ¡æ¬¾ å›ºå®šæ—¶æ®µ æŒ‡å®šæ—¶é—´æŠ•æ”¾ äº‹ä»¶è¥é”€ çµæ´»æ—¶æ®µ æ—¶æ®µå¯è°ƒæ•´ ä¼˜åŒ–æŠ•æ”¾ 24&#x2F;7æŠ•æ”¾ å…¨å¤©å€™æŠ•æ”¾ å…¨çƒå¹¿å‘Š åœ°åŸŸæ¡æ¬¾ å…¨çƒæŠ•æ”¾ æ— åœ°åŸŸé™åˆ¶ å›½é™…å“ç‰Œ åŒºåŸŸé™å®š æŒ‡å®šåŒºåŸŸ æœ¬åœ°å•†å®¶ åœ°åŸŸç‹¬å  åŒºåŸŸç‹¬å®¶ ç»é”€å•† æ’ä»–æ¡æ¬¾ å“ç±»æ’ä»– åŒç±»ç«å“æ’é™¤ å“ç‰Œä¿æŠ¤ åª’ä½“æ’ä»– ç‰¹å®šåª’ä½“ç‹¬å  èµåŠ©å¹¿å‘Š æ—¶æ®µæ’ä»– æ—¶æ®µç‹¬å  é»„é‡‘æ—¶æ®µ æ•ˆæœæ¡æ¬¾ CPAä¿è¯ ä¿è¯è½¬åŒ–æˆæœ¬ æ•ˆæœå¹¿å‘Š ROASä¿è¯ ä¿è¯å›æŠ¥ç‡ ç”µå•†å¹¿å‘Š å“ç‰Œæå‡ä¿è¯ ä¿è¯å“ç‰ŒæŒ‡æ ‡ å“ç‰Œå¹¿å‘Š ç»ˆæ­¢æ¡æ¬¾ æå‰ç»ˆæ­¢ å¯æå‰ç»“æŸ çµæ´»åˆä½œ è¿çº¦ç»ˆæ­¢ è¿çº¦å¯ç»ˆæ­¢ é£é™©æ§åˆ¶ è‡ªåŠ¨ç»­çº¦ åˆ°æœŸè‡ªåŠ¨ç»­ é•¿æœŸåˆä½œ 14 - åº“å­˜ç±»å‹ç»†åˆ† åº“å­˜ç±»å‹ ç»†åˆ† äº¤æ˜“æ¨¡å¼ ä»·æ ¼åŒºé—´ è¯´æ˜ å±•ç¤ºåº“å­˜ é¦–å± ä¼˜å…ˆäº¤æ˜“ $$$$ é¦–å±ä½ç½® æ¬¡å± æ ‡å‡†äº¤æ˜“ $$$ æ¬¡å±ä½ç½® åº•éƒ¨ ä½ä»·äº¤æ˜“ $$ åº•éƒ¨ä½ç½® è§†é¢‘åº“å­˜ å‰è´´ æ ‡å‡†ç«ä»· $$$ è§†é¢‘å‰ ä¸­è´´ é«˜ä»·ç«ä»· $$$$ è§†é¢‘ä¸­ åè´´ ä½ä»·ç«ä»· $$ è§†é¢‘å æš‚åœ æ–°å…´äº¤æ˜“ $$$ æš‚åœæ—¶ æœç´¢åº“å­˜ é¡¶éƒ¨ é«˜ä»·ç«ä»· $$$$ æœç´¢é¡¶éƒ¨ åº•éƒ¨ ä½ä»·ç«ä»· $$ æœç´¢åº•éƒ¨ ä¾§è¾¹ ä¸­ä»·ç«ä»· $$$ æœç´¢ä¾§è¾¹ åŸç”Ÿåº“å­˜ ä¿¡æ¯æµ æ ‡å‡†ç«ä»· $$$ å†…å®¹æµä¸­ æ¨èä½ ä¼˜å…ˆäº¤æ˜“ $$$$ æ¨èä½ç½® å¼€å±åº“å­˜ å†·å¯åŠ¨ é«˜ä»·ä¿é‡ $$$$$ Appå¯åŠ¨ çƒ­å¯åŠ¨ ä¸­ä»·ä¿é‡ $$$$ Appåˆ‡æ¢ ç‰¹æ®Šåº“å­˜ èŠ‚æ—¥èµ„æº å­£èŠ‚å®šä»· $$$$$ èŠ‚æ—¥ç‹¬å  äº‹ä»¶èµ„æº äº‹ä»¶å®šä»· $$$$$ çƒ­ç‚¹äº‹ä»¶ æµ‹è¯•åº“å­˜ ä½ä»·æµ‹è¯• $ æµ‹è¯•ç”¨é€” 15 - æ—¶é—´ç»´åº¦äº¤æ˜“ æ—¶é—´ç»´åº¦ å…·ä½“æ¨¡å¼ ä»·æ ¼ç³»æ•° é€‚ç”¨åœºæ™¯ æ—¶æ®µ é»„é‡‘æ—¶æ®µ 2-5x æ™šé—´é«˜å³° æ™®é€šæ—¶æ®µ 1x æ—¥å¸¸æ—¶æ®µ ä½è°·æ—¶æ®µ 0.3-0.5x æ·±å¤œå‡Œæ™¨ å·¥ä½œæ—¥ å·¥ä½œæ—¥ 1.2-1.5x å‘¨ä¸€è‡³å‘¨äº” å‘¨æœ« 0.8-1.2x å‘¨å…­å‘¨æ—¥ å­£èŠ‚ æ—ºå­£ 2-3x åŒ11&#x2F;é»‘äº” å¹³å­£ 1x å¸¸è§„å­£èŠ‚ æ·¡å­£ 0.5-0.8x æ˜¥èŠ‚ç­‰ èŠ‚æ—¥ é‡å¤§èŠ‚æ—¥ 3-5x æ˜¥èŠ‚&#x2F;åœ£è¯ ä¸€èˆ¬èŠ‚æ—¥ 1.5-2x æƒ…äººèŠ‚ç­‰ äº‹ä»¶ çƒ­ç‚¹äº‹ä»¶ 5-10x å¥¥è¿ä¼šç­‰ å¸¸è§„äº‹ä»¶ 1.5-3x æ—¥å¸¸æ´»åŠ¨ 16 - è®¾å¤‡&#x2F;OSç»†åˆ† ç»´åº¦ ç»†åˆ† äº¤æ˜“æ¨¡å¼ ä»·æ ¼å·®å¼‚ è¯´æ˜ è®¾å¤‡ç±»å‹ æ‰‹æœº ç§»åŠ¨ç«ä»· 1x æ™ºèƒ½æ‰‹æœº å¹³æ¿ å¹³æ¿ç«ä»· 1.2x å¹³æ¿è®¾å¤‡ PC æ¡Œé¢ç«ä»· 1.5x å°å¼&#x2F;ç¬”è®°æœ¬ CTV CTVç«ä»· 2x è”ç½‘ç”µè§† æ¸¸æˆä¸»æœº ä¸»æœºç«ä»· 2.5x PS&#x2F;Xboxç­‰ OSç±»å‹ iOS iOSç«ä»· 1.5x è‹¹æœè®¾å¤‡ Android Androidç«ä»· 1x å®‰å“è®¾å¤‡ Windows Windowsç«ä»· 1.3x å¾®è½¯ç³»ç»Ÿ macOS macOSç«ä»· 1.5x è‹¹æœç”µè„‘ OSç‰ˆæœ¬ æœ€æ–°ç‰ˆ é«˜ä»·ç«ä»· 1.5x æœ€æ–°ç³»ç»Ÿ æ—§ç‰ˆæœ¬ ä½ä»·ç«ä»· 0.8x æ—§ç³»ç»Ÿ å±å¹•å°ºå¯¸ å°å± ä½ä»·ç«ä»· 0.8x <5è‹±å¯¸ ä¸­å± æ ‡å‡†ç«ä»· 1x 5-7è‹±å¯¸ å¤§å± é«˜ä»·ç«ä»· 1.3x >7è‹±å¯¸ 17 - ç½‘ç»œç¯å¢ƒç»†åˆ† ç½‘ç»œç±»å‹ å…·ä½“æ¨¡å¼ ä»·æ ¼å·®å¼‚ é€‚ç”¨åœºæ™¯ WiFi WiFiå®šå‘ 1x å®¶åº­&#x2F;åŠå…¬ 4G 4Gå®šå‘ 1.2x ç§»åŠ¨ç½‘ç»œ 5G 5Gå®šå‘ 1.5x é«˜é€Ÿç½‘ç»œ è¿è¥å•† ç§»åŠ¨å®šå‘ varies ä¸­å›½ç§»åŠ¨ è”é€šå®šå‘ varies ä¸­å›½è”é€š ç”µä¿¡å®šå‘ varies ä¸­å›½ç”µä¿¡ ç½‘ç»œè´¨é‡ é«˜é€Ÿç½‘ç»œ é«˜ä»· è§†é¢‘å¹¿å‘Š ä½é€Ÿç½‘ç»œ ä½ä»· é™æ€å¹¿å‘Š 18 - ç”¨æˆ·çŠ¶æ€ç»†åˆ† ç”¨æˆ·ç±»å‹ å…·ä½“æ¨¡å¼ ä»·æ ¼å·®å¼‚ è¯´æ˜ æ–°ç”¨æˆ· æ–°å®¢å®šå‘ 1.5x é¦–æ¬¡è®¿é—® è€ç”¨æˆ· è€å®¢å®šå‘ 1x å›è®¿ç”¨æˆ· æ´»è·ƒç”¨æˆ· æ´»è·ƒå®šå‘ 1.2x é«˜é¢‘ä½¿ç”¨ æ²‰ç¡ç”¨æˆ· å”¤é†’å®šå‘ 2x æµå¤±å¬å› é«˜ä»·å€¼ç”¨æˆ· VIPå®šå‘ 3x é«˜æ¶ˆè´¹ç”¨æˆ· ä½ä»·å€¼ç”¨æˆ· ä½ä»·å®šå‘ 0.5x ä½æ¶ˆè´¹ç”¨æˆ· ğŸ“ˆ æœ€ç»ˆè¦†ç›–åº¦è¯„ä¼° ç»´åº¦ æ¨¡å¼æ•°é‡ è¦†ç›–åº¦ å¤‡æ³¨ L1 äº¤æ˜“è‡ªåŠ¨åŒ– 16 99% æ ¸å¿ƒå±‚å®Œæ•´ L2 ç«ä»·æŠ€æœ¯ 25 99% åè®®æ ‡å‡†å®Œæ•´ L3 åª’ä½“ç±»å‹ 80+ 99% è¶…ç»†åˆ†å®Œæ•´ L4 ä»˜è´¹æ¨¡å¼ 25 99% æ‰€æœ‰ä»˜è´¹ç±»å‹ L5 æ•°æ®å®šå‘ 40+ 99% éšç§åˆè§„å®Œæ•´ L6 å¹³å°ä¸“æœ‰ 35+ 99% ä¸»æµå¹³å°å®Œæ•´ L7 åœ°åŸŸç‰¹æ®Š 20+ 98% ä¸»è¦å¸‚åœºå®Œæ•´ L8 è¡Œä¸šå‚ç›´ 15+ 98% ä¸»è¦è¡Œä¸šå®Œæ•´ L9 è”ç›Ÿè¥é”€ 20+ 99% è”ç›Ÿç±»å‹å®Œæ•´ L10 ç¦»çº¿åª’ä½“ 15+ 97% ä¼ ç»Ÿåª’ä½“å®Œæ•´ L11 æµ‹é‡å½’å›  20+ 99% æµ‹é‡æ–¹æ¡ˆå®Œæ•´ L12 æ–°å…´æŠ€æœ¯ 20+ 95% æŒç»­æ¼”è¿›ä¸­ L13 åˆåŒæ¡æ¬¾ 20+ 99% æ¡æ¬¾ç±»å‹å®Œæ•´ L14 åº“å­˜ç»†åˆ† 20+ 99% åº“å­˜ç±»å‹å®Œæ•´ L15 æ—¶é—´ç»´åº¦ 15+ 99% æ—¶é—´å› ç´ å®Œæ•´ L16 è®¾å¤‡OS 20+ 99% è®¾å¤‡ç»´åº¦å®Œæ•´ L17 ç½‘ç»œç¯å¢ƒ 10+ 99% ç½‘ç»œç»´åº¦å®Œæ•´ L18 ç”¨æˆ·çŠ¶æ€ 10+ 99% ç”¨æˆ·ç»´åº¦å®Œæ•´ æ€»è®¡ 400+ 99% ç»ˆæå®Œæ•´ è¯´æ˜ ä½¿ç”¨åœºæ™¯ æ¨èç»´åº¦ è¯´æ˜ æˆ˜ç•¥è§„åˆ’ L1+L3+L6 æ ¸å¿ƒäº¤æ˜“+åª’ä½“+å¹³å° æŠ€æœ¯å¯¹æ¥ L2+L5+L16 æŠ€æœ¯+æ•°æ®+è®¾å¤‡ å•†åŠ¡è°ˆåˆ¤ L1+L4+L13 äº¤æ˜“+ä»˜è´¹+åˆåŒ æ•ˆæœä¼˜åŒ– L5+L11+L18 å®šå‘+æµ‹é‡+ç”¨æˆ· æ–°å…´å¸ƒå±€ L12+L3+L7 æ–°å…´+åª’ä½“+åœ°åŸŸ åˆè§„ç®¡ç† L5+L7+L8 æ•°æ®+åœ°åŸŸ+è¡Œä¸š","date":"2026-02-19","categories":["å¹¿å‘Š"],"tags":["å¹¿å‘Š"]},{"title":"å¹¿å‘Šï¼ˆ3ï¼‰-å¹¿å‘Šç›¸å…³çš„è§’è‰²","url":"/2026/02/19/å¹¿å‘Š3-å¹¿å‘Šç›¸å…³çš„è§’è‰²/","content":"å¹¿å‘Šç³»ç»Ÿç”Ÿæ€è§’è‰²åˆ—è¡¨ä¸€ã€éœ€æ±‚ä¾§è§’è‰² (Buy-Side) åºå· æœ¯è¯­ å®šä¹‰ ä»£è¡¨å‚å•† 1.1 Advertiser (å¹¿å‘Šä¸») å‡ºé’±æŠ•æ”¾å¹¿å‘Šçš„ä¼ä¸šæˆ–ä¸ªäºº æ‰€æœ‰å“ç‰Œæ–¹ 1.2 DSP (Demand-Side Platform) éœ€æ±‚æ–¹å¹³å°ï¼Œä»£è¡¨å¹¿å‘Šä¸»è‡ªåŠ¨è´­ä¹°å¹¿å‘Šæµé‡ The Trade Deskã€DV360ã€Xandr 1.3 TD&#x2F;ATD (Trading Desk) ç¨‹åºåŒ–äº¤æ˜“å°ï¼Œä¸ºå¤§å‹å¹¿å‘Šä¸»ç»Ÿä¸€ç®¡ç†å¤šä¸ªDSP é˜³ç‹®ã€ç”µé€šã€WPPæ——ä¸‹äº¤æ˜“å° 1.4 Agency (å¹¿å‘Šä»£ç†å…¬å¸) ä»£è¡¨å¹¿å‘Šä¸»ç­–åˆ’ã€æ‰§è¡Œå¹¿å‘Šæ´»åŠ¨çš„ä¸“ä¸šæœåŠ¡å•† å¥¥ç¾ã€æå¥¥è´çº³ã€è“æ ‡ 1.5 In-House Media Team (è‡ªå»ºåª’ä½“å›¢é˜Ÿ) å¹¿å‘Šä¸»å†…éƒ¨è‡ªå»ºç¨‹åºåŒ–æŠ•æ”¾å›¢é˜Ÿ å¤§å‹å“ç‰Œè‡ªå»ºå›¢é˜Ÿ 1.6 Media Buying Platform (åª’ä»‹è´­ä¹°å¹³å°) æ•´åˆå¤šæ¸ é“åª’ä»‹è´­ä¹°çš„SaaSå¹³å° å„ç§åª’ä»‹ç®¡ç†SaaS äºŒã€ä¾›ç»™ä¾§è§’è‰² (Sell-Side) åºå· æœ¯è¯­ å®šä¹‰ ä»£è¡¨å‚å•† 2.1 Publisher (åª’ä½“&#x2F;å‘å¸ƒå•†) æ‹¥æœ‰æµé‡çš„ç½‘ç«™ã€Appå¼€å‘è€… å„ç±»åª’ä½“ã€å†…å®¹å¹³å° 2.2 SSP (Supply-Side Platform) ä¾›åº”æ–¹å¹³å°ï¼Œä»£è¡¨åª’ä½“è‡ªåŠ¨å”®å–å¹¿å‘Šæµé‡ Magniteã€PubMaticã€Xandr 2.3 Ad Server-Sell (å–æ–¹å¹¿å‘ŠæœåŠ¡å™¨) åª’ä½“ä¾§å¹¿å‘ŠæŠ•æ”¾ä¸åº“å­˜ç®¡ç†ç³»ç»Ÿ Google Ad Managerã€Freewheel 2.4 Ad Network (å¹¿å‘Šç½‘ç»œ) èšåˆå¤šä¸ªåª’ä½“æµé‡çš„ä¼ ç»Ÿå¹¿å‘Šèšåˆå¹³å° Google AdSenseã€Taboolaã€Outbrain 2.5 Header Bidding Wrapper (é¦–ä»·ç«ä»·å°è£…å™¨) å¸®åŠ©å‘å¸ƒå•†å¹¶è¡Œè°ƒç”¨å¤šä¸ªSSP&#x2F;DSPå®ç°å…¬å¹³ç«ä»· Prebid.jsã€Amazon UAM 2.6 Ad Inventory Management (å¹¿å‘Šåº“å­˜ç®¡ç†ç³»ç»Ÿ) ç®¡ç†åª’ä½“å¹¿å‘Šä½åº“å­˜ã€æ’æœŸã€å®šä»· å„ç±»åº“å­˜ç®¡ç†SaaS 2.7 Yield Optimization Platform (æ”¶ç›Šä¼˜åŒ–å¹³å°) å¸®åŠ©å‘å¸ƒå•†æœ€å¤§åŒ–å¹¿å‘Šæ”¶ç›Š Ezoicã€Mediavineã€AdThrive 2.8 Content Management System (CMS) å†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œå½±å“å¹¿å‘Šä½å¸ƒå±€ WordPressã€Drupal ä¸‰ã€äº¤æ˜“ä¾§è§’è‰² (Trading&#x2F;Exchange) åºå· æœ¯è¯­ å®šä¹‰ ä»£è¡¨å‚å•† 3.1 ADX (Ad Exchange) å¹¿å‘Šäº¤æ˜“å¹³å°ï¼Œæ’®åˆDSPä¸SSPçš„ä¸­ç«‹äº¤æ˜“å¸‚åœº Google AdXã€Xandrã€OpenX 3.2 PMP (Private Marketplace) ç§æœ‰äº¤æ˜“å¸‚åœºï¼Œé‚€è¯·åˆ¶ä¼˜è´¨æµé‡äº¤æ˜“ å„å¤§ADXå‡æä¾›PMPåŠŸèƒ½ 3.3 PG (Programmatic Guaranteed) ç¨‹åºåŒ–ä¿é‡ï¼Œä¿è¯æ›å…‰é‡+ç¨‹åºåŒ–æ•ˆç‡ å„å¤§DSP&#x2F;SSPæ”¯æŒ 3.4 OpenDirect IABæ ‡å‡†çš„ç¨‹åºåŒ–ç›´æ¥äº¤æ˜“åè®® IAB Tech Labæ ‡å‡† 3.5 SPO Provider (Supply Path Optimization) ä¾›åº”è·¯å¾„ä¼˜åŒ–æœåŠ¡ï¼Œå‡å°‘ä¸­é—´ç¯èŠ‚æŸè€— The Trade Desk SPOã€Magnite SPO 3.6 Bidder Infrastructure (ç«ä»·åŸºç¡€è®¾æ–½) æä¾›å®æ—¶ç«ä»·æŠ€æœ¯åº•å±‚æœåŠ¡ OpenXã€MagniteåŸºç¡€è®¾æ–½ å››ã€æ•°æ®å±‚è§’è‰² (Data Layer) åºå· æœ¯è¯­ å®šä¹‰ ä»£è¡¨å‚å•† 4.1 DMP (Data Management Platform) æ•°æ®ç®¡ç†å¹³å°ï¼Œå­˜å‚¨ç”¨æˆ·æ ‡ç­¾ã€æä¾›äººç¾¤å®šå‘èƒ½åŠ›ï¼ˆä¾§é‡ç¬¬ä¸‰æ–¹æ•°æ®ï¼‰ Adobe Audience Managerã€Oracle DMP 4.2 CDP (Customer Data Platform) å®¢æˆ·æ•°æ®å¹³å°ï¼Œæ•´åˆç¬¬ä¸€æ–¹æ•°æ®ï¼Œæ„å»ºç»Ÿä¸€å®¢æˆ·è§†å›¾ Segmentã€Tealiumã€Salesforce CDP 4.3 Clean Room (æ•°æ®æ´å‡€å®¤) éšç§å®‰å…¨çš„æ•°æ®åä½œç¯å¢ƒï¼Œå¤šæ–¹æ•°æ®åŒ¹é…ä¸æš´éœ²åŸå§‹æ•°æ® Google Ads Data Hubã€Amazon Marketing Cloudã€InfoSumã€Habu 4.4 Identity Resolution Provider (èº«ä»½è§£ææœåŠ¡å•†) èº«ä»½è¯†åˆ«ä¸è·¨è®¾å¤‡åŒ¹é…æœåŠ¡ LiveRampã€The Trade Desk UID2.0ã€Zeotap 4.5 Data Onboarding Service (æ•°æ®å¯¼å…¥æœåŠ¡) å°†çº¿ä¸‹æ•°æ®å¯¼å…¥æ•°å­—å¹¿å‘Šç³»ç»Ÿ LiveRampã€InfoSum 4.6 Audience Marketplace (å—ä¼—æ•°æ®å¸‚åœº) ç¬¬ä¸‰æ–¹å—ä¼—æ•°æ®äº¤æ˜“å¹³å° Oracle Data Cloudã€LiveRamp Marketplace 4.7 First-Party Data Platform (ç¬¬ä¸€æ–¹æ•°æ®å¹³å°) å¸®åŠ©å¹¿å‘Šä¸»æ„å»ºã€æ¿€æ´»è‡ªæœ‰æ•°æ®èµ„äº§ Zero-Party Dataå·¥å…·ã€CDPå»¶ä¼¸ 4.8 Data Enrichment Provider (æ•°æ®å¢å¼ºæœåŠ¡å•†) ä¸ºç°æœ‰æ•°æ®æ·»åŠ é¢å¤–ç»´åº¦ä¿¡æ¯ Acxiomã€Experian 4.9 Privacy-Enhancing Technology (PETs) éšç§å¢å¼ºæŠ€æœ¯ï¼Œå¦‚å·®åˆ†éšç§ã€è”é‚¦å­¦ä¹  Variouséšç§è®¡ç®—å‚å•† äº”ã€æµ‹é‡ä¸å½’å› å±‚ (Measurement & Attribution) åºå· æœ¯è¯­ å®šä¹‰ ä»£è¡¨å‚å•† 5.1 Attribution Provider (å½’å› æœåŠ¡å•†) è¡¡é‡ç”¨æˆ·è½¬åŒ–è·¯å¾„ä¸­å„è§¦ç‚¹è´¡çŒ® AppsFlyerã€Adjustã€Branchã€Kochava 5.2 MMP (Mobile Measurement Partner) ç§»åŠ¨æµ‹é‡åˆä½œä¼™ä¼´ï¼Œä¸“æ³¨ç§»åŠ¨åº”ç”¨å½’å›  AppsFlyerã€Adjustã€Branch 5.3 Multi-Touch Attribution (MTA) å¤šè§¦ç‚¹å½’å› åˆ†æå¹³å° Variouså½’å› å¹³å° 5.4 Marketing Mix Modeling (MMM) è¥é”€ç»„åˆæ¨¡å‹ï¼Œå®è§‚å±‚é¢è¡¡é‡å„æ¸ é“è´¡çŒ® Nielsen MMMã€Google Meridianã€Meta Robyn 5.5 Incrementality Testing (å¢é‡æµ‹è¯•å¹³å°) è¡¡é‡å¹¿å‘Šçš„çœŸå®å¢é‡æ•ˆæœï¼Œæ’é™¤è‡ªç„¶è½¬åŒ– Remergeã€Statsigã€Optimizely 5.6 Brand Lift Measurement (å“ç‰Œæå‡æµ‹é‡) è¡¡é‡å¹¿å‘Šå¯¹å“ç‰Œè®¤çŸ¥ã€è€ƒè™‘åº¦çš„å½±å“ Google Brand Liftã€Nielsen Brand Effect 5.7 Viewability Measurement (å¯è§åº¦æµ‹é‡) ä¸“é—¨è¡¡é‡å¹¿å‘Šå®é™…å¯è§æ›å…‰ Moatã€Comscore Viewabilityã€IAS 5.8 Measurement & Analytics Platform (æµ‹é‡ä¸åˆ†æå¹³å°) æ•ˆæœè¯„ä¼°ä¸æ•°æ®æ´å¯Ÿå·¥å…· Nielsenã€Comscoreã€Google Analytics å…­ã€éªŒè¯ä¸å®‰å…¨å±‚ (Verification & Safety) åºå· æœ¯è¯­ å®šä¹‰ ä»£è¡¨å‚å•† 6.1 3PV (Third-Party Verification) ç¬¬ä¸‰æ–¹éªŒè¯ï¼Œåä½œå¼Šä¸å“ç‰Œå®‰å…¨ IASã€DoubleVerifyã€Moat 6.2 Ad Fraud Detection Vendor (å¹¿å‘Šåæ¬ºè¯ˆå‚å•†) ä¸“é—¨æ£€æµ‹è™šå‡æµé‡ä¸ç‚¹å‡»æ¬ºè¯ˆ HUMAN (White Ops)ã€Spider.ioã€Integral Ad Science 6.3 Brand Safety Provider (å“ç‰Œå®‰å…¨æœåŠ¡å•†) ç¡®ä¿å¹¿å‘Šä¸å‡ºç°åœ¨ä¸åˆé€‚å†…å®¹æ— Grapeshotã€Integral Ad Scienceã€DoubleVerify 6.4 Ad Verification Platform (å¹¿å‘ŠéªŒè¯å¹³å°) å¹¿å‘Šå±•ç¤ºåˆè§„æ€§éªŒè¯ Integral Ad Scienceã€DoubleVerify 6.5 Content Suitability Provider (å†…å®¹é€‚å®œæ€§æœåŠ¡å•†) è¯„ä¼°å¹¿å‘Šå‘¨å›´å†…å®¹æ˜¯å¦é€‚å®œ Grapeshotã€IAS ä¸ƒã€éšç§ä¸åˆè§„å±‚ (Privacy & Compliance) åºå· æœ¯è¯­ å®šä¹‰ ä»£è¡¨å‚å•† 7.1 CMP (Consent Management Platform) åŒæ„ç®¡ç†å¹³å°ï¼Œæ”¶é›†ç”¨æˆ·éšç§åŒæ„ OneTrustã€Sourcepointã€Cookiebot 7.2 Cookieless Identity Solution (æ— Cookieèº«ä»½æ–¹æ¡ˆ) Cookieæ·˜æ±°åçš„æ›¿ä»£èº«ä»½è¯†åˆ« Unified ID 2.0ã€Google Privacy Sandboxã€LiveRamp IdentityLink 7.3 Privacy Sandbox Provider (éšç§æ²™ç›’æœåŠ¡) Googleä¸»å¯¼çš„éšç§ä¿æŠ¤å¹¿å‘ŠæŠ€æœ¯ Google Privacy Sandbox Topics&#x2F;FLEDGE 7.4 Data Governance Platform (æ•°æ®æ²»ç†å¹³å°) ç®¡ç†æ•°æ®ä½¿ç”¨åˆè§„æ€§ OneTrustã€BigID å…«ã€åˆ›æ„ä¸å†…å®¹å±‚ (Creative & Content) åºå· æœ¯è¯­ å®šä¹‰ ä»£è¡¨å‚å•† 8.1 CrMP (Creative Management Platform) åˆ›æ„ç®¡ç†å¹³å°ï¼Œæ‰¹é‡ç”Ÿæˆã€æµ‹è¯•å’Œä¼˜åŒ–åŠ¨æ€å¹¿å‘Šç´ æ Celtraã€Google Web Designerã€Bannersnack 8.2 DCO (Dynamic Creative Optimization) åŠ¨æ€åˆ›æ„ä¼˜åŒ–ï¼Œå®æ—¶æ ¹æ®ç”¨æˆ·ç‰¹å¾ç”Ÿæˆä¸ªæ€§åŒ–åˆ›æ„ Celtraã€Sizmekã€Google DCO 8.3 AI Creative Generator (AIåˆ›æ„ç”Ÿæˆå¹³å°) åˆ©ç”¨ç”Ÿæˆå¼AIæ‰¹é‡ç”Ÿäº§å¹¿å‘Šç´ æ Canva AIã€Adobe Fireflyã€Midjourney for Ads 8.4 Creative CDN (åˆ›æ„å†…å®¹åˆ†å‘ç½‘ç»œ) åŠ é€Ÿå¹¿å‘Šç´ æåŠ è½½ å„ç±»CDNæœåŠ¡å•† 8.5 Rich Media Provider (å¯Œåª’ä½“æœåŠ¡å•†) æä¾›äº¤äº’å¼å¹¿å‘Šåˆ›æ„æŠ€æœ¯ Google Swiffyã€Celtra 8.6 Video Ad Platform (è§†é¢‘å¹¿å‘Šå¹³å°) è§†é¢‘å¹¿å‘Šåˆ¶ä½œä¸æŠ•æ”¾ Brightcoveã€Kalturaã€Vimeo 8.7 UGC Platform (ç”¨æˆ·ç”Ÿæˆå†…å®¹å¹³å°) ç®¡ç†ç”¨æˆ·ç”Ÿæˆå¹¿å‘Šå†…å®¹ TINTã€Bazaarvoiceã€Yotpo ä¹ã€æ–°å…´æ¸ é“å±‚ (Emerging Channels) åºå· æœ¯è¯­ å®šä¹‰ ä»£è¡¨å‚å•† 9.1 Retail Media Network (RMN) é›¶å”®åª’ä½“ç½‘ç»œï¼Œé›¶å”®å•†è‡ªæœ‰å¹¿å‘Šå¹³å° Amazon Advertisingã€Walmart Connectã€é˜¿é‡Œå¦ˆå¦ˆã€äº¬ä¸œäº¬å‡†é€š 9.2 CTV Platform (Connected TV) è”ç½‘ç”µè§†å¹¿å‘Šå¹³å° Rokuã€Samsung Adsã€Huluã€çˆ±å¥‡è‰ºå¥‡éºŸ 9.3 DOOH (Digital Out-of-Home) æ•°å­—æˆ·å¤–å¹¿å‘Šå¹³å° JCDecauxã€Oceanã€åˆ†ä¼—ä¼ åª’ã€Broadsign 9.4 Audio&#x2F;Podcast Ads Platform (éŸ³é¢‘&#x2F;æ’­å®¢å¹¿å‘Š) éŸ³ä¹&#x2F;æ’­å®¢ç¨‹åºåŒ–å¹¿å‘Š Spotify Adsã€ç½‘æ˜“äº‘éŸ³ä¹ã€å–œé©¬æ‹‰é›… 9.5 Gaming Ads Platform (æ¸¸æˆå†…å¹¿å‘Š) æ¸¸æˆå†…ç¨‹åºåŒ–å¹¿å‘Š Unity Adsã€AppLovinã€ironSourceã€InMobi 9.6 Shoppable Ads Platform (å¯è´­ç‰©å¹¿å‘Š) ç›´æ¥è½¬åŒ–å‹å¹¿å‘Š Instagram Shoppingã€TikTok Shopã€Pinterest Shopping 9.7 Influencer Marketing Platform (ç½‘çº¢è¥é”€å¹³å°) è¿æ¥å“ç‰Œä¸å†…å®¹åˆ›ä½œè€… Aspireã€CreatorIQã€Upfluenceã€è‰å¦ˆå¦ˆ 9.8 Social Commerce Platform (ç¤¾äº¤ç”µå•†å¹³å°) ç¤¾äº¤åª’ä½“å†…è´­ç‰©å¹¿å‘Š æŠ–éŸ³ç”µå•†ã€å¿«æ‰‹ç”µå•†ã€å¾®ä¿¡å°åº— 9.9 Search Ads Platform (æœç´¢å¹¿å‘Šå¹³å°) æœç´¢å¼•æ“å¹¿å‘Š Google Adsã€Microsoft Advertisingã€ç™¾åº¦è¥é”€ 9.10 Native Advertising Platform (åŸç”Ÿå¹¿å‘Šå¹³å°) åŸç”Ÿå†…å®¹å½¢å¼å¹¿å‘Š Taboolaã€Outbrainã€Revcontent åã€åŸºç¡€è®¾æ–½å±‚ (Infrastructure) åºå· æœ¯è¯­ å®šä¹‰ ä»£è¡¨å‚å•† 10.1 Ad Server-Buy (ä¹°æ–¹å¹¿å‘ŠæœåŠ¡å™¨) å¹¿å‘Šä¸»ä¾§åˆ›æ„ç®¡ç†ä¸è¿½è¸ª Google Campaign Manager 360ã€Sizmek 10.2 Tag Management System (æ ‡ç­¾ç®¡ç†ç³»ç»Ÿ) ç®¡ç†ç½‘ç«™&#x2F;APPä¸Šçš„å¹¿å‘Šä»£ç éƒ¨ç½² Google Tag Managerã€Tealium iQã€Adobe Launch 10.3 Server-Side Tracking (æœåŠ¡ç«¯è¿½è¸ª) åº”å¯¹ITP&#x2F;éšç§é™åˆ¶çš„è¿½è¸ªæ–¹æ¡ˆ Google Server-Side GTMã€Segment Protocols 10.4 API Management (å¹¿å‘ŠAPIç®¡ç†) ç®¡ç†å„å¹³å°å¹¿å‘ŠAPIé›†æˆ Various APIç®¡ç†å¹³å° 10.5 Data Pipeline (æ•°æ®ç®¡é“) å¹¿å‘Šæ•°æ®ä¼ è¾“ä¸å¤„ç†åŸºç¡€è®¾æ–½ Fivetranã€Stitchã€Airbyte 10.6 Cloud Infrastructure (äº‘åŸºç¡€è®¾æ–½) å¹¿å‘ŠæŠ€æœ¯åº•å±‚äº‘æœåŠ¡ AWSã€Google Cloudã€Azure 10.7 Real-Time Bidding Infrastructure (å®æ—¶ç«ä»·åŸºç¡€è®¾æ–½) åº•å±‚ç«ä»·æŠ€æœ¯æœåŠ¡ Various RTBåŸºç¡€è®¾æ–½å•† 10.8 Ad Calling Infrastructure (å¹¿å‘Šè°ƒç”¨åŸºç¡€è®¾æ–½) å¹¿å‘Šè¯·æ±‚ä¸å“åº”åº•å±‚æœåŠ¡ VariousåŸºç¡€è®¾æ–½å•† åä¸€ã€æœåŠ¡ä¸æ”¯æŒå±‚ (Services & Support) åºå· æœ¯è¯­ å®šä¹‰ ä»£è¡¨å‚å•† 11.1 Ad Operations Service (å¹¿å‘Šè¿è¥æœåŠ¡) å¹¿å‘ŠæŠ•æ”¾æ—¥å¸¸è¿è¥ç®¡ç† å„ç±»å¹¿å‘Šä»£è¿è¥å…¬å¸ 11.2 Ad Consulting (å¹¿å‘Šå’¨è¯¢æœåŠ¡) å¹¿å‘Šç­–ç•¥ä¸æŠ€æœ¯å’¨è¯¢ å„ç±»å’¨è¯¢å…¬å¸ 11.3 Ad Training & Education (å¹¿å‘ŠåŸ¹è®­æ•™è‚²) å¹¿å‘ŠæŠ€æœ¯äººæ‰åŸ¹å…» å„ç±»åŸ¹è®­æœºæ„ 11.4 Ad Legal & Compliance (å¹¿å‘Šæ³•å¾‹åˆè§„) å¹¿å‘Šæ³•å¾‹ä¸åˆè§„æœåŠ¡ å„ç±»å¾‹å¸ˆäº‹åŠ¡æ‰€ 11.5 Ad Insurance (å¹¿å‘Šä¿é™©) å¹¿å‘ŠæŠ•æ”¾é£é™©ä¿é™© å„ç±»ä¿é™©å…¬å¸ åäºŒã€ç‰¹æ®Šç”Ÿæ€è§’è‰² (Special Ecosystem Roles) åºå· æœ¯è¯­ å®šä¹‰ ä»£è¡¨å‚å•† 12.1 Walled Garden (å›´å¢™èŠ±å›­) å°é—­ç”Ÿæ€å¹³å°ï¼Œè‡ªæœ‰æµé‡+æ•°æ®+æŠ•æ”¾ç³»ç»Ÿé—­ç¯ Googleã€Metaã€Amazonã€TikTokã€å¾®ä¿¡å¹¿å‘Šã€æŠ–éŸ³å¹¿å‘Š 12.2 Ad Blocking Solution (å¹¿å‘Šæ‹¦æˆªè§£å†³æ–¹æ¡ˆ) ç”¨æˆ·ç«¯å¹¿å‘Šæ‹¦æˆªå·¥å…· AdBlock Plusã€uBlock Origin 12.3 Acceptable Ads Program (å¯æ¥å—å¹¿å‘Šè®¡åˆ’) å…è®¸éƒ¨åˆ†éä¾µå…¥å¼å¹¿å‘Šé€šè¿‡æ‹¦æˆªå™¨ AdBlock Pluså¯æ¥å—å¹¿å‘Š 12.4 Ad Standards Organization (å¹¿å‘Šæ ‡å‡†ç»„ç»‡) åˆ¶å®šå¹¿å‘Šè¡Œä¸šæ ‡å‡† IABã€MRCã€Ads.txtå€¡è®® 12.5 Industry Association (è¡Œä¸šåä¼š) å¹¿å‘Šè¡Œä¸šè‡ªå¾‹ç»„ç»‡ ä¸­å›½å¹¿å‘Šåä¼šã€IAB China 12.6 Ad Auction Infrastructure (å¹¿å‘Šæ‹å–åŸºç¡€è®¾æ–½) åº•å±‚æ‹å–æœºåˆ¶æœåŠ¡ Variousæ‹å–æŠ€æœ¯å•† 12.7 Blockchain Ad Platform (åŒºå—é“¾å¹¿å‘Šå¹³å°) åŸºäºåŒºå—é“¾çš„é€æ˜å¹¿å‘Šäº¤æ˜“ Basic Attention Tokenã€AdEx 12.8 Web3&#x2F;NFT Advertising (Web3&#x2F;NFTå¹¿å‘Š) å»ä¸­å¿ƒåŒ–å¹¿å‘Šä¸NFTè¥é”€ Various Web3å¹¿å‘Šå¹³å°","date":"2026-02-19","categories":["å¹¿å‘Š"],"tags":["å¹¿å‘Š"]},{"title":"å¹¿å‘Šï¼ˆ2ï¼‰-ç©¿å±±ç”²å¹¿å‘Šè§’è‰²å’ŒæŠ€æœ¯","url":"/2026/02/19/å¹¿å‘Š2-ç©¿å±±ç”²å¹¿å‘Šè§’è‰²å’ŒæŠ€æœ¯/","content":"","date":"2026-02-19","categories":["å¹¿å‘Š"],"tags":["å¹¿å‘Š"]},{"title":"å¹¿å‘Šï¼ˆ1ï¼‰-å¹¿å‘Šç›¸å…³çš„æ¦‚å¿µå’Œæœ¯è¯­","url":"/2026/01/19/å¹¿å‘Š1-å¹¿å‘Šç›¸å…³çš„æ¦‚å¿µå’Œæœ¯è¯­/","content":"ğŸ“š å¹¿å‘ŠæŠ€æœ¯æœ¯è¯­å¤§å…¨å¤§çº²ï¼ˆæŒ‰ç±»åˆ«åˆ†ç±»ï¼‰è¿™é‡Œæ€»ç»“ä¸€ä¸‹å¹¿å‘Šæ•´ä¸ªä¸šåŠ¡çº¿ç›¸å…³çš„ä¸€äº›æœ¯è¯­å¤§çº²ï¼Œåªåšäº†ä¸€ä¸ªç²—åˆ†ç±»ã€‚ ä¸€ã€ã€ç”Ÿæ€è§’è‰²ã€‘ æœ¯è¯­ å®šä¹‰ è¯´æ˜ Advertiser å¹¿å‘Šä¸» å‡ºé’±æŠ•æ”¾å¹¿å‘Šçš„ä¼ä¸šæˆ–ä¸ªäºº Publisher åª’ä½“ &#x2F; å‘å¸ƒå•† æ‹¥æœ‰æµé‡çš„ç½‘ç«™ã€App å¼€å‘è€… DSP (Demand-Side Platform) éœ€æ±‚æ–¹å¹³å° ä»£è¡¨å¹¿å‘Šä¸»è‡ªåŠ¨è´­ä¹°å¹¿å‘Šæµé‡çš„å¹³å° SSP (Supply-Side Platform) ä¾›åº”æ–¹å¹³å° ä»£è¡¨åª’ä½“è‡ªåŠ¨å”®å–å¹¿å‘Šæµé‡çš„å¹³å° ADX (Ad Exchange) å¹¿å‘Šäº¤æ˜“å¹³å° æ’®åˆ DSP ä¸ SSP çš„ä¸­ç«‹äº¤æ˜“å¸‚åœº DMP (Data Management Platform) æ•°æ®ç®¡ç†å¹³å° å­˜å‚¨ç”¨æˆ·æ ‡ç­¾ã€æä¾›äººç¾¤å®šå‘èƒ½åŠ› TD (Trading Desk) ç¨‹åºåŒ–äº¤æ˜“å° ä¸ºå¤§å‹å¹¿å‘Šä¸»ç»Ÿä¸€ç®¡ç†å¤šä¸ª DSP 3PV (Third-Party Verification) ç¬¬ä¸‰æ–¹éªŒè¯ å¦‚ IASã€DoubleVerifyï¼Œç”¨äºåä½œå¼Šä¸å“ç‰Œå®‰å…¨ Agencyï¼ˆå¹¿å‘Šä»£ç†å…¬å¸ï¼‰ ä»£è¡¨å¹¿å‘Šä¸»ç­–åˆ’ã€æ‰§è¡Œå¹¿å‘Šæ´»åŠ¨çš„ä¸“ä¸šæœåŠ¡å•† æä¾›ç­–ç•¥ã€åˆ›æ„ã€åª’ä»‹è´­ä¹°ç­‰æœåŠ¡ï¼›å¤§å‹ä»£ç†å…¬å¸å¦‚ WPPã€é˜³ç‹®ã€ç”µé€šç­‰å¸¸ä¸‹è®¾ç¨‹åºåŒ–äº¤æ˜“å°ï¼ˆTrading Deskï¼‰ Creative Management Platform (CMP) åˆ›æ„ç®¡ç†å¹³å° å¸®åŠ©å¹¿å‘Šä¸»æ‰¹é‡ç”Ÿæˆã€æµ‹è¯•å’Œä¼˜åŒ–åŠ¨æ€å¹¿å‘Šç´ æï¼ˆå¦‚ Bannerã€è§†é¢‘ï¼‰ Ad Serverï¼ˆå¹¿å‘ŠæœåŠ¡å™¨ï¼‰ å¹¿å‘ŠæŠ•æ”¾ä¸è¿½è¸ªç³»ç»Ÿ ç”¨äºæ§åˆ¶å¹¿å‘Šå±•ç¤ºé€»è¾‘ã€é¢‘æ¬¡ã€å½’å› ç­‰ï¼›åˆ†ä¸ºä¹°æ–¹ï¼ˆBuy-side Ad Serverï¼Œå¦‚ Google Campaign Manager 360ï¼‰å’Œå–æ–¹ï¼ˆSell-side Ad Serverï¼Œå¦‚ Google Ad Managerï¼‰ Attribution Providerï¼ˆå½’å› æœåŠ¡å•†ï¼‰ å½’å› åˆ†æå¹³å° è¡¡é‡ç”¨æˆ·è½¬åŒ–è·¯å¾„ä¸­å„è§¦ç‚¹è´¡çŒ®ï¼ˆå¦‚ AppsFlyerã€Adjustã€Branchã€Kochavaï¼‰ Identity Resolution Providerï¼ˆèº«ä»½è§£ææœåŠ¡å•†ï¼‰ èº«ä»½è¯†åˆ«ä¸è·¨è®¾å¤‡åŒ¹é…æœåŠ¡ åœ¨ Cookie é™åˆ¶èƒŒæ™¯ä¸‹ï¼Œæä¾›åŸºäºé‚®ç®±ã€è®¾å¤‡ ID ç­‰çš„ç”¨æˆ·èº«ä»½å›¾è°±ï¼ˆå¦‚ LiveRampã€The Trade Desk çš„ Unified ID 2.0ã€Zeotapï¼‰ Measurement & Analytics Platformï¼ˆæµ‹é‡ä¸åˆ†æå¹³å°ï¼‰ æ•ˆæœè¯„ä¼°ä¸æ•°æ®æ´å¯Ÿå·¥å…· å¦‚ Nielsenã€Comscoreã€Google Analyticsï¼Œç”¨äºè¡¡é‡æ›å…‰ã€åˆ°è¾¾ç‡ã€å“ç‰Œæå‡ç­‰ Consent Management Platform (CMP) åŒæ„ç®¡ç†å¹³å° æ ¹æ® GDPR&#x2F;CCPA ç­‰æ³•è§„æ”¶é›†ç”¨æˆ·éšç§åŒæ„ï¼ˆå¦‚ OneTrustã€Sourcepointï¼‰ Header Bidding Wrapperï¼ˆé¦–ä»·ç«ä»·å°è£…å™¨ï¼‰ é¦–ä»·ç«ä»·æŠ€æœ¯ç»„ä»¶ å¸®åŠ©å‘å¸ƒå•†å¹¶è¡Œè°ƒç”¨å¤šä¸ª SSP&#x2F;DSP å®ç°å…¬å¹³ç«ä»·ï¼ˆå¦‚ Prebid.jsï¼‰ Contextual Targeting Providerï¼ˆä¸Šä¸‹æ–‡å®šå‘æœåŠ¡å•†ï¼‰ åŸºäºé¡µé¢å†…å®¹è€Œéç”¨æˆ·è¡Œä¸ºçš„å®šå‘æŠ€æœ¯ åœ¨éšç§åˆè§„è¶‹åŠ¿ä¸‹é‡æ–°å…´èµ·ï¼ˆå¦‚ GumGumã€Criteo Contextualï¼‰ Ad Fraud Detection Vendorï¼ˆå¹¿å‘Šåæ¬ºè¯ˆå‚å•†ï¼‰ ä¸“é—¨æ£€æµ‹è™šå‡æµé‡ä¸ç‚¹å‡»æ¬ºè¯ˆ éƒ¨åˆ†ä¸ 3PV é‡å ï¼Œä½†ä¹Ÿæœ‰ç‹¬ç«‹æ–¹æ¡ˆï¼ˆå¦‚ White Ops â†’ HUMAN, Spider.ioï¼‰ äºŒã€ã€äº¤æ˜“æ¨¡å¼ã€‘ æœ¯è¯­ å®šä¹‰ è¯´æ˜ RTB (Real-Time Bidding) å®æ—¶ç«ä»· æ¯æ¬¡æ›å…‰æœºä¼šè¿›è¡Œæ¯«ç§’çº§æ‹å– RTA (Real-Time API) å®æ—¶ API åª’ä½“ä¸»åŠ¨è°ƒç”¨ DSP æ¥å£å†³å®šæ˜¯å¦æŠ•æ”¾ Open Auction (OA) å…¬å¼€ç«ä»· æ‰€æœ‰ DSP å¯å‚ä¸çš„æ ‡å‡† RTB Private Auction (PA) ç§æœ‰ç«ä»· åª’ä½“é‚€è¯·ç‰¹å®š DSP å‚ä¸çš„ç«ä»· Preferred Deal (PD) ä¼˜å…ˆäº¤æ˜“ å›ºå®šä»·æ ¼ã€éä¿é‡ï¼ŒDSP å¯é€‰æ‹©æ˜¯å¦ä¹° Programmatic Guaranteed (PG) ç¨‹åºåŒ–ä¿é‡ å›ºå®šä»·æ ¼ + ä¿é‡ï¼Œç±»ä¼¼ç›´æŠ• Direct Deal ç›´æ¥äº¤æ˜“ å¹¿å‘Šä¸»ä¸åª’ä½“çº¿ä¸‹ç­¾çº¦ï¼Œä¸èµ°ç¨‹åºåŒ– Waterfall ç€‘å¸ƒæµ æŒ‰ä¼˜å…ˆçº§é¡ºåºä¾æ¬¡è¯·æ±‚å¹¿å‘Šæº Header Bidding å‰ç½®ç«ä»· å¹¶è¡Œå‘å¤šä¸ª SSP è¯·æ±‚ï¼Œä»·é«˜è€…å¾— Contextual Targeting ä¸Šä¸‹æ–‡å®šå‘ åŸºäºé¡µé¢&#x2F;App å†…å®¹æŠ•æ”¾ï¼ˆæ— éœ€ç”¨æˆ· IDï¼‰ Audience Targeting äººç¾¤å®šå‘ åŸºäº DMP ç”¨æˆ·æ ‡ç­¾æŠ•æ”¾ Geotargeting &#x2F; Geofencing åœ°åŸŸå®šå‘ &#x2F; åœ°ç†å›´æ  åŸºäºåœ°ç†ä½ç½®è§¦å‘å¹¿å‘Š ä¸‰ã€ã€åè®®ä¸æ ‡å‡†ã€‘ æœ¯è¯­ å®šä¹‰ è¯´æ˜ OpenRTB å¼€æ”¾å®æ—¶ç«ä»·åè®® IAB åˆ¶å®šçš„ RTB é€šä¿¡æ ‡å‡†ï¼ˆv2.5 æœ€å¸¸ç”¨ï¼‰ VAST Video Ad Serving Template è§†é¢‘å¹¿å‘Šè¯·æ±‚&#x2F;è¿”å›æ ‡å‡†ï¼ˆXMLï¼‰ VMAP Video Multiple Ad Playlist æ§åˆ¶å¤šæ®µè§†é¢‘å¹¿å‘Šæ’­æ”¾é¡ºåº VPAID Video Player-Ad Interface Definition æ—§ç‰ˆäº’åŠ¨è§†é¢‘å¹¿å‘Šæ¥å£ï¼ˆå·²æ·˜æ±°ï¼‰ SIMID Secure Interactive Media Interface Definition VPAID ç»§ä»»è€…ï¼Œæ›´å®‰å…¨ MRAID Mobile Rich Media Ad Interface Definitions ç§»åŠ¨ç«¯å¯Œåª’ä½“å¹¿å‘Šæ ‡å‡† Ads.txt &#x2F; App-ads.txt å¹¿å‘Šæˆæƒæ–‡ä»¶ åª’ä½“å£°æ˜åˆæ³• SSP åˆ—è¡¨ï¼Œé˜²åŸŸåç›—ç”¨ Seller.json å–å®¶èº«ä»½å£°æ˜ é…åˆ Ads.txt ä½¿ç”¨ OpenRTB SupplyChain Object æµé‡æ¥æºé€æ˜åŒ–å¯¹è±¡ é˜²æ­¢æµé‡åŠ«æŒ TCF (Transparency & Consent Framework) ç”¨æˆ·æˆæƒæ¡†æ¶ GDPR åˆè§„æ ‡å‡† å››ã€ã€å‡ºä»·ä¸ä¼˜åŒ–ç­–ç•¥ã€‘ æœ¯è¯­ å®šä¹‰ è¯´æ˜ CPM &#x2F; CPC &#x2F; CPA åƒæ¬¡å±•ç¤º &#x2F; ç‚¹å‡» &#x2F; è½¬åŒ–æˆæœ¬ åŸºç¡€è®¡è´¹æ–¹å¼ oCPM &#x2F; oCPC &#x2F; oCPA ç›®æ ‡è½¬åŒ–å‡ºä»· eCPM &#x3D; pCVR Ã— target_CPA oCPX æ™ºèƒ½å‡ºä»·ç»Ÿç§° å›½å†…å¯¹ oCPM&#x2F;oCPA çš„æ³›ç§° tCPA &#x2F; tROAS ç›®æ ‡ CPA &#x2F; ç›®æ ‡å¹¿å‘Šæ”¯å‡ºå›æŠ¥ç‡ Google&#x2F;Meta æœ¯è¯­ Bid Shading å‡ºä»·é®è”½ åœ¨ç¬¬äºŒä»·æ ¼æ‹å–ä¸­é™ä½å‡ºä»·ä»¥èŠ‚çœæˆæœ¬ Budget Pacing é¢„ç®—å¹³æ»‘ æ§åˆ¶é¢„ç®—åœ¨å‘¨æœŸå†…å‡åŒ€&#x2F;æ™ºèƒ½æ¶ˆè€— Frequency Capping é¢‘æ¬¡æ§åˆ¶ é™åˆ¶ç”¨æˆ·å•ä½æ—¶é—´æ›å…‰æ¬¡æ•° Recency Capping è¿‘æœŸé¢‘æ§ å¦‚â€œ7å¤©å†…æœ€å¤š3æ¬¡â€ Bid Multiplier å‡ºä»·ç³»æ•° å¯¹ç‰¹å®šäººç¾¤&#x2F;æ—¶æ®µåŠ ä»· Auto Bidding è‡ªåŠ¨å‡ºä»· ç³»ç»Ÿè‡ªåŠ¨è°ƒä»·è¾¾æˆç›®æ ‡ CBO (Campaign Budget Optimization) è®¡åˆ’é¢„ç®—ä¼˜åŒ– åœ¨å¹¿å‘Šç»„é—´åŠ¨æ€åˆ†é…é¢„ç®— Lookalike Audience ç›¸ä¼¼äººç¾¤æ‰©å±• åŸºäºç§å­ç”¨æˆ·æ‰¾ç›¸ä¼¼äººç¾¤ Creative Fatigue åˆ›æ„ç–²åŠ³ åŒä¸€åˆ›æ„åå¤æ›å…‰å¯¼è‡´ CTR ä¸‹é™ Cold Start Problem å†·å¯åŠ¨é—®é¢˜ æ–°è®¡åˆ’æ— å†å²æ•°æ®ï¼Œæ¨¡å‹æ— æ³•é¢„ä¼° äº”ã€ã€å½’å› ä¸æµ‹é‡ã€‘ æœ¯è¯­ å®šä¹‰ è¯´æ˜ Impression (Imp) æ›å…‰ å¹¿å‘Šè¢«å±•ç¤ºä¸€æ¬¡ Click-Through Conversion (CTC) ç‚¹å‡»åè½¬åŒ– ç”¨æˆ·ç‚¹å‡»å¹¿å‘Šåå®Œæˆè½¬åŒ– View-Through Conversion (VTC) æ›å…‰åè½¬åŒ– æœªç‚¹å‡»ä½†åç»­è½¬åŒ– Attribution Window å½’å› çª—å£ å¦‚ click_7d_view_1d Last Click &#x2F; First Click &#x2F; Linear &#x2F; Time Decay å½’å› æ¨¡å‹ åˆ†é…è½¬åŒ–åŠŸåŠ³çš„æ–¹å¼ Shapley Value Attribution æ²™æ™®åˆ©å€¼å½’å›  åŸºäºåšå¼ˆè®ºçš„å…¬å¹³åˆ†é… Incrementality å¢é‡æ•ˆæœ å¹¿å‘Šå¸¦æ¥çš„çœŸå®æ–°å¢è½¬åŒ– Ghost Ads å¹½çµå¹¿å‘Š å¯¹ç…§ç»„çœ‹åˆ°ç©ºç™½å¹¿å‘Šä½ï¼Œç”¨äºå¢é‡æµ‹è¯• MMM (Marketing Mix Modeling) è¥é”€ç»„åˆå»ºæ¨¡ å®è§‚æ¸ é“æ•ˆæœè¯„ä¼° Conversion API (CAPI) è½¬åŒ–å›ä¼  API æœåŠ¡å™¨ç«¯ä¸ŠæŠ¥è½¬åŒ–ï¼ˆæ›¿ä»£ Pixelï¼‰ Cross-Device Attribution è·¨è®¾å¤‡å½’å›  æ‰‹æœº â†’ PC è½¬åŒ–å½’å›  Offline Conversion ç¦»çº¿è½¬åŒ– é—¨åº—æ‰«ç ã€ç”µè¯é”€å”®ç­‰å›ä¼  Store Visit Attribution åˆ°åº—å½’å›  åŸºäº GPS åˆ¤æ–­æ˜¯å¦åˆ°åº— å…­ã€ã€éšç§ä¸åˆè§„ã€‘ æœ¯è¯­ å®šä¹‰ è¯´æ˜ GDPR &#x2F; CCPA &#x2F; PIPL éšç§æ³•è§„ æ¬§ç›Ÿã€åŠ å·ã€ä¸­å›½ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³• Consent Management ç”¨æˆ·æˆæƒç®¡ç† é€šè¿‡ CMP å¼¹çª—è·å–åŒæ„ IDFA &#x2F; AAID &#x2F; OAID è®¾å¤‡æ ‡è¯†ç¬¦ iOS &#x2F; Android &#x2F; ä¸­å›½å®‰å“åŒ¿å ID ATT (App Tracking Transparency) åº”ç”¨è·Ÿè¸ªé€æ˜åº¦ iOS 14+ å¼¹çª—æˆæƒæœºåˆ¶ SKAdNetwork (SKAN) è‹¹æœå½’å› æ¡†æ¶ iOS éšç§å®‰å…¨å½’å› ï¼ˆv2&#x2F;v3&#x2F;v4ï¼‰ Conversion Value Schema è½¬åŒ–å€¼ç¼–ç è§„åˆ™ SKAN ä¸­ 6-bit å€¼çš„ä¸šåŠ¡å«ä¹‰ Probabilistic ID æ¦‚ç‡ ID åŸºäº IP+UA ç”Ÿæˆçš„åŒ¿å ID Deterministic ID ç¡®å®šæ€§ ID ç™»å½•æ€ç”¨æˆ· IDï¼ˆå¦‚å¾®ä¿¡ openidï¼‰ Privacy Sandbox è°·æ­Œéšç§æ²™ç›’ Cookie æ›¿ä»£æ–¹æ¡ˆï¼ˆTopics, FLEDGEï¼‰ FLEDGE &#x2F; Protected Audience éšç§ä¿æŠ¤é‡å®šå‘ åœ¨æœ¬åœ°å®Œæˆé‡å®šå‘é€»è¾‘ Topics API å…´è¶£ç¾¤ç»„ API è°·æ­Œæå‡ºçš„ä¸Šä¸‹æ–‡+ç¾¤ç»„å®šå‘ ä¸ƒã€ã€åä½œå¼Šä¸è´¨é‡ã€‘ æœ¯è¯­ å®šä¹‰ è¯´æ˜ IVT (Invalid Traffic) æ— æ•ˆæµé‡ æ€»ç§° GIVT (General IVT) ä¸€èˆ¬æ— æ•ˆæµé‡ å·²çŸ¥çˆ¬è™«ã€èœ˜è›› SIVT (Sophisticated IVT) é«˜çº§æ— æ•ˆæµé‡ è®¾å¤‡å†œåœºã€æ¨¡æ‹Ÿå™¨ Device Fingerprinting è®¾å¤‡æŒ‡çº¹ Canvas&#x2F;WebGL&#x2F;ç”µæ± ç­‰ç‰¹å¾ Click Spamming &#x2F; Injection ç‚¹å‡»åŠ«æŒ å°¤å…¶ Android æ¸ é“å¸¸è§ SDK Spoofing SDK ä¼ªé€  ä¼ªé€ å¹¿å‘Šè¯·æ±‚åˆ·é‡ Bot Detection æœºå™¨äººæ£€æµ‹ è¡Œä¸ºåºåˆ—å¼‚å¸¸è¯†åˆ« Brand Safety å“ç‰Œå®‰å…¨ é¿å…å‡ºç°åœ¨ä¸è‰¯å†…å®¹æ— Suitable Inventory åˆè§„æµé‡æ±  åª’ä½“æä¾›çš„â€œå¹²å‡€â€æµé‡ Ad Fraud Postback ä½œå¼Šå›æ‰« äº‹åç”³è¯·é€€æ¬¾æˆ–æŠµæ‰£ å…«ã€ã€å·¥ç¨‹ä¸è¿ç»´ã€‘ æœ¯è¯­ å®šä¹‰ è¯´æ˜ Bid Request &#x2F; Bid Response ç«ä»·è¯·æ±‚&#x2F;å“åº” OpenRTB æ ¸å¿ƒæ¶ˆæ¯ Seat å¸­ä½ DSP åœ¨ ADX ä¸­çš„èº«ä»½æ ‡è¯† Deal ID äº¤æ˜“ ID PDB&#x2F;PA å”¯ä¸€æ ‡è¯† Price Floor &#x2F; Reserve Price åº•ä»· åª’ä½“è®¾ç½®çš„æœ€ä½æˆäº¤ä»· Win Notice èµ¢æ ‡é€šçŸ¥ ç”¨äºè®¡è´¹å¯¹è´¦ Billable Event å¯è®¡è´¹äº‹ä»¶ æ›å…‰ or ç‚¹å‡»ï¼Ÿéœ€å¯¹é½ Reconciliation å¯¹è´¦ DSP ä¸ SSP æ ¸å¯¹æ•°æ® Discrepancy æ•°æ®å·®å¼‚ é€šå¸¸å…è®¸ Â±5% Makegood è¡¥é‡ å› æœªè¾¾æ ‡è€Œå…è´¹è¡¥æŠ• Log Sampling æ—¥å¿—é‡‡æ · é«˜ QPS ä¸‹é™æœ¬ç­–ç•¥ Shadow Mode å½±å­æ¨¡å¼ æ–°ç­–ç•¥ä¸Šçº¿å‰å¯¹æ¯”æµ‹è¯• Canary Release ç°åº¦å‘å¸ƒ é€æ­¥æ”¾é‡æ–°ç‰ˆæœ¬ Cost per Millisecond æ¯«ç§’æˆæœ¬ å»¶è¿Ÿæ¯å¢ 10msï¼Œæ”¶å…¥å¯èƒ½é™ 1% Geo-Distributed Bidding åœ°ç†åˆ†å¸ƒå¼å‡ºä»· é è¿‘ ADX éƒ¨ç½²é™ä½å»¶è¿Ÿ Online Learning åœ¨çº¿å­¦ä¹  å®æ—¶æ›´æ–° pCTR&#x2F;pCVR æ¨¡å‹ Feature Store ç‰¹å¾å­˜å‚¨ ä¾›æ¨¡å‹å’Œè§„åˆ™å¼•æ“ä½¿ç”¨ ä¹ã€ã€å›½å†…ç‰¹è‰²æœ¯è¯­ã€‘ æœ¯è¯­ å«ä¹‰ æ”¾é‡ &#x2F; ç¨³æŠ• &#x2F; è·‘é£ å‡ºä»·ç­–ç•¥çŠ¶æ€ å†·å¯ &#x2F; çƒ­å¯ å¹¿å‘Šè®¡åˆ’é˜¶æ®µ å»ºæ¨¡æˆåŠŸ oCPX ç§¯ç´¯è¶³å¤Ÿè½¬åŒ–ï¼Œæ¨¡å‹ç”Ÿæ•ˆ æ‰é‡ æ›å…‰é‡çªç„¶ä¸‹é™ ç©¿å±±ç”² &#x2F; ä¼˜é‡æ±‡ &#x2F; Uni Desk å­—èŠ‚ &#x2F; è…¾è®¯ &#x2F; é˜¿é‡Œ DSP è”ç›Ÿæµé‡ ç¬¬ä¸‰æ–¹ App èšåˆæµé‡ ç›´æŠ• vs è”ç›Ÿ è‡ªæœ‰ App vs ç¬¬ä¸‰æ–¹ App åº”ç”¨ç›´è¾¾ &#x2F; å”¤é†’å¹¿å‘Š DeepLink æ‹‰æ´»å·²å®‰è£… App","date":"2026-01-19","categories":["å¹¿å‘Š"],"tags":["å¹¿å‘Š"]},{"title":"docker(1)-åŸºç¡€","url":"/2024/12/31/docker-1--åŸºç¡€/","content":"docker ä¸å¤šè¯´å°±æ˜¯æ‹¥æœ‰ç‹¬ç«‹çš„å­˜å‚¨ç©ºé—´çš„æ›´åŠ ä¼˜ç§€çš„ç±»è™šæ‹Ÿæœºç³»ç»Ÿï¼Œä»–æ‹¥æœ‰è®¸å¤šä¼˜ç§€çš„æ€æƒ³ï¼Œæ¯”å¦‚å¸æ”¶äº†gitçš„å­˜å‚¨ä»“åº“çš„æ€æƒ³ï¼Œä½¿ç”¨imageå‚ç…§gitä¸­çš„ä»“åº“ç­‰ã€‚ docker ä¹‹åˆ†å±‚å­˜å‚¨Docker è®¾è®¡æ—¶ï¼Œå°±å……åˆ†åˆ©ç”¨ Union FS çš„æŠ€æœ¯ï¼Œå°†å…¶è®¾è®¡ä¸ºåˆ†å±‚å­˜å‚¨çš„æ¶æ„ã€‚æ‰€ä»¥ä¸¥æ ¼æ¥è¯´ï¼Œé•œåƒå¹¶éæ˜¯åƒä¸€ä¸ª ISO é‚£æ ·çš„æ‰“åŒ…æ–‡ä»¶ï¼Œé•œåƒåªæ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„æ¦‚å¿µï¼Œå…¶å®é™…ä½“ç°å¹¶éç”±ä¸€ä¸ªæ–‡ä»¶ç»„æˆï¼Œè€Œæ˜¯ç”±ä¸€ç»„æ–‡ä»¶ç³»ç»Ÿç»„æˆï¼Œæˆ–è€…è¯´ï¼Œç”±å¤šå±‚æ–‡ä»¶ç³»ç»Ÿè”åˆç»„æˆã€‚ é•œåƒæ„å»ºæ—¶ï¼Œä¼šä¸€å±‚å±‚æ„å»ºï¼Œå‰ä¸€å±‚æ˜¯åä¸€å±‚çš„åŸºç¡€ã€‚æ¯ä¸€å±‚æ„å»ºå®Œå°±ä¸ä¼šå†å‘ç”Ÿæ”¹å˜ï¼Œåä¸€å±‚ä¸Šçš„ä»»ä½•æ”¹å˜åªå‘ç”Ÿåœ¨è‡ªå·±è¿™ä¸€å±‚ã€‚æ¯”å¦‚ï¼Œåˆ é™¤å‰ä¸€å±‚æ–‡ä»¶çš„æ“ä½œï¼Œå®é™…ä¸æ˜¯çœŸçš„åˆ é™¤å‰ä¸€å±‚çš„æ–‡ä»¶ï¼Œè€Œæ˜¯ä»…åœ¨å½“å‰å±‚æ ‡è®°ä¸ºè¯¥æ–‡ä»¶å·²åˆ é™¤ã€‚åœ¨æœ€ç»ˆå®¹å™¨è¿è¡Œçš„æ—¶å€™ï¼Œè™½ç„¶ä¸ä¼šçœ‹åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯å®é™…ä¸Šè¯¥æ–‡ä»¶ä¼šä¸€ç›´è·Ÿéšé•œåƒã€‚å› æ­¤ï¼Œåœ¨æ„å»ºé•œåƒçš„æ—¶å€™ï¼Œéœ€è¦é¢å¤–å°å¿ƒï¼Œæ¯ä¸€å±‚å°½é‡åªåŒ…å«è¯¥å±‚éœ€è¦æ·»åŠ çš„ä¸œè¥¿ï¼Œä»»ä½•é¢å¤–çš„ä¸œè¥¿åº”è¯¥åœ¨è¯¥å±‚æ„å»ºç»“æŸå‰æ¸…ç†æ‰ã€‚ åˆ†å±‚å­˜å‚¨çš„ç‰¹å¾è¿˜ä½¿å¾—é•œåƒçš„å¤ç”¨ã€å®šåˆ¶å˜çš„æ›´ä¸ºå®¹æ˜“ã€‚ç”šè‡³å¯ä»¥ç”¨ä¹‹å‰æ„å»ºå¥½çš„é•œåƒä½œä¸ºåŸºç¡€å±‚ï¼Œç„¶åè¿›ä¸€æ­¥æ·»åŠ æ–°çš„å±‚ï¼Œä»¥å®šåˆ¶è‡ªå·±æ‰€éœ€çš„å†…å®¹ï¼Œæ„å»ºæ–°çš„é•œåƒã€‚ docker ä¹‹å®¹å™¨é•œåƒï¼ˆImageï¼‰å’Œå®¹å™¨ï¼ˆContainerï¼‰çš„å…³ç³»ï¼Œå°±åƒæ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­çš„ ç±» å’Œ å®ä¾‹ ä¸€æ ·ï¼Œé•œåƒæ˜¯é™æ€çš„å®šä¹‰ï¼Œå®¹å™¨æ˜¯é•œåƒè¿è¡Œæ—¶çš„å®ä½“ã€‚å®¹å™¨å¯ä»¥è¢«åˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤ã€æš‚åœç­‰ã€‚ å®¹å™¨çš„å®è´¨æ˜¯è¿›ç¨‹ï¼Œä½†ä¸ç›´æ¥åœ¨å®¿ä¸»æ‰§è¡Œçš„è¿›ç¨‹ä¸åŒï¼Œå®¹å™¨è¿›ç¨‹è¿è¡Œäºå±äºè‡ªå·±çš„ç‹¬ç«‹çš„ å‘½åç©ºé—´ã€‚å› æ­¤å®¹å™¨å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„ root æ–‡ä»¶ç³»ç»Ÿã€è‡ªå·±çš„ç½‘ç»œé…ç½®ã€è‡ªå·±çš„è¿›ç¨‹ç©ºé—´ï¼Œç”šè‡³è‡ªå·±çš„ç”¨æˆ· ID ç©ºé—´ã€‚å®¹å™¨å†…çš„è¿›ç¨‹æ˜¯è¿è¡Œåœ¨ä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒé‡Œï¼Œä½¿ç”¨èµ·æ¥ï¼Œå°±å¥½åƒæ˜¯åœ¨ä¸€ä¸ªç‹¬ç«‹äºå®¿ä¸»çš„ç³»ç»Ÿä¸‹æ“ä½œä¸€æ ·ã€‚è¿™ç§ç‰¹æ€§ä½¿å¾—å®¹å™¨å°è£…çš„åº”ç”¨æ¯”ç›´æ¥åœ¨å®¿ä¸»è¿è¡Œæ›´åŠ å®‰å…¨ã€‚ä¹Ÿå› ä¸ºè¿™ç§éš”ç¦»çš„ç‰¹æ€§ï¼Œå¾ˆå¤šäººåˆå­¦ Docker æ—¶å¸¸å¸¸ä¼šæ··æ·†å®¹å™¨å’Œè™šæ‹Ÿæœºã€‚ å‰é¢è®²è¿‡é•œåƒä½¿ç”¨çš„æ˜¯åˆ†å±‚å­˜å‚¨ï¼Œå®¹å™¨ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æ¯ä¸€ä¸ªå®¹å™¨è¿è¡Œæ—¶ï¼Œæ˜¯ä»¥é•œåƒä¸ºåŸºç¡€å±‚ï¼Œåœ¨å…¶ä¸Šåˆ›å»ºä¸€ä¸ªå½“å‰å®¹å™¨çš„å­˜å‚¨å±‚ï¼Œæˆ‘ä»¬å¯ä»¥ç§°è¿™ä¸ªä¸ºå®¹å™¨è¿è¡Œæ—¶è¯»å†™è€Œå‡†å¤‡çš„å­˜å‚¨å±‚ä¸ºå®¹å™¨å­˜å‚¨å±‚ã€‚ å®¹å™¨å­˜å‚¨å±‚çš„ç”Ÿå­˜å‘¨æœŸå’Œå®¹å™¨ä¸€æ ·ï¼Œå®¹å™¨æ¶ˆäº¡æ—¶ï¼Œå®¹å™¨å­˜å‚¨å±‚ä¹Ÿéšä¹‹æ¶ˆäº¡ã€‚å› æ­¤ï¼Œä»»ä½•ä¿å­˜äºå®¹å™¨å­˜å‚¨å±‚çš„ä¿¡æ¯éƒ½ä¼šéšå®¹å™¨åˆ é™¤è€Œä¸¢å¤±ã€‚ æŒ‰ç…§ Docker æœ€ä½³å®è·µçš„è¦æ±‚ï¼Œå®¹å™¨ä¸åº”è¯¥å‘å…¶å­˜å‚¨å±‚å†…å†™å…¥ä»»ä½•æ•°æ®ï¼Œå®¹å™¨å­˜å‚¨å±‚è¦ä¿æŒæ— çŠ¶æ€åŒ–ã€‚æ‰€æœ‰çš„æ–‡ä»¶å†™å…¥æ“ä½œï¼Œéƒ½åº”è¯¥ä½¿ç”¨ æ•°æ®å·ï¼ˆVolumeï¼‰ã€æˆ–è€…ç»‘å®šå®¿ä¸»ç›®å½•ï¼Œåœ¨è¿™äº›ä½ç½®çš„è¯»å†™ä¼šè·³è¿‡å®¹å™¨å­˜å‚¨å±‚ï¼Œç›´æ¥å¯¹å®¿ä¸»ï¼ˆæˆ–ç½‘ç»œå­˜å‚¨ï¼‰å‘ç”Ÿè¯»å†™ï¼Œå…¶æ€§èƒ½å’Œç¨³å®šæ€§æ›´é«˜ã€‚ æ•°æ®å·çš„ç”Ÿå­˜å‘¨æœŸç‹¬ç«‹äºå®¹å™¨ï¼Œå®¹å™¨æ¶ˆäº¡ï¼Œæ•°æ®å·ä¸ä¼šæ¶ˆäº¡ã€‚å› æ­¤ï¼Œä½¿ç”¨æ•°æ®å·åï¼Œå®¹å™¨åˆ é™¤æˆ–è€…é‡æ–°è¿è¡Œä¹‹åï¼Œæ•°æ®å´ä¸ä¼šä¸¢å¤±ã€‚ docker ä¹‹ä»“åº“dockerä»“åº“çš„åŠŸèƒ½å’Œgitä»“åº“ç±»ä¼¼è¿™é‡Œå°±ä¸å±•å¼€è¯´æ˜äº†ï¼Œè¿™é‡Œä¸»è¦è®¨è®ºä¸€ä¸‹dockerä»“åº“ç‰¹æ®Šçš„å‘½åè§„åˆ™ã€‚ ä»¥ Ubuntu é•œåƒ ä¸ºä¾‹ï¼Œubuntu æ˜¯ä»“åº“çš„åå­—ï¼Œå…¶å†…åŒ…å«æœ‰ä¸åŒçš„ç‰ˆæœ¬æ ‡ç­¾ï¼Œå¦‚ï¼Œ14.04, 16.04ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ ubuntu:14.04ï¼Œæˆ–è€… ubuntu:16.04 æ¥å…·ä½“æŒ‡å®šæ‰€éœ€å“ªä¸ªç‰ˆæœ¬çš„é•œåƒã€‚å¦‚æœå¿½ç•¥äº†æ ‡ç­¾ï¼Œæ¯”å¦‚ ubuntuï¼Œé‚£å°†è§†ä¸º ubuntu:latestã€‚ ä»“åº“åç»å¸¸ä»¥ ä¸¤æ®µå¼è·¯å¾„ å½¢å¼å‡ºç°ï¼Œæ¯”å¦‚ jwilder&#x2F;nginx-proxyï¼Œå‰è€…å¾€å¾€æ„å‘³ç€ Docker Registry å¤šç”¨æˆ·ç¯å¢ƒä¸‹çš„ç”¨æˆ·åï¼Œåè€…åˆ™å¾€å¾€æ˜¯å¯¹åº”çš„è½¯ä»¶åã€‚ä½†è¿™å¹¶éç»å¯¹ï¼Œå–å†³äºæ‰€ä½¿ç”¨çš„å…·ä½“ Docker Registry çš„è½¯ä»¶æˆ–æœåŠ¡ã€‚","date":"2024-12-31","categories":["docker"]},{"title":"docker(2)-é•œåƒä½¿ç”¨å’Œå‘½ä»¤","url":"/2024/12/31/docker-2--é•œåƒä½¿ç”¨å’Œå‘½ä»¤/","content":"è·å–é•œåƒ pullå…³é”®å‘½ä»¤ å‘½åæ ¼å¼ Docker é•œåƒä»“åº“åœ°å€ï¼šåœ°å€çš„æ ¼å¼ä¸€èˆ¬æ˜¯ <åŸŸå&#x2F;IP>[:ç«¯å£å·]ã€‚é»˜è®¤åœ°å€æ˜¯ Docker Hubã€‚ ä»“åº“åï¼šå¦‚ä¹‹å‰æ‰€è¯´ï¼Œè¿™é‡Œçš„ä»“åº“åæ˜¯ä¸¤æ®µå¼åç§°ï¼Œå³ <ç”¨æˆ·å>&#x2F;<è½¯ä»¶å>ã€‚å¯¹äº Docker Hubï¼Œå¦‚æœä¸ç»™å‡ºç”¨æˆ·åï¼Œåˆ™é»˜è®¤ä¸º libraryï¼Œä¹Ÿå°±æ˜¯å®˜æ–¹é•œåƒã€‚ è¿è¡Œé•œåƒ runé•œåƒæ ¼å¼ å¯åŠ¨å®¹å™¨æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯åŸºäºé•œåƒæ–°å»ºä¸€ä¸ªå®¹å™¨å¹¶å¯åŠ¨ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å°†åœ¨ç»ˆæ­¢çŠ¶æ€ï¼ˆstoppedï¼‰çš„å®¹å™¨é‡æ–°å¯åŠ¨ã€‚ å› ä¸º Docker çš„å®¹å™¨å®åœ¨å¤ªè½»é‡çº§äº†ï¼Œå¾ˆå¤šæ—¶å€™ç”¨æˆ·éƒ½æ˜¯éšæ—¶åˆ é™¤å’Œæ–°åˆ›å»ºå®¹å™¨ã€‚ OPTIONSè¯´æ˜ï¼š -a stdin: æŒ‡å®šæ ‡å‡†è¾“å…¥è¾“å‡ºå†…å®¹ç±»å‹ï¼Œå¯é€‰ STDIN&#x2F;STDOUT&#x2F;STDERR ä¸‰é¡¹ï¼› -d: åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDï¼› -i: ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ï¼› -t: ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼› â€“name&#x3D;â€nginx-lbâ€: ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼› â€“dns 8.8.8.8: æŒ‡å®šå®¹å™¨ä½¿ç”¨çš„DNSæœåŠ¡å™¨ï¼Œé»˜è®¤å’Œå®¿ä¸»ä¸€è‡´ï¼› â€“dns-search example.com: æŒ‡å®šå®¹å™¨DNSæœç´¢åŸŸåï¼Œé»˜è®¤å’Œå®¿ä¸»ä¸€è‡´ï¼› -h â€œmarsâ€: æŒ‡å®šå®¹å™¨çš„hostnameï¼› -e username&#x3D;â€ritchieâ€: è®¾ç½®ç¯å¢ƒå˜é‡ï¼› â€“env-file&#x3D;[]: ä»æŒ‡å®šæ–‡ä»¶è¯»å…¥ç¯å¢ƒå˜é‡ï¼› â€“cpuset&#x3D;â€0-2â€ or â€“cpuset&#x3D;â€0,1,2â€: ç»‘å®šå®¹å™¨åˆ°æŒ‡å®šCPUè¿è¡Œï¼› -m :è®¾ç½®å®¹å™¨ä½¿ç”¨å†…å­˜æœ€å¤§å€¼ï¼› â€“net&#x3D;â€bridgeâ€: æŒ‡å®šå®¹å™¨çš„ç½‘ç»œè¿æ¥ç±»å‹ï¼Œæ”¯æŒ bridge&#x2F;host&#x2F;none&#x2F;container: å››ç§ç±»å‹ï¼› â€“link&#x3D;[]: æ·»åŠ é“¾æ¥åˆ°å¦ä¸€ä¸ªå®¹å™¨ï¼› â€“expose&#x3D;[]: å¼€æ”¾ä¸€ä¸ªç«¯å£æˆ–ä¸€ç»„ç«¯å£ï¼› å½“åˆ©ç”¨ docker run æ¥åˆ›å»ºå®¹å™¨æ—¶ï¼ŒDocker åœ¨åå°è¿è¡Œçš„æ ‡å‡†æ“ä½œåŒ…æ‹¬ï¼š æ£€æŸ¥æœ¬åœ°æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„é•œåƒï¼Œä¸å­˜åœ¨å°±ä»å…¬æœ‰ä»“åº“ä¸‹è½½ åˆ©ç”¨é•œåƒåˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªå®¹å™¨ åˆ†é…ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶åœ¨åªè¯»çš„é•œåƒå±‚å¤–é¢æŒ‚è½½ä¸€å±‚å¯è¯»å†™å±‚ ä»å®¿ä¸»ä¸»æœºé…ç½®çš„ç½‘æ¡¥æ¥å£ä¸­æ¡¥æ¥ä¸€ä¸ªè™šæ‹Ÿæ¥å£åˆ°å®¹å™¨ä¸­å» ä»åœ°å€æ± é…ç½®ä¸€ä¸ª ip åœ°å€ç»™å®¹å™¨ æ‰§è¡Œç”¨æˆ·æŒ‡å®šçš„åº”ç”¨ç¨‹åº æ‰§è¡Œå®Œæ¯•åå®¹å™¨è¢«ç»ˆæ­¢ docker container startåˆ—å‡ºé•œåƒ image ls æ‰“å°è¾“å‡ºæ‰€æœ‰çš„é•œåƒ æŸ¥çœ‹docker ç£ç›˜çš„ä½¿ç”¨æƒ…å†µ æ³¨æ„ï¼šè¿™é‡Œå¼•ç”³ä¸€ä¸‹docker image å‘½ä»¤æ˜¾ç¤ºå‡ºæ¥çš„å„ç§ä¿¡æ¯ï¼Œdocker image ls åˆ—è¡¨ä¸­çš„é•œåƒä½“ç§¯æ€»å’Œå¹¶éæ˜¯æ‰€æœ‰é•œåƒå®é™…ç¡¬ç›˜æ¶ˆè€—ã€‚ç”±äº Docker é•œåƒæ˜¯å¤šå±‚å­˜å‚¨ç»“æ„ï¼Œå¹¶ä¸”å¯ä»¥ç»§æ‰¿ã€å¤ç”¨ï¼Œå› æ­¤ä¸åŒé•œåƒå¯èƒ½ä¼šå› ä¸ºä½¿ç”¨ç›¸åŒçš„åŸºç¡€é•œåƒï¼Œä»è€Œæ‹¥æœ‰å…±åŒçš„å±‚ã€‚ç”±äº Docker ä½¿ç”¨ Union FSï¼Œç›¸åŒçš„å±‚åªéœ€è¦ä¿å­˜ä¸€ä»½å³å¯ï¼Œå› æ­¤å®é™…é•œåƒç¡¬ç›˜å ç”¨ç©ºé—´å¾ˆå¯èƒ½è¦æ¯”è¿™ä¸ªåˆ—è¡¨é•œåƒå¤§å°çš„æ€»å’Œè¦å°çš„å¤šã€‚ ç‰¹æ®Šçš„ç„è™šé•œåƒç”±äºæ–°æ—§é•œåƒåŒåï¼Œæ—§é•œåƒåç§°è¢«å–æ¶ˆç­‰ï¼Œå‡ºç°ä»“åº“åã€æ ‡ç­¾å‡ä¸º çš„é•œäºŒç»´ç åƒã€‚è¿™ç±»æ— æ ‡ç­¾é•œåƒä¹Ÿè¢«ç§°ä¸º è™šæ‚¬é•œåƒ(dangling image) ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å°†ä¼šç›´æ¥çš„çœ‹åˆ°è¿™äº›é•œåƒ ä¸€èˆ¬æ¥è¯´ï¼Œè™šæ‚¬é•œåƒå·²ç»å¤±å»äº†å­˜åœ¨çš„ä»·å€¼ï¼Œæ˜¯å¯ä»¥éšæ„åˆ é™¤çš„ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤åˆ é™¤ã€‚ ä¸­é—´å±‚é•œåƒé»˜è®¤çš„ docker image ls åˆ—è¡¨ä¸­åªä¼šæ˜¾ç¤ºé¡¶å±‚é•œåƒï¼Œå¦‚æœå¸Œæœ›æ˜¾ç¤ºåŒ…æ‹¬ä¸­é—´å±‚é•œåƒåœ¨å†…çš„æ‰€æœ‰é•œåƒçš„è¯ï¼Œéœ€è¦åŠ  -a å‚æ•°ã€‚ è¿™æ ·ä¼šçœ‹åˆ°å¾ˆå¤šæ— æ ‡ç­¾çš„é•œåƒï¼Œä¸ä¹‹å‰çš„è™šæ‚¬é•œåƒä¸åŒï¼Œè¿™äº›æ— æ ‡ç­¾çš„é•œåƒå¾ˆå¤šéƒ½æ˜¯ä¸­é—´å±‚é•œåƒï¼Œæ˜¯å…¶å®ƒé•œåƒæ‰€ä¾èµ–çš„é•œåƒã€‚è¿™äº›æ— æ ‡ç­¾é•œåƒä¸åº”è¯¥åˆ é™¤ï¼Œå¦åˆ™ä¼šå¯¼è‡´ä¸Šå±‚é•œåƒå› ä¸ºä¾èµ–ä¸¢å¤±è€Œå‡ºé”™ã€‚å®é™…ä¸Šï¼Œè¿™äº›é•œåƒä¹Ÿæ²¡å¿…è¦åˆ é™¤ï¼Œå› ä¸ºä¹‹å‰è¯´è¿‡ï¼Œç›¸åŒçš„å±‚åªä¼šå­˜ä¸€éï¼Œè€Œè¿™äº›é•œåƒæ˜¯åˆ«çš„é•œåƒçš„ä¾èµ–ï¼Œå› æ­¤å¹¶ä¸ä¼šå› ä¸ºå®ƒä»¬è¢«åˆ—å‡ºæ¥è€Œå¤šå­˜äº†ä¸€ä»½ï¼Œæ— è®ºå¦‚ä½•ä½ ä¹Ÿä¼šéœ€è¦å®ƒä»¬ã€‚åªè¦åˆ é™¤é‚£äº›ä¾èµ–å®ƒä»¬çš„é•œåƒåï¼Œè¿™äº›ä¾èµ–çš„ä¸­é—´å±‚é•œåƒä¹Ÿä¼šè¢«è¿å¸¦åˆ é™¤ã€‚ åˆ—å‡ºéƒ¨åˆ†é•œåƒä¸åŠ ä»»ä½•å‚æ•°çš„æƒ…å†µä¸‹ï¼Œdocker image ls ä¼šåˆ—å‡ºæ‰€æœ‰é¡¶çº§é•œåƒï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬åªå¸Œæœ›åˆ—å‡ºéƒ¨åˆ†é•œåƒã€‚docker image ls æœ‰å¥½å‡ ä¸ªå‚æ•°å¯ä»¥å¸®åŠ©åšåˆ°è¿™ä¸ªäº‹æƒ…ã€‚ æ ¹æ®ä»“åº“ååˆ—å‡ºé•œåƒ æ˜¾ç¤ºé•œåƒè¯¦ç»†ä¿¡æ¯ è¿™ä¸ªæ–¹æ³•å°†ä¼šæ˜¾ç¤ºå‡ºè¿™ä¸ªé•œåƒçš„é•¿idç­‰ä¿¡æ¯ åˆ—å‡ºç‰¹å®šçš„æŸä¸ªé•œåƒï¼Œä¹Ÿå°±æ˜¯è¯´æŒ‡å®šä»“åº“åå’Œæ ‡ç­¾ docker image ls è¿˜æ”¯æŒå¼ºå¤§çš„è¿‡æ»¤å™¨å‚æ•° â€“filterï¼Œæˆ–è€…ç®€å†™ -f æ¯”å¦‚ï¼Œæˆ‘ä»¬å¸Œæœ›çœ‹åˆ°åœ¨ mongo:3.2 ä¹‹åå»ºç«‹çš„é•œåƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š æƒ³æŸ¥çœ‹æŸä¸ªä½ç½®ä¹‹å‰çš„é•œåƒä¹Ÿå¯ä»¥ï¼Œåªéœ€è¦æŠŠ since æ¢æˆ before å³å¯ã€‚ åˆ©ç”¨ docker image ls æŠŠæ‰€æœ‰çš„è™šæ‚¬é•œåƒçš„ ID åˆ—å‡ºæ¥ é…åˆä½¿ç”¨go æ¨¡æ¿è¯­æ³•ä¸‹é¢çš„å‘½ä»¤ä¼šç›´æ¥åˆ—å‡ºé•œåƒç»“æœï¼Œå¹¶ä¸”åªåŒ…å«é•œåƒIDå’Œä»“åº“åï¼š æˆ–è€…æ‰“ç®—ä»¥è¡¨æ ¼ç­‰è·æ˜¾ç¤ºï¼Œå¹¶ä¸”æœ‰æ ‡é¢˜è¡Œï¼Œå’Œé»˜è®¤ä¸€æ ·ï¼Œä¸è¿‡è‡ªå·±å®šä¹‰åˆ—ï¼š åˆ é™¤æœ¬åœ°é•œåƒç”¨ IDã€é•œåƒåã€æ‘˜è¦åˆ é™¤é•œåƒå¦‚æœè¦åˆ é™¤æœ¬åœ°çš„é•œåƒï¼Œå¯ä»¥ä½¿ç”¨ docker image rm å‘½ä»¤ï¼Œå…¶æ ¼å¼ä¸ºï¼š <é•œåƒ> å¯ä»¥æ˜¯ é•œåƒçŸ­ IDã€é•œåƒé•¿ IDã€é•œåƒå(<ä»“åº“å>:<æ ‡ç­¾>) æˆ–è€… é•œåƒæ‘˜è¦ å¼•ç”³ï¼š çŸ­id å…¶å®å°±æ˜¯docker image ls å±•ç¤ºçš„ç›¸å…³çš„id Untagged å’Œ Deletedé¦–å…ˆè§‚å¯Ÿä¸€ä¸ªåˆ é™¤çš„å‘½ä»¤å’Œç»“æœ åˆ é™¤è¡Œä¸ºåˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ Untaggedï¼Œå¦ä¸€ç±»æ˜¯ Deletedã€‚æˆ‘ä»¬ä¹‹å‰ä»‹ç»è¿‡ï¼Œé•œåƒçš„å”¯ä¸€æ ‡è¯†æ˜¯å…¶ ID å’Œæ‘˜è¦ï¼Œè€Œä¸€ä¸ªé•œåƒå¯ä»¥æœ‰å¤šä¸ªæ ‡ç­¾ã€‚ å› æ­¤å½“æˆ‘ä»¬ä½¿ç”¨ä¸Šé¢å‘½ä»¤åˆ é™¤é•œåƒçš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯åœ¨è¦æ±‚åˆ é™¤æŸä¸ªæ ‡ç­¾çš„é•œåƒã€‚æ‰€ä»¥é¦–å…ˆéœ€è¦åšçš„æ˜¯å°†æ»¡è¶³æˆ‘ä»¬è¦æ±‚çš„æ‰€æœ‰é•œåƒæ ‡ç­¾éƒ½å–æ¶ˆï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çœ‹åˆ°çš„ Untagged çš„ä¿¡æ¯ã€‚å› ä¸ºä¸€ä¸ªé•œåƒå¯ä»¥å¯¹åº”å¤šä¸ªæ ‡ç­¾ï¼Œå› æ­¤å½“æˆ‘ä»¬åˆ é™¤äº†æ‰€æŒ‡å®šçš„æ ‡ç­¾åï¼Œå¯èƒ½è¿˜æœ‰åˆ«çš„æ ‡ç­¾æŒ‡å‘äº†è¿™ä¸ªé•œåƒï¼Œå¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œé‚£ä¹ˆ Delete è¡Œä¸ºå°±ä¸ä¼šå‘ç”Ÿã€‚æ‰€ä»¥å¹¶éæ‰€æœ‰çš„ docker image rm éƒ½ä¼šäº§ç”Ÿåˆ é™¤é•œåƒçš„è¡Œä¸ºï¼Œæœ‰å¯èƒ½ä»…ä»…æ˜¯å–æ¶ˆäº†æŸä¸ªæ ‡ç­¾è€Œå·²ã€‚ å½“è¯¥é•œåƒæ‰€æœ‰çš„æ ‡ç­¾éƒ½è¢«å–æ¶ˆäº†ï¼Œè¯¥é•œåƒå¾ˆå¯èƒ½ä¼šå¤±å»äº†å­˜åœ¨çš„æ„ä¹‰ï¼Œå› æ­¤ä¼šè§¦å‘åˆ é™¤è¡Œä¸ºã€‚é•œåƒæ˜¯å¤šå±‚å­˜å‚¨ç»“æ„ï¼Œå› æ­¤åœ¨åˆ é™¤çš„æ—¶å€™ä¹Ÿæ˜¯ä»ä¸Šå±‚å‘åŸºç¡€å±‚æ–¹å‘ä¾æ¬¡è¿›è¡Œåˆ¤æ–­åˆ é™¤ã€‚é•œåƒçš„å¤šå±‚ç»“æ„è®©é•œåƒå¤ç”¨å˜åŠ¨éå¸¸å®¹æ˜“ï¼Œå› æ­¤å¾ˆæœ‰å¯èƒ½æŸä¸ªå…¶å®ƒé•œåƒæ­£ä¾èµ–äºå½“å‰é•œåƒçš„æŸä¸€å±‚ã€‚è¿™ç§æƒ…å†µï¼Œä¾æ—§ä¸ä¼šè§¦å‘åˆ é™¤è¯¥å±‚çš„è¡Œä¸ºã€‚ç›´åˆ°æ²¡æœ‰ä»»ä½•å±‚ä¾èµ–å½“å‰å±‚æ—¶ï¼Œæ‰ä¼šçœŸå®çš„åˆ é™¤å½“å‰å±‚ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆï¼Œæœ‰æ—¶å€™ä¼šå¥‡æ€ªï¼Œä¸ºä»€ä¹ˆæ˜æ˜æ²¡æœ‰åˆ«çš„æ ‡ç­¾æŒ‡å‘è¿™ä¸ªé•œåƒï¼Œä½†æ˜¯å®ƒè¿˜æ˜¯å­˜åœ¨çš„åŸå› ï¼Œä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šå‘ç°æ‰€åˆ é™¤çš„å±‚æ•°å’Œè‡ªå·± docker pull çœ‹åˆ°çš„å±‚æ•°ä¸ä¸€æ ·çš„æºã€‚ é™¤äº†é•œåƒä¾èµ–ä»¥å¤–ï¼Œè¿˜éœ€è¦æ³¨æ„çš„æ˜¯å®¹å™¨å¯¹é•œåƒçš„ä¾èµ–ã€‚å¦‚æœæœ‰ç”¨è¿™ä¸ªé•œåƒå¯åŠ¨çš„å®¹å™¨å­˜åœ¨ï¼ˆå³ä½¿å®¹å™¨æ²¡æœ‰è¿è¡Œï¼‰ï¼Œé‚£ä¹ˆåŒæ ·ä¸å¯ä»¥åˆ é™¤è¿™ä¸ªé•œåƒã€‚ä¹‹å‰è®²è¿‡ï¼Œå®¹å™¨æ˜¯ä»¥é•œåƒä¸ºåŸºç¡€ï¼Œå†åŠ ä¸€å±‚å®¹å™¨å­˜å‚¨å±‚ï¼Œç»„æˆè¿™æ ·çš„å¤šå±‚å­˜å‚¨ç»“æ„å»è¿è¡Œçš„ã€‚å› æ­¤è¯¥é•œåƒå¦‚æœè¢«è¿™ä¸ªå®¹å™¨æ‰€ä¾èµ–çš„ï¼Œé‚£ä¹ˆåˆ é™¤å¿…ç„¶ä¼šå¯¼è‡´æ•…éšœã€‚å¦‚æœè¿™äº›å®¹å™¨æ˜¯ä¸éœ€è¦çš„ï¼Œåº”è¯¥å…ˆå°†å®ƒä»¬åˆ é™¤ï¼Œç„¶åå†æ¥åˆ é™¤é•œåƒã€‚ ç”¨ docker image ls å‘½ä»¤æ¥é…åˆåƒå…¶å®ƒå¯ä»¥æ‰¿æ¥å¤šä¸ªå®ä½“çš„å‘½ä»¤ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨ docker image ls -q æ¥é…åˆä½¿ç”¨ docker image rmï¼Œè¿™æ ·å¯ä»¥æˆæ‰¹çš„åˆ é™¤å¸Œæœ›åˆ é™¤çš„é•œåƒã€‚æˆ‘ä»¬åœ¨â€œé•œåƒåˆ—è¡¨â€ç« èŠ‚ä»‹ç»è¿‡å¾ˆå¤šè¿‡æ»¤é•œåƒåˆ—è¡¨çš„æ–¹å¼éƒ½å¯ä»¥æ‹¿è¿‡æ¥ä½¿ç”¨ã€‚ æ¯”å¦‚ï¼Œæˆ‘ä»¬éœ€è¦åˆ é™¤æ‰€æœ‰ä»“åº“åä¸º redis çš„é•œåƒï¼š æˆ–è€…åˆ é™¤æ‰€æœ‰åœ¨ mongo:3.2 ä¹‹å‰çš„é•œåƒï¼š å……åˆ†åˆ©ç”¨ä½ çš„æƒ³è±¡åŠ›å’Œ Linux å‘½ä»¤è¡Œçš„å¼ºå¤§ï¼Œä½ å¯ä»¥å®Œæˆå¾ˆå¤šéå¸¸èµçš„åŠŸèƒ½ã€‚ docker commit å‘½ä»¤å’Œç›¸å…³çš„é—®é¢˜docker commit çš„è¯­æ³•æ ¼å¼ä¸ºï¼š å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹æ³•å°†æŒ‡å®šçš„å®¹å™¨æ‰“åŒ…æˆé•œåƒ å¼•ç”³ï¼šå…¶ä¸­ â€“author æ˜¯æŒ‡å®šä¿®æ”¹çš„ä½œè€…ï¼Œè€Œ â€“message åˆ™æ˜¯è®°å½•æœ¬æ¬¡ä¿®æ”¹çš„å†…å®¹ã€‚è¿™ç‚¹å’Œ git ç‰ˆæœ¬æ§åˆ¶ç›¸ä¼¼ï¼Œä¸è¿‡è¿™é‡Œè¿™äº›ä¿¡æ¯å¯ä»¥çœç•¥ç•™ç©ºã€‚ ä½¿ç”¨ docker commit å‘½ä»¤è™½ç„¶å¯ä»¥æ¯”è¾ƒç›´è§‚çš„å¸®åŠ©ç†è§£é•œåƒåˆ†å±‚å­˜å‚¨çš„æ¦‚å¿µï¼Œä½†æ˜¯å®é™…ç¯å¢ƒä¸­å¹¶ä¸ä¼šè¿™æ ·ä½¿ç”¨ã€‚ é¦–å…ˆï¼Œå¦‚æœä»”ç»†è§‚å¯Ÿä¹‹å‰çš„ docker diff webserver çš„ç»“æœï¼Œä½ ä¼šå‘ç°é™¤äº†çœŸæ­£æƒ³è¦ä¿®æ”¹çš„ &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;index.html æ–‡ä»¶å¤–ï¼Œç”±äºå‘½ä»¤çš„æ‰§è¡Œï¼Œè¿˜æœ‰å¾ˆå¤šæ–‡ä»¶è¢«æ”¹åŠ¨æˆ–æ·»åŠ äº†ã€‚è¿™è¿˜ä»…ä»…æ˜¯æœ€ç®€å•çš„æ“ä½œï¼Œå¦‚æœæ˜¯å®‰è£…è½¯ä»¶åŒ…ã€ç¼–è¯‘æ„å»ºï¼Œé‚£ä¼šæœ‰å¤§é‡çš„æ— å…³å†…å®¹è¢«æ·»åŠ è¿›æ¥ï¼Œå¦‚æœä¸å°å¿ƒæ¸…ç†ï¼Œå°†ä¼šå¯¼è‡´é•œåƒæä¸ºè‡ƒè‚¿ã€‚ æ­¤å¤–ï¼Œä½¿ç”¨ docker commit æ„å‘³ç€æ‰€æœ‰å¯¹é•œåƒçš„æ“ä½œéƒ½æ˜¯é»‘ç®±æ“ä½œï¼Œç”Ÿæˆçš„é•œåƒä¹Ÿè¢«ç§°ä¸ºé»‘ç®±é•œåƒï¼Œæ¢å¥è¯è¯´ï¼Œå°±æ˜¯é™¤äº†åˆ¶ä½œé•œåƒçš„äººçŸ¥é“æ‰§è¡Œè¿‡ä»€ä¹ˆå‘½ä»¤ã€æ€ä¹ˆç”Ÿæˆçš„é•œåƒï¼Œåˆ«äººæ ¹æœ¬æ— ä»å¾—çŸ¥ã€‚è€Œä¸”ï¼Œå³ä½¿æ˜¯è¿™ä¸ªåˆ¶ä½œé•œåƒçš„äººï¼Œè¿‡ä¸€æ®µæ—¶é—´åä¹Ÿæ— æ³•è®°æ¸…å…·ä½“åœ¨æ“ä½œçš„ã€‚è™½ç„¶ docker diff æˆ–è®¸å¯ä»¥å‘Šè¯‰å¾—åˆ°ä¸€äº›çº¿ç´¢ï¼Œä½†æ˜¯è¿œè¿œä¸åˆ°å¯ä»¥ç¡®ä¿ç”Ÿæˆä¸€è‡´é•œåƒçš„åœ°æ­¥ã€‚è¿™ç§é»‘ç®±é•œåƒçš„ç»´æŠ¤å·¥ä½œæ˜¯éå¸¸ç—›è‹¦çš„ã€‚ æ³¨æ„ï¼š åº”è¯¥ä½¿ç”¨dockerfile è¿›è¡Œç›¸å…³çš„é•œåƒç”Ÿæˆå’Œç»´æŠ¤å·¥ä½œ","date":"2024-12-31","categories":["docker"]},{"title":"docker(4)-dockerfileå®šåˆ¶é•œåƒ","url":"/2024/12/31/docker-4--dockerfileå®šåˆ¶é•œåƒ/","content":"ä½¿ç”¨ Dockerfile å®šåˆ¶é•œåƒä»åˆšæ‰çš„ docker commit çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼Œé•œåƒçš„å®šåˆ¶å®é™…ä¸Šå°±æ˜¯å®šåˆ¶æ¯ä¸€å±‚æ‰€æ·»åŠ çš„é…ç½®ã€æ–‡ä»¶ã€‚å¦‚æœæˆ‘ä»¬å¯ä»¥æŠŠæ¯ä¸€å±‚ä¿®æ”¹ã€å®‰è£…ã€æ„å»ºã€æ“ä½œçš„å‘½ä»¤éƒ½å†™å…¥ä¸€ä¸ªè„šæœ¬ï¼Œç”¨è¿™ä¸ªè„šæœ¬æ¥æ„å»ºã€å®šåˆ¶é•œåƒï¼Œé‚£ä¹ˆä¹‹å‰æåŠçš„æ— æ³•é‡å¤çš„é—®é¢˜ã€é•œåƒæ„å»ºé€æ˜æ€§çš„é—®é¢˜ã€ä½“ç§¯çš„é—®é¢˜å°±éƒ½ä¼šè§£å†³ã€‚è¿™ä¸ªè„šæœ¬å°±æ˜¯ Dockerfileã€‚ Dockerfile æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶å†…åŒ…å«äº†ä¸€æ¡æ¡çš„æŒ‡ä»¤(Instruction)ï¼Œæ¯ä¸€æ¡æŒ‡ä»¤æ„å»ºä¸€å±‚ï¼Œå› æ­¤æ¯ä¸€æ¡æŒ‡ä»¤çš„å†…å®¹ï¼Œå°±æ˜¯æè¿°è¯¥å±‚åº”å½“å¦‚ä½•æ„å»ºã€‚ docker æŒ‡ä»¤FROM æŒ‡å®šåŸºç¡€é•œåƒæ‰€è°“å®šåˆ¶é•œåƒï¼Œé‚£ä¸€å®šæ˜¯ä»¥ä¸€ä¸ªé•œåƒä¸ºåŸºç¡€ï¼Œåœ¨å…¶ä¸Šè¿›è¡Œå®šåˆ¶ã€‚å°±åƒæˆ‘ä»¬ä¹‹å‰è¿è¡Œäº†ä¸€ä¸ª nginx é•œåƒçš„å®¹å™¨ï¼Œå†è¿›è¡Œä¿®æ”¹ä¸€æ ·ï¼ŒåŸºç¡€é•œåƒæ˜¯å¿…é¡»æŒ‡å®šçš„ã€‚è€Œ FROM å°±æ˜¯æŒ‡å®šåŸºç¡€é•œåƒï¼Œå› æ­¤ä¸€ä¸ª Dockerfile ä¸­ FROM æ˜¯å¿…å¤‡çš„æŒ‡ä»¤ï¼Œå¹¶ä¸”å¿…é¡»æ˜¯ç¬¬ä¸€æ¡æŒ‡ä»¤ã€‚ From å‘½ä»¤å¯ä»¥åˆ¶å®šç‰¹å®šçš„æœåŠ¡ç±»çš„é•œåƒå¦‚ nginxã€redisã€mongoã€mysqlã€httpdã€phpã€tomcat ç­‰ï¼Œæˆ–è€…ç¼–ç¨‹è¯­è¨€é•œåƒå¦‚ nodeã€openjdkã€pythonã€rubyã€golang ç­‰ï¼Œæˆ–è€…æ“ä½œç³»ç»Ÿå¦‚ ubuntuã€debianã€centosã€fedoraã€alpine ç­‰ï¼Œæˆ–è€…ä½¿ç”¨ç©ºç™½é•œåƒscratchï¼ˆè¿™ä¸ªé•œåƒåªèƒ½è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ï¼‰ run å‘½ä»¤RUN æŒ‡ä»¤æ˜¯ç”¨æ¥æ‰§è¡Œå‘½ä»¤è¡Œå‘½ä»¤çš„ã€‚ç”±äºå‘½ä»¤è¡Œçš„å¼ºå¤§èƒ½åŠ›ï¼ŒRUN æŒ‡ä»¤åœ¨å®šåˆ¶é•œåƒæ—¶æ˜¯æœ€å¸¸ç”¨çš„æŒ‡ä»¤ä¹‹ä¸€ã€‚å…¶æ ¼å¼æœ‰ä¸¤ç§ï¼š shell æ ¼å¼ï¼šRUN <å‘½ä»¤>ï¼Œå°±åƒç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥çš„å‘½ä»¤ä¸€æ ·ã€‚åˆšæ‰å†™çš„ Dockerfile ä¸­çš„ RUN æŒ‡ä»¤å°±æ˜¯è¿™ç§æ ¼å¼ã€‚ exec æ ¼å¼ï¼šRUN [â€œå¯æ‰§è¡Œæ–‡ä»¶â€, â€œå‚æ•°1â€, â€œå‚æ•°2â€]ï¼Œè¿™æ›´åƒæ˜¯å‡½æ•°è°ƒç”¨ä¸­çš„æ ¼å¼ã€‚ æ³¨æ„ï¼šRUN å°±åƒ Shell è„šæœ¬ä¸€æ ·å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸èƒ½å°±å¯ä»¥åƒ Shell è„šæœ¬ä¸€æ ·æŠŠæ¯ä¸ªå‘½ä»¤å¯¹åº”ä¸€ä¸ª RUNï¼Œæ¯”å¦‚è¿™æ · å› ä¸ºDockerfile ä¸­æ¯ä¸€ä¸ªæŒ‡ä»¤éƒ½ä¼šå»ºç«‹ä¸€å±‚ï¼ŒRUN ä¹Ÿä¸ä¾‹å¤–ã€‚æ¯ä¸€ä¸ª RUN çš„è¡Œä¸ºï¼Œå°±å’Œåˆšæ‰æˆ‘ä»¬æ‰‹å·¥å»ºç«‹é•œåƒçš„è¿‡ç¨‹ä¸€æ ·ï¼šæ–°å»ºç«‹ä¸€å±‚ï¼Œåœ¨å…¶ä¸Šæ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œæ‰§è¡Œç»“æŸåï¼Œcommit è¿™ä¸€å±‚çš„ä¿®æ”¹ï¼Œæ„æˆæ–°çš„é•œåƒã€‚ä¸Šé¢çš„è¿™ç§å†™æ³•ï¼Œåˆ›å»ºäº† 7 å±‚é•œåƒã€‚è¿™æ˜¯å®Œå…¨æ²¡æœ‰æ„ä¹‰çš„ï¼Œè€Œä¸”å¾ˆå¤šè¿è¡Œæ—¶ä¸éœ€è¦çš„ä¸œè¥¿ï¼Œéƒ½è¢«è£…è¿›äº†é•œåƒé‡Œï¼Œæ¯”å¦‚ç¼–è¯‘ç¯å¢ƒã€æ›´æ–°çš„è½¯ä»¶åŒ…ç­‰ç­‰ã€‚ç»“æœå°±æ˜¯äº§ç”Ÿéå¸¸è‡ƒè‚¿ã€éå¸¸å¤šå±‚çš„é•œåƒï¼Œä¸ä»…ä»…å¢åŠ äº†æ„å»ºéƒ¨ç½²çš„æ—¶é—´ï¼Œä¹Ÿå¾ˆå®¹æ˜“å‡ºé”™ æ­£ç¡®çš„å†™æ³•åº”è¯¥æ˜¯è¿™æ ·ï¼š å¹¶ä¸”ï¼Œè¿™é‡Œä¸ºäº†æ ¼å¼åŒ–è¿˜è¿›è¡Œäº†æ¢è¡Œã€‚Dockerfile æ”¯æŒ Shell ç±»çš„è¡Œå°¾æ·»åŠ  \\ çš„å‘½ä»¤æ¢è¡Œæ–¹å¼ï¼Œä»¥åŠè¡Œé¦– # è¿›è¡Œæ³¨é‡Šçš„æ ¼å¼ã€‚è‰¯å¥½çš„æ ¼å¼ï¼Œæ¯”å¦‚æ¢è¡Œã€ç¼©è¿›ã€æ³¨é‡Šç­‰ï¼Œä¼šè®©ç»´æŠ¤ã€æ’éšœæ›´ä¸ºå®¹æ˜“ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„ä¹ æƒ¯ã€‚ æ­¤å¤–ï¼Œè¿˜å¯ä»¥çœ‹åˆ°è¿™ä¸€ç»„å‘½ä»¤çš„æœ€åæ·»åŠ äº†æ¸…ç†å·¥ä½œçš„å‘½ä»¤ï¼Œåˆ é™¤äº†ä¸ºäº†ç¼–è¯‘æ„å»ºæ‰€éœ€è¦çš„è½¯ä»¶ï¼Œæ¸…ç†äº†æ‰€æœ‰ä¸‹è½½ã€å±•å¼€çš„æ–‡ä»¶ï¼Œå¹¶ä¸”è¿˜æ¸…ç†äº† apt ç¼“å­˜æ–‡ä»¶ã€‚è¿™æ˜¯å¾ˆé‡è¦çš„ä¸€æ­¥ï¼Œæˆ‘ä»¬ä¹‹å‰è¯´è¿‡ï¼Œé•œåƒæ˜¯å¤šå±‚å­˜å‚¨ï¼Œæ¯ä¸€å±‚çš„ä¸œè¥¿å¹¶ä¸ä¼šåœ¨ä¸‹ä¸€å±‚è¢«åˆ é™¤ï¼Œä¼šä¸€ç›´è·Ÿéšç€é•œåƒã€‚å› æ­¤é•œåƒæ„å»ºæ—¶ï¼Œä¸€å®šè¦ç¡®ä¿æ¯ä¸€å±‚åªæ·»åŠ çœŸæ­£éœ€è¦æ·»åŠ çš„ä¸œè¥¿ï¼Œä»»ä½•æ— å…³çš„ä¸œè¥¿éƒ½åº”è¯¥æ¸…ç†æ‰ã€‚ docker buildå‘½ä»¤docker build å‘½ä»¤å°†ä¼šè‡ªåŠ¨çš„å°†docker file æ–‡ä»¶è¿›è¡Œè¿è¡Œæ„å»ºå‡ºé•œåƒ ä¸‹é¢ä½¿ç”¨çš„dockerfile æ–‡ä»¶ ä»å‘½ä»¤çš„è¾“å‡ºç»“æœä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°é•œåƒçš„æ„å»ºè¿‡ç¨‹ã€‚åœ¨ Step 2 ä¸­ï¼Œå¦‚åŒæˆ‘ä»¬ä¹‹å‰æ‰€è¯´çš„é‚£æ ·ï¼ŒRUN æŒ‡ä»¤å¯åŠ¨äº†ä¸€ä¸ªå®¹å™¨ 9cdc27646c7bï¼Œæ‰§è¡Œäº†æ‰€è¦æ±‚çš„å‘½ä»¤ï¼Œå¹¶æœ€åæäº¤äº†è¿™ä¸€å±‚ 44aa4490ce2cï¼Œéšååˆ é™¤äº†æ‰€ç”¨åˆ°çš„è¿™ä¸ªå®¹å™¨ 9cdc27646c7bã€‚ docker ä½¿ç”¨dockerfileæ„å»ºé•œåƒçš„è¿‡ç¨‹ é¦–å…ˆæˆ‘ä»¬è¦ç†è§£ docker build çš„å·¥ä½œåŸç†ã€‚Docker åœ¨è¿è¡Œæ—¶åˆ†ä¸º Docker å¼•æ“ï¼ˆä¹Ÿå°±æ˜¯æœåŠ¡ç«¯å®ˆæŠ¤è¿›ç¨‹ï¼‰å’Œå®¢æˆ·ç«¯å·¥å…·ã€‚Docker çš„å¼•æ“æä¾›äº†ä¸€ç»„ REST APIï¼Œè¢«ç§°ä¸º Docker Remote APIï¼Œè€Œå¦‚ docker å‘½ä»¤è¿™æ ·çš„å®¢æˆ·ç«¯å·¥å…·ï¼Œåˆ™æ˜¯é€šè¿‡è¿™ç»„ API ä¸ Docker å¼•æ“äº¤äº’ï¼Œä»è€Œå®Œæˆå„ç§åŠŸèƒ½ã€‚å› æ­¤ï¼Œè™½ç„¶è¡¨é¢ä¸Šæˆ‘ä»¬å¥½åƒæ˜¯åœ¨æœ¬æœºæ‰§è¡Œå„ç§ docker åŠŸèƒ½ï¼Œä½†å®é™…ä¸Šï¼Œä¸€åˆ‡éƒ½æ˜¯ä½¿ç”¨çš„è¿œç¨‹è°ƒç”¨å½¢å¼åœ¨æœåŠ¡ç«¯ï¼ˆDocker å¼•æ“ï¼‰å®Œæˆã€‚ä¹Ÿå› ä¸ºè¿™ç§ C&#x2F;S è®¾è®¡ï¼Œè®©æˆ‘ä»¬æ“ä½œè¿œç¨‹æœåŠ¡å™¨çš„ Docker å¼•æ“å˜å¾—è½»è€Œæ˜“ä¸¾ã€‚ å½“æˆ‘ä»¬è¿›è¡Œé•œåƒæ„å»ºçš„æ—¶å€™ï¼Œå¹¶éæ‰€æœ‰å®šåˆ¶éƒ½ä¼šé€šè¿‡ RUN æŒ‡ä»¤å®Œæˆï¼Œç»å¸¸ä¼šéœ€è¦å°†ä¸€äº›æœ¬åœ°æ–‡ä»¶å¤åˆ¶è¿›é•œåƒï¼Œæ¯”å¦‚é€šè¿‡ COPY æŒ‡ä»¤ã€ADD æŒ‡ä»¤ç­‰ã€‚è€Œ docker build å‘½ä»¤æ„å»ºé•œåƒï¼Œå…¶å®å¹¶éåœ¨æœ¬åœ°æ„å»ºï¼Œè€Œæ˜¯åœ¨æœåŠ¡ç«¯ï¼Œä¹Ÿå°±æ˜¯ Docker å¼•æ“ä¸­æ„å»ºçš„ã€‚ é‚£ä¹ˆåœ¨è¿™ç§å®¢æˆ·ç«¯&#x2F;æœåŠ¡ç«¯çš„æ¶æ„ä¸­ï¼Œå¦‚ä½•æ‰èƒ½è®©æœåŠ¡ç«¯è·å¾—æœ¬åœ°æ–‡ä»¶å‘¢ï¼Ÿ è¿™å°±å¼•å…¥äº†ä¸Šä¸‹æ–‡çš„æ¦‚å¿µã€‚å½“æ„å»ºçš„æ—¶å€™ï¼Œç”¨æˆ·ä¼šæŒ‡å®šæ„å»ºé•œåƒä¸Šä¸‹æ–‡çš„è·¯å¾„ï¼Œdocker build å‘½ä»¤å¾—çŸ¥è¿™ä¸ªè·¯å¾„åï¼Œä¼šå°†è·¯å¾„ä¸‹çš„æ‰€æœ‰å†…å®¹æ‰“åŒ…ï¼Œç„¶åä¸Šä¼ ç»™ Docker å¼•æ“ã€‚è¿™æ · Docker å¼•æ“æ”¶åˆ°è¿™ä¸ªä¸Šä¸‹æ–‡åŒ…åï¼Œå±•å¼€å°±ä¼šè·å¾—æ„å»ºé•œåƒæ‰€éœ€çš„ä¸€åˆ‡æ–‡ä»¶ã€‚â€” è¿™é‡Œç®€å•åœ°è¯´å°±æ˜¯ç³»ç»Ÿå°† åˆ¶å®šçš„è‡ªå·±çš„ç›®å½•çš„ä¿¡æ¯æ‰“åŒ…åˆ°dockerä¸­ï¼ˆæ³¨æ„å¹¶ä¸æ˜¯åœ¨å®¹å™¨ï¼‰","date":"2024-12-31","categories":["docker"]},{"title":"docker(4)-dockerfileæŒ‡ä»¤","url":"/2024/12/31/docker-4--dockerfileæŒ‡ä»¤/","content":"COPY å¤åˆ¶æ–‡ä»¶æ ¼å¼ï¼š <æºè·¯å¾„> å¯ä»¥æ˜¯å¤šä¸ªï¼Œç”šè‡³å¯ä»¥æ˜¯é€šé…ç¬¦ï¼Œå…¶é€šé…ç¬¦è§„åˆ™è¦æ»¡è¶³ Go çš„ filepath.Match è§„åˆ™ï¼Œå¦‚ï¼š <ç›®æ ‡è·¯å¾„> å¯ä»¥æ˜¯å®¹å™¨å†…çš„ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹äºå·¥ä½œç›®å½•çš„ç›¸å¯¹è·¯å¾„ï¼ˆå·¥ä½œç›®å½•å¯ä»¥ç”¨ WORKDIR æŒ‡ä»¤æ¥æŒ‡å®šï¼‰ã€‚ç›®æ ‡è·¯å¾„ä¸éœ€è¦äº‹å…ˆåˆ›å»ºï¼Œå¦‚æœç›®å½•ä¸å­˜åœ¨ä¼šåœ¨å¤åˆ¶æ–‡ä»¶å‰å…ˆè¡Œåˆ›å»ºç¼ºå¤±ç›®å½•ã€‚ æ­¤å¤–ï¼Œè¿˜éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œä½¿ç”¨ COPY æŒ‡ä»¤ï¼Œæºæ–‡ä»¶çš„å„ç§å…ƒæ•°æ®éƒ½ä¼šä¿ç•™ã€‚æ¯”å¦‚è¯»ã€å†™ã€æ‰§è¡Œæƒé™ã€æ–‡ä»¶å˜æ›´æ—¶é—´ç­‰ã€‚è¿™ä¸ªç‰¹æ€§å¯¹äºé•œåƒå®šåˆ¶å¾ˆæœ‰ç”¨ã€‚ç‰¹åˆ«æ˜¯æ„å»ºç›¸å…³æ–‡ä»¶éƒ½åœ¨ä½¿ç”¨ Git è¿›è¡Œç®¡ç†çš„æ—¶å€™ã€‚ ADD æ›´é«˜çº§çš„å¤åˆ¶æ–‡ä»¶ADD æŒ‡ä»¤å’Œ COPY çš„æ ¼å¼å’Œæ€§è´¨åŸºæœ¬ä¸€è‡´ã€‚ä½†æ˜¯åœ¨ COPY åŸºç¡€ä¸Šå¢åŠ äº†ä¸€äº›åŠŸèƒ½ã€‚ æ¯”å¦‚ <æºè·¯å¾„> å¯ä»¥æ˜¯ä¸€ä¸ª URLï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒDocker å¼•æ“ä¼šè¯•å›¾å»ä¸‹è½½è¿™ä¸ªé“¾æ¥çš„æ–‡ä»¶æ”¾åˆ° <ç›®æ ‡è·¯å¾„> å»ã€‚ä¸‹è½½åçš„æ–‡ä»¶æƒé™è‡ªåŠ¨è®¾ç½®ä¸º 600ï¼Œå¦‚æœè¿™å¹¶ä¸æ˜¯æƒ³è¦çš„æƒé™ï¼Œé‚£ä¹ˆè¿˜éœ€è¦å¢åŠ é¢å¤–çš„ä¸€å±‚ RUN è¿›è¡Œæƒé™è°ƒæ•´ï¼Œå¦å¤–ï¼Œå¦‚æœä¸‹è½½çš„æ˜¯ä¸ªå‹ç¼©åŒ…ï¼Œéœ€è¦è§£å‹ç¼©ï¼Œä¹Ÿä¸€æ ·è¿˜éœ€è¦é¢å¤–çš„ä¸€å±‚ RUN æŒ‡ä»¤è¿›è¡Œè§£å‹ç¼©ã€‚ æ³¨æ„: å¦‚æœ <æºè·¯å¾„> ä¸ºä¸€ä¸ª tar å‹ç¼©æ–‡ä»¶çš„è¯ï¼Œå‹ç¼©æ ¼å¼ä¸º gzip, bzip2 ä»¥åŠ xz çš„æƒ…å†µä¸‹ï¼ŒADD æŒ‡ä»¤å°†ä¼šè‡ªåŠ¨è§£å‹ç¼©è¿™ä¸ªå‹ç¼©æ–‡ä»¶åˆ° <ç›®æ ‡è·¯å¾„> å»ã€‚ åœ¨ Docker å®˜æ–¹çš„ Dockerfile æœ€ä½³å®è·µæ–‡æ¡£ ä¸­è¦æ±‚ï¼Œå°½å¯èƒ½çš„ä½¿ç”¨ COPYï¼Œå› ä¸º COPY çš„è¯­ä¹‰å¾ˆæ˜ç¡®ï¼Œå°±æ˜¯å¤åˆ¶æ–‡ä»¶è€Œå·²ï¼Œè€Œ ADD åˆ™åŒ…å«äº†æ›´å¤æ‚çš„åŠŸèƒ½ï¼Œå…¶è¡Œä¸ºä¹Ÿä¸ä¸€å®šå¾ˆæ¸…æ™°ã€‚æœ€é€‚åˆä½¿ç”¨ ADD çš„åœºåˆï¼Œå°±æ˜¯æ‰€æåŠçš„éœ€è¦è‡ªåŠ¨è§£å‹ç¼©çš„åœºåˆã€‚ CMD å®¹å™¨å¯åŠ¨å‘½ä»¤CMD æŒ‡ä»¤çš„æ ¼å¼å’Œ RUN ç›¸ä¼¼ï¼Œä¹Ÿæ˜¯ä¸¤ç§æ ¼å¼ï¼š shell æ ¼å¼ï¼šCMD <å‘½ä»¤> exec æ ¼å¼ï¼šCMD [â€œå¯æ‰§è¡Œæ–‡ä»¶â€, â€œå‚æ•°1â€, â€œå‚æ•°2â€â€¦] å‚æ•°åˆ—è¡¨æ ¼å¼ï¼šCMD [â€œå‚æ•°1â€, â€œå‚æ•°2â€â€¦]ã€‚åœ¨æŒ‡å®šäº† ENTRYPOINT æŒ‡ä»¤åï¼Œç”¨ CMD æŒ‡å®šå…·ä½“çš„å‚æ•°ã€‚ ä¹‹åä½¿ç”¨docker run çš„æ—¶å€™å¯ä»¥åŠ¨æ€çš„æ·»åŠ å‘½ä»¤åˆ°æŒ‡å®šçš„æ•°æ®ä¸­ä¹‹å‰ä»‹ç»å®¹å™¨çš„æ—¶å€™æ›¾ç»è¯´è¿‡ï¼ŒDocker ä¸æ˜¯è™šæ‹Ÿæœºï¼Œå®¹å™¨å°±æ˜¯è¿›ç¨‹ã€‚æ—¢ç„¶æ˜¯è¿›ç¨‹ï¼Œé‚£ä¹ˆåœ¨å¯åŠ¨å®¹å™¨çš„æ—¶å€™ï¼Œéœ€è¦æŒ‡å®šæ‰€è¿è¡Œçš„ç¨‹åºåŠå‚æ•°ã€‚CMD æŒ‡ä»¤å°±æ˜¯ç”¨äºæŒ‡å®šé»˜è®¤çš„å®¹å™¨ä¸»è¿›ç¨‹çš„å¯åŠ¨å‘½ä»¤çš„ã€‚ æ³¨æ„ï¼š åœ¨æŒ‡ä»¤æ ¼å¼ä¸Šï¼Œä¸€èˆ¬æ¨èä½¿ç”¨ exec æ ¼å¼ï¼Œè¿™ç±»æ ¼å¼åœ¨è§£ææ—¶ä¼šè¢«è§£æä¸º JSON æ•°ç»„ï¼Œå› æ­¤ä¸€å®šè¦ä½¿ç”¨åŒå¼•å· â€œï¼Œè€Œä¸è¦ä½¿ç”¨å•å¼•å·ã€‚ å¦‚æœä½¿ç”¨ shell æ ¼å¼çš„è¯ï¼Œå®é™…çš„å‘½ä»¤ä¼šè¢«åŒ…è£…ä¸º sh -c çš„å‚æ•°çš„å½¢å¼è¿›è¡Œæ‰§è¡Œã€‚æ¯”å¦‚ï¼š åœ¨å®é™…æ‰§è¡Œä¸­ï¼Œä¼šå°†å…¶å˜æ›´ä¸ºï¼š è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡çš„åŸå› ï¼Œå› ä¸ºè¿™äº›ç¯å¢ƒå˜é‡ä¼šè¢« shell è¿›è¡Œè§£æå¤„ç†ã€‚ æ³¨æ„ï¼šDocker ä¸æ˜¯è™šæ‹Ÿæœºï¼Œå®¹å™¨ä¸­çš„åº”ç”¨éƒ½åº”è¯¥ä»¥å‰å°æ‰§è¡Œï¼Œè€Œä¸æ˜¯åƒè™šæ‹Ÿæœºã€ç‰©ç†æœºé‡Œé¢é‚£æ ·ï¼Œç”¨ upstart&#x2F;systemd å»å¯åŠ¨åå°æœåŠ¡ï¼Œå®¹å™¨å†…æ²¡æœ‰åå°æœåŠ¡çš„æ¦‚å¿µã€‚ æ¯”å¦‚ ä½¿ç”¨ CMD service nginx start å®¹å™¨æ‰§è¡Œåå°±ç«‹å³é€€å‡º ä½¿ç”¨ service nginx start å‘½ä»¤ï¼Œåˆ™æ˜¯å¸Œæœ› upstart æ¥ä»¥åå°å®ˆæŠ¤è¿›ç¨‹å½¢å¼å¯åŠ¨ nginx æœåŠ¡ã€‚è€Œåˆšæ‰è¯´äº† CMD service nginx start ä¼šè¢«ç†è§£ä¸º CMD [ â€œshâ€, â€œ-câ€, â€œservice nginx startâ€]ï¼Œå› æ­¤ä¸»è¿›ç¨‹å®é™…ä¸Šæ˜¯ shã€‚é‚£ä¹ˆå½“ service nginx start å‘½ä»¤ç»“æŸåï¼Œsh ä¹Ÿå°±ç»“æŸäº†ï¼Œsh ä½œä¸ºä¸»è¿›ç¨‹é€€å‡ºäº†ï¼Œè‡ªç„¶å°±ä¼šä»¤å®¹å™¨é€€å‡ºã€‚ æ­£ç¡®çš„åšæ³•æ˜¯ç›´æ¥æ‰§è¡Œ nginx å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶ä¸”è¦æ±‚ä»¥å‰å°å½¢å¼è¿è¡Œã€‚æ¯”å¦‚ï¼š æ³¨æ„ï¼š å¦‚æœ docker run æŒ‡å®šäº†å…¶ä»–å‘½ä»¤ï¼ŒCMD æŒ‡å®šçš„é»˜è®¤å‘½ä»¤å°†è¢«å¿½ç•¥ã€‚å¦‚æœ Dockerfile ä¸­æœ‰å¤šä¸ª CMD æŒ‡ä»¤ï¼Œåªæœ‰æœ€åä¸€ä¸ª CMD æœ‰æ•ˆã€‚ ENTRYPOINT å…¥å£ç‚¹è¿™ä¸ªæ–¹æ³•ç›¸å½“äºé»˜è®¤å®¹å™¨å¯åŠ¨çš„æ—¶å€™è¿è¡Œçš„å‘½ä»¤ ENTRYPOINT çš„æ ¼å¼å’Œ RUN æŒ‡ä»¤æ ¼å¼ä¸€æ ·ï¼Œåˆ†ä¸º exec æ ¼å¼å’Œ shell æ ¼å¼ã€‚ ENTRYPOINT çš„ç›®çš„å’Œ CMD ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨æŒ‡å®šå®¹å™¨å¯åŠ¨ç¨‹åºåŠå‚æ•°ã€‚ENTRYPOINT åœ¨è¿è¡Œæ—¶ä¹Ÿå¯ä»¥æ›¿ä»£ï¼Œä¸è¿‡æ¯” CMD è¦ç•¥æ˜¾ç¹çï¼Œéœ€è¦é€šè¿‡ docker run çš„å‚æ•° â€“entrypoint æ¥æŒ‡å®šã€‚ å½“æŒ‡å®šäº† ENTRYPOINT åï¼ŒCMD çš„å«ä¹‰å°±å‘ç”Ÿäº†æ”¹å˜ï¼Œä¸å†æ˜¯ç›´æ¥çš„è¿è¡Œå…¶å‘½ä»¤ï¼Œè€Œæ˜¯å°† CMD çš„å†…å®¹ä½œä¸ºå‚æ•°ä¼ ç»™ ENTRYPOINT æŒ‡ä»¤ï¼Œæ¢å¥è¯è¯´å®é™…æ‰§è¡Œæ—¶ï¼Œå°†å˜ä¸ºï¼š é«˜çº§åº”ç”¨ç±»ä¼¼ redis å®˜æ–¹é•œåƒï¼Œè‡ªå®šä¹‰å¯åŠ¨æ•ˆæœ å¯ä»¥çœ‹åˆ°å…¶ä¸­ä¸ºäº† redis æœåŠ¡åˆ›å»ºäº† redis ç”¨æˆ·ï¼Œå¹¶åœ¨æœ€åæŒ‡å®šäº† ENTRYPOINT ä¸º docker-entrypoint.sh è„šæœ¬ã€‚ è¯¥è„šæœ¬çš„å†…å®¹å°±æ˜¯æ ¹æ® CMD çš„å†…å®¹æ¥åˆ¤æ–­ï¼Œå¦‚æœæ˜¯ redis-server çš„è¯ï¼Œåˆ™åˆ‡æ¢åˆ° redis ç”¨æˆ·èº«ä»½å¯åŠ¨æœåŠ¡å™¨ï¼Œå¦åˆ™ä¾æ—§ä½¿ç”¨ root èº«ä»½æ‰§è¡Œã€‚æ¯”å¦‚ï¼š RUN vs CMD vs ENTRYPOINTRUNã€CMD å’Œ ENTRYPOINT è¿™ä¸‰ä¸ª Dockerfile æŒ‡ä»¤çœ‹ä¸Šå»å¾ˆç±»ä¼¼ï¼Œå¾ˆå®¹æ˜“æ··æ·†ã€‚æœ¬èŠ‚å°†é€šè¿‡å®è·µè¯¦ç»†è®¨è®ºå®ƒä»¬çš„åŒºåˆ«ã€‚ ç®€å•çš„è¯´ï¼š RUN æ‰§è¡Œå‘½ä»¤å¹¶åˆ›å»ºæ–°çš„é•œåƒå±‚ï¼ŒRUN ç»å¸¸ç”¨äºå®‰è£…è½¯ä»¶åŒ…ã€‚ CMD è®¾ç½®å®¹å™¨å¯åŠ¨åé»˜è®¤æ‰§è¡Œçš„å‘½ä»¤åŠå…¶å‚æ•°ï¼Œä½† CMD èƒ½å¤Ÿè¢« docker run åé¢è·Ÿçš„å‘½ä»¤è¡Œå‚æ•°æ›¿æ¢ã€‚ ENTRYPOINT é…ç½®å®¹å™¨å¯åŠ¨æ—¶è¿è¡Œçš„å‘½ä»¤ã€‚ æœ€ä½³å®è·µ ä½¿ç”¨ RUN æŒ‡ä»¤å®‰è£…åº”ç”¨å’Œè½¯ä»¶åŒ…ï¼Œæ„å»ºé•œåƒã€‚ å¦‚æœ Docker é•œåƒçš„ç”¨é€”æ˜¯è¿è¡Œåº”ç”¨ç¨‹åºæˆ–æœåŠ¡ï¼Œæ¯”å¦‚è¿è¡Œä¸€ä¸ª MySQLï¼Œåº”è¯¥ä¼˜å…ˆä½¿ç”¨ Exec æ ¼å¼çš„ ENTRYPOINT æŒ‡ä»¤ã€‚CMD å¯ä¸º ENTRYPOINT æä¾›é¢å¤–çš„é»˜è®¤å‚æ•°ï¼ŒåŒæ—¶å¯åˆ©ç”¨ docker run å‘½ä»¤è¡Œæ›¿æ¢é»˜è®¤å‚æ•°ã€‚ å¦‚æœæƒ³ä¸ºå®¹å™¨è®¾ç½®é»˜è®¤çš„å¯åŠ¨å‘½ä»¤ï¼Œå¯ä½¿ç”¨ CMD æŒ‡ä»¤ã€‚ç”¨æˆ·å¯åœ¨ docker run å‘½ä»¤è¡Œä¸­æ›¿æ¢æ­¤é»˜è®¤å‘½ä»¤ã€‚ ENV è®¾ç½®ç¯å¢ƒå˜é‡æ ¼å¼æœ‰ä¸¤ç§ï¼š è¿™ä¸ªæŒ‡ä»¤å¾ˆç®€å•ï¼Œå°±æ˜¯è®¾ç½®ç¯å¢ƒå˜é‡è€Œå·²ï¼Œæ— è®ºæ˜¯åé¢çš„å…¶å®ƒæŒ‡ä»¤ï¼Œå¦‚ RUNï¼Œè¿˜æ˜¯è¿è¡Œæ—¶çš„åº”ç”¨ï¼Œéƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™é‡Œå®šä¹‰çš„ç¯å¢ƒå˜é‡ã€‚ é™¤æ­¤ä¹‹å¤–è¿˜èƒ½ä½¿ç”¨ç¯å¢ƒå˜é‡åœ¨ç¼–å†™dockeræ–‡ä»¶çš„æ—¶å€™è¿›è¡Œä½¿ç”¨ï¼Œä¸“ä¸šæœ¯è¯­å˜é‡å±•å¼€ ä¸‹åˆ—æŒ‡ä»¤å¯ä»¥æ”¯æŒç¯å¢ƒå˜é‡å±•å¼€ï¼š ADDã€COPYã€ENVã€EXPOSEã€LABELã€USERã€WORKDIRã€VOLUMEã€STOPSIGNALã€ONBUILDã€‚ å¯ä»¥ä»è¿™ä¸ªæŒ‡ä»¤åˆ—è¡¨é‡Œæ„Ÿè§‰åˆ°ï¼Œç¯å¢ƒå˜é‡å¯ä»¥ä½¿ç”¨çš„åœ°æ–¹å¾ˆå¤šï¼Œå¾ˆå¼ºå¤§ã€‚é€šè¿‡ç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥è®©ä¸€ä»½ Dockerfile åˆ¶ä½œæ›´å¤šçš„é•œåƒï¼Œåªéœ€ä½¿ç”¨ä¸åŒçš„ç¯å¢ƒå˜é‡å³å¯ã€‚ ARG è®¾ç½®ç¯å¢ƒå˜é‡æ„å»ºå‚æ•°å’ŒENVçš„æ•ˆæœä¸€æ ·,éƒ½æ˜¯è®¾ç½®ç¯å¢ƒå˜é‡ã€‚ä½†æ˜¯argè¿˜å¯ä»¥å°†ç›¸å…³çš„å˜é‡ä½¿ç”¨è¿›ç¼–è¯‘è¿‡ç¨‹ä¸­ VOLUME å®šä¹‰åŒ¿åå·æ ¼å¼ä¸ºï¼š ä¹‹å‰æˆ‘ä»¬è¯´è¿‡ï¼Œå®¹å™¨è¿è¡Œæ—¶åº”è¯¥å°½é‡ä¿æŒå®¹å™¨å­˜å‚¨å±‚ä¸å‘ç”Ÿå†™æ“ä½œï¼Œå¯¹äºæ•°æ®åº“ç±»éœ€è¦ä¿å­˜åŠ¨æ€æ•°æ®çš„åº”ç”¨ï¼Œå…¶æ•°æ®åº“æ–‡ä»¶åº”è¯¥ä¿å­˜äºå·(volume)ä¸­ï¼Œåé¢çš„ç« èŠ‚æˆ‘ä»¬ä¼šè¿›ä¸€æ­¥ä»‹ç» Docker å·çš„æ¦‚å¿µã€‚ ä¹‹å‰æˆ‘ä»¬è¯´è¿‡ï¼Œå®¹å™¨è¿è¡Œæ—¶åº”è¯¥å°½é‡ä¿æŒå®¹å™¨å­˜å‚¨å±‚ä¸å‘ç”Ÿå†™æ“ä½œï¼Œå¯¹äºæ•°æ®åº“ç±»éœ€è¦ä¿å­˜åŠ¨æ€æ•°æ®çš„åº”ç”¨ï¼Œå…¶æ•°æ®åº“æ–‡ä»¶åº”è¯¥ä¿å­˜äºå·(volume)ä¸­ EXPOSE å£°æ˜ç«¯å£æ ¼å¼ä¸º EXPOSE <ç«¯å£1> [<ç«¯å£2>â€¦]ã€‚ åœ¨ Dockerfile ä¸­å†™å…¥è¿™æ ·çš„å£°æ˜æœ‰ä¸¤ä¸ªå¥½å¤„ï¼š å¸®åŠ©é•œåƒä½¿ç”¨è€…ç†è§£è¿™ä¸ªé•œåƒæœåŠ¡çš„å®ˆæŠ¤ç«¯å£ï¼Œä»¥æ–¹ä¾¿é…ç½®æ˜ å°„ã€‚ åœ¨è¿è¡Œæ—¶ä½¿ç”¨éšæœºç«¯å£æ˜ å°„æ—¶ï¼Œä¹Ÿå°±æ˜¯ docker run -P æ—¶ï¼Œä¼šè‡ªåŠ¨éšæœºæ˜ å°„ EXPOSE çš„ç«¯å£ã€‚ æ—©æœŸ Docker ç‰ˆæœ¬ä¸­è¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç”¨å¤„ï¼Œè§£å†³ä»¥å‰æ‰€æœ‰å®¹å™¨éƒ½è¿è¡Œäºé»˜è®¤æ¡¥æ¥ç½‘ç»œä¸­ï¼Œæ‰€æœ‰å®¹å™¨äº’ç›¸ä¹‹é—´éƒ½å¯ä»¥ç›´æ¥è®¿é—®å¯¼è‡´çš„å®‰å…¨æ€§é—®é¢˜ã€‚ äºæ˜¯æœ‰äº†ä¸€ä¸ª Docker å¼•æ“å‚æ•° â€“icc&#x3D;false â€“icc&#x3D;falseå‚æ•°ä½œç”¨ï¼šå½“æŒ‡å®šè¯¥å‚æ•°åï¼Œå®¹å™¨é—´å°†é»˜è®¤æ— æ³•äº’è®¿ï¼Œé™¤éäº’ç›¸é—´ä½¿ç”¨äº† â€“links å‚æ•°çš„å®¹å™¨æ‰å¯ä»¥äº’é€šï¼Œå¹¶ä¸”åªæœ‰é•œåƒä¸­ EXPOSE æ‰€å£°æ˜çš„ç«¯å£æ‰å¯ä»¥è¢«è®¿é—®ã€‚è¿™ä¸ª â€“icc&#x3D;false çš„ç”¨æ³•ï¼Œåœ¨å¼•å…¥äº† docker network åå·²ç»åŸºæœ¬ä¸ç”¨äº†ï¼Œé€šè¿‡è‡ªå®šä¹‰ç½‘ç»œå¯ä»¥å¾ˆè½»æ¾çš„å®ç°å®¹å™¨é—´çš„äº’è”ä¸éš”ç¦»ã€‚ æ³¨æ„ï¼šè¦å°† EXPOSE å’Œåœ¨è¿è¡Œæ—¶ä½¿ç”¨ -p <å®¿ä¸»ç«¯å£>:<å®¹å™¨ç«¯å£> åŒºåˆ†å¼€æ¥ã€‚-pï¼Œæ˜¯æ˜ å°„å®¿ä¸»ç«¯å£å’Œå®¹å™¨ç«¯å£ï¼Œæ¢å¥è¯è¯´ï¼Œå°±æ˜¯å°†å®¹å™¨çš„å¯¹åº”ç«¯å£æœåŠ¡å…¬å¼€ç»™å¤–ç•Œè®¿é—®ï¼Œè€Œ EXPOSE ä»…ä»…æ˜¯å£°æ˜å®¹å™¨æ‰“ç®—ä½¿ç”¨ä»€ä¹ˆç«¯å£è€Œå·²ï¼Œå¹¶ä¸ä¼šè‡ªåŠ¨åœ¨å®¿ä¸»è¿›è¡Œç«¯å£æ˜ å°„ã€‚ WORKDIR æŒ‡å®šå·¥ä½œç›®å½•æ ¼å¼ä¸º WORKDIR <å·¥ä½œç›®å½•è·¯å¾„>ã€‚ è¿™ä¸ªå‘½ä»¤æ˜¯ä¸ºäº†è§£å†³ï¼Œå¦‚ä¸‹shell å‘½ä»¤ä¼šäº§ç”Ÿçš„é—®é¢˜ å› ä¸ºæ¯ä¸€ä¸ªrun å‘½ä»¤éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªå®¹æ˜“æ‰€ä»¥ä¼šå¯¼è‡´å¯¹åº”çš„æ–‡ä»¶ç›®å½•ä¸åŒï¼Œé€šè¿‡ä½¿ç”¨è¿™ä¸ªååˆ©å¯ä»¥ç›¸å…³çš„æ–‡ä»¶ç›®å½•ç»Ÿä¸€ USER æŒ‡å®šå½“å‰ç”¨æˆ·å’ŒWORKDIRéƒ½æ˜¯è§£å†³docker runç±»ä¼¼çš„å‘½ä»¤äº§ç”Ÿæ–°çš„å®¹å™¨å¯¼è‡´ç¯å¢ƒä¸åŒçš„é—®é¢˜ï¼Œåªä¸è¿‡WORKDIRé’ˆå¯¹ç›®å½•USERé’ˆå¯¹ç”¨æˆ· HEALTHCHECK å¥åº·æ£€æŸ¥æ ¼å¼ï¼š HEALTHCHECK [é€‰é¡¹] CMD <å‘½ä»¤>ï¼šè®¾ç½®æ£€æŸ¥å®¹å™¨å¥åº·çŠ¶å†µçš„å‘½ä»¤ HEALTHCHECK NONEï¼šå¦‚æœåŸºç¡€é•œåƒæœ‰å¥åº·æ£€æŸ¥æŒ‡ä»¤ï¼Œä½¿ç”¨è¿™è¡Œå¯ä»¥å±è”½æ‰å…¶å¥åº·æ£€æŸ¥æŒ‡ä»¤ HEALTHCHECK æŒ‡ä»¤æ˜¯å‘Šè¯‰ Docker åº”è¯¥å¦‚ä½•è¿›è¡Œåˆ¤æ–­å®¹å™¨çš„çŠ¶æ€æ˜¯å¦æ­£å¸¸ï¼Œè¿™æ˜¯ Docker 1.12 å¼•å…¥çš„æ–°æŒ‡ä»¤ã€‚ HEALTHCHECK æ”¯æŒä¸‹åˆ—é€‰é¡¹ï¼š â€“interval&#x3D;<é—´éš”>ï¼šä¸¤æ¬¡å¥åº·æ£€æŸ¥çš„é—´éš”ï¼Œé»˜è®¤ä¸º 30 ç§’ï¼› â€“timeout&#x3D;<æ—¶é•¿>ï¼šå¥åº·æ£€æŸ¥å‘½ä»¤è¿è¡Œè¶…æ—¶æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œæœ¬æ¬¡å¥åº·æ£€æŸ¥å°±è¢«è§†ä¸ºå¤±è´¥ï¼Œé»˜è®¤ 30 ç§’ï¼› â€“retries&#x3D;<æ¬¡æ•°>ï¼šå½“è¿ç»­å¤±è´¥æŒ‡å®šæ¬¡æ•°åï¼Œåˆ™å°†å®¹å™¨çŠ¶æ€è§†ä¸º unhealthyï¼Œé»˜è®¤ 3 æ¬¡ã€‚å’Œ CMD, ENTRYPOINT ä¸€æ ·ï¼ŒHEALTHCHECK åªå¯ä»¥å‡ºç°ä¸€æ¬¡ï¼Œå¦‚æœå†™äº†å¤šä¸ªï¼Œåªæœ‰æœ€åä¸€ä¸ªç”Ÿæ•ˆã€‚ åœ¨ HEALTHCHECK [é€‰é¡¹] CMD åé¢çš„å‘½ä»¤ï¼Œæ ¼å¼å’Œ ENTRYPOINT ä¸€æ ·ï¼Œåˆ†ä¸º shell æ ¼å¼ï¼Œå’Œ exec æ ¼å¼ã€‚å‘½ä»¤çš„è¿”å›å€¼å†³å®šäº†è¯¥æ¬¡å¥åº·æ£€æŸ¥çš„æˆåŠŸä¸å¦ï¼š0ï¼šæˆåŠŸï¼›1ï¼šå¤±è´¥ï¼›2ï¼šä¿ç•™ï¼Œä¸è¦ä½¿ç”¨è¿™ä¸ªå€¼ã€‚ å‡è®¾æˆ‘ä»¬æœ‰ä¸ªé•œåƒæ˜¯ä¸ªæœ€ç®€å•çš„ Web æœåŠ¡ï¼Œæˆ‘ä»¬å¸Œæœ›å¢åŠ å¥åº·æ£€æŸ¥æ¥åˆ¤æ–­å…¶ Web æœåŠ¡æ˜¯å¦åœ¨æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ curl æ¥å¸®åŠ©åˆ¤æ–­ï¼Œå…¶ Dockerfile çš„ HEALTHCHECK å¯ä»¥è¿™ä¹ˆå†™ï¼š å½“è¿è¡Œè¯¥é•œåƒåï¼Œå¯ä»¥é€šè¿‡ docker container ls çœ‹åˆ°æœ€åˆçš„çŠ¶æ€ä¸º (health: starting)ï¼š åœ¨ç­‰å¾…å‡ ç§’é’Ÿåï¼Œå†æ¬¡ docker container lsï¼Œå°±ä¼šçœ‹åˆ°å¥åº·çŠ¶æ€å˜åŒ–ä¸ºäº† (healthy)ï¼š ONBUILD ä¸ºä»–äººåšå«è¡£è£³æ ¼å¼ï¼šONBUILD <å…¶å®ƒæŒ‡ä»¤>ã€‚ ONBUILD æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æŒ‡ä»¤ï¼Œå®ƒåé¢è·Ÿçš„æ˜¯å…¶å®ƒæŒ‡ä»¤ï¼Œæ¯”å¦‚ RUN, COPY ç­‰ï¼Œè€Œè¿™äº›æŒ‡ä»¤ï¼Œåœ¨å½“å‰é•œåƒæ„å»ºæ—¶å¹¶ä¸ä¼šè¢«æ‰§è¡Œã€‚åªæœ‰å½“ä»¥å½“å‰é•œåƒä¸ºåŸºç¡€é•œåƒï¼Œå»æ„å»ºä¸‹ä¸€çº§é•œåƒçš„æ—¶å€™æ‰ä¼šè¢«æ‰§è¡Œã€‚ Dockerfile ä¸­çš„å…¶å®ƒæŒ‡ä»¤éƒ½æ˜¯ä¸ºäº†å®šåˆ¶å½“å‰é•œåƒè€Œå‡†å¤‡çš„ï¼Œå”¯æœ‰ ONBUILD æ˜¯ä¸ºäº†å¸®åŠ©åˆ«äººå®šåˆ¶è‡ªå·±è€Œå‡†å¤‡çš„ã€‚","date":"2024-12-31","categories":["docker"]},{"title":"git-åŸºæœ¬ä½¿ç”¨æ•™ç¨‹","url":"/2024/12/31/git-åŸºæœ¬ä½¿ç”¨æ•™ç¨‹/","content":"ä»Šå¤©åˆšåˆšè¿›è¡Œå·¥ä½œä¸€ä¸ªæ˜ŸæœŸï¼Œæ„Ÿè§‰è‡ªå·±ä»¥å‰åœ¨å¤§å­¦é‡Œè‡ªå·±åšé¡¹ç›®çš„æ—¶å€™è®¸å¤šæ¬ ç¼ºçš„åœ°æ–¹ï¼Œæ¯”å¦‚è¯´ç‰ˆæœ¬æ§åˆ¶ä¸Šçš„æ¬ ç¼ºï¼Œè¿™é‡Œå†™å‡ ç¯‡åšå®¢è¡¥å……ä¸€ä¸‹è‡ªå·±åœ¨ç‰ˆæœ¬æ§åˆ¶ä¸Šé¢çš„å‘ å°†ä¸€ä¸ªçº³å…¥gitçš„æ§åˆ¶ä¹‹ä¸­ è¿™ä¸ªå‘½ä»¤å°†ä¸€ä¸ªæ–‡ä»¶å¤¹æ–°å»ºæˆä¸€ä¸ªgitä»“åº“ å°†æ–‡ä»¶æ”¾å…¥æš‚å­˜åŒº è¿™ä¸ªæ–¹æ³•å¯ä»¥ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ–¹æ³•æ”¾å…¥æ–‡ä»¶çš„æš‚å­˜åŒº å…‹éš†è¿œç¨‹ç‰ˆæœ¬åº“ å¯ä»¥å°†æŒ‡å®šçš„è¿œç¨‹ä»“åº“å…‹éš†åˆ°æœ¬åœ° æ›´æ–°æœ¬çš„ä»“åº“ä¸­çš„æ–‡ä»¶ ä¸Šé¢ä¾‹å­ä¸­ä»£ç çš„ä½œç”¨å°±æ˜¯å°†å“¦originæŒ‡å®šçš„è¿œç¨‹ä»“åº“ä¸­çš„nextåˆ†æ”¯åˆå¹¶åˆ°æœ¬åœ°åˆ†æ”¯ä¸­ åœ¨é»˜è®¤æ¨¡å¼ä¸‹ï¼Œgit pullæ˜¯git fetchåè·Ÿgit merge FETCH_HEADçš„ç¼©å†™ git branchgit branch å¯¹å‘½ä»¤è¿›è¡Œåˆ†æ”¯è¿›è¡Œæ“ä½œ å…¶ä»–çš„ä¸€äº›è¯´æ˜","date":"2024-12-31","categories":["git"]},{"title":"git_åœ¨linux ç¯å¢ƒä¸‹ä¸­æ–‡ä¹±ç é—®é¢˜è§£å†³","url":"/2024/12/31/git_åœ¨linux-ç¯å¢ƒä¸‹ä¸­æ–‡ä¹±ç é—®é¢˜è§£å†³/","content":"çœ‹äº†ç½‘ä¸Šå¥½å¤šæ•™ç¨‹ å…¶å®ä¸€è¡Œå‘½ä»¤å°±å¯ä»¥è§£å†³","date":"2024-12-31","categories":["git"]},{"title":"golangå­¦ä¹ ç¬”è®°(1)-åŒ…å˜é‡å‡½æ•°","url":"/2024/12/31/golangå­¦ä¹ ç¬”è®°-1--åŒ…å˜é‡å‡½æ•°/","content":"golangçš„åŒ…ç®¡ç†å’Œå˜é‡ç®¡ç†éƒ½æ˜¯éå¸¸å®¹æ˜“çš„ golang åŒ…golangåœ¨ä½¿ç”¨çš„æ—¶å€™å¯ä»¥é€šè¿‡import å…³é”®å­—å¼•å…¥åŒ… å…¶ä»–çš„åŒ…åœ¨å®šä¹‰çš„æ—¶å€™å¯ä»¥ä½¿ç”¨package æ¥å®šä¹‰ä¸€ä¸ªåŒ… æ³¨æ„ mainåŒ…æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„åŒ…ï¼Œè¿™ä¸ªåŒ…è¡¨ç¤ºgolangæ‰§è¡Œçš„å…¥å£ è¿™é‡Œå…¶å®æœ‰ä¸€ä¸ªå°å‘ï¼Œå°±æ˜¯golangçš„ä»£ç å¼€å‘ç›®å½•å¿…é¡»æ˜¯æ˜¯GOPATHç¯å¢ƒå˜é‡ä¸‹çš„srcç›®å½•ä¸­ï¼Œä¸ç„¶å¼•ç”¨åŒ…çš„æ—¶å€™æ‰¾ä¸åˆ°ä»£ç  æ³¨æ„ åœ¨å…¨å±€ç¯å¢ƒä¸­åŒä¸€ä¸ªåŒ…åä¸­ä¸èƒ½æœ‰ç›¸åŒçš„æ–¹æ³•æ¥å£å£°æ˜ ï¼Œ é™¤äº†mainåŒ…ï¼Œå…¶ä»–çš„åŒ…åç§°å¿…é¡»å’Œä»–çš„ä¸Šå±‚æ–‡ä»¶å¤¹çš„åç§°ä¸€è‡´ goang å‡½æ•°å®šä¹‰ golangçš„å‚æ•°ç±»å‹æ˜¯æ”¾åœ¨åé¢çš„ golangçš„è¿”å›å€¼æ˜¯intç±»å‹ æ³¨æ„å¦‚æœè¿™ä¸ªæ–¹æ³•æ˜¯å¯ä»¥å¯¼å‡ºçš„é¦–å­—æ¯è¦å¤§å†™ golang æ”¯æŒå¤šä¸ªè¿”å›å€¼,ä½¿ç”¨çš„æ˜¯åè§£åŒ…æ¨¡å¼ golangè¿˜æ”¯æŒå‘½åè¿”å›ç›´æ¥ä½¿ç”¨è¿”å›çš„å˜é‡ä½œä¸ºè¿”å›å€¼ golang å˜é‡å£°æ˜æ–¹æ³• golangåŸºæœ¬ç±»å‹ golang åˆå§‹åŒ–å€¼æ²¡æœ‰æ˜ç¡®åˆå§‹å€¼çš„å˜é‡å£°æ˜ä¼šè¢«èµ‹äºˆå®ƒä»¬çš„ é›¶å€¼ã€‚ é›¶å€¼æ˜¯ï¼š æ•°å€¼ç±»å‹ä¸º 0ï¼Œ å¸ƒå°”ç±»å‹ä¸º falseï¼Œ å­—ç¬¦ä¸²ä¸º â€œâ€ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰ã€‚ ç±»å‹å¼ºåˆ¶è½¬åŒ–æ–¹æ³•golangä½¿ç”¨å˜é‡åç§°+() å¼ºåˆ¶è½¬åŒ– å¸¸é‡ æ³¨æ„ å¸¸é‡çš„å£°æ˜ä¸å˜é‡ç±»ä¼¼ï¼Œåªä¸è¿‡æ˜¯ä½¿ç”¨ const å…³é”®å­—ã€‚ å¸¸é‡å¯ä»¥æ˜¯å­—ç¬¦ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼æˆ–æ•°å€¼ã€‚ å¸¸é‡ä¸èƒ½ç”¨ :&#x3D; è¯­æ³•å£°æ˜ã€‚ä¹Ÿä¸ç”¨å¸¦ä¸Šç±»å‹","date":"2024-12-31","categories":["golang"]},{"title":"golangå­¦ä¹ ç¬”è®°(2)-æµç¨‹æ§åˆ¶è¯­å¥","url":"/2024/12/31/golangå­¦ä¹ ç¬”è®°-2--æµç¨‹æ§åˆ¶è¯­å¥/","content":"for ç®€å•æ¥ä¹¦å°±æ˜¯æ²¡æœ‰èŠ±é˜”åŒ–çš„forå¾ªç¯ golangç”¨ for æ¥ä»£æ›¿whileå¾ªç¯å’Œæ­»å¾ªç¯ for å¾ªç¯çš„ range å½¢å¼å¯éå†åˆ‡ç‰‡æˆ–æ˜ å°„ã€‚ å½“ä½¿ç”¨ for å¾ªç¯éå†åˆ‡ç‰‡æ—¶ï¼Œæ¯æ¬¡è¿­ä»£éƒ½ä¼šè¿”å›ä¸¤ä¸ªå€¼ã€‚ç¬¬ä¸€ä¸ªå€¼ä¸ºå½“å‰å…ƒç´ çš„ä¸‹æ ‡ï¼Œç¬¬äºŒä¸ªå€¼ä¸ºè¯¥ä¸‹æ ‡æ‰€å¯¹åº”å…ƒç´ çš„ä¸€ä»½å‰¯æœ¬ã€‚ if else swichgolangçš„switch æ²¡æœ‰break ï¼Œè€Œä¸”æ‰€æœ‰å¯ä»¥ä½¿ç”¨&#x3D; å·è¿›è¡Œåˆ¤æ–­çš„éƒ½å¯ä»¥æ”¾å…¥å…¶ä¸­ æ³¨æ„æ²¡æœ‰æ¡ä»¶çš„swich æ²¡æœ‰æ¡ä»¶çš„ switch åŒ switch true ä¸€æ ·ã€‚è¿™ç§å½¢å¼èƒ½å°†ä¸€é•¿ä¸² if-then-else å†™å¾—æ›´åŠ æ¸…æ™°ã€‚ deferdefer è¯­å¥ä¼šå°†å‡½æ•°æ¨è¿Ÿåˆ°å¤–å±‚å‡½æ•°è¿”å›ä¹‹åæ‰§è¡Œã€‚æ¨è¿Ÿè°ƒç”¨çš„å‡½æ•°å…¶å‚æ•°ä¼šç«‹å³æ±‚å€¼ï¼Œä½†ç›´åˆ°å¤–å±‚å‡½æ•°è¿”å›å‰è¯¥å‡½æ•°éƒ½ä¸ä¼šè¢«è°ƒç”¨ã€‚ æ³¨æ„ï¼šæ¨è¿Ÿçš„å‡½æ•°è°ƒç”¨ä¼šè¢«å‹å…¥ä¸€ä¸ªæ ˆä¸­ã€‚å½“å¤–å±‚å‡½æ•°è¿”å›æ—¶ï¼Œè¢«æ¨è¿Ÿçš„å‡½æ•°ä¼šæŒ‰ç…§åè¿›å…ˆå‡ºçš„é¡ºåºè°ƒç”¨","date":"2024-12-31","categories":["golang"]},{"title":"golangå­¦ä¹ ç¬”è®°(3)-æ›´å¤šç±»å‹æŒ‡é’ˆç»“æ„ä½“æ•°ç»„mapæŒ‡é’ˆæ¥å£","url":"/2024/12/31/golangå­¦ä¹ ç¬”è®°-3--æ›´å¤šç±»å‹æŒ‡é’ˆç»“æ„ä½“æ•°ç»„mapæŒ‡é’ˆæ¥å£/","content":"æŒ‡é’ˆGo æ‹¥æœ‰æŒ‡é’ˆã€‚æŒ‡é’ˆä¿å­˜äº†å€¼çš„å†…å­˜åœ°å€ã€‚ ç±»å‹ *T æ˜¯æŒ‡å‘ T ç±»å‹å€¼çš„æŒ‡é’ˆã€‚å…¶é›¶å€¼ä¸º nilã€‚ & æ“ä½œç¬¦ä¼šç”Ÿæˆä¸€ä¸ªæŒ‡å‘å…¶æ“ä½œæ•°çš„æŒ‡é’ˆã€‚ æ“ä½œç¬¦è¡¨ç¤ºæŒ‡é’ˆæŒ‡å‘çš„åº•å±‚å€¼ã€‚ è¿™ä¹Ÿå°±æ˜¯é€šå¸¸æ‰€è¯´çš„â€œé—´æ¥å¼•ç”¨â€æˆ–â€œé‡å®šå‘â€ã€‚ä¸ C ä¸åŒï¼ŒGo æ²¡æœ‰æŒ‡é’ˆè¿ç®—ã€‚ ç»“æ„ä½“ç»“æ„ä½“åŸºæœ¬ä½¿ç”¨ ç»“æ„ä½“æŒ‡é’ˆ å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªæŒ‡å‘ç»“æ„ä½“çš„æŒ‡é’ˆ pï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ (*p).X æ¥è®¿é—®å…¶å­—æ®µ Xã€‚ä¸è¿‡è¿™ä¹ˆå†™å¤ªå•°å—¦äº†ï¼Œæ‰€ä»¥è¯­è¨€ä¹Ÿå…è®¸æˆ‘ä»¬ä½¿ç”¨éšå¼é—´æ¥å¼•ç”¨ï¼Œç›´æ¥å†™ p.X å°±å¯ä»¥ã€‚ ç»“æ„ä½“å£°æ˜æ–¹æ³• é¡ºåºèµ‹å€¼ æŒ‡å®šèµ‹å€¼ é»˜è®¤èµ‹å€¼ å¿«é€ŸæŒ‡é’ˆ ç»“æ„ä½“é»˜è®¤æ–¹æ³•golangçš„ç»“æ„ä½“æ”¯æŒé»˜è®¤æ”¯æŒçš„æ–¹æ³•ï¼Œç”¨æ¥è¡¨ç¤ºå¯¹è±¡ æ³¨æ„è¿™ç§æ–¹æ³•æ˜¯åªè¯»çš„ï¼Œä¿®æ”¹å°†ä¸ä¼šç”Ÿæ•ˆï¼Œå¦‚æœéœ€è¦ä¿®æ”¹éœ€è¦ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶æ–¹æ³• ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶è€…çš„åŸå› æœ‰äºŒï¼šé¦–å…ˆï¼Œæ–¹æ³•èƒ½å¤Ÿä¿®æ”¹å…¶æ¥æ”¶è€…æŒ‡å‘çš„å€¼ã€‚å…¶æ¬¡ï¼Œè¿™æ ·å¯ä»¥é¿å…åœ¨æ¯æ¬¡è°ƒç”¨æ–¹æ³•æ—¶å¤åˆ¶è¯¥å€¼ã€‚è‹¥å€¼çš„ç±»å‹ä¸ºå¤§å‹ç»“æ„ä½“æ—¶ï¼Œè¿™æ ·åšä¼šæ›´åŠ é«˜æ•ˆã€‚ æ•°ç»„ æ•°ç»„åˆ‡ç‰‡ æ³¨æ„æ˜¯ [start:end) è¿™ç§æ–¹æ³•æ˜¯å‰å¼€åé—­çš„ æ³¨æ„åˆ‡ç‰‡å…¶å®æ˜¯å¼•ç”¨åˆ‡ç‰‡ï¼Œæ•°æ®ä¿®æ”¹ä¼šå…±äº« æ³¨æ„:å¦‚æœæ²¡æœ‰å†™æ•°å­—å°†ä¼šä»¥æ•°ç»„é•¿åº¦æ¥è¡¡é‡ ä»¥ä¸‹åˆ‡ç‰‡æ˜¯ç­‰ä»·çš„ï¼š åˆ‡ç‰‡çš„é•¿åº¦ä¸å®¹é‡åˆ‡ç‰‡æ‹¥æœ‰ é•¿åº¦ å’Œ å®¹é‡ã€‚ åˆ‡ç‰‡çš„é•¿åº¦å°±æ˜¯å®ƒæ‰€åŒ…å«çš„å…ƒç´ ä¸ªæ•°ã€‚ åˆ‡ç‰‡çš„å®¹é‡æ˜¯ä»å®ƒçš„ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹æ•°ï¼Œåˆ°å…¶åº•å±‚æ•°ç»„å…ƒç´ æœ«å°¾çš„ä¸ªæ•°ã€‚ åˆ‡ç‰‡ s çš„é•¿åº¦å’Œå®¹é‡å¯é€šè¿‡è¡¨è¾¾å¼ len(s) å’Œ cap(s) æ¥è·å–ã€‚ ä½ å¯ä»¥é€šè¿‡é‡æ–°åˆ‡ç‰‡æ¥æ‰©å±•ä¸€ä¸ªåˆ‡ç‰‡ï¼Œç»™å®ƒæä¾›è¶³å¤Ÿçš„å®¹é‡ã€‚è¿™æ ·ä¼šå½¢æˆä¸€ä¸ªçª—å£æ¥å®¡è§†åŸæ¥çš„æ•°ç»„ æ³¨æ„ï¼šåˆ‡ç‰‡çš„é›¶å€¼æ˜¯ nil åŠ¨æ€åˆ›å»ºæ•°ç»„æˆ–è€…åˆ‡ç‰‡ åˆ‡ç‰‡è¿½åŠ æ•°æ® append çš„ç¬¬ä¸€ä¸ªå‚æ•° s æ˜¯ä¸€ä¸ªå…ƒç´ ç±»å‹ä¸º T çš„åˆ‡ç‰‡ï¼Œå…¶ä½™ç±»å‹ä¸º T çš„å€¼å°†ä¼šè¿½åŠ åˆ°è¯¥åˆ‡ç‰‡çš„æœ«å°¾ã€‚ append çš„ç»“æœæ˜¯ä¸€ä¸ªåŒ…å«åŸåˆ‡ç‰‡æ‰€æœ‰å…ƒç´ åŠ ä¸Šæ–°æ·»åŠ å…ƒç´ çš„åˆ‡ç‰‡ã€‚ å½“ s çš„åº•å±‚æ•°ç»„å¤ªå°ï¼Œä¸è¶³ä»¥å®¹çº³æ‰€æœ‰ç»™å®šçš„å€¼æ—¶ï¼Œå®ƒå°±ä¼šåˆ†é…ä¸€ä¸ªæ›´å¤§çš„æ•°ç»„ã€‚è¿”å›çš„åˆ‡ç‰‡ä¼šæŒ‡å‘è¿™ä¸ªæ–°åˆ†é…çš„æ•°ç»„ã€‚ for å¾ªç¯è¿­ä»£for å¾ªç¯çš„ range å½¢å¼å¯éå†åˆ‡ç‰‡æˆ–æ˜ å°„ã€‚ å½“ä½¿ç”¨ for å¾ªç¯éå†åˆ‡ç‰‡æ—¶ï¼Œæ¯æ¬¡è¿­ä»£éƒ½ä¼šè¿”å›ä¸¤ä¸ªå€¼ã€‚ç¬¬ä¸€ä¸ªå€¼ä¸ºå½“å‰å…ƒç´ çš„ä¸‹æ ‡ï¼Œç¬¬äºŒä¸ªå€¼ä¸ºè¯¥ä¸‹æ ‡æ‰€å¯¹åº”å…ƒç´ çš„ä¸€ä»½å‰¯æœ¬ å¯ä»¥å°†ä¸‹æ ‡æˆ–å€¼èµ‹äºˆ _ æ¥å¿½ç•¥å®ƒã€‚ è‹¥ä½ åªéœ€è¦ç´¢å¼•ï¼Œå¿½ç•¥ç¬¬äºŒä¸ªå˜é‡å³å¯ã€‚ mapmap ä½¿ç”¨make æ–¹æ³•ç”Ÿæˆï¼Œä¸¤ä¸ªå‚æ•° ç±»å‹å’Œå€¼ golangæ”¯æŒåˆå§‹åŒ–æ˜ å°„è¯­æ³• æ˜ å°„çš„æ–‡æ³•ä¸ç»“æ„ä½“ç›¸ä¼¼ï¼Œä¸è¿‡å¿…é¡»æœ‰é”®åã€‚ è‹¥é¡¶çº§ç±»å‹åªæ˜¯ä¸€ä¸ªç±»å‹åï¼Œä½ å¯ä»¥åœ¨æ–‡æ³•çš„å…ƒç´ ä¸­çœç•¥å®ƒã€‚ åœ¨æ˜ å°„ m ä¸­æ’å…¥æˆ–ä¿®æ”¹å…ƒç´ ï¼š è·å–å…ƒç´ ï¼š åˆ é™¤å…ƒç´ ï¼š é€šè¿‡åŒèµ‹å€¼æ£€æµ‹æŸä¸ªé”®æ˜¯å¦å­˜åœ¨ï¼š è‹¥ key åœ¨ m ä¸­ï¼Œok ä¸º true ï¼›å¦åˆ™ï¼Œok ä¸º falseã€‚è‹¥ key ä¸åœ¨æ˜ å°„ä¸­ï¼Œé‚£ä¹ˆ elem æ˜¯è¯¥æ˜ å°„å…ƒç´ ç±»å‹çš„é›¶å€¼ã€‚åŒæ ·çš„ï¼Œå½“ä»æ˜ å°„ä¸­è¯»å–æŸä¸ªä¸å­˜åœ¨çš„é”®æ—¶ï¼Œç»“æœæ˜¯æ˜ å°„çš„å…ƒç´ ç±»å‹çš„é›¶å€¼ã€‚æ³¨ ï¼šè‹¥ elem æˆ– ok è¿˜æœªå£°æ˜ï¼Œä½ å¯ä»¥ä½¿ç”¨çŸ­å˜é‡å£°æ˜ï¼š å‡½æ•°å€¼ä¼ å‚golangä¸­å‡½æ•°ä¹Ÿæ˜¯é¡¶çº§çš„å˜é‡ å®ƒä»¬å¯ä»¥åƒå…¶å®ƒå€¼ä¸€æ ·ä¼ é€’ã€‚å¯ä»¥ç”¨ä½œå‡½æ•°çš„å‚æ•°æˆ–è¿”å›å€¼ã€‚ å‡½æ•°é—­åŒ… å‡½æ•°å¤šæ€golangæ”¯æŒå®šä¹‰å¤šä¸ªå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°è¦ä¿è¯æ–¹æ³•ç­¾åä¸åŒï¼Œåç§°å¯ä»¥ç›¸åŒ æ¥å£ å…¶å® goalngçš„æ¥å£ç¼–ç¨‹æ˜¯é’ˆå¯¹ç±»å‹æ–¹æ³•æ¥è¯´çš„ï¼Œæ¯”å¦‚ä½¿ç”¨golangçš„å‰ç¼€å‡½æ•°å£°æ˜ç»‘å®šä½¿ç”¨å¯¹è±¡ golangçš„è¿™ç§è®¾è®¡å…¶å®æ›´åƒä¸€ç§å£°æ˜ï¼Œè¿™ç§å£°æ˜æ˜¯å…¨å±€é€šç”¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœç”¨æ¥å£å£°æ˜äº†ä¸€ç§ç±»å‹é‚£ä¹ˆåªè¦å®ç°äº†ç›¸åŒçš„æ–¹æ³•å°±å¯ä»¥é‡ç”¨äº†ï¼Œgolangæ”¯æŒæ–¹æ³•é‡è½½æ‰€ä»¥è¿™ç§æ–¹æ³•å…¶å®æ›´èƒ½æé«˜é€šç”¨æ€§ æ³¨æ„ï¼šgolangåœ¨è¿™é‡Œåˆé™åˆ¶äº†ä¸€ä¸ªæ¡ä»¶å°±æ˜¯ï¼Œåœ¨å…¨å±€ç¯å¢ƒä¸­åŒä¸€ä¸ªåŒ…åä¸­ä¸èƒ½æœ‰ç›¸åŒçš„æ–¹æ³•æ¥å£å£°æ˜ å¼•ç”³ ï¼š golangçš„typeå…³é”®å­—Golangè¯­è¨€ä¸­å­˜åœ¨ä¸€ä¸ªå…³é”®å­—typeï¼Œtypeåˆæœ‰ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼Œä¸€ç§æ˜¯ç±»å‹åˆ«åï¼Œä¸€ç§æ˜¯ç±»å‹å®šä¹‰ ç±»å‹å®šä¹‰ golang æ¥å£å¯ä»¥åšå˜é‡ä¼ å‚ï¼Œæ³¨æ„å¦‚æœæ¥å£æŒ‡å‘çš„ä¸€å®šæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå› ä¸ºä»–ä¸å¯èƒ½éœ€è¦å¤åˆ¶çš„ å¦‚æœæ¥å£è¢«null è°ƒç”¨äº†å¦‚æœæ¥å£è¢«null è°ƒç”¨äº†ï¼Œgolangä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯ç»§ç»­ä»¥nilä¸ºå…¥å‚è¿è¡Œï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼Œå°†ä¼šè¾“å‡º nil æ³¨æ„:å¦‚æœæ¥å£æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„å‡½æ•°ï¼Œå°†ä¼šæŠ¥é”™ ç©ºæ¥å£æŒ‡å®šäº†é›¶ä¸ªæ–¹æ³•çš„æ¥å£å€¼è¢«ç§°ä¸º ç©ºæ¥å£ï¼š interface{}ç©ºæ¥å£å¯ä¿å­˜ä»»ä½•ç±»å‹çš„å€¼ã€‚ï¼ˆå› ä¸ºæ¯ä¸ªç±»å‹éƒ½è‡³å°‘å®ç°äº†é›¶ä¸ªæ–¹æ³•ã€‚ï¼‰ ç©ºæ¥å£è¢«ç”¨æ¥å¤„ç†æœªçŸ¥ç±»å‹çš„å€¼ã€‚ä¾‹å¦‚ï¼Œfmt.Print å¯æ¥å—ç±»å‹ä¸º interface{} çš„ä»»æ„æ•°é‡çš„å‚æ•°ã€‚ ç©ºæ¥å£æ‰¿è½½æ¥å£ç±»å‹åˆ¤æ–­ç±»å‹æ–­è¨€ç±»å‹æ–­è¨€ æä¾›äº†è®¿é—®æ¥å£å€¼åº•å±‚å…·ä½“å€¼çš„æ–¹å¼ã€‚ è¯¥è¯­å¥æ–­è¨€æ¥å£å€¼ i ä¿å­˜äº†å…·ä½“ç±»å‹ Tï¼Œå¹¶å°†å…¶åº•å±‚ç±»å‹ä¸º T çš„å€¼èµ‹äºˆå˜é‡ tã€‚è‹¥ i å¹¶æœªä¿å­˜ T ç±»å‹çš„å€¼ï¼Œè¯¥è¯­å¥å°±ä¼šè§¦å‘ä¸€ä¸ªææ…Œã€‚ä¸ºäº† åˆ¤æ–­ ä¸€ä¸ªæ¥å£å€¼æ˜¯å¦ä¿å­˜äº†ä¸€ä¸ªç‰¹å®šçš„ç±»å‹ï¼Œç±»å‹æ–­è¨€å¯è¿”å›ä¸¤ä¸ªå€¼ï¼šå…¶åº•å±‚å€¼ä»¥åŠä¸€ä¸ªæŠ¥å‘Šæ–­è¨€æ˜¯å¦æˆåŠŸçš„å¸ƒå°”å€¼ã€‚ è‹¥ i ä¿å­˜äº†ä¸€ä¸ª Tï¼Œé‚£ä¹ˆ t å°†ä¼šæ˜¯å…¶åº•å±‚å€¼ï¼Œè€Œ ok ä¸º trueã€‚å¦åˆ™ï¼Œok å°†ä¸º false è€Œ t å°†ä¸º T ç±»å‹çš„é›¶å€¼ï¼Œç¨‹åºå¹¶ä¸ä¼šäº§ç”Ÿææ…Œã€‚è¯·æ³¨æ„è¿™ç§è¯­æ³•å’Œè¯»å–ä¸€ä¸ªæ˜ å°„æ—¶çš„ç›¸åŒä¹‹å¤„ã€‚ ä¸Šé¢çš„é—®é¢˜çš„ç®€åŒ–ç‰ˆç±»å‹é€‰æ‹©ç±»å‹é€‰æ‹© æ˜¯ä¸€ç§æŒ‰é¡ºåºä»å‡ ä¸ªç±»å‹æ–­è¨€ä¸­é€‰æ‹©åˆ†æ”¯çš„ç»“æ„ã€‚ ç±»å‹é€‰æ‹©ä¸ä¸€èˆ¬çš„ switch è¯­å¥ç›¸ä¼¼ï¼Œä¸è¿‡ç±»å‹é€‰æ‹©ä¸­çš„ case ä¸ºç±»å‹ï¼ˆè€Œéå€¼ï¼‰ï¼Œ å®ƒä»¬é’ˆå¯¹ç»™å®šæ¥å£å€¼æ‰€å­˜å‚¨çš„å€¼çš„ç±»å‹è¿›è¡Œæ¯”è¾ƒã€‚ ç±»å‹é€‰æ‹©ä¸­çš„å£°æ˜ä¸ç±»å‹æ–­è¨€ i.(T) çš„è¯­æ³•ç›¸åŒï¼Œåªæ˜¯å…·ä½“ç±»å‹ T è¢«æ›¿æ¢æˆäº†å…³é”®å­— typeã€‚ æ­¤é€‰æ‹©è¯­å¥åˆ¤æ–­æ¥å£å€¼ i ä¿å­˜çš„å€¼ç±»å‹æ˜¯ T è¿˜æ˜¯ Sã€‚åœ¨ T æˆ– S çš„æƒ…å†µä¸‹ï¼Œå˜é‡ v ä¼šåˆ†åˆ«æŒ‰ T æˆ– S ç±»å‹ä¿å­˜ i æ‹¥æœ‰çš„å€¼ã€‚åœ¨é»˜è®¤ï¼ˆå³æ²¡æœ‰åŒ¹é…ï¼‰çš„æƒ…å†µä¸‹ï¼Œå˜é‡ v ä¸ i çš„æ¥å£ç±»å‹å’Œå€¼ç›¸åŒã€‚ ç‰¹æ®Šæ¥å£Errorgolangæœ‰ä¸€ä¸ªç‰¹æ®Šçš„æ¥å£è¡¨ç¤ºé”™è¯¯Error ï¼Œå…¶å®æ²¡å•¥é¸Ÿç”¨ã€‚ã€‚ã€‚ã€‚","date":"2024-12-31","categories":["golang"]},{"title":"golangå­¦ä¹ ç¬”è®°(4)-readerå’Œimage","url":"/2024/12/31/golangå­¦ä¹ ç¬”è®°-4--readerå’Œimage/","content":"Readeræ–‡ä»¶æ“ä½œ","date":"2024-12-31","categories":["golang"]},{"title":"golangå­¦ä¹ ç¬”è®°(5)-golangå¹¶å‘","url":"/2024/12/31/golangå­¦ä¹ ç¬”è®°-5--golangå¹¶å‘/","content":"gorountineGo ç¨‹ï¼ˆgoroutineï¼‰æ˜¯ç”± Go è¿è¡Œæ—¶ç®¡ç†çš„è½»é‡çº§çº¿ç¨‹ã€‚ ç”¨ä¸€ä¸ªgoå…³é”®å­—å°±å¯ä»¥äº† ä¿¡é“æ˜¯å¸¦æœ‰ç±»å‹çš„ç®¡é“ï¼Œä½ å¯ä»¥é€šè¿‡å®ƒç”¨ä¿¡é“æ“ä½œç¬¦ <- æ¥å‘é€æˆ–è€…æ¥æ”¶å€¼ã€‚ ï¼ˆâ€œç®­å¤´â€å°±æ˜¯æ•°æ®æµçš„æ–¹å‘ã€‚ï¼‰ å’Œæ˜ å°„ä¸åˆ‡ç‰‡ä¸€æ ·ï¼Œä¿¡é“åœ¨ä½¿ç”¨å‰å¿…é¡»åˆ›å»ºï¼š é»˜è®¤æƒ…å†µä¸‹ï¼Œå‘é€å’Œæ¥æ”¶æ“ä½œåœ¨å¦ä¸€ç«¯å‡†å¤‡å¥½ä¹‹å‰éƒ½ä¼šé˜»å¡ã€‚è¿™ä½¿å¾— Go ç¨‹å¯ä»¥åœ¨æ²¡æœ‰æ˜¾å¼çš„é”æˆ–ç«æ€å˜é‡çš„æƒ…å†µä¸‹è¿›è¡ŒåŒæ­¥ã€‚ ä»¥ä¸‹ç¤ºä¾‹å¯¹åˆ‡ç‰‡ä¸­çš„æ•°è¿›è¡Œæ±‚å’Œï¼Œå°†ä»»åŠ¡åˆ†é…ç»™ä¸¤ä¸ª Go ç¨‹ã€‚ä¸€æ—¦ä¸¤ä¸ª Go ç¨‹å®Œæˆäº†å®ƒä»¬çš„è®¡ç®—ï¼Œå®ƒå°±èƒ½ç®—å‡ºæœ€ç»ˆçš„ç»“æœã€‚ å¸¦ç¼“å†²çš„ä¿¡é“ä¿¡é“å¯ä»¥æ˜¯ å¸¦ç¼“å†²çš„ã€‚å°†ç¼“å†²é•¿åº¦ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æä¾›ç»™ make æ¥åˆå§‹åŒ–ä¸€ä¸ªå¸¦ç¼“å†²çš„ä¿¡é“ï¼š ä»…å½“ä¿¡é“çš„ç¼“å†²åŒºå¡«æ»¡åï¼Œå‘å…¶å‘é€æ•°æ®æ—¶æ‰ä¼šé˜»å¡ã€‚å½“ç¼“å†²åŒºä¸ºç©ºæ—¶ï¼Œæ¥å—æ–¹ä¼šé˜»å¡ã€‚ range å’Œ closeå‘é€è€…å¯é€šè¿‡ close å…³é—­ä¸€ä¸ªä¿¡é“æ¥è¡¨ç¤ºæ²¡æœ‰éœ€è¦å‘é€çš„å€¼äº†ã€‚æ¥æ”¶è€…å¯ä»¥é€šè¿‡ä¸ºæ¥æ”¶è¡¨è¾¾å¼åˆ†é…ç¬¬äºŒä¸ªå‚æ•°æ¥æµ‹è¯•ä¿¡é“æ˜¯å¦è¢«å…³é—­ï¼šè‹¥æ²¡æœ‰å€¼å¯ä»¥æ¥æ”¶ä¸”ä¿¡é“å·²è¢«å…³é—­ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œå®Œ ä¹‹å ok ä¼šè¢«è®¾ç½®ä¸º falseã€‚ å¾ªç¯ for i :&#x3D; range c ä¼šä¸æ–­ä»ä¿¡é“æ¥æ”¶å€¼ï¼Œç›´åˆ°å®ƒè¢«å…³é—­ã€‚ æ³¨æ„ï¼š åªæœ‰å‘é€è€…æ‰èƒ½å…³é—­ä¿¡é“ï¼Œè€Œæ¥æ”¶è€…ä¸èƒ½ã€‚å‘ä¸€ä¸ªå·²ç»å…³é—­çš„ä¿¡é“å‘é€æ•°æ®ä¼šå¼•å‘ç¨‹åºææ…Œï¼ˆpanicï¼‰ã€‚è¿˜è¦æ³¨æ„ï¼š ä¿¡é“ä¸æ–‡ä»¶ä¸åŒï¼Œé€šå¸¸æƒ…å†µä¸‹æ— éœ€å…³é—­å®ƒä»¬ã€‚åªæœ‰åœ¨å¿…é¡»å‘Šè¯‰æ¥æ”¶è€…ä¸å†æœ‰éœ€è¦å‘é€çš„å€¼æ—¶æ‰æœ‰å¿…è¦å…³é—­ï¼Œä¾‹å¦‚ç»ˆæ­¢ä¸€ä¸ª range å¾ªç¯ã€‚ select è¯­å¥select è¯­å¥ä½¿ä¸€ä¸ª Go ç¨‹å¯ä»¥ç­‰å¾…å¤šä¸ªé€šä¿¡æ“ä½œã€‚ select ä¼šé˜»å¡åˆ°æŸä¸ªåˆ†æ”¯å¯ä»¥ç»§ç»­æ‰§è¡Œä¸ºæ­¢ï¼Œè¿™æ—¶å°±ä¼šæ‰§è¡Œè¯¥åˆ†æ”¯ã€‚å½“å¤šä¸ªåˆ†æ”¯éƒ½å‡†å¤‡å¥½æ—¶ä¼šéšæœºé€‰æ‹©ä¸€ä¸ªæ‰§è¡Œã€‚ ä¾‹å­ sync.Mutex lock unlockæˆ‘ä»¬åªæ˜¯æƒ³ä¿è¯æ¯æ¬¡åªæœ‰ä¸€ä¸ª Go ç¨‹èƒ½å¤Ÿè®¿é—®ä¸€ä¸ªå…±äº«çš„å˜é‡ï¼Œä»è€Œé¿å…å†²çªï¼Ÿ è¿™é‡Œæ¶‰åŠçš„æ¦‚å¿µå«åš äº’æ–¥ï¼ˆmutualexclusionï¼‰* ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ äº’æ–¥é”ï¼ˆMutexï¼‰ è¿™ä¸€æ•°æ®ç»“æ„æ¥æä¾›è¿™ç§æœºåˆ¶ã€‚ Go æ ‡å‡†åº“ä¸­æä¾›äº† sync.Mutex äº’æ–¥é”ç±»å‹åŠå…¶ä¸¤ä¸ªæ–¹æ³•ï¼š LockUnlockæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ä»£ç å‰è°ƒç”¨ Lock æ–¹æ³•ï¼Œåœ¨ä»£ç åè°ƒç”¨ Unlock æ–¹æ³•æ¥ä¿è¯ä¸€æ®µä»£ç çš„äº’æ–¥æ‰§è¡Œã€‚","date":"2024-12-31","categories":["golang"]},{"title":"golang-00-å¼€å‘è®¡åˆ’","url":"/2024/12/31/golang-00-å¼€å‘è®¡åˆ’/","content":"golang é…ç½®å·¥å…·åŒ… golang æ—¥å¿—å·¥å…·åŒ… golang å¼‚å¸¸å¤„ç†å·¥å…·åŒ…","date":"2024-12-31","categories":["goè¯­è¨€"]},{"title":"golang-01-golang_contextç”¨æ³•å’Œç†å¿µ","url":"/2024/12/31/golang-01-golang_contextç”¨æ³•å’Œç†å¿µ/","content":"Contextæ˜¯golangå®˜æ–¹å®šä¹‰çš„ä¸€ä¸ªpackage,å®ƒå®šä¹‰äº†Contextç±»å‹,é‡Œé¢åŒ…å«äº†Deadline&#x2F;Done&#x2F;Erræ–¹æ³•ä»¥åŠç»‘å®šåˆ°Contextä¸Šçš„æˆå‘˜å˜é‡å€¼Value,å…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š é‚£ä¹ˆåˆ°åº•ä»€ä¹ˆContextï¼Ÿå¯ä»¥å­—é¢æ„æ€å¯ä»¥ç†è§£ä¸ºä¸Šä¸‹æ–‡,æ¯”è¾ƒç†Ÿæ‚‰çš„æœ‰è¿›ç¨‹&#x2F;çº¿ç¨‹ä¸Šçº¿æ–‡,å…³äºgolangä¸­çš„ä¸Šä¸‹æ–‡,ä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯ï¼š goroutineçš„ç›¸å…³ç¯å¢ƒå¿«ç…§,å…¶ä¸­åŒ…å«å‡½æ•°è°ƒç”¨ä»¥åŠæ¶‰åŠçš„ç›¸å…³çš„å˜é‡å€¼.é€šè¿‡Contextå¯ä»¥åŒºåˆ†ä¸åŒçš„goroutineè¯·æ±‚,å› ä¸ºåœ¨golang Seversä¸­,æ¯ä¸ªè¯·æ±‚éƒ½æ˜¯åœ¨å•ä¸ªgoroutineä¸­å®Œæˆçš„. æœ€è¿‘åœ¨å…¬å¸åˆ†ægRPCæºç ,protoæ–‡ä»¶ç”Ÿæˆçš„ä»£ç ,æ¥å£å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°ç»Ÿä¸€æ˜¯ctx context.Contextæ¥å£,å…¬å¸ä¸å°‘åŒäº‹éƒ½ä¸äº†è§£è¿™æ ·è®¾è®¡çš„å‡ºå‘ç‚¹æ˜¯ä»€ä¹ˆ,å…¶å®æˆ‘ä¹Ÿä¸äº†è§£å…¶èƒŒåçš„åŸç†.ä»Šå¤©è¶ç€å¦®å¦²å°é£å¦¹å­æ­£é¢ç™»é™†æ·±åœ³,å…¨å¸‚åœå·¥,åœè¯¾,åœä¸š,åœ¨å®¶ä¼‘æ¯æ‰¾äº†ä¸€äº›èµ„æ–™ç ”ç©¶æŠŠç©ä¸€æŠŠ. Contexté€šå¸¸è¢«è¯‘ä½œä¸Šä¸‹æ–‡,å®ƒæ˜¯ä¸€ä¸ªæ¯”è¾ƒæŠ½è±¡çš„æ¦‚å¿µ.åœ¨å…¬å¸æŠ€æœ¯è®¨è®ºæ—¶ä¹Ÿç»å¸¸ä¼šæåˆ°ä¸Šä¸‹æ–‡.ä¸€èˆ¬ç†è§£ä¸ºç¨‹åºå•å…ƒçš„ä¸€ä¸ªè¿è¡ŒçŠ¶æ€,ç°åœº,å¿«ç…§,è€Œç¿»è¯‘ä¸­ä¸Šä¸‹åˆå¾ˆå¥½åœ°è¯ é‡Šäº†å…¶æœ¬è´¨,ä¸Šä¸‹ä¸Šä¸‹åˆ™æ˜¯å­˜åœ¨ä¸Šä¸‹å±‚çš„ä¼ é€’,ä¸Šä¼šæŠŠå†…å®¹ä¼ é€’ç»™ä¸‹.åœ¨Goè¯­è¨€ä¸­,ç¨‹åºå•å…ƒä¹Ÿå°±æŒ‡çš„æ˜¯Goroutine. æ¯ä¸ªGoroutineåœ¨æ‰§è¡Œä¹‹å‰,éƒ½è¦å…ˆçŸ¥é“ç¨‹åºå½“å‰çš„æ‰§è¡ŒçŠ¶æ€,é€šå¸¸å°†è¿™äº›æ‰§è¡ŒçŠ¶æ€å°è£…åœ¨ä¸€ä¸ªContextå˜é‡ä¸­,ä¼ é€’ç»™è¦æ‰§è¡Œçš„Goroutineä¸­. ä¸Šä¸‹æ–‡åˆ™å‡ ä¹å·²ç»æˆä¸ºä¼ é€’ä¸è¯·æ±‚åŒç”Ÿå­˜å‘¨æœŸå˜é‡çš„æ ‡å‡†æ–¹æ³•.åœ¨ç½‘ç»œç¼–ç¨‹ä¸‹,å½“æ¥æ”¶åˆ°ä¸€ä¸ªç½‘ç»œè¯·æ±‚Request,å¤„ç†Requestæ—¶,æˆ‘ä»¬å¯èƒ½éœ€è¦å¼€å¯ä¸åŒçš„Goroutineæ¥è·å–æ•°æ®ä¸é€»è¾‘å¤„ç†,å³ä¸€ä¸ªè¯·æ±‚Request,ä¼šåœ¨å¤šä¸ªGoroutineä¸­å¤„ç†. è€Œè¿™äº›Goroutineå¯èƒ½éœ€è¦å…±äº«Requestçš„ä¸€äº›ä¿¡æ¯;åŒæ—¶å½“Requestè¢«å–æ¶ˆæˆ–è€…è¶…æ—¶çš„æ—¶å€™,æ‰€æœ‰ä»è¿™ä¸ªRequeståˆ›å»ºçš„æ‰€æœ‰Goroutineä¹Ÿåº”è¯¥è¢«ç»“æŸ. ä¸ºä»€ä¹ˆä½¿ç”¨contextç”±äºåœ¨golang seversä¸­,æ¯ä¸ªrequestéƒ½æ˜¯åœ¨å•ä¸ªgoroutineä¸­å®Œæˆ,å¹¶ä¸”åœ¨å•ä¸ªgoroutineï¼ˆä¸å¦¨ç§°ä¹‹ä¸ºAï¼‰ä¸­ä¹Ÿä¼šæœ‰è¯·æ±‚å…¶ä»–æœåŠ¡ï¼ˆå¯åŠ¨å¦ä¸€ä¸ªgoroutineï¼ˆç§°ä¹‹ä¸ºBï¼‰å»å®Œæˆï¼‰çš„åœºæ™¯,è¿™å°±ä¼šæ¶‰åŠå¤šä¸ªGoroutineä¹‹é—´çš„è°ƒç”¨.å¦‚æœæŸä¸€æ—¶åˆ»è¯·æ±‚å…¶ä»–æœåŠ¡è¢«å–æ¶ˆæˆ–è€…è¶…æ—¶,åˆ™ä½œä¸ºæ·±é™·å…¶ä¸­çš„å½“å‰goroutine Béœ€è¦ç«‹å³é€€å‡º,ç„¶åç³»ç»Ÿæ‰å¯å›æ”¶Bæ‰€å ç”¨çš„èµ„æº.å³ä¸€ä¸ªrequestä¸­é€šå¸¸åŒ…å«å¤šä¸ªgoroutine,è¿™äº›goroutineä¹‹é—´é€šå¸¸ä¼šæœ‰äº¤äº’. é‚£ä¹ˆ,å¦‚ä½•æœ‰æ•ˆç®¡ç†è¿™äº›goroutineæˆä¸ºä¸€ä¸ªé—®é¢˜ï¼ˆä¸»è¦æ˜¯é€€å‡ºé€šçŸ¥å’Œå…ƒæ•°æ®ä¼ é€’é—®é¢˜ï¼‰,Googleçš„è§£å†³æ–¹æ³•æ˜¯Contextæœºåˆ¶,ç›¸äº’è°ƒç”¨çš„goroutineä¹‹é—´é€šè¿‡ä¼ é€’contextå˜é‡ä¿æŒå…³è”,è¿™æ ·åœ¨ä¸ç”¨æš´éœ²å„goroutineå†…éƒ¨å®ç°ç»†èŠ‚çš„å‰æä¸‹,æœ‰æ•ˆåœ°æ§åˆ¶å„goroutineçš„è¿è¡Œ. å¦‚æ­¤ä¸€æ¥,é€šè¿‡ä¼ é€’Contextå°±å¯ä»¥è¿½è¸ªgoroutineè°ƒç”¨æ ‘,å¹¶åœ¨è¿™äº›è°ƒç”¨æ ‘ä¹‹é—´ä¼ é€’é€šçŸ¥å’Œå…ƒæ•°æ®.è™½ç„¶goroutineä¹‹é—´æ˜¯å¹³è¡Œçš„,æ²¡æœ‰ç»§æ‰¿å…³ç³»,ä½†æ˜¯Contextè®¾è®¡æˆæ˜¯åŒ…å«çˆ¶å­å…³ç³»çš„,è¿™æ ·å¯ä»¥æ›´å¥½çš„æè¿°goroutineè°ƒç”¨ä¹‹é—´çš„æ ‘å‹å…³ç³». æ€ä¹ˆä½¿ç”¨contextç”Ÿæˆä¸€ä¸ªContextä¸»è¦æœ‰ä¸¤ç±»æ–¹æ³•ï¼š é¡¶å±‚Contextï¼šBackgroundè¦åˆ›å»ºContextæ ‘,é¦–å…ˆå°±æ˜¯è¦åˆ›å»ºæ ¹èŠ‚ç‚¹ è¯¥Contexté€šå¸¸ç”±æ¥æ”¶requestçš„ç¬¬ä¸€ä¸ªgoroutineåˆ›å»º,å®ƒä¸èƒ½è¢«å–æ¶ˆ,æ²¡æœ‰å€¼,ä¹Ÿæ²¡æœ‰è¿‡æœŸæ—¶é—´,å¸¸ä½œä¸ºå¤„ç†requestçš„é¡¶å±‚contextå­˜åœ¨. ä¸‹å±‚Contextï¼šWithCancel&#x2F;WithDeadline&#x2F;WithTimeoutæœ‰äº†æ ¹èŠ‚ç‚¹ä¹‹å,æ¥ä¸‹æ¥å°±æ˜¯åˆ›å»ºå­å­™èŠ‚ç‚¹.ä¸ºäº†å¯ä»¥å¾ˆå¥½çš„æ§åˆ¶å­å­™èŠ‚ç‚¹,ContextåŒ…æä¾›çš„åˆ›å»ºæ–¹æ³•å‡æ˜¯å¸¦æœ‰ç¬¬äºŒè¿”å›å€¼ï¼ˆCancelFuncç±»å‹ï¼‰,å®ƒç›¸å½“äºä¸€ä¸ªHook,åœ¨å­goroutineæ‰§è¡Œè¿‡ç¨‹ä¸­,å¯ä»¥é€šè¿‡è§¦å‘Hookæ¥è¾¾åˆ°æ§åˆ¶å­goroutineçš„ç›®çš„ï¼ˆé€šå¸¸æ˜¯å–æ¶ˆ,å³è®©å…¶åœä¸‹æ¥ï¼‰.å†é…åˆContextæä¾›çš„Doneæ–¹æ³•,å­goroutineå¯ä»¥æ£€æŸ¥è‡ªèº«æ˜¯å¦è¢«çˆ¶çº§èŠ‚ç‚¹Cancelï¼š æ³¨ï¼šçˆ¶èŠ‚ç‚¹Contextå¯ä»¥ä¸»åŠ¨é€šè¿‡è°ƒç”¨cancelæ–¹æ³•å–æ¶ˆå­èŠ‚ç‚¹Context,è€Œå­èŠ‚ç‚¹Contextåªèƒ½è¢«åŠ¨ç­‰å¾….åŒæ—¶çˆ¶èŠ‚ç‚¹Contextè‡ªèº«ä¸€æ—¦è¢«å–æ¶ˆï¼ˆå¦‚å…¶ä¸Šçº§èŠ‚ç‚¹Cancelï¼‰,å…¶ä¸‹çš„æ‰€æœ‰å­èŠ‚ç‚¹Contextå‡ä¼šè‡ªåŠ¨è¢«å–æ¶ˆ. æœ‰ä¸‰ç§åˆ›å»ºæ–¹æ³•ï¼š è¿™é‡Œå†™ä¸€ä¸ªåˆ—å­ test1 çš„è¾“å‡º ï¼š test2 çš„è¾“å‡º: æ³¨æ„ä¸€ç‚¹ ï¼š è€é—®é¢˜äº†ï¼Œ test2 æœ€åå¦‚æœä¸æ¶ä¸Š time.Sleep( time.Second) è¿™è¡Œä»£ç  ï¼Œ mainå‡½æ•°åœ¨è¿è¡Œå®Œtest2 å‡½æ•°ä¹‹åå°†ä¼šé€€å‡ºè¿›ç¨‹ï¼Œ è¿™æ ·gorouteå°†å¼ºåˆ¶é€€å‡ºäº†ï¼Œdone test2 å°†ä¸ä¼šè¾“å‡º contextæ˜¯ä¸€ä¸ªä¼˜é›…çš„è®¾è®¡å—?ç¡®å®,é€šè¿‡å¼•å…¥ContextåŒ…,ä¸€ä¸ªrequestèŒƒå›´å†…æ‰€æœ‰goroutineè¿è¡Œæ—¶çš„å–æ¶ˆå¯ä»¥å¾—åˆ°æœ‰Ræ•ˆçš„æ§åˆ¶.ä½†æ˜¯è¿™ç§è§£å†³æ–¹å¼å´ä¸å¤Ÿä¼˜é›…. context åƒç—…æ¯’ä¸€æ ·æ‰©æ•£ä¸€æ—¦ä»£ç ä¸­æŸå¤„ç”¨åˆ°äº†Context,ä¼ é€’Contextå˜é‡ï¼ˆé€šå¸¸ä½œä¸ºå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰ä¼šåƒç—…æ¯’ä¸€æ ·è”“å»¶åœ¨å„å¤„è°ƒç”¨å®ƒçš„åœ°æ–¹. æ¯”å¦‚åœ¨ä¸€ä¸ªrequestä¸­å®ç°æ•°æ®åº“äº‹åŠ¡æˆ–è€…åˆ†å¸ƒå¼æ—¥å¿—è®°å½•, åˆ›å»ºçš„context,ä¼šä½œä¸ºå‚æ•°ä¼ é€’åˆ°ä»»ä½•æœ‰æ•°æ®åº“æ“ä½œæˆ–æ—¥å¿—è®°å½•éœ€æ±‚çš„å‡½æ•°ä»£ç å¤„. å³æ¯ä¸€ä¸ªç›¸å…³å‡½æ•°éƒ½å¿…é¡»å¢åŠ ä¸€ä¸ªcontext.Contextç±»å‹çš„å‚æ•°,ä¸”ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°,è¿™å¯¹æ— å…³ä»£ç å®Œå…¨æ˜¯ä¾µå…¥å¼çš„. Context ä¸ä»…ä»…åªæ˜¯cancelä¿¡å·Contextæœºåˆ¶æœ€æ ¸å¿ƒçš„åŠŸèƒ½æ˜¯åœ¨goroutineä¹‹é—´ä¼ é€’cancelä¿¡å·,ä½†æ˜¯å®ƒçš„å®ç°æ˜¯ä¸å®Œå…¨çš„. Cancelå¯ä»¥ç»†åˆ†ä¸ºä¸»åŠ¨ä¸è¢«åŠ¨ä¸¤ç§,é€šè¿‡ä¼ é€’contextå‚æ•°,è®©è°ƒç”¨goroutineå¯ä»¥ä¸»åŠ¨cancelè¢«è°ƒç”¨goroutine.ä½†æ˜¯å¦‚ä½•å¾—çŸ¥è¢«è°ƒç”¨goroutineä»€ä¹ˆæ—¶å€™æ‰§è¡Œå®Œæ¯•,è¿™éƒ¨åˆ†Contextæœºåˆ¶æ˜¯æ²¡æœ‰å®ç°çš„.è€Œç°å®ä¸­çš„ç¡®åˆæœ‰ä¸€äº›è¿™æ ·çš„åœºæ™¯,æ¯”å¦‚ä¸€ä¸ªç»„è£…æ•°æ®çš„goroutineå¿…é¡»ç­‰å¾…å…¶ä»–goroutineå®Œæˆæ‰å¯å¼€å§‹æ‰§è¡Œ,è¿™æ˜¯contextæ˜æ˜¾ä¸å¤Ÿç”¨äº†,å¿…é¡»å€ŸåŠ©sync.WaitGroup. context.valuecontext.Valueç›¸å½“äºgoroutineçš„TLSï¼ˆThread Local Storageï¼‰,ä½†å®ƒä¸æ˜¯é™æ€ç±»å‹å®‰å…¨çš„,ä»»ä½•ç»“æ„ä½“å˜é‡éƒ½å¿…é¡»ä½œä¸ºå­—ç¬¦ä¸²å½¢å¼å­˜å‚¨.åŒæ—¶,æ‰€æœ‰contextéƒ½ä¼šåœ¨å…¶ä¸­å®šä¹‰å˜é‡,å¾ˆå®¹æ˜“é€ æˆå‘½åå†²çª. æ€»ç»“ contextåŒ…é€šè¿‡æ„å»ºæ ‘å‹å…³ç³»çš„Context,æ¥è¾¾åˆ°ä¸Šä¸€å±‚Goroutineèƒ½å¯¹ä¼ é€’ç»™ä¸‹ä¸€å±‚Goroutineçš„æ§åˆ¶.å¯¹äºå¤„ç†ä¸€ä¸ªRequestè¯·æ±‚æ“ä½œ,éœ€è¦é‡‡ç”¨contextæ¥å±‚å±‚æ§åˆ¶Goroutine,ä»¥åŠä¼ é€’ä¸€äº›å˜é‡æ¥å…±äº«. Contextå¯¹è±¡çš„ç”Ÿå­˜å‘¨æœŸä¸€èˆ¬ä»…ä¸ºä¸€ä¸ªè¯·æ±‚çš„å¤„ç†å‘¨æœŸ.å³é’ˆå¯¹ä¸€ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªContextå˜é‡ï¼ˆå®ƒä¸ºContextæ ‘ç»“æ„çš„æ ¹ï¼‰;åœ¨è¯·æ±‚å¤„ç†ç»“æŸå,æ’¤é”€æ­¤ctxå˜é‡,é‡Šæ”¾èµ„æº. æ¯æ¬¡åˆ›å»ºä¸€ä¸ªGoroutine,è¦ä¹ˆå°†åŸæœ‰çš„Contextä¼ é€’ç»™Goroutine,è¦ä¹ˆåˆ›å»ºä¸€ä¸ªå­Contextå¹¶ä¼ é€’ç»™Goroutine. Contextèƒ½çµæ´»åœ°å­˜å‚¨ä¸åŒç±»å‹,ä¸åŒæ•°ç›®çš„å€¼,å¹¶ä¸”ä½¿å¤šä¸ªGoroutineå®‰å…¨åœ°è¯»å†™å…¶ä¸­çš„å€¼. å½“é€šè¿‡çˆ¶Contextå¯¹è±¡åˆ›å»ºå­Contextå¯¹è±¡æ—¶,å¯åŒæ—¶è·å¾—å­Contextçš„ä¸€ä¸ªæ’¤é”€å‡½æ•°,è¿™æ ·çˆ¶Contextå¯¹è±¡çš„åˆ›å»ºç¯å¢ƒå°±è·å¾—äº†å¯¹å­Contextå°†è¦è¢«ä¼ é€’åˆ°çš„Goroutineçš„æ’¤é”€æƒ. åœ¨å­Contextè¢«ä¼ é€’åˆ°çš„goroutineä¸­,åº”è¯¥å¯¹è¯¥å­Contextçš„Doneä¿¡é“ï¼ˆchannelï¼‰è¿›è¡Œç›‘æ§,ä¸€æ—¦è¯¥ä¿¡é“è¢«å…³é—­ï¼ˆå³ä¸Šå±‚è¿è¡Œç¯å¢ƒæ’¤é”€äº†æœ¬goroutineçš„æ‰§è¡Œï¼‰,åº”ä¸»åŠ¨ç»ˆæ­¢å¯¹å½“å‰è¯·æ±‚ä¿¡æ¯çš„å¤„ç†,é‡Šæ”¾èµ„æºå¹¶è¿”å›.","date":"2024-12-31","categories":["goè¯­è¨€"]},{"title":"golang-02-golangæµé‡æ§åˆ¶æ–¹æ³•","url":"/2024/12/31/golang-02-golangæµé‡æ§åˆ¶æ–¹æ³•/","content":"é—®é¢˜æè¿°è§£å†³goè¯·æ±‚æµé‡æ§åˆ¶çš„é—®é¢˜ï¼Œå®ç°å¯¹äºå°†å¹¶å‘æ§åˆ¶åœ¨ä¸€å®šçš„èŒƒå›´å†…ã€‚æˆ‘ä»¬é‡åˆ°çš„åœºæ™¯ï¼šæ‹‰å–æ•°æ®æ—¶ï¼Œæ•°æ®æºå¯èƒ½ä¼šæœ‰ä¸€å®šçš„QPSé™åˆ¶ï¼Œé˜²æ­¢è®¿é—®å¤±è´¥ï¼Œåœ¨è¯·æ±‚æ—¶éœ€è¦ä¿è¯è¯·æ±‚ä¸è¶…è¿‡æ¥å£é™åˆ¶ã€‚ æ–¹æ¡ˆè°ƒç ” æ–¹æ¡ˆ ä¼˜ç¼ºç‚¹ Waiting Group + Channel æ§åˆ¶å¹¶å‘æ•°ï¼Œä½†ä¸æ§åˆ¶QPS Go Ticker ç®€å•ï¼Œä¸èƒ½æ”¯æŒä¸å‡åŒ€ Go å®˜æ–¹ RateLimiter åŠŸèƒ½å¼ºå¤§ï¼Œä½¿ç”¨è¾ƒä¸ºå¤æ‚ Uber RateLimiter ä½¿ç”¨æ–¹ä¾¿ï¼ŒåŠŸèƒ½ç›¸å¯¹å°‘ä¸€äº› 1. Waiting Group + Channel ä¿è¯ä»»æ„æ—¶åˆ»æœ€å¤§çš„å¹¶å‘æ•°ä¸ä¼šè¶…è¿‡channelçš„å®¹é‡ï¼Œä½†ä¸èƒ½ä¿è¯QPS","date":"2024-12-31","categories":["goè¯­è¨€"]},{"title":"golang-03-go_linkname-éšå¼é“¾æ¥ç¼–è¯‘","url":"/2024/12/31/golang-03-go_linkname-éšå¼é“¾æ¥ç¼–è¯‘/","content":"ä»€ä¹ˆæ˜¯go:linknameæŒ‡ä»¤çš„æ ¼å¼å¦‚ä¸‹ï¼š go:linknameå¼•å¯¼ç¼–è¯‘å™¨å°†å½“å‰(ç§æœ‰)æ–¹æ³•æˆ–è€…å˜é‡åœ¨ç¼–è¯‘æ—¶é“¾æ¥åˆ°æŒ‡å®šçš„ä½ç½®çš„æ–¹æ³•æˆ–è€…å˜é‡,ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºå½“å‰æ–¹æ³•æˆ–å˜é‡,ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºç›®æ ‡æ–¹æ³•æˆ–å˜é‡,å› ä¸ºè¿™å…³æŒ‡ä»¤ä¼šç ´åç³»ç»Ÿå’ŒåŒ…çš„æ¨¡å—åŒ–,å› æ­¤åœ¨ä½¿ç”¨æ—¶å¿…é¡»å¯¼å…¥unsafe ä¸ºä»€ä¹ˆè¦ç”¨go:linknameè¿™ä¸ªæŒ‡ä»¤ä¸ç»å¸¸ç”¨,æœ€å¥½ä¹Ÿä¸è¦ç”¨,ä½†ç†è§£è¿™ä¸ªæŒ‡ä»¤å¯ä»¥å¸®åŠ©æ‚¨ç†è§£æ ¸å¿ƒåŒ…çš„å¾ˆå¤šä»£ç .åœ¨æ ‡å‡†åº“ä¸­æ˜¯ä¸ºäº†å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªåŒ…çš„unexportedçš„æ–¹æ³•æˆ–è€…å˜é‡,åœ¨æ•²ä»£ç çš„æ—¶å€™æ˜¯ä¸å¯åŒ…å¤–è®¿é—®çš„,ä½†æ˜¯è¿è¡Œæ—¶ç”¨è¿™ä¸ªå‘½ä»¤hackäº†ä¸€ä¸‹,å°±å˜å¾—å¯ä»¥è®¿é—®. æœ€å¤§çš„ä½œç”¨å°±æ˜¯ å®šå‘å¯è®¿é—®. ç¤ºä¾‹ Greet()å»è®¿é—®ä¸€ä¸ªæ²¡æœ‰æ–¹æ³•ä½“çš„æ–¹æ³•hellofunc(),IDEä¸€èˆ¬ä¼šæç¤ºé”™è¯¯,çœ‹åˆ°è¿™ä¸ªä¹‹åæ‚¨å°±ä¼šæ˜ç™½äº†,è¿™ä¸€èˆ¬æ˜¯å¦å¤–ä¸€ä¸ªåŒ…æœ‰go:linknameçš„é“¾æ¥ æˆ‘ä»¬å†çœ‹é“¾æ¥çš„å‡½æ•°ï¼š ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºå½“å‰æ–¹æ³•æˆ–å˜é‡,ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºéœ€è¦å»ºç«‹é“¾æ¥æ–¹æ³•,å˜é‡çš„è·¯å¾„ åœ¨è¿™é‡Œä¾‹å­ä¸­hello()åªèƒ½è¢«hello.hellofuncè¿™é‡Œä½œä¸ºé“¾æ¥è°ƒç”¨,å…¶ä»–åœ°æ–¹æ˜¯æ— æ³•è®¿é—®åˆ°è¿™ä¸ªæ–¹æ³•çš„,åªèƒ½è°ƒç”¨åŒ…è£…è¿‡çš„Greetæ–¹æ³•.è¿™ä¸ªé“¾æ¥è¿‡ç¨‹æ˜¯åœ¨ç¼–è¯‘æ—¶å®Œæˆçš„. æ³¨æ„ç‚¹go:linknameå¯ä»¥è·¨åŒ…ä½¿ç”¨ è·¨åŒ…ä½¿ç”¨æ—¶,ç›®æ ‡æ–¹æ³•æˆ–è€…å˜é‡å¿…é¡»å¯¼å…¥æœ‰æ–¹æ³•ä½“çš„åŒ…,è¿™ä¸ªç¼–è¯‘å™¨æ‰å¯ä»¥è¯†åˆ«åˆ°é“¾æ¥ import _ â€œgithub.com&#x2F;lastsweetop&#x2F;testlinkname&#x2F;privateâ€ go buildæ— æ³•ç¼–è¯‘go:linkname,å¿…é¡»ç”¨å•ç‹¬çš„compileå‘½ä»¤è¿›è¡Œç¼–è¯‘,å› ä¸ºgo buildä¼šåŠ ä¸Š-completeå‚æ•°,è¿™ä¸ªå‚æ•°ä¼šæ£€æŸ¥åˆ°æ²¡æœ‰æ–¹æ³•ä½“çš„æ–¹æ³•,å¹¶ä¸”ä¸é€šè¿‡.","date":"2024-12-31","categories":["goè¯­è¨€"]},{"title":"golang-04-go_ç¼–è¯‘å™¨","url":"/2024/12/31/golang-04-go_ç¼–è¯‘å™¨/","content":"1. golang ç¼–è¯‘å™¨ç›¸å…³çš„å¤„ç†é€»è¾‘ -2. golang ç¼–è¯‘å™¨ä¼˜åŒ–1. å‡½æ•°å†…è¿golang ä¼šå¯¹ç®€å•çš„å‡½æ•°è¿›è¡Œå†…è¿ï¼ˆæ²¡æœ‰å¤æ‚è¯­å¥çš„æƒ…å†µä¸‹ ï¼Œ for range go select é€’å½’å‡½æ•°æˆ–è€…å¤æ‚å‡½æ•°ï¼‰ å¦‚æœåœ¨å‡½æ•°å‰æœ‰æ³¨é‡Š &#x2F;&#x2F; go: noinline è¡¨ç¤ºé»˜è®¤ä¸è¿›è¡Œå†…è¿ , æˆ–è€…ç¼–è¯‘çš„æ—¶å€™ä½¿ç”¨ -l å‚æ•° å¼•ç”³ ï¼š æ‰“å°å†…è¿ä¿¡æ¯çš„æ–¹æ³•å¯ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™å¢åŠ  -m &#x3D; 2 çš„æ ‡è®° 2. é€ƒé€¸åˆ†æé€ƒé€¸åˆ†ææ˜¯golang é‡è¦çš„ä¼˜åŒ–ï¼Œ ç”¨æˆ·æ ‡è¯†å˜é‡å†…å­˜è¢«åˆ†é…åœ¨æ ˆåŒºè¿˜æ˜¯å †åŒº åœ¨ä¼ ç»Ÿçš„c&#x2F;c++ ä¸­ ï¼Œ å¦‚æœè¿”å›ä¸€ä¸ªæ ˆä¸Šçš„å¯¹è±¡æŒ‡é’ˆï¼Œä¼šå¯¼è‡´å‡½æ•°æ‰§è¡Œå®Œæˆçº¿ç¨‹è¢«å›æ”¶ä¹‹åï¼Œå¯¹è±¡è¢«é‡Šæ”¾ 2.1 golang ä¸­æ ˆå †åˆ†é…åŸåˆ™a. æŒ‡å‘æ ˆä¸Šçš„å¯¹è±¡æŒ‡é’ˆä¸èƒ½è¢«å­˜å‚¨åˆ°å †ä¸­b. æŒ‡å‘æ ˆä¸Šå¯¹è±¡çš„æŒ‡é’ˆä¸èƒ½è¶…è¿‡çœŸå¯¹è±¡çš„ç¥æ˜å‘¨æœŸ å…·ä½“çš„åˆ†æç­–ç•¥å¾…è¡¥å…… 3. é—­åŒ…é‡å†™ç®€å•æ¥è¯´ï¼Œ é—­åŒ…å¦‚æœè°ƒç”¨äº†ä¸€æ¬¡ ï¼Œ å°±æ˜¯è¢«åˆå§‹åŒ–æˆä¸€ä¸ªç®€å•å‡½æ•° ï¼Œ å¦‚æœå¤šæ¬¡è°ƒç”¨æˆ–è€…åç»­è°ƒç”¨ï¼Œå°±ä¼šè¢«åˆ›å»ºé—­åŒ…å¯¹è±¡ã€‚ é—­åŒ…ä¸­çš„å€¼ï¼š å¦‚æœå˜é‡å ç”¨ç©ºé—´å°äº 2Ã—sizeof(int) -> ä¼šåœ¨å†…éƒ¨åˆ›å»ºå±€éƒ¨å˜é‡æ¥äº§ç”Ÿè¿™ä¸ªå˜é‡ã€‚ å¦‚æœæ˜¯é€šè¿‡æŒ‡é’ˆæˆ–è€…å€¼å¼•ç”¨ä½†æ˜¯å ç”¨ç©ºé—´å¤§ï¼Œé‚£ä¹ˆæ•è·çš„å˜é‡ï¼ˆvarï¼‰å°†ä¼šè½¬åŒ–æˆæŒ‡é’ˆç±»å‹ &varã€‚ 4. éå†å‡½æ•°é—­åŒ…é‡å†™ä¹‹åéœ€è¦å˜é‡å‡½æ•°ï¼Œ ä¼šå¯¹å‡½æ•°ä¸­çš„ä¸€äº›è¡¨è¾¾å¼æ“ä½œè½¬åŒ–æˆè¿è¡Œæ—¶å‡½æ•°, æ¯”å¦‚ new å’Œmap è¿™ä¸ªè¿‡ç¨‹å¯èƒ½è¿˜ä¼šè¿›è¡Œé‡æ’åºç­‰","date":"2024-12-31","categories":["goè¯­è¨€"]},{"title":"golang-04-golang_æµ®ç‚¹æ•°å’Œç±»å‹è½¬åŒ–","url":"/2024/12/31/golang-04-golang_æµ®ç‚¹æ•°å’Œç±»å‹è½¬åŒ–/","content":"1. æµ®ç‚¹æ•°é™·é˜± è¿™ç§æƒ…å†µè¾“å‡ºçš„æ˜¯0.99999 è€Œä¸æ˜¯0.9 ï¼Œ è¿™ä¸ªå…¶å®æ˜¯IEEE æ ‡å‡†çš„ç°å®çš„é™·é˜± 2. æµ®ç‚¹æ•°å’Œå®šç‚¹æ•°INF -INF åˆ†åˆ«æè¿°æœ€å¤§å€¼å’Œæœ€å°å€¼ golang ä¸­ç®€å•çš„ç²¾åº¦å¤„ç† ï¼š ä½¿ç”¨strconv å¤„ç† è¾“å‡ºç»“æœ golang å¤§æ•°math.big golang bigæ ‡å‡†åº“æä¾›äº†3ä¸­æ•°æ®ç±»å‹ ï¼š big.Int big.Float big.Rat big.Int æ ¸å¿ƒæ€æƒ³æ˜¯ä½¿ç”¨uintåˆ‡ç‰‡æ¥å­˜å‚¨å¤§æ•´æ•° , go å¤§æ•´æ•°ä¹˜æ³•ç”¨äº† karatsubaç®—æ³•ï¼ˆtodoï¼‰æ‰§è¡Œæ—¶å€™ä½¿ç”¨äº†æ±‡ç¼–ä»£ç  big.Float golang å®ç°åŸç†ç®€å•ç²—æš´ ï¼Œ å°æ•°å…ˆè½¬æˆæ•´æ•° ï¼Œ ç„¶åå¤„ç† ï¼Œ æ³¨æ„è¿™ä¹ˆåšåŒæ ·æœ‰ç²¾åº¦é—®é¢˜ ã€‚ å› ä¸ºæœ‰é™ä½æ•°æ— æ³•è¡¨è¾¾æ— é™å°æ•°ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡precå­˜å‚¨æ•°å­—çš„ä½æ•°æ¥æé«˜ç²¾åº¦ big.Rat åˆ†æ•°è¿ç®— - ä¼šè¿›è¡Œä¸€äº›ä¼˜åŒ–ï¼Œ å°½é‡é¿å…ç²¾åº¦é—®é¢˜ï¼Œ æ¯”å¦‚ 1&#x2F;2+2&#x2F;3 ä¼šå˜æˆ (1Ã—3+2Ã—3)&#x2F;2Ã—3 è¿™æ · ç±»å‹è½¬åŒ–golang å†…ç½®äº†å‡ ä¸ªç±»å‹è½¬åŒ–çš„å‡½æ•°","date":"2024-12-31","categories":["goè¯­è¨€"]},{"title":"golang-05-å­—ç¬¦ä¸²","url":"/2024/12/31/golang-05-å­—ç¬¦ä¸²/","content":"golang ä¸­å­—ç¬¦ä¸²çš„ç»“æ„ Data : æŒ‡å‘åº•å±‚çš„å­—ç¬¦æ•°ç»„ Len : åªæƒ³åº•å±‚æ•°ç»„çš„é•¿åº¦ åœ¨golangä¸­ä½¿ç”¨ rune æ¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ - print ä½¿ç”¨ %#U è¾“å‡ºçœŸå®ç¼–ç  è¾“å‡º å­—ç¬¦ä¸²è¿è¡Œæ—¶æ‹¼æ¥ åŸç† ï¼šæ‰¾åˆ°ä¸€ä¸ªæ›´å¤§çš„å†…å­˜åœ°å€ï¼Œ é€šè¿‡å†…å­˜å¤åˆ¶çš„æ–¹æ³•å°†å­—ç¬¦ä¸²å¤åˆ¶åˆ°å…¶ä¸­ æ³¨æ„ï¼š å¦‚æœæ‹¼æ¥çš„æ—¶å€™å­—ç¬¦ä¸²å°äº32å­—èŠ‚æ—¶ ï¼Œ ä¼šæœ‰ä¸€ä¸ªä¸´æ—¶çš„ç¼“å­˜æä¾›ä½¿ç”¨ ï¼Œ å¤§äº32 ä¼šåœ¨å †åŒºå¼€è¾Ÿä¸€ä¸ªè¶³å¤Ÿå¤§çš„å†…å­˜ç©ºé—´ å­—ç¬¦ä¸²å’Œå­—èŠ‚æ•°ç»„è½¬åŒ– æ³¨æ„ï¼š äºŒè€…è½¬åŒ–å¹¶ä¸æ˜¯ç®€å•çš„å¼•ç”¨äº’è½¬ï¼Œ å¦‚æœå¤§å°è¶…è¿‡32 ä½ å°±ä¼šè¿˜éœ€è¦ç”³è¯·å†…å­˜æ‰§è¡Œcopyæ‰è¡Œ å¼•ç”³ é»‘é­”æ³• 0 æˆæœ¬è½¬åŒ–","date":"2024-12-31","categories":["goè¯­è¨€"]},{"title":"golang-06-æ•°ç»„å’Œåˆ‡ç‰‡","url":"/2024/12/31/golang-06-æ•°ç»„å’Œåˆ‡ç‰‡/","content":"golang æ•°ç»„å£°æ˜çš„ä¸‰ç§æ–¹æ³• printLn ä½¿ç”¨ %T æ‰“å°æ•°ç»„ç±»å‹ è¾“å‡ºï¼š golang æ•°ç»„å¼•ç”¨ è¾“å‡º golang æ•°ç»„èµ‹å€¼å’Œå‡½æ•°å¼•ç”¨éƒ½æ˜¯ golang æ•°ç»„å†…éƒ¨æ•°æ®æ ¼å¼ golang åˆ‡ç‰‡ åˆ‡ç‰‡åˆå§‹åŒ–æ–¹æ³• golang åˆ‡ç‰‡æˆªå– golang æˆªå–è¯­æ³• ï¼Œ [1:2], ä»1 ->2 ä¸åŒ…æ‹¬2 ï¼Œ é•¿åº¦å’Œå®¹é‡éƒ½æ˜¯æŒ‰ç…§åŸæ¥çš„æ•°ç»„çš„å®¹é‡å’Œé•¿åº¦æˆªæ–­ golang åˆ‡ç‰‡ç±»å‹çš„åº•å±‚å®ç° golang make åˆå§‹åŒ–åˆ‡ç‰‡å¤§å°æ”¯æŒgolang åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¼šåŠ¨æ€æ£€æµ‹æ˜¯åˆ†é…åˆ°æ ˆåŒºä¸­è¿˜æ˜¯åˆ†é…åˆ°å †åŒºä¸­ ï¼Œ é»˜è®¤å¤§å°æ˜¯64 KB å¯ä»¥åœ¨åœ¨ç¼–è¯‘æœŸæŒ‡å®š smallframes æ ‡è¯†è¿›è¡Œæ›´æ–° so make([]int64 ,1023) å’Œ make([]int64,1024)ç»†èŠ‚ä¸Šæ˜¯æˆªç„¶ä¸åŒçš„ golang å¤åˆ¶ æ³¨æ„ï¼š å¦‚æœæ‰ç”¨äº†åç¨‹è°ƒç”¨çš„æ–¹æ³•æˆ–è€…åŠ å…¥äº† raceæ£€æµ‹ï¼Œ å°±ä¼šè¿è¡Œ slicestringcopyæˆ–è€…slicecopyå‡½æ•°è¿›è¡Œé¢å¤–çš„æ£€æŸ¥ï¼Œ é»˜è®¤ä½¿ç”¨çš„memmove å‡½æ•°å®ç°å†…å­˜å¤åˆ¶ å¼•ç”³ï¼š race æ£€æµ‹ -> go å·¥å…·é“¾é›†æˆäº† race æ£€æµ‹ ï¼Œ ç”¨äºæ£€æµ‹golangç«äº‰çš„é—®é¢˜ golang åˆ‡ç‰‡æ‰©å®¹è§„åˆ™ å¦‚æœæ–°ç”³è¯·çš„å®¹é‡å¤§äºåŸæ¥çš„ç»å®¹é‡çš„2å€ï¼Œåˆ™ä½¿ç”¨æ–°ç”³è¯·çš„å®¹é‡ å¦‚æœæ¥åˆ‡ç‰‡é•¿åº¦å°äº 1024 ï¼Œ åˆ™æœ€ç»ˆå®¹é‡æ˜¯å°±å®¹é‡çš„2å€ å¦‚æœæ¥åˆ‡ç‰‡é•¿åº¦å¤§äºæˆ–ç­‰äº1024 ï¼Œ åˆ™ä»æ—§å®¹é‡å¼€å§‹çš„1&#x2F;4 å¾ªç¯å¢åŠ ç›´åˆ°å¤§äºç­‰äºæ–°å®¹é‡ å¦‚æœæœ€ç»ˆå®¹é‡è¿‡å¤§å¯¼è‡´æº¢å‡ºï¼Œ åˆ™æœ€ç»ˆå®¹é‡å°±æ˜¯æ–°ç”³è¯·çš„å®¹é‡","date":"2024-12-31","categories":["goè¯­è¨€"]},{"title":"golang-07-hashè¡¨goè¯­è¨€å®ç°æœºåˆ¶","url":"/2024/12/31/golang-07-hashè¡¨goè¯­è¨€å®ç°æœºåˆ¶/","content":"todo åº•å±‚å®ç°åŸç† golang map ä½¿ç”¨æ³¨æ„äº‹é¡¹ golang èµ‹å€¼çš„æ—¶å€™å¿…é¡»è¦åˆå§‹åŒ– golang æ”¯æŒ nil çš„map å–å€¼ ï¼Œ è™½ç„¶ä¼šè¿”å›nil golang map å®ç°åº•å±‚åŸç†","date":"2024-12-31","categories":["goè¯­è¨€"]},{"title":"golang-08-å‡½æ•°å’Œæ ˆ","url":"/2024/12/31/golang-08-å‡½æ•°å’Œæ ˆ/","content":"å‡½æ•°æ˜¯ç¨‹åºä¸­ä¸ºäº†æ‰§è¡Œç‰¹å®šä»»åŠ¡è€Œå­˜åœ¨çš„ä¸€ç³»åˆ—æ‰§è¡Œä»£ç ã€‚å‡½æ•°æ¥å—è¾“å…¥å¹¶è¿”å›è¾“å‡ºï¼Œæ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹å¯ä»¥çœ‹ä½œä¸€ç³»åˆ—å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹ã€‚Goè¯­è¨€ä¸­æœ€é‡è¦çš„å‡½æ•°ä¸ºmainå‡½æ•°ï¼Œå…¶æ˜¯ç¨‹åºæ‰§è¡Œç”¨æˆ·ä»£ç çš„å…¥å£ï¼Œåœ¨æ¯ä¸ªç¨‹åºä¸­éƒ½éœ€è¦å­˜åœ¨ã€‚ golang ä¸­å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘ å‡½æ•°æ˜¯ç¨‹åºä¸­ä¸ºäº†æ‰§è¡Œç‰¹å®šä»»åŠ¡è€Œå­˜åœ¨çš„ä¸€ç³»åˆ—æ‰§è¡Œä»£ç ã€‚å‡½æ•°æ¥å—è¾“å…¥å¹¶è¿”å›è¾“å‡ºï¼Œæ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹å¯ä»¥çœ‹ä½œä¸€ç³»åˆ—å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹ã€‚Goè¯­è¨€ä¸­æœ€é‡è¦çš„å‡½æ•°ä¸ºmainå‡½æ•°ï¼Œå…¶æ˜¯ç¨‹åºæ‰§è¡Œç”¨æˆ·ä»£ç çš„å…¥å£ï¼Œåœ¨æ¯ä¸ªç¨‹åºä¸­éƒ½éœ€è¦å­˜åœ¨ã€‚ å‡½æ•°æ˜¯ç¨‹åºä¸­ä¸ºäº†æ‰§è¡Œç‰¹å®šä»»åŠ¡è€Œå­˜åœ¨çš„ä¸€ç³»åˆ—æ‰§è¡Œä»£ç ã€‚å‡½æ•°æ¥å—è¾“å…¥å¹¶è¿”å›è¾“å‡ºï¼Œæ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹å¯ä»¥çœ‹ä½œä¸€ç³»åˆ—å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹ã€‚Goè¯­è¨€ä¸­æœ€é‡è¦çš„å‡½æ•°ä¸ºmainå‡½æ•°ï¼Œå…¶æ˜¯ç¨‹åºæ‰§è¡Œç”¨æˆ·ä»£ç çš„å…¥å£ï¼Œåœ¨æ¯ä¸ªç¨‹åºä¸­éƒ½éœ€è¦å­˜åœ¨ã€‚ golang å‡½æ•°é—­åŒ…å’Œé™·é˜± è¿™ä¹Ÿæ˜¯Goè¯­è¨€ä¸­ä¸€ç±»éå¸¸ç»å…¸çš„é”™è¯¯ï¼Œè¢«æ”¶å½•åœ¨äº†Goè¯­è¨€â€œå…±åŒçš„é”™è¯¯â€[2]ä¸­ï¼Œæœ€ç»ˆåç¨‹ä¼šæ‰“å°å‡ºvaluesåˆ‡ç‰‡çš„æœ€åä¸€ä¸ªå€¼ã€‚å› ä¸ºå½“å‰valå€¼å¼•ç”¨çš„æ˜¯åŒä¸€ä¸ªåœ°å€çš„æ•°æ®ï¼Œæ‰€ä»¥åœ¨rangeå¾ªç¯çš„è¿‡ç¨‹ä¸­ï¼Œä¼šä¸æ–­åœ¨valåœ°å€ä¸­æ›´æ–°æ•°æ®ã€‚è€Œåœ¨é—­åŒ…ä¸­ï¼Œç”±äºå¼•ç”¨äº†å¤–éƒ¨å˜é‡valï¼Œæ‰€ä»¥åœ¨è®¿é—®æ—¶ä¼šè·å–valåœ°å€ä¸­çš„å€¼ï¼Œå¯èƒ½ä¼šè·å–æœ€åæ”¾å…¥å…¶ä¸­çš„å€¼ï¼Œè€Œä¸æ˜¯éå†æ‰€æœ‰å€¼ï¼Œä»è€Œå¯¼è‡´ä¸¥é‡çš„é”™è¯¯ã€‚ æ³¨æ„è¿™ç§æƒ…å†µï¼Œ éœ€è¦ä½¿ç”¨ä¼ å‚ æ¥è§„é¿ ï¼Œ æˆ–è€…ä½¿ç”¨trace å·¥å…·æ¥å¤„ç† golang å‡½æ•°æ ˆå°±æ˜¯ä¼ ç»Ÿè®¡ç®—æœºç†è®ºä¸­çš„å‡½æ•°æ ˆ > æ¯ä¸ªå‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­éƒ½ä½¿ç”¨ä¸€å—æ ˆå†…å­˜æ¥ä¿å­˜è¿”å›åœ°å€ã€å±€éƒ¨å˜é‡ã€å‡½æ•°å‚æ•°ç­‰ï¼Œæˆ‘ä»¬å°†è¿™ä¸€å—åŒºåŸŸç§°ä¸ºå‡½æ•°çš„æ ˆå¸§ï¼ˆstack frameï¼‰ã€‚ golang å †æ ˆä¿¡æ¯ -> todogolang å‡½æ•°æ ˆæ‰©å®¹å’Œæ ˆè½¬ç§» -> todogolang æ ˆè°ƒè¯• -> todo","date":"2024-12-31","categories":["goè¯­è¨€"]},{"title":"golang-09-deferå»¶è¿Ÿè°ƒç”¨","url":"/2024/12/31/golang-09-deferå»¶è¿Ÿè°ƒç”¨/","content":"golang ä¸­çš„defer éå¸¸çµæ´»ï¼Œ ç”¨æ¥æ›¿ä»£ç±»ä¼¼java ä¸­çš„tryâ€“catch Goè¯­è¨€ä¸­çš„deferæœ‰ä¸€äº›ä¸åŒçš„ç‰¹ç‚¹åŠçµæ´»æ€§ï¼ŒåŒ…æ‹¬ç¨‹åºä¸­å¯ä»¥æœ‰å¤šä¸ªdeferã€deferçš„è°ƒç”¨å¯ä»¥å­˜åœ¨äºå‡½æ•°çš„ä»»ä½•ä½ç½®ç­‰ã€‚deferå¯èƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼Œä¾‹å¦‚ï¼Œå¦‚æœåˆ¤æ–­æ¡ä»¶ä¸æˆç«‹åˆ™æ”¾ç½®åœ¨ifè¯­å¥ä¸­çš„deferå¯èƒ½ä¸ä¼šè¢«æ‰§è¡Œã€‚deferè¯­å¥åœ¨ä½¿ç”¨æ—¶æœ‰è®¸å¤šé™·é˜±ï¼ŒGoè¯­è¨€ä¸­deferçš„å®ç°æ–¹å¼ä¹Ÿç»å†äº†å¤šæ¬¡æ¼”è¿› golang defer ä½¿ç”¨ä¼˜åŠ¿1. ç”¨äºèµ„æºé‡Šæ”¾deferä¸€èˆ¬ç”¨äºèµ„æºçš„é‡Šæ”¾å’Œå¼‚å¸¸çš„æ•è·ï¼Œä½œä¸ºGoè¯­è¨€çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œdeferç»™Goä»£ç çš„ä¹¦å†™æ–¹å¼å¸¦æ¥äº†å¾ˆå¤§çš„å˜åŒ–ã€‚ä¸‹é¢çš„CopyFileå‡½æ•°ç”¨äºå°†æ–‡ä»¶srcNameçš„å†…å®¹å¤åˆ¶åˆ°æ–‡ä»¶dstNameä¸­ã€‚ å¦‚æœä¸ä½¿ç”¨defer åˆ™éœ€è¦åœ¨æ¯ä¸€ä¸ªéœ€è¦å…³é—­çš„åœ°æ–¹å¢åŠ é€»è¾‘ï¼Œ éå¸¸å¤æ‚ ä½¿ç”¨deferä¼˜åŒ–ï¼Œ è§„èŒƒå†™æ³• 2. panic å¼‚å¸¸æ•è·deferçš„ç‰¹æ€§æ˜¯æ— è®ºåç»­å‡½æ•°çš„æ‰§è¡Œè·¯å¾„å¦‚ä½•ä»¥åŠæ˜¯å¦å‘ç”Ÿäº†panicï¼Œåœ¨å‡½æ•°ç»“æŸåä¸€å®šä¼šå¾—åˆ°æ‰§è¡Œï¼Œè¿™ä¸ºå¼‚å¸¸æ•è·æä¾›äº†å¾ˆå¥½çš„æ—¶æœºã€‚å¼‚å¸¸æ•è·é€šå¸¸ç»“åˆrecoverå‡½æ•°ä¸€èµ·ä½¿ç”¨ 3. å»¶è¿Ÿæ‰§è¡Œæ¯”å¦‚åŠ é”å»¶è¿Ÿæ‰§è¡Œ 4. å‚æ•°é¢„æ‰§è¡Œ å¦‚ä¸Šä¾‹æ‰€ç¤ºï¼Œdeferåçš„å‡½æ•°éœ€è¦ä¼ é€’intå‚æ•°ï¼Œé¦–å…ˆå°†aèµ‹å€¼ä¸º1ï¼Œæ¥ç€deferå‡½æ•°çš„å‚æ•°ä¼ é€’ä¸ºa+1ï¼Œæœ€åï¼Œåœ¨å‡½æ•°è¿”å›å‰aè¢«èµ‹å€¼ä¸º99ã€‚é‚£ä¹ˆæœ€ådeferå‡½æ•°æ‰“å°å‡ºçš„bå€¼æ˜¯å¤šå°‘å‘¢ï¼Ÿç­”æ¡ˆæ˜¯2ã€‚åŸå› æ˜¯ä¼ é€’åˆ°deferçš„å‚æ•°æ˜¯é¢„æ‰§è¡Œçš„ï¼Œå› æ­¤åœ¨æ‰§è¡Œåˆ°deferè¯­å¥æ—¶ï¼Œæ‰§è¡Œäº†a+1å¹¶å°†å…¶ä¿ç•™äº†èµ·æ¥ï¼Œç›´åˆ°å‡½æ•°æ‰§è¡Œå®Œæˆåæ‰æ‰§è¡Œdeferå‡½æ•°ä½“å†…çš„è¯­å¥ 4. å¤šä¸ª defer åå…¥å…ˆå‡ºè¿è¡Œ 5. defer é…åˆè¿”å›å€¼ è¾“å‡º è§£é‡Šè¿™ä¸ªå…¶å®æ¶‰åŠåˆ°ä¸€ä¸ªæ ˆæ‰§è¡Œé€»è¾‘çš„é—®é¢˜ golang æ ˆçš„å˜é‡å’Œè¿”å›å€¼ä¹‹é—´çš„æ‰§è¡Œé€»è¾‘å¦‚ä¸‹ å°†è¿”å›å€¼ä¿å­˜åœ¨æ ˆä¸Šâ†’æ‰§è¡Œdeferå‡½æ•°â†’å‡½æ•°è¿”å› ä½†æ˜¯è¦æ³¨æ„golang è¿”å›ä¹‹æœ‰å˜é‡çš„è¿™ç§æƒ…å†µ , å¦‚æœè¿”å›å€¼æ²¡æœ‰å˜é‡åç§°ï¼Œ é‚£ä¹ˆgolangåœ¨è¿”å›çš„ä¼šç”Ÿæˆä¸€ä¸ªé»˜è®¤å˜é‡æ¥ä»£è¡¨è¿”å›å€¼çš„å˜é‡åç§° ï¼Œ è¿™ä¸ªç‰¹æ€§çš„å·®å¼‚å¯¼è‡´äº†case 2 å’Œcase 3 è¿”å›å€¼çš„ä¸åŒ defer åº•å±‚åŸç† todo","date":"2024-12-31","categories":["goè¯­è¨€"]},{"title":"golang-èŒƒå‹","url":"/2024/12/31/golang-èŒƒå‹/","content":"golang èŒƒå‹ç±»å‹å£°æ˜ golang å¢åŠ äº†ä¸€ä¸ª [] ç¬¦å·çš„è¯­æ³•ï¼Œ é‡Œé¢å¯ä»¥å¢åŠ æˆ‘ä»¬çš„çº¦æŸï¼Œè¿™ä¸ªçº¦æŸä¸­çš„ä¿¡æ¯æ˜¯ä½ç±»å‹ ï¼Œ å‘ä¸Šå…¼å®¹æ‰€æœ‰æ´¾ç”Ÿç±»å‹æ¯”å¦‚ golang åˆå§‹åŒ– å¤æ‚çš„åµŒå¥—ç±»å‹ golangèŒƒå‹ç±»å‹åˆå§‹åŒ–æ–¹æ³•å’Œè‡ªå®šä¹‰ç±»å‹åˆå§‹åŒ–æ–¹æ³•ä¸€æ · ï¼Œ ä½†æ˜¯æ³¨æ„èŒƒå‹ä½¿ç”¨çš„æ—¶å€™è¦å£°æ˜èŒƒå‹ç±»å‹ ï¼Œ golangæš‚æ—¶ä¸æä¾›æ¨å¯¼èƒ½åŠ› èŒƒå‹å‡½æ•° çº¦æŸç±»å‹ å…³é”®å­— any -> æŒ‡å®šä»»æ„ç±»å‹comparator -> æŒ‡å®ç°äº†æ¯”è¾ƒæ¥å£interface","date":"2024-12-31","categories":["goè¯­è¨€"]},{"title":"goè¯­è¨€çš„è®¾è®¡å’Œå‘","url":"/2024/12/31/goè¯­è¨€çš„è®¾è®¡å’Œå‘/","content":"Go è¯­è¨€çš„è®¾è®¡å’Œå‘æœ¬æ–‡ç›®çš„ï¼š ç†è§£Goä¸ºä»€ä¹ˆXï¼Œæ‘†è„±åŸè¯­è¨€çš„æ€ç»´ è§£å†³å†™ä»£ç æ—¶æ¯”è¾ƒå›°æƒ‘å’Œä¸æ»¡çš„ç‚¹ï¼Œå¯¹å®¹æ˜“å‡ºé”™çš„è¯­æ³•æœ‰ä¸ªå°è±¡ è§„èŒƒä¸€äº›ä¹ æƒ¯æ€§å†™æ³•ï¼Œä¿æŒä»£ç strength & cleanGoå­¦èµ·æ¥éå¸¸ç®€å•ï¼Œä½†æ˜¯è¿™æ˜¯è¯­è¨€è®¾è®¡è€…åˆ»æ„ä¸ºä¹‹ï¼Œå¾ˆå¤šå¤æ‚çš„ç»†èŠ‚éƒ½è—åœ¨è¯­è¨€å®ç°é‡Œï¼Œå¯¼è‡´æˆ‘ä»¬è¿…é€Ÿå­¦ä¼šGoä¹‹åä¸æ–­è¸©å‘ï¼Œå¸Œæœ›æœ¬æ–‡èƒ½è®©å¤§å®¶åœ¨å·¥ä½œä¸­å°‘è¸©å‘ï¼Œæ—©ä¸‹ç­ï¼ Why Go2007å¹´ï¼ŒGoogleè®¾è®¡Goï¼Œç›®çš„åœ¨äºæé«˜åœ¨å¹¶è¡Œç¼–ç¨‹ï¼ˆå¤šæ ¸CPUè¶Šæ¥è¶Šå¤šï¼‰ã€åˆ†å¸ƒå¼éƒ¨ç½²ã€å¤§å‹ä»£ç åº“ï¼ˆä»¥åŠç»´æŠ¤ä»–ä»¬çš„éå¸¸å¤šçš„å¼€å‘äººå‘˜ï¼‰çš„æƒ…å†µä¸‹çš„å¼€å‘æ•ˆç‡ã€‚è®¾è®¡æ—¶ï¼Œåœ¨å¸æ”¶C++ä¼˜ç‚¹çš„åŸºç¡€ä¸Šï¼Œæ”¶é›†äºå¾ˆå¤šå·¥ç¨‹å¸ˆä¹‹é—´æµä¼ çš„çš„â€œä¸è¦åƒC++â€çš„ç¼ºç‚¹ã€‚ Go like C++ï¼š å†…å­˜æ¶ˆè€—å°‘ æ‰§è¡Œé€Ÿåº¦å¿« å¯åŠ¨å¿« Go not like C++ï¼š ç¨‹åºç¼–è¯‘æ—¶é—´çŸ­ï¼ˆæŒ‰ç…§ä½œè€…è¿‡å»çš„å·¥ç¨‹ç»éªŒï¼Œä¸€ä¸ªC++å¤§å‹é¡¹ç›®å³ä½¿make -j8ä¹Ÿéœ€è¦ç¼–è¯‘ä¸€ä¸ªå°æ—¶ä»¥ä¸Šï¼‰ åƒåŠ¨æ€è¯­è¨€ä¸€æ ·çµæ´»ï¼ˆæä¾›äº†å¦‚runtimeã€interfaceã€é—­åŒ…ã€åå°„ç­‰å¾ˆå¤šå¢åŠ çµæ´»æ€§çš„ç‰¹æ€§ï¼‰ å†…ç½®å¹¶å‘æ”¯æŒï¼ˆC++çš„åç¨‹è‡³å°‘å¾—ç­‰åˆ°std23æ‰æœ‰ï¼Œéå¸¸è½åï¼‰ ä¸°å¯Œçš„åŸç”Ÿåº“ï¼ˆC++è§£æjsonï¼Œå»ºç«‹httpæœåŠ¡å™¨ï¼Œä½¿ç”¨redisè¿™ç§éƒ½å¾ˆéš¾æ‰¾åˆ°é è°±çš„åº“ï¼‰ å¤šè¯­ä¹‰ï¼ˆå–æ¶ˆäº†æŒ‡é’ˆè¿ç®—ã€å–æ¶ˆéšå¼ç±»å‹è½¬æ¢ã€å–æ¶ˆç±»å‹åˆ«åï¼Œå–æ¶ˆé‡è½½ï¼Œ++å’Œèµ‹å€¼ä½œä¸ºè¡¨è¾¾å¼â€¦ï¼‰ Goçš„ä¼˜ç‚¹ï¼š é¢å‘å·¥ç¨‹ï¼šç®€å•ã€‚åªæœ‰25ä¸ªå…³é”®å­—ï¼Œä»£ç é£æ ¼ç»Ÿä¸€ï¼Œå¯è¯»æ€§é«˜ï¼Œgo modåŒ…ä¸°å¯Œ è‡ªåŠ¨åƒåœ¾å›æ”¶ï¼šè¯­è¨€è¿è¡Œæ—¶å†…ç½®åƒåœ¾å›æ”¶ è¯­è¨€çº§å¹¶å‘ï¼šéå¸¸å¥½ç”¨çš„routineå’Œchannelï¼Œæ›´é«˜å±‚æ¬¡çš„å¹¶å‘æŠ½è±¡ é™æ€è¯­è¨€ï¼ŒåŠ¨æ€ç‰¹æ€§ Goçš„ç¼ºç‚¹ï¼š runtimeçš„æ€§èƒ½è¿˜éœ€è¦æé«˜ æ²¡æœ‰æ³›å‹ï¼ˆè¿™ä¸€é¡¹å¾ˆå¿«å°±å¯ä»¥å…‹æœäº†ï¼‰ å†—ä½™çš„é”™è¯¯å¤„ç† Go modä¸å¤Ÿå®Œå–„ï¼ˆGoè¯­â¾”å°†â¾›å‘ä½•â½…?ï¼‰https://chai2010.cn/static-public/talks/giac2018-go-talk.pdfï¼ˆæˆ‘ä¸ºä»€ä¹ˆæ”¾å¼ƒGoè¯­è¨€ï¼‰https://blog.csdn.net/liigo/article/details/23699459 Goçš„è®¾è®¡å“²å­¦ ï¼ˆåˆ›å§‹äººRob Pikeåœ¨SPLASHä¸Šçš„æ¼”è®²ï¼Œé˜è¿°äº†è®¾è®¡Goçš„åˆè¡·ï¼‰https://talks.golang.org/2012/splash.articleï¼ˆè®¸å¼ä¼Ÿï¼ŒGoå’ŒJavaåœ¨ç»§æ‰¿è§‚å¿µä¸Šçš„å¯¹æ¯”ï¼‰https://www.infoq.cn/article/go-based-on-connection-combination-language-1ï¼ˆå¯¹é¢å‘å¯¹è±¡çš„æ‰¹è¯„ï¼‰https://studygolang.com/articles/2944ï¼ˆç‹å ï¼šè§£å¯†â€œè®¾è®¡æ¨¡å¼â€ï¼Œå¯¹è®¾è®¡æ¨¡å¼çš„æ‰¹è¯„ï¼‰https://www.yinwang.org/blog-cn/2013/03/07/design-patterns å°‘å³æ˜¯å¤šï¼ˆless is moreï¼‰ï¼šå¦‚æœä¸€ä¸ªç‰¹æ€§å¹¶ä¸å¯¹è§£å†³ä»»ä½•é—®é¢˜æœ‰æ˜¾è‘—ä»·å€¼ï¼Œé‚£ä¹ˆgoå°±ä¸æä¾›å®ƒï¼›å¦‚æœéœ€è¦ä¸€ä¸ªç‰¹æ€§ï¼Œé‚£ä¹ˆåªæœ‰ä¸€ç§æ–¹æ³•å»å®ç° é¢å‘æ¥å£ç¼–ç¨‹ï¼šéä¾µå…¥å¼æ¥å£ï¼Œåå¯¹ç»§æ‰¿ã€åå¯¹è™šå‡½æ•°å’Œè™šå‡½æ•°é‡è½½ï¼ˆå¤šæ€ï¼‰ã€åˆ é™¤æ„é€ å’Œææ„å‡½æ•° æ­£äº¤+ç»„åˆçš„è¯­è¨€ç‰¹æ€§ï¼šè¯­è¨€çš„ç‰¹æ€§ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œä¸ç›¸äº’å½±å“ã€‚æ¯”å¦‚ç±»å‹å’Œæ–¹æ³•æ˜¯äº’ç›¸ç‹¬ç«‹çš„ï¼Œç±»å‹ä¹‹é—´ä¹Ÿæ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œæ²¡æœ‰å­ç±»ï¼ŒåŒ…ä¹Ÿæ²¡æœ‰å­åŒ…ã€‚ä¸åŒç‰¹æ€§ç”¨ç»„åˆçš„æ–¹å¼æ¥æ¾è€¦åˆ å¹¶å‘åœ¨è¯­è¨€å±‚é¢æ”¯æŒï¼šå¹¶å‘æ›´å¥½åˆ©ç”¨å¤šæ ¸ï¼Œæœ‰æ›´å¼ºçš„è¡¨ç°åŠ›æ¥æ¨¡æ‹ŸçœŸå®ä¸–ç•Œ åœ¨è®¾è®¡ä¸Šï¼ŒGoç§‰æ‰¿äº†Cçš„ç®€å•ç²—æš´ã€‚ ä¸ºä»€ä¹ˆæ²¡æœ‰ç»§æ‰¿ï¼ŸGoæ²¡æœ‰å­ç±»å‹çš„æ¦‚å¿µï¼Œåªèƒ½æŠŠç±»å‹åµŒå…¥åˆ°å¦ä¸€ä¸ªç±»å‹ä¸­ï¼Œæ‰€ä»¥æ²¡æœ‰ç±»å‹ç³»ç»Ÿã€‚Goçš„ä½œè€…è®¤ä¸ºç±»å‹ç³»ç»Ÿè¢«è¿‡åº¦ä½¿ç”¨äº†ï¼Œåº”è¯¥åœ¨è¿™ä¸ªæ–¹å‘ä¸Šé€€ä¸€æ­¥ã€‚ ä½¿ç”¨ä¼¸ç¼©æ€§è‰¯å¥½çš„ç»„åˆï¼Œè€Œä¸æ˜¯ç»§æ‰¿ æ•°æ®å’Œæ–¹æ³•ä¸å†ç»‘å®šåœ¨ä¸€èµ·ï¼Œæ•°æ®çš„é›†åˆç”¨structï¼Œæ–¹æ³•çš„é›†åˆç”¨interfaceï¼Œä¿æŒæ­£äº¤ ç±»ä¼¼å­ç±»çˆ¶ç±»çš„ç³»ç»Ÿé€ æˆéå¸¸è„†å¼±çš„ä»£ç ã€‚ç±»å‹çš„å±‚æ¬¡å¿…é¡»åœ¨æ—©æœŸè¿›è¡Œè®¾è®¡ï¼Œé€šå¸¸ä¼šæ˜¯ç¨‹åºè®¾è®¡çš„ç¬¬ä¸€æ­¥ï¼Œä½†æ˜¯ä¸€æ—¦å†™å‡ºç¨‹åºåï¼Œæ—©æœŸçš„å†³ç­–å°±å¾ˆéš¾è¿›è¡Œæ”¹å˜äº†ã€‚æ‰€ä»¥ï¼Œç±»å‹å±‚æ¬¡ç»“æ„ä¼šä¿ƒæˆæ—©æœŸçš„è¿‡åº¦è®¾è®¡ï¼Œå› ä¸ºç¨‹åºå‘˜è¦å°½åŠ›å¯¹è½¯ä»¶å¯èƒ½éœ€è¦çš„å„ç§å¯èƒ½çš„ç”¨æ³•è¿›è¡Œé¢„æµ‹ï¼Œä¸æ–­åœ°ä¸ºäº†é¿å…æŒ‚ä¸€æ¼ä¸‡ï¼Œä¸æ–­çš„å¢åŠ ç±»å‹å’ŒæŠ½è±¡çš„å±‚æ¬¡ã€‚è¿™ç§åšæ³•æœ‰ç‚¹é¢ å€’äº†ï¼Œç³»ç»Ÿå„ä¸ªéƒ¨åˆ†ä¹‹é—´äº¤äº’çš„æ–¹å¼æœ¬åº”è¯¥éšç€ç³»ç»Ÿçš„å‘å±•è€Œåšå‡ºç›¸åº”çš„æ”¹å˜ï¼Œè€Œä¸åº”è¯¥åœ¨ä¸€å¼€å§‹å°±å›ºå®šä¸‹æ¥ã€‚ä½œè€…é™„äº†ä¸€ä¸ªä¾‹å­ï¼Œæ˜¯ä¸€äº›ä»¥æ¥å£ä¸ºå‚æ•°å¹¶ä¸”å…¶è¿”å›ç»“æœä¹Ÿæ˜¯ä¸€ä¸ªæ¥å£çš„å‡½æ•°ï¼š è¿™ç§ç»„åˆ+å‡½æ•°çš„æ¨¡å¼æ˜¯ç›¸å½“çµæ´»çš„ã€‚å¦‚æœç”¨ç»§æ‰¿ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¤šä¸‰ä¸ªio.Readerçš„å®šä¹‰ï¼ˆæˆ–è€…è‹¥å¹²ä¸ªæˆå‘˜å‡½æ•°ï¼‰ï¼›ç„¶åç”¨å¤šæ€å»è·å¾—å¯¹åº”çš„åŠŸèƒ½ä¸ºä»€ä¹ˆæ²¡æœ‰å¼‚å¸¸ï¼Ÿ panicå’Œrecoverè¿™äº›å‡½æ•°æ˜¯æ•…æ„å¼„çš„ä¸å¥½ç”¨çš„ï¼Œå› ä¸ºæˆ‘ä»¬åº”è¯¥å‡å°‘ä½¿ç”¨ä»–ä»¬ã€‚ä¸åƒJavaåº“ä¸­ä½¿ç”¨å¼‚å¸¸é‚£æ ·ï¼Œåœ¨goçš„åº“ä¸­è¿™ä¸¤ä¸ªå…³é”®å­—å‡ ä¹æ²¡æœ‰ä½¿ç”¨ã€‚ ä¸šåŠ¡ä¸­çš„é”™è¯¯å¹¶ä¸æ˜¯çœŸæ­£çš„å¼‚å¸¸æƒ…å†µï¼Œifå’Œreturnå®Œå…¨å¯ä»¥èƒœä»»ï¼Œæ— éœ€æ§åˆ¶æµ å¦‚æœé”™è¯¯è¦ä½¿ç”¨ç‰¹æ®Šçš„æ§åˆ¶ç»“æ„ï¼Œé”™è¯¯å¤„ç†å°±ä¼šæ‰­æ›²ç¨‹åºçš„æ§åˆ¶æµï¼Œéå¸¸å¤æ‚ æ˜¾å¼çš„é”™è¯¯æ£€æŸ¥ä¼šè¿«ä½¿ç¨‹åºå‘˜åœ¨é”™è¯¯å‡ºç°çš„æ—¶å€™å¯¹é”™è¯¯è¿›è¡Œæ€è€ƒï¼Œå¹¶è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œè€Œä¸æ˜¯æ¨ç»™å‰é¢çš„è°ƒç”¨å †æ ˆ æ¯«æ— ç–‘é—®è¿™ä¼šä½¿ä»£ç æ›´é•¿ä¸€äº›ï¼Œä½†å¦‚æ­¤ç¼–ç å¸¦æ¥çš„æ¸…æ™°åº¦å’Œç®€å•æ€§å¯ä»¥å¼¥è¡¥å…¶å†—é•¿çš„ç¼ºç‚¹ ä¸ºä»€ä¹ˆæ²¡æœ‰Xï¼Ÿ æ€»ç»“ï¼šGoçš„è®¾è®¡ç€çœ¼äºç¼–ç¨‹çš„ä¾¿åˆ©æ€§ã€ç¼–è¯‘çš„é€Ÿåº¦ã€æ¦‚å¿µçš„æ­£äº¤æ€§ä»¥åŠæ”¯æŒå¹¶å‘å’Œåƒåœ¾å›æ”¶ç­‰åŠŸèƒ½ã€‚å¦‚æœä½ åœ¨Goä¸­æ‰¾ä¸åˆ°å…¶ä»–è¯­è¨€çš„Xç‰¹æ€§ï¼Œé‚£ä¹ˆåªèƒ½è¯´æ˜è¿™ä¸ªç‰¹æ€§ä¸é€‚åˆGoï¼Œæ¯”å¦‚å®ƒä¼šå½±å“ç¼–è¯‘é€Ÿåº¦æˆ–è®¾è®¡çš„æ¸…æ™°åº¦ï¼Œæˆ–è€…ä½¿å¾—åŸºç¡€ç³»ç»Ÿå˜å¾—ç‰¹åˆ«å¤æ‚ã€‚ ä¿æŒGoçš„ç‰¹æ€§å’Œé£æ ¼ ä»Goçš„è§’åº¦è€ƒè™‘é—®é¢˜ï¼Œæ›´åŠ è®©äººå®¹æ˜“ç†è§£ ç”¨Goçš„æ–¹å¼å†™ä»£ç ï¼Œmore effective å®¹æ˜“å‡ºé”™çš„ç»†èŠ‚åˆ›å»ºå¯¹è±¡æ–°å»ºä¸€ä¸ªå¯¹è±¡åœ¨goé‡Œé¢æœ‰å¥½å‡ ç§æ–¹æ³•ï¼Œè®©äººè¿·æƒ‘ï¼Œè€Œä¸”ä¼¼ä¹å’Œç®€æ´è¿™ä¸€è®¾è®¡åŸåˆ™è¿èƒŒã€‚æˆ‘ä»¬æŒ‰ç…§å¯¹è±¡ç±»å‹è®¨è®ºä¸€ä¸‹ï¼š å¯¹äºç»“æ„ä½“ï¼Œnew(T)å’Œ&T{}æ˜¯ç­‰ä»·çš„ï¼Œéƒ½ä¼šç»™å¯¹è±¡èµ‹é›¶å€¼ï¼ˆä¸€èˆ¬äººå¾ˆå°‘ç”¨newï¼‰ã€‚Noteï¼šç›´æ¥var obj T;&Tä¹Ÿæ˜¯ç­‰ä»·çš„ï¼Œåªä¸è¿‡å˜é‡æœ‰å¯èƒ½åœ¨å †ä¸Šï¼Œæœ‰å¯èƒ½åœ¨æ ˆä¸Š å¯¹äºsliceã€mapã€chanï¼Œmake(map[string]int)å’Œmap[string]int{}ç­‰ä»·ï¼Œä¼šå¯¹å¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ã€‚ çœ‹ä¸€ä¸ªä»£ç é‡Œçš„badcaseï¼š é›¶å€¼é›¶å€¼å’Œæœªåˆå§‹åŒ–çš„å€¼å¹¶ä¸ç›¸åŒã€‚ä¸åŒç±»å‹çš„é›¶å€¼æ˜¯ä»€ä¹ˆï¼Ÿ å¸ƒå°”ç±»å‹æ˜¯falseï¼Œæ•´å‹æ˜¯0ï¼Œå­—ç¬¦ä¸²æ˜¯â€â€ æŒ‡é’ˆã€å‡½æ•°ã€interfaceã€sliceã€channelå’Œmapçš„é›¶å€¼éƒ½æ˜¯nil ç»“æ„ä½“çš„é›¶å€¼æ˜¯é€’å½’ç”Ÿæˆçš„ï¼Œæ¯ä¸ªæˆå‘˜éƒ½æ˜¯å¯¹åº”çš„é›¶å€¼ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚ä¸€ä¸ªä¸ºnilçš„sliceå’Œmapèƒ½åšä»€ä¹ˆæ“ä½œï¼š å€¼ä¼ é€’Goè¯­è¨€ä¸­æ‰€æœ‰çš„ä¼ å‚éƒ½æ˜¯å€¼ä¼ é€’ï¼Œéƒ½æ˜¯åŸå€¼çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œæˆ–è€…è¯´ä¸€ä¸ªæ‹·è´ã€‚ä¼ å…¥çš„æ•°æ®èƒ½ä¸èƒ½åœ¨å‡½æ•°å†…è¢«ä¿®æ”¹ï¼Œå–å†³äºæ˜¯ä¸æ˜¯æŒ‡é’ˆæˆ–è€…å«æœ‰æŒ‡é’ˆçš„ç±»å‹ï¼ˆæŒ‡é’ˆè¢«å€¼ä¼ é€’å¤åˆ¶åä¾ç„¶æŒ‡å‘åŒä¸€å—åœ°å€ï¼‰ã€‚è¿™å°±è®©äººå¾ˆç–‘æƒ‘ï¼Œä»€ä¹ˆæ—¶å€™ä¼ å…¥çš„å‚æ•°ä¿®æ”¹ä¼šç”Ÿæ•ˆï¼Œä»€ä¹ˆæ—¶å€™ä¸ä¼šç”Ÿæ•ˆï¼Ÿsliceç±»å‹åœ¨ å€¼ä¼ é€’çš„æ—¶å€™lenå’Œcapä¸ä¼šå˜ï¼Œæ‰€ä»¥å‡½æ•°å†…appendæ²¡æœ‰ç”¨ï¼štype slice struct { array unsafe.Pointer len int cap int}&#x2F;&#x2F; badcasefunc appendMe(s []int){ s &#x3D; append(s, -1)} map å’Œ chanç±»å‹ï¼Œæœ¬æ¥å°±æ˜¯ä¸ªæŒ‡é’ˆï¼Œæ‰€ä»¥å‡½æ•°å†…ä¿®æ”¹ä¸€å®šä¼šç”Ÿæ•ˆï¼š&#x2F;&#x2F; mapå®é™…ä¸Šæ˜¯ä¸€ä¸ª *hmapfunc makemap(t *maptype, hint int64, h *hmap, bucket unsafe.Pointer) *hmap { &#x2F;&#x2F;çœç•¥æ— å…³ä»£ç } &#x2F;&#x2F; chanå®é™…ä¸Šæ˜¯ä¸ª *hchanfunc makechan(t *chantype, size int64) *hchan { &#x2F;&#x2F;çœç•¥æ— å…³ä»£ç } å†æ¯”å¦‚ä¸€ä¸ªç»“æ„ä½“ä½œä¸ºå‚æ•°ï¼š&#x2F;&#x2F; è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„æŒ‡é’ˆåŒ…è£¹ç±»å‹type Person struct { name string age *int}func modify(x Person){ x.name &#x3D; â€œmodifiedâ€ *x.age &#x3D; 66} è¿™ä¸ªç»“æ„ä½“é‡Œçš„ageæ˜¯ä¸ªæŒ‡é’ˆç±»å‹ï¼Œæ‰€ä»¥åœ¨å‡½æ•°å†…ä¼šè¢«ä¿®æ”¹ã€‚è¿™ç§å«æœ‰æŒ‡é’ˆçš„ç»“æ„ä½“ç±»å‹ï¼Œé‡Œé¢çš„æŒ‡é’ˆæŒ‡å‘äº†å…¶ä»–çš„å†…å­˜ã€‚åœ¨å‘ç”Ÿæ‹·è´çš„æ—¶å€™ï¼Œåªæœ‰ç»“æ„ä½“æœ¬èº«çš„å†…å­˜ä¼šè¢«æ‹·è´ï¼ŒæŒ‡å‘çš„å†…å­˜æ˜¯å’ŒåŸå€¼å…±äº«çš„ã€‚ï¼ˆæ›´å¤šç»†èŠ‚å‚è€ƒ å€¼éƒ¨ï¼šhttps://gfw.go101.org/article/value-part.html )ä½†æ˜¯æˆ‘ä»¬ä¸€èˆ¬å¸Œæœ›çš„æ˜¯ï¼Œè¦ä¹ˆç»“æ„ä½“çš„æˆå‘˜ä¸€èµ·æ”¹å˜ï¼ˆè¿™ä¸ªç®€å•ï¼Œå‚æ•°ä¼ personçš„æŒ‡é’ˆï¼‰ï¼Œè¦ä¹ˆä¸€èµ·ä¸æ”¹å˜ï¼ˆæ·±æ‹·è´ï¼‰ã€‚é‚£ä¹ˆå¦ä¸€ä¸ªè®©äººå¤´ç–¼çš„é—®é¢˜æ¥äº†ï¼Œé‚£æˆ‘å¦‚ä½•æ·±æ‹·è´è¿™ä¸ªå¯¹è±¡ï¼Ÿæ·±æ‹·è´å¯¹äºsliceï¼Œgoæä¾›äº†ä¼¼ä¹è¿˜ä¸é”™çš„æ–¹å¼ï¼š&#x2F;&#x2F; è‡ªå·±å¤åˆ¶s1 :&#x3D; []int{1,2,3}s2 :&#x3D; append([]int{}, s1â€¦)&#x2F;&#x2F; æ•ˆç‡æ›´é«˜çš„å¤åˆ¶s1 :&#x3D; []int{1,2,3}s2 :&#x3D; make([]int, len(s1))copy(s2, s1) å¦‚æœä½ è¦æ‹·è´ä¸€ä¸ªmapï¼Œåªèƒ½ç”¨forå¾ªç¯ä¾æ¬¡æŠŠé”®å€¼å¯¹èµ‹å€¼åˆ°æ–°mapé‡Œã€‚åˆ‡è®°ï¼šéœ€è¦æ‹·è´mapä¸€å®šè¦æ·±æ‹·è´ï¼Œä¸ç„¶å¦‚æœåç»­åœ¨ä¸åŒçš„åç¨‹é‡Œæ“ä½œmapä¼španicå¦‚æœæœ‰å…¶ä»–æ›´å¤æ‚çš„ç»“æ„ä½“éœ€è¦æ·±æ‹·è´å‘¢ï¼Ÿç›®å‰è¿˜æ²¡æœ‰å¾ˆå¥½çš„åŠæ³•ï¼š è‡ªå·±å†™ä¸€ä¸ªå¤åˆ¶å€¼çš„å‡½æ•° ç”¨åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–çš„æ–¹æ³•æ¥åšï¼Œjsonï¼Œbson ç”¨åå°„æ¥åšage :&#x3D; 22p :&#x3D; &Person{â€œBobâ€, &age} v :&#x3D; reflect.ValueOf(p).Elem()vp2 :&#x3D; reflect.New(v.Type())vp2.Elem().Set(v) å°å¿ƒinterfaceåˆ¤ç­‰goå®ç°æ¥å£çš„æ—¶å€™æœ‰ä¸¤ä¸ªå±æ€§ï¼Œtype Tå’Œvalue Vï¼Œåˆ¤ç­‰çš„æ—¶å€™ä¸¤ä¸ªå±æ€§éƒ½è¦æ¯”è¾ƒã€‚æ¯”å¦‚ä¸€ä¸ªinterfaceå­˜äº†3ï¼Œé‚£ä¹ˆT&#x3D;intï¼Œv&#x3D;3ã€‚åªæœ‰å½“ä¸¤ä¸ªå€¼éƒ½æ²¡æœ‰è®¾ç½®æ‰ç­‰äºnilã€‚var pi *int &#x3D; nilvar pb *bool &#x3D; nilvar x interface{} &#x3D; pivar y interface{} &#x3D; pbvar z interface{} &#x3D; nil fmt.Println(x &#x3D;&#x3D; y) &#x2F;&#x2F; falsefmt.Println(x &#x3D;&#x3D; nil) &#x2F;&#x2F; falsefmt.Println(x &#x3D;&#x3D; z) &#x2F;&#x2F; false &#x2F;&#x2F; badcasetype error interface { Error() string}func returnsError() error { var p *MyError &#x3D; nil if bad() { p &#x3D; ErrBad } return p &#x2F;&#x2F; Will always return a non-nil error.} è¿˜æœ‰ä¸€ç§å¸¸è§çš„åœºæ™¯æ˜¯æˆ‘ä»¬å®¹æ˜“æ¼æ‰çš„ã€‚int64å’Œintçš„interfaceä¹Ÿä¸ç›¸ç­‰ï¼švar int1,int2 interface{}int1 &#x3D; int64(0)int2 &#x3D; int(0)fmt.Printf(â€œ%v %v &#x3D; %vâ€, int1, int2, int1 &#x3D;&#x3D; int2) &#x2F;&#x2F; 0 0 false &#x2F;&#x2F; å¦‚æœå‡½æ•°å‚æ•°ç”¨äº†interfaceï¼Œå¦‚æœæˆ‘ä»¬å¾ˆå®¹æ˜“çŠ¯é”™func (m *Map) Load(key, value interface{}) { if e, ok :&#x3D; read.m[key]; ok { â€¦ }}&#x2F;&#x2F; badcase 1: keyçš„ç±»å‹ä¸ä¸€è‡´å¯¼è‡´ç¼“å­˜æ— æ³•å–å‡ºm :&#x3D; sync.Map{}m.Store(0, â€œManualCacheâ€)val, ok :&#x3D; m.Load(int64(0)) &#x2F;&#x2F; nil false&#x2F;&#x2F; badcase 2: valueçš„ç±»å‹ä¸ä¸€è‡´å¯¼è‡´æ–­è¨€å¤±è´¥m.Store(â€œkeyâ€, 0)if val, ok :&#x3D; m.Load(â€œkeyâ€); ok { _ &#x3D; val.(int64) &#x2F;&#x2F; panic} ç‚¹ç‚¹ç‚¹â€¦æ˜¯ä¸ªå¾ˆå¸¸ç”¨çš„è¯­æ³•ç³–ï¼Œèƒ½å¸®æˆ‘ä»¬èŠ‚çœå¾ˆå¤šä»£ç ã€‚ç”¨ä½œå±•å¼€ï¼šx :&#x3D; []int{1,2,3}y :&#x3D; []int{4,5,6}x &#x3D; append(x, yâ€¦) &#x2F;&#x2F;è€Œä¸æ˜¯forå¾ªç¯x &#x3D; append(x, 4, 5, 6) &#x2F;&#x2F;ç­‰ä»·äºä¸Šé¢çš„ ç”¨ä½œå¯å˜å‚æ•°åˆ—è¡¨ï¼š&#x2F;&#x2F; Println prints to the standard logger in the manner of fmt.Println.func Println(v â€¦interface{}) { std.Output(2, fmt.Sprintln(vâ€¦)) &#x2F;&#x2F; Output takes parameters (int, string)} ç”¨ä½œç®€åŒ–æ•°ç»„å£°æ˜ï¼švar _ &#x3D; [â€¦]language{ {â€œCâ€, 1972}, {â€œPythonâ€, 1991}, {â€œGoâ€, 2009},}var b &#x3D; [â€¦]string{0: â€œfooâ€, 2: â€œfooâ€} &#x2F;&#x2F; [3]string{â€œfooâ€, â€œâ€, â€œfooâ€} é—­åŒ…é‡Œçš„å±€éƒ¨å˜é‡æ˜¯å¼•ç”¨é—­åŒ…é‡Œèµ·çš„goåç¨‹é‡Œé¢å¼•ç”¨çš„æ˜¯å˜é‡içš„åœ°å€ã€‚æ‰€æœ‰çš„goåç¨‹å¯åŠ¨åç­‰å¾…è°ƒç”¨ï¼Œåœ¨ä¸‹é¢çš„åç¨‹ä¸­ï¼Œéƒ¨åˆ†åç¨‹å¾ˆå¯èƒ½åœ¨forå¾ªç¯å®Œæˆä¹‹åæ‰è¢«è°ƒç”¨ï¼Œæ‰€ä»¥è¾“å‡ºç»“æœå¾ˆå¤šéƒ½æ˜¯æœ€åä¸€ä¸ªiçš„å€¼&#x2F;&#x2F; bad casedone :&#x3D; make(chan bool)for i :&#x3D; 0; i < 5; i++ { go func() { println(i) done <- true }()}for i :&#x3D; 0; i < 5; i++{ <-done}&#x2F;&#x2F; 5 5 5 5 5 &#x2F;&#x2F; good sample 1for i :&#x3D; 0; i < 5; i++ { defer func(i int) { println(i) done <- true }(i)}&#x2F;&#x2F; good sample 2for i :&#x3D; 0; i < 5; i++ { i :&#x3D; i &#x2F;&#x2F; æ–°å»ºå˜é‡ go func() { println(i) done <- true }()}&#x2F;&#x2F;1 3 5 4 2 ä¸è¦å¼•ç”¨å¤§æ•°ç»„è¢«åˆ‡ç‰‡å¼•ç”¨çš„æ•°æ®ä¸ä¼šè¢«é‡Šæ”¾ï¼ˆå³ä½¿ä½ ä»…ä»…å¼•ç”¨äº†å¾ˆå°ä¸€éƒ¨åˆ†ï¼‰ï¼Œä¼šå¤§å¹…é™ä½ä»£ç æ€§èƒ½headerMap :&#x3D; make(map[string][]byte) for i :&#x3D; 0; i < 5; i++ { name :&#x3D; â€œ&#x2F;path&#x2F;to&#x2F;fileâ€ data, err :&#x3D; ioutil.ReadFile(name) if err !&#x3D; nil { log.Fatal(err) } headerMap[name] &#x3D; data[:1] &#x2F;&#x2F; better: headerMap[name] &#x3D; append([]byte{}, data[:1]â€¦)} èµ‹å€¼ä¸æ˜¯åŸå­æ“ä½œåœ¨64ä½çš„æœºå™¨ä¸Šï¼Œèµ‹å€¼å¾ˆå¯èƒ½è¢«æ‹†æˆmovä¸¤æ¬¡çš„æ±‡ç¼–ä»£ç ï¼Œå› æ­¤ä¸æ˜¯åŸå­çš„ã€‚æˆ‘ä»¬å¯ä»¥ç”¨atomicé‡Œçš„æ–¹æ³•å¸®åŠ©æˆ‘ä»¬åšåŸå­æ“ä½œã€‚è€ƒè™‘ä¸€ä¸ªå†…å­˜cacheå®šæ—¶åˆ·æ–°çš„åç¨‹ï¼šå› ä¸ºéšæ—¶æœ‰è¯·æ±‚åœ¨è¯»cacheï¼Œæ‰€ä»¥åˆ·æ–°cacheçš„æ—¶å€™éœ€è¦ä¿è¯cacheçš„æŒ‡é’ˆå­˜å–æ˜¯åŸå­æ“ä½œã€‚ä¸¾ä¾‹ï¼šmycache *map[string]*Cache&#x2F;&#x2F; åŠ è½½ï¼ˆè¯»å–ï¼‰var _ &#x3D; (*T)(atomic.LoadPointer((*unsafe.Pointer)(unsafe.Pointer(mycache)))) &#x2F;&#x2F; å­˜å‚¨ï¼ˆä¿®æ”¹ï¼‰atomic.StorePointer( (*unsafe.Pointer)(unsafe.Pointer(mycache)), unsafe.Pointer(&newMycache)) æ‰€æœ‰çš„æ“ä½œï¼Œåªè¦å­˜åœ¨åŒæ—¶å­˜åœ¨å¤šä¸ªgoroutineåŒæ—¶æ“ä½œä¸€ä¸ªèµ„æºï¼ˆä¸´ç•ŒåŒºï¼‰ï¼Œé™¤äº†å¸¦æœ‰syncï¼Œatomicï¼Œæˆ–è€…channelå…³é”®å­—çš„ï¼Œéƒ½ä¸å®‰å…¨ã€‚åŒ…æ‹¬ä½†ä¸é™äºï¼š å¹¶å‘è¯»å†™map å¹¶å‘appendåˆ‡ç‰‡ è‡ªå¢å˜é‡ èµ‹å€¼æ¥æ”¶å™¨ç”¨æŒ‡é’ˆè¿˜æ˜¯å€¼Goçš„æ¥æ”¶å™¨å¯ä»¥ä¼ æŒ‡é’ˆè¿›æ¥ï¼Œä¹Ÿå¯ä»¥ä¼ å€¼ã€‚æ³¨æ„ä¼ å€¼çš„æ—¶å€™æ¥æ”¶å™¨ä¸ä¼šè¢«æ”¹å˜ã€‚å®˜æ–¹æ¨èä¸‹é¢ä¸¤ç§æƒ…å†µè¯¥ç”¨æŒ‡é’ˆï¼š MyStructå¾ˆå¤§ï¼Œéœ€è¦æ‹·è´çš„æˆæœ¬å¤ªé«˜ æ–¹æ³•éœ€è¦ä¿®æ”¹MyStructå¦åˆ™Goæ¨èä½¿ç”¨å€¼æ¥æ”¶å™¨Noteï¼šå¦‚æœå¯¹è±¡æœ‰å¯èƒ½å¹¶å‘æ‰§è¡Œæ–¹æ³•ï¼ŒæŒ‡é’ˆæ¥æ”¶å™¨ä¸­å¯èƒ½äº§ç”Ÿæ•°æ®ç«äº‰ï¼Œè®°å¾—åŠ é”funcï¼ˆs * MyStructï¼‰pointerMethodï¼ˆï¼‰{ &#x2F;&#x2F; æŒ‡é’ˆæ–¹æ³• s.Age &#x3D; -1 &#x2F;&#x2F; useful}funcï¼ˆs MyStructï¼‰valueMethodï¼ˆï¼‰{ &#x2F;&#x2F; å€¼æ–¹æ³• s.Age &#x3D; -1 &#x2F;&#x2F; no use} forå¾ªç¯é‡Œçš„å˜é‡éƒ½æ˜¯å‰¯æœ¬for key, element &#x3D; range aContainer {â€¦} å…³äºä¸Šé¢forå¾ªç¯æœ‰å‡ ä¸ªç‚¹ï¼š å®é™…éå†çš„aContaineræ˜¯åŸå§‹å€¼çš„ä¸€ä¸ªå‰¯æœ¬ elementæ˜¯éå†åˆ°çš„å…ƒç´ çš„åŸå§‹å€¼çš„ä¸€ä¸ªå‰¯æœ¬ keyå’Œelementæ•´ä¸ªå¾ªç¯éƒ½æ˜¯åŒä¸€ä¸ªå˜é‡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡è¿­ä»£éƒ½ç”Ÿæˆæ–°å˜é‡è¿™é‡Œæ¶‰åŠåˆ°å‡ ä¸ªé—®é¢˜ã€‚ä¸€ä¸ªæ˜¯aContainerå’Œelementçš„æ‹·è´æˆæœ¬ã€‚aContaineræ˜¯æ•°ç»„çš„æ—¶å€™çš„æ‹·è´æˆæœ¬æ¯”è¾ƒå¤§ï¼Œè€Œåˆ‡ç‰‡å’Œmapçš„æ‹·è´æˆæœ¬æ¯”è¾ƒå°ã€‚å¦‚æœæƒ³è¦ç¼©å°æ‹·è´æˆæœ¬ï¼Œæˆ‘ä»¬æœ‰å‡ ä¸ªå»ºè®®ï¼š éå†å¤§æ•°ç»„æ—¶ï¼Œå¯ä»¥å…ˆåˆ›å»ºå¤§æ•°ç»„çš„åˆ‡ç‰‡å†æ”¾åœ¨rangeåé¢ elementç»“æ„æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œç›´æ¥ç”¨ä¸‹æ ‡keyéå†ï¼Œèˆå¼ƒelementè¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯éå†çš„æ—¶å€™ä¿®æ”¹ï¼Œèƒ½ä¸èƒ½ç”Ÿæ•ˆï¼Ÿ å½“aContaineræ˜¯æ•°ç»„æ—¶ï¼Œå› ä¸ºæ•°ç»„æ˜¯æ•´ä¸ªå¤åˆ¶ï¼Œæ‰€ä»¥ç›´æ¥ä¿®æ”¹aContainerä¸ä¼šç”Ÿæ•ˆ ç›´æ¥ä¿®æ”¹keyæˆ–è€…elementï¼Œï¼Ÿ å› ä¸ºåˆ‡ç‰‡å’Œmapæ˜¯æµ…å¤åˆ¶ï¼Œåœ¨å¾ªç¯ä¸­æ“ä½œaContaineræˆ–è€…aContainer[key]å¯ä»¥ç”Ÿæ•ˆ å› ä¸ºå¾ªç¯é‡Œçš„å‰¯æœ¬å’Œå‡½æ•°å‚æ•°çš„å‰¯æœ¬éå¸¸ç±»ä¼¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‚è€ƒä¸Šé¢çš„â€œå€¼ä¼ é€’â€ä¸­çš„å†…å®¹æ¥åˆ¤æ–­ä¿®æ”¹å‰¯æœ¬æ˜¯å¦ä¼šä½¿å¾—ä¿®æ”¹è¾¾åˆ°æƒ³è¦çš„æ•ˆæœã€‚mapçš„å€¼ä¸å¯å–å€mapæ˜¯å“ˆå¸Œè¡¨å®ç°çš„ï¼Œæ‰€ä»¥å€¼çš„åœ°å€åœ¨å“ˆå¸Œè¡¨åŠ¨æ€è°ƒæ•´çš„æ—¶å€™å¯èƒ½ä¼šäº§ç”Ÿå˜åŒ–ã€‚å› æ­¤ã€‚å­˜ç€mapå€¼çš„åœ°å€æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œgoä¸­ç›´æ¥ç¦æ­¢äº†mapçš„å€¼çš„å–åœ°å€ã€‚è¿™äº›ç±»å‹éƒ½ä¸èƒ½å–å€ï¼š mapå…ƒç´  stringçš„å­—èŠ‚å…ƒç´  å¸¸é‡ï¼ˆæœ‰åå¸¸é‡å’Œå­—é¢é‡éƒ½ä¸å¯ä»¥ï¼‰ ä¸­é—´ç»“æœå€¼ï¼ˆå‡½æ•°è°ƒç”¨ã€æ˜¾å¼å€¼è½¬æ¢ã€å„ç§æ“ä½œï¼‰&#x2F;&#x2F; ä¸‹é¢è¿™å‡ è¡Œç¼–è¯‘ä¸é€šè¿‡ã€‚_ &#x3D; &[3]int{2, 3, 5}[0] &#x2F;&#x2F;å­—é¢é‡_ &#x3D; &map[int]bool{1: true}[1] &#x2F;&#x2F;å­—é¢é‡const pi &#x3D; 3.14_ &#x3D; &pi &#x2F;&#x2F;æœ‰åå¸¸é‡m :&#x3D; map[int]bool{1: true}_ &#x3D; &m[1] &#x2F;&#x2F;mapçš„valuelt :&#x3D; [3]int{2, 3, 5}_ &#x3D; &lt[1:1] &#x2F;&#x2F;åˆ‡ç‰‡æ“ä½œ ä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªä¸å¯å¯»å€çš„å€¼çš„ç›´æ¥éƒ¨åˆ†æ˜¯ä¸å¯ä¿®æ”¹çš„ã€‚ä½†æ˜¯mapçš„å…ƒç´ æ˜¯ä¸ªä¾‹å¤–ã€‚ mapçš„å…ƒç´ è™½ç„¶ä¸å¯å¯»å€ï¼Œä½†æ˜¯æ¯ä¸ªæ˜ å°„å…ƒç´ å¯ä»¥è¢«æ•´ä¸ªä¿®æ”¹ï¼ˆä½†ä¸å¯ä»¥è¢«éƒ¨åˆ†ä¿®æ”¹ï¼‰ï¼štype T struct{age int}mt :&#x3D; map[string]T{}mt[â€œJohnâ€] &#x3D; T{age: 29} &#x2F;&#x2F; æ•´ä½“ä¿®æ”¹æ˜¯å…è®¸çš„ma :&#x3D; map[int][5]int{}ma[1] &#x3D; [5]int{1: 789} &#x2F;&#x2F; æ•´ä½“ä¿®æ”¹æ˜¯å…è®¸çš„ &#x2F;&#x2F; è¿™ä¸¤ä¸ªèµ‹å€¼ç¼–è¯‘ä¸é€šè¿‡ï¼Œå› ä¸ºéƒ¨åˆ†ä¿®æ”¹ä¸€ä¸ªæ˜ å°„å…ƒç´ æ˜¯éæ³•çš„ã€‚è¿™çœ‹ä¸Šå»ç¡®å®æœ‰äº›åç›´è§‰ã€‚ma[1][1] &#x3D; 123 &#x2F;&#x2F; errormt[â€œJohnâ€].age &#x3D; 30 &#x2F;&#x2F; error &#x2F;&#x2F; è¯»å–æ˜ å°„å…ƒç´ çš„å…ƒç´ æˆ–è€…å­—æ®µæ˜¯æ²¡é—®é¢˜çš„ã€‚fmt.Println(ma[1][1]) &#x2F;&#x2F; 789fmt.Println(mt[â€œJohnâ€].age) &#x2F;&#x2F; 29 é€ƒé€¸åˆ†æå…³å¿ƒå˜é‡åœ¨æ ˆæˆ–è€…å †ä¸Šæœ‰åŠ©äºæˆ‘ä»¬å¯¹å˜é‡çš„ç”Ÿå‘½å‘¨æœŸæœ‰æ‰€äº†è§£ï¼Œå†™å‡ºæ›´å¥½æ€§èƒ½çš„ä»£ç ã€‚æ¯”å¦‚ä¸€äº›çŸ­å‘¨æœŸçš„å˜é‡çš„æŒ‡é’ˆå¦‚æœå’Œé•¿ç”Ÿå‘½å‘¨æœŸçš„å˜é‡ç»‘å®šï¼Œå°±ä¼šä½¿å¾—è¿™ä¸ªå˜é‡è¿Ÿè¿Ÿä¸èƒ½å›æ”¶ï¼Œå½±å“æ€§èƒ½ã€‚Goåœ¨æ ˆä¸Šçš„å˜é‡ä¸ä¼šäº§ç”ŸGCæˆæœ¬ï¼Œå› ä¸ºå˜é‡ä¼šéšç€å‡½æ•°çš„é€€å‡ºä¸€èµ·é”€æ¯ï¼ˆå½“ç„¶è¿™æ ·æ€§èƒ½ä¹Ÿæ˜¯æœ€é«˜çš„ï¼‰ã€‚ä½†æ˜¯ï¼Œå˜é‡æ˜¯å¦åœ¨æ ˆä¸Šï¼Œä¸èƒ½ç®€å•çš„é€šè¿‡æ˜¯å¦å±€éƒ¨å˜é‡æˆ–è€…æ˜¯å¦ä½¿ç”¨newæ„å»ºçš„å¼•ç”¨ç±»å‹æ¥åˆ¤æ–­ã€‚æœ‰ä¸€ä¸ªåŸºæœ¬çš„åˆ¤æ–­åŸåˆ™ï¼šæƒ…å†µ1ï¼šå¦‚æœå˜é‡çš„å¼•ç”¨è¢«å£°æ˜å®ƒçš„å‡½æ•°è¿”å›äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡å°±ä¼šé€ƒé€¸åˆ°å †ä¸Šfunc ref(z S) *S { return &z}&#x2F;&#x2F; go run -gcflags â€˜-m -lâ€™ main.go.&#x2F;escape.go:10: moved to heap: z.&#x2F;escape.go:11: &z escapes to heap æƒ…å†µ2ï¼šè¿”å›çš„ç»“æ„ä½“å¼•ç”¨çš„å¯¹è±¡ä¼šé€ƒé€¸func refStruct(y int) (z S) { z.M &#x3D; &y return z}&#x2F;&#x2F; go run -gcflags â€˜-m -lâ€™ main.go.&#x2F;escape.go:12: moved to heap: y.&#x2F;escape.go:13: &y escapes to heap æƒ…å†µ3ï¼šmapã€sliceã€chanå¼•ç”¨çš„å¯¹è±¡ä¼šé€ƒé€¸func main() { a :&#x3D; make([]*int,1) b :&#x3D; 12 a[0] &#x3D; &b}&#x2F;&#x2F; go run -gcflags â€˜-m -lâ€™ maint.go.&#x2F;maint.go:5:2: moved to heap: b.&#x2F;maint.go:4:11: make([]*int, 1) does not escape æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼Œé€ƒé€¸ä½¿å¾—æ€§èƒ½ä¸‹é™äº†ä¸å°‘ï¼šfunc BenchmarkHeap(b *testing.B) { b.ResetTimer() c :&#x3D; make(chan *T, b.N) &#x2F;&#x2F; c :&#x3D; make(chan T, b.N) for i :&#x3D; 0; i < b.N; i++ { b :&#x3D; T{a: 3, b: 5} c <- &b &#x2F;&#x2F; c <- b }}&#x2F;&#x2F; go test -bench&#x3D;. -run&#x3D;noneBenchmarkStack-12 32297865 32.1 ns&#x2F;opBenchmarkHeap-12 28062832 40.2 ns&#x2F;op routineGolangå¹¶å‘æ³¨æ„ç‚¹goroutineæ€§èƒ½æ¢ç©¶å’Œç¼–ç¨‹è§„èŒƒ æœ€å¥½ç¡®è®¤routineä»»åŠ¡çš„å¼€é”€å¤§äºä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€æ—¶ï¼Œæ‰ä½¿ç”¨routineã€‚ è¦å°½é‡æ§åˆ¶routineçš„æ•°é‡ï¼Œä¸ç„¶ä¼šèµ·åˆ°åæ•ˆæœ channelè¦æ³¨æ„ç¼“å†²åŒºçš„å¤§å°å’Œæ¯æ¬¡å†™å…¥çš„æ•°é‡ï¼Œå°½é‡æ‰“åŒ…å†™å…¥é˜²æ­¢æ³„æ¼å¦‚æœroutineåœ¨è¿è¡Œä¸­è¢«é˜»å¡ï¼Œæˆ–è€…é€Ÿåº¦å¾ˆæ…¢ï¼Œå°±ä¼šå‘ç”Ÿæ³„æ¼ï¼ˆroutineçš„æ•°é‡ä¼šè¿…é€Ÿçº¿æ€§å¢é•¿ï¼‰ routinueå¡æ­»åœ¨è¯»å–chanå´æ²¡æ•°æ®ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è®¾è®¡çš„è¯»å–chançš„routineä¼šæŠŠæ‰€æœ‰çš„å†…å®¹è¯»å–å®Œæ¯•åæ‰ä¼šå…³é—­ã€‚ä½†æ˜¯ï¼Œä¸€æ—¦è¯»å–è€…åœ¨è¯»å–å®Œæˆä¹‹å‰é€€å‡ºï¼Œå†™å…¥æ–¹å†™æ»¡chanä¹‹åå°±ä¼šå¡æ­»ã€‚ routinueå¤„ç†çš„é€Ÿåº¦è¿‡æ…¢è¿™ä¸ªæƒ…å†µæœ‰ç‚¹ç±»ä¼¼æ¶ˆæ¯é˜Ÿåˆ—æ¶ˆè´¹è€…çš„å †ç§¯ï¼Œå¦‚æœæ–°èµ·çš„routineå¤„ç†é€Ÿåº¦æ¯”ä¸»åç¨‹è¿˜æ…¢çš„è¯ï¼Œå †ç§¯èµ·æ¥çš„routineä¼šè¶Šæ¥è¶Šå¤šï¼Œæœ€ç»ˆæ‰“çˆ†å†…å­˜å¤ç”¨timeræ¥æ›¿ä»£timer.Aftertimer.Afterä¼šåˆ›å»ºå¾ˆå¤šçš„timerï¼Œå¼•å‘å¾ˆå¤§çš„GCæ¶ˆè€—ã€‚&#x2F;&#x2F; å¦‚æœæœ‰100wä¸ªmsgæ¨è¿›æ¥ï¼Œå°±ä¼šæœ‰100wä¸ªtimerè¢«é”€æ¯func longRunning(messages <-chan string) { for { select { &#x2F;&#x2F; æ¶ˆæ¯é—´éš”è¶…è¿‡1minä¼šreturn case <-time.After(time.Minute): return case msg :&#x3D; <-messages: fmt.Println(msg) } } }func longRunning(messages <-chan string) { timer :&#x3D; time.NewTimer(time.Minute) defer timer.Stop() for { select { case <-timer.C: &#x2F;&#x2F; è¿‡æœŸäº† return case msg :&#x3D; <-messages: fmt.Println(msg) &#x2F;&#x2F; æ­¤ifä»£ç å—å¾ˆé‡è¦ã€‚ if !timer.Stop() { <-timer.C } } &#x2F;&#x2F; å¿…é¡»é‡ç½®ä»¥å¤ç”¨ã€‚ timer.Reset(time.Minute) }} æˆ‘ä»¬åœ¨æ¯æ¬¡å¤„ç†å®Œæ¶ˆæ¯åè°ƒç”¨timer.Stop()ä»¥ä¾¿äºå¤ç”¨ã€‚å¦‚æœtimerå·²ç»è¿‡æœŸï¼Œstopä¼šè¿”å›falseï¼ŒCé‡Œé¢è¿˜æœ‰ä¸€æ¡è¿‡æœŸæ¶ˆæ¯ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒå–å‡ºæ¥ï¼›å¦‚æœtimeræ²¡æœ‰è¿‡æœŸï¼Œstopä¼šè¿”å›trueï¼Œç»§ç»­æ‰§è¡Œå¾ªç¯ åœ¨ä¸€ä¸ªTimerç»ˆæ­¢ï¼ˆstoppedï¼‰ä¹‹åå¹¶ä¸”åœ¨é‡ç½®å’Œé‡ç”¨æ­¤Timerå€¼ä¹‹å‰ï¼Œæˆ‘ä»¬åº”è¯¥ç¡®ä¿æ­¤Timerçš„é€šé“Cä¸­è‚¯å®šä¸å­˜åœ¨è¿‡æœŸçš„é€šçŸ¥å¸¸ç”¨çš„ä»“åº“syncå’ŒatomicstringsStringsåº“æ˜¯é‡å¤é€ è½®å­çš„é‡ç¾åŒºï¼Œå¾ˆå¤šäººè¯•å›¾è‡ªå·±å†å†™ä¸€éå‰åå¤„ç†var s &#x3D; â€œabaayæ£®zä¼—xbbabâ€o :&#x3D; fmt.Printlno(strings.TrimPrefix(s, â€œabâ€)) &#x2F;&#x2F; aayæ£®zä¼—xbbabo(strings.TrimSuffix(s, â€œabâ€)) &#x2F;&#x2F; abaayæ£®zä¼—xbbo(strings.TrimLeft(s, â€œabâ€)) &#x2F;&#x2F; yæ£®zä¼—xbbabo(strings.TrimRight(s, â€œabâ€)) &#x2F;&#x2F; abaayæ£®zä¼—xo(strings.Trim(s, â€œabâ€)) &#x2F;&#x2F; yæ£®zä¼—xo(strings.TrimFunc(s, func(r rune) bool { return r < 128 &#x2F;&#x2F; trim all ascii chars })) &#x2F;&#x2F; æ£®zä¼— åˆ†å‰²ä¸åˆå¹¶&#x2F;&#x2F; â€œ1 2 3â€ -> [â€œ1â€,â€2â€,â€3â€]func Fields(s string) []string &#x2F;&#x2F; ç”¨ç©ºç™½å­—ç¬¦åˆ†å‰²å­—ç¬¦ä¸²&#x2F;&#x2F; â€œ1|2|3â€ -> [â€œ1â€,â€2â€,â€3â€]func Split(s, sep string) []string &#x2F;&#x2F; ç”¨sepåˆ†å‰²å­—ç¬¦ä¸²ï¼Œsepä¼šè¢«å»æ‰&#x2F;&#x2F; [â€œ1â€,â€2â€,â€3â€] -> â€œ1,2,3â€func Join(a []string, sep string) string &#x2F;&#x2F; å°†ä¸€ç³»åˆ—å­—ç¬¦ä¸²è¿æ¥ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹‹é—´ç”¨sepæ¥åˆ†éš” &#x2F;&#x2F; Note:&#x2F;&#x2F; â€œ1||3â€ -> [â€œ1â€,â€â€,â€3â€] æ¼”åŒ–ä¸­çš„é”™è¯¯å¤„ç†æ»¡è¶³ä¸‹é¢çš„è¯‰æ±‚ï¼š å¯ä»¥æŠŠå¼‚å¸¸ä¼ é€’ä¸‹å»ï¼Œå¹¶ä¸ä¸¢å¤±è‡ªå·±çš„ç±»å‹ å¯ä»¥ä¿å­˜å †æ ˆä¿¡æ¯Goçš„é”™è¯¯å¤„ç†ä¸€ç›´åœ¨è®¨è®ºå’Œæ¼”è¿›ï¼Œç›®å‰å®˜æ–¹å·²ç»æœ‰å‡ ç§ä¸åŒçš„æ–¹æ¡ˆã€‚å¯¹äºåå¤å†™é”™è¯¯å¤„ç†ä»£ç çš„é—®é¢˜ï¼Œæœ‰å‡ ç§è§£å†³çš„è®¾æƒ³ï¼Œå¯ä»¥çœ‹çœ‹ä¸Šé¢çš„ï¼ˆGoè¯­â¾”å°†â¾›å‘ä½•â½…?ï¼‰import (â€œgolang.org&#x2F;x&#x2F;xerrorsâ€) func bar() error { if err :&#x3D; foo(); err !&#x3D; nil { return xerrors.Errorf(â€œbar failed: %wâ€, foo()) } return nil}func foo() error { return xerrors.Errorf(â€œfoo failed: %wâ€, sql.ErrNoRows)} func main() { err :&#x3D; bar() if xerrors.Is(err, sql.ErrNoRows) { fmt.Printf(â€œdata not found, %v\\nâ€, err) fmt.Printf(â€œ%+v\\nâ€, err) return }}&#x2F;* Outputs:data not found, bar failed: foo failed: sql: no rows in result setbar failed: main.bar &#x2F;usr&#x2F;four&#x2F;main.go:12 foo failed:main.foo&#x2F;usr&#x2F;four&#x2F;main.go:18 sql: no rows in result set*&#x2F; å‚è€ƒèµ„æ–™ã€ŠGo Tourã€‹ï¼ˆä¸€ä¸ªå°æ—¶å­¦ä¼šGoï¼‰https://tour.go-zh.org/welcome/1ã€ŠThe Go Programming Language Specificationã€‹ï¼ˆè¯­æ³•ç»†èŠ‚ï¼‰https://golang.org/ref/spec#Introductionï¼ˆä¸­æ–‡ç‰ˆã€ŠGoè¯­è¨€ç¼–ç è§„èŒƒã€‹ï¼‰ã€ŠGoè¯­è¨€åœ£ç»ã€‹ï¼ˆè¯­æ³•ç»†èŠ‚ï¼‰https://docs.hacknode.org/gopl-zh/ã€ŠEffective Goã€‹ï¼ˆé€‚åˆåˆšå­¦å®ŒGoçš„åŸºç¡€è¯­æ³•æ—¶å€™è¯»ï¼‰https://www.kancloud.cn/kancloud/effective/72199ã€ŠGoè¯­è¨€è®¾è®¡å’Œå®ç°ã€‹ï¼ˆé€‚åˆæƒ³äº†è§£GoæŸä¸ªç‰¹æ€§å®ç°åŸç†çš„æ—¶å€™å‚è€ƒï¼‰https://draveness.me/golang/docs/part1-prerequisite/ch02-compile/golang-compile-intro/ã€ŠGo Q&A 101ã€‹ï¼ˆå¯ä»¥å’Œå®˜æ–¹QAç»“åˆçœ‹ï¼‰https://gfw.go101.org/article/unofficial-faq.html#time-sleep-afterã€ŠGo è¯­è¨€é«˜çº§ç¼–ç¨‹ã€‹https://chai2010.cn/advanced-go-programming-book/ã€ŠGoè¯­è¨€åŸæœ¬ã€‹https://golang.design/under-the-hood/ã€ŠGoogle Goä»£ç è§„èŒƒã€‹https://github.com/golang/go/wiki/CodeReviewCommentsã€ŠUber Goè§„èŒƒã€‹https://github.com/xxjwxc/uber_go_guide_cn","date":"2024-12-31","categories":["goè¯­è¨€"]},{"title":"dubbo-å­¦ä¹ å’Œä½¿ç”¨(1)-dubboæ¶æ„è®¾è®¡å’Œæ€æƒ³","url":"/2024/12/31/dubbo-å­¦ä¹ å’Œä½¿ç”¨-1--dubboæ¶æ„è®¾è®¡å’Œæ€æƒ³/","content":"å†³å®šä½¿ç”¨dubbo æ¡†æ¶çš„åŸå› è€ƒè™‘äº†å¾ˆä¹…ï¼ŒæŸ¥äº†å¾ˆå¯¹æœ‰å…³spring cloud å’Œ dubbo çš„å¯¹æ¯”ï¼Œæœ€ç»ˆå†³å®šå¥½å¥½ç ”ç©¶ä¸€ä¸‹dubboæ¡†æ¶ï¼ŒåŸå› ä¸»è¦æœ‰ä¸€ä¸‹çš„ä¸¤ä¸ªæ–¹é¢ï¼š dubbo ç›¸æ¯”å«spring cloud æ„Ÿè§‰rpcè°ƒç”¨æ‰æ˜¯æœªæ¥å‘å±•çš„æ¡†æ¶å’ŒåŸºç¡€ã€‚ dubbo ç›¸æ¯”è¾ƒspring cloud æ¥è¯´ä»£ç è´¨é‡å’ŒæŠ½è±¡ç¨‹åº¦æ›´é«˜ï¼Œç ”ç©¶å’Œå­¦ä¹ çš„ç‚¹æ›´å¤š ç›®å‰dubboå­˜åœ¨çš„é—®é¢˜æœ€å¤§çš„é—®é¢˜ï¼Œæ•´åˆspring boot å…¶ä½™çš„ä»¥åè¡¥å…… dubbo é¡¹ç›®è§„èŒƒå…¶å®è€ƒå¯Ÿå…¶ä»–çš„ä¸€äº›rpc è°ƒç”¨æ¡†æ¶ï¼Œæ— ä¸€ä¾‹å¤–ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªæ¨¡æ¿ï¼Œåœ¨dubbo ä¸­è¿™ç§ç»Ÿä¸€çš„æ¨¡æ¿è¢«å®šä¹‰æˆä¸€ä¸ªç»Ÿä¸€çš„åŒ…ï¼Œå„ä¸ªéœ€è¦è°ƒç”¨çš„æ¥å£éƒ½ç»§æ‰¿è¿™ä¸ªåŒ…æ¥è¿›è¡Œå¼€å‘å’Œéƒ¨ç½² ä¸€ä¸ªåŸºç¡€çš„dubboé¡¹ç›®ç»“æ„ dubbo_information: è¡¨ç¤ºå…¬å…±çš„æ¥å£ç±»ï¼ˆrpcè°ƒç”¨è¿‡ç¨‹ä¸­çš„æ¨¡æ¿ï¼‰ dubbo_client : è¡¨ç¤ºå…¬å…±æ¥å£çš„å®¢æˆ·ç«¯ dubbo_service : è¡¨ç¤ºå…¬å…±æ¥å£çš„æœåŠ¡ç«¯ dubboçš„ä½œç”¨ ä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ŒåŠ¨æ€çš„æ³¨å†Œå’Œå‘ç°æœåŠ¡ï¼Œä½¿æœåŠ¡çš„ä½ç½®é€æ˜å¹¶é€šè¿‡åœ¨æ¶ˆè´¹æ–¹è·å–æœåŠ¡æä¾›æ–¹åœ°å€åˆ—è¡¨ï¼Œå®ç°è½¯è´Ÿè½½å‡è¡¡å’Œ Failoverï¼ˆå¤±æ•ˆå¤‡ä»½ï¼‰ï¼Œé™ä½å¯¹ F5 ç¡¬ä»¶è´Ÿè½½å‡è¡¡å™¨çš„ä¾èµ– è‡ªåŠ¨ç”»å‡ºåº”ç”¨é—´çš„ä¾èµ–å…³ç³»å›¾ï¼Œä»¥å¸®åŠ©æ¶æ„å¸ˆç†æ¸…ç†å…³ç³»ã€‚ å°†æœåŠ¡ç°åœ¨æ¯å¤©çš„è°ƒç”¨é‡ï¼Œå“åº”æ—¶é—´ï¼Œéƒ½ç»Ÿè®¡å‡ºæ¥ï¼Œä½œä¸ºå®¹é‡è§„åˆ’çš„å‚è€ƒæŒ‡æ ‡ï¼Œå¯ä»¥åŠ¨æ€è°ƒæ•´æƒé‡ï¼Œåœ¨çº¿ä¸Šï¼Œå°†æŸå°æœºå™¨çš„æƒé‡ä¸€ç›´åŠ å¤§ï¼Œå¹¶åœ¨åŠ å¤§çš„è¿‡ç¨‹ä¸­è®°å½•å“åº”æ—¶é—´çš„å˜åŒ–ï¼Œç›´åˆ°å“åº”æ—¶é—´åˆ°è¾¾é˜€å€¼ï¼Œè®°å½•æ­¤æ—¶çš„è®¿é—®é‡ï¼Œå†ä»¥æ­¤è®¿é—®é‡ä¹˜ä»¥æœºå™¨æ•°åæ¨æ€»å®¹é‡ dubboçš„åŸºæœ¬æ¶æ„ èŠ‚ç‚¹ è§’è‰²è¯´æ˜ Provider æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ Consumer è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ Registry æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ³¨å†Œä¸­å¿ƒ Monitor ç»Ÿè®¡æœåŠ¡çš„è°ƒç”¨æ¬¡è°ƒå’Œè°ƒç”¨æ—¶é—´çš„ç›‘æ§ä¸­å¿ƒ Container æœåŠ¡è¿è¡Œå®¹å™¨ è°ƒç”¨å…³ç³»è¯´æ˜ æœåŠ¡å®¹å™¨è´Ÿè´£å¯åŠ¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚ æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚ æœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚ æ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚ æœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚ æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚ åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¸€äº›ç‰¹æ€§Dubbo æ¶æ„å…·æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼Œåˆ†åˆ«æ˜¯è¿é€šæ€§ã€å¥å£®æ€§ã€ä¼¸ç¼©æ€§ã€ä»¥åŠå‘æœªæ¥æ¶æ„çš„å‡çº§æ€§ã€‚ è¿é€šæ€§ æ³¨å†Œä¸­å¿ƒè´Ÿè´£æœåŠ¡åœ°å€çš„æ³¨å†Œä¸æŸ¥æ‰¾ï¼Œç›¸å½“äºç›®å½•æœåŠ¡ï¼ŒæœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…åªåœ¨å¯åŠ¨æ—¶ä¸æ³¨å†Œä¸­å¿ƒäº¤äº’ï¼Œæ³¨å†Œä¸­å¿ƒä¸è½¬å‘è¯·æ±‚ï¼Œå‹åŠ›è¾ƒå° ç›‘æ§ä¸­å¿ƒè´Ÿè´£ç»Ÿè®¡å„æœåŠ¡è°ƒç”¨æ¬¡æ•°ï¼Œè°ƒç”¨æ—¶é—´ç­‰ï¼Œç»Ÿè®¡å…ˆåœ¨å†…å­˜æ±‡æ€»åæ¯åˆ†é’Ÿä¸€æ¬¡å‘é€åˆ°ç›‘æ§ä¸­å¿ƒæœåŠ¡å™¨ï¼Œå¹¶ä»¥æŠ¥è¡¨å±•ç¤º æœåŠ¡æä¾›è€…å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œå…¶æä¾›çš„æœåŠ¡ï¼Œå¹¶æ±‡æŠ¥è°ƒç”¨æ—¶é—´åˆ°ç›‘æ§ä¸­å¿ƒï¼Œæ­¤æ—¶é—´ä¸åŒ…å«ç½‘ç»œå¼€é”€ æœåŠ¡æ¶ˆè´¹è€…å‘æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ï¼Œå¹¶æ ¹æ®è´Ÿè½½ç®—æ³•ç›´æ¥è°ƒç”¨æä¾›è€…ï¼ŒåŒæ—¶æ±‡æŠ¥è°ƒç”¨æ—¶é—´åˆ°ç›‘æ§ä¸­å¿ƒï¼Œæ­¤æ—¶é—´åŒ…å«ç½‘ç»œå¼€é”€ æ³¨å†Œä¸­å¿ƒï¼ŒæœåŠ¡æä¾›è€…ï¼ŒæœåŠ¡æ¶ˆè´¹è€…ä¸‰è€…ä¹‹é—´å‡ä¸ºé•¿è¿æ¥ï¼Œç›‘æ§ä¸­å¿ƒé™¤å¤– æ³¨å†Œä¸­å¿ƒé€šè¿‡é•¿è¿æ¥æ„ŸçŸ¥æœåŠ¡æä¾›è€…çš„å­˜åœ¨ï¼ŒæœåŠ¡æä¾›è€…å®•æœºï¼Œæ³¨å†Œä¸­å¿ƒå°†ç«‹å³æ¨é€äº‹ä»¶é€šçŸ¥æ¶ˆè´¹è€… æ³¨å†Œä¸­å¿ƒå’Œç›‘æ§ä¸­å¿ƒå…¨éƒ¨å®•æœºï¼Œä¸å½±å“å·²è¿è¡Œçš„æä¾›è€…å’Œæ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹è€…åœ¨æœ¬åœ°ç¼“å­˜äº†æä¾›è€…åˆ—è¡¨ æ³¨å†Œä¸­å¿ƒå’Œç›‘æ§ä¸­å¿ƒéƒ½æ˜¯å¯é€‰çš„ï¼ŒæœåŠ¡æ¶ˆè´¹è€…å¯ä»¥ç›´è¿æœåŠ¡æä¾›è€… å¥å£®æ€§ ç›‘æ§ä¸­å¿ƒå®•æ‰ä¸å½±å“ä½¿ç”¨ï¼Œåªæ˜¯ä¸¢å¤±éƒ¨åˆ†é‡‡æ ·æ•°æ® æ•°æ®åº“å®•æ‰åï¼Œæ³¨å†Œä¸­å¿ƒä»èƒ½é€šè¿‡ç¼“å­˜æä¾›æœåŠ¡åˆ—è¡¨æŸ¥è¯¢ï¼Œä½†ä¸èƒ½æ³¨å†Œæ–°æœåŠ¡ æ³¨å†Œä¸­å¿ƒå¯¹ç­‰é›†ç¾¤ï¼Œä»»æ„ä¸€å°å®•æ‰åï¼Œå°†è‡ªåŠ¨åˆ‡æ¢åˆ°å¦ä¸€å° æ³¨å†Œä¸­å¿ƒå…¨éƒ¨å®•æ‰åï¼ŒæœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…ä»èƒ½é€šè¿‡æœ¬åœ°ç¼“å­˜é€šè®¯ æœåŠ¡æä¾›è€…æ— çŠ¶æ€ï¼Œä»»æ„ä¸€å°å®•æ‰åï¼Œä¸å½±å“ä½¿ç”¨ æœåŠ¡æä¾›è€…å…¨éƒ¨å®•æ‰åï¼ŒæœåŠ¡æ¶ˆè´¹è€…åº”ç”¨å°†æ— æ³•ä½¿ç”¨ï¼Œå¹¶æ— é™æ¬¡é‡è¿ç­‰å¾…æœåŠ¡æä¾›è€…æ¢å¤ ä¼¸ç¼©æ€§ æ³¨å†Œä¸­å¿ƒä¸ºå¯¹ç­‰é›†ç¾¤ï¼Œå¯åŠ¨æ€å¢åŠ æœºå™¨éƒ¨ç½²å®ä¾‹ï¼Œæ‰€æœ‰å®¢æˆ·ç«¯å°†è‡ªåŠ¨å‘ç°æ–°çš„æ³¨å†Œä¸­å¿ƒ æœåŠ¡æä¾›è€…æ— çŠ¶æ€ï¼Œå¯åŠ¨æ€å¢åŠ æœºå™¨éƒ¨ç½²å®ä¾‹ï¼Œæ³¨å†Œä¸­å¿ƒå°†æ¨é€æ–°çš„æœåŠ¡æä¾›è€…ä¿¡æ¯ç»™æ¶ˆè´¹è€… å‡çº§æ€§å½“æœåŠ¡é›†ç¾¤è§„æ¨¡è¿›ä¸€æ­¥æ‰©å¤§ï¼Œå¸¦åŠ¨ITæ²»ç†ç»“æ„è¿›ä¸€æ­¥å‡çº§ï¼Œéœ€è¦å®ç°åŠ¨æ€éƒ¨ç½²ï¼Œè¿›è¡ŒæµåŠ¨è®¡ç®—ï¼Œç°æœ‰åˆ†å¸ƒå¼æœåŠ¡æ¶æ„ä¸ä¼šå¸¦æ¥é˜»åŠ›ã€‚ä¸‹å›¾æ˜¯æœªæ¥å¯èƒ½çš„ä¸€ç§æ¶æ„ï¼š èŠ‚ç‚¹è§’è‰²è¯´æ˜ èŠ‚ç‚¹ è§’è‰²è¯´æ˜ Deployer è‡ªåŠ¨éƒ¨ç½²æœåŠ¡çš„æœ¬åœ°ä»£ç† Repository ä»“åº“ç”¨äºå­˜å‚¨æœåŠ¡åº”ç”¨å‘å¸ƒåŒ… Scheduler è°ƒåº¦ä¸­å¿ƒåŸºäºè®¿é—®å‹åŠ›è‡ªåŠ¨å¢å‡æœåŠ¡æä¾›è€… Admin ç»Ÿä¸€ç®¡ç†æ§åˆ¶å° Registry æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ³¨å†Œä¸­å¿ƒ Monitor ç»Ÿè®¡æœåŠ¡çš„è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´çš„ç›‘æ§ä¸­å¿ƒ dubbo çš„éœ€æ±‚ åœ¨å¤§è§„æ¨¡æœåŠ¡åŒ–ä¹‹å‰ï¼Œåº”ç”¨å¯èƒ½åªæ˜¯é€šè¿‡ RMI æˆ– Hessian ç­‰å·¥å…·ï¼Œç®€å•çš„æš´éœ²å’Œå¼•ç”¨è¿œç¨‹æœåŠ¡ï¼Œé€šè¿‡é…ç½®æœåŠ¡çš„URLåœ°å€è¿›è¡Œè°ƒç”¨ï¼Œé€šè¿‡ F5 ç­‰ç¡¬ä»¶è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚ å½“æœåŠ¡è¶Šæ¥è¶Šå¤šæ—¶ï¼ŒæœåŠ¡ URL é…ç½®ç®¡ç†å˜å¾—éå¸¸å›°éš¾ï¼ŒF5 ç¡¬ä»¶è´Ÿè½½å‡è¡¡å™¨çš„å•ç‚¹å‹åŠ›ä¹Ÿè¶Šæ¥è¶Šå¤§ã€‚ æ­¤æ—¶éœ€è¦ä¸€ä¸ªæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ŒåŠ¨æ€çš„æ³¨å†Œå’Œå‘ç°æœåŠ¡ï¼Œä½¿æœåŠ¡çš„ä½ç½®é€æ˜ã€‚å¹¶é€šè¿‡åœ¨æ¶ˆè´¹æ–¹è·å–æœåŠ¡æä¾›æ–¹åœ°å€åˆ—è¡¨ï¼Œå®ç°è½¯è´Ÿè½½å‡è¡¡å’Œ Failoverï¼Œé™ä½å¯¹ F5 ç¡¬ä»¶è´Ÿè½½å‡è¡¡å™¨çš„ä¾èµ–ï¼Œä¹Ÿèƒ½å‡å°‘éƒ¨åˆ†æˆæœ¬ã€‚ å½“è¿›ä¸€æ­¥å‘å±•ï¼ŒæœåŠ¡é—´ä¾èµ–å…³ç³»å˜å¾—é”™è¸ªå¤æ‚ï¼Œç”šè‡³åˆ†ä¸æ¸…å“ªä¸ªåº”ç”¨è¦åœ¨å“ªä¸ªåº”ç”¨ä¹‹å‰å¯åŠ¨ï¼Œæ¶æ„å¸ˆéƒ½ä¸èƒ½å®Œæ•´çš„æè¿°åº”ç”¨çš„æ¶æ„å…³ç³»ã€‚ è¿™æ—¶ï¼Œéœ€è¦è‡ªåŠ¨ç”»å‡ºåº”ç”¨é—´çš„ä¾èµ–å…³ç³»å›¾ï¼Œä»¥å¸®åŠ©æ¶æ„å¸ˆç†æ¸…ç†å…³ç³»ã€‚ æ¥ç€ï¼ŒæœåŠ¡çš„è°ƒç”¨é‡è¶Šæ¥è¶Šå¤§ï¼ŒæœåŠ¡çš„å®¹é‡é—®é¢˜å°±æš´éœ²å‡ºæ¥ï¼Œè¿™ä¸ªæœåŠ¡éœ€è¦å¤šå°‘æœºå™¨æ”¯æ’‘ï¼Ÿä»€ä¹ˆæ—¶å€™è¯¥åŠ æœºå™¨ï¼Ÿ ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œç¬¬ä¸€æ­¥ï¼Œè¦å°†æœåŠ¡ç°åœ¨æ¯å¤©çš„è°ƒç”¨é‡ï¼Œå“åº”æ—¶é—´ï¼Œéƒ½ç»Ÿè®¡å‡ºæ¥ï¼Œä½œä¸ºå®¹é‡è§„åˆ’çš„å‚è€ƒæŒ‡æ ‡ã€‚å…¶æ¬¡ï¼Œè¦å¯ä»¥åŠ¨æ€è°ƒæ•´æƒé‡ï¼Œåœ¨çº¿ä¸Šï¼Œå°†æŸå°æœºå™¨çš„æƒé‡ä¸€ç›´åŠ å¤§ï¼Œå¹¶åœ¨åŠ å¤§çš„è¿‡ç¨‹ä¸­è®°å½•å“åº”æ—¶é—´çš„å˜åŒ–ï¼Œç›´åˆ°å“åº”æ—¶é—´åˆ°è¾¾é˜€å€¼ï¼Œè®°å½•æ­¤æ—¶çš„è®¿é—®é‡ï¼Œå†ä»¥æ­¤è®¿é—®é‡ä¹˜ä»¥æœºå™¨æ•°åæ¨æ€»å®¹é‡ã€‚ ä»¥ä¸Šæ˜¯ Dubbo æœ€åŸºæœ¬çš„å‡ ä¸ªéœ€æ±‚ã€‚","date":"2024-12-31","categories":["java"],"tags":["dubbo"]},{"title":"dubbo-å­¦ä¹ å’Œä½¿ç”¨(8)-dubboé…ç½®å‚è€ƒ","url":"/2024/12/31/dubbo-å­¦ä¹ å’Œä½¿ç”¨-8--dubboé…ç½®å‚è€ƒ/","content":"dubbo:service(dubbo:service)è¿™ä¸ªé…ç½®æ˜¯é’ˆå¯¹æœåŠ¡ç«¯çš„ï¼Œç”¨æ¥æš´éœ²æœåŠ¡ç«¯å¯ä»¥å¯¹å¤–æä¾›çš„æœåŠ¡ä¿¡æ¯ å¯¹åº”çš„é…ç½®ç±»com.alibaba.dubbo.config.ServiceConfig å±æ€§ å¯¹åº”URL ç±»å‹ æ˜¯å¦å¿…å¡« ç¼ºçœå€¼ ä½œç”¨ æè¿° å…¼å®¹æ€§ interface - class å¿…å¡« - æœåŠ¡å‘ç° æœåŠ¡æ¥å£å 1.0.0ä»¥ä¸Šç‰ˆæœ¬ ref - object å¿…å¡« - æœåŠ¡å‘ç° æœåŠ¡å¯¹è±¡å®ç°å¼•ç”¨ 1.0.0ä»¥ä¸Šç‰ˆæœ¬ version version string å¯é€‰ 0.0.0 æœåŠ¡å‘ç° æœåŠ¡ç‰ˆæœ¬ï¼Œå»ºè®®ä½¿ç”¨ä¸¤ä½æ•°å­—ç‰ˆæœ¬ï¼Œå¦‚ï¼š1.0ï¼Œé€šå¸¸åœ¨æ¥å£ä¸å…¼å®¹æ˜¯ç‰ˆæœ¬å·æ‰éœ€è¦å‡çº§ 1.0.0ä»¥ä¸Šç‰ˆæœ¬ group group string å¯é€‰ - æœåŠ¡å‘ç° æœåŠ¡åˆ†ç»„ï¼Œå½“ä¸€ä¸ªå€Ÿå£æœ‰å¤šä¸ªå®ç°ï¼Œå¯ä»¥ç”¨åˆ†ç»„åŒºåˆ† 1.0.7ä»¥ä¸Šç‰ˆæœ¬ path string å¯é€‰ ç¼ºçœä¸ºæ¥å£ æœåŠ¡å‘ç° æœåŠ¡è·¯å¾„ 1.0.12ä»¥ä¸Šç‰ˆæœ¬ delay delay int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ å»¶è¿Ÿæ³¨å†ŒæœåŠ¡æ—¶é—´(æ¯«ç§’)ï¼Œè®¾ä¸º-1æ—¶ï¼Œè¡¨ç¤ºå»¶è¿Ÿåˆ°Springå®¹å™¨åˆå§‹åŒ–å®Œæˆæ—¶æš´éœ²æœåŠ¡ 1.0.14ä»¥ä¸Šç‰ˆæœ¬ timeout timeout int å¯é€‰ 1000 æ€§èƒ½è°ƒä¼˜ è¿œç¨‹æœåŠ¡è°ƒç”¨è¶…æ—¶æ—¶é—´(æ¯«ç§’) 2.0.0ä»¥ä¸Šç‰ˆæœ¬ retries retries int å¯é€‰ 2 æ€§èƒ½è°ƒä¼˜ è¿œç¨‹æœåŠ¡è°ƒç”¨é‡è¯•æ¬¡æ•°ï¼Œä¸åŒ…æ‹¬ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œ0ä¸ºä¸éœ€è¦é‡è¯• 2.0.0ä»¥ä¸Šç‰ˆæœ¬ connections connections boolean å¯é€‰ 100 æ€§èƒ½è°ƒä¼˜ å¯¹æ¯ä¸ªæä¾›è€…çš„æœ€å¤§è¿æ¥æ•°ï¼Œrmiã€httpã€hesslanç­‰å¤šè¿æ¥åè®®è¡¨ç¤ºé™åˆ¶è¿æ¥æ•°ï¼Œdubboç­‰é•¿é“¾æ¥åè®®è¡¨ç¤ºå»ºç«‹çš„é•¿è¿æ¥ä¸ªæ•° 2.0.0ä»¥ä¸Šç‰ˆæœ¬ loadbalance loadbalance string å¯é€‰ random æ€§èƒ½è°ƒä¼˜ è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå¯é€‰å€¼ï¼šrandomï¼Œroundrobinï¼Œleastacticeï¼Œåˆ†åˆ«è¡¨ç¤ºï¼šéšæœºï¼Œè½®è¯¢ï¼Œæœ€å°‘æ´»è·ƒè°ƒç”¨ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ async async boolean å¯é€‰ FALSE æ€§èƒ½è°ƒä¼˜ æ˜¯å¦ç¼ºçœå¼‚æ­¥æ‰§è¡Œï¼Œä¸å¯é å¼‚æ­¥ï¼Œåªæ˜¯å¿½ç•¥è¿”å›å€¼ï¼Œä¸é˜»å¡æ‰§è¡Œçº¿ç¨‹ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ stub stub class&#x2F;boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† è®¾ä¸ºtureï¼Œè¡¨ç¤ºä½¿ç”¨ç¼ºçœä»£ç†ç±»åï¼Œå³ï¼šæ¥å£å+Localåç¼€ï¼ŒæœåŠ¡æ¥å£å®¢æˆ·ç«¯æœ¬åœ°ä»£ç†ç±»åï¼Œç”¨äºåœ¨å®¢æˆ·ç«¯æ‰§è¡Œæœ¬åœ°é€»è¾‘ï¼Œå¦‚æœ¬åœ°ç¼“å­˜ç­‰ã€‚è¯¥æœ¬åœ°ä»£ç†ç±»çš„æ„é€ å‡½æ•°å¿…é¡»å…è®¸ä¼ å…¥è¿œç¨‹ä»£ç†å¯¹è±¡ï¼Œæ„é€ å‡½æ•°å¦‚ï¼špublicxxxServiceLocal(XxxServicexxxService) 2.0.0ä»¥ä¸Šç‰ˆæœ¬ mock mock class&#x2F;boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† è®¾ä¸ºtrueï¼Œè¡¨ç¤ºä½¿ç”¨ç¼ºçœMockç±»åï¼Œå³ï¼šæ¥å£å+Mockåç¼€ï¼ŒæœåŠ¡æ¥å£è°ƒç”¨å¤±è´¥Mockå®ç°ç±»ï¼Œè¯¥Mockç±»å¿…é¡»æœ‰ä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°ï¼Œä¸Localçš„åŒºåˆ«åœ¨äºï¼ŒLocalæ€»æ˜¯è¢«æ‰§è¡Œï¼Œè€ŒMockåªåœ¨å‡ºç°éä¸šåŠ¡å¼‚å¸¸(æ¯”å¦‚è¶…æ—¶ï¼Œç½‘ç»œå¼‚å¸¸ç­‰)æ—¶æ‰§è¡Œï¼ŒLocalåœ¨è¿œç¨‹è°ƒç”¨ä¹‹å‰æ‰§è¡Œï¼ŒMockåœ¨è¿œç¨‹è°ƒç”¨åæ‰§è¡Œ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ token token string&#x2F;bollean å¯é€‰ FALSE æœåŠ¡æ²»ç† ä»¤ç‰ŒéªŒè¯ï¼Œä¸ºç©ºè¡¨ç¤ºä¸å¼€å¯ã€‚å¦‚æœä¸ºtrueï¼Œè¡¨ç¤ºéšæœºç”ŸæˆåŠ¨æ€ä»¤ç‰Œï¼Œå¦åˆ™ä½¿ç”¨é™æ€ä»¤ç‰Œã€‚ä»¤ç‰Œçš„ä½œç”¨æ˜¯é˜²æ­¢æ¶ˆè´¹è€…ç»•è¿‡æ³¨å†Œä¸­å¿ƒç›´æ¥è®¿é—®ï¼Œä¿è¯æ³¨å†Œä¸­å¿ƒçš„æˆæƒåŠŸèƒ½æœ‰æ•ˆã€‚å¦‚æœä½¿ç”¨ç‚¹å¯¹ç‚¹è°ƒç”¨ï¼Œéœ€è¦å…³é—­ä»¤ç‰ŒåŠŸèƒ½ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ registry - string å¯é€‰ ç¼ºçœå‘æ‰€æœ‰registryæ³¨å†Œ é…ç½®å…³è” å‘æŒ‡å®šæ³¨å†Œä¸­å¿ƒæ³¨å†Œdubbo:registryçš„å±æ€§ä¸ºidçš„valueï¼›åœ¨å‘å¤šä¸ªæ³¨å†Œä¸­å¿ƒæ³¨å†Œæ—¶ï¼Œå¤šä¸ªidä½¿ç”¨é€—å·åˆ†éš”ï¼›å¦‚æœä¸æƒ³è®²è¯¥æœåŠ¡æ³¨å†Œåˆ°ä»»ä½•registryï¼Œå¯å°†å€¼è®¾ç½®N&#x2F;A 2.0.0ä»¥ä¸Šç‰ˆæœ¬ provider - string å¯é€‰ ç¼ºçœä½¿ç”¨ç¬¬ä¸€ä¸ªprovideré…ç½® é…ç½®å…³è” æŒ‡å®šproviderï¼Œå€¼ä¸ºdubbo:providerçš„idå±æ€§ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ deprecated deprecated boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† æœåŠ¡æ˜¯å¦è¿‡æ—¶ï¼Œå¦‚æœè®¾ç½®ä¸ºtrueï¼Œæ¶ˆè´¹æ–¹å¼•ç”¨æ—¶å°†æ‰“å°æœåŠ¡è¿‡æ—¶è­¦å‘Šerroræ—¥å¿— 2.0.5ä»¥ä¸Šç‰ˆæœ¬ dynamic dynamic boolean å¯é€‰ TRUE æœåŠ¡æ²»ç† æœåŠ¡æ˜¯å¦åŠ¨æ€æ³¨å†Œï¼Œå¦‚æœè®¾ä¸ºfalseï¼Œæ³¨å†Œåå°†æ˜¾ç¤ºdisableçŠ¶æ€ï¼Œéœ€è¦äººå·¥å¯ç”¨ï¼›å¹¶ä¸”æœåŠ¡æä¾›è€…åœæ­¢æ—¶ï¼Œä¹Ÿä¸ä¼šè‡ªåŠ¨å–æ¶ˆæ³¨å†Œï¼Œéœ€è¦äººå·¥ç¦ç”¨ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ accesslog accesslog string&#x2F;boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† è®¾ä¸ºtrueï¼Œå°†å‘loggerä¸­è¾“å…¥è®¿é—®æ—¥å¿—ï¼Œä¹Ÿå¯ä»¥å¡«å†™è®¿é—®æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œç›´æ¥æŠŠè®¿é—®æ—¥å¿—è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ owner owner string å¯é€‰ - æœåŠ¡æ²»ç† æœåŠ¡è´£ä»»äººï¼Œç”¨äºæœåŠ¡æ²»ç†ï¼Œè¯·å¡«å†™å…¬å¸è´Ÿè´£äººé‚®ç®±å‰ç¼€ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ document document string å¯é€‰ - æœåŠ¡æ²»ç† æœåŠ¡æ–‡æ¡£URL 1.0.5ä»¥ä¸Šç‰ˆæœ¬ weight weight int å¯é€‰ - æœåŠ¡è°ƒä¼˜ æœåŠ¡æƒé‡ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ executes executes int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ æœåŠ¡æä¾›è€…æ¯ä¸ªæœåŠ¡æ–¹æ³•æœ€å¤§å¯å¹¶è¡Œè¯·æ±‚æ•° actives actives int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ æœåŠ¡æ¶ˆè´¹è€…æ¯ä¸ªæœåŠ¡æ–¹æ³•æœ€å¤§å¹¶å‘è°ƒç”¨æ•° proxy proxy string å¯é€‰ javassist æ€§èƒ½è°ƒä¼˜ çœåŸåŠ¨æ€ä»£ç†æ–¹æ³•ï¼Œå¯é€‰ï¼šjdk&#x2F;javassist 2.0.5ä»¥ä¸Šç‰ˆæœ¬ cluster cluster stirng å¯é€‰ failover æ€§èƒ½è°ƒä¼˜ é›†ç¾¤æ–¹å¼ï¼Œå¯é€‰:failover&#x2F;failfast&#x2F;failsafe&#x2F;failback&#x2F;forking 2.0.5ä»¥ä¸Šç‰ˆæœ¬ filter service.filter string å¯é€‰ default æ€§èƒ½è°ƒä¼˜ æœåŠ¡æä¾›æ–¹è¿œç¨‹è°ƒç”¨è¿‡ç¨‹æ‹¦æˆªå™¨åç§°ï¼Œå¤šä¸ªåç§°ç”¨é€—å·åˆ†éš” 2.0.5ä»¥ä¸Šç‰ˆæœ¬ listener exporter.listener string å¯é€‰ default æ€§èƒ½è°ƒä¼˜ æœåŠ¡æä¾›æ–¹å¯¼å‡ºæœåŠ¡ç›‘å¬å™¨åç§°ï¼Œå¤šä¸ªåç§°ç”¨é€—å·åˆ†éš” 2.0.5ä»¥ä¸Šç‰ˆæœ¬ protocol - string å¯é€‰ - é…ç½®å…³è” ä½¿ç”¨æŒ‡å®šçš„åè®®æš´éœ²æœåŠ¡ï¼Œåœ¨ä½¿ç”¨å¤šåè®®æ—¶ï¼Œdubbo:protocolçš„idå±æ€§çš„value,ä½¿ç”¨é€—å·åˆ†éš” 2.0.5ä»¥ä¸Šç‰ˆæœ¬ layer layer string å¯é€‰ - æœåŠ¡æ²»ç† æœåŠ¡æä¾›è€…æ‰€åœ¨çš„åˆ†å±‚ã€‚å¦‚ï¼šbiz,dao,intl:web,china:acton 2.0.7ä»¥ä¸Šç‰ˆæœ¬ register register boolean å¯é€‰ TRUE æœåŠ¡æ²»ç† è¯¥åè®®çš„æœåŠ¡æ˜¯å¦æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ 2.0.8ä»¥ä¸Šç‰ˆæœ¬ æ³¨æ„ï¼šå¤´å››ä¸ªæ˜¯æœ€é‡è¦çš„å±æ€§dubboé€šè¿‡è¿™äº›å±æ€§æ¥å”¯ä¸€çš„æ ‡ç¤ºä¸€ä¸ªservice dubbo:referenceè¿™ä¸ªé…ç½®æ˜¯é’ˆå¯¹æ¶ˆè´¹è€…ç«¯çš„ï¼Œæ¶ˆè´¹ä¸­é€šè¿‡è¿™ä¸ªç±»å‘èµ·è¯·æ±‚å‘æœåŠ¡ç«¯è¿›è¡Œè°ƒç”¨ å¯¹åº”çš„é…ç½®ç±»com.alibaba.dubbo.config.ReferenceConfig å±æ€§ å¯¹åº”URL ç±»å‹ æ˜¯å¦å¿…å¡« ç¼ºçœå€¼ ä½œç”¨ æè¿° å…¼å®¹æ€§ id - string å¿…å¡« - é…ç½®å…³è” æœåŠ¡åº”ç”¨beanid 1.0.0ä»¥ä¸Šç‰ˆæœ¬ interface - class å¿…å¡« - æœåŠ¡å‘ç° æœåŠ¡æ¥å£å 1.0.0ä»¥ä¸Šç‰ˆæœ¬ version version string å¯é€‰ - æœåŠ¡å‘ç° æœåŠ¡ç‰ˆæœ¬ï¼Œä¸æœåŠ¡æä¾›è€…çš„ç‰ˆæœ¬ä¿æŒä¸€è‡´ 1.0.0ä»¥ä¸Šç‰ˆæœ¬ group group string å¯é€‰ - æœåŠ¡å‘ç° æœåŠ¡åˆ†ç»„ï¼Œå½“ä¸€ä¸ªå€Ÿå£æœ‰å¤šä¸ªå®ç°ï¼Œå¯ä»¥ç”¨åˆ†ç»„åŒºåˆ†ï¼Œå¿…é¡»å’ŒæœåŠ¡æä¾›æ–¹ä¸€è‡´ 1.0.7ç‰ˆæœ¬ timeout timeout long å¯é€‰ ç¼ºçœä½¿ç”¨dubbo:consumerçš„timeout æ€§èƒ½è°ƒä¼˜ æœåŠ¡æ–¹æ³•è°ƒç”¨è¶…æ—¶æ—¶é—´(æ¯«ç§’) 1.0.5ä»¥ä¸Šç‰ˆæœ¬ retries retries int å¯é€‰ ç¼ºçœä½¿ç”¨dubbo:consumerçš„retries æ€§èƒ½è°ƒä¼˜ è¿œç¨‹æœåŠ¡è°ƒç”¨é‡è¯•æ¬¡æ•°ï¼Œä¸åŒ…æ‹¬ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œä¸éœ€è¦é‡è¯•è¯·è®¾ç½®ä¸º0 2.0.0ä»¥ä¸Šç‰ˆæœ¬ connections connections int å¯é€‰ ç¼ºçœä½¿ç”¨çš„connections æ€§èƒ½è°ƒä¼˜ å¯¹æ¯ä¸ªæä¾›è€…çš„æœ€å¤§è¿æ¥æ•°ï¼Œrmiã€httpã€hessianç­‰çŸ­è¿æ¥åè®®è¡¨ç¤ºé™åˆ¶è¿æ¥æ•°ï¼Œdubboç­‰é•¿è¿æ¥åè¡¨ç¤ºå»ºç«‹çš„é•¿è¿æ¥ä¸ªæ•° 2.0.0ä»¥ä¸Šç‰ˆæœ¬ loadbalance loadbalance string å¯é€‰ ç¼ºçœä½¿ç”¨çš„loadbalance æ€§èƒ½è°ƒä¼˜ è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå¯é€‰å€¼ï¼šrandom,roundrobin,leastactiveï¼Œåˆ†åˆ«è¡¨ç¤ºï¼šéšæœºï¼Œè½®å¾ªï¼Œæœ€å°‘æ´»è·ƒè°ƒç”¨ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ sync sync boolean å¯é€‰ ç¼ºçœä½¿ç”¨çš„async æ€§èƒ½è°ƒä¼˜ æ˜¯å¦å¼‚æ­¥æ‰§è¡Œï¼Œä¸å¯é å¼‚æ­¥ï¼Œåªæ˜¯å¿½ç•¥è¿”å›å€¼ï¼Œä¸é˜»å¡æ‰§è¡Œçº¿ç¨‹ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ generic generic boolean å¯é€‰ ç¼ºçœä½¿ç”¨çš„generic æœåŠ¡æ²»ç† æ˜¯å¦ç¼ºçœæ³›åŒ–æ¥å£ï¼Œå¦‚æœä¸ºæ³›åŒ–æ¥å£ï¼Œå°†è¿”å›GenericService 2.0.0ä»¥ä¸Šç‰ˆæœ¬ check check boolean å¯é€‰ ç¼ºçœä½¿ç”¨çš„check æœåŠ¡æ²»ç† å¯åŠ¨æ—¶æ£€æŸ¥æä¾›è€…æ˜¯å¦å­˜åœ¨ï¼ŒtrueæŠ¥é”™ï¼Œfalseå¿½ç•¥ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ url string å¯é€‰ - æœåŠ¡æ²»ç† ç‚¹å¯¹ç‚¹ç›´è¿æœåŠ¡æä¾›è€…åœ°å€ï¼Œå°†ç»•è¿‡æ³¨å†Œä¸­å¿ƒ 1.0.6ä»¥ä¸Šç‰ˆæœ¬ stub stub class&#x2F;boolean å¯é€‰ - æœåŠ¡æ²»ç† æœåŠ¡æ¥å£å®¢æˆ·ç«¯æœ¬åœ°ä»£ç†ç±»åï¼Œç”¨äºåœ¨å®¢æˆ·ç«¯æ‰§è¡Œæœ¬åœ°é€»è¾‘ï¼Œå¦‚æœ¬åœ°ç¼“å­˜ç­‰ï¼Œè¯¥æœ¬åœ°ä»£ç†ç±»çš„æ„é€ å‡½æ•°å¿…é¡»å…è®¸ä¼ å…¥è¿œç¨‹ä»£ç†å¯¹è±¡ï¼Œæ„é€ å‡½æ•°å¦‚ï¼špublicXxxServiceLocal(XxxServicexxxService) 2.0.0ä»¥ä¸Šç‰ˆæœ¬ mock mock class&#x2F;boolean å¯é€‰ - æœåŠ¡æ²»ç† æœåŠ¡æ¥å£è°ƒç”¨å¤±è´¥Mockå®ç°ç±»åï¼Œè¯¥Mockç±»å¿…é¡»æœ‰ä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°ï¼Œä¸Localçš„åŒºåˆ«åœ¨äºï¼ŒLocalæ€»æ˜¯è¢«æ‰§è¡Œï¼Œè€ŒMockåªåœ¨å‡ºç°éä¸šåŠ¡å¼‚å¸¸(æ¯”å¦‚è¶…æ—¶ï¼Œç½‘ç»œå¼‚å¸¸ç­‰)æ—¶æ‰§è¡Œï¼ŒLocalåœ¨è¿œç¨‹è°ƒç”¨ä¹‹å‰æ‰§è¡Œï¼ŒMockåœ¨è¿œç¨‹è°ƒç”¨åæ‰§è¡Œ 1.0.13ä»¥ä¸Šç‰ˆæœ¬ cache cache string&#x2F;boolean å¯é€‰ - æœåŠ¡æ²»ç† ä»¥è°ƒç”¨å‚æ•°ä¸ºkeyï¼Œç¼“å­˜è¿”å›ç»“æœã€‚å¯é€‰ï¼šlru,threadlocal,jcacheç­‰ 2.1.0ä»¥ä¸Šç‰ˆæœ¬ validation validation boolean å¯é€‰ - æœåŠ¡æ²»ç† æ˜¯å¦å¯ç”¨JSR303æ ‡å‡†æ³¨è§£éªŒè¯ï¼Œå¦‚æœå¯ç”¨ï¼Œå°†å¯¹æ–¹æ³•å‚æ•°ä¸Šçš„æ³¨è§£è¿›è¡Œæ ¡éªŒ 2.1.0ä»¥ä¸Šç‰ˆæœ¬ proxy proxy boolean å¯é€‰ javassist æ€§èƒ½è°ƒä¼˜ é€‰æ‹©åŠ¨æ€ä»£ç†å®ç°ç­–ç•¥ï¼Œå¯é€‰ï¼šjavassist,jdk 2.0.2ä»¥ä¸Šç‰ˆæœ¬ client client string å¯é€‰ - æ€§èƒ½è°ƒä¼˜ å®¢æˆ·ç«¯ä¼ è¾“ç±»å‹è®¾ç½®ï¼Œå¦‚Dubboåè®®çš„nettyæˆ–mina 2.0.0ä»¥ä¸Šç‰ˆæœ¬ registry - string å¯é€‰ ç¼ºçœå°†ä»æ‰€æœ‰æ³¨å†Œä¸­å¿ƒè·æœåŠ¡åˆ—è¡¨ååˆå¹¶ç»“æœ é…ç½®å…³è” ä»æŒ‡å®šæ³¨å†Œä¸­å¿ƒæ³¨å†Œè·å–æœåŠ¡åˆ—è¡¨ï¼Œåœ¨å¤šä¸ªæ³¨å†Œä¸­å¿ƒæ—¶ä½¿ç”¨ï¼Œå€¼ä¸ºçš„idå±æ€§ï¼Œå¤šä¸ªæ³¨å†Œä¸­å¿ƒIDç”¨é€—å·åˆ†éš” 2.0.0ä»¥ä¸Šç‰ˆæœ¬ owner owner string å¯é€‰ - æœåŠ¡æ²»ç† è°ƒç”¨æœåŠ¡è´Ÿè´£äººï¼Œç”¨äºæœåŠ¡æ²»ç†ï¼Œè¯·å¡«å†™è´Ÿè´£äººå…¬å¸é‚®ç®±å‰ç¼€ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ actives actives int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ æœåŠ¡æ¶ˆè´¹è€…æ¯ä¸ªæœåŠ¡æ–¹æ³•æœ€å¤§å¹¶å‘è°ƒç”¨æ•° 2.0.5ä»¥ä¸Šç‰ˆæœ¬ cluster cluster string å¯é€‰ failover æ€§èƒ½ä¼˜åŒ– é›†ç¾¤æ–¹å¼ï¼Œå¯é€‰ï¼šfailover&#x2F;failfast&#x2F;failsafe&#x2F;failback&#x2F;forking 2.0.5ä»¥ä¸Šç‰ˆæœ¬ filter reference.filter string å¯é€‰ default æ€§èƒ½è°ƒä¼˜ æœåŠ¡æ¶ˆè´¹æ–¹è¿œç¨‹è°ƒç”¨è¿‡ç¨‹æ‹¦æˆªå™¨åç§°ï¼Œå¤šä¸ªåç§°ç”¨é€—å·åˆ†éš” 2.0.5ä»¥ä¸Šç‰ˆæœ¬ listener invoker.listener string å¯é€‰ default æ€§èƒ½è°ƒä¼˜ æœåŠ¡æ¶ˆè´¹æ–¹å¼•ç”¨æœåŠ¡ç›‘å¬å™¨åç§°ï¼Œå¤šä¸ªåç§°ç”¨é€—å·åˆ†éš” 2.0.5ä»¥ä¸Šç‰ˆæœ¬ layer layer string å¯é€‰ - æœåŠ¡æ²»ç† æœåŠ¡è°ƒç”¨è€…æ‰€åœ¨çš„åˆ†å±‚ã€‚å¦‚ï¼šbizã€daoã€intl:webã€china:acton 2.0.7ä»¥ä¸Šç‰ˆæœ¬ init init boolean å¯é€‰ FALSE æ€§èƒ½è°ƒä¼˜ æ˜¯å¦åœ¨afterPropertiesSet()æ—¶é¥¥é¥¿åˆå§‹åŒ–å¼•ç”¨ï¼Œå¦åˆ™ç­‰åˆ°æœ‰äººæ³¨å…¥æˆ–å¼•ç”¨è¯¥å®ä¾‹æ—¶å†åˆå§‹åŒ– 2.0.10ä»¥ä¸Šç‰ˆæœ¬ protocol protocol string å¯é€‰ - æœåŠ¡æ²»ç† åªè°ƒç”¨æŒ‡å®šåè®®çš„æœåŠ¡æä¾›æ–¹ï¼Œå…¶ä»–åè®®å¿½ç•¥ æ³¨æ„ï¼šå¤´å››ä¸ªæ˜¯æœ€é‡è¦çš„å±æ€§dubboé€šè¿‡è¿™äº›å±æ€§æ¥å”¯ä¸€çš„æ ‡ç¤ºä¸€ä¸ªservice dubbo:protocol(dubbo:protocol)æœåŠ¡æä¾›è€…åè®®é…ç½®ã€‚å¯¹åº”çš„é…ç½®ç±»ï¼šcom.alibaba.dubbo.config.ProtocolConfigã€‚åŒæ—¶ï¼Œå¦‚æœéœ€è¦æ”¯æŒå¤šåè®®ï¼Œå¯ä»¥å£°æ˜å¤šä¸ªdubbo:protocolæ ‡ç­¾ï¼Œå¹¶åœ¨dubbo:serviceä¸­é€šè¿‡protocolå±æ€§æŒ‡å®šä½¿ç”¨çš„åè®®ã€‚ å±æ€§ å¯¹åº”URLå‚æ•° ç±»å‹ æ˜¯å¦å¿…å¡« ç¼ºçœå€¼ ä½œç”¨ æè¿° å…¼å®¹æ€§ id string å¯é€‰ dubbo é…ç½®å…³è” åè®®BeanIdï¼Œå¯ä»¥åœ¨ä¸­å¼•ç”¨æ­¤IDï¼Œå¦‚æœIDä¸å¡«ï¼Œç¼ºçœå’Œnameå±æ€§å€¼ä¸€æ ·ï¼Œé‡å¤åˆ™åœ¨nameååŠ åºå·ã€‚ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ name string å¿…å¡« dubbo æ€§èƒ½è°ƒä¼˜ åè®®åç§° 2.0.5ä»¥ä¸Šç‰ˆæœ¬ port int å¯é€‰ dubboåè®®ç¼ºçœç«¯å£ä¸º20880ï¼Œrmiåè®®ç¼ºçœç«¯å£ä¸º1099ï¼Œhttpå’Œhessianåè®®ç¼ºçœç«¯å£ä¸º80ï¼›å¦‚æœæ²¡æœ‰é…ç½®portï¼Œåˆ™è‡ªåŠ¨é‡‡ç”¨é»˜è®¤ç«¯å£ï¼Œå¦‚æœé…ç½®ä¸º-1ï¼Œåˆ™ä¼šåˆ†é…ä¸€ä¸ªæ²¡æœ‰è¢«å ç”¨çš„ç«¯å£ã€‚Dubbo2.4.0+ï¼Œåˆ†é…çš„ç«¯å£åœ¨åè®®ç¼ºçœç«¯å£çš„åŸºç¡€ä¸Šå¢é•¿ï¼Œç¡®ä¿ç«¯å£æ®µå¯æ§ã€‚ æœåŠ¡å‘ç° æœåŠ¡ç«¯å£ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ host string å¯é€‰ è‡ªåŠ¨æŸ¥æ‰¾æœ¬æœºIP æœåŠ¡å‘ç° -æœåŠ¡ä¸»æœºåï¼Œå¤šç½‘å¡é€‰æ‹©æˆ–æŒ‡å®šVIPåŠåŸŸåæ—¶ä½¿ç”¨ï¼Œä¸ºç©ºåˆ™è‡ªåŠ¨æŸ¥æ‰¾æœ¬æœºIPï¼Œ-å»ºè®®ä¸è¦é…ç½®ï¼Œè®©Dubboè‡ªåŠ¨è·å–æœ¬æœºIP 2.0.5ä»¥ä¸Šç‰ˆæœ¬ threadpool threadpool string å¯é€‰ fixed æ€§èƒ½è°ƒä¼˜ çº¿ç¨‹æ± ç±»å‹ï¼Œå¯é€‰ï¼šfixed&#x2F;cached 2.0.5ä»¥ä¸Šç‰ˆæœ¬ threads threads int å¯é€‰ 200 æ€§èƒ½è°ƒä¼˜ æœåŠ¡çº¿ç¨‹æ± å¤§å°(å›ºå®šå¤§å°) 2.0.5ä»¥ä¸Šç‰ˆæœ¬ iothreads threads int å¯é€‰ cpuä¸ªæ•°+1 æ€§èƒ½è°ƒä¼˜ ioçº¿ç¨‹æ± å¤§å°(å›ºå®šå¤§å°) 2.0.5ä»¥ä¸Šç‰ˆæœ¬ accepts accepts int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ æœåŠ¡æä¾›æ–¹æœ€å¤§å¯æ¥å—è¿æ¥æ•° 2.0.5ä»¥ä¸Šç‰ˆæœ¬ payload payload int å¯é€‰ 8388608(&#x3D;8M) æ€§èƒ½è°ƒä¼˜ è¯·æ±‚åŠå“åº”æ•°æ®åŒ…å¤§å°é™åˆ¶ï¼Œå•ä½ï¼šå­—èŠ‚ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ codec codec string å¯é€‰ dubbo æ€§èƒ½è°ƒä¼˜ åè®®ç¼–ç æ–¹å¼ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ serialization serialization string å¯é€‰ dubboåè®®ç¼ºçœä¸ºhessian2ï¼Œrmiåè®®ç¼ºçœä¸ºjavaï¼Œhttpåè®®ç¼ºçœä¸ºjson æ€§èƒ½è°ƒä¼˜ åè®®åºåˆ—åŒ–æ–¹å¼ï¼Œå½“åè®®æ”¯æŒå¤šç§åºåˆ—åŒ–æ–¹å¼æ—¶ä½¿ç”¨ï¼Œæ¯”å¦‚ï¼šdubboåè®®çš„dubbo,hessian2,java,compactedjavaï¼Œä»¥åŠhttpåè®®çš„jsonç­‰ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ accesslog accesslog string&#x2F;boolean å¯é€‰ æœåŠ¡æ²»ç† è®¾ä¸ºtrueï¼Œå°†å‘loggerä¸­è¾“å‡ºè®¿é—®æ—¥å¿—ï¼Œä¹Ÿå¯å¡«å†™è®¿é—®æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œç›´æ¥æŠŠè®¿é—®æ—¥å¿—è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ path string å¯é€‰ æœåŠ¡å‘ç° æä¾›è€…ä¸Šä¸‹æ–‡è·¯å¾„ï¼Œä¸ºæœåŠ¡pathçš„å‰ç¼€ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ transporter transporter string å¯é€‰ dubboåè®®ç¼ºçœä¸ºnetty æ€§èƒ½è°ƒä¼˜ åè®®çš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å®ç°ç±»å‹ï¼Œæ¯”å¦‚ï¼šdubboåè®®çš„mina,nettyç­‰ï¼Œå¯ä»¥åˆ†æ‹†ä¸ºserverå’Œclienté…ç½® 2.0.5ä»¥ä¸Šç‰ˆæœ¬ server server string å¯é€‰ dubboåè®®ç¼ºçœä¸ºnettyï¼Œhttpåè®®ç¼ºçœä¸ºservlet æ€§èƒ½è°ƒä¼˜ åè®®çš„æœåŠ¡å™¨ç«¯å®ç°ç±»å‹ï¼Œæ¯”å¦‚ï¼šdubboåè®®çš„mina,nettyç­‰ï¼Œhttpåè®®çš„jetty,servletç­‰ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ client client string å¯é€‰ dubboåè®®ç¼ºçœä¸ºnetty æ€§èƒ½è°ƒä¼˜ åè®®çš„å®¢æˆ·ç«¯å®ç°ç±»å‹ï¼Œæ¯”å¦‚ï¼šdubboåè®®çš„mina,nettyç­‰ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ dispatcher dispatcher string å¯é€‰ dubboåè®®ç¼ºçœä¸ºall æ€§èƒ½è°ƒä¼˜ åè®®çš„æ¶ˆæ¯æ´¾å‘æ–¹å¼ï¼Œç”¨äºæŒ‡å®šçº¿ç¨‹æ¨¡å‹ï¼Œæ¯”å¦‚ï¼šdubboåè®®çš„all,direct,message,execution,connectionç­‰ 2.1.0ä»¥ä¸Šç‰ˆæœ¬ queues queues int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ çº¿ç¨‹æ± é˜Ÿåˆ—å¤§å°ï¼Œå½“çº¿ç¨‹æ± æ»¡æ—¶ï¼Œæ’é˜Ÿç­‰å¾…æ‰§è¡Œçš„é˜Ÿåˆ—å¤§å°ï¼Œå»ºè®®ä¸è¦è®¾ç½®ï¼Œå½“çº¿ç¨‹ç¨‹æ± æ—¶åº”ç«‹å³å¤±è´¥ï¼Œé‡è¯•å…¶å®ƒæœåŠ¡æä¾›æœºå™¨ï¼Œè€Œä¸æ˜¯æ’é˜Ÿï¼Œé™¤éæœ‰ç‰¹æ®Šéœ€æ±‚ã€‚ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ charset charset string å¯é€‰ UTF-8 æ€§èƒ½è°ƒä¼˜ åºåˆ—åŒ–ç¼–ç  2.0.5ä»¥ä¸Šç‰ˆæœ¬ buffer buffer int å¯é€‰ 8192 æ€§èƒ½è°ƒä¼˜ ç½‘ç»œè¯»å†™ç¼“å†²åŒºå¤§å° 2.0.5ä»¥ä¸Šç‰ˆæœ¬ heartbeat heartbeat int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ å¿ƒè·³é—´éš”ï¼Œå¯¹äºé•¿è¿æ¥ï¼Œå½“ç‰©ç†å±‚æ–­å¼€æ—¶ï¼Œæ¯”å¦‚æ‹”ç½‘çº¿ï¼ŒTCPçš„FINæ¶ˆæ¯æ¥ä¸åŠå‘é€ï¼Œå¯¹æ–¹æ”¶ä¸åˆ°æ–­å¼€äº‹ä»¶ï¼Œæ­¤æ—¶éœ€è¦å¿ƒè·³æ¥å¸®åŠ©æ£€æŸ¥è¿æ¥æ˜¯å¦å·²æ–­å¼€ 2.0.10ä»¥ä¸Šç‰ˆæœ¬ telnet telnet string å¯é€‰ æœåŠ¡æ²»ç† æ‰€æ”¯æŒçš„telnetå‘½ä»¤ï¼Œå¤šä¸ªå‘½ä»¤ç”¨é€—å·åˆ†éš” 2.0.5ä»¥ä¸Šç‰ˆæœ¬ register register boolean å¯é€‰ TRUE æœåŠ¡æ²»ç† è¯¥åè®®çš„æœåŠ¡æ˜¯å¦æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ 2.0.8ä»¥ä¸Šç‰ˆæœ¬ contextpath contextpath String å¯é€‰ ç¼ºçœä¸ºç©ºä¸² æœåŠ¡æ²»ç† 2.0.6ä»¥ä¸Šç‰ˆæœ¬ dubbo:registry(dubbo:registry)æ³¨å†Œä¸­å¿ƒé…ç½®ã€‚å¯¹åº”çš„é…ç½®ç±»ï¼š com.alibaba.dubbo.config.RegistryConfigã€‚åŒæ—¶å¦‚æœæœ‰å¤šä¸ªä¸åŒçš„æ³¨å†Œä¸­å¿ƒï¼Œå¯ä»¥å£°æ˜å¤šä¸ª dubbo:registry æ ‡ç­¾ï¼Œå¹¶åœ¨ dubbo:service æˆ– dubbo:reference çš„ registry å±æ€§æŒ‡å®šä½¿ç”¨çš„æ³¨å†Œä¸­å¿ƒã€‚ å±æ€§ å¯¹åº”URLå‚æ•° ç±»å‹ æ˜¯å¦å¿…å¡« ç¼ºçœå€¼ ä½œç”¨ æè¿° å…¼å®¹æ€§ id string å¯é€‰ é…ç½®å…³è” æ³¨å†Œä¸­å¿ƒå¼•ç”¨BeanIdï¼Œå¯ä»¥åœ¨dubbo:serviceregistry=\"\"æˆ–dubbo:referenceregistry=\"\"ä¸­å¼•ç”¨æ­¤ID 1.0.16ä»¥ä¸Šç‰ˆæœ¬ address host:port string å¿…å¡« æœåŠ¡å‘ç° æ³¨å†Œä¸­å¿ƒæœåŠ¡å™¨åœ°å€ï¼Œå¦‚æœåœ°å€æ²¡æœ‰ç«¯å£ç¼ºçœä¸º9090ï¼ŒåŒä¸€é›†ç¾¤å†…çš„å¤šä¸ªåœ°å€ç”¨é€—å·åˆ†éš”ï¼Œå¦‚ï¼šip:port,ip:portï¼Œä¸åŒé›†ç¾¤çš„æ³¨å†Œä¸­å¿ƒï¼Œè¯·é…ç½®å¤šä¸ªdubbo:registryæ ‡ç­¾ 1.0.16ä»¥ä¸Šç‰ˆæœ¬ protocol string å¯é€‰ dubbo æœåŠ¡å‘ç° æ³¨åŒä¸­å¿ƒåœ°å€åè®®ï¼Œæ”¯æŒdubbo,http,localä¸‰ç§åè®®ï¼Œåˆ†åˆ«è¡¨ç¤ºï¼Œdubboåœ°å€ï¼Œhttpåœ°å€ï¼Œæœ¬åœ°æ³¨å†Œä¸­å¿ƒ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ port int å¯é€‰ 9090 æœåŠ¡å‘ç° æ³¨å†Œä¸­å¿ƒç¼ºçœç«¯å£ï¼Œå½“addressæ²¡æœ‰å¸¦ç«¯å£æ—¶ä½¿ç”¨æ­¤ç«¯å£åšä¸ºç¼ºçœå€¼ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ username string å¯é€‰ æœåŠ¡æ²»ç† ç™»å½•æ³¨å†Œä¸­å¿ƒç”¨æˆ·åï¼Œå¦‚æœæ³¨å†Œä¸­å¿ƒä¸éœ€è¦éªŒè¯å¯ä¸å¡« 2.0.0ä»¥ä¸Šç‰ˆæœ¬ password string å¯é€‰ æœåŠ¡æ²»ç† ç™»å½•æ³¨å†Œä¸­å¿ƒå¯†ç ï¼Œå¦‚æœæ³¨å†Œä¸­å¿ƒä¸éœ€è¦éªŒè¯å¯ä¸å¡« 2.0.0ä»¥ä¸Šç‰ˆæœ¬ transport registry.transporter string å¯é€‰ netty æ€§èƒ½è°ƒä¼˜ ç½‘ç»œä¼ è¾“æ–¹å¼ï¼Œå¯é€‰mina,netty 2.0.0ä»¥ä¸Šç‰ˆæœ¬ timeout registry.timeout int å¯é€‰ 5000 æ€§èƒ½è°ƒä¼˜ æ³¨å†Œä¸­å¿ƒè¯·æ±‚è¶…æ—¶æ—¶é—´(æ¯«ç§’) 2.0.0ä»¥ä¸Šç‰ˆæœ¬ session registry.session int å¯é€‰ 60000 æ€§èƒ½è°ƒä¼˜ æ³¨å†Œä¸­å¿ƒä¼šè¯è¶…æ—¶æ—¶é—´(æ¯«ç§’)ï¼Œç”¨äºæ£€æµ‹æä¾›è€…éæ­£å¸¸æ–­çº¿åçš„è„æ•°æ®ï¼Œæ¯”å¦‚ç”¨å¿ƒè·³æ£€æµ‹çš„å®ç°ï¼Œæ­¤æ—¶é—´å°±æ˜¯å¿ƒè·³é—´éš”ï¼Œä¸åŒæ³¨å†Œä¸­å¿ƒå®ç°ä¸ä¸€æ ·ã€‚ 2.1.0ä»¥ä¸Šç‰ˆæœ¬ file registry.file string å¯é€‰ æœåŠ¡æ²»ç† ä½¿ç”¨æ–‡ä»¶ç¼“å­˜æ³¨å†Œä¸­å¿ƒåœ°å€åˆ—è¡¨åŠæœåŠ¡æä¾›è€…åˆ—è¡¨ï¼Œåº”ç”¨é‡å¯æ—¶å°†åŸºäºæ­¤æ–‡ä»¶æ¢å¤ï¼Œæ³¨æ„ï¼šä¸¤ä¸ªæ³¨å†Œä¸­å¿ƒä¸èƒ½ä½¿ç”¨åŒä¸€æ–‡ä»¶å­˜å‚¨ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ wait registry.wait int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ åœæ­¢æ—¶ç­‰å¾…é€šçŸ¥å®Œæˆæ—¶é—´(æ¯«ç§’) 2.0.0ä»¥ä¸Šç‰ˆæœ¬ check check boolean å¯é€‰ true æœåŠ¡æ²»ç† æ³¨å†Œä¸­å¿ƒä¸å­˜åœ¨æ—¶ï¼Œæ˜¯å¦æŠ¥é”™ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ register register boolean å¯é€‰ true æœåŠ¡æ²»ç† æ˜¯å¦å‘æ­¤æ³¨å†Œä¸­å¿ƒæ³¨å†ŒæœåŠ¡ï¼Œå¦‚æœè®¾ä¸ºfalseï¼Œå°†åªè®¢é˜…ï¼Œä¸æ³¨å†Œ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ subscribe subscribe boolean å¯é€‰ true æœåŠ¡æ²»ç† æ˜¯å¦å‘æ­¤æ³¨å†Œä¸­å¿ƒè®¢é˜…æœåŠ¡ï¼Œå¦‚æœè®¾ä¸ºfalseï¼Œå°†åªæ³¨å†Œï¼Œä¸è®¢é˜… 2.0.5ä»¥ä¸Šç‰ˆæœ¬ dynamic dynamic boolean å¯é€‰ true æœåŠ¡æ²»ç† æœåŠ¡æ˜¯å¦åŠ¨æ€æ³¨å†Œï¼Œå¦‚æœè®¾ä¸ºfalseï¼Œæ³¨å†Œåå°†æ˜¾ç¤ºådisableçŠ¶æ€ï¼Œéœ€äººå·¥å¯ç”¨ï¼Œå¹¶ä¸”æœåŠ¡æä¾›è€…åœæ­¢æ—¶ï¼Œä¹Ÿä¸ä¼šè‡ªåŠ¨å–æ¶ˆå†Œï¼Œéœ€äººå·¥ç¦ç”¨ã€‚ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ dubbo:monitorç›‘æ§ä¸­å¿ƒé…ç½®ã€‚å¯¹åº”çš„é…ç½®ç±»ï¼š com.alibaba.dubbo.config.MonitorConfig å±æ€§ å¯¹åº”URLå‚æ•° ç±»å‹ æ˜¯å¦å¿…å¡« ç¼ºçœå€¼ ä½œç”¨ æè¿° å…¼å®¹æ€§ protocol protocol string å¯é€‰ dubbo æœåŠ¡æ²»ç† ç›‘æ§ä¸­å¿ƒåè®®ï¼Œå¦‚æœä¸ºprotocol&#x3D;â€registryâ€ï¼Œè¡¨ç¤ºä»æ³¨å†Œä¸­å¿ƒå‘ç°ç›‘æ§ä¸­å¿ƒåœ°å€ï¼Œå¦åˆ™ç›´è¿ç›‘æ§ä¸­å¿ƒã€‚ 2.0.9ä»¥ä¸Šç‰ˆæœ¬ address string å¯é€‰ N&#x2F;A æœåŠ¡æ²»ç† ç›´è¿ç›‘æ§ä¸­å¿ƒæœåŠ¡å™¨åœ°å€ï¼Œaddress&#x3D;â€10.20.130.230:12080â€ 1.0.16ä»¥ä¸Šç‰ˆæœ¬ dubbo:applicationdubbo:applicationåº”ç”¨ä¿¡æ¯é…ç½®ã€‚å¯¹åº”çš„é…ç½®ç±»ï¼šcom.alibaba.dubbo.config.ApplicationConfig å±æ€§ å¯¹åº”URLå‚æ•° ç±»å‹ æ˜¯å¦å¿…å¡« ç¼ºçœå€¼ ä½œç”¨ æè¿° å…¼å®¹æ€§ name application string å¿…å¡« æœåŠ¡æ²»ç† å½“å‰åº”ç”¨åç§°ï¼Œç”¨äºæ³¨å†Œä¸­å¿ƒè®¡ç®—åº”ç”¨é—´ä¾èµ–å…³ç³»ï¼Œæ³¨æ„ï¼šæ¶ˆè´¹è€…å’Œæä¾›è€…åº”ç”¨åä¸è¦ä¸€æ ·ï¼Œæ­¤å‚æ•°ä¸æ˜¯åŒ¹é…æ¡ä»¶ï¼Œä½ å½“å‰é¡¹ç›®å«ä»€ä¹ˆåå­—å°±å¡«ä»€ä¹ˆï¼Œå’Œæä¾›è€…æ¶ˆè´¹è€…è§’è‰²æ— å…³ï¼Œæ¯”å¦‚ï¼škylinåº”ç”¨è°ƒç”¨äº†morganåº”ç”¨çš„æœåŠ¡ï¼Œåˆ™kyliné¡¹ç›®é…æˆkylinï¼Œmorgané¡¹ç›®é…æˆmorganï¼Œå¯èƒ½kylinä¹Ÿæä¾›å…¶å®ƒæœåŠ¡ç»™åˆ«äººä½¿ç”¨ï¼Œä½†kyliné¡¹ç›®æ°¸è¿œé…æˆkylinï¼Œè¿™æ ·æ³¨å†Œä¸­å¿ƒå°†æ˜¾ç¤ºkylinä¾èµ–äºmorgan 1.0.16ä»¥ä¸Šç‰ˆæœ¬ version application.version string å¯é€‰ æœåŠ¡æ²»ç† å½“å‰åº”ç”¨çš„ç‰ˆæœ¬ 2.2.0ä»¥ä¸Šç‰ˆæœ¬ owner owner string å¯é€‰ æœåŠ¡æ²»ç† åº”ç”¨è´Ÿè´£äººï¼Œç”¨äºæœåŠ¡æ²»ç†ï¼Œè¯·å¡«å†™è´Ÿè´£äººå…¬å¸é‚®ç®±å‰ç¼€ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ organization organization string å¯é€‰ æœåŠ¡æ²»ç† ç»„ç»‡åç§°(BUæˆ–éƒ¨é—¨)ï¼Œç”¨äºæ³¨å†Œä¸­å¿ƒåŒºåˆ†æœåŠ¡æ¥æºï¼Œæ­¤é…ç½®é¡¹å»ºè®®ä¸è¦ä½¿ç”¨autoconfigï¼Œç›´æ¥å†™æ­»åœ¨é…ç½®ä¸­ï¼Œæ¯”å¦‚china,intl,itu,crm,asc,dw,aliexpressç­‰ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ architecture architecture string å¯é€‰ æœåŠ¡æ²»ç† ç”¨äºæœåŠ¡åˆ†å±‚å¯¹åº”çš„æ¶æ„ã€‚å¦‚ï¼Œintlã€chinaã€‚ä¸åŒçš„æ¶æ„ä½¿ç”¨ä¸åŒçš„åˆ†å±‚ã€‚ 2.0.7ä»¥ä¸Šç‰ˆæœ¬ environment environment string å¯é€‰ æœåŠ¡æ²»ç† åº”ç”¨ç¯å¢ƒï¼Œå¦‚ï¼šdevelop&#x2F;test&#x2F;productï¼Œä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„ç¼ºçœå€¼ï¼Œä»¥åŠä½œä¸ºåªç”¨äºå¼€å‘æµ‹è¯•åŠŸèƒ½çš„é™åˆ¶æ¡ä»¶ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ compiler compiler string å¯é€‰ javassist æ€§èƒ½ä¼˜åŒ– Javaå­—èŠ‚ç ç¼–è¯‘å™¨ï¼Œç”¨äºåŠ¨æ€ç±»çš„ç”Ÿæˆï¼Œå¯é€‰ï¼šjdkæˆ–javassist 2.1.0ä»¥ä¸Šç‰ˆæœ¬ logger logger string å¯é€‰ slf4j æ€§èƒ½ä¼˜åŒ– æ—¥å¿—è¾“å‡ºæ–¹å¼ï¼Œå¯é€‰ï¼šslf4j,jcl,log4j,jdk 2.2.0ä»¥ä¸Šç‰ˆæœ¬ dubbo:moduledubbo:moduleæ¨¡å—ä¿¡æ¯é…ç½®ã€‚å¯¹åº”çš„é…ç½®ç±» com.alibaba.dubbo.config.ModuleConfig å±æ€§ å¯¹åº”URLå‚æ•° ç±»å‹ æ˜¯å¦å¿…å¡« ç¼ºçœå€¼ ä½œç”¨ æè¿° å…¼å®¹æ€§ name module string å¿…å¡« æœåŠ¡æ²»ç† å½“å‰æ¨¡å—åç§°ï¼Œç”¨äºæ³¨å†Œä¸­å¿ƒè®¡ç®—æ¨¡å—é—´ä¾èµ–å…³ç³» 2.2.0ä»¥ä¸Šç‰ˆæœ¬ version module.version string å¯é€‰ æœåŠ¡æ²»ç† å½“å‰æ¨¡å—çš„ç‰ˆæœ¬ 2.2.0ä»¥ä¸Šç‰ˆæœ¬ owner owner string å¯é€‰ æœåŠ¡æ²»ç† æ¨¡å—è´Ÿè´£äººï¼Œç”¨äºæœåŠ¡æ²»ç†ï¼Œè¯·å¡«å†™è´Ÿè´£äººå…¬å¸é‚®ç®±å‰ç¼€ 2.2.0ä»¥ä¸Šç‰ˆæœ¬ organization organization string å¯é€‰ æœåŠ¡æ²»ç† ç»„ç»‡åç§°(BUæˆ–éƒ¨é—¨)ï¼Œç”¨äºæ³¨å†Œä¸­å¿ƒåŒºåˆ†æœåŠ¡æ¥æºï¼Œæ­¤é…ç½®é¡¹å»ºè®®ä¸è¦ä½¿ç”¨autoconfigï¼Œç›´æ¥å†™æ­»åœ¨é…ç½®ä¸­ï¼Œæ¯”å¦‚china,intl,itu,crm,asc,dw,aliexpressç­‰ 2.2.0ä»¥ä¸Šç‰ˆæœ¬ dubbo:provider(<dubboï¼šprovider>)æœåŠ¡æä¾›è€…ç¼ºçœå€¼é…ç½®ã€‚å¯¹åº”çš„é…ç½®ç±»ï¼š com.alibaba.dubbo.config.ProviderConfigã€‚åŒæ—¶è¯¥æ ‡ç­¾ä¸º dubbo:service å’Œ dubbo:protocol æ ‡ç­¾çš„ç¼ºçœå€¼è®¾ç½®ã€‚ï¼ˆå°±æ˜¯serviceå’Œserviceå¯¹åº”çš„protocolçš„é»˜è®¤é…ç½®ï¼‰ å±æ€§ å¯¹åº”URLå‚æ•° ç±»å‹ æ˜¯å¦å¿…å¡« ç¼ºçœå€¼ ä½œç”¨ æè¿° å…¼å®¹æ€§ id string å¯é€‰ dubbo é…ç½®å…³è” åè®®BeanIdï¼Œå¯ä»¥åœ¨dubbo:serviceproivder=\"\"ä¸­å¼•ç”¨æ­¤ID 1.0.16ä»¥ä¸Šç‰ˆæœ¬ protocol string å¯é€‰ dubbo æ€§èƒ½è°ƒä¼˜ åè®®åç§° 1.0.16ä»¥ä¸Šç‰ˆæœ¬ host string å¯é€‰ è‡ªåŠ¨æŸ¥æ‰¾æœ¬æœºIP æœåŠ¡å‘ç° æœåŠ¡ä¸»æœºåï¼Œå¤šç½‘å¡é€‰æ‹©æˆ–æŒ‡å®šVIPåŠåŸŸåæ—¶ä½¿ç”¨ï¼Œä¸ºç©ºåˆ™è‡ªåŠ¨æŸ¥æ‰¾æœ¬æœºIPï¼Œå»ºè®®ä¸è¦é…ç½®ï¼Œè®©Dubboè‡ªåŠ¨è·å–æœ¬æœºIP 1.0.16ä»¥ä¸Šç‰ˆæœ¬ threads threads int å¯é€‰ 200 æ€§èƒ½è°ƒä¼˜ æœåŠ¡çº¿ç¨‹æ± å¤§å°(å›ºå®šå¤§å°) 1.0.16ä»¥ä¸Šç‰ˆæœ¬ payload payload int å¯é€‰ 8388608(&#x3D;8M) æ€§èƒ½è°ƒä¼˜ è¯·æ±‚åŠå“åº”æ•°æ®åŒ…å¤§å°é™åˆ¶ï¼Œå•ä½ï¼šå­—èŠ‚ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ path string å¯é€‰ æœåŠ¡å‘ç° æä¾›è€…ä¸Šä¸‹æ–‡è·¯å¾„ï¼Œä¸ºæœåŠ¡pathçš„å‰ç¼€ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ server server string å¯é€‰ dubboåè®®ç¼ºçœä¸ºnettyï¼Œhttpåè®®ç¼ºçœä¸ºservlet æ€§èƒ½è°ƒä¼˜ åè®®çš„æœåŠ¡å™¨ç«¯å®ç°ç±»å‹ï¼Œæ¯”å¦‚ï¼šdubboåè®®çš„mina,nettyç­‰ï¼Œhttpåè®®çš„jetty,servletç­‰ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ client client string å¯é€‰ dubboåè®®ç¼ºçœä¸ºnetty æ€§èƒ½è°ƒä¼˜ åè®®çš„å®¢æˆ·ç«¯å®ç°ç±»å‹ï¼Œæ¯”å¦‚ï¼šdubboåè®®çš„mina,nettyç­‰ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ codec codec string å¯é€‰ dubbo æ€§èƒ½è°ƒä¼˜ åè®®ç¼–ç æ–¹å¼ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ serialization serialization string å¯é€‰ dubboåè®®ç¼ºçœä¸ºhessian2ï¼Œrmiåè®®ç¼ºçœä¸ºjavaï¼Œhttpåè®®ç¼ºçœä¸ºjson æ€§èƒ½è°ƒä¼˜ åè®®åºåˆ—åŒ–æ–¹å¼ï¼Œå½“åè®®æ”¯æŒå¤šç§åºåˆ—åŒ–æ–¹å¼æ—¶ä½¿ç”¨ï¼Œæ¯”å¦‚ï¼šdubboåè®®çš„dubbo,hessian2,java,compactedjavaï¼Œä»¥åŠhttpåè®®çš„json,xmlç­‰ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ default boolean å¯é€‰ FALSE é…ç½®å…³è” æ˜¯å¦ä¸ºç¼ºçœåè®®ï¼Œç”¨äºå¤šåè®® 1.0.16ä»¥ä¸Šç‰ˆæœ¬ filter service.filter string å¯é€‰ æ€§èƒ½è°ƒä¼˜ æœåŠ¡æä¾›æ–¹è¿œç¨‹è°ƒç”¨è¿‡ç¨‹æ‹¦æˆªå™¨åç§°ï¼Œå¤šä¸ªåç§°ç”¨é€—å·åˆ†éš” 2.0.5ä»¥ä¸Šç‰ˆæœ¬ listener exporter.listener string å¯é€‰ æ€§èƒ½è°ƒä¼˜ æœåŠ¡æä¾›æ–¹å¯¼å‡ºæœåŠ¡ç›‘å¬å™¨åç§°ï¼Œå¤šä¸ªåç§°ç”¨é€—å·åˆ†éš” 2.0.5ä»¥ä¸Šç‰ˆæœ¬ threadpool threadpool string å¯é€‰ fixed æ€§èƒ½è°ƒä¼˜ çº¿ç¨‹æ± ç±»å‹ï¼Œå¯é€‰ï¼šfixed&#x2F;cached 2.0.5ä»¥ä¸Šç‰ˆæœ¬ accepts accepts int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ æœåŠ¡æä¾›è€…æœ€å¤§å¯æ¥å—è¿æ¥æ•° 2.0.5ä»¥ä¸Šç‰ˆæœ¬ version version string å¯é€‰ 0.0.0 æœåŠ¡å‘ç° æœåŠ¡ç‰ˆæœ¬ï¼Œå»ºè®®ä½¿ç”¨ä¸¤ä½æ•°å­—ç‰ˆæœ¬ï¼Œå¦‚ï¼š1.0ï¼Œé€šå¸¸åœ¨æ¥å£ä¸å…¼å®¹æ—¶ç‰ˆæœ¬å·æ‰éœ€è¦å‡çº§ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ group group string å¯é€‰ æœåŠ¡å‘ç° æœåŠ¡åˆ†ç»„ï¼Œå½“ä¸€ä¸ªæ¥å£æœ‰å¤šä¸ªå®ç°ï¼Œå¯ä»¥ç”¨åˆ†ç»„åŒºåˆ† 2.0.5ä»¥ä¸Šç‰ˆæœ¬ delay delay int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ å»¶è¿Ÿæ³¨å†ŒæœåŠ¡æ—¶é—´(æ¯«ç§’)ï¼Œè®¾ä¸º1æ—¶ï¼Œè¡¨ç¤ºå»¶è¿Ÿåˆ°Springå®¹å™¨åˆå§‹åŒ–å®Œæˆæ—¶æš´éœ²æœåŠ¡ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ timeout default.timeout int å¯é€‰ 1000 æ€§èƒ½è°ƒä¼˜ è¿œç¨‹æœåŠ¡è°ƒç”¨è¶…æ—¶æ—¶é—´(æ¯«ç§’) 2.0.5ä»¥ä¸Šç‰ˆæœ¬ retries default.retries int å¯é€‰ 2 æ€§èƒ½è°ƒä¼˜ è¿œç¨‹æœåŠ¡è°ƒç”¨é‡è¯•æ¬¡æ•°ï¼Œä¸åŒ…æ‹¬ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œä¸éœ€è¦é‡è¯•è¯·è®¾ä¸º0 2.0.5ä»¥ä¸Šç‰ˆæœ¬ connections default.connections int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ å¯¹æ¯ä¸ªæä¾›è€…çš„æœ€å¤§è¿æ¥æ•°ï¼Œrmiã€httpã€hessianç­‰çŸ­è¿æ¥åè®®è¡¨ç¤ºé™åˆ¶è¿æ¥æ•°ï¼Œdubboç­‰é•¿è¿æ¥åè¡¨ç¤ºå»ºç«‹çš„é•¿è¿æ¥ä¸ªæ•° 2.0.5ä»¥ä¸Šç‰ˆæœ¬ loadbalance default.loadbalance string å¯é€‰ random æ€§èƒ½è°ƒä¼˜ è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå¯é€‰å€¼ï¼šrandom,roundrobin,leastactiveï¼Œåˆ†åˆ«è¡¨ç¤ºï¼šéšæœºï¼Œè½®å¾ªï¼Œæœ€å°‘æ´»è·ƒè°ƒç”¨ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ async default.async boolean å¯é€‰ FALSE æ€§èƒ½è°ƒä¼˜ æ˜¯å¦ç¼ºçœå¼‚æ­¥æ‰§è¡Œï¼Œä¸å¯é å¼‚æ­¥ï¼Œåªæ˜¯å¿½ç•¥è¿”å›å€¼ï¼Œä¸é˜»å¡æ‰§è¡Œçº¿ç¨‹ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ stub stub boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† è®¾ä¸ºtrueï¼Œè¡¨ç¤ºä½¿ç”¨ç¼ºçœä»£ç†ç±»åï¼Œå³ï¼šæ¥å£å+Localåç¼€ã€‚ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ mock mock boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† è®¾ä¸ºtrueï¼Œè¡¨ç¤ºä½¿ç”¨ç¼ºçœMockç±»åï¼Œå³ï¼šæ¥å£å+Mockåç¼€ã€‚ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ token token boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† ä»¤ç‰ŒéªŒè¯ï¼Œä¸ºç©ºè¡¨ç¤ºä¸å¼€å¯ï¼Œå¦‚æœä¸ºtrueï¼Œè¡¨ç¤ºéšæœºç”ŸæˆåŠ¨æ€ä»¤ç‰Œ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ registry registry string å¯é€‰ ç¼ºçœå‘æ‰€æœ‰registryæ³¨å†Œ é…ç½®å…³è” å‘æŒ‡å®šæ³¨å†Œä¸­å¿ƒæ³¨å†Œï¼Œåœ¨å¤šä¸ªæ³¨å†Œä¸­å¿ƒæ—¶ä½¿ç”¨ï¼Œå€¼ä¸ºdubbo:registryçš„idå±æ€§ï¼Œå¤šä¸ªæ³¨å†Œä¸­å¿ƒIDç”¨é€—å·åˆ†éš”ï¼Œå¦‚æœä¸æƒ³å°†è¯¥æœåŠ¡æ³¨å†Œåˆ°ä»»ä½•registryï¼Œå¯å°†å€¼è®¾ä¸ºN&#x2F;A 2.0.5ä»¥ä¸Šç‰ˆæœ¬ dynamic dynamic boolean å¯é€‰ TRUE æœåŠ¡æ²»ç† æœåŠ¡æ˜¯å¦åŠ¨æ€æ³¨å†Œï¼Œå¦‚æœè®¾ä¸ºfalseï¼Œæ³¨å†Œåå°†æ˜¾ç¤ºådisableçŠ¶æ€ï¼Œéœ€äººå·¥å¯ç”¨ï¼Œå¹¶ä¸”æœåŠ¡æä¾›è€…åœæ­¢æ—¶ï¼Œä¹Ÿä¸ä¼šè‡ªåŠ¨å–æ¶ˆå†Œï¼Œéœ€äººå·¥ç¦ç”¨ã€‚ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ accesslog accesslog string&#x2F;boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† è®¾ä¸ºtrueï¼Œå°†å‘loggerä¸­è¾“å‡ºè®¿é—®æ—¥å¿—ï¼Œä¹Ÿå¯å¡«å†™è®¿é—®æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œç›´æ¥æŠŠè®¿é—®æ—¥å¿—è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ owner owner string å¯é€‰ æœåŠ¡æ²»ç† æœåŠ¡è´Ÿè´£äººï¼Œç”¨äºæœåŠ¡æ²»ç†ï¼Œè¯·å¡«å†™è´Ÿè´£äººå…¬å¸é‚®ç®±å‰ç¼€ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ document document string å¯é€‰ æœåŠ¡æ²»ç† æœåŠ¡æ–‡æ¡£URL 2.0.5ä»¥ä¸Šç‰ˆæœ¬ weight weight int å¯é€‰ æ€§èƒ½è°ƒä¼˜ æœåŠ¡æƒé‡ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ executes executes int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ æœåŠ¡æä¾›è€…æ¯æœåŠ¡æ¯æ–¹æ³•æœ€å¤§å¯å¹¶è¡Œæ‰§è¡Œè¯·æ±‚æ•° 2.0.5ä»¥ä¸Šç‰ˆæœ¬ actives default.actives int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ æ¯æœåŠ¡æ¶ˆè´¹è€…æ¯æœåŠ¡æ¯æ–¹æ³•æœ€å¤§å¹¶å‘è°ƒç”¨æ•° 2.0.5ä»¥ä¸Šç‰ˆæœ¬ proxy proxy string å¯é€‰ javassist æ€§èƒ½è°ƒä¼˜ ç”ŸæˆåŠ¨æ€ä»£ç†æ–¹å¼ï¼Œå¯é€‰ï¼šjdk&#x2F;javassist 2.0.5ä»¥ä¸Šç‰ˆæœ¬ cluster default.cluster string å¯é€‰ failover æ€§èƒ½è°ƒä¼˜ é›†ç¾¤æ–¹å¼ï¼Œå¯é€‰ï¼šfailover&#x2F;failfast&#x2F;failsafe&#x2F;failback&#x2F;forking 2.0.5ä»¥ä¸Šç‰ˆæœ¬ deprecated deprecated boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† æœåŠ¡æ˜¯å¦è¿‡æ—¶ï¼Œå¦‚æœè®¾ä¸ºtrueï¼Œæ¶ˆè´¹æ–¹å¼•ç”¨æ—¶å°†æ‰“å°æœåŠ¡è¿‡æ—¶è­¦å‘Šerroræ—¥å¿— 2.0.5ä»¥ä¸Šç‰ˆæœ¬ queues queues int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ çº¿ç¨‹æ± é˜Ÿåˆ—å¤§å°ï¼Œå½“çº¿ç¨‹æ± æ»¡æ—¶ï¼Œæ’é˜Ÿç­‰å¾…æ‰§è¡Œçš„é˜Ÿåˆ—å¤§å°ï¼Œå»ºè®®ä¸è¦è®¾ç½®ï¼Œå½“çº¿ç¨‹ç¨‹æ± æ—¶åº”ç«‹å³å¤±è´¥ï¼Œé‡è¯•å…¶å®ƒæœåŠ¡æä¾›æœºå™¨ï¼Œè€Œä¸æ˜¯æ’é˜Ÿï¼Œé™¤éæœ‰ç‰¹æ®Šéœ€æ±‚ã€‚ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ charset charset string å¯é€‰ UTF8 æ€§èƒ½è°ƒä¼˜ åºåˆ—åŒ–ç¼–ç  2.0.5ä»¥ä¸Šç‰ˆæœ¬ buffer buffer int å¯é€‰ 8192 æ€§èƒ½è°ƒä¼˜ ç½‘ç»œè¯»å†™ç¼“å†²åŒºå¤§å° 2.0.5ä»¥ä¸Šç‰ˆæœ¬ iothreads iothreads int å¯é€‰ CPU+1 æ€§èƒ½è°ƒä¼˜ IOçº¿ç¨‹æ± ï¼Œæ¥æ”¶ç½‘ç»œè¯»å†™ä¸­æ–­ï¼Œä»¥åŠåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œä¸å¤„ç†ä¸šåŠ¡ï¼Œä¸šåŠ¡çº¿ç¨‹æ± å‚è§threadsé…ç½®ï¼Œæ­¤çº¿ç¨‹æ± å’ŒCPUç›¸å…³ï¼Œä¸å»ºè®®é…ç½®ã€‚ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ telnet telnet string å¯é€‰ æœåŠ¡æ²»ç† æ‰€æ”¯æŒçš„telnetå‘½ä»¤ï¼Œå¤šä¸ªå‘½ä»¤ç”¨é€—å·åˆ†éš” 2.0.5ä»¥ä¸Šç‰ˆæœ¬ dubbo:service contextpath contextpath String å¯é€‰ ç¼ºçœä¸ºç©ºä¸² æœåŠ¡æ²»ç† layer layer string å¯é€‰ æœåŠ¡æ²»ç† æœåŠ¡æä¾›è€…æ‰€åœ¨çš„åˆ†å±‚ã€‚å¦‚ï¼šbizã€daoã€intl:webã€china:actonã€‚ 2.0.7ä»¥ä¸Šç‰ˆæœ¬ dubbo:consumer(dubbo:consumer)æœåŠ¡æ¶ˆè´¹è€…ç¼ºçœå€¼é…ç½®ã€‚é…ç½®ç±»ï¼š com.alibaba.dubbo.config.ConsumerConfig ã€‚åŒæ—¶è¯¥æ ‡ç­¾ä¸º dubbo:reference æ ‡ç­¾çš„ç¼ºçœå€¼è®¾ç½®ã€‚ å±æ€§ å¯¹åº”URLå‚æ•° ç±»å‹ æ˜¯å¦å¿…å¡« ç¼ºçœå€¼ ä½œç”¨ æè¿° å…¼å®¹æ€§ timeout default.timeout int å¯é€‰ 1000 æ€§èƒ½è°ƒä¼˜ è¿œç¨‹æœåŠ¡è°ƒç”¨è¶…æ—¶æ—¶é—´(æ¯«ç§’) 1.0.16ä»¥ä¸Šç‰ˆæœ¬ retries default.retries int å¯é€‰ 2 æ€§èƒ½è°ƒä¼˜ è¿œç¨‹æœåŠ¡è°ƒç”¨é‡è¯•æ¬¡æ•°ï¼Œä¸åŒ…æ‹¬ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œä¸éœ€è¦é‡è¯•è¯·è®¾ä¸º0 1.0.16ä»¥ä¸Šç‰ˆæœ¬ loadbalance default.loadbalance string å¯é€‰ random æ€§èƒ½è°ƒä¼˜ è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå¯é€‰å€¼ï¼šrandom,roundrobin,leastactiveï¼Œåˆ†åˆ«è¡¨ç¤ºï¼šéšæœºï¼Œè½®å¾ªï¼Œæœ€å°‘æ´»è·ƒè°ƒç”¨ 1.0.16ä»¥ä¸Šç‰ˆæœ¬ async default.async boolean å¯é€‰ FALSE æ€§èƒ½è°ƒä¼˜ æ˜¯å¦ç¼ºçœå¼‚æ­¥æ‰§è¡Œï¼Œä¸å¯é å¼‚æ­¥ï¼Œåªæ˜¯å¿½ç•¥è¿”å›å€¼ï¼Œä¸é˜»å¡æ‰§è¡Œçº¿ç¨‹ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ connections default.connections int å¯é€‰ 100 æ€§èƒ½è°ƒä¼˜ æ¯ä¸ªæœåŠ¡å¯¹æ¯ä¸ªæä¾›è€…çš„æœ€å¤§è¿æ¥æ•°ï¼Œrmiã€httpã€hessianç­‰çŸ­è¿æ¥åè®®æ”¯æŒæ­¤é…ç½®ï¼Œdubboåè®®é•¿è¿æ¥ä¸æ”¯æŒæ­¤é…ç½® 1.0.16ä»¥ä¸Šç‰ˆæœ¬ generic generic boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† æ˜¯å¦ç¼ºçœæ³›åŒ–æ¥å£ï¼Œå¦‚æœä¸ºæ³›åŒ–æ¥å£ï¼Œå°†è¿”å›GenericService 2.0.0ä»¥ä¸Šç‰ˆæœ¬ check check boolean å¯é€‰ TRUE æœåŠ¡æ²»ç† å¯åŠ¨æ—¶æ£€æŸ¥æä¾›è€…æ˜¯å¦å­˜åœ¨ï¼ŒtrueæŠ¥é”™ï¼Œfalseå¿½ç•¥ 1.0.16ä»¥ä¸Šç‰ˆæœ¬ proxy proxy string å¯é€‰ javassist æ€§èƒ½è°ƒä¼˜ ç”ŸæˆåŠ¨æ€ä»£ç†æ–¹å¼ï¼Œå¯é€‰ï¼šjdk&#x2F;javassist 2.0.5ä»¥ä¸Šç‰ˆæœ¬ owner owner string å¯é€‰ æœåŠ¡æ²»ç† è°ƒç”¨æœåŠ¡è´Ÿè´£äººï¼Œç”¨äºæœåŠ¡æ²»ç†ï¼Œè¯·å¡«å†™è´Ÿè´£äººå…¬å¸é‚®ç®±å‰ç¼€ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ actives default.actives int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ æ¯æœåŠ¡æ¶ˆè´¹è€…æ¯æœåŠ¡æ¯æ–¹æ³•æœ€å¤§å¹¶å‘è°ƒç”¨æ•° 2.0.5ä»¥ä¸Šç‰ˆæœ¬ cluster default.cluster string å¯é€‰ failover æ€§èƒ½è°ƒä¼˜ é›†ç¾¤æ–¹å¼ï¼Œå¯é€‰ï¼šfailover&#x2F;failfast&#x2F;failsafe&#x2F;failback&#x2F;forking 2.0.5ä»¥ä¸Šç‰ˆæœ¬ filter reference.filter string å¯é€‰ æ€§èƒ½è°ƒä¼˜ æœåŠ¡æ¶ˆè´¹æ–¹è¿œç¨‹è°ƒç”¨è¿‡ç¨‹æ‹¦æˆªå™¨åç§°ï¼Œå¤šä¸ªåç§°ç”¨é€—å·åˆ†éš” 2.0.5ä»¥ä¸Šç‰ˆæœ¬ listener invoker.listener string å¯é€‰ æ€§èƒ½è°ƒä¼˜ æœåŠ¡æ¶ˆè´¹æ–¹å¼•ç”¨æœåŠ¡ç›‘å¬å™¨åç§°ï¼Œå¤šä¸ªåç§°ç”¨é€—å·åˆ†éš” 2.0.5ä»¥ä¸Šç‰ˆæœ¬ registry string å¯é€‰ ç¼ºçœå‘æ‰€æœ‰registryæ³¨å†Œ é…ç½®å…³è” å‘æŒ‡å®šæ³¨å†Œä¸­å¿ƒæ³¨å†Œï¼Œåœ¨å¤šä¸ªæ³¨å†Œä¸­å¿ƒæ—¶ä½¿ç”¨ï¼Œå€¼ä¸ºdubbo:registryçš„idå±æ€§ï¼Œå¤šä¸ªæ³¨å†Œä¸­å¿ƒIDç”¨é€—å·åˆ†éš”ï¼Œå¦‚æœä¸æƒ³å°†è¯¥æœåŠ¡æ³¨å†Œåˆ°ä»»ä½•registryï¼Œå¯å°†å€¼è®¾ä¸ºN&#x2F;A 2.0.5ä»¥ä¸Šç‰ˆæœ¬ layer layer string å¯é€‰ æœåŠ¡æ²»ç† æœåŠ¡è°ƒç”¨è€…æ‰€åœ¨çš„åˆ†å±‚ã€‚å¦‚ï¼šbizã€daoã€intl:webã€china:actonã€‚ 2.0.7ä»¥ä¸Šç‰ˆæœ¬ init init boolean å¯é€‰ FALSE æ€§èƒ½è°ƒä¼˜ æ˜¯å¦åœ¨afterPropertiesSet()æ—¶é¥¥é¥¿åˆå§‹åŒ–å¼•ç”¨ï¼Œå¦åˆ™ç­‰åˆ°æœ‰äººæ³¨å…¥æˆ–å¼•ç”¨è¯¥å®ä¾‹æ—¶å†åˆå§‹åŒ–ã€‚ 2.0.10ä»¥ä¸Šç‰ˆæœ¬ cache cache string&#x2F;boolean å¯é€‰ æœåŠ¡æ²»ç† ä»¥è°ƒç”¨å‚æ•°ä¸ºkeyï¼Œç¼“å­˜è¿”å›ç»“æœï¼Œå¯é€‰ï¼šlru,threadlocal,jcacheç­‰ Dubbo2.1.0åŠå…¶ä»¥ä¸Šç‰ˆæœ¬æ”¯æŒ validation validation boolean å¯é€‰ æœåŠ¡æ²»ç† æ˜¯å¦å¯ç”¨JSR303æ ‡å‡†æ³¨è§£éªŒè¯ï¼Œå¦‚æœå¯ç”¨ï¼Œå°†å¯¹æ–¹æ³•å‚æ•°ä¸Šçš„æ³¨è§£è¿›è¡Œæ ¡éªŒ Dubbo2.1.0åŠå…¶ä»¥ä¸Šç‰ˆæœ¬æ”¯æŒ timeout default.timeout int å¯é€‰ 1000 æ€§èƒ½è°ƒä¼˜ è¿œç¨‹æœåŠ¡è°ƒç”¨è¶…æ—¶æ—¶é—´(æ¯«ç§’) 2.0.5ä»¥ä¸Šç‰ˆæœ¬ retries default.retries int å¯é€‰ 2 æ€§èƒ½è°ƒä¼˜ è¿œç¨‹æœåŠ¡è°ƒç”¨é‡è¯•æ¬¡æ•°ï¼Œä¸åŒ…æ‹¬ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œä¸éœ€è¦é‡è¯•è¯·è®¾ä¸º0 2.0.5ä»¥ä¸Šç‰ˆæœ¬ connections default.connections int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ å¯¹æ¯ä¸ªæä¾›è€…çš„æœ€å¤§è¿æ¥æ•°ï¼Œrmiã€httpã€hessianç­‰çŸ­è¿æ¥åè®®è¡¨ç¤ºé™åˆ¶è¿æ¥æ•°ï¼Œdubboç­‰é•¿è¿æ¥åè¡¨ç¤ºå»ºç«‹çš„é•¿è¿æ¥ä¸ªæ•° 2.0.5ä»¥ä¸Šç‰ˆæœ¬ loadbalance default.loadbalance string å¯é€‰ random æ€§èƒ½è°ƒä¼˜ è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå¯é€‰å€¼ï¼šrandom,roundrobin,leastactiveï¼Œåˆ†åˆ«è¡¨ç¤ºï¼šéšæœºï¼Œè½®å¾ªï¼Œæœ€å°‘æ´»è·ƒè°ƒç”¨ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ async default.async boolean å¯é€‰ FALSE æ€§èƒ½è°ƒä¼˜ æ˜¯å¦ç¼ºçœå¼‚æ­¥æ‰§è¡Œï¼Œä¸å¯é å¼‚æ­¥ï¼Œåªæ˜¯å¿½ç•¥è¿”å›å€¼ï¼Œä¸é˜»å¡æ‰§è¡Œçº¿ç¨‹ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ stub stub boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† è®¾ä¸ºtrueï¼Œè¡¨ç¤ºä½¿ç”¨ç¼ºçœä»£ç†ç±»åï¼Œå³ï¼šæ¥å£å+Localåç¼€ã€‚ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ mock mock boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† è®¾ä¸ºtrueï¼Œè¡¨ç¤ºä½¿ç”¨ç¼ºçœMockç±»åï¼Œå³ï¼šæ¥å£å+Mockåç¼€ã€‚ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ token token boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† ä»¤ç‰ŒéªŒè¯ï¼Œä¸ºç©ºè¡¨ç¤ºä¸å¼€å¯ï¼Œå¦‚æœä¸ºtrueï¼Œè¡¨ç¤ºéšæœºç”ŸæˆåŠ¨æ€ä»¤ç‰Œ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ registry registry string å¯é€‰ ç¼ºçœå‘æ‰€æœ‰registryæ³¨å†Œ é…ç½®å…³è” å‘æŒ‡å®šæ³¨å†Œä¸­å¿ƒæ³¨å†Œï¼Œåœ¨å¤šä¸ªæ³¨å†Œä¸­å¿ƒæ—¶ä½¿ç”¨ï¼Œå€¼ä¸ºdubbo:registryçš„idå±æ€§ï¼Œå¤šä¸ªæ³¨å†Œä¸­å¿ƒIDç”¨é€—å·åˆ†éš”ï¼Œå¦‚æœä¸æƒ³å°†è¯¥æœåŠ¡æ³¨å†Œåˆ°ä»»ä½•registryï¼Œå¯å°†å€¼è®¾ä¸ºN&#x2F;A 2.0.5ä»¥ä¸Šç‰ˆæœ¬ dynamic dynamic boolean å¯é€‰ TRUE æœåŠ¡æ²»ç† æœåŠ¡æ˜¯å¦åŠ¨æ€æ³¨å†Œï¼Œå¦‚æœè®¾ä¸ºfalseï¼Œæ³¨å†Œåå°†æ˜¾ç¤ºådisableçŠ¶æ€ï¼Œéœ€äººå·¥å¯ç”¨ï¼Œå¹¶ä¸”æœåŠ¡æä¾›è€…åœæ­¢æ—¶ï¼Œä¹Ÿä¸ä¼šè‡ªåŠ¨å–æ¶ˆå†Œï¼Œéœ€äººå·¥ç¦ç”¨ã€‚ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ accesslog accesslog string&#x2F;boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† è®¾ä¸ºtrueï¼Œå°†å‘loggerä¸­è¾“å‡ºè®¿é—®æ—¥å¿—ï¼Œä¹Ÿå¯å¡«å†™è®¿é—®æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œç›´æ¥æŠŠè®¿é—®æ—¥å¿—è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ owner owner string å¯é€‰ æœåŠ¡æ²»ç† æœåŠ¡è´Ÿè´£äººï¼Œç”¨äºæœåŠ¡æ²»ç†ï¼Œè¯·å¡«å†™è´Ÿè´£äººå…¬å¸é‚®ç®±å‰ç¼€ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ document document string å¯é€‰ æœåŠ¡æ²»ç† æœåŠ¡æ–‡æ¡£URL 2.0.5ä»¥ä¸Šç‰ˆæœ¬ weight weight int å¯é€‰ æ€§èƒ½è°ƒä¼˜ æœåŠ¡æƒé‡ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ executes executes int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ æœåŠ¡æä¾›è€…æ¯æœåŠ¡æ¯æ–¹æ³•æœ€å¤§å¯å¹¶è¡Œæ‰§è¡Œè¯·æ±‚æ•° 2.0.5ä»¥ä¸Šç‰ˆæœ¬ actives default.actives int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ æ¯æœåŠ¡æ¶ˆè´¹è€…æ¯æœåŠ¡æ¯æ–¹æ³•æœ€å¤§å¹¶å‘è°ƒç”¨æ•° 2.0.5ä»¥ä¸Šç‰ˆæœ¬ proxy proxy string å¯é€‰ javassist æ€§èƒ½è°ƒä¼˜ ç”ŸæˆåŠ¨æ€ä»£ç†æ–¹å¼ï¼Œå¯é€‰ï¼šjdk&#x2F;javassist 2.0.5ä»¥ä¸Šç‰ˆæœ¬ cluster default.cluster string å¯é€‰ failover æ€§èƒ½è°ƒä¼˜ é›†ç¾¤æ–¹å¼ï¼Œå¯é€‰ï¼šfailover&#x2F;failfast&#x2F;failsafe&#x2F;failback&#x2F;forking 2.0.5ä»¥ä¸Šç‰ˆæœ¬ deprecated deprecated boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† æœåŠ¡æ˜¯å¦è¿‡æ—¶ï¼Œå¦‚æœè®¾ä¸ºtrueï¼Œæ¶ˆè´¹æ–¹å¼•ç”¨æ—¶å°†æ‰“å°æœåŠ¡è¿‡æ—¶è­¦å‘Šerroræ—¥å¿— 2.0.5ä»¥ä¸Šç‰ˆæœ¬ queues queues int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ çº¿ç¨‹æ± é˜Ÿåˆ—å¤§å°ï¼Œå½“çº¿ç¨‹æ± æ»¡æ—¶ï¼Œæ’é˜Ÿç­‰å¾…æ‰§è¡Œçš„é˜Ÿåˆ—å¤§å°ï¼Œå»ºè®®ä¸è¦è®¾ç½®ï¼Œå½“çº¿ç¨‹ç¨‹æ± æ—¶åº”ç«‹å³å¤±è´¥ï¼Œé‡è¯•å…¶å®ƒæœåŠ¡æä¾›æœºå™¨ï¼Œè€Œä¸æ˜¯æ’é˜Ÿï¼Œé™¤éæœ‰ç‰¹æ®Šéœ€æ±‚ã€‚ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ charset charset string å¯é€‰ UTF8 æ€§èƒ½è°ƒä¼˜ åºåˆ—åŒ–ç¼–ç  2.0.5ä»¥ä¸Šç‰ˆæœ¬ buffer buffer int å¯é€‰ 8192 æ€§èƒ½è°ƒä¼˜ ç½‘ç»œè¯»å†™ç¼“å†²åŒºå¤§å° 2.0.5ä»¥ä¸Šç‰ˆæœ¬ iothreads iothreads int å¯é€‰ CPU+1 æ€§èƒ½è°ƒä¼˜ IOçº¿ç¨‹æ± ï¼Œæ¥æ”¶ç½‘ç»œè¯»å†™ä¸­æ–­ï¼Œä»¥åŠåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œä¸å¤„ç†ä¸šåŠ¡ï¼Œä¸šåŠ¡çº¿ç¨‹æ± å‚è§threadsé…ç½®ï¼Œæ­¤çº¿ç¨‹æ± å’ŒCPUç›¸å…³ï¼Œä¸å»ºè®®é…ç½®ã€‚ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ telnet telnet string å¯é€‰ æœåŠ¡æ²»ç† æ‰€æ”¯æŒçš„telnetå‘½ä»¤ï¼Œå¤šä¸ªå‘½ä»¤ç”¨é€—å·åˆ†éš” 2.0.5ä»¥ä¸Šç‰ˆæœ¬ dubbo:service contextpath contextpath String å¯é€‰ ç¼ºçœä¸ºç©ºä¸² æœåŠ¡æ²»ç† layer layer string å¯é€‰ æœåŠ¡æ²»ç† æœåŠ¡æä¾›è€…æ‰€åœ¨çš„åˆ†å±‚ã€‚å¦‚ï¼šbizã€daoã€intl:webã€china:actonã€‚ 2.0.7ä»¥ä¸Šç‰ˆæœ¬ dubbo:method (dubbo:method)æ–¹æ³•çº§é…ç½®ã€‚å¯¹åº”çš„é…ç½®ç±»ï¼š com.alibaba.dubbo.config.MethodConfigã€‚åŒæ—¶è¯¥æ ‡ç­¾ä¸º dubbo:service æˆ– dubbo:reference çš„å­æ ‡ç­¾ï¼Œç”¨äºæ§åˆ¶åˆ°æ–¹æ³•çº§ã€‚ å±æ€§ å¯¹åº”URLå‚æ•° ç±»å‹ æ˜¯å¦å¿…å¡« ç¼ºçœå€¼ ä½œç”¨ æè¿° å…¼å®¹æ€§ name string å¿…å¡« æ ‡è¯† æ–¹æ³•å 1.0.8ä»¥ä¸Šç‰ˆæœ¬ timeout .timeout int å¯é€‰ ç¼ºçœä¸ºçš„timeout æ€§èƒ½è°ƒä¼˜ æ–¹æ³•è°ƒç”¨è¶…æ—¶æ—¶é—´(æ¯«ç§’) 1.0.8ä»¥ä¸Šç‰ˆæœ¬ retries .retries int å¯é€‰ ç¼ºçœä¸ºdubbo:referenceçš„retries æ€§èƒ½è°ƒä¼˜ è¿œç¨‹æœåŠ¡è°ƒç”¨é‡è¯•æ¬¡æ•°ï¼Œä¸åŒ…æ‹¬ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œä¸éœ€è¦é‡è¯•è¯·è®¾ä¸º0 2.0.0ä»¥ä¸Šç‰ˆæœ¬ loadbalance .loadbalance string å¯é€‰ ç¼ºçœä¸ºçš„loadbalance æ€§èƒ½è°ƒä¼˜ è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå¯é€‰å€¼ï¼šrandom,roundrobin,leastactiveï¼Œåˆ†åˆ«è¡¨ç¤ºï¼šéšæœºï¼Œè½®å¾ªï¼Œæœ€å°‘æ´»è·ƒè°ƒç”¨ 2.0.0ä»¥ä¸Šç‰ˆæœ¬ async .async boolean å¯é€‰ ç¼ºçœä¸ºdubbo:referenceçš„async æ€§èƒ½è°ƒä¼˜ æ˜¯å¦å¼‚æ­¥æ‰§è¡Œï¼Œä¸å¯é å¼‚æ­¥ï¼Œåªæ˜¯å¿½ç•¥è¿”å›å€¼ï¼Œä¸é˜»å¡æ‰§è¡Œçº¿ç¨‹ 1.0.9ä»¥ä¸Šç‰ˆæœ¬ sent .sent boolean å¯é€‰ TRUE æ€§èƒ½è°ƒä¼˜ å¼‚æ­¥è°ƒç”¨æ—¶ï¼Œæ ‡è®°sent&#x3D;trueæ—¶ï¼Œè¡¨ç¤ºç½‘ç»œå·²å‘å‡ºæ•°æ® 2.0.6ä»¥ä¸Šç‰ˆæœ¬ actives .actives int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ æ¯æœåŠ¡æ¶ˆè´¹è€…æœ€å¤§å¹¶å‘è°ƒç”¨é™åˆ¶ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ executes .executes int å¯é€‰ 0 æ€§èƒ½è°ƒä¼˜ æ¯æœåŠ¡æ¯æ–¹æ³•æœ€å¤§ä½¿ç”¨çº¿ç¨‹æ•°é™åˆ¶ï¼Œæ­¤å±æ€§åªåœ¨dubbo:methodä½œä¸ºdubbo:serviceå­æ ‡ç­¾æ—¶æœ‰æ•ˆ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ deprecated .deprecated boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† æœåŠ¡æ–¹æ³•æ˜¯å¦è¿‡æ—¶ï¼Œæ­¤å±æ€§åªåœ¨dubbo:methodä½œä¸ºdubbo:serviceå­æ ‡ç­¾æ—¶æœ‰æ•ˆ 2.0.5ä»¥ä¸Šç‰ˆæœ¬ sticky .sticky boolean å¯é€‰ FALSE æœåŠ¡æ²»ç† è®¾ç½®trueè¯¥æ¥å£ä¸Šçš„æ‰€æœ‰æ–¹æ³•ä½¿ç”¨åŒä¸€ä¸ªprovider.å¦‚æœéœ€è¦æ›´å¤æ‚çš„è§„åˆ™ï¼Œè¯·ä½¿ç”¨ç”¨è·¯ç”± 2.0.6ä»¥ä¸Šç‰ˆæœ¬ return .return boolean å¯é€‰ TRUE æ€§èƒ½è°ƒä¼˜ æ–¹æ³•è°ƒç”¨æ˜¯å¦éœ€è¦è¿”å›å€¼,asyncè®¾ç½®ä¸ºtrueæ—¶æ‰ç”Ÿæ•ˆï¼Œå¦‚æœè®¾ç½®ä¸ºtrueï¼Œåˆ™è¿”å›futureï¼Œæˆ–å›è°ƒonreturnç­‰æ–¹æ³•ï¼Œå¦‚æœè®¾ç½®ä¸ºfalseï¼Œåˆ™è¯·æ±‚å‘é€æˆåŠŸåç›´æ¥è¿”å›Null 2.0.6ä»¥ä¸Šç‰ˆæœ¬ oninvoke attributeå±æ€§ï¼Œä¸åœ¨URLä¸­ä½“ç° String å¯é€‰ æ€§èƒ½è°ƒä¼˜ æ–¹æ³•æ‰§è¡Œå‰æ‹¦æˆª 2.0.6ä»¥ä¸Šç‰ˆæœ¬ onreturn attributeå±æ€§ï¼Œä¸åœ¨URLä¸­ä½“ç° String å¯é€‰ æ€§èƒ½è°ƒä¼˜ æ–¹æ³•æ‰§è¡Œè¿”å›åæ‹¦æˆª 2.0.6ä»¥ä¸Šç‰ˆæœ¬ onthrow attributeå±æ€§ï¼Œä¸åœ¨URLä¸­ä½“ç° String å¯é€‰ æ€§èƒ½è°ƒä¼˜ æ–¹æ³•æ‰§è¡Œæœ‰å¼‚å¸¸æ‹¦æˆª 2.0.6ä»¥ä¸Šç‰ˆæœ¬ cache .cache string&#x2F;boolean å¯é€‰ æœåŠ¡æ²»ç† ä»¥è°ƒç”¨å‚æ•°ä¸ºkeyï¼Œç¼“å­˜è¿”å›ç»“æœï¼Œå¯é€‰ï¼šlru,threadlocal,jcacheç­‰ Dubbo2.1.0åŠå…¶ä»¥ä¸Šç‰ˆæœ¬æ”¯æŒ validation .validation boolean å¯é€‰ æœåŠ¡æ²»ç† æ˜¯å¦å¯ç”¨JSR303æ ‡å‡†æ³¨è§£éªŒè¯ï¼Œå¦‚æœå¯ç”¨ï¼Œå°†å¯¹æ–¹æ³•å‚æ•°ä¸Šçš„æ³¨è§£è¿›è¡Œæ ¡éªŒ Dubbo2.1.0åŠå…¶ä»¥ä¸Šç‰ˆæœ¬æ”¯æŒ ä»£ç å®ä¾‹ dubbo:argument(dubbo:argument)æ–¹æ³•å‚æ•°é…ç½®ã€‚å¯¹åº”çš„é…ç½®ç±»ï¼š com.alibaba.dubbo.config.ArgumentConfigã€‚è¯¥æ ‡ç­¾ä¸º dubbo:method çš„å­æ ‡ç­¾ï¼Œç”¨äºæ–¹æ³•å‚æ•°çš„ç‰¹å¾æè¿°ï¼Œæ¯”å¦‚ï¼š å±æ€§ å¯¹åº”URLå‚æ•° ç±»å‹ æ˜¯å¦å¿…å¡« ç¼ºçœå€¼ ä½œç”¨ æè¿° å…¼å®¹æ€§ index int å¿…å¡« æ ‡è¯† æ–¹æ³•å 2.0.6ä»¥ä¸Šç‰ˆæœ¬ type String ä¸indexäºŒé€‰ä¸€ æ ‡è¯† é€šè¿‡å‚æ•°ç±»å‹æŸ¥æ‰¾å‚æ•°çš„index 2.0.6ä»¥ä¸Šç‰ˆæœ¬ callback .retries boolean å¯é€‰ æœåŠ¡æ²»ç† å‚æ•°æ˜¯å¦ä¸ºcallbackæ¥å£ï¼Œå¦‚æœä¸ºcallbackï¼ŒæœåŠ¡æä¾›æ–¹å°†ç”Ÿæˆåå‘ä»£ç†ï¼Œå¯ä»¥ä»æœåŠ¡æä¾›æ–¹åå‘è°ƒç”¨æ¶ˆè´¹æ–¹ï¼Œé€šå¸¸ç”¨äºäº‹ä»¶æ¨é€. 2.0.6ä»¥ä¸Šç‰ˆæœ¬ dubbo:parameter()é€‰é¡¹å‚æ•°é…ç½®ã€‚å¯¹åº”çš„é…ç½®ç±»ï¼šjava.util.Mapã€‚åŒæ—¶è¯¥æ ‡ç­¾ä¸ºdubbo:protocolæˆ–dubbo:serviceæˆ–dubbo:provideræˆ–dubbo:referenceæˆ–dubbo:consumerçš„å­æ ‡ç­¾ï¼Œç”¨äºé…ç½®è‡ªå®šä¹‰å‚æ•°ï¼Œè¯¥é…ç½®é¡¹å°†ä½œä¸ºæ‰©å±•ç‚¹è®¾ç½®è‡ªå®šä¹‰å‚æ•°ä½¿ç”¨ã€‚ å±æ€§ å¯¹åº”URLå‚æ•° ç±»å‹ æ˜¯å¦å¿…å¡« ç¼ºçœå€¼ ä½œç”¨ æè¿° å…¼å®¹æ€§ key key string å¿…å¡« æœåŠ¡æ²»ç† è·¯ç”±å‚æ•°é”® 2.0.0ä»¥ä¸Šç‰ˆæœ¬ value value string å¿…å¡« æœåŠ¡æ²»ç† è·¯ç”±å‚æ•°å€¼ 2.0.0ä»¥ä¸Šç‰ˆæœ¬","date":"2024-12-31","categories":["java"],"tags":["dubbo"]},{"title":"dubbo-æ·±å…¥(1)-åŸºæœ¬ä½¿ç”¨åˆæ¢","url":"/2024/12/31/dubbo-æ·±å…¥-1--åŸºæœ¬ä½¿ç”¨åˆæ¢/","content":"æ·±å…¥dubboï¼ˆä¸€ï¼‰åŸºæœ¬ä½¿ç”¨åˆæ¢äº’è”ç½‘æ¶æ„å‡çº§è¿‡ç¨‹å›¾ å•ä¸€åº”ç”¨æ¶æ„(å•æœºéƒ¨ç½²æ‰€æœ‰çš„åº”ç”¨)â€”â€”>å‚ç›´åº”ç”¨æ¶æ„(å°†å•æœºçš„åº”ç”¨éƒ¨ç½²åˆ°ç›¸å…³çš„å„ç§åˆ†å¼€çš„æœåŠ¡å™¨ä¸Šï¼Œå„ä¸ªæœåŠ¡å™¨ç›¸äº’ç‹¬ç«‹)â€”â€”>åˆ†å¸ƒå¼æœåŠ¡æ¶æ„(åœ¨ä¹‹å‰çš„å„ä¸ªéƒ¨åˆ†å‡ºç°äº†äº¤äº’çš„è¿‡ç¨‹)â€”â€”>æµåŠ¨è®¡ç®—æ¶æ„soa(å½“ç³»ç»Ÿå˜å¾—å¤æ‚ï¼Œå„ç§äº¤äº’æ··ä¹±ï¼Œç‰æ ‘å‡ºç°äº†åŸºäºä¸­å¤®è°ƒåº¦çš„æ•´åˆé…ç½®æœºåˆ¶)â€”â€”>å¾®æœåŠ¡ dubboçš„ä½œç”¨ ä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ŒåŠ¨æ€çš„æ³¨å†Œå’Œå‘ç°æœåŠ¡ï¼Œä½¿æœåŠ¡çš„ä½ç½®é€æ˜å¹¶é€šè¿‡åœ¨æ¶ˆè´¹æ–¹è·å–æœåŠ¡æä¾›æ–¹åœ°å€åˆ—è¡¨ï¼Œå®ç°è½¯è´Ÿè½½å‡è¡¡å’Œ Failoverï¼ˆå¤±æ•ˆå¤‡ä»½ï¼‰ï¼Œé™ä½å¯¹ F5 ç¡¬ä»¶è´Ÿè½½å‡è¡¡å™¨çš„ä¾èµ– è‡ªåŠ¨ç”»å‡ºåº”ç”¨é—´çš„ä¾èµ–å…³ç³»å›¾ï¼Œä»¥å¸®åŠ©æ¶æ„å¸ˆç†æ¸…ç†å…³ç³»ã€‚ å°†æœåŠ¡ç°åœ¨æ¯å¤©çš„è°ƒç”¨é‡ï¼Œå“åº”æ—¶é—´ï¼Œéƒ½ç»Ÿè®¡å‡ºæ¥ï¼Œä½œä¸ºå®¹é‡è§„åˆ’çš„å‚è€ƒæŒ‡æ ‡ï¼Œå¯ä»¥åŠ¨æ€è°ƒæ•´æƒé‡ï¼Œåœ¨çº¿ä¸Šï¼Œå°†æŸå°æœºå™¨çš„æƒé‡ä¸€ç›´åŠ å¤§ï¼Œå¹¶åœ¨åŠ å¤§çš„è¿‡ç¨‹ä¸­è®°å½•å“åº”æ—¶é—´çš„å˜åŒ–ï¼Œç›´åˆ°å“åº”æ—¶é—´åˆ°è¾¾é˜€å€¼ï¼Œè®°å½•æ­¤æ—¶çš„è®¿é—®é‡ï¼Œå†ä»¥æ­¤è®¿é—®é‡ä¹˜ä»¥æœºå™¨æ•°åæ¨æ€»å®¹é‡ dubboçš„åŸºæœ¬æ¶æ„ èŠ‚ç‚¹ è§’è‰²è¯´æ˜ Provider æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ Consumer è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ Registry æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ³¨å†Œä¸­å¿ƒ Monitor ç»Ÿè®¡æœåŠ¡çš„è°ƒç”¨æ¬¡è°ƒå’Œè°ƒç”¨æ—¶é—´çš„ç›‘æ§ä¸­å¿ƒ Container æœåŠ¡è¿è¡Œå®¹å™¨ åŸºæœ¬ä½¿ç”¨æ–¹æ³•å¼•ç”³ï¼Œå…¶å®dubboå¹¶æ²¡æœ‰é‚£ä¹ˆéš¾ï¼Œé¦–å…ˆä»–éœ€è¦çš„ä¸€ç»„å…¬å…±çš„æ¥å£ï¼Œä½œä¸ºå¯¹å¤–é¢æä¾›çš„æœåŠ¡çš„å…¥å£ï¼Œdubboæ¡†æ¶å¤„ç†äº†å¯»æ‰¾æœåŠ¡æä¾›è€…ç­‰è¿‡ç¨‹ï¼Œä½¿ç”¨è€…å¯ä»¥å°±åƒä½¿ç”¨springæ¡†æ¶é‚£æ ·è¿›è¡Œdubboçš„ä½¿ç”¨ï¼Œè§ä¸‹é¢çš„ä¾‹å­ å…¬å…±çš„æ¥å£ æ³¨æ„ï¼šè¿™ä¸ªå…¬å…±çš„æ¥å£ä¸€å®šè¦æœ‰åŒ…åï¼Œå¦åˆ™dubboå†…éƒ¨çš„åå°„å¤„ç†æ–¹æ³•å°†ä¼šæŠ¥ç©ºå€¼é”™è¯¯ æä¾›mavenè´¡å…¶ä»–ç»„ä»¶ä½¿ç”¨ provideræœåŠ¡æä¾›è€… xmlé…ç½®æ–‡ä»¶ï¼Œæ³¨æ„å¯¹å¤–æä¾›çš„æœåŠ¡ä¸€å®šè¦æ˜¯æ¥å£ æ¥å£å®ç°ç±» æœåŠ¡å¯åŠ¨å…¥å£ æ³¨æ„ï¼šlinuxç³»ç»Ÿéœ€è¦ä¿®æ”¹&#x2F;etc&#x2F;hostsæ–‡ä»¶å°†hostnameå¯¹åº”çš„ipåœ°å€æ”¹æˆç°åœ¨ç”µè„‘å¯¹åº”ç½‘å¡çš„ipåœ°å€ consumer æ¶ˆè´¹è€… xmlé…ç½®æ–‡ä»¶ æ¶ˆè´¹è€…ç¨‹åºå…¥å£","date":"2024-12-31","categories":["java"],"tags":["dubbo"]},{"title":"dubbo-æ·±å…¥(3)-æ³¨å†Œä¸­å¿ƒ","url":"/2024/12/31/dubbo-æ·±å…¥-3--æ³¨å†Œä¸­å¿ƒ/","content":"æ·±å…¥dubboï¼ˆäºŒï¼‰æ³¨å†Œä¸­å¿ƒæ³¨å†Œä¸­å¿ƒåªè¦è§£å†³çš„é—®é¢˜å°±æ˜¯ï¼ŒæœåŠ¡ç«¯å’Œæ¶ˆè´¹ç«¯çš„ç›¸äº’å‘ç°çš„é—®é¢˜ï¼Œæ–­å¼€é‡é“¾æ¥çš„é—®é¢˜ åŸºäºå¹¿æ’­å®ç°æ³¨å†Œçš„Multicast æ³¨å†Œä¸­å¿ƒMulticast æ³¨å†Œä¸­å¿ƒä¸éœ€è¦å¯åŠ¨ä»»ä½•ä¸­å¿ƒèŠ‚ç‚¹ï¼Œåªè¦å¹¿æ’­åœ°å€ä¸€æ ·ï¼Œå°±å¯ä»¥äº’ç›¸å‘ç°ã€‚ æä¾›æ–¹å¯åŠ¨æ—¶å¹¿æ’­è‡ªå·±çš„åœ°å€ æ¶ˆè´¹æ–¹å¯åŠ¨æ—¶å¹¿æ’­è®¢é˜…è¯·æ±‚ æä¾›æ–¹æ”¶åˆ°è®¢é˜…è¯·æ±‚æ—¶ï¼Œå•æ’­è‡ªå·±çš„åœ°å€ç»™è®¢é˜…è€…ï¼Œå¦‚æœè®¾ç½®äº† unicast&#x3D;falseï¼Œåˆ™å¹¿æ’­ç»™è®¢é˜…è€… æ¶ˆè´¹æ–¹æ”¶åˆ°æä¾›æ–¹åœ°å€æ—¶ï¼Œè¿æ¥è¯¥åœ°å€è¿›è¡Œ RPC è°ƒç”¨ã€‚ é…ç½®æ–¹æ³• ä¸ºäº†å‡å°‘å¹¿æ’­é‡ï¼ŒDubbo ç¼ºçœä½¿ç”¨å•æ’­å‘é€æä¾›è€…åœ°å€ä¿¡æ¯ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœä¸€ä¸ªæœºå™¨ä¸ŠåŒæ—¶å¯äº†å¤šä¸ªæ¶ˆè´¹è€…è¿›ç¨‹ï¼Œæ¶ˆè´¹è€…éœ€å£°æ˜ unicast&#x3D;falseï¼Œå¦åˆ™åªä¼šæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…èƒ½æ”¶åˆ°æ¶ˆæ¯ æ³¨æ„é—®é¢˜,hostnameéœ€è¦ä¸ºæœ¬åœ°çš„ipåœ°å€ï¼ˆä¸èƒ½æ˜¯127.0.0.1ï¼‰ï¼Œubuntuç³»ç»Ÿéœ€è¦ä¿®æ”¹hostsæ–‡ä»¶ ä½¿ç”¨åŸºäºzookeeperçš„æ³¨å†Œä¸­å¿ƒæ³¨å†Œä¾èµ–äºzookeeperåº•å±‚æ ‘å®ç° æµç¨‹è¯´æ˜ï¼š æœåŠ¡æä¾›è€…å¯åŠ¨æ—¶: å‘ &#x2F;dubbo&#x2F;com.foo.BarService&#x2F;providers ç›®å½•ä¸‹å†™å…¥è‡ªå·±çš„ URL åœ°å€ æœåŠ¡æ¶ˆè´¹è€…å¯åŠ¨æ—¶: è®¢é˜… &#x2F;dubbo&#x2F;com.foo.BarService&#x2F;providers ç›®å½•ä¸‹çš„æä¾›è€… URL åœ°å€ã€‚å¹¶å‘ &#x2F;dubbo&#x2F;com.foo.BarService&#x2F;consumers ç›®å½•ä¸‹å†™å…¥è‡ªå·±çš„ URL åœ°å€ ç›‘æ§ä¸­å¿ƒå¯åŠ¨æ—¶: è®¢é˜… &#x2F;dubbo&#x2F;com.foo.BarService ç›®å½•ä¸‹çš„æ‰€æœ‰æä¾›è€…å’Œæ¶ˆè´¹è€… URL åœ°å€ã€‚ åŠŸèƒ½ç‰¹ç‚¹ï¼š æä¾›è€…å‡ºç°æ–­ç”µç­‰å¼‚å¸¸åœæœºæ—¶ï¼Œæ³¨å†Œä¸­å¿ƒèƒ½è‡ªåŠ¨åˆ é™¤æä¾›è€…ä¿¡æ¯ï¼Œæ³¨å†Œä¸­å¿ƒé‡å¯æ—¶ï¼Œèƒ½è‡ªåŠ¨æ¢å¤æ³¨å†Œæ•°æ®ï¼Œä»¥åŠè®¢é˜…è¯·æ±‚ï¼Œä¼šè¯è¿‡æœŸæ—¶ï¼Œèƒ½è‡ªåŠ¨æ¢å¤æ³¨å†Œæ•°æ®ï¼Œä»¥åŠè®¢é˜…è¯·æ±‚ <dubbo:registry check&#x3D;â€œfalseâ€œ &#x2F;> æ—¶ï¼Œè®°å½•å¤±è´¥æ³¨å†Œå’Œè®¢é˜…è¯·æ±‚ï¼Œåå°å®šæ—¶é‡è¯• é€šè¿‡ <dubbo:registry username&#x3D;â€œadminâ€œ password&#x3D;â€œ1234â€œ &#x2F;> è®¾ç½® zookeeper ç™»å½•ä¿¡æ¯ <dubbo:registry group&#x3D;â€œdubboâ€œ &#x2F;> è®¾ç½® zookeeper çš„æ ¹èŠ‚ç‚¹ï¼Œä¸è®¾ç½®å°†ä½¿ç”¨æ— æ ¹æ ‘ å·é€šé…ç¬¦ <dubbo:reference group&#x3D;â€œ*â€œ version&#x3D;â€œ*â€œ &#x2F;>ï¼Œå¯è®¢é˜…æœåŠ¡çš„æ‰€æœ‰åˆ†ç»„å’Œæ‰€æœ‰ç‰ˆæœ¬çš„æä¾›è€… æ³¨æ„ï¼šä½¿ç”¨zkè¿›è¡Œæ³¨å†Œä¸­å¿ƒé…ç½®çš„æ—¶å€™ï¼Œéœ€è¦å¯¹ä¾èµ–åŒ…å°½è¿›è¡Œé…ç½® Zookeeper å•æœºé…ç½®: Zookeeper é›†ç¾¤é…ç½®ï¼š åŒä¸€ Zookeeperï¼Œåˆ†æˆå¤šç»„æ³¨å†Œä¸­å¿ƒ: ä½¿ç”¨redisä½œä¸ºé…ç½®ä¸­å¿ƒ ä½¿ç”¨ Redis çš„ Key&#x2F;Map ç»“æ„å­˜å‚¨æ•°æ®ç»“æ„ï¼šä¸» Key ä¸ºæœåŠ¡åå’Œç±»å‹ï¼ŒMap ä¸­çš„ Key ä¸º URL åœ°å€ï¼ŒMap ä¸­çš„ Value ä¸ºè¿‡æœŸæ—¶é—´ï¼Œç”¨äºåˆ¤æ–­è„æ•°æ®ï¼Œè„æ•°æ®ç”±ç›‘æ§ä¸­å¿ƒåˆ é™¤ å…·ä½“æµç¨‹å°†ä¸Šå›¾ï¼Œå› ä¸ºä½¿ç”¨å¾ˆå°‘ï¼Œæš‚æ—¶ä¸åšè®¨è®º","date":"2024-12-31","categories":["java"],"tags":["dubbo"]},{"title":"dubbo-æ·±å…¥(3)-é…ç½®å‚è€ƒ","url":"/2024/12/31/dubbo-æ·±å…¥-3--é…ç½®å‚è€ƒ/","content":"æ·±å…¥dubboï¼ˆä¸‰ï¼‰é…ç½®å‚è€ƒé…ç½®é¡¹åˆ†ä¸ºä¸‰å¤§ç±»ï¼šæœåŠ¡å‘ç°ï¼šè¡¨ç¤ºè¯¥é…ç½®é¡¹ç”¨äºæœåŠ¡çš„æ³¨å†Œä¸å‘ç°ï¼Œç›®çš„æ˜¯è®©æ¶ˆè´¹æ–¹æ‰¾åˆ°æä¾›æ–¹ã€‚æœåŠ¡æ²»ç†ï¼šè¡¨ç¤ºè¯¥é…ç½®é¡¹ç”¨äºæ²»ç†æœåŠ¡é—´çš„å…³ç³»ï¼Œæˆ–ä¸ºå¼€å‘æµ‹è¯•æä¾›ä¾¿åˆ©æ¡ä»¶ã€‚æ€§èƒ½è°ƒä¼˜ï¼šè¡¨ç¤ºè¯¥é…ç½®é¡¹ç”¨äºè°ƒä¼˜æ€§èƒ½ï¼Œä¸åŒçš„é€‰é¡¹å¯¹æ€§èƒ½ä¼šäº§ç”Ÿå½±å“ã€‚ æ³¨æ„ï¼šåªæœ‰ groupï¼Œinterfaceï¼Œversion æ˜¯æœåŠ¡çš„åŒ¹é…æ¡ä»¶ï¼Œä¸‰è€…å†³å®šæ˜¯ä¸æ˜¯åŒä¸€ä¸ªæœåŠ¡ï¼Œå…¶å®ƒé…ç½®é¡¹å‡ä¸ºè°ƒä¼˜å’Œæ²»ç†å‚æ•°ã€‚ å¯åŠ¨æ—¶æ£€æŸ¥å‚æ•° check ä½¿ç”¨æ ‡ç­¾ reference consumer registry xmlé…ç½®æ³• é…ç½®æ–‡ä»¶ Dubbo ç¼ºçœä¼šåœ¨å¯åŠ¨æ—¶æ£€æŸ¥ä¾èµ–çš„æœåŠ¡æ˜¯å¦å¯ç”¨ï¼Œå¯ä»¥é€šè¿‡ check&#x3D;â€falseâ€ å…³é—­æ£€æŸ¥ï¼ˆæœ‰äº›æœåŠ¡ä¸å…³å¿ƒï¼Œæˆ–è€…å‡ºç°äº†å¾ªç¯ä¾èµ–ï¼Œå¿…é¡»æœ‰ä¸€æ–¹å…ˆå¯åŠ¨ï¼Œ æ¯”å¦‚Spring å®¹å™¨æ˜¯æ‡’åŠ è½½çš„ï¼Œæˆ–è€…é€šè¿‡ API ç¼–ç¨‹å»¶è¿Ÿå¼•ç”¨æœåŠ¡ï¼‰ é›†ç¾¤å®¹é”™é…ç½® é»˜è®¤Failover Cluster å¤±è´¥è‡ªåŠ¨åˆ‡æ¢ï¼Œå½“å‡ºç°å¤±è´¥ï¼Œé‡è¯•å…¶å®ƒæœåŠ¡å™¨ 1ã€‚é€šå¸¸ç”¨äºè¯»æ“ä½œï¼Œä½†é‡è¯•ä¼šå¸¦æ¥æ›´é•¿å»¶è¿Ÿã€‚å¯é€šè¿‡ retries&#x3D;â€2â€³ æ¥è®¾ç½®é‡è¯•æ¬¡æ•°(ä¸å«ç¬¬ä¸€æ¬¡)ã€‚é…ç½®å¦‚ä¸‹ Failfast Cluster å¿«é€Ÿå¤±è´¥ï¼Œåªå‘èµ·ä¸€æ¬¡è°ƒç”¨ï¼Œå¤±è´¥ç«‹å³æŠ¥é”™ã€‚é€šå¸¸ç”¨äºéå¹‚ç­‰æ€§çš„å†™æ“ä½œï¼Œæ¯”å¦‚æ–°å¢è®°å½•ã€‚ Failsafe Cluster å¤±è´¥å®‰å…¨ï¼Œå‡ºç°å¼‚å¸¸æ—¶ï¼Œç›´æ¥å¿½ç•¥ã€‚é€šå¸¸ç”¨äºå†™å…¥å®¡è®¡æ—¥å¿—ç­‰æ“ä½œã€‚ Failback Cluster å¤±è´¥è‡ªåŠ¨æ¢å¤ï¼Œåå°è®°å½•å¤±è´¥è¯·æ±‚ï¼Œå®šæ—¶é‡å‘ã€‚é€šå¸¸ç”¨äºæ¶ˆæ¯é€šçŸ¥æ“ä½œã€‚ Forking Cluster å¹¶è¡Œè°ƒç”¨å¤šä¸ªæœåŠ¡å™¨ï¼Œåªè¦ä¸€ä¸ªæˆåŠŸå³è¿”å›ã€‚é€šå¸¸ç”¨äºå®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„è¯»æ“ä½œï¼Œä½†éœ€è¦æµªè´¹æ›´å¤šæœåŠ¡èµ„æºã€‚å¯é€šè¿‡ forks&#x3D;â€2â€³ æ¥è®¾ç½®æœ€å¤§å¹¶è¡Œæ•°ã€‚ Broadcast Clusterå¹¿æ’­è°ƒç”¨æ‰€æœ‰æä¾›è€…ï¼Œé€ä¸ªè°ƒç”¨ï¼Œä»»æ„ä¸€å°æŠ¥é”™åˆ™æŠ¥é”™ 2ã€‚é€šå¸¸ç”¨äºé€šçŸ¥æ‰€æœ‰æä¾›è€…æ›´æ–°ç¼“å­˜æˆ–æ—¥å¿—ç­‰æœ¬åœ°èµ„æºä¿¡æ¯ã€‚ é›†ç¾¤æ¨¡å¼é…ç½®ä»¥ä¸Šå…­ç§æŒ‰ç…§ä»¥ä¸‹ç¤ºä¾‹åœ¨æœåŠ¡æä¾›æ–¹å’Œæ¶ˆè´¹æ–¹é…ç½®é›†ç¾¤æ¨¡å¼ è´Ÿè½½å‡è¡¡é…ç½® Random LoadBalanceéšæœºï¼ŒæŒ‰æƒé‡è®¾ç½®éšæœºæ¦‚ç‡ã€‚åœ¨ä¸€ä¸ªæˆªé¢ä¸Šç¢°æ’çš„æ¦‚ç‡é«˜ï¼Œä½†è°ƒç”¨é‡è¶Šå¤§åˆ†å¸ƒè¶Šå‡åŒ€ï¼Œè€Œä¸”æŒ‰æ¦‚ç‡ä½¿ç”¨æƒé‡åä¹Ÿæ¯”è¾ƒå‡åŒ€ï¼Œæœ‰åˆ©äºåŠ¨æ€è°ƒæ•´æä¾›è€…æƒé‡ã€‚ RoundRobin LoadBalanceè½®å¾ªï¼ŒæŒ‰å…¬çº¦åçš„æƒé‡è®¾ç½®è½®å¾ªæ¯”ç‡ã€‚å­˜åœ¨æ…¢çš„æä¾›è€…ç´¯ç§¯è¯·æ±‚çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šç¬¬äºŒå°æœºå™¨å¾ˆæ…¢ï¼Œä½†æ²¡æŒ‚ï¼Œå½“è¯·æ±‚è°ƒåˆ°ç¬¬äºŒå°æ—¶å°±å¡åœ¨é‚£ï¼Œä¹…è€Œä¹…ä¹‹ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å¡åœ¨è°ƒåˆ°ç¬¬äºŒå°ä¸Šã€‚ LeastActive LoadBalanceæœ€å°‘æ´»è·ƒè°ƒç”¨æ•°ï¼Œç›¸åŒæ´»è·ƒæ•°çš„éšæœºï¼Œæ´»è·ƒæ•°æŒ‡è°ƒç”¨å‰åè®¡æ•°å·®ã€‚ä½¿æ…¢çš„æä¾›è€…æ”¶åˆ°æ›´å°‘è¯·æ±‚ï¼Œå› ä¸ºè¶Šæ…¢çš„æä¾›è€…çš„è°ƒç”¨å‰åè®¡æ•°å·®ä¼šè¶Šå¤§ã€‚ ConsistentHash LoadBalanceä¸€è‡´æ€§ Hashï¼Œç›¸åŒå‚æ•°çš„è¯·æ±‚æ€»æ˜¯å‘åˆ°åŒä¸€æä¾›è€…ã€‚ å½“æŸä¸€å°æä¾›è€…æŒ‚æ—¶ï¼ŒåŸæœ¬å‘å¾€è¯¥æä¾›è€…çš„è¯·æ±‚ï¼ŒåŸºäºè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¹³æ‘Šåˆ°å…¶å®ƒæä¾›è€…ï¼Œä¸ä¼šå¼•èµ·å‰§çƒˆå˜åŠ¨ã€‚ ç¼ºçœåªå¯¹ç¬¬ä¸€ä¸ªå‚æ•° Hashï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® <dubbo:parameter key&#x3D;â€hash.argumentsâ€ value&#x3D;â€0,1â€³ &#x2F;> ç¼ºçœç”¨ 160 ä»½è™šæ‹ŸèŠ‚ç‚¹ï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® <dubbo:parameter key&#x3D;â€hash.nodesâ€ value&#x3D;â€320â€³ &#x2F;> é…ç½®æ–¹æ³• æœåŠ¡ç«¯æœåŠ¡çº§åˆ« å®¢æˆ·ç«¯æœåŠ¡çº§åˆ« æœåŠ¡ç«¯æ–¹æ³•çº§åˆ« å®¢æˆ·ç«¯æ–¹æ³•çº§åˆ« çº¿ç¨‹æ± å¯¹äºDubboçš„æœåŠ¡æä¾›è€…ï¼Œä¸»è¦æœ‰ä¸¤ç§çº¿ç¨‹æ± ï¼Œä¸€ç§æ˜¯IOå¤„ç†çº¿ç¨‹æ± ï¼Œå¦ä¸€ç§æ˜¯æœåŠ¡è°ƒç”¨çº¿ç¨‹æ± ã€‚è€Œä½œä¸ºIOå¤„ç†çº¿ç¨‹æ± ï¼Œç”±äºDubboåŸºäºMinaã€Grizzlyå’ŒNettyæ¡†æ¶åšIOç»„ä»¶ï¼ŒIOçº¿ç¨‹æ± éƒ½æ˜¯åŸºäºè¿™äº›æ¡†æ¶æ¥é…ç½®ï¼Œæ¯”å¦‚Nettyä¸­çš„bosså’Œworkerçº¿ç¨‹æ± ï¼ŒDubboé€‰æ‹©çš„æ˜¯â€œæ— è¾¹ç•Œâ€çš„CachedThreadPoolï¼Œè¿™æ„å‘³ç€å¯¹æ‰€æœ‰æœåŠ¡è¯·æ±‚å…ˆåšåˆ°â€œæ¥è€…ä¸æ‹’â€ï¼Œä½†å®ƒè¿›ä¸€æ­¥é™åˆ¶äº†IOå¤„ç†çš„çº¿ç¨‹æ•°ï¼Œé»˜è®¤æ˜¯æ ¸æ•°+1 å¦‚æœäº‹ä»¶å¤„ç†çš„é€»è¾‘èƒ½è¿…é€Ÿå®Œæˆï¼Œå¹¶ä¸”ä¸ä¼šå‘èµ·æ–°çš„ IO è¯·æ±‚ï¼Œæ¯”å¦‚åªæ˜¯åœ¨å†…å­˜ä¸­è®°ä¸ªæ ‡è¯†ï¼Œåˆ™ç›´æ¥åœ¨ IO çº¿ç¨‹ä¸Šå¤„ç†æ›´å¿«ï¼Œå¦‚æœäº‹ä»¶å¤„ç†é€»è¾‘è¾ƒæ…¢ï¼Œæˆ–è€…éœ€è¦å‘èµ·æ–°çš„IOè¯·æ±‚ï¼Œæ¯”å¦‚éœ€è¦æŸ¥è¯¢æ•°æ®åº“ï¼Œåˆ™å¿…é¡»æ´¾å‘åˆ°IOçº¿ç¨‹æ± ä¸­ Dispatcher all æ‰€æœ‰æ¶ˆæ¯éƒ½æ´¾å‘åˆ°çº¿ç¨‹æ± ï¼ŒåŒ…æ‹¬è¯·æ±‚ï¼Œå“åº”ï¼Œè¿æ¥äº‹ä»¶ï¼Œæ–­å¼€äº‹ä»¶ï¼Œå¿ƒè·³ç­‰ã€‚ direct æ‰€æœ‰æ¶ˆæ¯éƒ½ä¸æ´¾å‘åˆ°çº¿ç¨‹æ± ï¼Œå…¨éƒ¨åœ¨ IO çº¿ç¨‹ä¸Šç›´æ¥æ‰§è¡Œã€‚ message åªæœ‰è¯·æ±‚å“åº”æ¶ˆæ¯æ´¾å‘åˆ°çº¿ç¨‹æ± ï¼Œå…¶å®ƒè¿æ¥æ–­å¼€äº‹ä»¶ï¼Œå¿ƒè·³ç­‰æ¶ˆæ¯ï¼Œç›´æ¥åœ¨ IO çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚ execution åªè¯·æ±‚æ¶ˆæ¯æ´¾å‘åˆ°çº¿ç¨‹æ± ï¼Œä¸å«å“åº”ï¼Œå“åº”å’Œå…¶å®ƒè¿æ¥æ–­å¼€äº‹ä»¶ï¼Œå¿ƒè·³ç­‰æ¶ˆæ¯ï¼Œç›´æ¥åœ¨ IO çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚ connection åœ¨ IO çº¿ç¨‹ä¸Šï¼Œå°†è¿æ¥æ–­å¼€äº‹ä»¶æ”¾å…¥é˜Ÿåˆ—ï¼Œæœ‰åºé€ä¸ªæ‰§è¡Œï¼Œå…¶å®ƒæ¶ˆæ¯æ´¾å‘åˆ°çº¿ç¨‹æ± ã€‚ ThreadPool fixed å›ºå®šå¤§å°çº¿ç¨‹æ± ï¼Œå¯åŠ¨æ—¶å»ºç«‹çº¿ç¨‹ï¼Œä¸å…³é—­ï¼Œä¸€ç›´æŒæœ‰ã€‚(ç¼ºçœ) cached ç¼“å­˜çº¿ç¨‹æ± ï¼Œç©ºé—²ä¸€åˆ†é’Ÿè‡ªåŠ¨åˆ é™¤ï¼Œéœ€è¦æ—¶é‡å»ºã€‚ limited å¯ä¼¸ç¼©çº¿ç¨‹æ± ï¼Œä½†æ± ä¸­çš„çº¿ç¨‹æ•°åªä¼šå¢é•¿ä¸ä¼šæ”¶ç¼©ã€‚åªå¢é•¿ä¸æ”¶ç¼©çš„ç›®çš„æ˜¯ä¸ºäº†é¿å…æ”¶ç¼©æ—¶çªç„¶æ¥äº†å¤§æµé‡å¼•èµ·çš„æ€§èƒ½é—®é¢˜ã€‚ ç›´æ¥é“¾æ¥å’Œåªè®¢é˜…æ¨¡å¼åœ¨å¼€å‘åŠæµ‹è¯•ç¯å¢ƒä¸‹ï¼Œç»å¸¸éœ€è¦ç»•è¿‡æ³¨å†Œä¸­å¿ƒï¼Œåªæµ‹è¯•æŒ‡å®šæœåŠ¡æä¾›è€…ï¼Œè¿™æ—¶å€™å¯èƒ½éœ€è¦ç‚¹å¯¹ç‚¹ç›´è¿ ç‚¹å¯¹ç‚¹ï¼Œå¯åœ¨ dubbo:reference ä¸­é…ç½® url æŒ‡å‘æä¾›è€…ï¼Œå°†ç»•è¿‡æ³¨å†Œä¸­å¿ƒï¼Œå¤šä¸ªåœ°å€ç”¨åˆ†å·éš”å¼€ æ³¨æ„ï¼šä¸ºäº†é¿å…å¤æ‚åŒ–çº¿ä¸Šç¯å¢ƒï¼Œä¸è¦åœ¨çº¿ä¸Šä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œåªåº”åœ¨æµ‹è¯•é˜¶æ®µä½¿ç”¨ã€‚ åªè®¢é˜…æ¨¡å¼ï¼šä¸€èˆ¬å’Œç›´è¿è¿ç”¨ï¼Œè§£å†³åœ¨æµ‹è¯•ç¯å¢ƒä¸‹æ³¨å†Œä¸­å¿ƒå…±ç”¨å¯èƒ½å¯¼è‡´ï¼Œçº¿ä¸Šä¸šåŠ¡å—åˆ°å½±å“çš„é—®é¢˜ ç¦ç”¨æ³¨å†Œé…ç½® æ³¨å†Œåˆ°æŒ‡å®šçš„æœåŠ¡å™¨ ä½¿ç”¨å¤šä¸ªåè®®å’Œä½¿ç”¨å¤šä¸ªæ³¨å†Œä¸­å¿ƒDubbo å…è®¸é…ç½®å¤šåè®®ï¼Œåœ¨ä¸åŒæœåŠ¡ä¸Šæ”¯æŒä¸åŒåè®®æˆ–è€…åŒä¸€æœåŠ¡ä¸ŠåŒæ—¶æ”¯æŒå¤šç§åè®®ã€‚ Dubbo æ”¯æŒåŒä¸€æœåŠ¡å‘å¤šæ³¨å†Œä¸­å¿ƒåŒæ—¶æ³¨å†Œï¼Œæˆ–è€…ä¸åŒæœåŠ¡åˆ†åˆ«æ³¨å†Œåˆ°ä¸åŒçš„æ³¨å†Œä¸­å¿ƒä¸Šå»ï¼Œç”šè‡³å¯ä»¥åŒæ—¶å¼•ç”¨æ³¨å†Œåœ¨ä¸åŒæ³¨å†Œä¸­å¿ƒä¸Šçš„åŒåæœåŠ¡ã€‚ åŒæ—¶é“¾æ¥åˆ°å¤šä¸ªä¸åŒçš„æ³¨å†Œä¸­å¿ƒ service çœç•¥ registryå±æ€§å°†è‡ªåŠ¨çš„ä½¿ç”¨é»˜è®¤é…ç½® åˆ†ç»„èšåˆæŒ‰ç»„åˆå¹¶è¿”å›ç»“æœ ï¼Œæ¯”å¦‚èœå•æœåŠ¡ï¼Œæ¥å£ä¸€æ ·ï¼Œä½†æœ‰å¤šç§å®ç°ï¼Œç”¨groupåŒºåˆ†ï¼Œç°åœ¨æ¶ˆè´¹æ–¹éœ€ä»æ¯ç§groupä¸­è°ƒç”¨ä¸€æ¬¡è¿”å›ç»“æœï¼Œåˆå¹¶ç»“æœè¿”å›ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°èšåˆèœå•é¡¹ã€‚ æ³¨æ„ï¼šdubboåªæœ‰é»˜è®¤çš„å››ç§ç»„åˆï¼Œlist set map array ï¼Œæ‰€ä»¥è¿”å›çš„ç»“æœå€¼å¿…é¡»è¦æ˜¯ä»¥ä¸Šå‡ ç§ç±»å‹ ç»“æœç¼“å­˜ç»“æœç¼“å­˜ ï¼Œç”¨äºåŠ é€Ÿçƒ­é—¨æ•°æ®çš„è®¿é—®é€Ÿåº¦ï¼ŒDubbo æä¾›å£°æ˜å¼ç¼“å­˜ï¼Œä»¥å‡å°‘ç”¨æˆ·åŠ ç¼“å­˜çš„å·¥ä½œé‡ 2ã€‚ å›å£°æµ‹è¯•å›å£°æµ‹è¯•ç”¨äºæ£€æµ‹æœåŠ¡æ˜¯å¦å¯ç”¨ï¼Œå›å£°æµ‹è¯•æŒ‰ç…§æ­£å¸¸è¯·æ±‚æµç¨‹æ‰§è¡Œï¼Œèƒ½å¤Ÿæµ‹è¯•æ•´ä¸ªè°ƒç”¨æ˜¯å¦é€šç•…ï¼Œå¯ç”¨äºç›‘æ§ã€‚ æ‰€æœ‰æœåŠ¡è‡ªåŠ¨å®ç° EchoService æ¥å£ï¼Œåªéœ€å°†ä»»æ„æœåŠ¡å¼•ç”¨å¼ºåˆ¶è½¬å‹ä¸º EchoServiceï¼Œå³å¯ä½¿ç”¨ã€‚ ä¸Šä¸‹æ–‡ä¿¡æ¯è·å–å’Œä»å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯ä¼ é€’å‚æ•°ä¸Šä¸‹æ–‡ä¸­å­˜æ”¾çš„æ˜¯å½“å‰è°ƒç”¨è¿‡ç¨‹ä¸­æ‰€éœ€çš„ç¯å¢ƒä¿¡æ¯ã€‚æ‰€æœ‰é…ç½®ä¿¡æ¯éƒ½å°†è½¬æ¢ä¸º URL çš„å‚æ•° RpcContext æ˜¯ä¸€ä¸ª ThreadLocal çš„ä¸´æ—¶çŠ¶æ€è®°å½•å™¨ï¼Œå½“æ¥æ”¶åˆ° RPC è¯·æ±‚ï¼Œæˆ–å‘èµ· RPC è¯·æ±‚æ—¶ï¼ŒRpcContext çš„çŠ¶æ€éƒ½ä¼šå˜åŒ–ã€‚æ¯”å¦‚ï¼šA è°ƒ Bï¼ŒB å†è°ƒ Cï¼Œåˆ™ B æœºå™¨ä¸Šï¼Œåœ¨ B è°ƒ C ä¹‹å‰ï¼ŒRpcContext è®°å½•çš„æ˜¯ A è°ƒ B çš„ä¿¡æ¯ï¼Œåœ¨ B è°ƒ C ä¹‹åï¼ŒRpcContext è®°å½•çš„æ˜¯ B è°ƒ C çš„ä¿¡æ¯ã€‚ å¯¹äºæœåŠ¡çš„æ¶ˆè´¹æ–¹ï¼Œæ³¨æ„åªæœ‰åœ¨ä½¿ç”¨rpcè°ƒç”¨ä¹‹åæ‰çŠ¶æ€ä¼šå‘ç”Ÿæ”¹å˜ æœåŠ¡æä¾›æ–¹ï¼Œæ³¨æ„åªæœ‰åœ¨æœåŠ¡ç±»ä¸­è¿›è¡Œæ³¨å†Œæ‰èƒ½åšæŒºåˆ°æ•°æ® å‚æ•°ä¼ é€’æµç¨‹å›¾ åœ¨æœåŠ¡æ¶ˆè´¹æ–¹ç«¯è®¾ç½®éšå¼å‚æ•° åœ¨æœåŠ¡æä¾›æ–¹ç«¯è·å–éšå¼å‚æ•° å¼‚æ­¥è°ƒç”¨ æ³¨æ„:è¦åœ¨å®¢æˆ·ç«¯è¿›è¡Œé…ç½® è°ƒç”¨ä»£ç  ä½ ä¹Ÿå¯ä»¥è®¾ç½®æ˜¯å¦ç­‰å¾…æ¶ˆæ¯å‘å‡º sent&#x3D;â€trueâ€ ç­‰å¾…æ¶ˆæ¯å‘å‡ºï¼Œæ¶ˆæ¯å‘é€å¤±è´¥å°†æŠ›å‡ºå¼‚å¸¸ã€‚ sent&#x3D;â€falseâ€ ä¸ç­‰å¾…æ¶ˆæ¯å‘å‡ºï¼Œå°†æ¶ˆæ¯æ”¾å…¥ IO é˜Ÿåˆ—ï¼Œå³åˆ»è¿”å›ã€‚ å¦‚æœä½ åªæ˜¯æƒ³å¼‚æ­¥ï¼Œå®Œå…¨å¿½ç•¥è¿”å›å€¼ï¼Œå¯ä»¥é…ç½® return&#x3D;â€falseâ€ï¼Œä»¥å‡å°‘ Future å¯¹è±¡çš„åˆ›å»ºå’Œç®¡ç†æˆæœ¬ æ³¨æ„:å¦‚æœæœåŠ¡ç«¯é•¿æ—¶é—´è¿›è¡Œå µå¡ï¼Œå®¢æˆ·ç«¯å¯èƒ½ä¼šå‘ç”Ÿè¶…æ—¶é—®é¢˜ï¼Œæ‰€ä»¥æœ‰æ—¶å¯èƒ½è¦åœ¨å‰å°è®¾ç½®è¶…æ—¶æ—¶é—´ å‘ç‚¹ï¼šdubboçš„ä¸€éƒ¨è°ƒç”¨ä¼šå»¶ç»­ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´aä¸€éƒ¨è°ƒç”¨bï¼ŒbåŒæ­¥è°ƒç”¨cï¼Œå…¶å®ä¸Šbè¿˜æ˜¯å¼‚æ­¥è°ƒç”¨c dubboå†…ç½®è°ƒç”¨æ‹¦æˆªåœ¨æœ¬åœ°æ‹¦æˆªæ–¹æ³•è°ƒç”¨è¿‡ç¨‹ä¸­çš„ before after throww returnè¿‡ç¨‹ å…¶å®ç›¸å½“äºä¸ºdubboè¿œç¨‹è°ƒç”¨çš„å¤„ç†å·¥ç¨‹æä¾›äº†ç»Ÿä¸€çš„æ¨¡æ¿ ï¼ˆæ³¨æ„dubboçš„å“²å­¦æ€æƒ³â€”â€”æä¾›ä¸€ä¸ªå…¬å…±çš„apiï¼Œä½¿ç”¨apiè¿›è¡Œç›¸äº’çš„è°ƒç”¨ï¼‰ æœåŠ¡ç«¯é…ç½®æ–¹æ³• å…¬å…±apiæä¾›ï¼ŒBarserviceæ¥å£çš„Stubå®ç° æœ¬åœ°ä¼ªè£… é€šå¸¸ç”¨äºæœåŠ¡é™çº§ï¼Œæ¯”å¦‚æŸéªŒæƒæœåŠ¡ï¼Œå½“æœåŠ¡æä¾›æ–¹å…¨éƒ¨æŒ‚æ‰åï¼Œå®¢æˆ·ç«¯ä¸æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œæ˜¯é€šè¿‡ Mock æ•°æ®è¿”å›æˆæƒå¤±è´¥ã€‚ æœåŠ¡ç«¯é…ç½®æ–¹æ³• å…¬å…±apiæä¾›æ¥å£çš„Mockå®ç° è¿™æ ·å½“å‘ç”Ÿè°ƒç”¨å¼‚å¸¸çš„æ—¶å€™ï¼Œå°†ä¼šè°ƒç”¨ä¸Šé¢Mockç±»ç›¸åº”çš„æ–¹æ³•ï¼Œä½¿ç”¨è°ƒç”¨ æœåŠ¡æ‡’é“¾æ¥å’Œå»¶è¿Ÿæš´éœ²å’Œå¯¹åº”è°ƒç”¨ å¹¶å‘æ§åˆ¶å’Œé“¾æ¥æ§åˆ¶æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å¹¶å‘æ§åˆ¶é…ç½® æ³¨æ„ï¼šæœåŠ¡ç«¯çš„å¹¶å‘æ‰§è¡Œå‚æ•°æ§åˆ¶åªèƒ½åœ¨æœåŠ¡ç«¯é…ç½®ï¼Œé…ç½®å‚æ•°executes ï¼Œ å®¢æˆ·ç«¯ å¹¶å‘æ‰§è¡Œå‚æ•°ï¼Œå¯åœ¨æœåŠ¡ç«¯æˆ–è€…å®¢æˆ·ç«¯é…ç½® å‚æ•°active å®¢æˆ·ç«¯ä¼˜å…ˆ æœåŠ¡ç«¯é“¾æ¥æ§åˆ¶ å®¢æˆ·ç«¯é“¾æ¥æ§åˆ¶ ä¸€ä¸ªæ¦‚å¿µï¼šèŒƒåŒ–å¼•ç”¨æ³›åŒ–æ¥å£è°ƒç”¨æ–¹å¼ä¸»è¦ç”¨äºå®¢æˆ·ç«¯æ²¡æœ‰ API æ¥å£åŠæ¨¡å‹ç±»å…ƒçš„æƒ…å†µï¼Œå‚æ•°åŠè¿”å›å€¼ä¸­çš„æ‰€æœ‰ POJO å‡ç”¨ Map è¡¨ç¤ºï¼Œé€šå¸¸ç”¨äºæ¡†æ¶é›†æˆï¼Œ","date":"2024-12-31","categories":["java"],"tags":["dubbo"]},{"title":"dubbo-æ·±å…¥(4)- é›†ç¾¤æ¶æ„è®¾è®¡","url":"/2024/12/31/dubbo-æ·±å…¥-4---é›†ç¾¤æ¶æ„è®¾è®¡/","content":"æ·±å…¥dubboï¼ˆå››ï¼‰- é›†ç¾¤æ¶æ„è®¾è®¡è¿™æ¬¡è·Ÿè¸ªæºä»£ç ï¼Œçœ‹ä¸€çœ‹dubboåœ¨è¿›è¡Œè¿œç¨‹è°ƒç”¨çš„æ—¶å€™è¿›è¡Œäº†é‚£äº›æ–¹æ³• é¦–å…ˆè°ƒç”¨æˆ‘ä»¬å£°æ˜çš„æ¥å£æ–¹æ³• å¾ˆæ˜æ˜¾è¿›å…¥äº†åŠ¨æ€ä»£ç†ç±»ä¸­ æ³¨æ„è¿”å›å€¼ ä¸Šä¸€æ­¥çš„returnæ–¹æ³•ä¸­æˆ‘ä»¬éœ€è¦è¿›ä¸€æ­¥åˆ†æinvokeï¼ˆxxxï¼‰æ–¹æ³•çš„è¿‡ç¨‹ æ¥åˆ°äº†ç¬¬ä¸€ä¸ªå…³é”®çš„ç±»ä¸­ AbstractClusterInvoker é€šè¿‡ ä¸‹å›¾ä¸­çš„ä¸¤ä¸ªæ–¹æ³•æˆ‘ä»¬æ‰¾åˆ°äº† ä¸‹ä¸€ä¸ªå…³é”®directory æ¥åˆ°äº†directoryç±»ä¸­ listæ–¹æ³•æ˜¯è¿”å›ä¸€ä¸ªæ‰€éœ€è¦çš„invokeç»“æœé›†åˆ ä¸­é—´ä½¿ç”¨directory è¿”å›æ‰€æœ‰é›†åˆå’Œä½¿ç”¨routerå¯¹ç»“æœé›†è¿›è¡Œç­›é€‰","date":"2024-12-31","categories":["java"],"tags":["dubbo"]},{"title":"dubboå­¦ä¹ å’Œä½¿ç”¨(2)-ä½¿ç”¨åˆæ¢å’Œé…ç½®æ–¹æ³•","url":"/2024/12/31/dubboå­¦ä¹ å’Œä½¿ç”¨-2--ä½¿ç”¨åˆæ¢å’Œé…ç½®æ–¹æ³•/","content":"å¿«é€Ÿå¯åŠ¨Dubbo é‡‡ç”¨å…¨ Spring é…ç½®æ–¹å¼ï¼Œé€æ˜åŒ–æ¥å…¥åº”ç”¨ï¼Œå¯¹åº”ç”¨æ²¡æœ‰ä»»ä½• API ä¾µå…¥ï¼Œåªéœ€ç”¨ Spring åŠ è½½ Dubbo çš„é…ç½®å³å¯ï¼ŒDubbo åŸºäº Spring çš„ Schema æ‰©å±•è¿›è¡ŒåŠ è½½ã€‚ å¦‚æœä¸æƒ³ä½¿ç”¨ Spring é…ç½®ï¼Œå¯ä»¥é€šè¿‡ API çš„æ–¹å¼ è¿›è¡Œè°ƒç”¨ã€‚ æœåŠ¡æä¾›è€… å®šä¹‰æœåŠ¡æ¥å£ DemoService.javaï¼š åœ¨æœåŠ¡æä¾›æ–¹å®ç°æ¥å£DemoServiceImpl.javaï¼š ç”¨ Spring é…ç½®å£°æ˜æš´éœ²æœåŠ¡provider.xmlï¼š åŠ è½½ Spring é…ç½®Provider.javaï¼š æœåŠ¡æ¶ˆè´¹è€… é€šè¿‡ Spring é…ç½®å¼•ç”¨è¿œç¨‹æœåŠ¡consumer.xmlï¼š åŠ è½½Springé…ç½®ï¼Œå¹¶è°ƒç”¨è¿œç¨‹æœåŠ¡Consumer.javaï¼š dubbo çš„å››ä¸­é…ç½®æ–¹å¼xml é…ç½®æ–¹æ³•é…ç½®å®ä¾‹ æ‰€æœ‰æ ‡ç­¾éƒ½æ”¯æŒè‡ªå®šä¹‰å‚æ•°ï¼Œç”¨äºä¸åŒæ‰©å±•ç‚¹å®ç°çš„ç‰¹æ®Šé…ç½®ï¼Œå¦‚ï¼š dubbo æ‰€æœ‰çš„æ ‡ç­¾å’Œä½œç”¨ æ ‡ç­¾ ç”¨é€” è§£é‡Š dubbo:service/ æœåŠ¡é…ç½® ç”¨äºæš´éœ²ä¸€ä¸ªæœåŠ¡ï¼Œå®šä¹‰æœåŠ¡çš„å…ƒä¿¡æ¯ï¼Œä¸€ä¸ªæœåŠ¡å¯ä»¥ç”¨å¤šä¸ªåè®®æš´éœ²ï¼Œä¸€ä¸ªæœåŠ¡ä¹Ÿå¯ä»¥æ³¨å†Œåˆ°å¤šä¸ªæ³¨å†Œä¸­å¿ƒ dubbo:reference/ å¼•ç”¨é…ç½® ç”¨äºåˆ›å»ºä¸€ä¸ªè¿œç¨‹æœåŠ¡ä»£ç†ï¼Œä¸€ä¸ªå¼•ç”¨å¯ä»¥æŒ‡å‘å¤šä¸ªæ³¨å†Œä¸­å¿ƒ dubbo:protocol/ åè®®é…ç½® ç”¨äºé…ç½®æä¾›æœåŠ¡çš„åè®®ä¿¡æ¯ï¼Œåè®®ç”±æä¾›æ–¹æŒ‡å®šï¼Œæ¶ˆè´¹æ–¹è¢«åŠ¨æ¥å— dubbo:application/ åº”ç”¨é…ç½® ç”¨äºé…ç½®å½“å‰åº”ç”¨ä¿¡æ¯ï¼Œä¸ç®¡è¯¥åº”ç”¨æ˜¯æä¾›è€…è¿˜æ˜¯æ¶ˆè´¹è€… dubbo:module/ æ¨¡å—é…ç½® ç”¨äºé…ç½®å½“å‰æ¨¡å—ä¿¡æ¯ï¼Œå¯é€‰ dubbo:registry/ æ³¨å†Œä¸­å¿ƒé…ç½® ç”¨äºé…ç½®è¿æ¥æ³¨å†Œä¸­å¿ƒç›¸å…³ä¿¡æ¯ dubbo:monitor/ ç›‘æ§ä¸­å¿ƒé…ç½® ç”¨äºé…ç½®è¿æ¥ç›‘æ§ä¸­å¿ƒç›¸å…³ä¿¡æ¯ï¼Œå¯é€‰ dubbo:provider/ æä¾›æ–¹é…ç½® å½“ ProtocolConfig å’Œ ServiceConfig æŸå±æ€§æ²¡æœ‰é…ç½®æ—¶ï¼Œé‡‡ç”¨æ­¤ç¼ºçœå€¼ï¼Œå¯é€‰ dubbo:consumer/ æ¶ˆè´¹æ–¹é…ç½® å½“ ReferenceConfig æŸå±æ€§æ²¡æœ‰é…ç½®æ—¶ï¼Œé‡‡ç”¨æ­¤ç¼ºçœå€¼ï¼Œå¯é€‰ dubbo:method/ æ–¹æ³•é…ç½® ç”¨äº ServiceConfig å’Œ ReferenceConfig æŒ‡å®šæ–¹æ³•çº§çš„é…ç½®ä¿¡æ¯ dubbo:argument/ å‚æ•°é…ç½® ç”¨äºæŒ‡å®šæ–¹æ³•å‚æ•°é…ç½® é…ç½®è¦†ç›–å…³ç³» ä»¥ timeout ä¸ºä¾‹ï¼Œæ˜¾ç¤ºäº†é…ç½®çš„æŸ¥æ‰¾é¡ºåºï¼Œå…¶å®ƒ retries, loadbalance, actives ç­‰ç±»ä¼¼ï¼š æ–¹æ³•çº§ä¼˜å…ˆï¼Œæ¥å£çº§æ¬¡ä¹‹ï¼Œå…¨å±€é…ç½®å†æ¬¡ä¹‹ã€‚ å¦‚æœçº§åˆ«ä¸€æ ·ï¼Œåˆ™æ¶ˆè´¹æ–¹ä¼˜å…ˆï¼Œæä¾›æ–¹æ¬¡ä¹‹ã€‚ å…¶ä¸­ï¼ŒæœåŠ¡æä¾›æ–¹é…ç½®ï¼Œé€šè¿‡ URL ç»ç”±æ³¨å†Œä¸­å¿ƒä¼ é€’ç»™æ¶ˆè´¹æ–¹ã€‚ ä»ä¸Šåˆ°ä¸‹ä¼˜å…ˆçº§é€’å‡ å±æ€§é…ç½®å¦‚æœå…¬å…±é…ç½®å¾ˆç®€å•ï¼Œæ²¡æœ‰å¤šæ³¨å†Œä¸­å¿ƒï¼Œå¤šåè®®ç­‰æƒ…å†µï¼Œæˆ–è€…æƒ³å¤šä¸ª Spring å®¹å™¨æƒ³å…±äº«é…ç½®ï¼Œå¯ä»¥ä½¿ç”¨ dubbo.properties ä½œä¸ºç¼ºçœé…ç½®ã€‚ æ˜ å°„è§„åˆ™å°† XML é…ç½®çš„æ ‡ç­¾åï¼ŒåŠ å±æ€§åï¼Œç”¨ç‚¹åˆ†éš”ï¼Œå¤šä¸ªå±æ€§æ‹†æˆå¤šè¡Œ æ¯”å¦‚ï¼šdubbo.application.name&#x3D;fooç­‰ä»·äº<dubbo:application name&#x3D;â€fooâ€ &#x2F;> æ¯”å¦‚ï¼šdubbo.registry.address&#x3D;10.20.153.10:9090ç­‰ä»·äº<dubbo:registry address&#x3D;â€10.20.153.10:9090â€ &#x2F;>å¦‚æœ XML æœ‰å¤šè¡ŒåŒåæ ‡ç­¾é…ç½®ï¼Œå¯ç”¨ id å·åŒºåˆ†ï¼Œå¦‚æœæ²¡æœ‰ id å·å°†å¯¹æ‰€æœ‰åŒåæ ‡ç­¾ç”Ÿæ•ˆ æ¯”å¦‚ï¼šdubbo.protocol.rmi.port&#x3D;1234ç­‰ä»·äº<dubbo:protocol id&#x3D;â€rmiâ€ name&#x3D;â€rmiâ€ port&#x3D;â€1099â€ &#x2F;> [2] æ¯”å¦‚ï¼šdubbo.registry.china.address&#x3D;10.20.153.10:9090ç­‰ä»·äº<dubbo:registry id&#x3D;â€chinaâ€ address&#x3D;â€10.20.153.10:9090â€ &#x2F;>ä¸‹é¢æ˜¯ dubbo.properties çš„ä¸€ä¸ªå…¸å‹é…ç½®ï¼š è¦†ç›–ç­–ç•¥ï¼ˆä»ä¸Šåˆ°ä¸‹ä¼˜å…ˆçº§é€’å‡ï¼‰ å¦‚æœ classpath æ ¹ç›®å½•ä¸‹å­˜åœ¨å¤šä¸ª dubbo.propertiesï¼Œæ¯”å¦‚å¤šä¸ª jar åŒ…ä¸­æœ‰ dubbo.propertiesï¼ŒDubbo ä¼šä»»æ„åŠ è½½ï¼Œå¹¶æ‰“å° Error æ—¥å¿—ï¼Œåç»­å¯èƒ½æ”¹ä¸ºæŠ›å¼‚å¸¸ã€‚ åè®®çš„ id æ²¡é…æ—¶ï¼Œç¼ºçœä½¿ç”¨åè®®åä½œä¸º id api é…ç½®API å±æ€§xmlä¸é…ç½®é¡¹ä¸€å¯¹ä¸€ æœåŠ¡æä¾›è€… æœåŠ¡æ¶ˆè´¹è€… ç‰¹æ®Šåœºæ™¯ä¸‹é¢åªåˆ—å‡ºä¸åŒçš„åœ°æ–¹ï¼Œå…¶å®ƒå‚è§ä¸Šé¢çš„å†™æ³• æ–¹æ³•çº§è®¾ç½® ç‚¹å¯¹ç‚¹ç›´è¿ APIä½¿ç”¨èŒƒå›´è¯´æ˜ï¼šAPI ä»…ç”¨äº OpenAPI, ESB, Test, Mock ç­‰ç³»ç»Ÿé›†æˆï¼Œæ™®é€šæœåŠ¡æä¾›æ–¹æˆ–æ¶ˆè´¹æ–¹ï¼Œè¯·é‡‡ç”¨XML é…ç½®æ–¹å¼ä½¿ç”¨ Dubbo æ³¨è§£é…ç½® æœåŠ¡æä¾›æ–¹ Serviceæ³¨è§£æš´éœ²æœåŠ¡ javaconfigå½¢å¼é…ç½®å…¬å…±æ¨¡å— æŒ‡å®šdubboæ‰«æè·¯å¾„ æœåŠ¡æ¶ˆè´¹æ–¹ Referenceæ³¨è§£å¼•ç”¨æœåŠ¡ javaconfigå½¢å¼é…ç½®å…¬å…±æ¨¡å— æŒ‡å®šdubboæ‰«æè·¯å¾„ æ³¨æ„ å¦‚æœä½ æ›¾ä½¿ç”¨æ—§ç‰ˆannotationé…ç½®ï¼Œè¯·åˆ é™¤æ‰€æœ‰ç›¸å…³é…ç½®ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸ªç‰ˆæœ¬åˆ é™¤æ‰€æœ‰æ—§ç‰ˆé…ç½®é¡¹ã€‚","date":"2024-12-31","categories":["java"],"tags":["dubbo"]},{"title":"dubboå­¦ä¹ å’Œä½¿ç”¨(3)-dubboåŠŸèƒ½(1)","url":"/2024/12/31/dubboå­¦ä¹ å’Œä½¿ç”¨-3--dubboåŠŸèƒ½-1-/","content":"å¯åŠ¨æ—¶æ£€æŸ¥Dubbo ç¼ºçœä¼šåœ¨å¯åŠ¨æ—¶æ£€æŸ¥ä¾èµ–çš„æœåŠ¡æ˜¯å¦å¯ç”¨ï¼Œä¸å¯ç”¨æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œé˜»æ­¢ Spring åˆå§‹åŒ–å®Œæˆï¼Œä»¥ä¾¿ä¸Šçº¿æ—¶ï¼Œèƒ½åŠæ—©å‘ç°é—®é¢˜ï¼Œé»˜è®¤ check&#x3D;â€trueâ€ã€‚ æ³¨æ„ä½¿ç”¨æ‡’åŠ è½½çš„æ—¶å€™å¯ä»¥æŒ‡å®šè¿™ä¸ªæ–¹æ³•ä¸ºfalseï¼Œå½“è¿™ä¸ªä¸ºfalseçš„æ—¶å€™ï¼Œå¦‚æœæœåŠ¡ä¸å¯ç”¨å°†ä¼šä¸ºnull è€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸ï¼Œå½“æœåŠ¡æ¢å¤æ—¶ï¼Œèƒ½è‡ªåŠ¨è¿ä¸Šã€‚ é…ç½®æ–¹æ³•é€šè¿‡ spring é…ç½®æ–‡ä»¶å…³é—­æŸä¸ªæœåŠ¡çš„å¯åŠ¨æ—¶æ£€æŸ¥ (æ²¡æœ‰æä¾›è€…æ—¶æŠ¥é”™)ï¼š å…³é—­æ‰€æœ‰æœåŠ¡çš„å¯åŠ¨æ—¶æ£€æŸ¥ (æ²¡æœ‰æä¾›è€…æ—¶æŠ¥é”™)ï¼š å…³é—­æ³¨å†Œä¸­å¿ƒå¯åŠ¨æ—¶æ£€æŸ¥ (æ³¨å†Œè®¢é˜…å¤±è´¥æ—¶æŠ¥é”™)ï¼š é€šè¿‡ dubbo.properties é…ç½®çš„å«ä¹‰ dubbo.reference.check&#x3D;falseï¼Œå¼ºåˆ¶æ”¹å˜æ‰€æœ‰ reference çš„ check å€¼ï¼Œå°±ç®—é…ç½®ä¸­æœ‰å£°æ˜ï¼Œä¹Ÿä¼šè¢«è¦†ç›–ã€‚ dubbo.consumer.check&#x3D;falseï¼Œæ˜¯è®¾ç½® check çš„ç¼ºçœå€¼ï¼Œå¦‚æœé…ç½®ä¸­æœ‰æ˜¾å¼çš„å£°æ˜ï¼Œå¦‚ï¼š<dubbo:reference check&#x3D;â€trueâ€&#x2F;>ï¼Œä¸ä¼šå—å½±å“ã€‚ dubbo.registry.check&#x3D;falseï¼Œå‰é¢ä¸¤ä¸ªéƒ½æ˜¯æŒ‡è®¢é˜…æˆåŠŸï¼Œä½†æä¾›è€…åˆ—è¡¨æ˜¯å¦ä¸ºç©ºæ˜¯å¦æŠ¥é”™ï¼Œå¦‚æœæ³¨å†Œè®¢é˜…å¤±è´¥æ—¶ï¼Œä¹Ÿå…è®¸å¯åŠ¨ï¼Œéœ€ä½¿ç”¨æ­¤é€‰é¡¹ï¼Œå°†åœ¨åå°å®šæ—¶é‡è¯•ã€‚ é›†ç¾¤å®¹é”™ å„èŠ‚ç‚¹å…³ç³»ï¼š è¿™é‡Œçš„ Invoker æ˜¯ Provider çš„ä¸€ä¸ªå¯è°ƒç”¨ Service çš„æŠ½è±¡ï¼ŒInvoker å°è£…äº† Provider åœ°å€åŠ Service æ¥å£ä¿¡æ¯ Directory ä»£è¡¨å¤šä¸ª Invokerï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆ List ï¼Œä½†ä¸ List ä¸åŒçš„æ˜¯ï¼Œå®ƒçš„å€¼å¯èƒ½æ˜¯åŠ¨æ€å˜åŒ–çš„ï¼Œæ¯”å¦‚æ³¨å†Œä¸­å¿ƒæ¨é€å˜æ›´ Cluster å°† Directory ä¸­çš„å¤šä¸ª Invoker ä¼ªè£…æˆä¸€ä¸ª Invokerï¼Œå¯¹ä¸Šå±‚é€æ˜ï¼Œä¼ªè£…è¿‡ç¨‹åŒ…å«äº†å®¹é”™é€»è¾‘ï¼Œè°ƒç”¨å¤±è´¥åï¼Œé‡è¯•å¦ä¸€ä¸ª Router è´Ÿè´£ä»å¤šä¸ª Invoker ä¸­æŒ‰è·¯ç”±è§„åˆ™é€‰å‡ºå­é›†ï¼Œæ¯”å¦‚è¯»å†™åˆ†ç¦»ï¼Œåº”ç”¨éš”ç¦»ç­‰ LoadBalance è´Ÿè´£ä»å¤šä¸ª Invoker ä¸­é€‰å‡ºå…·ä½“çš„ä¸€ä¸ªç”¨äºæœ¬æ¬¡è°ƒç”¨ï¼Œé€‰çš„è¿‡ç¨‹åŒ…å«äº†è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œè°ƒç”¨å¤±è´¥åï¼Œéœ€è¦é‡é€‰ é›†ç¾¤å®¹é”™æ¨¡å¼ Failover Cluster å¤±è´¥è‡ªåŠ¨åˆ‡æ¢ï¼Œå½“å‡ºç°å¤±è´¥ï¼Œé‡è¯•å…¶å®ƒæœåŠ¡å™¨ [1]ã€‚é€šå¸¸ç”¨äºè¯»æ“ä½œï¼Œä½†é‡è¯•ä¼šå¸¦æ¥æ›´é•¿å»¶è¿Ÿã€‚å¯é€šè¿‡ retries&#x3D;â€2â€ æ¥è®¾ç½®é‡è¯•æ¬¡æ•°(ä¸å«ç¬¬ä¸€æ¬¡)ã€‚ é‡è¯•æ¬¡æ•°é…ç½®å¦‚ä¸‹ï¼š Failfast Clusterå¿«é€Ÿå¤±è´¥ï¼Œåªå‘èµ·ä¸€æ¬¡è°ƒç”¨ï¼Œå¤±è´¥ç«‹å³æŠ¥é”™ã€‚é€šå¸¸ç”¨äºéå¹‚ç­‰æ€§çš„å†™æ“ä½œï¼Œæ¯”å¦‚æ–°å¢è®°å½•ã€‚ Failsafe Clusterå¤±è´¥å®‰å…¨ï¼Œå‡ºç°å¼‚å¸¸æ—¶ï¼Œç›´æ¥å¿½ç•¥ã€‚é€šå¸¸ç”¨äºå†™å…¥å®¡è®¡æ—¥å¿—ç­‰æ“ä½œã€‚ Failback Clusterå¤±è´¥è‡ªåŠ¨æ¢å¤ï¼Œåå°è®°å½•å¤±è´¥è¯·æ±‚ï¼Œå®šæ—¶é‡å‘ã€‚é€šå¸¸ç”¨äºæ¶ˆæ¯é€šçŸ¥æ“ä½œã€‚ Forking Clusterå¹¶è¡Œè°ƒç”¨å¤šä¸ªæœåŠ¡å™¨ï¼Œåªè¦ä¸€ä¸ªæˆåŠŸå³è¿”å›ã€‚é€šå¸¸ç”¨äºå®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„è¯»æ“ä½œï¼Œä½†éœ€è¦æµªè´¹æ›´å¤šæœåŠ¡èµ„æºã€‚å¯é€šè¿‡ forks&#x3D;â€2â€ æ¥è®¾ç½®æœ€å¤§å¹¶è¡Œæ•°ã€‚ Broadcast Clusterå¹¿æ’­è°ƒç”¨æ‰€æœ‰æä¾›è€…ï¼Œé€ä¸ªè°ƒç”¨ï¼Œä»»æ„ä¸€å°æŠ¥é”™åˆ™æŠ¥é”™ [2]ã€‚é€šå¸¸ç”¨äºé€šçŸ¥æ‰€æœ‰æä¾›è€…æ›´æ–°ç¼“å­˜æˆ–æ—¥å¿—ç­‰æœ¬åœ°èµ„æºä¿¡æ¯ã€‚ é›†ç¾¤æ¨¡å¼é…ç½®æŒ‰ç…§ä»¥ä¸‹ç¤ºä¾‹åœ¨æœåŠ¡æä¾›æ–¹å’Œæ¶ˆè´¹æ–¹é…ç½®é›†ç¾¤æ¨¡å¼ è´Ÿè½½å‡è¡¡åœ¨é›†ç¾¤è´Ÿè½½å‡è¡¡æ—¶ï¼ŒDubbo æä¾›äº†å¤šç§å‡è¡¡ç­–ç•¥ï¼Œç¼ºçœä¸º random éšæœºè°ƒç”¨ã€‚ è´Ÿè½½å‡è¡¡ç­–ç•¥ Random LoadBalance éšæœºï¼ŒæŒ‰æƒé‡è®¾ç½®éšæœºæ¦‚ç‡ã€‚åœ¨ä¸€ä¸ªæˆªé¢ä¸Šç¢°æ’çš„æ¦‚ç‡é«˜ï¼Œä½†è°ƒç”¨é‡è¶Šå¤§åˆ†å¸ƒè¶Šå‡åŒ€ï¼Œè€Œä¸”æŒ‰æ¦‚ç‡ä½¿ç”¨æƒé‡åä¹Ÿæ¯”è¾ƒå‡åŒ€ï¼Œæœ‰åˆ©äºåŠ¨æ€è°ƒæ•´æä¾›è€…æƒé‡ã€‚ RoundRobin LoadBalance è½®å¾ªï¼ŒæŒ‰å…¬çº¦åçš„æƒé‡è®¾ç½®è½®å¾ªæ¯”ç‡ã€‚å­˜åœ¨æ…¢çš„æä¾›è€…ç´¯ç§¯è¯·æ±‚çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šç¬¬äºŒå°æœºå™¨å¾ˆæ…¢ï¼Œä½†æ²¡æŒ‚ï¼Œå½“è¯·æ±‚è°ƒåˆ°ç¬¬äºŒå°æ—¶å°±å¡åœ¨é‚£ï¼Œä¹…è€Œä¹…ä¹‹ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å¡åœ¨è°ƒåˆ°ç¬¬äºŒå°ä¸Šã€‚ LeastActive LoadBalance æœ€å°‘æ´»è·ƒè°ƒç”¨æ•°ï¼Œç›¸åŒæ´»è·ƒæ•°çš„éšæœºï¼Œæ´»è·ƒæ•°æŒ‡è°ƒç”¨å‰åè®¡æ•°å·®ã€‚ä½¿æ…¢çš„æä¾›è€…æ”¶åˆ°æ›´å°‘è¯·æ±‚ï¼Œå› ä¸ºè¶Šæ…¢çš„æä¾›è€…çš„è°ƒç”¨å‰åè®¡æ•°å·®ä¼šè¶Šå¤§ã€‚ ConsistentHash LoadBalanceä¸€è‡´æ€§ Hashï¼Œç›¸åŒå‚æ•°çš„è¯·æ±‚æ€»æ˜¯å‘åˆ°åŒä¸€æä¾›è€…ã€‚å½“æŸä¸€å°æä¾›è€…æŒ‚æ—¶ï¼ŒåŸæœ¬å‘å¾€è¯¥æä¾›è€…çš„è¯·æ±‚ï¼ŒåŸºäºè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¹³æ‘Šåˆ°å…¶å®ƒæä¾›è€…ï¼Œä¸ä¼šå¼•èµ·å‰§çƒˆå˜åŠ¨ã€‚ç®—æ³•å‚è§ï¼šhttp://en.wikipedia.org/wiki/Consistent_hashingç¼ºçœåªå¯¹ç¬¬ä¸€ä¸ªå‚æ•° Hashï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® ç¼ºçœç”¨ 160 ä»½è™šæ‹ŸèŠ‚ç‚¹ï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® é…ç½®æœåŠ¡ç«¯æœåŠ¡çº§åˆ« å®¢æˆ·ç«¯æœåŠ¡çº§åˆ« æœåŠ¡ç«¯æ–¹æ³•çº§åˆ« å®¢æˆ·ç«¯æ–¹æ³•çº§åˆ« çº¿ç¨‹æ¨¡å‹å¦‚æœäº‹ä»¶å¤„ç†çš„é€»è¾‘èƒ½è¿…é€Ÿå®Œæˆï¼Œå¹¶ä¸”ä¸ä¼šå‘èµ·æ–°çš„ IO è¯·æ±‚ï¼Œæ¯”å¦‚åªæ˜¯åœ¨å†…å­˜ä¸­è®°ä¸ªæ ‡è¯†ï¼Œåˆ™ç›´æ¥åœ¨ IO çº¿ç¨‹ä¸Šå¤„ç†æ›´å¿«ï¼Œå› ä¸ºå‡å°‘äº†çº¿ç¨‹æ± è°ƒåº¦ã€‚ ä½†å¦‚æœäº‹ä»¶å¤„ç†é€»è¾‘è¾ƒæ…¢ï¼Œæˆ–è€…éœ€è¦å‘èµ·æ–°çš„ IO è¯·æ±‚ï¼Œæ¯”å¦‚éœ€è¦æŸ¥è¯¢æ•°æ®åº“ï¼Œåˆ™å¿…é¡»æ´¾å‘åˆ°çº¿ç¨‹æ± ï¼Œå¦åˆ™ IO çº¿ç¨‹é˜»å¡ï¼Œå°†å¯¼è‡´ä¸èƒ½æ¥æ”¶å…¶å®ƒè¯·æ±‚ã€‚ å¦‚æœç”¨ IO çº¿ç¨‹å¤„ç†äº‹ä»¶ï¼Œåˆåœ¨äº‹ä»¶å¤„ç†è¿‡ç¨‹ä¸­å‘èµ·æ–°çš„ IO è¯·æ±‚ï¼Œæ¯”å¦‚åœ¨è¿æ¥äº‹ä»¶ä¸­å‘èµ·ç™»å½•è¯·æ±‚ï¼Œä¼šæŠ¥â€œå¯èƒ½å¼•å‘æ­»é”â€å¼‚å¸¸ï¼Œä½†ä¸ä¼šçœŸæ­»é”ã€‚ å› æ­¤ï¼Œéœ€è¦é€šè¿‡ä¸åŒçš„æ´¾å‘ç­–ç•¥å’Œä¸åŒçš„çº¿ç¨‹æ± é…ç½®çš„ç»„åˆæ¥åº”å¯¹ä¸åŒçš„åœºæ™¯: Dispatcher all æ‰€æœ‰æ¶ˆæ¯éƒ½æ´¾å‘åˆ°çº¿ç¨‹æ± ï¼ŒåŒ…æ‹¬è¯·æ±‚ï¼Œå“åº”ï¼Œè¿æ¥äº‹ä»¶ï¼Œæ–­å¼€äº‹ä»¶ï¼Œå¿ƒè·³ç­‰ã€‚ direct æ‰€æœ‰æ¶ˆæ¯éƒ½ä¸æ´¾å‘åˆ°çº¿ç¨‹æ± ï¼Œå…¨éƒ¨åœ¨ IO çº¿ç¨‹ä¸Šç›´æ¥æ‰§è¡Œã€‚ message åªæœ‰è¯·æ±‚å“åº”æ¶ˆæ¯æ´¾å‘åˆ°çº¿ç¨‹æ± ï¼Œå…¶å®ƒè¿æ¥æ–­å¼€äº‹ä»¶ï¼Œå¿ƒè·³ç­‰æ¶ˆæ¯ï¼Œç›´æ¥åœ¨ IO çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚ execution åªè¯·æ±‚æ¶ˆæ¯æ´¾å‘åˆ°çº¿ç¨‹æ± ï¼Œä¸å«å“åº”ï¼Œå“åº”å’Œå…¶å®ƒè¿æ¥æ–­å¼€äº‹ä»¶ï¼Œå¿ƒè·³ç­‰æ¶ˆæ¯ï¼Œç›´æ¥åœ¨ IO çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚ connection åœ¨ IO çº¿ç¨‹ä¸Šï¼Œå°†è¿æ¥æ–­å¼€äº‹ä»¶æ”¾å…¥é˜Ÿåˆ—ï¼Œæœ‰åºé€ä¸ªæ‰§è¡Œï¼Œå…¶å®ƒæ¶ˆæ¯æ´¾å‘åˆ°çº¿ç¨‹æ± ã€‚ ThreadPool fixed å›ºå®šå¤§å°çº¿ç¨‹æ± ï¼Œå¯åŠ¨æ—¶å»ºç«‹çº¿ç¨‹ï¼Œä¸å…³é—­ï¼Œä¸€ç›´æŒæœ‰ã€‚(ç¼ºçœ) cached ç¼“å­˜çº¿ç¨‹æ± ï¼Œç©ºé—²ä¸€åˆ†é’Ÿè‡ªåŠ¨åˆ é™¤ï¼Œéœ€è¦æ—¶é‡å»ºã€‚ limited å¯ä¼¸ç¼©çº¿ç¨‹æ± ï¼Œä½†æ± ä¸­çš„çº¿ç¨‹æ•°åªä¼šå¢é•¿ä¸ä¼šæ”¶ç¼©ã€‚åªå¢é•¿ä¸æ”¶ç¼©çš„ç›®çš„æ˜¯ä¸ºäº†é¿å…æ”¶ç¼©æ—¶çªç„¶æ¥äº†å¤§æµé‡å¼•èµ·çš„æ€§èƒ½é—®é¢˜ã€‚ eager ä¼˜å…ˆåˆ›å»ºWorkerçº¿ç¨‹æ± ã€‚åœ¨ä»»åŠ¡æ•°é‡å¤§äºcorePoolSizeä½†æ˜¯å°äºmaximumPoolSizeæ—¶ï¼Œä¼˜å…ˆåˆ›å»ºWorkeræ¥å¤„ç†ä»»åŠ¡ã€‚å½“ä»»åŠ¡æ•°é‡å¤§äºmaximumPoolSizeæ—¶ï¼Œå°†ä»»åŠ¡æ”¾å…¥é˜»å¡é˜Ÿåˆ—ä¸­ã€‚é˜»å¡é˜Ÿåˆ—å……æ»¡æ—¶æŠ›å‡ºRejectedExecutionExceptionã€‚(ç›¸æ¯”äºcached:cachedåœ¨ä»»åŠ¡æ•°é‡è¶…è¿‡maximumPoolSizeæ—¶ç›´æ¥æŠ›å‡ºå¼‚å¸¸è€Œä¸æ˜¯å°†ä»»åŠ¡æ”¾å…¥é˜»å¡é˜Ÿåˆ—) ç›´è¿æä¾›è€…ï¼ˆåªæœ‰æµ‹è¯•ç¯å¢ƒä½¿ç”¨ï¼‰å’Œåªè®¢é˜…ï¼Œåªæ³¨å†Œç›´è¿åœ¨å¼€å‘åŠæµ‹è¯•ç¯å¢ƒä¸‹ï¼Œç»å¸¸éœ€è¦ç»•è¿‡æ³¨å†Œä¸­å¿ƒï¼Œåªæµ‹è¯•æŒ‡å®šæœåŠ¡æä¾›è€…ï¼Œè¿™æ—¶å€™å¯èƒ½éœ€è¦ç‚¹å¯¹ç‚¹ç›´è¿ï¼Œç‚¹å¯¹ç‚¹ç›´è”æ–¹å¼ï¼Œå°†ä»¥æœåŠ¡æ¥å£ä¸ºå•ä½ï¼Œå¿½ç•¥æ³¨å†Œä¸­å¿ƒçš„æä¾›è€…åˆ—è¡¨ï¼ŒA æ¥å£é…ç½®ç‚¹å¯¹ç‚¹ï¼Œä¸å½±å“ B æ¥å£ä»æ³¨å†Œä¸­å¿ƒè·å–åˆ—è¡¨ã€‚ é€šè¿‡ XML é…ç½® å¦‚æœæ˜¯çº¿ä¸Šéœ€æ±‚éœ€è¦ç‚¹å¯¹ç‚¹ï¼Œå¯åœ¨ dubbo:reference ä¸­é…ç½® url æŒ‡å‘æä¾›è€…ï¼Œå°†ç»•è¿‡æ³¨å†Œä¸­å¿ƒï¼Œå¤šä¸ªåœ°å€ç”¨åˆ†å·éš”å¼€ï¼Œé…ç½®å¦‚ä¸‹ [1]ï¼š é€šè¿‡æ–‡ä»¶æ˜ å°„ å¦‚æœæœåŠ¡æ¯”è¾ƒå¤šï¼Œä¹Ÿå¯ä»¥ç”¨æ–‡ä»¶æ˜ å°„ï¼Œç”¨ -Ddubbo.resolve.file æŒ‡å®šæ˜ å°„æ–‡ä»¶è·¯å¾„ï¼Œæ­¤é…ç½®ä¼˜å…ˆçº§é«˜äº dubbo:reference ä¸­çš„é…ç½® [3]ï¼Œå¦‚ï¼š ç„¶ååœ¨æ˜ å°„æ–‡ä»¶ xxx.properties ä¸­åŠ å…¥é…ç½®ï¼Œå…¶ä¸­ key ä¸ºæœåŠ¡åï¼Œvalue ä¸ºæœåŠ¡æä¾›è€… URLï¼š æ³¨æ„:ä¸ºäº†é¿å…å¤æ‚åŒ–çº¿ä¸Šç¯å¢ƒï¼Œä¸è¦åœ¨çº¿ä¸Šä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œåªåº”åœ¨æµ‹è¯•é˜¶æ®µä½¿ç”¨ã€‚ ç¦ç”¨æ³¨å†Œå°±æ˜¯æŒ‡æœåŠ¡æ–¹å¯ä»¥æ‹‰å–é…ç½®ä¸­å¿ƒçš„ä¿¡æ¯å½“æ—¶å¹¶ä¸åœ¨é…ç½®ä¸­å¿ƒè¿›è¡Œæ³¨å†Œ ç¦ç”¨æ³¨å†Œé…ç½® æˆ–è€… ç¦ç”¨æ‹‰å–åˆ¶å®šä¸€ä¸ªé…ç½®ä¸­å¿ƒåªå°†è‡ªå·±æ³¨å†Œè¿›å»ä½†æ˜¯ä¸è¿›è¡Œè®¢é˜…åŠŸèƒ½ ç¦ç”¨è®¢é˜…é…ç½® <dubbo:registry id&#x3D;â€hzRegistryâ€ address&#x3D;â€10.20.153.10:9090â€ &#x2F;><dubbo:registry id&#x3D;â€qdRegistryâ€ address&#x3D;â€10.20.141.150:9090â€ subscribe&#x3D;â€falseâ€ &#x2F;>æˆ–è€… <dubbo:registry id&#x3D;â€hzRegistryâ€ address&#x3D;â€10.20.153.10:9090â€ &#x2F;><dubbo:registry id&#x3D;â€qdRegistryâ€ address&#x3D;â€10.20.141.150:9090?subscribe&#x3D;falseâ€ &#x2F;> å¤šåè®® ä¸åŒæœåŠ¡ä¸åŒåè®® ä¸åŒæœåŠ¡åœ¨æ€§èƒ½ä¸Šé€‚ç”¨ä¸åŒåè®®è¿›è¡Œä¼ è¾“ï¼Œæ¯”å¦‚å¤§æ•°æ®ç”¨çŸ­è¿æ¥åè®®ï¼Œå°æ•°æ®å¤§å¹¶å‘ç”¨é•¿è¿æ¥åè®® å¤šåè®®æš´éœ²æœåŠ¡ éœ€è¦ä¸ http å®¢æˆ·ç«¯äº’æ“ä½œ æœåŠ¡åˆ†ç»„å½“ä¸€ä¸ªæ¥å£æœ‰å¤šç§å®ç°æ—¶ï¼Œå¯ä»¥ç”¨ group åŒºåˆ†ã€‚ æœåŠ¡ å¼•ç”¨ å¤šç‰ˆæœ¬å½“ä¸€ä¸ªæ¥å£å®ç°ï¼Œå‡ºç°ä¸å…¼å®¹å‡çº§æ—¶ï¼Œå¯ä»¥ç”¨ç‰ˆæœ¬å·è¿‡æ¸¡ï¼Œç‰ˆæœ¬å·ä¸åŒçš„æœåŠ¡ç›¸äº’é—´ä¸å¼•ç”¨ã€‚ å¯ä»¥æŒ‰ç…§ä»¥ä¸‹çš„æ­¥éª¤è¿›è¡Œç‰ˆæœ¬è¿ç§»ï¼š åœ¨ä½å‹åŠ›æ—¶é—´æ®µï¼Œå…ˆå‡çº§ä¸€åŠæä¾›è€…ä¸ºæ–°ç‰ˆæœ¬ å†å°†æ‰€æœ‰æ¶ˆè´¹è€…å‡çº§ä¸ºæ–°ç‰ˆæœ¬ ç„¶åå°†å‰©ä¸‹çš„ä¸€åŠæä¾›è€…å‡çº§ä¸ºæ–°ç‰ˆæœ¬ è€ç‰ˆæœ¬æœåŠ¡æä¾›è€…é…ç½®ï¼š æ–°ç‰ˆæœ¬æœåŠ¡æä¾›è€…é…ç½®ï¼š è€ç‰ˆæœ¬æœåŠ¡æ¶ˆè´¹è€…é…ç½®ï¼š æ–°ç‰ˆæœ¬æœåŠ¡æ¶ˆè´¹è€…é…ç½®ï¼š å¦‚æœä¸éœ€è¦åŒºåˆ†ç‰ˆæœ¬ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹çš„æ–¹å¼é…ç½® [1]ï¼š åˆ†ç»„èšåˆæŒ‰ç»„åˆå¹¶è¿”å›ç»“æœ [1]ï¼Œæ¯”å¦‚èœå•æœåŠ¡ï¼Œæ¥å£ä¸€æ ·ï¼Œä½†æœ‰å¤šç§å®ç°ï¼Œç”¨groupåŒºåˆ†ï¼Œç°åœ¨æ¶ˆè´¹æ–¹éœ€ä»æ¯ç§groupä¸­è°ƒç”¨ä¸€æ¬¡è¿”å›ç»“æœï¼Œåˆå¹¶ç»“æœè¿”å›ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°èšåˆèœå•é¡¹ã€‚ é…ç½® æœç´¢æ‰€æœ‰åˆ†ç»„ åˆå¹¶æŒ‡å®šåˆ†ç»„ æŒ‡å®šæ–¹æ³•åˆå¹¶ç»“æœï¼Œå…¶å®ƒæœªæŒ‡å®šçš„æ–¹æ³•ï¼Œå°†åªè°ƒç”¨ä¸€ä¸ª Group æŸä¸ªæ–¹æ³•ä¸åˆå¹¶ç»“æœï¼Œå…¶å®ƒéƒ½åˆå¹¶ç»“æœ æŒ‡å®šåˆå¹¶ç­–ç•¥ï¼Œç¼ºçœæ ¹æ®è¿”å›å€¼ç±»å‹è‡ªåŠ¨åŒ¹é…ï¼Œå¦‚æœåŒä¸€ç±»å‹æœ‰ä¸¤ä¸ªåˆå¹¶å™¨æ—¶ï¼Œéœ€æŒ‡å®šåˆå¹¶å™¨çš„åç§° æŒ‡å®šåˆå¹¶æ–¹æ³•ï¼Œå°†è°ƒç”¨è¿”å›ç»“æœçš„æŒ‡å®šæ–¹æ³•è¿›è¡Œåˆå¹¶ï¼Œåˆå¹¶æ–¹æ³•çš„å‚æ•°ç±»å‹å¿…é¡»æ˜¯è¿”å›ç»“æœç±»å‹æœ¬èº« ç»“æœç¼“å­˜ç»“æœç¼“å­˜ [1]ï¼Œç”¨äºåŠ é€Ÿçƒ­é—¨æ•°æ®çš„è®¿é—®é€Ÿåº¦ï¼ŒDubbo æä¾›å£°æ˜å¼ç¼“å­˜ï¼Œä»¥å‡å°‘ç”¨æˆ·åŠ ç¼“å­˜çš„å·¥ä½œé‡ [2]ã€‚ ç¼“å­˜ç±»å‹ lru åŸºäºæœ€è¿‘æœ€å°‘ä½¿ç”¨åŸåˆ™åˆ é™¤å¤šä½™ç¼“å­˜ï¼Œä¿æŒæœ€çƒ­çš„æ•°æ®è¢«ç¼“å­˜ã€‚ threadlocal å½“å‰çº¿ç¨‹ç¼“å­˜ï¼Œæ¯”å¦‚ä¸€ä¸ªé¡µé¢æ¸²æŸ“ï¼Œç”¨åˆ°å¾ˆå¤š portalï¼Œæ¯ä¸ª portal éƒ½è¦å»æŸ¥ç”¨æˆ·ä¿¡æ¯ï¼Œé€šè¿‡çº¿ç¨‹ç¼“å­˜ï¼Œå¯ä»¥å‡å°‘è¿™ç§å¤šä½™è®¿é—®ã€‚ jcache ä¸ JSR107 é›†æˆï¼Œå¯ä»¥æ¡¥æ¥å„ç§ç¼“å­˜å®ç°ã€‚ ç¼“å­˜ç±»å‹å¯æ‰©å±•ï¼Œå‚è§ï¼šç¼“å­˜æ‰©å±• é…ç½® æˆ–ï¼š ä½¿ç”¨æ³›åŒ–è°ƒç”¨æ³›åŒ–æ¥å£è°ƒç”¨æ–¹å¼ä¸»è¦ç”¨äºå®¢æˆ·ç«¯æ²¡æœ‰ API æ¥å£åŠæ¨¡å‹ç±»å…ƒçš„æƒ…å†µï¼Œå‚æ•°åŠè¿”å›å€¼ä¸­çš„æ‰€æœ‰ POJO å‡ç”¨ Map è¡¨ç¤ºï¼Œé€šå¸¸ç”¨äºæ¡†æ¶é›†æˆï¼Œæ¯”å¦‚ï¼šå®ç°ä¸€ä¸ªé€šç”¨çš„æœåŠ¡æµ‹è¯•æ¡†æ¶ï¼Œå¯é€šè¿‡ GenericService è°ƒç”¨æ‰€æœ‰æœåŠ¡å®ç°ã€‚ é€šè¿‡ Spring ä½¿ç”¨æ³›åŒ–è°ƒç”¨åœ¨ Spring é…ç½®ç”³æ˜ generic&#x3D;â€trueâ€ï¼š åœ¨ Java ä»£ç è·å– barService å¹¶å¼€å§‹æ³›åŒ–è°ƒç”¨ï¼š é€šè¿‡ API æ–¹å¼ä½¿ç”¨æ³›åŒ–è°ƒç”¨ æœ‰å…³æ³›åŒ–ç±»å‹çš„è¿›ä¸€æ­¥è§£é‡Š å‡è®¾å­˜åœ¨ POJO å¦‚ï¼š åˆ™ POJO æ•°æ®ï¼š å¯ç”¨ä¸‹é¢ Map è¡¨ç¤ºï¼š","date":"2024-12-31","categories":["java"],"tags":["dubbo"]},{"title":"dubboå­¦ä¹ å’Œä½¿ç”¨(4)-dubboåŠŸèƒ½(2)","url":"/2024/12/31/dubboå­¦ä¹ å’Œä½¿ç”¨-4--dubboåŠŸèƒ½-2-/","content":"æ³›åŒ–è°ƒç”¨å®¢æˆ·ç«¯æ³›åŒ–æ¥å£è°ƒç”¨æ–¹å¼ä¸»è¦ç”¨äºå®¢æˆ·ç«¯æ²¡æœ‰ API æ¥å£åŠæ¨¡å‹ç±»å…ƒçš„æƒ…å†µï¼Œå‚æ•°åŠè¿”å›å€¼ä¸­çš„æ‰€æœ‰ POJO å‡ç”¨ Map è¡¨ç¤ºï¼Œé€šå¸¸ç”¨äºæ¡†æ¶é›†æˆï¼Œæ¯”å¦‚ï¼šå®ç°ä¸€ä¸ªé€šç”¨çš„æœåŠ¡æµ‹è¯•æ¡†æ¶ï¼Œå¯é€šè¿‡ GenericService è°ƒç”¨æ‰€æœ‰æœåŠ¡å®ç°ã€‚ é€šè¿‡ Spring ä½¿ç”¨æ³›åŒ–è°ƒç”¨åœ¨ Spring é…ç½®ç”³æ˜ generic&#x3D;â€trueâ€ï¼š åœ¨ Java ä»£ç è·å– barService å¹¶å¼€å§‹æ³›åŒ–è°ƒç”¨ï¼š é€šè¿‡ API æ–¹å¼ä½¿ç”¨æ³›åŒ–è°ƒç”¨ æœ‰å…³æ³›åŒ–ç±»å‹çš„è¿›ä¸€æ­¥è§£é‡Š å‡è®¾å­˜åœ¨ POJO å¦‚ï¼š åˆ™ POJO æ•°æ®ï¼š å¯ç”¨ä¸‹é¢ Map è¡¨ç¤ºï¼š æ³›åŒ–è°ƒç”¨æœåŠ¡ç«¯æ³›æ¥å£å®ç°æ–¹å¼ä¸»è¦ç”¨äºæœåŠ¡å™¨ç«¯æ²¡æœ‰APIæ¥å£åŠæ¨¡å‹ç±»å…ƒçš„æƒ…å†µï¼Œå‚æ•°åŠè¿”å›å€¼ä¸­çš„æ‰€æœ‰POJOå‡ç”¨Mapè¡¨ç¤ºï¼Œé€šå¸¸ç”¨äºæ¡†æ¶é›†æˆï¼Œæ¯”å¦‚ï¼šå®ç°ä¸€ä¸ªé€šç”¨çš„è¿œç¨‹æœåŠ¡Mockæ¡†æ¶ï¼Œå¯é€šè¿‡å®ç°GenericServiceæ¥å£å¤„ç†æ‰€æœ‰æœåŠ¡è¯·æ±‚ã€‚ åœ¨ Java ä»£ç ä¸­å®ç° GenericService æ¥å£ï¼š é€šè¿‡ Spring æš´éœ²æ³›åŒ–å®ç°åœ¨ Spring é…ç½®ç”³æ˜æœåŠ¡çš„å®ç°ï¼š é€šè¿‡ API æ–¹å¼æš´éœ²æ³›åŒ–å®ç° å›å£°æµ‹è¯•å›å£°æµ‹è¯•ç”¨äºæ£€æµ‹æœåŠ¡æ˜¯å¦å¯ç”¨ï¼Œå›å£°æµ‹è¯•æŒ‰ç…§æ­£å¸¸è¯·æ±‚æµç¨‹æ‰§è¡Œï¼Œèƒ½å¤Ÿæµ‹è¯•æ•´ä¸ªè°ƒç”¨æ˜¯å¦é€šç•…ï¼Œå¯ç”¨äºç›‘æ§ã€‚ æ‰€æœ‰æœåŠ¡è‡ªåŠ¨å®ç° EchoService æ¥å£ï¼Œåªéœ€å°†ä»»æ„æœåŠ¡å¼•ç”¨å¼ºåˆ¶è½¬å‹ä¸º EchoServiceï¼Œå³å¯ä½¿ç”¨ã€‚ Spring é…ç½®ï¼š ä»£ç ï¼š ä¸Šä¸‹æ–‡ä¿¡æ¯ä¸Šä¸‹æ–‡ä¸­å­˜æ”¾çš„æ˜¯å½“å‰è°ƒç”¨è¿‡ç¨‹ä¸­æ‰€éœ€çš„ç¯å¢ƒä¿¡æ¯ã€‚æ‰€æœ‰é…ç½®ä¿¡æ¯éƒ½å°†è½¬æ¢ä¸º URL çš„å‚æ•°ï¼Œå‚è§ schema é…ç½®å‚è€ƒæ‰‹å†Œ ä¸­çš„å¯¹åº”URLå‚æ•°ä¸€åˆ—ã€‚ RpcContext æ˜¯ä¸€ä¸ª ThreadLocal çš„ä¸´æ—¶çŠ¶æ€è®°å½•å™¨ï¼Œå½“æ¥æ”¶åˆ° RPC è¯·æ±‚ï¼Œæˆ–å‘èµ· RPC è¯·æ±‚æ—¶ï¼ŒRpcContext çš„çŠ¶æ€éƒ½ä¼šå˜åŒ–ã€‚æ¯”å¦‚ï¼šA è°ƒ Bï¼ŒB å†è°ƒ Cï¼Œåˆ™ B æœºå™¨ä¸Šï¼Œåœ¨ B è°ƒ C ä¹‹å‰ï¼ŒRpcContext è®°å½•çš„æ˜¯ A è°ƒ B çš„ä¿¡æ¯ï¼Œåœ¨ B è°ƒ C ä¹‹åï¼ŒRpcContext è®°å½•çš„æ˜¯ B è°ƒ C çš„ä¿¡æ¯ã€‚ æœåŠ¡æ¶ˆè´¹æ–¹ æœåŠ¡æä¾›æ–¹ éšå¼å‚æ•°å¯ä»¥é€šè¿‡ RpcContext ä¸Šçš„ setAttachment å’Œ getAttachment åœ¨æœåŠ¡æ¶ˆè´¹æ–¹å’Œæä¾›æ–¹ä¹‹é—´è¿›è¡Œå‚æ•°çš„éšå¼ä¼ é€’ã€‚ [1] åœ¨æœåŠ¡æ¶ˆè´¹æ–¹ç«¯è®¾ç½®éšå¼å‚æ•°setAttachment è®¾ç½®çš„ KV å¯¹ï¼Œåœ¨å®Œæˆä¸‹é¢ä¸€æ¬¡è¿œç¨‹è°ƒç”¨ä¼šè¢«æ¸…ç©ºï¼Œå³å¤šæ¬¡è¿œç¨‹è°ƒç”¨è¦å¤šæ¬¡è®¾ç½®ã€‚ åœ¨æœåŠ¡æä¾›æ–¹ç«¯è·å–éšå¼å‚æ•°public class XxxServiceImpl implements XxxService { } å¼‚æ­¥è°ƒç”¨åŸºäº NIO çš„éé˜»å¡å®ç°å¹¶è¡Œè°ƒç”¨ï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦å¯åŠ¨å¤šçº¿ç¨‹å³å¯å®Œæˆå¹¶è¡Œè°ƒç”¨å¤šä¸ªè¿œç¨‹æœåŠ¡ï¼Œç›¸å¯¹å¤šçº¿ç¨‹å¼€é”€è¾ƒå°ã€‚ [1] åœ¨ consumer.xml ä¸­é…ç½®ï¼š è°ƒç”¨ä»£ç : ä½ ä¹Ÿå¯ä»¥è®¾ç½®æ˜¯å¦ç­‰å¾…æ¶ˆæ¯å‘å‡ºï¼š [2] sent&#x3D;â€trueâ€ ç­‰å¾…æ¶ˆæ¯å‘å‡ºï¼Œæ¶ˆæ¯å‘é€å¤±è´¥å°†æŠ›å‡ºå¼‚å¸¸ã€‚sent&#x3D;â€falseâ€ ä¸ç­‰å¾…æ¶ˆæ¯å‘å‡ºï¼Œå°†æ¶ˆæ¯æ”¾å…¥ IO é˜Ÿåˆ—ï¼Œå³åˆ»è¿”å›ã€‚ å¦‚æœä½ åªæ˜¯æƒ³å¼‚æ­¥ï¼Œå®Œå…¨å¿½ç•¥è¿”å›å€¼ï¼Œå¯ä»¥é…ç½® return&#x3D;â€falseâ€ï¼Œä»¥å‡å°‘ Future å¯¹è±¡çš„åˆ›å»ºå’Œç®¡ç†æˆæœ¬ï¼š æœ¬åœ°è°ƒç”¨æœ¬åœ°è°ƒç”¨ä½¿ç”¨äº† injvm åè®®ï¼Œæ˜¯ä¸€ä¸ªä¼ªåè®®ï¼Œå®ƒä¸å¼€å¯ç«¯å£ï¼Œä¸å‘èµ·è¿œç¨‹è°ƒç”¨ï¼Œåªåœ¨ JVM å†…ç›´æ¥å…³è”ï¼Œä½†æ‰§è¡Œ Dubbo çš„ Filter é“¾ã€‚ é…ç½® å®šä¹‰ injvm åè®® è®¾ç½®é»˜è®¤åè®® è®¾ç½®æœåŠ¡åè®® ä¼˜å…ˆä½¿ç”¨ injvm æˆ– æ³¨æ„ï¼šæœåŠ¡æš´éœ²ä¸æœåŠ¡å¼•ç”¨éƒ½éœ€è¦å£°æ˜ injvm&#x3D;â€trueâ€ è‡ªåŠ¨æš´éœ²ã€å¼•ç”¨æœ¬åœ°æœåŠ¡ä» 2.2.0 å¼€å§‹ï¼Œæ¯ä¸ªæœåŠ¡é»˜è®¤éƒ½ä¼šåœ¨æœ¬åœ°æš´éœ²ã€‚åœ¨å¼•ç”¨æœåŠ¡çš„æ—¶å€™ï¼Œé»˜è®¤ä¼˜å…ˆå¼•ç”¨æœ¬åœ°æœåŠ¡ã€‚å¦‚æœå¸Œæœ›å¼•ç”¨è¿œç¨‹æœåŠ¡å¯ä»¥ä½¿ç”¨ä¸€ä¸‹é…ç½®å¼ºåˆ¶å¼•ç”¨è¿œç¨‹æœåŠ¡ã€‚","date":"2024-12-31","categories":["java"],"tags":["dubbo"]},{"title":"dubboå­¦ä¹ å’Œä½¿ç”¨(5)dubboåŠŸèƒ½(3)","url":"/2024/12/31/dubboå­¦ä¹ å’Œä½¿ç”¨-5-dubboåŠŸèƒ½-3-/","content":"å‚æ•°å›è°ƒ å‚æ•°å›è°ƒæ–¹å¼ä¸è°ƒç”¨æœ¬åœ° callback æˆ– listener ç›¸åŒï¼Œåªéœ€è¦åœ¨ Spring çš„é…ç½®æ–‡ä»¶ä¸­å£°æ˜å“ªä¸ªå‚æ•°æ˜¯ callback ç±»å‹å³å¯ã€‚Dubbo å°†åŸºäºé•¿è¿æ¥ç”Ÿæˆåå‘ä»£ç†ï¼Œè¿™æ ·å°±å¯ä»¥ä»æœåŠ¡å™¨ç«¯è°ƒç”¨å®¢æˆ·ç«¯é€»è¾‘ã€‚ æœåŠ¡æ¥å£ç¤ºä¾‹ æœåŠ¡æä¾›è€…é…ç½®ç¤ºä¾‹ æœåŠ¡æ¶ˆè´¹è€…é…ç½®ç¤ºä¾‹ æœåŠ¡æ¶ˆè´¹è€…è°ƒç”¨ç¤ºä¾‹ äº‹ä»¶é€šçŸ¥åœ¨è°ƒç”¨ä¹‹å‰ã€è°ƒç”¨ä¹‹åã€å‡ºç°å¼‚å¸¸æ—¶ï¼Œä¼šè§¦å‘ oninvokeã€onreturnã€onthrow ä¸‰ä¸ªäº‹ä»¶ï¼Œå¯ä»¥é…ç½®å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œé€šçŸ¥å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•ã€‚ æœåŠ¡æä¾›è€…ä¸æ¶ˆè´¹è€…å…±äº«æœåŠ¡æ¥å£ æœåŠ¡æä¾›è€…å®ç° æœåŠ¡æä¾›è€…é…ç½® æœåŠ¡æ¶ˆè´¹è€… Callback æ¥å£ æœåŠ¡æ¶ˆè´¹è€… Callback å®ç° æœåŠ¡æ¶ˆè´¹è€… Callback é…ç½® callback ä¸ async åŠŸèƒ½æ­£äº¤åˆ†è§£ï¼Œasync&#x3D;true è¡¨ç¤ºç»“æœæ˜¯å¦é©¬ä¸Šè¿”å›ï¼Œonreturn è¡¨ç¤ºæ˜¯å¦éœ€è¦å›è°ƒã€‚ ä¸¤è€…å åŠ å­˜åœ¨ä»¥ä¸‹å‡ ç§ç»„åˆæƒ…å†µ [2]ï¼š å¼‚æ­¥å›è°ƒæ¨¡å¼ï¼šasync&#x3D;true onreturn&#x3D;â€xxxâ€ åŒæ­¥å›è°ƒæ¨¡å¼ï¼šasync&#x3D;false onreturn&#x3D;â€xxxâ€ å¼‚æ­¥æ— å›è°ƒ ï¼šasync&#x3D;true åŒæ­¥æ— å›è°ƒ ï¼šasync&#x3D;false æµ‹è¯•ä»£ç  æœ¬åœ°å­˜æ ¹ è¿œç¨‹æœåŠ¡åï¼Œå®¢æˆ·ç«¯é€šå¸¸åªå‰©ä¸‹æ¥å£ï¼Œè€Œå®ç°å…¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œä½†æä¾›æ–¹æœ‰äº›æ—¶å€™æƒ³åœ¨å®¢æˆ·ç«¯ä¹Ÿæ‰§è¡Œéƒ¨åˆ†é€»è¾‘ï¼Œæ¯”å¦‚ï¼šåš ThreadLocal ç¼“å­˜ï¼Œæå‰éªŒè¯å‚æ•°ï¼Œè°ƒç”¨å¤±è´¥åä¼ªé€ å®¹é”™æ•°æ®ç­‰ç­‰ï¼Œæ­¤æ—¶å°±éœ€è¦åœ¨ API ä¸­å¸¦ä¸Š Stubï¼Œå®¢æˆ·ç«¯ç”Ÿæˆ Proxy å®ä¾‹ï¼Œä¼šæŠŠ Proxy é€šè¿‡æ„é€ å‡½æ•°ä¼ ç»™ Stubï¼Œç„¶åæŠŠ Stub æš´éœ²ç»™ç”¨æˆ·ï¼ŒStub å¯ä»¥å†³å®šè¦ä¸è¦å»è°ƒ Proxyã€‚ åœ¨ spring é…ç½®æ–‡ä»¶ä¸­æŒ‰ä»¥ä¸‹æ–¹å¼é…ç½®ï¼š æä¾› Stub çš„å®ç°ï¼š Stub å¿…é¡»æœ‰å¯ä¼ å…¥ Proxy çš„æ„é€ å‡½æ•°ã€‚ åœ¨ interface æ—è¾¹æ”¾ä¸€ä¸ª Stub å®ç°ï¼Œå®ƒå®ç° BarService æ¥å£ï¼Œå¹¶æœ‰ä¸€ä¸ªä¼ å…¥è¿œç¨‹ BarService å®ä¾‹çš„æ„é€ å‡½æ•° æœ¬åœ°ä¼ªè£…æœ¬åœ°ä¼ªè£…é€šå¸¸ç”¨äºæœåŠ¡é™çº§ï¼Œæ¯”å¦‚æŸéªŒæƒæœåŠ¡ï¼Œå½“æœåŠ¡æä¾›æ–¹å…¨éƒ¨æŒ‚æ‰åï¼Œå®¢æˆ·ç«¯ä¸æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œæ˜¯é€šè¿‡ Mock æ•°æ®è¿”å›æˆæƒå¤±è´¥ã€‚ åœ¨ spring é…ç½®æ–‡ä»¶ä¸­æŒ‰ä»¥ä¸‹æ–¹å¼é…ç½®ï¼š åœ¨å·¥ç¨‹ä¸­æä¾› Mock å®ç°ï¼š å¦‚æœæœåŠ¡çš„æ¶ˆè´¹æ–¹ç»å¸¸éœ€è¦ try-catch æ•è·å¼‚å¸¸ï¼Œå¦‚ è¯·è€ƒè™‘æ”¹ä¸º Mock å®ç°ï¼Œå¹¶åœ¨ Mock å®ç°ä¸­ return nullã€‚å¦‚æœåªæ˜¯æƒ³ç®€å•çš„å¿½ç•¥å¼‚å¸¸ï¼Œåœ¨ 2.0.11 ä»¥ä¸Šç‰ˆæœ¬å¯ç”¨ Mock æ˜¯ Stub çš„ä¸€ä¸ªå­é›†ï¼Œä¾¿äºæœåŠ¡æä¾›æ–¹åœ¨å®¢æˆ·ç«¯æ‰§è¡Œå®¹é”™é€»è¾‘ï¼Œå› ç»å¸¸éœ€è¦åœ¨å‡ºç° RpcException (æ¯”å¦‚ç½‘ç»œå¤±è´¥ï¼Œè¶…æ—¶ç­‰)æ—¶è¿›è¡Œå®¹é”™ï¼Œè€Œåœ¨å‡ºç°ä¸šåŠ¡å¼‚å¸¸(æ¯”å¦‚ç™»å½•ç”¨æˆ·åå¯†ç é”™è¯¯)æ—¶ä¸éœ€è¦å®¹é”™ï¼Œå¦‚æœç”¨ Stubï¼Œå¯èƒ½å°±éœ€è¦æ•è·å¹¶ä¾èµ– RpcException ç±»ï¼Œè€Œç”¨ Mock å°±å¯ä»¥ä¸ä¾èµ– RpcExceptionï¼Œå› ä¸ºå®ƒçš„çº¦å®šå°±æ˜¯åªæœ‰å‡ºç° RpcException æ—¶æ‰æ‰§è¡Œã€‚ åœ¨ interface æ—æ”¾ä¸€ä¸ª Mock å®ç°ï¼Œå®ƒå®ç° BarService æ¥å£ï¼Œå¹¶æœ‰ä¸€ä¸ªæ— å‚æ„é€ å‡½æ•° å»¶è¿Ÿæš´éœ²å¦‚æœä½ çš„æœåŠ¡éœ€è¦é¢„çƒ­æ—¶é—´ï¼Œæ¯”å¦‚åˆå§‹åŒ–ç¼“å­˜ï¼Œç­‰å¾…ç›¸å…³èµ„æºå°±ä½ç­‰ï¼Œå¯ä»¥ä½¿ç”¨ delay è¿›è¡Œå»¶è¿Ÿæš´éœ²ã€‚ å»¶è¿Ÿ 5 ç§’æš´éœ²æœåŠ¡ å»¶è¿Ÿåˆ° Spring åˆå§‹åŒ–å®Œæˆåï¼Œå†æš´éœ²æœåŠ¡ [1] æ³¨æ„ï¼šSpring 2.x åˆå§‹åŒ–æ­»é”é—®é¢˜ åŸå› æè¿°åœ¨ Spring è§£æåˆ° <dubbo:service &#x2F;> æ—¶ï¼Œå°±å·²ç»å‘å¤–æš´éœ²äº†æœåŠ¡ï¼Œè€Œ Spring è¿˜åœ¨æ¥ç€åˆå§‹åŒ–å…¶å®ƒ Beanã€‚å¦‚æœè¿™æ—¶æœ‰è¯·æ±‚è¿›æ¥ï¼Œå¹¶ä¸”æœåŠ¡çš„å®ç°ç±»é‡Œæœ‰è°ƒç”¨ applicationContext.getBean() çš„ç”¨æ³•ã€‚ è¯·æ±‚çº¿ç¨‹çš„ applicationContext.getBean() è°ƒç”¨ï¼Œå…ˆåŒæ­¥ singletonObjects åˆ¤æ–­ Bean æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨å°±åŒæ­¥ beanDefinitionMap è¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶å†æ¬¡åŒæ­¥ singletonObjects å†™å…¥ Bean å®ä¾‹ç¼“å­˜ã€‚ è€Œ Spring åˆå§‹åŒ–çº¿ç¨‹ï¼Œå› ä¸éœ€è¦åˆ¤æ–­ Bean çš„å­˜åœ¨ï¼Œç›´æ¥åŒæ­¥ beanDefinitionMap è¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶åŒæ­¥ singletonObjects å†™å…¥ Bean å®ä¾‹ç¼“å­˜ã€‚ è¿™æ ·å°±å¯¼è‡´ getBean çº¿ç¨‹ï¼Œå…ˆé” singletonObjectsï¼Œå†é” beanDefinitionMapï¼Œå†æ¬¡é” singletonObjectsã€‚è€Œ Spring åˆå§‹åŒ–çº¿ç¨‹ï¼Œå…ˆé” beanDefinitionMapï¼Œå†é” singletonObjectsã€‚åå‘é”å¯¼è‡´çº¿ç¨‹æ­»é”ï¼Œä¸èƒ½æä¾›æœåŠ¡ï¼Œå¯åŠ¨ä¸äº†ã€‚ å¹¶å‘æ§åˆ¶é…ç½®æ ·ä¾‹ æ ·ä¾‹ 1 é™åˆ¶ com.foo.BarService çš„æ¯ä¸ªæ–¹æ³•ï¼ŒæœåŠ¡å™¨ç«¯å¹¶å‘æ‰§è¡Œï¼ˆæˆ–å ç”¨çº¿ç¨‹æ± çº¿ç¨‹æ•°ï¼‰ä¸èƒ½è¶…è¿‡ 10 ä¸ªï¼š æ ·ä¾‹ 2 é™åˆ¶ com.foo.BarService çš„ sayHello æ–¹æ³•ï¼ŒæœåŠ¡å™¨ç«¯å¹¶å‘æ‰§è¡Œï¼ˆæˆ–å ç”¨çº¿ç¨‹æ± çº¿ç¨‹æ•°ï¼‰ä¸èƒ½è¶…è¿‡ 10 ä¸ªï¼š æ ·ä¾‹ 3 é™åˆ¶ com.foo.BarService çš„æ¯ä¸ªæ–¹æ³•ï¼Œæ¯å®¢æˆ·ç«¯å¹¶å‘æ‰§è¡Œï¼ˆæˆ–å ç”¨è¿æ¥çš„è¯·æ±‚æ•°ï¼‰ä¸èƒ½è¶…è¿‡ 10 ä¸ªï¼š æ ·ä¾‹ 4 é™åˆ¶ com.foo.BarService çš„ sayHello æ–¹æ³•ï¼Œæ¯å®¢æˆ·ç«¯å¹¶å‘æ‰§è¡Œï¼ˆæˆ–å ç”¨è¿æ¥çš„è¯·æ±‚æ•°ï¼‰ä¸èƒ½è¶…è¿‡ 10 ä¸ªï¼š æ³¨æ„ï¼šå¦‚æœ <dubbo:service> å’Œ <dubbo:reference> éƒ½é…äº†activesï¼Œ<dubbo:reference> ä¼˜å…ˆï¼Œå‚è§ï¼šé…ç½®çš„è¦†ç›–ç­–ç•¥ã€‚ Load Balance å‡è¡¡ é…ç½®æœåŠ¡çš„å®¢æˆ·ç«¯çš„ loadbalance å±æ€§ä¸º leastactiveï¼Œæ­¤ Loadbalance ä¼šè°ƒç”¨å¹¶å‘æ•°æœ€å°çš„ Providerï¼ˆConsumerç«¯å¹¶å‘æ•°ï¼‰ã€‚ è¿æ¥æ§åˆ¶ æœåŠ¡ç«¯è¿æ¥æ§åˆ¶ é™åˆ¶æœåŠ¡å™¨ç«¯æ¥å—çš„è¿æ¥ä¸èƒ½è¶…è¿‡ 10 ä¸ªï¼š å®¢æˆ·ç«¯è¿æ¥æ§åˆ¶ é™åˆ¶å®¢æˆ·ç«¯æœåŠ¡ä½¿ç”¨è¿æ¥ä¸èƒ½è¶…è¿‡ 10 ä¸ªï¼š å¦‚æœ <dubbo:service> å’Œ <dubbo:reference> éƒ½é…äº† connectionsï¼Œ<dubbo:reference> ä¼˜å…ˆ å»¶è¿Ÿè¿æ¥å»¶è¿Ÿè¿æ¥ç”¨äºå‡å°‘é•¿è¿æ¥æ•°ã€‚å½“æœ‰è°ƒç”¨å‘èµ·æ—¶ï¼Œå†åˆ›å»ºé•¿è¿æ¥. ç²˜æ»è¿æ¥ç²˜æ»è¿æ¥ç”¨äºæœ‰çŠ¶æ€æœåŠ¡ï¼Œå°½å¯èƒ½è®©å®¢æˆ·ç«¯æ€»æ˜¯å‘åŒä¸€æä¾›è€…å‘èµ·è°ƒç”¨ï¼Œé™¤éè¯¥æä¾›è€…æŒ‚äº†ï¼Œå†è¿å¦ä¸€å°ã€‚ ç²˜æ»è¿æ¥å°†è‡ªåŠ¨å¼€å¯å»¶è¿Ÿè¿æ¥ï¼Œä»¥å‡å°‘é•¿è¿æ¥æ•°ã€‚ ä»¤ç‰ŒéªŒè¯é€šè¿‡ä»¤ç‰ŒéªŒè¯åœ¨æ³¨å†Œä¸­å¿ƒæ§åˆ¶æƒé™ï¼Œä»¥å†³å®šè¦ä¸è¦ä¸‹å‘ä»¤ç‰Œç»™æ¶ˆè´¹è€…ï¼Œå¯ä»¥é˜²æ­¢æ¶ˆè´¹è€…ç»•è¿‡æ³¨å†Œä¸­å¿ƒè®¿é—®æä¾›è€…ï¼Œå¦å¤–é€šè¿‡æ³¨å†Œä¸­å¿ƒå¯çµæ´»æ”¹å˜æˆæƒæ–¹å¼ï¼Œè€Œä¸éœ€ä¿®æ”¹æˆ–å‡çº§æä¾›è€… å¯ä»¥å…¨å±€è®¾ç½®å¼€å¯ä»¤ç‰ŒéªŒè¯ï¼š ä¹Ÿå¯åœ¨æœåŠ¡çº§åˆ«è®¾ç½®ï¼š è¿˜å¯åœ¨åè®®çº§åˆ«è®¾ç½®ï¼š","date":"2024-12-31","categories":["java"],"tags":["dubbo"]},{"title":"dubboå­¦ä¹ å’Œä½¿ç”¨(6)-dubboåŠŸèƒ½(4)-è·¯ç”±","url":"/2024/12/31/dubboå­¦ä¹ å’Œä½¿ç”¨-6--dubboåŠŸèƒ½-4--è·¯ç”±/","content":"è·¯ç”±è§„åˆ™ è·¯ç”±è§„åˆ™å†³å®šä¸€æ¬¡ dubbo æœåŠ¡è°ƒç”¨çš„ç›®æ ‡æœåŠ¡å™¨ï¼Œåˆ†ä¸ºæ¡ä»¶è·¯ç”±è§„åˆ™å’Œè„šæœ¬è·¯ç”±è§„åˆ™ï¼Œå¹¶ä¸”æ”¯æŒå¯æ‰©å±•ã€‚ å†™å…¥è·¯ç”±è§„åˆ™å‘æ³¨å†Œä¸­å¿ƒå†™å…¥è·¯ç”±è§„åˆ™çš„æ“ä½œé€šå¸¸ç”±ç›‘æ§ä¸­å¿ƒæˆ–æ²»ç†ä¸­å¿ƒçš„é¡µé¢å®Œæˆ å±æ€§è§£é‡Š condition:&#x2F;&#x2F; è¡¨ç¤ºè·¯ç”±è§„åˆ™çš„ç±»å‹ï¼Œæ”¯æŒæ¡ä»¶è·¯ç”±è§„åˆ™å’Œè„šæœ¬è·¯ç”±è§„åˆ™ï¼Œå¯æ‰©å±•ï¼Œå¿…å¡«ã€‚ 0.0.0.0 è¡¨ç¤ºå¯¹æ‰€æœ‰ IP åœ°å€ç”Ÿæ•ˆï¼Œå¦‚æœåªæƒ³å¯¹æŸä¸ª IP çš„ç”Ÿæ•ˆï¼Œè¯·å¡«å…¥å…·ä½“ IPï¼Œå¿…å¡«ã€‚ com.foo.BarService è¡¨ç¤ºåªå¯¹æŒ‡å®šæœåŠ¡ç”Ÿæ•ˆï¼Œå¿…å¡«ã€‚ group&#x3D;foo å¯¹æŒ‡å®šæœåŠ¡çš„æŒ‡å®šgroupç”Ÿæ•ˆï¼Œä¸å¡«è¡¨ç¤ºå¯¹æœªé…ç½®groupçš„æŒ‡å®šæœåŠ¡ç”Ÿæ•ˆ version&#x3D;1.0å¯¹æŒ‡å®šæœåŠ¡çš„æŒ‡å®šversionç”Ÿæ•ˆï¼Œä¸å¡«è¡¨ç¤ºå¯¹æœªé…ç½®versionçš„æŒ‡å®šæœåŠ¡ç”Ÿæ•ˆ category&#x3D;routers è¡¨ç¤ºè¯¥æ•°æ®ä¸ºåŠ¨æ€é…ç½®ç±»å‹ï¼Œå¿…å¡«ã€‚ dynamic&#x3D;false è¡¨ç¤ºè¯¥æ•°æ®ä¸ºæŒä¹…æ•°æ®ï¼Œå½“æ³¨å†Œæ–¹é€€å‡ºæ—¶ï¼Œæ•°æ®ä¾ç„¶ä¿å­˜åœ¨æ³¨å†Œä¸­å¿ƒï¼Œå¿…å¡«ã€‚ enabled&#x3D;true è¦†ç›–è§„åˆ™æ˜¯å¦ç”Ÿæ•ˆï¼Œå¯ä¸å¡«ï¼Œç¼ºçœç”Ÿæ•ˆã€‚ force&#x3D;false å½“è·¯ç”±ç»“æœä¸ºç©ºæ—¶ï¼Œæ˜¯å¦å¼ºåˆ¶æ‰§è¡Œï¼Œå¦‚æœä¸å¼ºåˆ¶æ‰§è¡Œï¼Œè·¯ç”±ç»“æœä¸ºç©ºçš„è·¯ç”±è§„åˆ™å°†è‡ªåŠ¨å¤±æ•ˆï¼Œå¯ä¸å¡«ï¼Œç¼ºçœä¸º falseã€‚ runtime&#x3D;false æ˜¯å¦åœ¨æ¯æ¬¡è°ƒç”¨æ—¶æ‰§è¡Œè·¯ç”±è§„åˆ™ï¼Œå¦åˆ™åªåœ¨æä¾›è€…åœ°å€åˆ—è¡¨å˜æ›´æ—¶é¢„å…ˆæ‰§è¡Œå¹¶ç¼“å­˜ç»“æœï¼Œè°ƒç”¨æ—¶ç›´æ¥ä»ç¼“å­˜ä¸­è·å–è·¯ç”±ç»“æœã€‚å¦‚æœç”¨äº†å‚æ•°è·¯ç”±ï¼Œå¿…é¡»è®¾ä¸º trueï¼Œéœ€è¦æ³¨æ„è®¾ç½®ä¼šå½±å“è°ƒç”¨çš„æ€§èƒ½ï¼Œå¯ä¸å¡«ï¼Œç¼ºçœä¸º falseã€‚ priority&#x3D;1 è·¯ç”±è§„åˆ™çš„ä¼˜å…ˆçº§ï¼Œç”¨äºæ’åºï¼Œä¼˜å…ˆçº§è¶Šå¤§è¶Šé å‰æ‰§è¡Œï¼Œå¯ä¸å¡«ï¼Œç¼ºçœä¸º 0ã€‚ rule&#x3D;URL.encode(â€œhost &#x3D; 10.20.153.10 &#x3D;> host &#x3D; 10.20.153.11â€) è¡¨ç¤ºè·¯ç”±è§„åˆ™çš„å†…å®¹ï¼Œå¿…å¡«ã€‚ æ¡ä»¶è·¯ç”±è§„åˆ™åŸºäºæ¡ä»¶è¡¨è¾¾å¼çš„è·¯ç”±è§„åˆ™ï¼Œå¦‚ï¼šhost &#x3D; 10.20.153.10 &#x3D;> host &#x3D; 10.20.153.11 è§„åˆ™è§£é‡Šï¼š &#x3D;> ä¹‹å‰çš„ä¸ºæ¶ˆè´¹è€…åŒ¹é…æ¡ä»¶ï¼Œæ‰€æœ‰å‚æ•°å’Œæ¶ˆè´¹è€…çš„ URL è¿›è¡Œå¯¹æ¯”ï¼Œå½“æ¶ˆè´¹è€…æ»¡è¶³åŒ¹é…æ¡ä»¶æ—¶ï¼Œå¯¹è¯¥æ¶ˆè´¹è€…æ‰§è¡Œåé¢çš„è¿‡æ»¤è§„åˆ™ã€‚ &#x3D;> ä¹‹åä¸ºæä¾›è€…åœ°å€åˆ—è¡¨çš„è¿‡æ»¤æ¡ä»¶ï¼Œæ‰€æœ‰å‚æ•°å’Œæä¾›è€…çš„ URL è¿›è¡Œå¯¹æ¯”ï¼Œæ¶ˆè´¹è€…æœ€ç»ˆåªæ‹¿åˆ°è¿‡æ»¤åçš„åœ°å€åˆ—è¡¨ã€‚ å¦‚æœåŒ¹é…æ¡ä»¶ä¸ºç©ºï¼Œè¡¨ç¤ºå¯¹æ‰€æœ‰æ¶ˆè´¹æ–¹åº”ç”¨ï¼Œå¦‚ï¼š&#x3D;> host !&#x3D; 10.20.153.11 å¦‚æœè¿‡æ»¤æ¡ä»¶ä¸ºç©ºï¼Œè¡¨ç¤ºç¦æ­¢è®¿é—®ï¼Œå¦‚ï¼šhost &#x3D; 10.20.153.10 &#x3D;> è¡¨è¾¾å¼è§„åˆ™ï¼š å‚æ•°æ”¯æŒï¼š æœåŠ¡è°ƒç”¨ä¿¡æ¯ï¼Œå¦‚ï¼šmethod, argument ç­‰ï¼Œæš‚ä¸æ”¯æŒå‚æ•°è·¯ç”± URL æœ¬èº«çš„å­—æ®µï¼Œå¦‚ï¼šprotocol, host, port ç­‰ ä»¥åŠ URL ä¸Šçš„æ‰€æœ‰å‚æ•°ï¼Œå¦‚ï¼šapplication, organization ç­‰ æ¡ä»¶æ”¯æŒï¼š ç­‰å· &#x3D; è¡¨ç¤ºâ€åŒ¹é…â€ï¼Œå¦‚ï¼šhost &#x3D; 10.20.153.10 ä¸ç­‰å· !&#x3D; è¡¨ç¤ºâ€ä¸åŒ¹é…â€ï¼Œå¦‚ï¼šhost !&#x3D; 10.20.153.10 å€¼æ”¯æŒï¼š ä»¥é€—å· , åˆ†éš”å¤šä¸ªå€¼ï¼Œå¦‚ï¼šhost !&#x3D; 10.20.153.10,10.20.153.11 ä»¥æ˜Ÿå· * ç»“å°¾ï¼Œè¡¨ç¤ºé€šé…ï¼Œå¦‚ï¼šhost !&#x3D; 10.20.* ä»¥ç¾å…ƒç¬¦ $ å¼€å¤´ï¼Œè¡¨ç¤ºå¼•ç”¨æ¶ˆè´¹è€…å‚æ•°ï¼Œå¦‚ï¼šhost &#x3D; $host ç¤ºä¾‹ï¼š æ’é™¤é¢„å‘å¸ƒæœºï¼š &#x3D;> host !&#x3D; 172.22.3.91 ç™½åå•ï¼š host !&#x3D; 10.20.153.10,10.20.153.11 &#x3D;> é»‘åå•ï¼š host &#x3D; 10.20.153.10,10.20.153.11 &#x3D;> æœåŠ¡å¯„å®¿åœ¨åº”ç”¨ä¸Šï¼Œåªæš´éœ²ä¸€éƒ¨åˆ†çš„æœºå™¨ï¼Œé˜²æ­¢æ•´ä¸ªé›†ç¾¤æŒ‚æ‰ï¼š &#x3D;> host &#x3D; 172.22.3.1*,172.22.3.2* ä¸ºé‡è¦åº”ç”¨æä¾›é¢å¤–çš„æœºå™¨ï¼š application !&#x3D; kylin &#x3D;> host !&#x3D; 172.22.3.95,172.22.3.96 è¯»å†™åˆ†ç¦»ï¼š method &#x3D; find*,list*,get*,is* &#x3D;> host &#x3D; 172.22.3.94,172.22.3.95,172.22.3.96 method !&#x3D; find*,list*,get*,is* &#x3D;> host &#x3D; 172.22.3.97,172.22.3.98 å‰åå°åˆ†ç¦»ï¼š application &#x3D; bops &#x3D;> host &#x3D; 172.22.3.91,172.22.3.92,172.22.3.93 application !&#x3D; bops &#x3D;> host &#x3D; 172.22.3.94,172.22.3.95,172.22.3.96 éš”ç¦»ä¸åŒæœºæˆ¿ç½‘æ®µï¼š host !&#x3D; 172.22.3.* &#x3D;> host !&#x3D; 172.22.3.* æä¾›è€…ä¸æ¶ˆè´¹è€…éƒ¨ç½²åœ¨åŒé›†ç¾¤å†…ï¼Œæœ¬æœºåªè®¿é—®æœ¬æœºçš„æœåŠ¡ï¼š &#x3D;> host &#x3D; $host è„šæœ¬è·¯ç”±è§„åˆ™è„šæœ¬è·¯ç”±è§„åˆ™æ”¯æŒ JDK è„šæœ¬å¼•æ“çš„æ‰€æœ‰è„šæœ¬ï¼Œæ¯”å¦‚ï¼šjavascript, jruby, groovy ç­‰ï¼Œé€šè¿‡ type&#x3D;javascript å‚æ•°è®¾ç½®è„šæœ¬ç±»å‹ï¼Œç¼ºçœä¸º javascriptã€‚ â€œscript:&#x2F;&#x2F;0.0.0.0&#x2F;com.foo.BarService?category&#x3D;routers&dynamic&#x3D;false&rule&#x3D;â€ + URL.encode(â€œï¼ˆfunction route(invokers) { â€¦ } (invokers)ï¼‰â€) åŸºäºè„šæœ¬å¼•æ“çš„è·¯ç”±è§„åˆ™ï¼Œå¦‚ï¼š è·¯ç”±è§„åˆ™æ‰©å±•ç‚¹ï¼šè·¯ç”±æ‰©å±• æ³¨æ„ï¼šä¸€ä¸ªæœåŠ¡åªèƒ½æœ‰ä¸€æ¡ç™½åå•è§„åˆ™ï¼Œå¦åˆ™ä¸¤æ¡è§„åˆ™äº¤å‰ï¼Œå°±éƒ½è¢«ç­›é€‰æ‰äº† æ³¨æ„ï¼šè„šæœ¬æ²¡æœ‰æ²™ç®±çº¦æŸï¼Œå¯æ‰§è¡Œä»»æ„ä»£ç ï¼Œå­˜åœ¨åé—¨é£é™©","date":"2024-12-31","categories":["java"],"tags":["dubbo"]},{"title":"dubboå­¦ä¹ å’Œä½¿ç”¨(7)-dubboåŠŸèƒ½(5)","url":"/2024/12/31/dubboå­¦ä¹ å’Œä½¿ç”¨-7--dubboåŠŸèƒ½-5-/","content":"##é…ç½®è§„åˆ™ å‘æ³¨å†Œä¸­å¿ƒå†™å…¥åŠ¨æ€é…ç½®è¦†ç›–è§„åˆ™ã€‚è¯¥åŠŸèƒ½é€šå¸¸ç”±ç›‘æ§ä¸­å¿ƒæˆ–æ²»ç†ä¸­å¿ƒçš„é¡µé¢å®Œæˆã€‚ å…¶ä¸­ï¼š override:&#x2F;&#x2F; è¡¨ç¤ºæ•°æ®é‡‡ç”¨è¦†ç›–æ–¹å¼ï¼Œæ”¯æŒ override å’Œ absentï¼Œå¯æ‰©å±•ï¼Œå¿…å¡«ã€‚ 0.0.0.0 è¡¨ç¤ºå¯¹æ‰€æœ‰ IP åœ°å€ç”Ÿæ•ˆï¼Œå¦‚æœåªæƒ³è¦†ç›–æŸä¸ª IP çš„æ•°æ®ï¼Œè¯·å¡«å…¥å…·ä½“ IPï¼Œå¿…å¡«ã€‚ com.foo.BarService è¡¨ç¤ºåªå¯¹æŒ‡å®šæœåŠ¡ç”Ÿæ•ˆï¼Œå¿…å¡«ã€‚ category&#x3D;configurators è¡¨ç¤ºè¯¥æ•°æ®ä¸ºåŠ¨æ€é…ç½®ç±»å‹ï¼Œå¿…å¡«ã€‚ dynamic&#x3D;false è¡¨ç¤ºè¯¥æ•°æ®ä¸ºæŒä¹…æ•°æ®ï¼Œå½“æ³¨å†Œæ–¹é€€å‡ºæ—¶ï¼Œæ•°æ®ä¾ç„¶ä¿å­˜åœ¨æ³¨å†Œä¸­å¿ƒï¼Œå¿…å¡«ã€‚ enabled&#x3D;true è¦†ç›–è§„åˆ™æ˜¯å¦ç”Ÿæ•ˆï¼Œå¯ä¸å¡«ï¼Œç¼ºçœç”Ÿæ•ˆã€‚ application&#x3D;foo è¡¨ç¤ºåªå¯¹æŒ‡å®šåº”ç”¨ç”Ÿæ•ˆï¼Œå¯ä¸å¡«ï¼Œè¡¨ç¤ºå¯¹æ‰€æœ‰åº”ç”¨ç”Ÿæ•ˆã€‚ timeout&#x3D;1000 è¡¨ç¤ºå°†æ»¡è¶³ä»¥ä¸Šæ¡ä»¶çš„ timeout å‚æ•°çš„å€¼è¦†ç›–ä¸º 1000ã€‚å¦‚æœæƒ³è¦†ç›–å…¶å®ƒå‚æ•°ï¼Œç›´æ¥åŠ åœ¨ override çš„ URL å‚æ•°ä¸Šã€‚ ç¤ºä¾‹ï¼š ç¦ç”¨æä¾›è€…ï¼š(é€šå¸¸ç”¨äºä¸´æ—¶è¸¢é™¤æŸå°æä¾›è€…æœºå™¨ï¼Œç›¸ä¼¼çš„ï¼Œç¦æ­¢æ¶ˆè´¹è€…è®¿é—®è¯·ä½¿ç”¨è·¯ç”±è§„åˆ™) è°ƒæ•´æƒé‡ï¼š(é€šå¸¸ç”¨äºå®¹é‡è¯„ä¼°ï¼Œç¼ºçœæƒé‡ä¸º 100) è°ƒæ•´è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼š(ç¼ºçœè´Ÿè½½å‡è¡¡ç­–ç•¥ä¸º random) æœåŠ¡é™çº§ï¼š(é€šå¸¸ç”¨äºä¸´æ—¶å±è”½æŸä¸ªå‡ºé”™çš„éå…³é”®æœåŠ¡) æœåŠ¡é™çº§å¯ä»¥é€šè¿‡æœåŠ¡é™çº§åŠŸèƒ½ä¸´æ—¶å±è”½æŸä¸ªå‡ºé”™çš„éå…³é”®æœåŠ¡ï¼Œå¹¶å®šä¹‰é™çº§åçš„è¿”å›ç­–ç•¥ã€‚ å‘æ³¨å†Œä¸­å¿ƒå†™å…¥åŠ¨æ€é…ç½®è¦†ç›–è§„åˆ™ï¼š å…¶ä¸­ï¼š mock&#x3D;force:return+null è¡¨ç¤ºæ¶ˆè´¹æ–¹å¯¹è¯¥æœåŠ¡çš„æ–¹æ³•è°ƒç”¨éƒ½ç›´æ¥è¿”å› null å€¼ï¼Œä¸å‘èµ·è¿œç¨‹è°ƒç”¨ã€‚ç”¨æ¥å±è”½ä¸é‡è¦æœåŠ¡ä¸å¯ç”¨æ—¶å¯¹è°ƒç”¨æ–¹çš„å½±å“ã€‚ è¿˜å¯ä»¥æ”¹ä¸º mock&#x3D;fail:return+null è¡¨ç¤ºæ¶ˆè´¹æ–¹å¯¹è¯¥æœåŠ¡çš„æ–¹æ³•è°ƒç”¨åœ¨å¤±è´¥åï¼Œå†è¿”å› null å€¼ï¼Œä¸æŠ›å¼‚å¸¸ã€‚ç”¨æ¥å®¹å¿ä¸é‡è¦æœåŠ¡ä¸ç¨³å®šæ—¶å¯¹è°ƒç”¨æ–¹çš„å½±å“ã€‚ ä¼˜é›…åœæœºDubbo æ˜¯é€šè¿‡ JDK çš„ ShutdownHook æ¥å®Œæˆä¼˜é›…åœæœºçš„ï¼Œæ‰€ä»¥å¦‚æœç”¨æˆ·ä½¿ç”¨ kill -9 PID ç­‰å¼ºåˆ¶å…³é—­æŒ‡ä»¤ï¼Œæ˜¯ä¸ä¼šæ‰§è¡Œä¼˜é›…åœæœºçš„ï¼Œåªæœ‰é€šè¿‡ kill PID æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œã€‚ åŸç† æœåŠ¡æä¾›æ–¹ åœæ­¢æ—¶ï¼Œå…ˆæ ‡è®°ä¸ºä¸æ¥æ”¶æ–°è¯·æ±‚ï¼Œæ–°è¯·æ±‚è¿‡æ¥æ—¶ç›´æ¥æŠ¥é”™ï¼Œè®©å®¢æˆ·ç«¯é‡è¯•å…¶å®ƒæœºå™¨ã€‚ç„¶åï¼Œæ£€æµ‹çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ˜¯å¦æ­£åœ¨è¿è¡Œï¼Œå¦‚æœæœ‰ï¼Œç­‰å¾…æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œæˆï¼Œé™¤éè¶…æ—¶ï¼Œåˆ™å¼ºåˆ¶å…³é—­ã€‚ æœåŠ¡æ¶ˆè´¹æ–¹ åœæ­¢æ—¶ï¼Œä¸å†å‘èµ·æ–°çš„è°ƒç”¨è¯·æ±‚ï¼Œæ‰€æœ‰æ–°çš„è°ƒç”¨åœ¨å®¢æˆ·ç«¯å³æŠ¥é”™ã€‚ç„¶åï¼Œæ£€æµ‹æœ‰æ²¡æœ‰è¯·æ±‚çš„å“åº”è¿˜æ²¡æœ‰è¿”å›ï¼Œç­‰å¾…å“åº”è¿”å›ï¼Œé™¤éè¶…æ—¶ï¼Œåˆ™å¼ºåˆ¶å…³é—­ã€‚ è®¾ç½®æ–¹å¼ è®¾ç½®ä¼˜é›…åœæœºè¶…æ—¶æ—¶é—´ï¼Œç¼ºçœè¶…æ—¶æ—¶é—´æ˜¯ 10 ç§’ï¼Œå¦‚æœè¶…æ—¶åˆ™å¼ºåˆ¶å…³é—­ã€‚ dubbo.properties å¦‚æœ ShutdownHook ä¸èƒ½ç”Ÿæ•ˆï¼Œå¯ä»¥è‡ªè¡Œè°ƒç”¨ï¼Œä½¿ç”¨tomcatç­‰å®¹å™¨éƒ¨ç½²çš„å ´æ™¯ï¼Œå»ºè®®é€šè¿‡æ‰©å±• ContextListenerç­‰è‡ªè¡Œè°ƒç”¨ä»¥ä¸‹ä»£ç å®ç°ä¼˜é›…åœæœºï¼š æ—¥å¿—é€‚é…è‡ª 2.2.1 å¼€å§‹ï¼Œdubbo å¼€å§‹å†…ç½® log4jã€slf4jã€jclã€jdk è¿™äº›æ—¥å¿—æ¡†æ¶çš„é€‚é…ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ˜¾ç¤ºé…ç½®æ—¥å¿—è¾“å‡ºç­–ç•¥ï¼š å‘½ä»¤è¡Œ åœ¨ dubbo.properties ä¸­æŒ‡å®š åœ¨ dubbo.xml ä¸­é…ç½® å¼€å¯è®¿é—®æ—¥å¿—å¦‚æœä½ æƒ³è®°å½•æ¯ä¸€æ¬¡è¯·æ±‚ä¿¡æ¯ï¼Œå¯å¼€å¯è®¿é—®æ—¥å¿—ï¼Œç±»ä¼¼äºapacheçš„è®¿é—®æ—¥å¿—ã€‚æ³¨æ„ï¼šæ­¤æ—¥å¿—é‡æ¯”è¾ƒå¤§ï¼Œè¯·æ³¨æ„ç£ç›˜å®¹é‡ã€‚ å°†è®¿é—®æ—¥å¿—è¾“å‡ºåˆ°å½“å‰åº”ç”¨çš„log4jæ—¥å¿—ï¼š å°†è®¿é—®æ—¥å¿—è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ï¼š æœåŠ¡å®¹å™¨æœåŠ¡å®¹å™¨æ˜¯ä¸€ä¸ª standalone çš„å¯åŠ¨ç¨‹åºï¼Œå› ä¸ºåå°æœåŠ¡ä¸éœ€è¦ Tomcat æˆ– JBoss ç­‰ Web å®¹å™¨çš„åŠŸèƒ½ï¼Œå¦‚æœç¡¬è¦ç”¨ Web å®¹å™¨å»åŠ è½½æœåŠ¡æä¾›æ–¹ï¼Œå¢åŠ å¤æ‚æ€§ï¼Œä¹Ÿæµªè´¹èµ„æºã€‚ æœåŠ¡å®¹å™¨åªæ˜¯ä¸€ä¸ªç®€å•çš„ Main æ–¹æ³•ï¼Œå¹¶åŠ è½½ä¸€ä¸ªç®€å•çš„ Spring å®¹å™¨ï¼Œç”¨äºæš´éœ²æœåŠ¡ã€‚ æœåŠ¡å®¹å™¨çš„åŠ è½½å†…å®¹å¯ä»¥æ‰©å±•ï¼Œå†…ç½®äº† spring, jetty, log4j ç­‰åŠ è½½ï¼Œå¯é€šè¿‡å®¹å™¨æ‰©å±•ç‚¹è¿›è¡Œæ‰©å±•ã€‚é…ç½®é…åœ¨ java å‘½ä»¤çš„ -D å‚æ•°æˆ–è€… dubbo.properties ä¸­ã€‚ å®¹å™¨ç±»å‹ Spring Container è‡ªåŠ¨åŠ è½½ META-INF&#x2F;spring ç›®å½•ä¸‹çš„æ‰€æœ‰ Spring é…ç½®ã€‚ é…ç½® spring é…ç½®åŠ è½½ä½ç½®ï¼š dubbo.spring.config&#x3D;classpath*:META-INF&#x2F;spring&#x2F;*.xml Jetty Container å¯åŠ¨ä¸€ä¸ªå†…åµŒ Jettyï¼Œç”¨äºæ±‡æŠ¥çŠ¶æ€ã€‚ é…ç½®ï¼š dubbo.jetty.port=8080ï¼šé…ç½® jetty å¯åŠ¨ç«¯å£ dubbo.jetty.directory=/foo/barï¼šé…ç½®å¯é€šè¿‡ jetty ç›´æ¥è®¿é—®çš„ç›®å½•ï¼Œç”¨äºå­˜æ”¾é™æ€æ–‡ä»¶ dubbo.jetty.page=log,status,systemï¼šé…ç½®æ˜¾ç¤ºçš„é¡µé¢ï¼Œç¼ºçœåŠ è½½æ‰€æœ‰é¡µé¢ Log4j Container è‡ªåŠ¨é…ç½® log4j çš„é…ç½®ï¼Œåœ¨å¤šè¿›ç¨‹å¯åŠ¨æ—¶ï¼Œè‡ªåŠ¨ç»™æ—¥å¿—æ–‡ä»¶æŒ‰è¿›ç¨‹åˆ†ç›®å½•ã€‚ é…ç½®ï¼š dubbo.log4j.file=/foo/bar.logï¼šé…ç½®æ—¥å¿—æ–‡ä»¶è·¯å¾„ dubbo.log4j.level=WARNï¼šé…ç½®æ—¥å¿—çº§åˆ« dubbo.log4j.subdirectory=20880ï¼šé…ç½®æ—¥å¿—å­ç›®å½•ï¼Œç”¨äºå¤šè¿›ç¨‹å¯åŠ¨ï¼Œé¿å…å†²çª å®¹å™¨å¯åŠ¨ç¼ºçœåªåŠ è½½ spring ReferenceConfig ç¼“å­˜ReferenceConfig å®ä¾‹å¾ˆé‡ï¼Œå°è£…äº†ä¸æ³¨å†Œä¸­å¿ƒçš„è¿æ¥ä»¥åŠä¸æä¾›è€…çš„è¿æ¥ï¼Œéœ€è¦ç¼“å­˜ã€‚å¦åˆ™é‡å¤ç”Ÿæˆ ReferenceConfig å¯èƒ½é€ æˆæ€§èƒ½é—®é¢˜å¹¶ä¸”ä¼šæœ‰å†…å­˜å’Œè¿æ¥æ³„æ¼ã€‚åœ¨ API æ–¹å¼ç¼–ç¨‹æ—¶ï¼Œå®¹æ˜“å¿½ç•¥æ­¤é—®é¢˜ã€‚ å› æ­¤ï¼Œè‡ª 2.4.0 ç‰ˆæœ¬å¼€å§‹ï¼Œ dubbo æä¾›äº†ç®€å•çš„å·¥å…·ç±» ReferenceConfigCacheç”¨äºç¼“å­˜ ReferenceConfig å®ä¾‹ã€‚ ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š æ¶ˆé™¤ Cache ä¸­çš„ ReferenceConfigï¼Œå°†é”€æ¯ ReferenceConfig å¹¶é‡Šæ”¾å¯¹åº”çš„èµ„æºã€‚ ç¼ºçœ ReferenceConfigCache æŠŠç›¸åŒæœåŠ¡ Groupã€æ¥å£ã€ç‰ˆæœ¬çš„ ReferenceConfig è®¤ä¸ºæ˜¯ç›¸åŒï¼Œç¼“å­˜ä¸€ä»½ã€‚å³ä»¥æœåŠ¡ Groupã€æ¥å£ã€ç‰ˆæœ¬ä¸ºç¼“å­˜çš„ Keyã€‚ å¯ä»¥ä¿®æ”¹è¿™ä¸ªç­–ç•¥ï¼Œåœ¨ ReferenceConfigCache.getCache æ—¶ï¼Œä¼ ä¸€ä¸ª KeyGeneratorã€‚è¯¦è§ ReferenceConfigCache ç±»çš„æ–¹æ³•ã€‚ ç°åœºdumpå½“ä¸šåŠ¡çº¿ç¨‹æ± æ»¡æ—¶ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“çº¿ç¨‹éƒ½åœ¨ç­‰å¾…å“ªäº›èµ„æºã€æ¡ä»¶ï¼Œä»¥æ‰¾åˆ°ç³»ç»Ÿçš„ç“¶é¢ˆç‚¹æˆ–å¼‚å¸¸ç‚¹ã€‚dubboé€šè¿‡Jstackè‡ªåŠ¨å¯¼å‡ºçº¿ç¨‹å †æ ˆæ¥ä¿ç•™ç°åœºï¼Œæ–¹ä¾¿æ’æŸ¥é—®é¢˜ é»˜è®¤ç­–ç•¥: å¯¼å‡ºè·¯å¾„ï¼Œuser.homeæ ‡è¯†çš„ç”¨æˆ·ä¸»ç›®å½•å¯¼å‡ºé—´éš”ï¼Œæœ€çŸ­é—´éš”å…è®¸æ¯éš”10åˆ†é’Ÿå¯¼å‡ºä¸€æ¬¡æŒ‡å®šå¯¼å‡ºè·¯å¾„ï¼š","date":"2024-12-31","categories":["java"],"tags":["dubbo"]},{"title":"gradle-å­¦ä¹ ç¬”è®°(1)-åˆæ­¥ä½¿ç”¨","url":"/2024/12/31/gradle-å­¦ä¹ ç¬”è®°-1--åˆæ­¥ä½¿ç”¨/","content":"æœ€è¿‘æƒ³æ·±å…¥çš„å­¦ä¹ ä¸€ä¸‹å·¥ç¨‹åŒ–æ–¹é¢ç›¸å…³çš„ä¸œè¥¿ï¼Œåœ¨mavenå’Œgradleç›´æ¥çº ç»“ä¸å·²ï¼Œå› ä¸ºmavençš„æ‰©å±•æ€§å¤ªå·®åŠ²äº†ï¼Œå­¦ä¹ æˆæœ¬é¢‡é«˜ï¼Œæ‰€ä»¥æœ€åæŠ•å…¥äº†gradleçš„æ€€æŠ±ä¸­ï¼Œä»¥åæœ‰æ—¶é—´å†é‡æ–°å­¦ä¹ ä¸€ä¸‹mavenå§ æœ€è¿‘çš„å­¦ä¹ ç¬”è®°æ˜¯åŸºäºgradle 5 ç³»åˆ—ï¼Œå…¶ä¸­å„ç§æ•™ç¨‹å’Œä¾‹å­å¤§éƒ½æ˜¯æ¥æºäºå®˜æ–¹æ–‡æ¡£æˆ–è€…ç½‘ç»œä¸Šçš„åšå®¢ã€‚å†…å®¹æ¶µç›–æˆ‘åœ¨å­¦ä¹ gradleè¿‡ç¨‹ä¸­çš„å„ç§å¿ƒå¾—å’Œgradleçš„ä¸€äº›ä½¿ç”¨æ–¹æ³• æ³¨æ„: è¿™é‡Œä½¿ç”¨çš„é…å¶è¯­è¨€ä¸–kotlin è€Œä¸æ˜¯ä½¿ç”¨groovy gradleåˆ›å»ºé¡¹ç›®ä¸€ä¸ªå‘½ä»¤ ç”¨æˆ·å¯ä»¥é€šè¿‡è¿™ä¸ªå‘½ä»¤åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„gradleé¡¹ç›®åŒ…æ‹¬gradleé¡¹ç›®çš„ç›®å½•ç»“æ„ (1) gradle çš„æ„å»ºè„šæœ¬ç”¨æ¥æ„å»ºå½“å‰çš„gradleé¡¹ç›®,æœ€æ ¸å¿ƒçš„é…ç½®æ–‡ä»¶ (2) (3) ä¸€ä¸ªgradleå‰¯æœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œç”¨æ¥å½“å¦‚æœç³»ç»Ÿä¸­çš„gradleç‰ˆæœ¬å’Œé¡¹ç›®ä½¿ç”¨çš„gradleç‰ˆæœ¬ä¸åŒï¼Œå°†ä¼šåœ¨è¿™é‡Œä¸‹è½½ä¸€ä¸ªé¡¹ç›®ä¸­çš„ç‰ˆæœ¬ (4) (5) é…å¥—ä½¿ç”¨çš„å‘½ä»¤è¡Œå·¥å…· æ²¡æœ‰.batåç¼€çš„æ˜¯unixç³»ç»Ÿå‘½ä»¤æœ‰çš„æ˜¯windownsç³»ç»Ÿï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡Œgradleä¸­å®šä¹‰çš„å„ç§task ä»»åŠ¡ (6) ç”¨äºé…ç½®Gradleæ„å»ºçš„Gradleè®¾ç½®è„šæœ¬ gradleçš„taskgradle æ–¹ä¾¿ç”¨æˆ·è¿›è¡Œé…ç½®çš„ç‰¹æ€§æ˜¯æºäºgradleæä¾›äº†æ–¹ä¾¿ä½¿ç”¨taskå‚æ•°è¿™é‡Œç¼–å†™ä¸€ä¸ªå¾ˆåŸºæœ¬çš„copyæ–‡ä»¶çš„æƒé™ï¼Œåœ¨è·¯å¾„ä¸­æ·»åŠ ä¸€ä¸ªsrcæ–‡ä»¶å¤¹å’Œdestæ–‡ä»¶å¤¹ï¼Œåœ¨srcæ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªæ–‡ä»¶markfile.txt å¹¶ä¸”é‡Œé¢æœ‰ä¸€ä¸ªå†…å®¹hello worldï¼ ç„¶ååœ¨build.gradle ä¸­ç¼–å†™ä¸€ä¸ªä»»åŠ¡ å…¶ä¸­çš„type å­—æ®µå°†ä¼šè°ƒç”¨ç³»ç»Ÿä¸­çš„Copyå‡½æ•°ï¼Œè€Œgroupå’Œdescription åªæ˜¯æè¿°è¿™ä¸ªè¿‡ç¨‹çš„æè¿°ç¬¦ï¼Œåªä¼šå½±å“ç³»ç»Ÿçš„logè¾“å‡ºï¼Œå¹¶ä¸ä¼šå½±å“å®é™…çš„æ•ˆæœ è¿è¡Œå¯¹åº”çš„å‘½ä»¤å°±èƒ½è¿è¡Œå¯¹åº”çš„copyæ–¹æ³• ä½¿ç”¨ä¸€ä¸ªgradleå†…éƒ¨çš„æ’ä»¶ç³»ç»Ÿåœ¨é¡¹ç›®ä¸­ä½¿ç”¨æ’ä»¶æ ‡ç­¾pluginsæ·»åŠ æŒ‡å®šçš„baseæ’ä»¶åˆ°ç³»ç»Ÿä¸­ ç„¶ååœ¨æŒ‡å®šçš„ä½ç½®æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæ’ä»¶(å’Œä»»åŠ¡çš„ä½¿ç”¨æ–¹æ³•ç›¸åŒï¼Œæˆ‘æ€€ç–‘å…¶å®gradleçš„æ’ä»¶å°±æ˜¯æ‰“åŒ…å¥½çš„ä»»åŠ¡) ç„¶åè¿è¡Œå¯¹åº”çš„å‘½ä»¤,å°±å¯ä»¥åœ¨å¯¹åº”çš„ç›®å½• build&#x2F;distributions ä¸­æ‰¾åˆ° srcç›®å½•ä¸‹çš„å‹ç¼©æ–‡ä»¶äº† æŸ¥çœ‹å½“å‰æ‹¥æœ‰çš„taskgradle æœ‰ä¸€ä¸ªå†…ç½®çš„å‘½ä»¤ è¿™æ¡å‘½ä»¤å°†ä¼šå°†æ‰€æœ‰çš„å½“å‰çš„gradleé¡¹ç›®ä¸­æ‹¥æœ‰çš„æ„å»ºå‘½ä»¤å…¨éƒ¨åˆ—å‡ºæ¥ gradle æä¾›çš„åœ¨çº¿æŸ¥çœ‹æ„å»ºè¯¦æƒ…çš„æ–¹æ³• â€“scanå‘½ä»¤æˆ‘ä»¬åœ¨ä½¿ç”¨æ„å»ºå‘½ä»¤çš„æ—¶å€™å¯ä»¥åœ¨å‘½ä»¤çš„åé¢æ·»åŠ ä¸€ä¸ª â€“scanå‘½ä»¤,é€šè¿‡è¿™ä¸ªå‘½ä»¤å¯ä»¥é“¾æ¥åˆ°gradleå®˜æ–¹çš„viewæ˜¾ç¤ºä»“åº“æˆ–è€…è¿æ¥åˆ°è‡ªå®šä¹‰çš„é“¾æ¥ä»“åº“ä¸­,ç„¶åè½»æ¾çš„æŸ¥çœ‹é¡¹ç›®ä½¿ç”¨çš„æ„å»ºä»»åŠ¡,æ„å»ºæ—¶é—´ç­‰ç­‰ä¿¡æ¯ ç„¶åå¯ä»¥ç™»å…¥å‘½ä»¤è¡Œæ‰“å‡ºçš„ä¸€ä¸ªç½‘å€,åœ¨å…¶ä¸­çš„formè¡¨å•ä¸­å¡«å†™é‚®ç®±åœ°å€,ç„¶åå°±ä¼šå°†æ„å»ºçš„ä¿¡æ¯å‘é€åˆ°é‚®ç®±ä¸­äº† æ³¨æ„:è¿™ä¸ªåŠŸèƒ½æ˜¯æ”¶è´¹çš„ gradle å±•ç¤ºå½“å‰ç³»ç»Ÿçš„å¯ç”¨å‚æ•°ä¿¡æ¯ propertieså‘½ä»¤","date":"2024-12-31","categories":["java"],"tags":["gradle"]},{"title":"gradle-å­¦ä¹ ç¬”è®°(2)-å¤šé¡¹ç›®æ„å»º","url":"/2024/12/31/gradle-å­¦ä¹ ç¬”è®°-2--å¤šé¡¹ç›®æ„å»º/","content":"è®°å¾—åœ¨mavenä¸­æ”¯æŒå¤šä¸ªå­é¡¹ç›®çš„æ„å»ºæ–¹æ³•,åŒæ ·çš„åœ¨gradle ä¸­ä¹Ÿä¼šæ”¯æŒå¤šé¡¹ç›®çš„æ„å»ºæ–¹æ³• è¿˜è®°å¾—åœ¨mavenä¸­å¦‚ä½•é…ç½®å¤šé¡¹ç›®å·¥ç¨‹å—, è¿™é‡Œå›å¿†ä¸€ä¸‹ é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªçˆ¶å…ƒç´ pomæ–‡ä»¶æ¯”å¦‚è¿™æ · è€Œåœ¨gradleä¸­,æˆ‘ä»¬å¹¶ä¸éœ€è¦æŒ‡å®šçˆ¶å…ƒç´ çš„æ ‡ç­¾,æˆ‘ä»¬åªéœ€è¦ç¼–å†™å¥½å¯¹åº”çš„æ–‡ä»¶å¤¹åç§°ï¼Œå¹¶ä¸”å°†æ–‡ä»¶å¤¹åç§°å’Œå¯¹åº”çš„ç›®å½•ç»“æ„å¯¹åº”æ¸…ï¼Œgradle å°±èƒ½è‡ªåŠ¨çš„è¯†åˆ«è¿™ä¸ªå­é¡¹ç›® æ¯”å¦‚æˆ‘åˆ›å»ºè¿™æ ·ä¸€ä¸ªå­é¡¹ç›®åç§°æ˜¯greeting-library å­é¡¹ç›®ä¸­çš„é…ç½®æœªè§build.gradle çˆ¶é¡¹ç›®ä¸­çš„setting.gradleä¸­æ·»åŠ è¿™æ ·ä¸€æ¡é…ç½® è¿™æ ·å°±èƒ½ä½¿ç”¨greeting-libraryç›®å½•ä¸‹çš„gradleå­é¡¹ç›®äº† ä¸€ä¸ªç®€å•çš„é¡¹ç›®è¿™ä½¿ç”¨ä¸€ä¸ªç®€å•çš„é¡¹ç›®ä»‹ç»ä¸€ä¸‹è¿™ä¸ªå¦‚ä½•ä½¿ç”¨gradle å®ç°æ•´åˆæ‰“åŒ… é¡¹ç›®ç»“æ„å’Œæ¨¡å—åˆ’åˆ† è¿™ä¸ªé¡¹ç›®ä¸­åˆ’åˆ†ä¸ºæ ¹é¡¹ç›®gradle-demoï¼ŒåŒ…é¡¹ç›®greeting-libraryï¼Œcoreå¯è¿è¡Œé¡¹ç›®greeterã€‚ æ³¨æ„ï¼š é€šè¿‡ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼Œåœ¨gradle ä¸­ä¸åŒçš„å­é¡¹ç›®çš„å‘½åè§„åˆ™æ˜¯ä½¿ç”¨æ–‡ä»¶å¤¹çš„æ³¨æ„ï¼šåœ¨java é¡¹ç›®ä¸­ï¼Œgradle è¦æ±‚ å¿…é¡»æŒ‡å®šé¡¹ç›®çš„mainå‡½æ•°å…·ä½“æ–¹æ³•è§ä¸‹æ–¹ è¿™é‡Œé’ˆå¯¹gradleçš„å¤šè¯­è¨€çš„ç¼–ç¨‹çš„ç›®å½•ç»“æ„åšä¸€ä¸‹è¡¥å……ï¼Œgradleä¸­æºä»£ç åŒæ„æ”¾ç½®åœ¨è¿™æ ·çš„ä½ç½®ä¸­src->main&#x2F;test->ç¼–ç¨‹è¯­è¨€åç§°æ–‡ä»¶å¤¹ ä¸‹ æ€»ç»“åœ¨æ„å»ºgradle å¤šæ¨¡å—é¡¹ç›®çš„æ—¶å€™,ä¸€å®šè¦æ³¨æ„å¤šæ¨¡å—çš„ä¹‹é—´çš„å¼•ç”¨ï¼Œæ¨¡å—ä¸­mainå‡½æ•°çš„ç¼–å†™ï¼Œçˆ¶æ¨¡å—çš„include","date":"2024-12-31","categories":["java"],"tags":["gradle"]},{"title":"gradle-å­¦ä¹ ç¬”è®°(3)-æ„å»ºjaråŒ…","url":"/2024/12/31/gradle-å­¦ä¹ ç¬”è®°-3--æ„å»ºjaråŒ…/","content":"ä½œä¸ºä¸€ä¸ªæœ€åŸºæœ¬çš„å…¥é—¨ï¼Œè¿™é‡Œåªæ˜¯æ‰“ä¸€ä¸ªæœ€ç®€å•çš„jaråŒ… æ‰“jaråŒ…ä¸‰ä¸ªé‡è¦çš„gradleçš„å‚æ•° nameï¼Œbuild.gradleçš„versionå’Œjar é€šè¿‡jar å‘½ä»¤æ„å»ºjaråŒ…ä¸­MANIFSET.MFæ–‡ä»¶ä¸­çš„å‚æ•°ä¿¡æ¯jar é…ç½®çš„æ–¹æ³• ç„¶åä½¿ç”¨jar å‘½ä»¤çš„æ—¶å€™ï¼Œå°†ä¼šåœ¨buildæ–‡ä»¶å¤¹ä¸­çš„libså­æ–‡ä»¶å¤¹é‡Œç”Ÿæˆå¯¹åº”çš„jaråŒ…ï¼Œè¿™é‡Œæ‘˜å‡ºä»–çš„MANIFSET.MFæ–‡ä»¶ä¸­çš„å†…å®¹ version åˆ¶å®šç”Ÿæˆçš„jaråŒ…ç‰ˆæœ¬å·æˆ‘ä»¬é…ç½®ä¸€ä¸ªå‚æ•° ç„¶åå½“æ‰§è¡Œgradle jar çš„taskçš„æ—¶å€™å°†ä¼šåœ¨libæ–‡ä»¶å¤¹ä¸­ç”Ÿæˆåç¼€ä¸º1.0-SNAPSHOTçš„jaråŒ…","date":"2024-12-31","categories":["java"],"tags":["gradle"]},{"title":"gradle-å­¦ä¹ ç¬”è®°(4)-æ‰§è¡Œæµ‹è¯•æ ·ä¾‹","url":"/2024/12/31/gradle-å­¦ä¹ ç¬”è®°-4--æ‰§è¡Œæµ‹è¯•æ ·ä¾‹/","content":"gradleå¯ä»¥è‡ªåŠ¨çš„æ‰§è¡Œæµ‹è¯•æ ·ä¾‹ï¼Œå‰ææ˜¯è¦æ±‚æµ‹è¯•çš„åŒ…åå’Œè¦æµ‹è¯•çš„ç±»æ˜¯ä¸€ä¸€å¯¹åº”çš„ å½“é¡¹ç›®ä¸­ç¼–å†™äº†Testç›®å½•ä¸­çš„å†…å®¹çš„æ—¶å€™ï¼Œç„¶åæŒ‡å®šçš„æµ‹è¯•æ ·ä¾‹å†™æ³•æ­£ç¡®ï¼Œå½“è¿è¡Œtest taskçš„æ—¶å€™ï¼Œgradleå°†ä¼šè‡ªåŠ¨çš„æ‰§è¡Œå¯¹åº”çš„æµ‹è¯•ï¼Œå¹¶ä¸”åœ¨buildçš„build æ–‡ä»¶å¤¹ä¸­çš„reports ä»¥htmlçš„å½¢å¼ï¼Œè¾“å‡ºå¯¹åº”çš„ç»“æœ","date":"2024-12-31","categories":["java"],"tags":["gradle"]},{"title":"gradle-å­¦ä¹ ç¬”è®°(5)-ç”Ÿæˆå¯æ‰§è¡Œçš„appliaction","url":"/2024/12/31/gradle-å­¦ä¹ ç¬”è®°-5--ç”Ÿæˆå¯æ‰§è¡Œçš„appliaction/","content":"gradle åˆæ­¥çš„å­¦ä¹ å·²ç»è¿›è¡Œåˆ°è¿™é‡Œäº†,è¶Šæ¥è¶Šè§‰å¾—gradleè®¾è®¡çš„éå¸¸å·§å¦™,å¹¶ä¸”ideaå¯¹gradleçš„æ”¯æŒä¹Ÿæ˜¯éå¸¸åˆ°ä½çš„ åœ¨æˆ‘ä»¬æ·±å…¥ç†è§£gradleä½“ç³»çš„æ—¶å€™,ä¸€å®šè¦è´¯å½»ä¸€ä¸ªgradleçš„è®¾è®¡å“²å­¦,ä¸€åˆ‡çš†task gradleç”Ÿæˆå¯æ‰§è¡Œçš„application - gradle çš„ application æ’ä»¶gradle æƒ³è¦ç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œçš„ä»»åŠ¡æ˜¯éå¸¸å®¹æ˜“çš„,åªè¦åœ¨build.gradle æ–‡ä»¶ä¸­å¼•å…¥applicationæ’ä»¶,å¹¶ä¸”ä½¿ç”¨mainapplication å­—æ®µæŒ‡æ˜äº†mainå‡½æ•°çš„å¯¹è±¡,å°±å¯ä»¥ä½¿ç”¨ gradle run å‘½ä»¤æ¥æ‰§è¡Œè¿™ä¸ªmainå‡½æ•° (æˆ–è€…ä½¿ç”¨gradlew è¿™ä¸¤ä¸ªå‘½ä»¤æœ¬è´¨ä¸Šæ˜¯ç­‰ä»·çš„) è¿™ä¸ªæ˜¯åœ¨ideaä¸­æŸ¥çœ‹çš„,å¯ä»¥çœ‹å‡ºå·²ç»å‡ºç°äº†runçš„task é€šè¿‡gradleçš„task â€“allå‘½ä»¤åŒæ ·å¯ä»¥çœ‹è§ ä¸€ä¸ªdemoå®ä¾‹é¡¹ç›®çš„ç›®å½•ç»“æ„å¦‚ä¸‹ é¦–å…ˆåœ¨mainæ–¹æ³•ä¸­å®ç°äº†ä¸€ä¸ªç®€å•çš„å‡½æ•°è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸² å¹¶ä¸”ç¼–å†™äº†ä¸€ä¸ªtestæ ·ä¾‹ TestApp æ•´ä¸ªé¡¹ç›®çš„build.gradleå¦‚ä¸‹ è¿™é‡Œæˆ‘ä»¬å¼•å…¥äº†applicationæ’ä»¶,é€šè¿‡è¿™ä¸ªæ’ä»¶,æˆ‘ä»¬å°±èƒ½åœ¨é¡¹ç›®ä¸­ä½¿ç”¨gradle å¯¹åº”çš„å‘½ä»¤æ¥æ‰§è¡Œæˆ‘ä»¬è‡ªå·±çš„mainæ–¹æ³•äº† æ‰§è¡Œ gradle run å¯ä»¥çœ‹è§è¿™é‡Œå…¶å®è¿è¡Œäº†å¯¹åº”çš„å‡½æ•°è¾“å‡ºäº†hello world å¼•ç”³ ä¸€ä¸‹æŠŠ,çœ‹ä¸€ä¸‹è¿™é‡Œçš„æµ‹è¯•,å½“è¿è¡Œäº†gradle çš„buildå‘½ä»¤çš„æ—¶å€™,åŒæ ·ä¼šæ‰§è¡Œæµ‹è¯•æ ·ä¾‹,å¹¶ä¸”åœ¨buildçš„reportsæ–‡ä»¶å¤¹ä¸­ç”Ÿæˆå¯¹åº”çš„æµ‹è¯•æŠ¥å‘Šhtml","date":"2024-12-31","categories":["java"],"tags":["gradle"]},{"title":"gradle-å­¦ä¹ ç¬”è®°(6)-javaWebé¡¹ç›®å¼€å‘","url":"/2024/12/31/gradle-å­¦ä¹ ç¬”è®°-6--javaWebé¡¹ç›®å¼€å‘/","content":"gradle é€šè¿‡è‡ªå¸¦çš„waræ’ä»¶å¯ä»¥ç¼–ç¨‹ç”ŸæˆwebåŒ…é¡¹ç›®,å¹¶ä¸”ç¤¾åŒºæä¾›äº†grettyè¿™ä¸ªæ’ä»¶,é€šè¿‡è¿™ä¸ªæ’ä»¶,æˆ‘ä»¬å¯ä»¥ä¸å¿…äººå·¥çš„é‡‡ç”¨æ‰‹åŠ¨æ‰“waråŒ…éƒ¨ç½²åˆ°webå®¹å™¨ä¸­æ¥è¿è¡Œwebé¡¹ç›®,è€Œæ˜¯ç›´æ¥ç¼–è¯‘æˆclassæ–‡ä»¶åœ¨é¡¹ç›®ä¸­è¿è¡Œå®¹å™¨å’Œwebé¡¹ç›® gradle web é¡¹ç›®ç›®å½•è§£æå…¶å®æœ¬è´¨ä¸Šgradle çš„web é¡¹ç›®ç›¸æ¯”è¾ƒwar é¡¹ç›®çš„ä¸€ä¸ªæœ¬è´¨ä¸Šçš„åŒºåˆ«å°±æ˜¯åœ¨main ç›®å½•ä¸‹å¤šäº†ä¸€ä¸ªwebapp æ–‡ä»¶å¤¹,è¿™ä¸ªæ˜¯é»˜è®¤å­˜æ”¾javaweb ç›¸å…³ä¿¡æ¯çš„æ–‡ä»¶å¤¹ ä¸€ä¸ªç®€å•çš„webé¡¹ç›® webé¡¹ç›®çš„build.gradle æ³¨æ„è¿™é‡Œ,gradleçš„war åŒ…ä½“æ·»åŠ äº†ä¸€ä¸ªæ–°çš„ä¾èµ–é€‰é¡¹,proovidedCompileå’ŒprovidedRuntime åˆ†åˆ«å’Œjava æ„å»ºçš„compileå’Œruntimeç›¸åŒ,åªä¸è¿‡æ‰“åŒ…çš„æ—¶å€™ä¸ä¼šå°†è¿™ä¸ªåº”ç”¨æ‰“è¿›å¯¹åº”çš„åŒ…ä¸­ è¿™é‡Œå¼•ç”¨äº†javaçš„mockitoè‡ªåŠ¨æµ‹è¯•æ¡†æ¶,ç›¸æ¯”è¾ƒjunitæ›´å…·æœ‰æµç¨‹åŒ–çš„ç‰¹ç‚¹ servlet æµ‹è¯•servlet jspå’Œindex.html æ–‡ä»¶ é¡¹ç›®çš„æ•´ä½“ç»“æ„ é¡¹ç›®çš„è¿è¡Œæ–¹æ³•gradleçš„grettyæ’ä»¶æä¾›äº†å¤§é‡çš„taskä¾›æˆ‘ä»¬é€‰æ‹©,è¿™é‡Œæˆ‘ä»¬è¿è¡Œåªæ˜¯ä½¿ç”¨appRun Taskå°±è¡Œäº† æ³¨æ„:gretty çš„ä»“åº“å¿…é¡»ä½¿ç”¨jcenter()è€Œä¸èƒ½ä½¿ç”¨mavenCentral(),å› ä¸ºå…¶ä¸­çš„ä¸€äº›ä¾èµ–åŒ…åœ¨mavenä¸­ä¸å­˜åœ¨,æˆ‘åœ¨ä½¿ç”¨çš„æ—¶å€™æ˜¯ä¸¤ä¸ªéƒ½è¿ è¿™é‡Œæˆ‘ä»¬è¿è¡Œä¸€ä¸‹gradle appRun â€“console&#x3D;plain å¼•ç”³:â€“console&#x3D;plain gradle5 å°†ä¸€äº›æ§åˆ¶å°è¾“å‡ºåˆå¹¶äº†,è¿™é‡Œä½¿ç”¨è¿™ä¸ªå‚æ•°å¯ä»¥å°†åˆå¹¶çš„ä¿¡æ¯å±•å¼€æ˜¾ç¤º æˆ‘ä»¬å‘ç°grettyå¯åŠ¨äº†ä¸€ä¸ªjettyæœåŠ¡ç›‘å¬8080æ‰“å¼€å¯¹åº”çš„åœ°å€å°±èƒ½æ˜¾ç¤ºå¯¹åº”çš„ä¿¡æ¯äº†","date":"2024-12-31","categories":["java"],"tags":["gradle"]},{"title":"gradle-å­¦ä¹ ç¬”è®°(7)-ç¼–å†™è‡ªå®šä¹‰Tasks(custom tasks)","url":"/2024/12/31/gradle-å­¦ä¹ ç¬”è®°-7--ç¼–å†™è‡ªå®šä¹‰Tasks-custom-tasks-/","content":"å¥½äº†ç»ˆäºåˆ°äº†é‡å¤´æˆäº†,gradelæœ€ä¸ºå¼ºå¤§çš„åœ°æ–¹å°±æ˜¯å¯ä»¥éå¸¸æ–¹ä¾¿çš„å®šä¹‰taskå¹¶é›†æˆåˆ°å¼€å‘ç¯å¢ƒä¸­ ç®€å•çš„ä¸´æ—¶ä»»åŠ¡gradle æä¾›åœ¨buildä¸­ç›´æ¥ç¼–å†™ä¸´æ—¶taskçš„æ–¹æ³•,åƒä¸‹é¢è¿™æ · è¿™æ®µä»£ç æ³¨å†Œäº†ä¸€ä¸ªhello task,åˆ†é…åˆ°äº†task groupç»„é‡Œ æè¿°ä¸ºa simple demo task,ä½œç”¨æ˜¯æ‰“å°ä¸€ä¸ªhello,world åˆ°æ§åˆ¶å° ä½¿ç”¨gradle task å‘½ä»¤å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è‡ªå®šä¹‰çš„task groupç»„ä¸‹çš„ hello task è¿è¡Œgradle hello å‘½ä»¤å¯ä»¥æ‰“å°å‡º hello,world ä½¿ç”¨gradle ç¼–ç¨‹å®ç°ä»»åŠ¡å…¶å®æœ¬è´¨ä¸Šå’Œç®€å•ä»»åŠ¡ç›¸åŒ,åªè¿‡ä½¿ç”¨äº†gradleå£°æ˜äº†ä¸€ä¸ªå¯¹è±¡ç½¢äº† å…·ä½“çš„ä¸€çœ‹ä»£ç å°±æ˜ç™½äº†,è¯´ä¸¤ç‚¹1.@TaskAction è¡¨æ˜è¿™ä¸ªæ˜¯é»˜è®¤çš„ä»»åŠ¡æ–¹æ³•,å¦‚æœæ²¡æœ‰æŒ‡æ˜å°±é»˜è®¤ä½¿ç”¨è¿™ä¸ªæ–¹æ³• 2. DefaultTask æ˜¯gradleçš„é»˜è®¤æ‰©å±•,gradleè¿˜æä¾›äº†å…¶ä»–çš„æ–¹æ³•,è¿™é‡Œä¸åšå±•å¼€äº†","date":"2024-12-31","categories":["java"],"tags":["gradle"]},{"title":"gradle-è¿›é˜¶(1)-å‘½ä»¤è¡Œ æ“ä½œå®Œå…¨æ€»ç»“","url":"/2024/12/31/gradle-è¿›é˜¶-1--å‘½ä»¤è¡Œ-æ“ä½œå®Œå…¨æ€»ç»“/","content":"è¿™é‡Œè®°å½•ä¸€ä¸‹gradleçš„è¯¦ç»†ä½¿ç”¨ä¿¡æ¯ gradle å‘½ä»¤çš„ç»„æˆ gradleçš„å‘½ä»¤æ€»ä½“ä¸Šåªæœ‰ä¸¤ä¸ªç‚¹ taskname å’Œ option å¦‚æœä¸å¸¦â€“ å°±æ˜¯task å¸¦çš„è¯å°±æ˜¯option optionå¯èƒ½å¸¦æœ‰å‚æ•°,è¿™é‡Œä½¿ç”¨&#x3D;å·æ¥ä¸ºä»–èµ‹å€¼ å¯ä»¥ä½¿ç”¨ â€“no- æ¥å‘½ååè½¬,è¡¨ç¤ºä¸è¿›è¡Œä»€ä¹ˆæ“ä½œ optionå…·æœ‰ç­‰ä»·å½¢å¼æ¯”å¦‚ gradle æ‰§è¡Œtask åœ¨å­é¡¹ç›®ç¯å¢ƒä¸‹å¯ä»¥ä½¿ç”¨[:å­é¡¹ç›®åç§°]â€¦[:å­é¡¹ç›®åç§°][:taskName] æ¥è¿è¡ŒæŒ‡å®šçš„task(åªæ˜¯åœ¨rooté¡¹ç›®ä¸­å¯ä»¥è¿è¡Œ) å¦‚æœæ²¡æœ‰æŒ‡å®šå­é¡¹ç›®åç§°å°†ä¼šä»å½“å‰ç›®å½•çš„é¡¹ç›®ä¸­å‘ä¸‹å¯»æ‰¾task å¤štaskè¿è¡Œ åº”ç”¨ä¸Šé¢çš„è§„åˆ™,ä½¿ç”¨ç©ºæ ¼å¯å¼€å°±å¯ä»¥æŒ‡å®šå¤šä¸ªå­taské¡ºåºæ‰§è¡Œäº† ç§»é™¤ä¸€ä¸ªtask ä½¿ç”¨ â€“exclude-task ç§»é™¤gradleè¿è¡Œè¿‡ç¨‹ä¸­çš„ä¸€ä¸ªtask é‡æ–°è¿è¡Œ ä¸ä¼šä¿ç•™ä¹‹å‰è¿è¡Œçš„ç»“æœè€Œæ˜¯é‡æ–°æ‰§è¡Œ éä¸­æ–­æ‰§è¡Œ â€“continue è¿™ä¸ªå‚æ•°å°†ä¼šè¦†ç›–ä¹‹å‰gradleè¿è¡Œæ˜¯å¦‚æœæœ‰ä¸€ä¸ªtaskå¤±è´¥æ¥ä¸‹æ¥çš„éƒ½ä¸ä¼šæ‰§è¡Œ,è€Œå˜ä¸ºè·³è¿‡å¤±è´¥çš„taskåœ¨å…¶ä»–éä¾èµ–æœ¬å¤±è´¥taskçš„taskæ‰§è¡Œå®Œåæ‰“å°é”™è¯¯ gradleä¸­ä¸€äº›å¸¸ç”¨çš„task åç§° ä½œç”¨ build ç»„è£…æ‰€æœ‰è¾“å‡ºå¹¶è¿è¡Œæ‰€æœ‰æ£€æŸ¥ run æ‰§è¡ŒæŸäº›è„šæœ¬æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ check ä½¿ç”¨è¯¥ä»»åŠ¡æ‰§è¡Œæ‰€æœ‰éªŒè¯ä»»åŠ¡ï¼ˆåŒ…æ‹¬æµ‹è¯•å’Œlintingï¼‰ clean åˆ é™¤æ„å»ºç›®å½•çš„å†…å®¹ projects åˆ—å‡ºæ‰€æœ‰çš„é¡¹ç›®æŠ¥å‘Š,å­é¡¹ç›®æ ‘ tasks ä¸»è¦taskåˆ—è¡¨,å¯ä»¥ä½¿ç”¨â€“all æ‰“å°å‡ºæ›´å¤šçš„ä¿¡æ¯ gradle help â€“task someTas æ˜¾ç¤ºæŒ‡å®šä»»åŠ¡çš„è¯¦ç»†ä¿¡æ¯ gradle myTask â€“scan æ„å»ºæ‰«ææä¾›äº†å…³äºå“ªäº›é…ç½®ï¼Œä¼ é€’ä¾èµ–å…³ç³»å’Œä¾èµ–å…³ç³»ç‰ˆæœ¬é€‰æ‹©å­˜åœ¨å“ªäº›ä¾èµ–å…³ç³»çš„å®Œæ•´å¯è§†æŠ¥å‘Š gradle dependencies æä¾›æ‰€é€‰é¡¹ç›®çš„ä¾èµ–å…³ç³»åˆ—è¡¨ï¼ŒæŒ‰é…ç½®ç»†åˆ†ã€‚å¯¹äºæ¯ä¸ªé…ç½®ï¼Œè¯¥é…ç½®çš„ç›´æ¥å’Œä¼ é€’ä¾èµ–å…³ç³»éƒ½æ˜¾ç¤ºåœ¨æ ‘ä¸­ gradle buildEnvironment é€šä¸Šé¢çš„ä¾èµ–é…ç½®,è¿™ä¸ªå±•ç¤ºçš„æ˜¯çˆ¶å­é¡¹ç›®æˆ–è€…å…¶ä»–å½¢å¼çš„é…ç½®ä¾èµ– gradle properties ä¸ºæ‚¨æä¾›æ‰€é€‰é¡¹ç›®çš„å±æ€§åˆ—è¡¨ gradle model gradleä¸­ä¸€äº›å¸¸ç”¨çš„option DEBUGç›¸å…³çš„å‚æ•° åç§° ä½œç”¨ -?, -h, â€“help å¸®åŠ©æ–‡æ¡£ -v, â€“version è¾“å‡ºæ•´ä¸ªç¯å¢ƒçš„ç‰ˆæœ¬ä¿¡æ¯groovy java gradleç­‰ç­‰ -S, â€“full-stacktrace æ‰“å°å‡ºä»»ä½•å¼‚å¸¸çš„å®Œæ•´ï¼ˆéå¸¸è¯¦ç»†ï¼‰å †æ ˆè·Ÿè¸ªã€‚ å¦è¯·å‚é˜…æ—¥å¿—è®°å½•é€‰é¡¹ -s, â€“stacktrace æ‰“å°å †æ ˆè·Ÿè¸ªä¹Ÿç”¨äºç”¨æˆ·å¼‚å¸¸ï¼ˆä¾‹å¦‚ç¼–è¯‘é”™è¯¯ï¼‰ã€‚å¦è¯·å‚é˜…æ—¥å¿—è®°å½•é€‰é¡¹ â€“scan åˆ›å»ºä¸€ä¸ªæ„å»ºæ‰«æï¼Œå…¶ä¸­åŒ…å«æœ‰å…³Gradleæ„å»ºçš„æ‰€æœ‰æ–¹é¢çš„ç»†ç²’åº¦ä¿¡æ¯ -Dorg.gradle.debug&#x3D;true Debug Gradle client (non-Daemon) process. Gradle will wait for you to attach a debugger at localhost:5005 by default. -Dorg.gradle.daemon.debug&#x3D;true Debug Gradle Daemonè¿›ç¨‹ æ€§èƒ½é€‰æ‹©å‚æ•°(Performance options) è¿™é‡Œçš„å¾ˆå¤šæ€§èƒ½ä¼˜åŒ–å‚æ•°å…¶å®å¯ä»¥åœ¨gradle.propertiesä¸­æŒ‡å®šçš„ åç§° ä½œç”¨ propertiesæ–‡ä»¶ä¸­çš„å‚æ•° â€“build-cache, â€“no-build-cache åˆ‡æ¢Gradleæ„å»ºç¼“å­˜.Gradleå°†å°è¯•é‡ç”¨ä»¥å‰ç‰ˆæœ¬çš„è¾“å‡º.é»˜è®¤ä¸ºå…³é—­ â€“configure-on-demand, â€“no-configure-on-demand åˆ‡æ¢æŒ‰éœ€é…ç½®ã€‚åœ¨æ­¤æ„å»ºè¿è¡Œä¸­ä»…é…ç½®ç›¸å…³é¡¹ç›®ã€‚é»˜è®¤ä¸ºå…³é—­ã€‚ â€“max-workers è®¾ç½®Gradleå¯ä»¥ä½¿ç”¨çš„æœ€å¤§å·¥ä½œæ•°ã€‚é»˜è®¤å€¼æ˜¯å¤„ç†å™¨æ•°é‡ â€“parallel, â€“no-parallel å¹¶è¡Œæ„å»ºé¡¹ç›®ã€‚æœ‰å…³æ­¤é€‰é¡¹çš„é™åˆ¶ï¼Œè¯·å‚é˜…å¹¶è¡Œé¡¹ç›®æ‰§è¡Œã€‚é»˜è®¤ä¸ºå…³é—­ã€‚ â€“profile åœ¨$ buildDir &#x2F; reports &#x2F; profileç›®å½•ä¸­ç”Ÿæˆé«˜çº§æ€§èƒ½æŠ¥å‘Šã€‚ â€“scanæ˜¯é¦–é€‰ã€‚ â€“scan ä½¿ç”¨è¯¦ç»†çš„æ€§èƒ½è¯Šæ–­ç”Ÿæˆæ„å»ºæ‰«æã€‚ Gradleå®ˆæŠ¤ç¨‹åºé€‰é¡¹ åç§° ä½œç”¨ â€“daemon, â€“no-daemon ä½¿ç”¨Gradle Daemonè¿è¡Œæ„å»ºã€‚å¦‚æœæœªè¿è¡Œå®ˆæŠ¤ç¨‹åºæˆ–ç°æœ‰å®ˆæŠ¤ç¨‹åºç¹å¿™ï¼Œåˆ™å¯åŠ¨å®ˆæŠ¤ç¨‹åºã€‚é»˜è®¤æ‰“å¼€ã€‚ â€“foreground åœ¨å‰å°è¿›ç¨‹ä¸­å¯åŠ¨Gradleå®ˆæŠ¤ç¨‹åº â€“status (Standalone command) è¿è¡Œgradle â€“statusåˆ—å‡ºæ­£åœ¨è¿è¡Œä¸”æœ€è¿‘åœæ­¢çš„Gradleå®ˆæŠ¤è¿›ç¨‹ã€‚ä»…æ˜¾ç¤ºç›¸åŒGradleç‰ˆæœ¬çš„å®ˆæŠ¤ç¨‹åºã€‚ â€“stop (Standalone command) è¿è¡Œgradle â€“stopä»¥åœæ­¢ç›¸åŒç‰ˆæœ¬çš„æ‰€æœ‰Gradleå®ˆæŠ¤è¿›ç¨‹ã€‚ -Dorg.gradle.daemon.idletimeout&#x3D;(number of milliseconds) Gradleå®ˆæŠ¤ç¨‹åºå°†åœ¨æ­¤æ¯«ç§’çš„ç©ºé—²æ—¶é—´ååœæ­¢è¿è¡Œã€‚é»˜è®¤å€¼ä¸º10800000ï¼ˆ3å°æ—¶ï¼‰ gradle æ—¥å¿—å‚æ•°-Dorg.gradle.logging.level&#x3D;(quiet,warn,lifecycle,info,debug)|é€šè¿‡Gradleå±æ€§è®¾ç½®æ—¥å¿—è®°å½•çº§åˆ«ã€‚-q, â€“quiet|ä»…è®°å½•é”™è¯¯ã€‚-w, â€“warn|å°†æ—¥å¿—çº§åˆ«è®¾ç½®ä¸ºè­¦å‘Š-i, â€“info|Set log level to info.-d, â€“debug|ç™»å½•è°ƒè¯•æ¨¡å¼ï¼ˆåŒ…æ‹¬æ­£å¸¸çš„å †æ ˆè·Ÿè¸ªï¼‰ã€‚ gradleè‡ªå®šä¹‰æ—¥å¿—æ ·å¼æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æŒ‡å®šâ€œæ§åˆ¶å°â€æ¨¡å¼æ¥æ§åˆ¶ä¸°å¯Œè¾“å‡ºï¼ˆé¢œè‰²å’Œå­—ä½“å˜ä½“ï¼‰çš„ä½¿ç”¨ -Dorg.gradle.console&#x3D;(auto,plain,rich,verbose),â€“console&#x3D;(auto,plain,rich,verbose)|é€šè¿‡Gradleå±æ€§æŒ‡å®šæ§åˆ¶å°æ¨¡å¼ã€‚ä¸‹é¢æè¿°äº†ä¸åŒçš„æ¨¡å¼ plain : è®¾ç½®ä¸ºplainä»¥ä»…ç”Ÿæˆçº¯æ–‡æœ¬ã€‚æ­¤é€‰é¡¹ç¦ç”¨æ§åˆ¶å°è¾“å‡ºä¸­çš„æ‰€æœ‰é¢œè‰²å’Œå…¶ä»–ä¸°å¯Œè¾“å‡ºã€‚å½“Gradleæœªè¿æ¥åˆ°ç»ˆç«¯æ—¶ï¼Œè¿™æ˜¯é»˜è®¤è®¾ç½® auto : è®¾ç½®ä¸ºautoï¼ˆé»˜è®¤å€¼ï¼‰ä»¥åœ¨æ„å»ºè¿‡ç¨‹é™„åŠ åˆ°æ§åˆ¶å°æ—¶åœ¨æ§åˆ¶å°è¾“å‡ºä¸­å¯ç”¨é¢œè‰²å’Œå…¶ä»–ä¸°å¯Œè¾“å‡ºï¼Œæˆ–ä»…åœ¨æœªè¿æ¥åˆ°æ§åˆ¶å°æ—¶ç”Ÿæˆçº¯æ–‡æœ¬ã€‚ è¿™æ˜¯Gradleè¿æ¥åˆ°ç»ˆç«¯æ—¶çš„é»˜è®¤è®¾ç½®ã€‚ rich : è®¾ç½®ä¸ºrichä»¥åœ¨æ§åˆ¶å°è¾“å‡ºä¸­å¯ç”¨é¢œè‰²å’Œå…¶ä»–ä¸°å¯Œè¾“å‡ºï¼Œæ— è®ºæ„å»ºè¿‡ç¨‹æ˜¯å¦æœªé™„åŠ åˆ°æ§åˆ¶å°ã€‚ å¦‚æœæœªè¿æ¥åˆ°æ§åˆ¶å°ï¼Œåˆ™æ„å»ºè¾“å‡ºå°†ä½¿ç”¨ANSIæ§åˆ¶å­—ç¬¦æ¥ç”Ÿæˆä¸°å¯Œçš„è¾“å‡ºã€‚ verbose : è®¾ç½®ä¸ºverboseä»¥å¯ç”¨é¢œè‰²å’Œå…¶ä»–ä¸°å¯Œè¾“å‡ºï¼Œå¦‚å¯Œï¼Œä½†åœ¨ç”Ÿå‘½å‘¨æœŸæ—¥å¿—çº§åˆ«è¾“å‡ºä»»åŠ¡åç§°å’Œç»“æœï¼Œå¦‚Gradle 3.5åŠæ›´æ—©ç‰ˆæœ¬ä¸­é»˜è®¤æ‰§è¡Œ gradle è­¦å‘Šæç¤ºçº§åˆ«é»˜è®¤æƒ…å†µä¸‹ï¼ŒGradleä¸ä¼šæ˜¾ç¤ºæ‰€æœ‰è­¦å‘Šï¼ˆä¾‹å¦‚ï¼Œå¼ƒç”¨è­¦å‘Šï¼‰ã€‚ç›¸åï¼ŒGradleå°†æ”¶é›†å®ƒä»¬å¹¶åœ¨æ„å»ºç»“æŸæ—¶å‘ˆç°æ‘˜è¦ -Dorg.gradle.warning.mode&#x3D;(all,none,summary)é€šè¿‡Gradleå±æ€§æŒ‡å®šè­¦å‘Šæ¨¡å¼ã€‚ ä¸‹é¢æè¿°äº†ä¸åŒçš„æ¨¡å¼ã€‚ â€“warning-mode&#x3D;(all,none,summary)æŒ‡å®šå¦‚ä½•è®°å½•è­¦å‘Šã€‚ é»˜è®¤ä¸ºæ‘˜è¦ã€‚ è®¾ç½®ä¸ºallä»¥è®°å½•æ‰€æœ‰è­¦å‘Šã€‚ è®¾ç½®ä¸ºsummaryä»¥ç¦æ­¢æ‰€æœ‰è­¦å‘Šå¹¶åœ¨æ„å»ºç»“æŸæ—¶è®°å½•æ‘˜è¦ã€‚ è®¾ç½®ä¸ºnoneä»¥ç¦æ­¢æ‰€æœ‰è­¦å‘Šï¼ŒåŒ…æ‹¬æ„å»ºç»“æŸæ—¶çš„æ‘˜è¦ã€‚ æ‰§è¡Œæ—¶è®¾ç½®option ps æ„Ÿè§‰æ²¡å°‘å•¥ç”¨,å…·ä½“å¯ä»¥çœ‹æ–‡æ¡£è¿™é‡Œä¸è®°å½•äº† gradle é…ç½®å‚æ•°(è¿™äº›å…¶å®å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šçš„å¯¹åº”çš„æ–¹æ³•) åç§° ä½œç”¨ -b,-build-file æŒ‡å®šæ„å»ºæ–‡ä»¶ã€‚ä¾‹å¦‚ï¼šgradle â€“build-file &#x3D; foo.gradleã€‚é»˜è®¤å€¼ä¸ºbuild.gradleï¼Œç„¶åæ˜¯build.gradle.ktsï¼Œç„¶åæ˜¯myProjectName.gradleã€‚ -c,-setting-fil æŒ‡å®šè®¾ç½®æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼šgradle â€“settings-file &#x3D; somewhere&#x2F;else&#x2F;settings.gradle -g,-gradle-user-home æŒ‡å®šGradleç”¨æˆ·ä¸»ç›®å½•ã€‚é»˜è®¤å€¼æ˜¯ç”¨æˆ·ä¸»ç›®å½•ä¸­çš„.gradleç›®å½•ã€‚ -p,-project-dir æŒ‡å®šGradleçš„èµ·å§‹ç›®å½•ã€‚é»˜è®¤ä¸ºå½“å‰ç›®å½•ã€‚ â€“project-ç¼“å­˜ç›®å½• æŒ‡å®šé¡¹ç›®ç‰¹å®šçš„ç¼“å­˜ç›®å½•ã€‚æ ¹é¡¹ç›®ç›®å½•ä¸­çš„é»˜è®¤å€¼ä¸º.gradleã€‚ -u,-no-search-upwardï¼ˆä¸å»ºè®®ä½¿ç”¨ï¼‰ ä¸è¦åœ¨çˆ¶ç›®å½•ä¸­æœç´¢settings.gradleæ–‡ä»¶ã€‚ -D,-system-prop è®¾ç½®JVMçš„ç³»ç»Ÿå±æ€§ï¼Œä¾‹å¦‚-Dmyprop &#x3D; myvalueã€‚è¯·å‚é˜…ç³»ç»Ÿå±æ€§ã€‚ -I,-init-script æŒ‡å®šåˆå§‹åŒ–è„šæœ¬ã€‚è¯·å‚é˜…Init Scriptsã€‚ -P,-project-prop è®¾ç½®æ ¹é¡¹ç›®çš„é¡¹ç›®å±æ€§ï¼Œä¾‹å¦‚-Pmyprop &#x3D; myvalueã€‚è¯·å‚é˜…ç³»ç»Ÿå±æ€§ã€‚ -Dorg.gradle.jvmargs è®¾ç½®JVMå‚æ•°ã€‚ gradle åˆå§‹åŒ–æ„å»ºä¸»è¦å°±æ˜¯ä¸€ä¸ªå‘½ä»¤ è¿™ä¸ªå‘½ä»¤å¯ä»¥é™„å¸¦ä¸€äº›å‚æ•°,æ¯”å¦‚ â€“type java-library : æŒ‡å®šæ„å»ºçš„é¡¹ç›®ç±»å‹â€“gradle-version : æŒ‡å®šgradleçš„ç‰ˆæœ¬ ç­‰ç­‰ gradle çš„æŒç»­æ„å»ºç›®å‰æ˜¯ä¸€é¡¹æµ‹è¯•åŠŸèƒ½ åº”ç”¨å‚æ•°æ˜¯â€“continuousjava9 çš„æ›´æ–°å¤ªå¤§äº†,ç°åœ¨å¾ˆå¤šæ¡†æ¶éƒ½æ˜¯åº”ç”¨çš„java8æ„å»ºçš„,java9 æ‰¯åˆ°è›‹äº†â€¦â€¦.java11 çœŸçš„å¾ˆå¼ºå¤§,å­¦äº†gradleå‡†å¤‡å¼€å§‹é€ è½®å­äº†,é‚£äº›æ¡†æ¶æ²¡æœ‰æ›´æ–°æ˜¯å› ä¸ºç”¨çš„äººå°‘,ç¤¾åŒºä¹Ÿæ²¡æœ‰å»æ¨åŠ¨â€¦â€¦â€¦â€¦â€¦â€¦..","date":"2024-12-31","categories":["java"],"tags":["gradle"]},{"title":"gradle-è¿›é˜¶(2)-gradlePluginså¼€å‘","url":"/2024/12/31/gradle-è¿›é˜¶-2--gradlePluginså¼€å‘/","content":"gradleæ’ä»¶,æˆ‘çš„ç†è§£å…¶å®æœ¬è´¨ä¸Šå°±æ˜¯ä¸€å †taskçš„é›†åˆ","date":"2024-12-31","categories":["java"],"tags":["gradle"]},{"title":"gradle-è¿›é˜¶(2)-gradleç¯å¢ƒä¿¡æ¯,å±æ€§é…ç½®è¯¦è§£","url":"/2024/12/31/gradle-è¿›é˜¶-2--gradleç¯å¢ƒä¿¡æ¯-å±æ€§é…ç½®è¯¦è§£/","content":"è¿™ä¸€ç¯‡æ–‡ç« æ˜¯ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« gradleå‘½ä»¤è¡Œç›¸å…³çš„è®°å½•çš„æ–‡ç« çš„å»¶ç»­,ä¸»è¦è®°å½•ä¸€ä¸‹gradleçš„å„ç§ç¯å¢ƒæˆ–è€…è¯´å±æ€§çš„é…ç½®æ–¹æ³• gradle å„ç§å±æ€§å˜é‡çš„ä¼˜å…ˆçº§gradleæœ‰äº”ç§å±æ€§æ„å»ºä¼˜å…ˆçº§,è¿™é‡Œå°†ä¼˜å…ˆçº§ä»é«˜åˆ°åº•æ’åº å‘½ä»¤è¡Œæ ‡å¿—å¦‚â€“build-cache.å®ƒä»¬ä¼˜å…ˆäºå±æ€§å’Œç¯å¢ƒå˜é‡. ç³»ç»Ÿå±æ€§ï¼Œä¾‹å¦‚systemProp.http.proxyHost&#x3D;somehost.orgå­˜å‚¨åœ¨gradle.propertiesæ–‡ä»¶ä¸­.æŒ‡çš„è¯•ä¸€äº›æœ‰systemPropå‰ç¼€çš„å‚æ•° Gradleå±æ€§(ä¾‹å¦‚org.gradle.caching&#x3D;trueé€šå¸¸å­˜å‚¨åœ¨gradle.propertiesé¡¹ç›®æ ¹ç›®å½•æˆ–GRADLE_USER_HOME(linux ç³»ç»Ÿçš„$USER_HOME&#x2F;.gradleç›®å½•)ç¯å¢ƒå˜é‡ä¸­çš„æ–‡ä»¶ä¸­). ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚GRADLE_OPTSç”±æ‰§è¡ŒGradleçš„ç¯å¢ƒæä¾›çš„,åœ¨ç¯å¢ƒå˜é‡ä¸­è®¾ç½®å¯¹åº”çš„å‚æ•°,åŒ…æ‹¬çš„ç¯å¢ƒå˜é‡æœ‰ GRADLE_OPTS GRADLE_USER_HOME JAVA_HOME (ps è¿™ä¸ªä¸€èˆ¬ä¸ä½¿ç”¨) é¡¹ç›®æ„å»ºé¡¹ç›®å±æ€§ï¼Œå¦‚-PreleaseType&#x3D;final,å°±æ˜¯åœ¨gradle.propertiesä¸­é™¤äº†gradle.propertiesä¹‹å¤–çš„å‚æ•° æ¨èç”¨æ³•ä½¿ç”¨gradle.propertiesgradle.properties æ‰¿æ¥äº†gradle ç³»ç»Ÿçš„å¾ˆå¤šå±æ€§,é€šè¿‡è¿™ç§æ–¹æ³•,æˆ‘ä»¬å¯ä»¥ç»Ÿä¸€gradleçš„ç¯å¢ƒä¿¡æ¯é…ç½® gradle.properties ä¸­çš„å‚æ•°å…·æœ‰ä¸€å®šçš„ä¼˜å…ˆçº§,ç›¸åŒçš„å‚æ•°å¦‚æœé…ç½®åœ¨ä¸åŒçš„ä½ç½®ä¸Šå°†ä¼šæœ‰è¦†ç›–æ•ˆæœ,è¦†ç›–è§„åˆ™å¦‚ä¸‹åè€…è¦†ç›–å‰è€…: gradle.properties åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­. gradle.propertiesåœ¨GRADLE_USER_HOMEç›®å½•ä¸­. ç³»ç»Ÿå±æ€§ ä¸‹é¢çš„å±æ€§å°†ä¼šåº”ç”¨åœ¨gradleä¸­ åç§° å‚æ•° org.gradle.caching&#x3D;(true,false) è®¾ç½®ä¸ºtrueæ—¶ï¼ŒGradleå°†å°½å¯èƒ½é‡ç”¨ä»»ä½•å…ˆå‰æ„å»ºçš„ä»»åŠ¡è¾“å‡ºï¼Œä»è€Œä½¿æ„å»ºé€Ÿåº¦æ›´å¿«.äº†è§£æœ‰å…³ä½¿ç”¨æ„å»ºç¼“å­˜çš„æ›´å¤šä¿¡æ¯. org.gradle.caching.debug&#x3D;(true,false) è®¾ç½®ä¸ºtrueæ—¶ï¼Œå°†åœ¨æ§åˆ¶å°ä¸Šè®°å½•å„ä¸ªè¾“å…¥å±æ€§å“ˆå¸Œå€¼ä»¥åŠæ¯ä¸ªä»»åŠ¡çš„æ„å»ºç¼“å­˜é”®.äº†è§£æœ‰å…³ä»»åŠ¡è¾“å‡ºç¼“å­˜çš„æ›´å¤šä¿¡æ¯. org.gradle.configureondemand&#x3D;(true,false) å…è®¸æŒ‰éœ€å­µåŒ–é…ç½®ï¼ŒGradleå°†å°è¯•ä»…é…ç½®å¿…è¦çš„é¡¹ç›®. org.gradle.console&#x3D;(auto,plain,rich,verbose) è‡ªå®šä¹‰æ§åˆ¶å°è¾“å‡ºç€è‰²æˆ–è¯¦ç»†ç¨‹åº¦.é»˜è®¤å€¼å–å†³äºGradleçš„è°ƒç”¨æ–¹å¼.æœ‰å…³å…¶ä»–è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…å‘½ä»¤è¡Œæ—¥å¿—è®° org.gradle.daemon&#x3D;(true,false) å½“è®¾ç½®trueçš„æ‘‡ç¯®å®ˆæŠ¤è¿›ç¨‹æ¥è¿è¡Œæ„å»º.é»˜è®¤æ˜¯true. org.gradle.daemon.idletimeout&#x3D;(# of idle millis) Gradleå®ˆæŠ¤ç¨‹åºå°†åœ¨æŒ‡å®šçš„ç©ºé—²æ¯«ç§’æ•°åè‡ªè¡Œç»ˆæ­¢.é»˜è®¤ä¸º10800000(3å°æ—¶) org.gradle.debug&#x3D;(true,false) è®¾ç½®trueä¸ºæ—¶ï¼ŒGradleå°†åœ¨å¯ç”¨è¿œç¨‹è°ƒè¯•çš„æƒ…å†µä¸‹è¿è¡Œæ„å»ºï¼Œä¾¦å¬ç«¯å£5005.è¯·æ³¨æ„ï¼Œè¿™ç›¸å½“äºæ·»åŠ -agentlib:jdwp&#x3D;transport&#x3D;dt_socket,server&#x3D;y,suspend&#x3D;y,address&#x3D;5005åˆ°JVMå‘½ä»¤è¡Œï¼Œå¹¶å°†æŒ‚èµ·è™šæ‹Ÿæœºï¼Œç›´åˆ°è¿æ¥è°ƒè¯•å™¨.é»˜è®¤æ˜¯false. org.gradle.java.home&#x3D;(path to JDK home) æŒ‡å®šGradleæ„å»ºè¿‡ç¨‹çš„Javaä¸»ç›®å½•.å¯ä»¥å°†å€¼è®¾ç½®ä¸ºa jdkæˆ–jrelocationï¼Œä½†æ˜¯ï¼Œæ ¹æ®æ„å»ºçš„åŠŸèƒ½ï¼Œä½¿ç”¨JDKä¼šæ›´å®‰å…¨.å¦‚æœæœªæŒ‡å®šè®¾ç½®ï¼Œåˆ™ä½¿ç”¨åˆç†çš„é»˜è®¤å€¼. org.gradle.jvmargs&#x3D;(JVM arguments) æŒ‡å®šç”¨äºGradleå®ˆæŠ¤ç¨‹åºçš„JVMå‚æ•°.è¯¥è®¾ç½®å¯¹äºä¸ºæ„å»ºæ€§èƒ½é…ç½®JVMå†…å­˜è®¾ç½®ç‰¹åˆ«æœ‰ç”¨. org.gradle.logging.level&#x3D;(quiet,warn,lifecycle,info,debug) å½“è®¾ç½®ä¸ºquietï¼Œwarnï¼Œlifecycleï¼Œinfoæˆ–debugæ—¶ï¼ŒGradleå°†ä½¿ç”¨æ­¤æ—¥å¿—çº§åˆ«.å€¼ä¸åŒºåˆ†å¤§å°å†™.è¯¥lifecycleçº§åˆ«æ˜¯ç¼ºçœå€¼.è¯·å‚é˜…é€‰æ‹©æ—¥å¿—çº§åˆ«. org.gradle.parallel&#x3D;(true,false) é…ç½®å®Œæˆåï¼ŒGradleå°†åˆ†å‰åˆ°org.gradle.workers.maxJVMä»¥å¹¶è¡Œæ‰§è¡Œé¡¹ç›®.è¦äº†è§£æœ‰å…³å¹¶è¡Œä»»åŠ¡æ‰§è¡Œçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…Gradleæ€§èƒ½æŒ‡å—. org.gradle.warning.mode&#x3D;(all,none,summary) è®¾ç½®ä¸ºallï¼Œsummaryæˆ–è€…noneï¼ŒGradleå°†ä½¿ç”¨ä¸åŒçš„è­¦å‘Šç±»å‹æ˜¾ç¤º.æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…å‘½ä»¤è¡Œæ—¥å¿—è®°å½•é€‰ org.gradle.workers.max&#x3D;(max # of worker processes) é…ç½®åï¼ŒGradleå°†ä½¿ç”¨ç»™å®šæ•°é‡çš„å·¥ä½œè€…çš„æœ€å¤§å€¼.é»˜è®¤å€¼æ˜¯CPUå¤„ç†å™¨æ•°.å¦è¯·å‚è§æ€§èƒ½å‘½ä»¤è¡Œé€‰é¡¹. gradle jvm é…ç½®gradle ä½¿ç”¨org.gradle.jvmargs å¯ä»¥é…ç½®jvmçš„å„ç§è¿è¡Œå‚æ•° ä¹Ÿå¯ä»¥é’ˆå¯¹æŸä¸€ä¸ªtaskå•ç‹¬è¿›è¡Œé…ç½® gradle ç¼–ç¨‹è®¾ç½®å‚æ•°ä¿¡æ¯è¿™æˆ‘ä»¬å…ˆæ˜¯å£°æ˜äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„task,ç„¶ååœ¨å†…éƒ¨ä½¿ç”¨if else å’Œ project.hasProperty æ–¹æ³•åˆ¤æ–­gradle çš„è¿è¡Œç¯å¢ƒä¸­æ—¶å€™æœ‰isCIè¿™ä¸ªå‚æ•° gradleé€šè¿‡httpä»£ç†è®¿é—®webé…ç½®HTTPæˆ–HTTPSä»£ç†ï¼ˆä¾‹å¦‚ï¼Œç”¨äºä¸‹è½½ä¾èµ–é¡¹ï¼‰æ˜¯é€šè¿‡æ ‡å‡†JVMç³»ç»Ÿå±æ€§å®Œæˆçš„ã€‚è¿™äº›å±æ€§å¯ä»¥ç›´æ¥åœ¨æ„å»ºè„šæœ¬ä¸­è®¾ç½®; ä¾‹å¦‚ï¼Œè®¾ç½®HTTPä»£ç†ä¸»æœºå°†å®ŒæˆSystem.setProperty(â€˜http.proxyHostâ€™, â€˜www.somehost.org')ã€‚æˆ–è€…ï¼Œå¯ä»¥åœ¨gradle.propertiesä¸­æŒ‡å®šå±æ€§ã€‚ ä½¿ç”¨é…ç½®HTTPä»£ç† gradle.properties HTTPSæœ‰å•ç‹¬çš„è®¾ç½®ã€‚ ä½¿ç”¨é…ç½®HTTPSä»£ç† gradle.properties","date":"2024-12-31","categories":["java"],"tags":["gradle"]},{"title":"gradle-è¿›é˜¶(3)-æ€§èƒ½ä¼˜åŒ–ä¸“é¢˜","url":"/2024/12/31/gradle-è¿›é˜¶-3--æ€§èƒ½ä¼˜åŒ–ä¸“é¢˜/","content":"gradleå†…éƒ¨è¿›è¡Œäº†å¤§é‡çš„ä¼˜åŒ–ä»¥æé«˜gradleçš„æ€§èƒ½,è¿™é‡Œæ•´ç†ä¸€ä¸‹gradleæ€§èƒ½ç›¸å…³çš„é…ç½®æ–¹æ³• ps : åŸºäºgradle5+ ç³»åˆ— gradleçš„å®ˆæŠ¤è¿›ç¨‹åŸç† : gradleä½¿ç”¨å®ˆæŠ¤è¿›ç¨‹çš„åŸç†éå¸¸ç®€å•,ç¬¬ä¸€æ¡,å‡å°‘äº†jvmæ¯æ¬¡çš„å¯åŠ¨æˆæœ¬,ç¬¬äºŒæ¡,åœ¨å†…å­˜ä¸­è¿›è¡Œä¼˜åŒ–,é‡ç”¨ä¹‹å‰çš„æ„å»ºç»“æœ æ³¨æ„é—®é¢˜ : gradleå®ˆæŠ¤ç¨‹åºæ˜¯ä¾èµ–è¿›ç¨‹é‡ç”¨çš„,åœ¨å®¹å™¨ä¸­éœ€è¦ç¦ç”¨æ‰ ç›¸å…³å‘½ä»¤ : â€“profile : äº†è§£å®ˆæŠ¤è¿›ç¨‹å¯èƒ½é€ æˆçš„å½±å“,å¹¶åˆ†ææ„å»º â€“status : æŸ¥çœ‹å®ˆæŠ¤è¿›ç¨‹çš„åˆ—è¡¨å’ŒçŠ¶æ€ â€“stop : ç»ˆæ­¢å®ˆæŠ¤è¿›ç¨‹ â€“deamon,â€“no-deamon : å¯ç”¨æˆ–è€…åœç”¨å®ˆæŠ¤è¿›ç¨‹ç¦ç”¨å®ˆæŠ¤è¿›ç¨‹æ–¹æ³•: åœ¨gradleè¿è¡Œç¯å¢ƒä¸­æ·»åŠ å‚æ•°(è§gradleç¯å¢ƒä¿¡æ¯,å±æ€§é…ç½®è¯¦è§£) å¤šä¸ªgradleå®ˆæŠ¤è¿›ç¨‹äº§ç”Ÿçš„åŸå›  : æœ¬è´¨ä¸Šæ˜¯å› ä¸ºgradleæ£€æµ‹äº†ç¯å¢ƒ(javaç‰ˆæœ¬,javaè¿è¡Œå‚æ•°ç­‰)ä¸åŒæ‰€ä»¥ç”Ÿæˆäº†æ–°çš„è¿›ç¨‹ å¯èƒ½å­˜åœ¨çš„é—®é¢˜ : æ„å»ºè„šæœ¬å†…å­˜æ³„æ¼,æˆ–è€…å…¨å±€çŠ¶æ€æŸåå¯¼è‡´çš„ä¸ä¸€è‡´é—®é¢˜,(windowsé—®é¢˜æ›´åŠ ä¸¥é‡,å› ä¸ºå®ƒå¯¹è¯»å–æˆ–å†™å…¥åæ— æ³•å…³é—­æ–‡ä»¶çš„ç¨‹åºçš„å®½å®¹åº¦è¾ƒä½)","date":"2024-12-31","categories":["java"],"tags":["gradle"]},{"title":"gradle-è¿›é˜¶(5)-gradleåˆ›å»ºå’Œè„šæœ¬","url":"/2024/12/31/gradle-è¿›é˜¶-5--gradleåˆ›å»ºå’Œè„šæœ¬/","content":"é€šè¿‡ä¹‹å‰çš„å…¥é—¨å­¦ä¹ ï¼Œä¸€ä¸ªgradleæ„å»ºå¯ä»¥ç†è§£æˆæœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªtaskç»„æˆï¼Œè¿™é‡Œç®€å•å›é¡¾ä¸€ä¸‹gradleè„šæœ¬å¦‚ä½•æ„å»ºä¸€ä¸ªç®€å•çš„task ä½¿ç”¨gradleè„šæœ¬åˆ›å»ºä¸€ä¸ªç®€å•çš„taskåœ¨build.gradle æ–‡ä»¶å¤¹ä¸­å†™å…¥ä¸€ä¸ªä»»åŠ¡ è¿™ä¸ªtaskçš„ä½œç”¨å¾ˆç®€å•å°±æ˜¯è¾“å‡ºä¸€ä¸ªhello world å­—ç¬¦ä¸² å¼•ç”³:å¦‚æœä½¿ç”¨è¿‡antçš„è¯é‚£ä¹ˆå¯ä»¥ç†è§£gradle taskå°±æ˜¯antä¸­çš„ç›®æ ‡ gradleæ„å»ºè„šæœ¬é«˜çº§ç©æ³•1. å¯ä»¥ä½¿ç”¨å±€éƒ¨å˜é‡å…¶å®å°±æ˜¯åœ¨gradleçš„taskè„šæœ¬ä¸­å¯ä»¥å£°æ˜å˜é‡ä¾›ä¸‹é¢å¼•ç”¨ gradle ä¾èµ–æ€§è„šæœ¬ä½¿ç”¨å¦‚æœä½¿ç”¨ä¾èµ–å­—æ®µdependsOn å…³é”®å­çš„æ—¶å€™,ç³»ç»Ÿå°†ä¼šå…ˆè¿è¡Œæ­¤å­—æ®µå¯¹åº”çš„task graldeä½¿ç”¨ç¼–ç¨‹æ–¹æ³•æ‰¹é‡æ·»åŠ taskï¼Œå’ŒåŠ¨æ€æ·»åŠ ä¾èµ– å¼•ç”³ä¸€ä¸‹è¿™ä¸ªåŠ¨æ€ä¾èµ–æ·»åŠ  ï¼š åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¦‚æœè¿è¡Œäº†task0 å°†ä¼šå…ˆä¸æ€§task2å’Œtask3 ç„¶åå†è¿è¡Œtask0ï¼Œåœ¨æ›´å¼ºå¤§çš„æ–¹æ³•è§ä¸‹é¢çš„ä¾‹å­ gradle ä½¿ç”¨apiè®¿é—®ä»»åŠ¡ è¿è¡Œçš„ç»“æœå¦‚ä¸‹ åŠ¨æ€è·å–tashå±æ€§çš„æ–¹æ³•è¿™ä¸ªæ–¹æ³•çš„ä½¿ç”¨éœ€è¦é…åˆgradle apiä½¿ç”¨çš„ åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œä½¿ç”¨$hello.nameè·å–åˆ°äº†è¿™ä¸ªä»»åŠ¡çš„åç§°,ä½¿ç”¨ext.xxx å®šä¹‰äº†ä¸€ä¸ªå˜é‡çš„åç§°ï¼Œå…µä½¿ç”¨hello.xxx è°ƒç”¨äº†è¿™ä¸ªå˜é‡çš„åç§° gradle buildæ–‡ä»¶ä¸­ä½¿ç”¨æ–¹æ³• æˆ‘ä»¬è¿™é‡Œä½¿ç”¨äº†groovyä¸è¯­æ³•å£°æ˜äº†ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”åœ¨æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ä»»åŠ¡ä¸­ä½¿ç”¨è¿™äº›å‡½æ•° æŒ‡å®šé»˜è®¤çš„taské»˜è®¤çš„task çš„ä½¿ç”¨æ–¹æ³•å°±æ˜¯è°ƒç”¨ gradle å‘½ä»¤å°†ä¼šé»˜è®¤è¿è¡Œçš„æ–¹æ³•ï¼Œä½¿ç”¨defaultTasks å®šä¹‰ gradleæ§åˆ¶æ‰§è¡Œé˜¶æ®µç®€å•å®ä¾‹ è¾“å‡ºä¿¡æ¯ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬ä½¿ç”¨äº† taskGraphæ–¹æ³•æ¥åœ¨gradleçš„é…ç½®è¿‡ç¨‹ä¸­ï¼ˆè¿˜æœ‰ä¸€ä¸ªæ˜¯è¿è¡Œè¿‡ç¨‹ï¼‰åŠ¨æ€æ”¹å˜ å˜é‡ï¼ˆversionï¼‰çš„æ–¹æ³• æ·»åŠ å¤–éƒ¨ä¾èµ–çš„æ–¹æ³•è¿™ä¸ªç‚¹åº”è¯¥å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰äº† è¿™é‡Œgroovy æä¾›äº†éå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­ç›´æ¥ä½¿ç”¨gradle å¼•ç”¨çš„ä»£ç ï¼ˆä¾‹å­ä¸­çš„taskå®šä¹‰ï¼‰ æˆ‘ä»¬è¿™é‡Œé‡Œä¸€å®šè¦æ³¨æ„importè¿™ä¸ªåŒ…ï¼Œideaæ¡†æ¶å¹¶ä¸ä¼šè‡ªåŠ¨æç¤º æˆ‘ä»¬ä½¿ç”¨å‘½ä»¤ gradle encode å°†ä¼šæœ‰å¦‚ä¸‹çš„è¾“å‡º","date":"2024-12-31","categories":["java"],"tags":["gradle"]},{"title":"gradle-è¿›é˜¶(6)-å¢å¼ºç‰ˆtaskæ„å»º","url":"/2024/12/31/gradle-è¿›é˜¶-6--å¢å¼ºç‰ˆtaskæ„å»º/","content":"å¢å¼ºç‰ˆtaskæ„å»ºä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« æ•´ç†gradle taskçš„ä¸€ä¸ªç®€å•åˆ›å»ºï¼Œè¿™é‡Œæ•´ç†ä¸€ä¸‹taskçš„é«˜çº§åº”ç”¨æ–¹æ³• ä»»åŠ¡çš„å®šä¹‰æ–¹æ³•å¦‚æœæ˜¯ç®€å•çš„ä»»åŠ¡æˆ‘ä»¬å¯ä»¥è¿™æ ·è¿›è¡Œå®šä¹‰ æˆ–è€…æŒ‡å®šä»»åŠ¡çš„ç±»å‹ï¼ˆç»§æ‰¿åŸæœ‰çš„ä»»åŠ¡ï¼‰ è¿™ç§æ–¹æ³•ï¼Œåé¢çš„type å­—æ®µå…¶å®æ˜¯å¯ä»¥çœç•¥çš„ é™¤æ­¤ä¹‹å¤–æˆ‘ä»¬è¿˜èƒ½ä½¿ç”¨tasksç»„çš„æ–¹æ³•åˆ›å»ºå¯¹åº”çš„ä»»åŠ¡ å®šä½åˆ°æŒ‡å®šçš„ä»»åŠ¡ å…¶å®æœ¬è´¨ä¸Šï¼Œgradleå°†ä¸€ä¸ªä¸ªä»»åŠ¡æŠ½è±¡æˆä¸€ä¸ªä¸€ä¸ªçš„å˜é‡ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½åœ¨ä½¿ç”¨çš„æ—¶å€™ç›´æ¥ä½¿ç”¨å˜é‡åæˆå¼•ç”¨å°±èƒ½å®ç° æˆ–è€…ä½¿ç”¨æŒ‰è·¯å¾„å’Œåç§°çš„æ–¹æ³•ï¼Œè·å–ä¸€ä¸ªtask è¿™é‡Œè¦æ³¨æ„ä¸¤ä¸ªåœ°æ–¹ é¦–å…ˆ project ä¸­æŒ‡å®šçš„è·¯å¾„å¿…é¡»æ˜¯ä¸€ä¸ªå·²ç»å®šä¹‰çš„gradleå­è·¯å¾„ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œgradleå°†ä¼šæŠ¥é”™ã€‚å…¶æ¬¡æ˜¯è¾“å‡ºçš„æ–¹æ³•å°±æ˜¯æŒ‰ç…§å®šä¹‰çš„æ–¹æ³•è¿›è¡Œæ‰§è¡Œ ä½¿ç”¨ç»„çš„æ–¹æ³•è·å–ä¸€ä¸ªå˜é‡ gradle ä»»åŠ¡çš„å˜é‡åŒ–æ“ä½œä¹‹å‰è¯´è¿‡åœ¨gradle ä¸­ æ‰€æœ‰çš„ä»»åŠ¡éƒ½å¯ä»¥æŠ½è±¡æˆå˜é‡ï¼Œè¿™é‡Œå†™ä¸€ä¸ªä¾‹å­æ¥è¡¨æ˜è¿™ä¸ªè§‚ç‚¹ æˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªç±»å‹æ˜¯Copyï¼Œåç§°æ—¶myCopyçš„taskï¼Œæ¥ä¸‹æ¥ä½¿ç”¨æ–¹æ³•åŠ¨æ€çš„è·å–è¿™ä¸ªtaskå¹¶å¯¹ä»–è¿›è¡Œä¸€å®šçš„ä¿®æ”¹æ“ä½œ å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰ä»»åŠ¡ä¹‹å‰æ•´ç†è¿‡ï¼Œåœ¨gradleä¸­æˆ‘ä»¬å…¶å®å¯ä»¥ç”Ÿå‘½ä¸€ä¸ªtaskç±»å‹ï¼Œæ–¹æ³•å¦‚ä¸‹ é€šè¿‡ç»§æ‰¿DefaultTaskç±»ï¼Œæˆ‘ä»¬å¯ä»¥åŠ¨æ€çš„å£°æ˜ä¸€ä¸ªtask åœ¨ä½¿ç”¨çš„æ—¶å€™å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä¸¤ç§å‘æ³•å®šä¹‰ä»»åŠ¡ æˆ‘ä»¬æŒ‡å®šäº†åç§°å’Œç±»å‹ï¼Œæœ€åçš„ä¸¤ä¸ªå‚æ•°å°†ä¼šä¼ å…¥æ„é€ å‡½æ•°ä¸­ï¼Œä½†æ˜¯åœ¨gradleä¸­ï¼Œå¦‚æœè¦ä½¿ç”¨æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ï¼Œé‚£ä¹ˆå¿…é¡»ä½¿ç”¨@Injectæ³¨è§£ è¿™ä¸ªæ–¹æ³•å°±å¾ˆæ˜ç¡®äº†,ç›´æ¥ä½¿ç”¨typeå’ŒconstructorArgså­—æ®µå®šä¹‰è¦ä½¿ç”¨çš„å‚æ•°ç±»å‹æ˜¯å•¥ gradle taskçš„ä¾èµ–ä¹‹å‰æˆ‘ä»¬æ•´ç†äº†taskä¾èµ–ï¼Œä½¿ç”¨dependsOnå­—æ®µï¼ŒæŒ‡æ˜ä¾èµ–è§ä¸‹é¢çš„ä¾‹å­ è¿™é‡Œæ‰©å±•ä¸€ä¸ªgradle ä¾èµ–å¤„ç†çš„é«˜çº§ç”¨æ³•ï¼ŒåŠ¨æ€æ·»åŠ ä¾èµ– è¿™ä¸ªæ–¹æ³•é€šè¿‡groovyçš„æ‰©å±•æ–¹æ³•ï¼ŒæŒ‡å®šäº†æ‰€æœ‰åç§°æœ‰libå‰ç¼€çš„taskéƒ½æ˜¯ä»–çš„ä¾èµ– gradle ä»»åŠ¡è¿è¡Œæ—¶æ’åºä¸¤ä¸ªå…³é”®å­— shouldAfterRun mustAfterRun ä¸€ä¸ªä¾‹å­ï¼š shouldRunAfter æŒ‡å®šçš„æ˜¯è¿™äº›ä»»åŠ¡åº”è¯¥æŒ‰ç…§æŒ‡å®šçš„é¡ºåºæ‰§è¡ŒmustRunAfter è¡¨ç¤ºå¿…é¡»æŒ‰ç…§æŒ‡å®šçš„é¡ºåºæ‰§è¡Œ ä¸Šé¢çš„ä¾‹å­ä¸­ä¼šæŒ‰ç…§ taskz -> taskY->taskx çš„é¡ºåºæ‰§è¡Œï¼Œå¦‚æœä½¿ç”¨äº†mustRunAfterå°†ä¼šæŠ¥é”™ gradle æœ€ç»ˆä»»åŠ¡ä½¿ç”¨finalizedByå­—æ®µæè¿°æ‰§è¡Œå™¨çš„æœ€ç»ˆä»»åŠ¡ï¼Œè¿™ä¸ªä»»åŠ¡å°†ä¸è®ºå®šä¹‰æ”¾æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œæœ€ç»ˆéƒ½å°†ä¼šæ‰§è¡Œ gradle taskçš„æè¿°ï¼Œæ›¿æ¢ï¼Œå’Œè·³è¿‡æ‰§è¡Œï¼Œå¯ç”¨ï¼Œç¦ç”¨ï¼Œè¶…æ—¶æ—¶é—´æ“ä½œgradle é’ˆå¯¹ä»»åŠ¡æä¾›äº†å¤§é‡çš„æ“ä½œæ€§åŠŸèƒ½ ä½¿ç”¨description åŒåè¦†ç›–æ“ä½œ å¦‚æœè‡ªå·±å‘½åçš„taskä¸ç³»ç»Ÿä¸­æˆ–è€…è‡ªå·±å®šä¹‰çš„å…¶ä»–taské‡åï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•è¿›è¡Œè¦†ç›– è·³è¿‡æ‰§è¡Œæ“ä½œ åœ¨è¿™é‡Œgradle æä¾›äº†ä¸¤ä¸ªæ–¹æ³•è·³è¿‡æ‰§è¡Œæ“ä½œï¼Œç¬¬ä¸€ç§ï¼Œä½¿ç”¨å“¦onlyIf å…³é”®å­— æŒ‡å®šåªåœ¨ä»€ä¹ˆæƒ…å†µä¸‹æ‰ä¼šæ‰§è¡Œå¯¹åº”çš„ä»»åŠ¡ ç¬¬äºŒç§ï¼Œåœ¨ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹ä¸­æŠ›å‡º stopExecutionExceptionå¼‚å¸¸ï¼Œç»ˆæ­¢è¿™ä¸ªè°ƒç”¨é“¾æ“ä½œ å¯ç”¨ç¦ç”¨è®¾ç½®è¶…æ—¶æ—¶é—´è¿™äº›gradleæ“ä½œï¼Œæˆ‘ç”¨ä¸€ä¸ªä¾‹å­æ¥è§£é‡Šå§ å¯ç”¨ç¦ç”¨æ“ä½œ è¶…æ—¶æ—¶é—´ gradle ä»»åŠ¡ç»„çº§åˆ«å…¨å±€è§„åˆ™æ³¨å…¥ gradleçš„project å’Œ å…¶ä»–ä¿¡æ¯ç”Ÿå‘½å‘¨æœŸä»»åŠ¡","date":"2024-12-31","categories":["java"],"tags":["gradle"]},{"title":"gradle-è¿›é˜¶(7)-gradleæ–‡ä»¶æ“ä½œ","url":"/2024/12/31/gradle-è¿›é˜¶-7--gradleæ–‡ä»¶æ“ä½œ/","content":"å…¶å®å¯¹äºä»»ä½•ä¸€ç§æ„å»ºå·¥å…·æ¥è¯´ï¼Œé’ˆå¯¹æ–‡ä»¶æ“ä½œçš„åŠŸèƒ½æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œè¿™é‡Œæ•´ç†ä¸€ä¸‹gradleé’ˆå¯¹æ–‡ä»¶æä¾›çš„åŠŸèƒ½ gradle ä¸­çš„æ–‡ä»¶è·¯å¾„ gradle çš„ Project.fileæ–¹æ³• ä½œç”¨ï¼š æŒ‡å®šå•ä¸ªæ–‡ä»¶æˆ–è€…ç›®å½•çš„ä½ç½®ï¼Œè§£æè§„åˆ™ï¼ˆç›¸å¯¹è·¯å¾„ç›¸å¯¹äºé¡¹ç›®ç›®å½•è¿›è¡Œè§£æï¼Œè€Œç»å¯¹è·¯å¾„ä¿æŒä¸å˜ï¼‰ã€‚ ä¾‹å­ï¼š æ³¨æ„ï¼šgradleä¸å¯ä½¿ç”¨new File(relative path) è¿™ä¸ªæ–¹æ³•ï¼Œï¼‰ï¼Œå› ä¸ºnew Fileï¼ˆrelativeï¼‰ä¼šåˆ›å»ºç›¸å¯¹ä¸è¿è¡Œæ—¶çš„ï¼ˆå½“æ—¶çš„ï¼‰è·¯å¾„ï¼Œgradleä¸èƒ½ä¿è¯è¿è¡Œæ—¶è·¯å¾„ç›¸åŒï¼ˆå†…éƒ¨çš„å®ˆæŠ¤ä»»åŠ¡å¯èƒ½ä¼šåˆ‡æ¢è·¯å¾„ï¼‰ Project.getRootDir ä½œç”¨ï¼š è·å–é¡¹ç›®çš„æ ¹è·¯å¾„ ä¾‹å­ï¼š gradle æ–‡ä»¶æ“ä½œæ–‡ä»¶é›†åˆgradleè¿™ä¹ˆå®šä¹‰æ–‡ä»¶é›†åˆçš„-å°±æ˜¯ä¸€ç»„æ–‡ä»¶ï¼Œä¸è€ƒè™‘ç›®å½•ä»€ä¹ˆ è·å–æ–‡ä»¶é›†åˆ gradleæ¨èä½¿ç”¨ ProjectLayout.filesï¼ˆjava.lang.Object â€¦ï¼‰æ–¹æ³•è·å–æ–‡ä»¶é›†åˆï¼Œæœ¬æ–¹æ³•è¿”å›ä¸€ä¸ªFileCollectionå®ä¾‹ï¼Œæ­¤æ–¹æ³•éå¸¸çµæ´»ï¼Œå…è®¸æ‚¨ä¼ é€’å¤šä¸ªå­—ç¬¦ä¸²ï¼ŒFileå®ä¾‹ï¼Œå­—ç¬¦ä¸²é›†åˆï¼ŒFiles é›†åˆç­‰ è¿™é‡Œå†™ä¸€ä¸ªä¾‹å­åœ¨æŒ‡å®šçš„ç›®å½•ä¸‹å¯»æ‰¾æ–‡ä»¶ æ–‡ä»¶é›†åˆçš„ä¸€äº›æ“ä½œ æ”¹å˜é›†åˆç±»å‹ é›†åˆé—´è¿›è¡Œé›†åˆæ“ä½œ groovy ä½¿ç”¨+ è¡¨ç¤ºunionæ“ä½œ ä½¿ç”¨ - è¡¨ç¤º defferenceæ“ä½œ æ³¨æ„å¦‚æœä½¿ç”¨è¿™äº›é›†åˆæ–¹æ³•æ— æ³•æ»¡è¶³è¦æ±‚ï¼Œéœ€è¦ä½¿ç”¨filteræ–¹æ³•æ¥å¯¹é›†åˆè¿›è¡Œè¿‡æ»¤æ“ä½œ æ–‡ä»¶æ ‘å’Œæ–‡ä»¶çš„åŒºåˆ«ï¼Œå…¶å®æœ¬è´¨ä¸Šæ–‡ä»¶æ ‘æ˜¯æ–‡ä»¶é›†åˆçš„ä¸€ç§å»¶ä¼¸ï¼Œä¸è¿‡æ–‡ä»¶æ ‘ä¿ç•™äº†æ ‘çŠ¶ç»“æ„ åˆ›å»ºæ–‡ä»¶æ ‘ ç®€å•æ–¹æ³• ä»zipæˆ–è€…tarä¸­åˆ›å»ºæ–‡ä»¶æ ‘ å¼•ç”³ï¼šæ–‡ä»¶é›†åˆï¼ˆåŒ…æ‹¬æ–‡ä»¶æ ‘ï¼Œä½œä¸ºå‚æ•°è¿›è¡Œä¼ é€’çš„æ—¶å€™çš„å¤„ç†æ–¹æ³•ï¼‰ åœ¨gradle ä¸­ï¼Œå¾ˆå¤šæ—¶å€™sourceâ€”â€”èµ„æºè¢«è§£é‡Šç§°ä¸€ä¸ªæ–‡ä»¶ç›®å½•æˆ–è€…ä¸€ä¸ªæ–‡ä»¶é›†åˆï¼Œå¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªæ–‡ä»¶é›†åˆå¦‚JavaCompileä»»åŠ¡æœ‰ä¸€ä¸ªsourceå±æ€§ åœ¨gradleä¸­souceå±æ€§å¯ä»¥æœ‰å¾ˆå¤šä¸åŒçš„è¡¨ç°å½¢å¼ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ ä½¿ç”¨æ–‡ä»¶æ ‘ æ–‡ä»¶å¤åˆ¶gradle æä¾›copy task å®ç°æ–‡ä»¶å¤åˆ¶çš„ç›¸å…³åŠŸèƒ½ copyéœ€è¦çš„å‚æ•°ä¿¡æ¯ from intoæ–¹æ³•è¡¨ç¤ºæ–‡ä»¶çš„å¤åˆ¶æ¥æºå’Œè¾“å‡ºæ¥æºï¼Œæ³¨æ„è¿™äº›å±æ€§çš„å‚æ•°éƒ½å¯ä»¥æ˜¯é›†åˆæˆ–è€…æ–‡ä»¶ç›®å½• include exclude é€‰æ‹©æ€§è¿‡æ»¤æ–¹æ³• é‡å‘½åæ–‡ä»¶ renameæ–¹æ³• gradle æä¾›äº†ä¸¤ç§æ–¹æ³•ï¼Œè¿›è¡Œé‡å‘½åæ–‡ä»¶ ä½¿ç”¨è¿‡æ»¤å™¨ ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ copyæ–‡ä»¶ä½¿ç”¨æ¨¡æ¿æ–¹æ³• Gradleæä¾›çš„ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯Project.copySpecï¼ˆorg.gradle.api.Actionï¼‰æ–¹æ³•ã€‚è¿™å…è®¸æ‚¨åœ¨ä»»åŠ¡ä¹‹å¤–åˆ›å»ºå¤åˆ¶è§„èŒƒï¼Œç„¶åå¯ä»¥ä½¿ç”¨CopySpec.withï¼ˆorg.gradle.api.file.CopySpec â€¦ï¼‰æ–¹æ³•å°†å…¶é™„åŠ åˆ°é€‚å½“çš„ä»»åŠ¡ã€‚ ä»»åŠ¡ä¸­æ·»åŠ å¤åˆ¶åŠŸèƒ½ syncæ–¹æ³•å°†å¤åˆ¶ç›®å½•å’Œè¢«copyç›®å½•åŒæ­¥ ç®€å•ç‚¹è¯´å°±æ˜¯å¦‚æœå¤åˆ¶çš„æ—¶å€™å°‘äº†å‡ ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆå¤åˆ¶ç»“æŸåï¼Œè¢«å¤åˆ¶çš„æ–‡é›†å¤¹å°†ä¼šåˆ é™¤è¿™äº›æ–‡ä»¶ï¼Œå…¶ä»–çš„ç”¨æ³•å’Œgradleç›¸åŒ å…¶å®è¿™ä¸ªæ–¹æ³•æ˜¯ç»§æ‰¿è‡ªcopyä¸­çš„ï¼Œå’Œcopyçš„ä½¿ç”¨æ–¹æ³•ç›¸åŒ å¸¸è§ç”¨æ³•ä¾‹å­ å•æ–‡ä»¶å¤åˆ¶ å¤šæ–‡ä»¶å¤åˆ¶ æ³¨æ„ä¸€ç‚¹ï¼Œä½¿ç”¨**&#x2F;*.javaçš„æ—¶å€™ä¼šå¤åˆ¶ç›®å½•ç»“æ„ï¼ŒåŒ…æ‹¬ä¸åŒ…å«æŒ‡å®šæ–‡ä»¶çš„ç›®å½•ç»“æ„ include æŒ‡ä»¤ï¼Œå¦‚æœå†™åœ¨å¤–é¢å°±æ˜¯é’ˆå¯¹æ•´ä¸ªcopyè¿‡ç¨‹éƒ½é€‚ç”¨ï¼Œå¦‚æœæ˜¯åœ¨fromä¸­ç¼–å†™ï¼Œå°±åªé’ˆå¯¹è¿™ä¸ªfromè¯­å¥é€‚ç”¨ ä¸€ä¸ªå¤æ‚çš„å¤åˆ¶æ„å»ºä¾‹å­ è¿™ä¸ªä¾‹å­æ˜¯å°† src&#x2F;distä¸­çš„æ‰€æœ‰html png jpgæ–‡ä»¶ æ·»åŠ åˆ° $buildDir&#x2F;explodeWaræ–‡ä»¶å¤¹ä¸­ï¼Œè€Œoutputå’Œ classpathä¸­çš„æ‰€æœ‰æ–‡ä»¶å°†ä¼šè€ƒåˆ°æŒ‡å®šçš„æ–‡ä»¶å¤¹ä¸­ zip å‹ç¼©æ–‡ä»¶ æ³¨æ„ä¸€ç‚¹ï¼Œä½¿ç”¨**&#x2F;*.javaçš„æ—¶å€™ä¼šå¤åˆ¶ç›®å½•ç»“æ„ï¼ŒåŒ…æ‹¬ä¸åŒ…å«æŒ‡å®šæ–‡ä»¶çš„ç›®å½•ç»“æ„include æŒ‡ä»¤ï¼Œä¸åŒäºcopyï¼Œåªèƒ½åœ¨fromä¸­ç¼–å†™ï¼Œé’ˆå¯¹è¿™ä¸ªfromè¯­å¥é€‚ç”¨ è§£å‹ç¼© æ™®é€šå‰¯æœ¬ä¸€æ ·ï¼Œæ‚¨å¯ä»¥æ§åˆ¶å“ªäº›æ–‡ä»¶é€šè¿‡è¿‡æ»¤å™¨è§£å‹ç¼©ï¼Œç”šè‡³åœ¨è§£å‹ç¼©æ—¶é‡å‘½åæ–‡ä»¶ã€‚æ³¨æ„zipTree æ–¹æ³•åŒæ ·é€‚ç”¨ Jar å’Œ war ear èƒ½åŠ›æå‡ï¼Œå°†ç¯å¢ƒä¸­æ‰€æœ‰çš„jar class æ–‡ä»¶éƒ½ç»Ÿä¸€åˆ°ç¼–è¯‘ä¹‹åçš„jaråŒ…ä¸­æ–¹æ³•å¾ˆç®€å•ï¼ˆjarä»»åŠ¡ä½¿ç”¨zipTreeæ‰“åŒ…ï¼‰ psæš‚æ—¶æ²¡æœ‰æˆåŠŸ æ–‡ä»¶ç§»åŠ¨ Gradleæ²¡æœ‰ç”¨äºç§»åŠ¨æ–‡ä»¶å’Œç›®å½•çš„APIï¼Œä½†æ‚¨å¯ä»¥ä½¿ç”¨Apache Anté›†æˆè½»æ¾åœ°æ‰§è¡Œæ­¤æ“ä½œï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š é‡æ–°å‘½åæ–¹æ³• æ–‡ä»¶åˆ é™¤","date":"2024-12-31","categories":["java"],"tags":["gradle"]},{"title":"groovy-åŒºåˆ«ç‰¹æ€§æ¢³ç†(1)-åŸºæœ¬ä¿¡æ¯","url":"/2024/12/31/groovy-åŒºåˆ«ç‰¹æ€§æ¢³ç†-1--åŸºæœ¬ä¿¡æ¯/","content":"groovyç›¸æ¯”è¾ƒjavaçš„ç‰¹æ®Šçš„å­—ç¬¦ä¸²æ“ä½œ $ å¼•ç”¨å½“å‰ä½œç”¨åŸŸä¸­çš„å˜é‡åç§°,è¿™ç§æ–¹æ³•å«æ’å€¼ groovyä¸­å¯ä»¥ä½¿ç”¨${xxx sxx}æˆ–è€… $xxx æ¥ç›´æ¥åœ¨å­—ç¬¦ä¸²ä¸­æ‹¼æ¥ä¿¡æ¯ groovy æ’å€¼æ–¹æ³•è¿˜æœ‰ä¸¤ç§ç‰¹æ®Šç”¨æ³• è¡¨è¾¾å¼ä½¿ç”¨æ–¹æ³• æ³¨æ„: å¦‚æœ<<åé¢æ˜¯å­—ç¬¦ä¸²çš„æ—¶å€™,å°†è¡¨ç¤ºæ’å…¥æ–¹æ³•,å¦‚æœæ˜¯å­—ç¬¦ä¸²å°±æ˜¯ä½ç§»é€»è¾‘ â€˜xâ€™ ,â€xxâ€, â€˜â€™â€™xxxxâ€™â€™â€™,&#x2F;xxx&#x2F;,å››ç§å­—ç¬¦ä¸²çš„åŒºåˆ« åœ¨å¾ˆå¤šç¼–ç¨‹è¯­è¨€ä¸­éƒ½æœ‰è¿™ä¸ªç‰¹æ€§ â€˜â€™ : ç®€å•çš„ä¸€ä¸ªå­—ç¬¦ä¸²,åœ¨groovyä¸­è¿™ä¸ªå­—ç¬¦ä¸²ä¸æ”¯æŒæ’å€¼($)æ“ä½œ â€œâ€ : â€˜â€™ ç‰¹æ€§åŠ ä¸Šæ”¯æŒæ’å€¼-â€˜â€™â€™ â€˜â€™â€™ : ä¿ç•™æ ¼å¼,æœ‰äº›åœ°æ–¹éœ€è¦ä½¿ç”¨\\ æ¥æ¶ˆé™¤ â€˜\\nâ€™ æ¢è¡Œé—®é¢˜-&#x2F;xx&#x2F; : ç‰¹æ®Šå­—ç¬¦ä¸éœ€è¦è½¬ä¹‰(åªæœ‰&#x2F;éœ€è¦ä½¿ç”¨\\è¿›è¡Œè½¬ä¹‰),æ­£åˆ™è¡¨è¾¾å¼ä¸“ç”¨ ä½¿ç”¨~ æˆ–è€…&#x3D;~å¿«é€Ÿåˆ›å»ºæ­£åˆ™è¡¨è¾¾åŒ¹é…å¼ é€šè¿‡~ è¿™ä¸ªæ–¹æ³•å¯ä»¥å¿«é€Ÿçš„åˆ›å»ºjavaä¸­çš„java.utilregex.patternå¯¹è±¡,æ³¨æ„è¿™ç§æ–¹æ³•&#x3D;å’Œ~ ä¹‹é—´ä¸€å®šè¦æœ‰ç©ºæ ¼,å¦åˆ™ä¼šè§£é‡Šæˆ~&#x3D;æ“ä½œè¿ç®—ç¬¦ å¼•ç”³: åŒ¹é…è¿ç®—ç¬¦ï¼ˆ&#x3D;&#x3D;~ï¼‰æ˜¯findè¿ç®—ç¬¦çš„ä¸€ä¸ªå°å˜ä½“ï¼Œå®ƒä¸è¿”å›Matcherä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå¹¶ä¸”éœ€è¦è¾“å…¥å­—ç¬¦ä¸²çš„ä¸¥æ ¼åŒ¹é… groovyä¸­ç›¸æ¯”è¾ƒjavaç‰¹æ®Šçš„å˜é‡åç§°æ“ä½œ groovyä¸­å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å˜é‡æ¥ä½œä¸ºå˜é‡åç§° groovyç›¸æ¯”è¾ƒjavaç‰¹æ®Šçš„å¯¹è±¡æ“ä½œ ç©ºæŒ‡é’ˆçš„å®‰å…¨ä¿è¯ groovyä¸­å¦‚æœå¯¹è±¡ä¸ºç©º,å¯ä»¥ä½¿ç”¨?.çš„æ–¹æ³•æ¥æ¶ˆé™¤å¼‚å¸¸ å¯¹è±¡çš„getterå’Œsetterçš„ä¸åŒä¹‹å¤„ åœ¨groovyä¸­å¦‚æœè®¾ç½®äº†getterä½¿ç”¨å¯¹è±¡.xxçš„æ—¶å€™å°†ä¼šè‡ªåŠ¨çš„è°ƒç”¨getteræ–¹æ³•,å¦‚æœæ²¡æœ‰è®¾ç½®,å°†ä¼šç›´æ¥ä½¿ç”¨è¿™ä¸ªå˜é‡groovyè¿˜æ˜¯æ”¯æŒä½¿ç”¨å¯¹è±¡.@xxæ–¹æ³•æ¥ç›´æ¥çš„è°ƒç”¨å¯¹åº”çš„å˜é‡ æ³¨æ„å…¶å®æœ¬è´¨ä¸Šæ˜¯groovyé»˜è®¤å°±ä¸ºæ¯ä¸€ä¸ªå‚æ•°å£°æ˜äº†getterå’Œsetteræ–¹æ³•ç½¢äº†,æˆ‘ä»¬å¯ä»¥ä¸ä½¿ç”¨getxxè€Œæ˜¯ç›´æ¥ä½¿ç”¨å¯¹è±¡.xxxæ¥è°ƒç”¨getteræˆ–è€…setteræ–¹æ³• æ–¹æ³•æŒ‡é’ˆ è¿™ä¸ªç®—æ˜¯ä¸€ä¸ªé«˜çº§ç‰¹æ€§äº†,é€šè¿‡è¿™ç§æ–¹æ³•,å¯ä»¥å¿«é€Ÿçš„æ‹‰å–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•å¼•ç”¨,ç±»ä¼¼js,functionä¹Ÿæ˜¯å˜é‡ æ³¨æ„:groovyæ˜¯å¼•ç”¨äº†å¯¹åº”å¯¹è±¡çš„æ–¹æ³• å¯¹è±¡å±æ€§èšåˆæ“ä½œ *. åœ¨groovyä¸­å¯ä»¥ä½¿ç”¨*.æ“ä½œå°†ä¸€ä¸ªå¯¹è±¡æ•°ç»„ä¸­çš„å¯¹è±¡çš„æŸä¸ªå±æ€§èšåˆèµ·æ¥,è¡¨è¾¾å¼cars*.makeç›¸å½“äºcars.collect{ it.make },åŒºåˆ«æ˜¯groovyçš„*,è¡¨è¾¾å¼å¯ä»¥ä½¿ç”¨null å¯¹è±¡ä¸­çš„callç”¨æ³• åœ¨groovyä¸­,å¯¹è±¡ä¹Ÿå¯ä»¥æŠ½è±¡æˆä¸€ä¸ªå‡½æ•°,ä½¿ç”¨å¯¹è±¡å()æ–¹æ³•çš„æ—¶å€™,å°†ä¼šéšå¼çš„è°ƒç”¨å¯¹è±¡ä¸­çš„callæ–¹æ³• groovy ç›¸å¯¹æ¯”java ç‰¹æ®Šçš„å‡½æ•°ç”¨æ³• å‡½æ•°å‚æ•°æ•°ç»„åŒ–æ˜ å°„ å‡½æ•°å‚æ•°mapåŒ–æ˜ å°„ åœ¨groovyä¸­ä½¿ç”¨mapå¯ä»¥åŠ¨æ€çš„æŒ‡å®šç›¸å…³çš„å‚æ•° æ³¨æ„groovyæ”¯æŒmapå’Œå…¶ä»–ç±»å‹å‚æ•°æ··ç”¨çš„é€»è¾‘,åªæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„,å®šä¹‰çš„å‡½æ•°,ä»–çš„ä¼ å‚çš„ç¬¬ä¸€ä¸ªä¸€å®šæ˜¯mapç±»å‹,å¦åˆ™å¿…é¡»æ˜¾ç¤ºçš„æŒ‡å®šå‚æ•° def è¿”å›å€¼å‚æ•° groovyæ˜¯å¼±ç±»å‹ç¼–ç¨‹è¯­è¨€,æ‰€ä»¥è¿”å›å€¼æ”¯æŒdefå¼±ç±»å‹çš„è¿”å›å€¼ groovy ç›¸å¯¹æ¯”javaçš„ç‰¹æ®Šæ•°ç»„ç”¨æ³• groovyçš„å¿«é€Ÿæ·»åŠ æ•°æ® groovyæä¾›äº†å¼•ç”¨çš„æ–¹æ³•,èµ–åœ¨ç¬¬äºŒä¸ªæ•°ç»„ä¸­åº”ç”¨å¦ä¸€ä¸ªæ•°ç»„ä¸­çš„å†…å®¹ å¿«é€Ÿåˆ›å»ºæ•°ç»„ä¿¡æ¯ é€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥å¿«é€Ÿçš„åˆ›å»ºä¸€ä¸ªæŒ‡å®šè¿­ä»£è§„å¾‹çš„å­—ç¬¦ä¸² æ•°ç»„æ‰¹é‡èµ‹å€¼ groovyå’Œjava åœ¨æ¯”è¾ƒæ–¹æ³•ä¸­çš„åŒºåˆ« &#x3D;&#x3D; å’Œ equalçš„åŒºåˆ« åœ¨groovyä¸­&#x3D;&#x3D; å°†ä¼šè°ƒç”¨javaä¸­çš„equal æ–¹æ³•,å¦‚æœè¦æ¯”è¾ƒå€¼æ˜¯å¦ç›¸ç­‰,åº”è¯¥ä½¿ç”¨isæ–¹æ³• compareToå¿«é€Ÿåˆ›å»ºæ–¹æ³• åœ¨groovyä¸­å¯ä»¥ä½¿ç”¨<&#x3D;>æ¥æ›¿ä»£compareTo groovy ä¸javaä¸ç”¨çš„è¿ç®—ç¬¦ç”¨æ³• è¿ç®—ç¬¦é‡è½½ åœ¨groovyä¸­åªè¦äº‹å…ˆæŒ‡å®šå‡½æ•°çš„å¯¹è±¡å°±èƒ½å°†å‡½æ•°å¯¹åº”çš„è¿ç®—æ³•è¿ç®—æ–¹æ³•é›†æˆåˆ°è¿™ä¸ªå¯¹è±¡ä¸­ è¿ç®—ç¬¦å·å¯¹åº”çš„æ–¹æ³•è§ä¸‹è¡¨ Operator Method Operator Method + a.plus(b) a[b] a.getAt(b) - a.minus(b) a[b] &#x3D; c a.putAt(b, c) * a.multiply(b) a in b b.isCase(a) &#x2F; a.div(b) << a.leftShift(b) % a.mod(b) >> a.rightShift(b) ** a.power(b) >>> a.rightShiftUnsigned(b) | a.or(b) ++ a.next() & a.and(b) â€“ a.previous() ^ a.xor(b) +a a.positive() as a.asType(b) -a a.negative() a() a.call() ~a a.bitwiseNegate()","date":"2024-12-31","categories":["java"],"tags":["groovy"]},{"title":"groovy-åŒºåˆ«ç‰¹æ€§æ¢³ç†(2)-åŒ…ç®¡ç†å¼•ç”¨","url":"/2024/12/31/groovy-åŒºåˆ«ç‰¹æ€§æ¢³ç†-2--åŒ…ç®¡ç†å¼•ç”¨/","content":"groovy å’Œjava åœ¨åŒ…ç®¡ç†ç‰¹æ€§ä¸Šçš„ä¸åŒå…¶å®æœ¬è´¨ä¸Šgroovyå’Œjava åœ¨åŒ…ç®¡ç†ä¸Šå…¶å®æ˜¯ç±»ä¼¼çš„,ä½†æ˜¯groovyæä¾›äº†æ›´åŠ å¼ºå¤§çš„é™æ€åŠŸèƒ½ è®¸æ‚¨å®šä¹‰ä¸å¯¼å…¥æ–¹æ³•åŒåçš„æ–¹æ³•ï¼Œåªè¦æ‚¨æœ‰ä¸åŒçš„ç±»å‹ å¯¼å…¥åˆ«å é™æ€å‡½æ•°åç§°å¯¼å…¥åˆ«å å¯¹è±¡åˆ«å groovy å’Œ java è¿è¡Œä¸Šçš„ä¸åŒgroovyç»§æ‰¿äº†javaç±»çš„å®šä¹‰,å¦‚æœä½¿ç”¨äº†classæ¥è¡¨ç¤ºgroovyå¯¹è±¡,æœ¬è´¨ä¸Šå’Œjavaå¹¶æ²¡æœ‰åŒºåˆ« ä½†æ˜¯å¦‚æœä½¿ç”¨groovyè„šæœ¬æ¨¡å¼å˜æˆå¹¶è¿è¡Œ,groovyå†…éƒ¨ä¼šå°†è„šæœ¬è¿›è¡Œç¼–è¯‘ æ¯”å¦‚è¿™æ ·ä¸€ä¸ªgroovyè„šæœ¬ groovyå°†ä¼šå°†è¿™ä¸ªè„šæœ¬ç¼–è¯‘æˆ","date":"2024-12-31","categories":["java"],"tags":["groovy"]},{"title":"groovy-åŒºåˆ«ç‰¹æ€§æ¢³ç†(3)-é¢å‘å¯¹è±¡çš„ç‰¹æ®Šç‚¹","url":"/2024/12/31/groovy-åŒºåˆ«ç‰¹æ€§æ¢³ç†-3--é¢å‘å¯¹è±¡çš„ç‰¹æ®Šç‚¹/","content":"groovy å˜é‡å¯è§æ€§å’Œjavabeanç›¸æ¯”è¾ƒjavaçš„ä¸åŒç‚¹groovyå¦‚æœæ²¡æœ‰å®šä¹‰å¯è§æ€§(public private),é»˜è®¤ä½¿ç”¨public groovy ä¸æä¾›getterå’Œsetter åœ¨groovyä¸­å¦‚æœè®¾ç½®äº†getterä½¿ç”¨å¯¹è±¡.xxçš„æ—¶å€™å°†ä¼šè‡ªåŠ¨çš„è°ƒç”¨getteræ–¹æ³•,å¦‚æœæ²¡æœ‰è®¾ç½®,å°†ä¼šç›´æ¥ä½¿ç”¨è¿™ä¸ªå˜é‡groovyè¿˜æ˜¯æ”¯æŒä½¿ç”¨å¯¹è±¡.@xxæ–¹æ³•æ¥ç›´æ¥çš„è°ƒç”¨å¯¹åº”çš„å˜é‡ groovyé›†æˆç™»groovyçš„ç»§æ‰¿å’Œjavaçš„éå¸¸ç±»ä¼¼,éƒ½æ‹¥æœ‰private protected public å…³é”®å­—,éƒ½æœ‰interface abstract å…³é”®å­—,å¹¶ä¸”è¯­ä¹‰ç›¸åŒ Groovyæ¥å£ä¸æ”¯æŒJava 8æ¥å£ç­‰é»˜è®¤å®ç°ã€‚ä½†æ˜¯groovyæä¾›äº†ä¸€ä¸ªç‰¹æ®Šçš„ä¸œè¥¿å«åšTraits,ç‰¹å¾ groovyå¯¹è±¡new groovyæ—¢ç„¶æ˜¯è„šæœ¬è¯­è¨€æ‰€ä»¥åœ¨æ„å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡çš„æ—¶å€™ä¹Ÿç›¸å½“çµæ´»,groovyæä¾›äº†å¦‚ä¸‹çš„å‡ ç§æ–¹æ³•æ¥åˆ›å»ºå¯¹è±¡ ä¼ ç»Ÿçš„javaåˆ›å»ºæ–¹æ³• ä½¿ç”¨asæŒ‡å®šåˆ›å»ºçš„å¯¹è±¡ç±»å‹ ç›´æ¥å®šä¹‰åˆ›å»ºçš„ç±»å‹,è¿›è¡Œå¼ºåˆ¶è½¬æ¢ å¦‚æœæ²¡æœ‰æä¾›æ„é€ å‚æ•°,groovyè¿˜æä¾›äº†å‚æ•°æ˜ å°„æ¥åŠ¨æ€çš„åˆå§‹åŒ–å¯¹åº”çš„å­—æ®µä¿¡æ¯ æ³¨æ„: è¿™ç§æ–¹æ¡ˆä¼ é€’çš„å‚æ•°æ˜¯ä¸€ä¸ªmapç±»å‹,åç§°å’Œå¯¹è±¡ä¸­çš„å˜é‡ä¸€ä¸€å¯¹åº”","date":"2024-12-31","categories":["java"],"tags":["groovy"]},{"title":"groovy-å­¦ä¹ ä½¿ç”¨(ä¸€)","url":"/2024/12/31/groovy-å­¦ä¹ ä½¿ç”¨-ä¸€-/","content":"","date":"2024-12-31","categories":["java"],"tags":["groovy"]},{"title":"jacksonä½¿ç”¨ä»£ç è¿›è¡Œé…ç½®","url":"/2024/12/31/jacksonä½¿ç”¨ä»£ç è¿›è¡Œé…ç½®/","content":"jackson ä½¿ç”¨ä»£ç è¿›è¡Œé…ç½®çš„ä¸€ä¸ªä¾‹å­ Jacksoné…ç½®å±æ€§å¦‚æœä¸Šé¢çš„å·¥å…·ç±»å®ä¾‹ï¼Œåœ¨Jacksonä¸­å­˜åœ¨ä¸€äº›å±æ€§é…ç½®ï¼Œè¿™äº›é…ç½®å†³å®šäº†æœ€ååœ¨è§£ææˆ–è€…ç¼–ç åæ•°æ®è§†å›¾ã€‚å› æ­¤ï¼Œåœ¨åˆ†æJacksonä¹‹å‰ï¼Œå…ˆäº†è§£ä¸‹ï¼ŒJacksonå…·æœ‰çš„ä¸€äº›é…ç½®å«ä¹‰ã€‚ JsonParserè§£æç›¸å…³é…ç½®å±æ€§ Note: åœ¨æšä¸¾æœ€åæœ‰ä¸€ä¸ªå…¬å…±é™æ€æ–¹æ³•collectDefaults()ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªæ•´å½¢ï¼Œæ•´å½¢åŒ…å«çš„æ˜¯æ‰€æœ‰æšä¸¾é¡¹å¯¹åº”ä½bitä¸ºåˆå§‹é»˜è®¤å€¼ï¼ˆtrueï¼š1ï¼›falseï¼š0ï¼‰ï¼Œå¦‚æœé»˜è®¤å±æ€§ä¸ºtrueï¼Œåˆ™é€šè¿‡å¯¹1 << ordinal()çš„å€¼å’Œflagsè¿›è¡Œäº¦æˆ–æ¥ç½®ä½ã€‚ DeserializationConfigååºåˆ—åŒ–ç›¸å…³é…ç½®å±æ€§å°†Java å¯¹è±¡åºåˆ—åŒ–ä¸ºJsonå­—ç¬¦ä¸²ã€‚Jacksonåœ¨åºåˆ—åŒ–Javaå¯¹è±¡çš„æ—¶å€™ï¼Œå¯¹äºæœ‰äº›ä¸å­˜åœ¨çš„å±æ€§å¤„ç†ï¼Œä»¥åŠä¸€äº›ç±»å‹è½¬æ¢ç­‰ï¼Œéƒ½å¯ä»¥é€šè¿‡é…ç½®æ¥è®¾ç½®ã€‚","date":"2024-12-31","categories":["java"],"tags":["jackson"]},{"title":"jacksonä½¿ç”¨æŒ‡å—","url":"/2024/12/31/jacksonä½¿ç”¨æŒ‡å—/","content":"jasksonæ³¨è§£è¯¦è§£åºåˆ—åŒ–ç›¸å…³æ³¨è§£@JsonAnyGetterè¿™ä¸ªæ³¨è§£å¯ä»¥å°†javabeanä¸­çš„mapperåœ¨åºåˆ—åŒ–çš„æ—¶å€™å±•å¼€æˆå˜é‡ æ¯”å¦‚è¿™ä¸ªjson å°±å¯ä»¥ç”±è¿™ä¸ªjavabeanåºåˆ—åŒ–è€Œæ¥ @JsonGetteræŒ‡å®šå˜é‡åç§°å’Œgetteræ–¹æ³•çš„ç»‘å®šå…³ç³»,æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­å°†nameå±æ€§å’ŒgetThemNameæ–¹æ³•ç»‘å®šåœ¨ä¸€èµ· @JsonPropertyOrderæŒ‡å®šåºåˆ—åŒ–çš„é¡ºåº æ³¨æ„ï¼šæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨@JsonPropertyOrderï¼ˆalphabetic &#x3D; trueï¼‰æŒ‰å­—æ¯é¡ºåºå¯¹å±æ€§è¿›è¡Œæ’åº @JsonRawValueå¼ºåˆ¶jackåºåˆ—åŒ– è¢«æ ¼å¼åŒ–çš„jsonå­—ç¬¦ä¸² æ¯”å¦‚æœ‰ä¸€ä¸ªjavabean å…¶ä¸­stringå­˜äº†ä¸€ä¸ªjsonï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ³¨è§£å°†è¿™ä¸ªjsonæ ¼å¼åŒ–å‡ºæ¥ @JsonValue@JsonValueè¡¨ç¤ºåº“å°†ç”¨äºåºåˆ—åŒ–æ•´ä¸ªå®ä¾‹çš„å•ä¸ªæ–¹æ³• ç®€å•çš„è¯´å°±æ˜¯æŒ‡å®šäº†ä¸€ä¸ªæ–¹æ³•ç”¨æ¥åœ¨åºåˆ—åŒ–çš„æ—¶å€™è°ƒç”¨ @JsonRootNameå°†åºåˆ—åŒ–çš„javabeanå¤–å±‚åŒ…è£¹ä¸€ä¸ªåŒ…åç§° @JsonSerializeè‡ªå®šä¹‰åºåˆ—åŒ–è¿‡ç¨‹ Jacksonååºåˆ—åŒ–æ³¨é‡Š@JsonCreatorå’Œ@JsonPropertyè¿ç”¨å¯ä»¥åœ¨åˆ›å»ºbeançš„æ—¶å€™å¼ºåˆ¶ç»‘å®šjsonä¸­çš„å±æ€§ æ¯”å¦‚è¿™ä¸ªjsonä¸­çš„theNameç»‘å®šåˆ°javabeanä¸­çš„name @JacksonInjectå±æ€§æ³¨å…¥ï¼Œè¿™ä¸ªåœºæ™¯è²Œä¼¼æœ‰ç‚¹æ™• @JsonAnySetterè¿™ä¸ª@JsonAnyGetterç›¸å @JsonAnySetterä½¿æˆ‘ä»¬å¯ä»¥çµæ´»åœ°ä½¿ç”¨Mapä½œä¸ºæ ‡å‡†å±æ€§ã€‚ååºåˆ—åŒ–æ—¶ï¼ŒJSONä¸­å°šæœªç»‘å®šçš„å±æ€§ï¼Œå°†è¢«ç®€å•åœ°æ·»åŠ åˆ°mapä¸­ @JsonSetter@JsonSetteræ˜¯ä¸€ç§æ›¿ä»£@JsonProperty -è¿™æ ‡å¿—ç€æ–¹æ³•ä½œä¸ºsetteræ–¹æ³•ã€‚ å½“æˆ‘ä»¬éœ€è¦è¯»å–ä¸€äº›JSONæ•°æ®ä½†ç›®æ ‡å®ä½“ç±»ä¸è¯¥æ•°æ®ä¸å®Œå…¨åŒ¹é…æ—¶ï¼Œè¿™éå¸¸æœ‰ç”¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è°ƒæ•´è¿‡ç¨‹ä»¥ä½¿å…¶é€‚åˆã€‚ å’Œ@JsonGetteré€»è¾‘ç›¸åŒ @JsonDeserializeè‡ªå®šä¹‰ååºåˆ—åŒ–é€»è¾‘ @JsonAliasååºåˆ—åŒ–è¿‡ç¨‹ä¸ºå±æ€§çš„ä¸€ä¸ªæˆ–å¤šä¸ªçš„æ›¿ä»£åç§° Jacksonå±æ€§å±•ç¤ºå‹æ³¨è§£@JsonIgnoreProperties@JsonIgnorePropertiesæ˜¯ä¸€ä¸ªç±»çº§åˆ«çš„æ³¨é‡Šï¼Œç”¨äºæ ‡è®°Jacksonå°†å¿½ç•¥çš„ä¸€ä¸ªå±æ€§æˆ–ä¸€ç³»åˆ—å±æ€§ã€‚ @JsonIgnoreè¯¥@JsonIgnoreæ³¨é‡Šç”¨æ¥æ ‡è®°åœ¨å¤–åœ°è¢«å¿½ç•¥çš„å±æ€§ã€‚ @JsonIgnoreType@JsonIgnoreTypeå°†å¸¦æ³¨é‡Šç±»å‹çš„æ‰€æœ‰å±æ€§æ ‡è®°ä¸ºå¿½ç•¥ã€‚ @JsonInclude @JsonAutoDetect@JsonAutoDetectå¯ä»¥è¦†ç›–é»˜è®¤è¯­ä¹‰ï¼Œå³å“ªäº›å±æ€§å¯è§ï¼Œå“ªäº›å±æ€§ä¸å¯è§ã€‚ è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œè¯¥æ‰¹æ³¨å¦‚ä½•éå¸¸æœ‰ç”¨â€“è®©æˆ‘ä»¬åºåˆ—åŒ–ç§æœ‰å±æ€§ï¼š Jacksonå¤šæ€ç±»å‹å¤„ç†æ³¨é‡Š æœ‰ç‚¹éº»çƒ¦æ è¿‡ å…¶ä»–é€šç”¨æ³¨è§£@JsonPropertyåœ¨å¤„ç†éæ ‡å‡†çš„getterå’Œsetteræ—¶ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨@JsonPropertyå¯¹å±æ€§åç§°è¿›è¡Œåºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–ï¼š @JsonFormatè¯¥@JsonFormatåºåˆ—åŒ–çš„æ—¥æœŸ&#x2F;æ—¶é—´å€¼æ—¶ï¼Œæ³¨è§£æŒ‡å®šçš„æ ¼å¼ã€‚ @JsonUnwrapped@JsonUnwrappedå®šä¹‰åœ¨åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–æ—¶åº”è¯¥è§£åŒ…&#x2F;å±•å¹³çš„å€¼ã€‚ @JsonView@JsonViewæŒ‡ç¤ºå°†åœ¨å…¶ä¸­åŒ…å«å±æ€§ä»¥è¿›è¡Œåºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–çš„Viewã€‚ @ JsonManagedReferenceï¼Œ@ JsonBackReferenceè¯¥@JsonManagedReferenceå’Œ@JsonBackReferenceæ³¨é‡Šå¯ä»¥å¤„ç†çˆ¶&#x2F;å­å…³ç³»å’Œè§£å†³å¾ªç¯ã€‚ @JsonIdentityInfo@JsonIdentityInfoæŒ‡ç¤ºåœ¨å¯¹å€¼è¿›è¡Œåºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–æ—¶åº”ä½¿ç”¨å¯¹è±¡æ ‡è¯†ï¼Œä¾‹å¦‚ï¼Œä»¥å¤„ç†æ— é™é€’å½’ç±»å‹çš„é—®é¢˜ã€‚ @JsonFilterè¯¥@JsonFilteræ³¨é‡ŠæŒ‡å®šä¸€ä¸ªè¿‡æ»¤å™¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ä½¿ç”¨ã€‚ è‡ªå®šä¹‰æ°å…‹é€Šæ³¨é‡Šåˆ›å»ºè‡ªå®šä¹‰Jacksonæ³¨é‡Šã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨@JacksonAnnotationsInsideæ³¨é‡Š æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒå¦‚ä½•å°†ç°æœ‰çš„æ³¨é‡Šåˆå¹¶ä¸ºä¸€ä¸ªæ›´ç®€å•çš„è‡ªå®šä¹‰æ³¨é‡Šï¼Œå¯ä»¥ç”¨ä½œé€Ÿè®°ï¼š","date":"2024-12-31","categories":["java"],"tags":["jackson"]},{"title":"java-EE-servlet3.1è§„èŒƒ","url":"/2024/12/31/java-EE-servlet3-1è§„èŒƒ/","content":"è¯´é“springçš„webæ”¯æŒé¦–å…ˆå°±å¯ä»¥æƒ³åˆ°äº†spring MVC çš„æŠ€æœ¯(å…¶ä»–çš„æŠ€æœ¯è¿˜æœ‰springçš„webflux ä»¥åè®¨è®º),ä»è¿™ç‰‡åšå®¢å¼€å§‹è¦è¿›è¡Œç›¸å…³çŸ¥è¯†ç‚¹çš„æ•´ç†. spring MVC æ•´ä½“çš„æ¶æ„è®¾è®¡ spring è‡ªå·±çš„webapplicationæ”¯æŒåµŒå¥—ä½œç”¨åŸŸ,é€šè¿‡è¿™ä¸ªæ–¹æ³•å¯ä»¥å®ç°spring applicationcongtextçš„ç»§æ‰¿ç‰¹æ€§(ç»§æ‰¿ç‰¹æ€§,å­ä½œç”¨åŸŸå¯ä»¥è®¿é—®å¤«ä½œç”¨åŸŸçš„ä¸­çš„å±æ€§,ä½†æ˜¯çˆ¶ä½œç”¨åŸŸä¸­çš„å±æ€§æ— æ³•è®¿é—®å­ä½œç”¨åŸŸä¸­çš„å±æ€§,å…·ä½“çš„ä½¿ç”¨çœ‹HierarchicalBeanFactory) webå®¹å™¨çš„åˆå§‹åŒ–è®¾ç½®springMVC æ”¯æŒä½¿ç”¨xmlè¿›è¡Œé…ç½® ä»spring5.0 å¼€å§‹ springå®˜æ–¹æ–‡æ¡£æå€¡ä½¿ç”¨æ¥å£é…ç½®,å®¹å™¨åœ¨åˆå§‹åŒ–çš„æ—¶å€™å°†ä¼šè‡ªåŠ¨çš„åŠ è½½è¿™ä¸ªæ¥å£çš„å®ç°ç±»ä»è€Œè¿›è¡Œé…ç½®spring mvc çš„è‡ªåŠ¨åŒ–é…ç½®æ˜¯é€šè¿‡ WebApplicationInitializer æ¥å£å®ç°çš„ ä½†æ˜¯ç³»ç»Ÿæä¾›äº†æ›´åŠ é«˜çº§çš„æ¥å£ AbstractAnnotationConfigDispatcherServletInitializer å¦‚æœä½¿ç”¨åŸºäºxml çš„ springé…ç½®åˆ™éœ€è¦ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è¿›è¡Œç›¸å…³çš„è°ƒç”¨ å¦‚æœè¦æ·»åŠ filter é…ç½® é‡æ„å¦‚ä¸‹çš„æ–¹æ³• è¿™ä¸ªæ–¹æ³•å°†ä¼šä¸ºæ¯ä¸€ä¸ªfilter æ·»åŠ ä¸€ä¸ªé»˜è®¤çš„è¿‡æ»¤å™¨,å¹¶ä¸”è‡ªåŠ¨çš„æ·»åŠ åˆ°å¯¹åº”çš„displayä¸­ è¿™ä¸ªæ–¹æ³•è¿˜æœ‰ä¸€ä¸ªisisAsyncSupported() é»˜è®¤æƒ…å†µä¸‹è¿”å›true è¡¨ç¤ºspring mvc æ¡†æ¶ä¸­çš„filter å°†ä¼šå¼‚æ­¥çš„å¤„ç†è¯·æ±‚ å½“ä½¿ç”¨idea è¿›è¡Œæ“ä½œçš„æ—¶å€™æ³¨æ„è¦ä¿è¯springâ€”webåŒ…è¦åœ¨class pathç›®å½•ä¸‹ï¼Œä¸ç„¶tomcatç­‰web å®¹å™¨å°†ä¸ä¼šä½¿ç”¨spiæŠ€æœ¯å°†ç›¸å…³çš„å„ç§éœ€è¦çš„ä¸œè¥¿å¤¹åœ¨åˆ°classä¸­ å¼•ç”³ï¼š tomcat æ­¤å¤„å®ç°spiæŠ€æœ¯çš„è§£æ springçš„webåŒ…çš„META-INFçš„æ–‡ä»¶å¤¹ä¸­æœ‰ä¸€ä¸ªåä¸ºï¼Œjavax.servlet.ServletContainerInitializerçš„æ–‡ä»¶ï¼Œå…¶ä¸­çš„å†…å®¹org.springframework.web.SpringServletContainerInitializerï¼Œè¡¨ç¤ºå®šä¹‰çš„ServletContainerInitializerå’Œspringçš„å®ç°æ¥å£SpringServletContainerInitializerï¼Œå…¶ä¸­@HandlesTypesæ³¨è§£è¡¨ç¤ºCustomServletContainerInitializer å¯ä»¥å¤„ç†çš„ç±»ï¼Œåœ¨onStartup æ–¹æ³•ä¸­ï¼Œå¯ä»¥é€šè¿‡Set<Class<?>> c è·å–å¾—åˆ°ã€‚ è§ä¸‹é¢ä»£ç ï¼š æœ€æ ¸å¿ƒç±» DispatcherServletå¦‚æœè¦è¯´è¿™ä¸ªç±»å°±éœ€è¦çœ‹ä¸€ä¸‹springmvcçš„æµç¨‹å›¾ ; åœ¨è¿™é‡Œä¹‹å‰ DispathcerServlet å°†ä¼šwebapplicationcontextçš„å­—ç¬¦ä¸²å¼•ç”¨æ”¾å…¥javaä¸­ ä¸€ä¸ªä¸€ä¸ªçœ‹ HandlerMapping è¿™ä¸ªç±»è§£å†³äº† urlåœ°å€æ˜ å°„åˆ°å¯¹åº”çš„å¤„ç†ç±»ä¸­ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªå®ç°RequestMappingHandlerMapping-ä¸º@RequestMapping æ³¨è§£æä¾›æ”¯æŒ ï¼ŒSimpleUrlHandlerMappingï¼Œå®ç°ç®€å•çš„urlåœ°å€æ˜ å°„ HandlerExceptionResolver è¿™ä¸ªæ˜¯è¯•å›¾è¿”å›çš„å¼‚å¸¸å¤„ç†åŒ…æ‹¬ç›¸å…³çš„é”™è¯¯å¤„ç†æ–¹æ³• HandlerIntercepter å¤„ç†ç›¸å…³çš„æ¥å£è¿›è¡Œæ‹¦æˆª HandlerAdapter ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ï¼Œå°†è¯•å›¾çš„æ˜ å°„ç”±æŒ‡å®šçš„æ¥å£å¤„ç† å„ç§resolver æä¾›è§†å›¾è§£æå±•ç¤ºçš„åŠŸèƒ½ LocaleResolver, LocaleContextResolverï¼ŒThemeResolverï¼ŒMultipartResolver FlashMapManager å¤„ç†flashçš„æ—¶å€™ä½¿ç”¨çš„ ä¼°è®¡ç”¨ä¸åˆ°äº† Interception æ‹¦æˆªå™¨åœ¨spring MVC ä¸­å£°æ˜springmvc çš„æ–¹æ³•æœ‰å¦‚ä¸‹å‡ ç§ï¼š å®ç°HandlerInterceptoræ¥å£æˆ–è€…å®ç°HandlerInterceptorAdapter æŠ½è±¡ç±» å®ç°WebRequestInterceptoræ¥å£ï¼Œæˆ–è€…å®ç°äº†WebRequestInterceptorçš„ç±» HandlerInterceptor æ¥å£æ–¹æ³•(1)boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handle)æ–¹æ³•ï¼Œè¿™ä¸ªå°†ä¼šåœ¨è¯·æ±‚ä¼ å…¥ä¹‹å‰è¿›è¡Œç›¸å…³çš„å¤„ç†ï¼Œå¦‚æœè¿”å›å€¼æ˜¯trueï¼Œå°†ä¼šè‡ªåŠ¨çš„è¿›è¡Œé“¾å¼è°ƒç”¨å…¶ä»–æŒ‰ç…§é¡ºåºæ‰§è¡Œçš„å®šæ—¶å™¨ï¼Œå¦åˆ™å°†ä¼šç»ˆæ­¢è°ƒç”¨controllå’Œå…¶ä»–æ‹¦æˆªå™¨ã€‚ (2) postHandle (HttpServletRequest request, HttpServletResponse response, Object handle, ModelAndView modelAndView) æ–¹æ³•,è¿™ä¸ªæ–¹æ³•å°†ä¼šåœ¨å¤„ç†å™¨æ‰§è¡Œå®Œåè¿›è¡Œå¤„ç†ï¼Œå’ŒpreHandleçš„æ‰§è¡Œæ–¹æ³•ï¼Œæ³¨æ„è¿™ä¸ªæ–¹æ³•å°†ä¸ä¼šè‡ªåŠ¨æ‹¦æˆª@requsetBodyæ³¨è§£ResponseEntity æ³¨æ„è¿™é‡Œï¼šï¼ˆ1ï¼‰å’Œï¼ˆ2ï¼‰çš„ç¬¬ä¸‰ä¸ªå‚æ•° handle å®˜æ–¹çš„è§£é‡Šæ˜¯@controlleræ ‡è®°çš„æœ¬èº«æˆ–è€…ä½¿ç”¨HandleMethodè¿™ä¸ªç±»ï¼Œå…¶å®è¿™é‡Œæ˜¯springmvc è‡ªå·±å¢å¼ºçš„æ–¹æ³•ï¼Œ ResponseEntity è¯¦è§£ï¼š è¿™ä¸ªç±»å…¶å®æ˜¯å¯¹ httpè¯·æ±‚çš„ä¸€ä¸ªå°è£…ï¼Œå°è£…äº†httpçš„æŠ¥å¤´ï¼ŒçŠ¶æ€ç ï¼Œhttp code ç­‰æ•°æ®ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ç§é€šä¿¡åè®® å¦‚æœä½¿ç”¨çš„ä¸æ˜¯stringç±»å‹ï¼Œé‚£ä¹ˆå°†ä¼šæ˜¯ä¸€ç§ç±»ä¼¼rpcåè®® å½“ä½¿ç”¨stringç±»å‹çš„æ—¶å€™å°±å’Œ@ResponceBody+@ResponseStatus ç›¸åŒ (3)afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handle, Exception ex) æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¹Ÿæ˜¯éœ€è¦å½“å‰å¯¹åº”çš„Interceptor çš„preHandle æ–¹æ³•çš„è¿”å›å€¼ä¸ºtrue æ—¶æ‰ä¼šæ‰§è¡Œã€‚è¯¥æ–¹æ³•å°†åœ¨æ•´ä¸ªè¯·æ±‚ç»“æŸä¹‹åï¼Œä¹Ÿå°±æ˜¯åœ¨DispatcherServlet æ¸²æŸ“äº†å¯¹åº”çš„è§†å›¾ä¹‹åæ‰§è¡Œã€‚è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦ä½œç”¨æ˜¯ç”¨äºè¿›è¡Œèµ„æºæ¸…ç†å·¥ä½œçš„ã€‚ é™¤äº†å®ç°HandlerInterceptorå¯ä»¥å®ç°æ‹¦æˆªå™¨ä¹‹å¤–ï¼Œä½¿ç”¨WebRequestInterceptor åŒæ ·å¯ä»¥å®ç°æ‹¦æˆªå™¨ (1)preHandle(WebRequest request) æ–¹æ³•ã€‚æ³¨æ„è¿™ä¸ªæ–¹æ³•æ²¡æœ‰è¿”å›ç›´ï¼Œä¸€èˆ¬ä¸»è¦ç”¨å®ƒæ¥è¿›è¡Œèµ„æºçš„å‡†å¤‡å·¥ä½œï¼Œå…¶ä¸­çš„webrequestå‚æ•°æ˜¯HttpServletRequestçš„åŠ å¼ºç‰ˆï¼Œå¯ä»¥ä½¿ç”¨setAttribute(name, value, scope)æ·»åŠ å‚æ•°åˆ°æŒ‡å®šçš„ä½œç”¨åŸŸä¸­ï¼Œscopeå‚æ•°æœ‰å¦‚ä¸‹çš„å‡ ä¸ªå€¼ï¼š 1. SCOPE_REQUEST ï¼šå®ƒçš„å€¼æ˜¯0 ï¼Œä»£è¡¨åªæœ‰åœ¨request ä¸­å¯ä»¥è®¿é—®ã€‚ 2. SCOPE_SESSION ï¼šå®ƒçš„å€¼æ˜¯1 ï¼Œå¦‚æœç¯å¢ƒå…è®¸çš„è¯å®ƒä»£è¡¨çš„æ˜¯ä¸€ä¸ªå±€éƒ¨çš„éš”ç¦»çš„sessionï¼Œå¦åˆ™å°±ä»£è¡¨æ™®é€šçš„sessionï¼Œå¹¶ä¸”åœ¨è¯¥sessionèŒƒå›´å†…å¯ä»¥è®¿é—®ã€‚ 3. SCOPE_GLOBAL_SESSION ï¼šå®ƒçš„å€¼æ˜¯2 ï¼Œå¦‚æœç¯å¢ƒå…è®¸çš„è¯ï¼Œå®ƒä»£è¡¨çš„æ˜¯ä¸€ä¸ªå…¨å±€å…±äº«çš„sessionï¼Œå¦åˆ™å°±ä»£è¡¨æ™®é€šçš„sessionï¼Œå¹¶ä¸”åœ¨è¯¥session èŒƒå›´å†…å¯ä»¥è®¿é—®ã€‚(2)postHandle(WebRequest request, ModelMap model) æ–¹æ³•ã€‚è¯¥æ–¹æ³•å°†åœ¨è¯·æ±‚å¤„ç†ä¹‹åï¼Œä¹Ÿå°±æ˜¯åœ¨Controller æ–¹æ³•è°ƒç”¨ä¹‹åè¢«è°ƒç”¨ï¼Œä½†æ˜¯ä¼šåœ¨è§†å›¾è¿”å›è¢«æ¸²æŸ“ä¹‹å‰è¢«è°ƒç”¨ï¼Œrequest å°±æ˜¯ä¼ é€’çš„è¯·æ±‚å‚æ•°ï¼Œmodelå°±æ˜¯è¿”å›çš„è§†å›¾(3)afterCompletion(WebRequest request, Exception ex) æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¼šåœ¨æ•´ä¸ªè¯·æ±‚å¤„ç†å®Œæˆï¼Œä¹Ÿå°±æ˜¯åœ¨è§†å›¾è¿”å›å¹¶è¢«æ¸²æŸ“ä¹‹åæ‰§è¡Œã€‚æ‰€ä»¥åœ¨è¯¥æ–¹æ³•ä¸­å¯ä»¥è¿›è¡Œèµ„æºçš„é‡Šæ”¾æ“ä½œã€‚è€ŒWebRequest å‚æ•°å°±å¯ä»¥æŠŠæˆ‘ä»¬åœ¨preHandle ä¸­å‡†å¤‡çš„èµ„æºä¼ é€’åˆ°è¿™é‡Œè¿›è¡Œé‡Šæ”¾ã€‚Exception å‚æ•°è¡¨ç¤ºçš„æ˜¯å½“å‰è¯·æ±‚çš„å¼‚å¸¸å¯¹è±¡ï¼Œå¦‚æœåœ¨Controller ä¸­æŠ›å‡ºçš„å¼‚å¸¸å·²ç»è¢«Spring çš„å¼‚å¸¸å¤„ç†å™¨ç»™å¤„ç†äº†çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªå¼‚å¸¸å¯¹è±¡å°±æ˜¯æ˜¯null ã€‚ ####HandlerExceptionResolver springmvc å¼‚å¸¸å¤„ç† å¼‚å¸¸å¤„ç†ç”¨äºå¤„ç†@controll è¿™ç§æ¥å£æŠ›å‡ºçš„å„ç§å¼‚å¸¸ï¼Œä¸»è¦æœ‰å¦‚ä¸‹çš„å‡ ç§ SimpleMappingExceptionResolver å¼‚å¸¸ç±»åç§°å’Œé”™è¯¯è§†å›¾åç§°ä¹‹é—´çš„æ˜ å°„ã€‚ç”¨äºåœ¨æµè§ˆå™¨åº”ç”¨ç¨‹åºä¸­å‘ˆç°é”™è¯¯é¡µé¢ã€‚ DefaultHandlerExceptionResolver è§£å†³Spring MVCå¼•å‘çš„å¼‚å¸¸å¹¶å°†å®ƒä»¬æ˜ å°„åˆ°HTTPçŠ¶æ€ä»£ç ã€‚å¦è¯·å‚é˜…å¤‡ç”¨ResponseEntityExceptionHandlerå’ŒREST APIä¾‹å¤–ã€‚ ResponseStatusExceptionResolver æ ¹æ®@ResponseStatusæ³¨é‡Šä¸­çš„å€¼è§£å†³æ³¨é‡Šä¸­çš„å¼‚å¸¸å¹¶å°†å…¶æ˜ å°„åˆ°HTTPçŠ¶æ€ä»£ç ã€‚ ExceptionHandlerExceptionResolver é€šè¿‡è°ƒç”¨@ExceptionHandlerä¸€ä¸ª@Controlleræˆ–ä¸€ä¸ª @ControllerAdviceç±»ä¸­çš„æ–¹æ³•æ¥è§£å†³å¼‚å¸¸ã€‚è¯·å‚é˜…@ExceptionHandleræ–¹æ³•ã€‚ å¯¹äºå¼‚å¸¸å¤„ç†æ¥è¯´é€šå¸¸çš„è§£å†³ç»“æœæœ‰å¦‚ä¸‹çš„å‡ ç§æ–¹æ³• ä½¿ç”¨ModelAndView æŒ‡å‘é”™è¯¯è§†å›¾ã€‚ è¿”å›ç©ºçš„modelandview å¦‚æœå¼‚å¸¸è¢«å¤„ç† å¦‚æœå¼‚å¸¸æ²¡æœ‰è¢«è§£å†³ï¼Œå°†ä¼šä½¿ç”¨å¼‚å¸¸è°ƒç”¨è¿è¿›è¡Œå¤„ç†ï¼Œå¦‚æœè°ƒç”¨åˆ°æœ€åå°†ä¼šæŠ›å‡ºåˆ°servletä¸­ åœ¨spring mvc ä¸­é›†ä¸­è¿›è¡Œå¼‚å¸¸å¤„ç†çš„æœ‰ä¸‰ç§æ–¹æ³• ä½¿ç”¨@ResponseStatus æ³¨é‡Šä¸€ä¸ªå¼‚å¸¸ç±»ï¼Œå½“springä¸­æŠ›å‡ºè¿™ä¸ªå¼‚å¸¸çš„æ—¶å€™å°†ä¼šè‡ªåŠ¨çš„äº¤ç”±è¿™ä¸ªç±»å¤„ç†,å¹¶ä¸”å¯ä»¥åˆ¶å®šhttp codeå€¼ï¼Œæ¯”å¦‚ä¸‹é¢çš„æ–¹æ³•å°†ä¼šè·‘å‡º403é”™è¯¯ æ³¨æ„å¦‚æœè¿™ä¸ªæ³¨è§£ä½¿ç”¨åœ¨ ä¸€ä¸ªæ–¹æ³•ä¸Šçš„æ—¶å€™ ï¼Œ ä¸è®ºç»“æœå¦‚ä½•éƒ½å°†ä¼šæ”¾å›åˆ¶å®šçš„httpcode å¼‚å¸¸ 2.@ControllerAdvice å’Œ @ExceptionHandler è¿™ä¸¤ä¸ªæ³¨è§£åŒæ ·ç”¨äºå¼‚å¸¸å¤„ç† ï¼ˆ1ï¼‰@ExceptionHandler å½“ä¸€ä¸ªControllerä¸­æœ‰æ–¹æ³•åŠ äº†@ExceptionHandlerä¹‹åï¼Œè¿™ä¸ªControllerå…¶ä»–æ–¹æ³•ä¸­æ²¡æœ‰æ•è·çš„å¼‚å¸¸å°±ä¼šä»¥å‚æ•°çš„å½¢å¼ä¼ å…¥åŠ äº†@ExceptionHandleræ³¨è§£çš„é‚£ä¸ªæ–¹æ³•ä¸­ã€‚æ³¨æ„è¿™ä¸ªæ–¹æ³•è¦æœ‰ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å°±æ˜¯æŒ‡å®šè¦å¤„ç†çš„å¼‚å¸¸ ï¼ˆ2ï¼‰@ControllerAdvice å®ç°è¿™ä¸ªæ³¨è§£çš„ç±»å¯ä»¥è®©è¿™ä¸ªç±»ä¸­ @ExceptionHandleræ ‡è®°çš„æ–¹æ³•å®ç°å…¨è§‰å¼‚å¸¸ç›‘å¬ æœ€åå¯¹äºspringmvc å¦‚æœå¼‚å¸¸æ²¡æœ‰è¢«å¤„ç†ï¼Œspringæä¾›äº†é»˜è®¤çš„é¡µé¢å±•ç¤ºå¼‚å¸¸ï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹æ³•é…ç½®xml ï¼š åˆ¶å®šé»˜è®¤é”™è¯¯é¡µé¢ java ï¼š å¤„ç†url ViewResolver æä¾›äº†view åç§°åˆ°viewå®ä¾‹ä¹‹é—´çš„ç»‘å®šï¼Œå¹¶ä¸”å®ŒæˆçœŸæ­£è§†å›¾å±•ç¤ºä¹‹å‰å°†ç›¸å…³æ•°æ®è¿›è¡Œæ•´ç†çš„åŠŸèƒ½spring mvc ä¸­å°†ç›¸å…³çš„è§†å›¾å˜æˆä¸€ä¸ªç½‘é¡µç»å†çš„è¿‡ç¨‹ å°†SpringMVCæ§åˆ¶å™¨ä¸­çš„è¿”å›ç»“æœå°è£…æˆä¸€ä¸ªModelAndViewå¯¹è±¡ã€‚ é€šè¿‡SpringMVCä¸­çš„è§†å›¾è§£æå™¨ï¼Œä½¿ç”¨ViewResolverå¯¹æ§åˆ¶å™¨è¿”å›çš„ModelAndViewå¯¹è±¡è¿›è¡Œè§£æï¼Œå°†é€»è¾‘è§†å›¾è½¬æ¢æˆç‰©ç†è§†å›¾ã€‚ è°ƒç”¨Viewä¸­çš„render()æ–¹æ³•å¯¹ç‰©ç†è§†å›¾è¿›è¡Œæ¸²æŸ“ã€‚ å‡ ä¸ªä¸»è¦çš„è§†å›¾çš„ä»‹ç» AbstractCachingViewResolver: æœ€æŠ½è±¡çš„ç±»æä¾›äº†è§†å›¾ç¼“å­˜çš„åŠŸèƒ½ UrlBasedViewResolver: æä¾›äº†æ›´åŠ ç»†ç²’åº¦çš„urlæ§åˆ¶ï¼Œæ”¯æŒå‰ç¼€åç¼€ç­‰åŠŸèƒ½ï¼Œä½†æ˜¯ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å¿…é¡»åˆ¶å®šç›¸å…³çš„viewè§£æå·¥å…·ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯jspè§£æå·¥å…·InternalResourceViewï¼ˆå’Œå¯ä»¥ä½¿ç”¨å…¶ä»–çš„æ˜¯è§£æå·¥å…·æ¯”å¦‚FreeMarkerViewç­‰ï¼‰ï¼Œ å¹¶ä¸”æä¾›äº†é‡å®šå‘å’Œè½¬å‘çš„åŠŸèƒ½ InternalResourceViewResolverï¼šè¿™ä¸ªæ–¹æ³•æ˜¯ UrlBasedViewResolver çš„å­ç±»ï¼Œæ”¯æŒçˆ¶ç±»çš„æ‰€æœ‰åŠŸèƒ½ï¼ŒInternalResourceViewResolverä¼šæŠŠè¿”å›çš„è§†å›¾åç§°éƒ½è§£æä¸ºInternalResourceViewå¯¹è±¡ï¼Œå†…éƒ¨ä½¿ç”¨é‡å®šå‘çš„æ–¹æ³•ï¼Œå°†controllerè¿”å›çš„view åŒ…è£…æˆInternalResourceViewï¼Œ å¹¶ä¸”é‹å¸¦ä¸Šå‰ç¼€å’Œåç¼€ï¼ŒåŒæ—¶å†è½¬å‘å‡ºå» è§†å›¾è§£æé“¾ï¼šåœ¨SpringMVCä¸­å¯ä»¥åŒæ—¶å®šä¹‰å¤šä¸ªViewResolverè§†å›¾è§£æå™¨ï¼Œç„¶åå®ƒä»¬ä¼šç»„æˆä¸€ä¸ªViewResolveré“¾ã€‚å½“Controllerå¤„ç†å™¨æ–¹æ³•è¿”å›ä¸€ä¸ªé€»è¾‘è§†å›¾åç§°åï¼ŒViewResolveré“¾å°†æ ¹æ®å…¶ä¸­ViewResolverçš„ä¼˜å…ˆçº§æ¥è¿›è¡Œå¤„ç†ã€‚æ‰€æœ‰çš„ViewResolveréƒ½å®ç°äº†Orderedæ¥å£ï¼Œåœ¨Springä¸­å®ç°äº†è¿™ä¸ªæ¥å£çš„ç±»éƒ½æ˜¯å¯ä»¥æ’åºçš„ã€‚åœ¨ViewResolverä¸­æ˜¯é€šè¿‡orderå±æ€§æ¥æŒ‡å®šé¡ºåºçš„ï¼Œé»˜è®¤éƒ½æ˜¯æœ€å¤§å€¼ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‡å®šViewResolverçš„orderå±æ€§æ¥å®ç°ViewResolverçš„ä¼˜å…ˆçº§ï¼Œorderå±æ€§æ˜¯Integerç±»å‹ï¼Œorderè¶Šå°ï¼Œå¯¹åº”çš„ViewResolverå°†æœ‰è¶Šé«˜çš„è§£æè§†å›¾çš„æƒåˆ©ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªè¿›è¡Œè§£æçš„å°†æ˜¯ViewResolveré“¾ä¸­orderå€¼æœ€å°çš„é‚£ä¸ªã€‚å½“ä¸€ä¸ªViewResolveråœ¨è¿›è¡Œè§†å›¾è§£æåè¿”å›çš„Viewå¯¹è±¡æ˜¯nullçš„è¯å°±è¡¨ç¤ºè¯¥ViewResolverä¸èƒ½è§£æè¯¥è§†å›¾ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœè¿˜å­˜åœ¨å…¶ä»–orderå€¼æ¯”å®ƒå¤§çš„ViewResolverå°±ä¼šè°ƒç”¨å‰©ä½™çš„ViewResolverä¸­çš„orderå€¼æœ€å°çš„é‚£ä¸ªæ¥è§£æè¯¥è§†å›¾ï¼Œä¾æ­¤ç±»æ¨ã€‚å½“ViewResolveråœ¨è¿›è¡Œè§†å›¾è§£æåè¿”å›çš„æ˜¯ä¸€ä¸ªéç©ºçš„Viewå¯¹è±¡çš„æ—¶å€™ï¼Œå°±è¡¨ç¤ºè¯¥ViewResolverèƒ½å¤Ÿè§£æè¯¥è§†å›¾ï¼Œé‚£ä¹ˆè§†å›¾è§£æè¿™ä¸€æ­¥å°±å®Œæˆäº†ï¼Œåç»­çš„ViewResolverå°†ä¸ä¼šå†ç”¨æ¥è§£æè¯¥è§†å›¾ã€‚å½“å®šä¹‰çš„æ‰€æœ‰ViewResolveréƒ½ä¸èƒ½è§£æè¯¥è§†å›¾çš„æ—¶å€™ï¼ŒSpringå°±ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ spring mvc å¸¸ç”¨æ³¨è§£spring æä¾›äº†ä¸€æ•´å¥—æ³¨è§£æ¥ç®€åŒ–springç›¸å…³çš„é…ç½® @Controll å’Œ @RestControllerSpring MVCæä¾›äº†ä¸€ç§åŸºäºæ³¨é‡Šçš„ç¼–ç¨‹æ¨¡å‹ï¼Œå…¶ä¸­@Controllerå’Œ@RestControllerç»„ä»¶ä½¿ç”¨æ³¨é‡Šæ¥è¡¨ç¤ºè¯·æ±‚æ˜ å°„ï¼Œè¯·æ±‚è¾“å…¥ï¼Œå¼‚å¸¸å¤„ç†ç­‰ã€‚ å…¶ä¸­çš„@RestController æ˜¯@ResponseBodyå’Œ@Controlleræ³¨è§£çš„ä¸€ç§é›†åˆã€‚ æ³¨æ„ï¼šå¦‚æœä½¿ç”¨aopæ–¹æ³•å¯¹controller è¿›è¡Œå¢å¼ºçš„è¯è¯·ä½¿ç”¨class-based proxyingä»£ç†ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨äº†éspring contextå›è°ƒæ¥å£çš„æ–¹æ³•çš„æ—¶å€™ï¼Œéœ€è¦æ˜ç¡®çš„åˆ¶å®šç›¸å…³çš„é…ç½®ä¿¡æ¯ï¼štx:annotation-driven/, æ”¹å˜ä¸º <tx:annotation-driven proxy-target-class&#x3D;â€trueâ€&#x2F;>. @RequestMapping requestMapping:æœ‰ç®€åŒ–ç‰ˆçš„å„ç§æ³¨è§£@GetMappingï¼Œ@PostMappingï¼Œ@PutMappingï¼Œ@DeleteMappingï¼Œ@PatchMappingï¼ŒæŒ‡å®šäº†ç›¸å…³çš„methodæ–¹æ³•å¯¹åº”çš„å„ç§è¯·æ±‚ request è¯·æ±‚å¯ä»¥æ¥å—çš„è¯·æ±‚å¯ä»¥é€šè¿‡é€šé…ç¬¦æˆ–è€…globå‚æ•°çš„æ–¹æ³•è¿›è¡ŒåŒ¹é… spring mvc çš„åœ°å€åŒ¹é…æ–¹æ³•æ»¡è¶³ä¸€å®šçš„ç›¸å…³åŸåˆ™ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦è¿›è¡ŒåŒ¹é… Wildcard Description ï¼Ÿ åŒ¹é…ä»»ä½•å•å­—ç¬¦ * åŒ¹é…0æˆ–è€…ä»»æ„æ•°é‡çš„å­—ç¬¦ ** åŒ¹é…0æˆ–è€…æ›´å¤šçš„ç›®å½• æ³¨æ„ï¼šspringå°†ä¼šæŒ‰ç…§åŒ¹é…çš„å­—ç¬¦æœ€é•¿çš„é‚£ä¸ªè¿›è¡ŒåŒ¹é…ï¼Œæ¯”å¦‚&#x2F;**&#x2F;.jsp å’Œ&#x2F;app&#x2F;dir&#x2F;.jspï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå°†ä¼šåŒ¹é…åè€…ã€‚ æ³¨æ„ï¼šspring mvc çš„åŒ¹é…åŸåˆ™æ˜¯æŒ‰ç…§åç¼€åŒ¹é…çš„åŸåˆ™ï¼Œæ¯”å¦‚ä¸€ä¸ªurlåœ°å€ &#x2F;nameè¿™ä¸ªåœ°å€ï¼Œè¡¨ç¤ºçš„å°±æ˜¯&#x2F;name.*ï¼Œä¸€å®šç¨‹åº¦ä¸Šå®ç°äº†æ–‡ä»¶æ‰©å±•åå¼•ç”¨ å¦‚æœä½¿ç”¨äº†æ–‡ä»¶æ‰©å±•åç§°è¿™ç§ä¸œè¥¿å¦‚æœæƒ³è¦é…ç½®è¯·æŸ¥çœ‹å¦‚ä¸‹ä¸¤ä¸ªæ¥å£ï¼š åœ¨requestMethodä¸­å¯ä»¥æ¥æ”¶çš„æ•°æ®æ¥å—çš„å‡½æ•°ä½“ä¸­å¯ä»¥ä½¿ç”¨çš„æ³¨è§£å’Œå‚æ•° WebRequest, NativeWebRequest WebRequestæ˜¯Spring Web MVCæä¾›çš„ç»Ÿä¸€è¯·æ±‚è®¿é—®æ¥å£ï¼Œä¸ä»…ä»…å¯ä»¥è®¿é—®è¯·æ±‚ç›¸å…³æ•°æ®ï¼ˆå¦‚å‚æ•°åŒºæ•°æ®ã€è¯·æ±‚å¤´æ•°æ®ï¼Œä½†è®¿é—®ä¸åˆ°CookieåŒºæ•°æ®ï¼‰ï¼Œè¿˜å¯ä»¥è®¿é—®ä¼šè¯å’Œä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®ï¼›NativeWebRequestç»§æ‰¿äº†WebRequestï¼Œå¹¶æä¾›è®¿é—®æœ¬åœ°Servlet APIçš„æ–¹æ³•ã€‚ javax.servlet.ServletRequest, javax.servlet.ServletResponseï¼Œjavax.servlet.http.HttpSession javax æä¾›çš„å…·ä½“æ¥å£æ³¨æ„å…¶ä¸­çš„httpsession ï¼Œä¼šè¯è®¿é—®ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å¦‚æœå…è®¸å¤šä¸ªè¯·æ±‚åŒæ—¶è®¿é—®ä¼šè¯ï¼Œè¯·è€ƒè™‘å°†RequestMappingHandlerAdapterçš„â€œsynchronizeOnSessionâ€æ ‡å¿—è®¾ç½®ä¸ºâ€œtrueâ€ã€‚ HttpMethod è¿™ä¸ªå€¼ä¸­æœ‰ä¼ å…¥çš„æ–¹å¼ï¼Œæ¯”å¦‚getè¿˜æ˜¯post java.io.InputStream, java.io.Readerï¼Œjava.io.OutputStream, java.io.Writer è¯·æ±‚çš„åŸå§‹è¯·æ±‚æ•°æ®æµï¼Œå’ŒåŸå§‹è¿”å›æ•°æ® @PathVariableå’Œ@MatrixVariable ä½¿ç”¨{}è¡¨ç¤ºçš„urlè¯·æ±‚å¯¹åº”çš„ç›¸å…³å‚æ•°, @PathVariable æ²¡ä»€ä¹ˆå¥½è¯´çš„å…³é”®æ˜¯@MatrixVariable ï¼Œ è¿™ä¸ªæ³¨è§£å°†ä¼šè‡ªåŠ¨çš„åŒ¹é…url åœ°å€ä¸­ ;uuu&#x3D;123;iii&#x3D;333 è¿™ç§å‚æ•°ï¼Œå¹¶ä¸”ä¸€å®šçš„ç¨‹åº¦ä¸‹å¹¶ä¸éœ€è¦{jj}ä¸­æŒ‡å®šçš„åç§°æ¥åŒ¹é…ï¼Œå½“å‘ç”Ÿå‚æ•°å†²çªçš„æ—¶å€™å¯ä»¥ä½¿ç”¨pathVarå‚æ•°æŒ‡å®šåç§°ï¼Œç›®å‰æœ‰bugä¸è®°å½•äº† @PathVariable,@MatrixVariable,@RequestParamï¼Œ@RequestBodyï¼Œ@RequestHeaderï¼Œ@CookieValueï¼Œ@RequestPart,@ModelAttribute,@SessionAttribute,@RequestAttribute @PathVariable ,spring mvcæä¾›äº†ä¸€å¥—æ”¯æŒreastfulapiçš„æ–¹æ³•ï¼Œè¿™å¥—æ–¹æ³•å¯ä»¥ä½¿ç”¨{}+é€šé…ç¬¦çš„æ–¹å¼ï¼Œå°†urlä¸­çš„æ•°æ®ä¼ é€’åˆ°method å¯¹åº”çš„å‚æ•°ä¸­ æ³¨æ„ï¼š{}é‡Œé¢çš„å€¼å€¼ä¹Ÿå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œç›¸å…³çš„é…ç½®ï¼Œæ ¼å¼ï¼š{varName:regex} @MatrixVariableï¼Œè¿™ä¸ªæ³¨è§£å°†ä¼šè‡ªåŠ¨çš„åŒ¹é…urlåœ°å€ä¸­;uuu&#x3D;123;iii&#x3D;333è¿™ç§å‚æ•°ï¼Œå¹¶ä¸”ä¸€å®šçš„ç¨‹åº¦ä¸‹å¹¶ä¸éœ€è¦{jj}ä¸­æŒ‡å®šçš„åç§°æ¥åŒ¹é…ï¼Œå½“å‘ç”Ÿå‚æ•°å†²çªçš„æ—¶å€™å¯ä»¥ä½¿ç”¨pathVarå‚æ•°æŒ‡å®šåç§°ï¼Œç›®å‰æœ‰bugä¸è®°å½•äº† @RequestParamæ¥å£å°†ä¼šè‡ªåŠ¨çš„å°†ä¼ å…¥åˆ°æŒ‡å®šçš„åœ°å€ä¸­ å¦‚æœä½¿ç”¨è¿™ä¸ªæ³¨è§£æ ‡è¯†Map<String, String> or MultiValueMap<String, String>ï¼Œå°†ä¼šå°†æ‰€æœ‰çš„å±æ€§æ³¨å…¥è¿›æ¥Aï¼‰ å¸¸ç”¨æ¥å¤„ç†ç®€å•ç±»å‹çš„ç»‘å®šï¼Œé€šè¿‡Request.getParameter() è·å–çš„Stringå¯ç›´æ¥è½¬æ¢ä¸ºç®€å•ç±»å‹çš„æƒ…å†µï¼ˆ Stringâ€“> ç®€å•ç±»å‹çš„è½¬æ¢æ“ä½œç”±ConversionServiceé…ç½®çš„è½¬æ¢å™¨æ¥å®Œæˆï¼‰ï¼›å› ä¸ºä½¿ç”¨request.getParameter()æ–¹å¼è·å–å‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥å¤„ç†get æ–¹å¼ä¸­queryStringçš„å€¼ï¼Œä¹Ÿå¯ä»¥å¤„ç†postæ–¹å¼ä¸­ body dataçš„å€¼ï¼›Bï¼‰ç”¨æ¥å¤„ç†Content-Type: ä¸º application&#x2F;x-www-form-urlencodedç¼–ç çš„å†…å®¹ï¼Œæäº¤æ–¹å¼GETã€POSTï¼›C) è¯¥æ³¨è§£æœ‰ä¸¤ä¸ªå±æ€§ï¼š valueã€requiredï¼› valueç”¨æ¥æŒ‡å®šè¦ä¼ å…¥å€¼çš„idåç§°ï¼Œrequiredç”¨æ¥æŒ‡ç¤ºå‚æ•°æ˜¯å¦å¿…é¡»ç»‘å®šï¼› @RequestBody è¯¥æ³¨è§£å¸¸ç”¨æ¥å¤„ç†Content-Type: ä¸æ˜¯application&#x2F;x-www-form-urlencodedç¼–ç çš„å†…å®¹ï¼Œä¾‹å¦‚application&#x2F;json, application&#x2F;xmlç­‰ï¼›å®ƒæ˜¯é€šè¿‡ä½¿ç”¨HandlerAdapter é…ç½®çš„HttpMessageConvertersæ¥è§£æpost data bodyï¼Œç„¶åç»‘å®šåˆ°ç›¸åº”çš„beanä¸Šçš„ã€‚ ä½¿ç”¨ï¼šHttpMessageConverteræ¥å£ï¼Œéœ€è¦å¼€å¯<mvc:annotation-driven &#x2F;>ã€‚ AnnotationMethodHandlerAdapterå°†ä¼šåˆå§‹åŒ–7ä¸ªè½¬æ¢å™¨ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨AnnotationMethodHandlerAdapterçš„getMessageConverts()æ–¹æ³•æ¥è·å–è½¬æ¢å™¨çš„ä¸€ä¸ªé›†åˆ Listï¼Œè¿™7ä¸ªè½¬åŒ–å™¨å¦‚ä¸‹ï¼š PS:Springé»˜è®¤çš„jsonåè®®è§£æç”±Jacksonå®Œæˆã€‚ è¿™ç§æ–¹å¼çš„æ—¶å€™é»˜è®¤ä½¿ç”¨çš„å°±æ˜¯jsonè§£æã€‚ é—®é¢˜ å¦‚ä½•æ‰©å±• psï¼šå¦‚æœä½¿ç”¨xml æ–¹å¼ï¼Œéœ€è¦ä½¿ç”¨æ³¨è§£ æ³¨æ„ è¿™é‡Œå¦‚æœè¦ä½¿ç”¨æ³¨æ„spring mvc ç¯å¢ƒçš„é…ç½® ä½¿ç”¨xml è¿›è¡Œé…ç½® ä½¿ç”¨java è¿›è¡Œé…ç½® @RequestPart å’Œæ–‡ä»¶ä¸Šä¼ ç›¸å…³ï¼Œéš¾åº¦æœ‰ç‚¹å¤§ï¼Œå’Œhttpåè®®ç›¸å…³çš„æš‚æ—¶ä¸è€ƒè™‘ @RequestHeader å°†httpåè®®ä¸­ç›¸å…³çš„å¤´æ³¨å…¥åˆ°æŒ‡å®šçš„æ•°æ®ä¸­ @ModelAttribute åœ¨ä½¿ç”¨model view åœºæ™¯ä¸‹ï¼Œæœ‰å¦‚ä¸‹çš„ä¸€åº”ç”¨ å…¨å±€modelé…ç½®ï¼Œåœ¨è·å¾—è¯·æ±‚&#x2F;helloWorld åï¼ŒpopulateModelæ–¹æ³•åœ¨helloWorldæ–¹æ³•ä¹‹å‰å…ˆè¢«è°ƒç”¨ï¼Œå®ƒæŠŠè¯·æ±‚å‚æ•°ï¼ˆ&#x2F;helloWorld?abc&#x3D;textï¼‰åŠ å…¥åˆ°ä¸€ä¸ªåä¸ºattributeNameçš„modelå±æ€§ä¸­ï¼Œåœ¨å®ƒæ‰§è¡Œå helloWorldè¢«è°ƒç”¨ï¼Œè¿”å›è§†å›¾åhelloWorldå’Œmodelå·²ç”±@ModelAttributeæ–¹æ³•ç”Ÿäº§å¥½äº†ã€‚ æŒ‡æ´¾modelé…ç½® è¿”å› helloworld.doè§†å›¾ï¼Œæœ‰ä¸€ä¸ªmodel å‚æ•°æ˜¯attributeNameå’Œå€¼ hi ç»‘å®šapplication&#x2F;x-www-form-urlencoded æäº¤çš„è¯·æ±‚ä¸­ çš„å€¼åˆ°å¯¹è±¡ä¸­ æ”¯æŒuser.xxx,user2.ddd åµŒå¥—å¯¹åº”æ³• @CookieValue å’Œä¹‹å‰çš„ç›¸åŒï¼Œå°±æ˜¯å°†cookieä¸­ç›¸å…³çš„æ•°æ®æ‹¿å‡ºæ¥ HttpEntity HttpEntityæˆ–å¤šæˆ–å°‘ä¸ä½¿ç”¨@RequestBodyç›¸åŒï¼Œä½†åŸºäºå…¬å¼€è¯·æ±‚æ ‡å¤´å’Œä¸»ä½“çš„å®¹å™¨å¯¹è±¡ã€‚ æ³¨æ„è¿™ä¸ªæ–¹æ³•å¤šæ˜¯ç”¨äºpostè¯·æ±‚ç”¨æ¥é’ˆå¯¹ajaxåºåˆ—åŒ–çš„jsonå¯¹è±¡è§£æï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªgetbodyæ–¹æ³• @InitBinder springè‡ªå¸¦çš„æ•°æ®å¤„ç†æ¨¡å— ç”±@InitBinderè¡¨ç¤ºçš„æ–¹æ³•ï¼Œå¯ä»¥å¯¹WebDataBinderå¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ã€‚WebDataBinderæ˜¯DataBinderçš„å­ç±»ï¼Œç”¨äºå®Œæˆç”±è¡¨å•åˆ°JavaBeanå±æ€§çš„ç»‘å®šã€‚@InitBinderæ–¹æ³•ä¸èƒ½æœ‰è¿”å›å€¼ï¼Œå®ƒå¿…é¡»ç››åä¸ºvoidã€‚@InitBinderæ–¹æ³•çš„å‚æ•°é€šå¸¸æ˜¯WebDataBinderï¼Œ@InitBinderå¯ä»¥å¯¹WebDataBinderè¿›è¡Œåˆå§‹åŒ–ã€‚ æ³¨æ„è¿™ä¸ªæ³¨è§£åªæ˜¯é’ˆå¯¹è¿™ä¸ªcontrollerä¸­çš„æ–¹æ³•èµ·ä½œç”¨ï¼Œæ— æ³•é’ˆå¯¹æ‰€æœ‰çš„controller æ³¨æ„WebDataBinderè¿™ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªæ–¹æ³•registerCustomEditor,è¿™ä¸ªæ–¹æ³•å°†ä¼šè‡ªåŠ¨çš„é…ç½®å±æ€§æ˜ å°„å™¨ï¼Œå°†ç›¸å…³çš„å±æ€§æ˜ å°„åˆ°æŒ‡å®šçš„ä½ç½®ï¼Œå±æ€§æ˜ å°„å™¨å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹æ³•è¿›è¡Œè‡ªå®šä¹‰å®ç°PropertyEditoræˆ–è€…é‡å†™PropertyEditorSupportå¯¹è±¡ä¸­çš„æ–¹æ³•ï¼Œæ³¨æ„è¿™ç§æ–¹æ³•åªèƒ½å®ç°stringåˆ°å¯¹è±¡çš„è½¬æ¢ setValueä¸­å°±æ˜¯è½¬åŒ–åçš„å¯¹è±¡ï¼ŒsetAsTextä¼ å…¥çš„å°±æ˜¯ä¼ å…¥çš„urlå­—ç¬¦ä¸² åŒæ—¶WebDataBinderè¿™ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªaddCustomFormatter å¯ä»¥ç›´æ¥ä½¿ç”¨formatterè¿›è¡Œå‚æ•°è½¬åŒ–æœ¬è´¨ä¸Šæ˜¯ç›¸åŒçš„ addCustomFormatteræœ¬è´¨ä¸Šè¿˜æ˜¯å’ŒregisterCustomEditoræ˜¯ä¸€æ ·çš„è§æºä»£ç  @RequestMapping æ–¹æ³•è¿”å›å€¼ä¸­çš„å‚æ•° @ResponseBody HttpEntity, ResponseEntity HttpEntity HttpEntityæˆ–å¤šæˆ–å°‘ä¸ä½¿ç”¨@RequestBodyç›¸åŒï¼Œä½†åŸºäºå…¬å¼€è¯·æ±‚æ ‡å¤´å’Œä¸»ä½“çš„å®¹å™¨å¯¹è±¡ã€‚ ResponseEntity è¿™ä¸ªç±»å…¶å®æ˜¯å¯¹ httpè¯·æ±‚çš„ä¸€ä¸ªå°è£…ï¼Œå°è£…äº†httpçš„æŠ¥å¤´ï¼ŒçŠ¶æ€ç ï¼Œhttp code ç­‰æ•°æ®ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ç§é€šä¿¡åè®® å¦‚æœä½¿ç”¨çš„ä¸æ˜¯stringç±»å‹ï¼Œé‚£ä¹ˆå°†ä¼šæ˜¯ä¸€ç§ç±»ä¼¼rpcåè®® å½“ä½¿ç”¨stringç±»å‹çš„æ—¶å€™å°±å’Œ@ResponceBody+@ResponseStatus ç›¸åŒ HttpHeaders è¿”å›ä¸€ä¸ªå°è£…çš„httpheadersçš„å¤´ï¼Œè¿™ä¸ªç±»æœ‰ä¸€ä¸ªsetæ–¹æ³•ï¼Œåˆ¶å®šæ–¹æ³•çš„å¤´å’Œå†…å®¹ï¼Œå¦‚æœæƒ³æ·±å…¥çš„ä½¿ç”¨ï¼Œéœ€è¦ç²¾é€šhttpåè®® string æœ€ç®€å•çš„ä¸€ä¸ªæ–¹æ³•ï¼Œspringå°†ä¼šä½¿ç”¨è¿™ä¸ªå­—ç¬¦ä¸²æ‰¾åˆ°å¯¹åº”çš„view java.util.Map, org.springframework.ui.Modelï¼Œ@ModelAttribute spring mvc modelandviewä½“ç³»çš„ä¸œè¥¿ ResponseBodyEmitter, SseEmitterï¼Œ StreamingResponseBody Reactive types â€” Reactor, RxJava, or others via ReactiveAdapterRegistry @ResponseStatus(HttpStatus.CREATED) åˆ¶å®šè¿”å›å€¼çš„å¤´éƒ¨ä¿¡æ¯, æ¯”å¦‚åˆ¶å®š401 402 è¿™ç§http code","date":"2024-12-31","categories":["java"]},{"title":"java-JAAS(Java è®¤è¯å’ŒæˆæƒæœåŠ¡)","url":"/2024/12/31/java-JAAS-Java-è®¤è¯å’ŒæˆæƒæœåŠ¡-/","content":"ä¹‹å‰å†™è¿‡ä¸€ç¯‡æœ‰å…³javaå†…éƒ¨å®‰å…¨æœºåˆ¶å’Œæ²™ç®±çš„ä¸€ç‰‡æ–‡ç« ,é‚£ä¸€ç¯‡ä¸­jvmæ˜¯åŸºäºä»£ç çš„ç»´åº¦è¿›è¡Œæƒé™ç®¡ç†çš„,ä½†æ˜¯javaåœ¨java1.4å†…ç½®ä¸€ä¸ªJAASåŸºäºç”¨æˆ·çš„æƒé™ç®¡ç†(è™½ç„¶ä¸ªäººè§‰å¾—è¿™ä¸ªä¸œè¥¿éå¸¸é¸¡è‚‹,é€‚åˆå•ä½“åº”ç”¨å¹¶ä¸é€‚åˆç°åœ¨çš„å¾®æœåŠ¡å’Œåˆ†å¸ƒå¼æ¡†æ¶,å› ä¸ºæœ‰ä¸ªéå¸¸å‘çˆ¹çš„é…ç½®æ–‡ä»¶-æˆ‘æƒé™ç®¡ç†éƒ½æ˜¯ä½¿ç”¨æ•°æ®åº“å®ç°çš„:disappointed_relieved:) JAASçš„å¤§ä½“ç»„æˆ å®¢æˆ·ç«¯é€šè¿‡ä¸€ä¸ªLoginContextå¯¹è±¡ä¸JAASç›¸äº’ä½œç”¨ï¼Œè¿™ä¸ªLoginContextå¯¹è±¡æä¾›äº†ä¸€ç§å¼€å‘åº”ç”¨ç¨‹åºçš„æ–¹å¼ï¼Œå®ƒä¸ä¾èµ–äºåº•å±‚çš„è®¤è¯æŠ€æœ¯ã€‚ LoginContextï¼šæ˜¯javax.security.auth.loginåŒ…é‡Œçš„ä¸€ä¸ªç±»ï¼Œå®ƒæè¿°äº†ç”¨äºéªŒè¯å¯¹è±¡(subjects)çš„æ–¹æ³•ã€‚ Subjectï¼šå°±æ˜¯åœ¨æŸä¸ªä½ æƒ³å»è®¤è¯å’Œåˆ†é…è®¿é—®æƒé™çš„ç³»ç»Ÿé‡Œçš„ä¸€ä¸ªæ ‡è¯†ã€‚ä¸€ä¸ªä¸»ä½“(subject)å¯èƒ½æ˜¯ä¸€ä¸ªç”¨æˆ·ã€ä¸€ä¸ªè¿›ç¨‹æˆ–è€…æ˜¯ä¸€å°æœºå™¨ï¼Œå®ƒç”¨javax.security.auth.Subjectç±»è¡¨ç¤ºã€‚ java.security.Principalï¼š ç”±äºä¸€ä¸ªSubjectå¯èƒ½æ¶‰åŠå¤šä¸ªæˆæƒï¼ˆä¸€ä¸ªç½‘ä¸Šé“¶è¡Œå¯†ç å’Œå¦ä¸€ä¸ªç”µå­é‚®ä»¶ç³»ç»Ÿï¼‰ï¼Œjava.security.Principalå°±è¢«ç”¨ä½œåœ¨é‚£äº›å…³è”é‡Œçš„æ ‡è¯†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥Principalæ¥å£æ˜¯ä¸€ä¸ªèƒ½å¤Ÿè¢«ç”¨ä½œä»£è¡¨æŸä¸ªå®ä½“ã€å…¬å¸æˆ–è€…ç™»é™†IDçš„æŠ½è±¡æ¦‚å¿µã€‚ä¸€ä¸ªSubjectå¯èƒ½åŒ…å«å¤šä¸ªPrinciples. ç¨åå°†æœ‰ä¸€ä¸ªç¤ºä¾‹ç±»å®ç°äº†è¿™ä¸ªPrincipalæ¥å£ã€‚ LoginContextå¯¹è±¡è°ƒç”¨è´Ÿè´£å®ç°å’Œæ‰§è¡Œè®¤è¯çš„LoginModulesã€‚LoginModuleæ¥å£(åœ¨javax.security.auth.spi åŒ…é‡Œ)å¿…é¡»è®©è®¤è¯æŠ€æœ¯çš„æä¾›è€…å»å®ç°ï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«åº”ç”¨ç¨‹åºæŒ‡å®šæä¾›ä¸€ä¸ªç‰¹å®šè®¤è¯ç±»å‹ã€‚ LoginContextï¼š ç”¨æ¥è¯»å–Configuarationå’Œå®ä¾‹åŒ–ç‰¹å®šçš„LoginModules. Configuarationï¼š è¢«æŸä¸ªç‰¹å®šçš„åº”ç”¨ç¨‹åºç”¨ä½œæŒ‡å®šè®¤è¯æŠ€æœ¯æˆ–è€…LoginModuleã€‚å› æ­¤ï¼Œä¸åŒçš„LoginModulesèƒ½å¤Ÿè¢«åº”ç”¨åˆ°æŸä¸ªåº”ç”¨ç¨‹åºè€Œä¸ç”¨å¯¹è¿™ä¸ªåº”ç”¨ç¨‹åºåšä»»ä½•çš„ä»£ç ä¿®æ”¹ã€‚ CallbackHandler å®‰å…¨æœºåˆ¶çš„å›è°ƒå™¨å¤„ç†å™¨,ç”¨æ¥å¤„ç†å’Œæ˜¾ç¤ºå›è°ƒçš„ä¿¡æ¯ ä¸€ä¸ªä¾‹å­ ä¸»ç±»:å…³é”®çš„ä¸€å¥ç¬¬å…«è¡Œ-åœ¨é…ç½®æ–‡ä»¶example.confé‡Œï¼Œå®ä½“åâ€WeatherLoginâ€å°±æ˜¯è¢«MyClient.javaç”¨ä½œå…³è”è¿™ä¸ªå®ä½“çš„åå­—ã€‚è¿™é‡ŒåŒæ—¶è¿˜å°†ä¸€ä¸ªå›è°ƒå¤„ç†ç¨‹åºä¼ ç»™äº†åº•å±‚çš„LoginModuleï¼Œå› æ­¤ä»–ä»¬èƒ½å¤Ÿé€šè¿‡æç¤ºç”¨æˆ·å&#x2F;å¯†ç åŒç”¨æˆ·è¿›è¡Œäº¤æµå’Œä½œç”¨ï¼Œä¾‹å¦‚ï¼šé€šè¿‡æ–‡æœ¬æˆ–è€…å›¾å½¢ç”¨æˆ·æ¥å£ã€‚ä¸€æ—¦LoginContextå·²ç»è¢«å®ä¾‹åŒ–äº†ï¼Œloginæ–¹æ³•å°±è¢«è°ƒç”¨å»ç™»é™†. å›è°ƒç±»:åº•å±‚å®‰å…¨æœåŠ¡å¯èƒ½è¦æ±‚é€šè¿‡ä¼ é€’å•ä¸ªçš„callbacksåˆ°å›è°ƒå¤„ç†ç¨‹åºã€‚åŸºäºä¼ é€’çš„callbacksï¼Œå›è°ƒå¤„ç†ç¨‹åºå†³å®šæ€æ ·å»è·å–å’Œæ˜¾ç¤ºä¿¡æ¯ã€‚ Moduleç±»:çœŸå®çš„æ§åˆ¶æ“ä½œç±» Principal : Principalæ¥å£çš„ä¸€ä¸ªå®ç°ã€‚ é…ç½®æ–‡ä»¶è®¾ç½® LoginContexté€šè¿‡è¯»å–Configurationå»å†³å®šé‚£ä¸ªLoginModuleå°†è¢«ä½¿ç”¨ã€‚ ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼ˆæŒ‡å®šäº†loginé…ç½®æ–‡ä»¶ï¼‰è¿è¡Œå®¢æˆ·ç«¯. å¼•ç”³:å¦‚æœå¼€å¯äº†å®‰å…¨æ¨¡å¼java -Djava.security.manager,éœ€è¦æŒ‡å®šå®‰å…¨ç­–ç•¥çš„ è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤è¿è¡Œ ç»“æŸè¯­: çœ‹çœ‹å°±å¥½äº†,çŸ¥é“æ˜¯ä¸ªå•¥å°±è¡Œäº†,åŸºæœ¬ä¸Šç”¨ä¸ä¸Š","date":"2024-12-31","categories":["java"]},{"title":"java-System.getProperty(xxxx)æ–¹æ³•è§£æƒ‘","url":"/2024/12/31/java-System-getProperty-xxxx-æ–¹æ³•è§£æƒ‘/","content":"System.getProperty(â€œjava.versionâ€) æ–¹æ³•æ˜¯è¾“å‡ºjavaçš„è¿è¡Œç¯å¢ƒå˜é‡(ç³»ç»Ÿå±æ€§)çš„æ–¹æ³• ä¸»è¦å¯ä»¥è¾“å‡ºçš„æ•°æ®æœ‰: java.version Java è¿è¡Œæ—¶ç¯å¢ƒç‰ˆæœ¬java.vendor Java è¿è¡Œæ—¶ç¯å¢ƒä¾›åº”å•†java.vendor.url Java ä¾›åº”å•†çš„ URLjava.home Java å®‰è£…ç›®å½•java.vm.specification.version Java è™šæ‹Ÿæœºè§„èŒƒç‰ˆæœ¬java.vm.specification.vendor Java è™šæ‹Ÿæœºè§„èŒƒä¾›åº”java.vm.specification.name Java è™šæ‹Ÿæœºè§„èŒƒåç§°java.vm.version Java è™šæ‹Ÿæœºå®ç°ç‰ˆæœ¬java.vm.vendor Java è™šæ‹Ÿæœºå®ç°ä¾›åº”å•†java.vm.name Java è™šæ‹Ÿæœºå®ç°åç§°java.specification.version Java è¿è¡Œæ—¶ç¯å¢ƒè§„èŒƒç‰ˆæœ¬java.specification.vendor Java è¿è¡Œæ—¶ç¯å¢ƒè§„èŒƒä¾›åº”å•†java.specification.name Java è¿è¡Œæ—¶ç¯å¢ƒè§„èŒƒåç§°java.class.version Java ç±»æ ¼å¼ç‰ˆæœ¬å·java.class.path Java ç±»è·¯å¾„java.library.path åŠ è½½åº“æ—¶æœç´¢çš„è·¯å¾„åˆ—è¡¨java.io.tmpdir é»˜è®¤çš„ä¸´æ—¶æ–‡ä»¶è·¯å¾„java.compiler è¦ä½¿ç”¨çš„ JIT ç¼–è¯‘å™¨çš„åç§°java.ext.dirs ä¸€ä¸ªæˆ–å¤šä¸ªæ‰©å±•ç›®å½•çš„è·¯å¾„os.name æ“ä½œç³»ç»Ÿçš„åç§°os.arch æ“ä½œç³»ç»Ÿçš„æ¶æ„os.version æ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬file.separator æ–‡ä»¶åˆ†éš”ç¬¦ï¼ˆåœ¨ UNIX ç³»ç»Ÿä¸­æ˜¯â€œ&#x2F;â€ï¼‰path.separator è·¯å¾„åˆ†éš”ç¬¦ï¼ˆåœ¨ UNIX ç³»ç»Ÿä¸­æ˜¯â€œ:â€ï¼‰line.separator è¡Œåˆ†éš”ç¬¦ï¼ˆåœ¨ UNIX ç³»ç»Ÿä¸­æ˜¯â€œ&#x2F;nâ€ï¼‰user.name ç”¨æˆ·çš„è´¦æˆ·åç§°user.home ç”¨æˆ·çš„ä¸»ç›®å½•user.dir ç”¨æˆ·çš„å½“å‰å·¥ä½œç›®å½• javaè¿è¡Œç¯å¢ƒçš„è®¾ç½®æ–¹æ³•å…¶å®æœ¬è´¨ä¸Šå°±æ˜¯ä½¿ç”¨jvmè™šæ‹Ÿæœºæä¾›çš„-Då‚æ•° æ¯”å¦‚è®¾ç½® java -Done.xxx.yyy&#x3D;123 åŠŸèƒ½è§£æ-D&#x3D;valueå®˜ç½‘è§£é‡Šï¼š Set a system property value. If value is a string that contains spaces, you must enclose the string in double quotes:åœ¨è™šæ‹Ÿæœºçš„ç³»ç»Ÿå±æ€§ä¸­è®¾ç½®å±æ€§å&#x2F;å€¼å¯¹ï¼Œè¿è¡Œåœ¨æ­¤è™šæ‹Ÿæœºä¸Šçš„åº”ç”¨ç¨‹åºå¯ç”¨ï¼š å¾—åˆ°valueçš„å€¼ã€‚å¦‚æœvalueä¸­æœ‰ç©ºæ ¼ï¼Œåˆ™éœ€è¦ç”¨åŒå¼•å·å°†è¯¥å€¼æ‹¬èµ·æ¥ï¼Œå¦‚ï¼š-Dname&#x3D;â€kazaf fâ€ è¯¥å‚æ•°é€šå¸¸ç”¨äºè®¾ç½®ç³»ç»Ÿçº§å…¨å±€å˜é‡å€¼ï¼Œå¦‚é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œä¿è¯è¯¥å±æ€§åœ¨ç¨‹åºä¸­ä»»ä½•åœ°æ–¹éƒ½å¯è®¿é—®ã€‚ æ³¨æ„äº‹é¡¹ éœ€è¦è®¾ç½®çš„æ˜¯JVMå‚æ•°è€Œä¸æ˜¯programå‚æ•°ï¼› ä½¿ç”¨æ­¤å‚æ•°çš„å‚æ•°ä¼˜å…ˆçº§æœ€é«˜ï¼Œä¼šè¦†ç›–é¡¹ç›®ä¸­é…ç½®çš„æ­¤é¡¹ï¼›","date":"2024-12-31","categories":["java"]},{"title":"java-classpathçš„ç†è§£","url":"/2024/12/31/java-classpathçš„ç†è§£/","content":"è¿™æ¬¡å†™è¿™ä¸€ç‰‡ç¯‡æ–‡ç« çš„èµ·å› æ˜¯å¯¹è€å¤§æ­å»ºçš„åº•å±‚æ¡†æ¶å­˜åœ¨æ€€ç–‘ç»“æœç„¶åè‡ªå·±ç…§ç€è€å¤§çš„æ–¹æ³•è¿è¡Œç«Ÿç„¶å¯ä»¥æˆåŠŸåŸå› çš„è´¹è§£ã€‚å› æ­¤åœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹è‡ªå·±çš„ç–‘é—®è§£æƒ‘è¿‡ç¨‹ã€‚ classpathåˆ°åº•æ˜¯å•¥æˆ‘çš„ç†è§£classpath å…¶å®æ˜¯ java çš„ä¸€ç§è™šæ‹Ÿçš„æ–‡ä»¶ç›®å½•ç»“æ„ï¼Œjavaé€šè¿‡åŒ…åï¼ˆç›¸å½“äºè·¯å¾„åç§°ï¼‰ï¼Œé’ˆå¯¹æ¯ä¸€ä¸ªclasspathåœ°å€ï¼ˆjavaæ”¯æŒå¤šä¸ªclasspathåœ°å€ï¼‰è¿›è¡Œèµ„æºç®¡ç†çš„ä¸€ç§æŠ½è±¡è·¯å¾„ 1. é’ˆå¯¹äºèµ„æºåŠ è½½æœ€ç›´è§‚æ˜¯æˆ‘åœ¨mybatisä¸­é…ç½®map xmlæ–‡ä»¶è·¯å¾„çš„æ—¶å€™ä¼šåŠ ä¸Š è¿™ä¹ˆåšå°†ä¼šè®©mybatiæ‰€æœ‰æ‰€æœ‰çš„classpatè·¯å¾„ä¸‹çš„å¯¹åº”çš„map&#x2F;ç›®å½•ä¸­çš„æ–‡ä»¶ ä¹Ÿå°±æ˜¯è¯´å¦‚æœjaråŒ…1 ä¸­æœ‰map&#x2F;ç›®å½•ï¼Œå¹¶ä¸”jar2 ä¸­ä¹Ÿæœ‰è¿™ä¸ªç›®å½• jar1 å¼•ç”¨äº†jar2ï¼Œå½“jar1è¿è¡Œçš„æ—¶å€™å¹¶ä¸”jar2åˆåœ¨classpathå½“ä¸­çš„æ—¶å€™å°†ä¼šè‡ªåŠ¨çš„æœç´¢ä¸¤ä¸ªjaråŒ…classpathç›¸å¯¹è·¯å¾„ä¸‹çš„ï¼Œmap&#x2F;ç›®å½•ä¸‹çš„ä¿¡æ¯ æ³¨æ„å¦‚æœä¸¤ä¸ªæ–‡ä»¶åç§°æ˜¯ç›¸åŒçš„ï¼ˆåŒ…æ‹¬classpathå¯¹åº”çš„ç›¸å¯¹è·¯å¾„ï¼‰ï¼Œå°†ä¼šä»¥å…ˆåŠ è½½çš„æ–‡ä»¶ä¼˜å…ˆ 2. å¯¹ä¸å’Œclasså¯¹è±¡åŠ è½½jvmçš„ç±»åŠ è½½åˆ†ä¸‰ä¸­æ–¹å¼ï¼š ç³»ç»Ÿçº§åˆ«ï¼šrt.jar æ‰©å±•çº§åˆ«ï¼šjava_home&#x2F;jre&#x2F;lib&#x2F;ext&#x2F;ç›®å½•ä¸‹çš„jaræ–‡ä»¶ åº”ç”¨çº§åˆ«ï¼šç¯å¢ƒå˜é‡ä¸­çš„classpathæˆ–javac javaä¸­çš„å‚æ•°æŒ‡å®šjava -classpath â€¦ æˆ–è€…è‡ªå·±å†™ClassLoaderåŠ è½½ã€‚ å‰é¢2ä¸­æ˜¯JVMè‡ªåŠ¨å¤„ç†ã€‚å…¶ä¸­ç¬¬äºŒç§æ˜¯ä¸ºäº†å¤„ç†Javaçš„classpathç¾éš¾è€Œæä¾›çš„è§£å†³æ–¹æ¡ˆã€‚ å®é™…ä¸Šjavaè™šæ‹Ÿæœºæ˜¯ç”±java luncheråˆå§‹åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯javaï¼ˆæˆ–java.exeï¼‰è¿™ä¸ªç¨‹åºæ¥åšçš„ã€‚ è™šæ‹ŸæœºæŒ‰ä»¥ä¸‹é¡ºåºæœç´¢å¹¶è£…è½½æ‰€æœ‰éœ€è¦çš„ç±»ï¼š å¼•å¯¼ç±»:ç»„æˆjavaå¹³å°çš„ç±»ï¼ŒåŒ…å«rt.jarå’Œi18n.jarä¸­çš„ç±»ã€‚ æ‰©å±•ç±»ï¼šä½¿ç”¨javaæ‰©å±•æœºåˆ¶çš„ç±»ï¼Œéƒ½æ˜¯ä½äºæ‰©å±•ç›®å½•ï¼ˆ$JAVA_HOME&#x2F;jre&#x2F;lib&#x2F;extï¼‰ä¸­çš„ã€‚jaræ¡£æ¡ˆåŒ…ã€‚ ç”¨æˆ·ç±»:å¼€å‘è€…å®šä¹‰çš„ç±»æˆ–è€…æ²¡æœ‰ä½¿ç”¨javaæ‰©å±•æœºåˆ¶çš„ç¬¬ä¸‰æ–¹äº§å“ã€‚ä½ å¿…é¡»åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨-classpath é€‰é¡¹æˆ–è€…ä½¿ç”¨CLASSPATHç¯å¢ƒå˜é‡æ¥ç¡®å®šè¿™äº›ç±»çš„ä½ç½®ã€‚æˆ‘ä»¬åœ¨ä¸Šé¢æ‰€è¯´çš„ç”¨æˆ·è‡ªå·±çš„ç±»å°±æ˜¯ç‰¹æŒ‡è¿™äº›ç±»ã€‚ è¿™æ ·ï¼Œä¸€èˆ¬æ¥è¯´,ç”¨æˆ·åªéœ€æŒ‡å®šç”¨æˆ·ç±»çš„ä½ç½®ï¼Œå¼•å¯¼ç±»å’Œæ‰©å±•ç±»æ˜¯ â€œè‡ªåŠ¨ â€œå¯»æ‰¾çš„ã€‚å½“ä½ çš„ç¨‹åºéœ€è¦ç¬¬ä¸‰æ–¹çš„ç±»åº“æ”¯æŒï¼Œè€Œä¸”æ¯”è¾ƒå¸¸ç”¨ï¼Œå°±å¯ä»¥é‡‡ç”¨æ­¤ç§æ–¹æ³•ã€‚æ¯”å¦‚å¸¸ç”¨çš„æ•°æ®åº“é©±åŠ¨ç¨‹åºï¼Œå†™servletéœ€è¦çš„servletåŒ…ç­‰ç­‰ã€‚è®¾ç½®æ–¹æ³•å°±æ˜¯åœ¨ç¯å¢ƒå˜é‡ä¸­åŠ å…¥CLASSPATH.ç„¶åå°±å¯ä»¥ç›´æ¥ç¼–è¯‘è¿è¡Œäº†ã€‚è€Œä½ çš„ç¨‹åºåªç”¨äº†äº›åŸºç¡€ç±»ï¼Œå¯»æ‰¾æ—¶ï¼Œå°±ç”¨ä¸ç€å¿…é¡»è®¾å®šå®ƒã€‚ åœ¨æ‰§è¡ŒJavaç¨‹åºçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨åŠ è½½ç¨‹åºç”¨ä¸­éœ€è¦çš„åœ¨rt.jarå’Œå…¶ä»–java_home\\jre\\libä¸­åŒ…å«çš„ã€‚jaræ–‡ä»¶ä¸­åŒ…å«çš„JavaåŸºç¡€ç±»åº“å’Œä¸€äº›æ‰©å±•ç±»åº“ã€‚è¿™äº›éƒ½æ˜¯JVMè‡ªåŠ¨å¤„ç†çš„ï¼Œå¯¹ç”¨æˆ·æ¥è¯´æ˜¯é€æ˜çš„ã€‚ å¦‚æœJavaç¨‹åºä¸­ä½¿ç”¨åˆ°äº†ä¸€äº›åº”ç”¨çº§åˆ«çš„ç±»ï¼ˆå¦‚ç¬¬ä¸‰æ–¹çš„ç±»ï¼‰ï¼Œå¯ä»¥åœ¨javacå’Œjavaä¸­çš„-classpathé€‰é¡¹ä¸­æŒ‡å®šå®ƒä»¬çš„æœç´¢è·¯å¾„ï¼Œæˆ–è€…æ˜¯è‡ªå·±å†™ClassLoaderåŠ è½½ï¼Œå¦å¤–ä¹Ÿå¯ä»¥è®¾ç½®ClassPathç¯å¢ƒå˜é‡ï¼Œåœ¨é‡Œé¢æŒ‡å®šé‚£äº›è¶é˜€åº”ç”¨çº§åˆ«çš„ç±»çš„æœç´¢è·¯å¾„ã€‚ è®¾ç½®ClassPathç¯å¢ƒå˜é‡ä¸æ˜¯å¿…é¡»çš„ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œè®¾ç½®äº†ClassPathï¼ŒJDKå°±ä¼šæŒ‰ClassPathåˆ¶å®šçš„è·¯å¾„å»æœç´¢éœ€è¦çš„åº”ç”¨çº§åˆ«çš„ç±»ï¼Œè€Œä¸å¿…æ¯ä¸€æ¬¡éƒ½ä½¿ç”¨-classpathé€‰é¡¹æˆ–è‡ªå·±å†™ClassLoaderã€‚ è¿˜æœ‰éœ€è¦æ³¨æ„çš„å°±æ˜¯ï¼šå¦‚æœç›¸å…³çš„ç±»å°±åœ¨å½“å‰å·¥ä½œç›®å½•ä¸‹çš„è¯ï¼Œä¸Šé¢3ç§æ–¹æ³•éƒ½å¯ä»¥ä¸è¦ï¼Œå› ä¸ºJDKç³»ç»Ÿä¼šé¦–å…ˆæœç´¢ä¼šåœ¨å½“å‰çš„å·¥ä½œç›®å½•ä¸­æœç´¢ç¨‹åºç›¸å…³çš„ç±»ã€‚ æ³¨æ„å¦‚æœåœ¨classç³»ç»Ÿä¸­ä¸¤ä¸ªç±»ç§°æ˜¯ç›¸åŒçš„ï¼ˆåŒ…å+ç±»åï¼‰ï¼Œå°†ä¼šä»¥å…ˆåŠ è½½çš„ç±»ä¼˜å…ˆ","date":"2024-12-31","categories":["java"]},{"title":"java-io-javaioæ“ä½œçš„å‡½æ•°æ•´ç†","url":"/2024/12/31/java-io-javaioæ“ä½œçš„å‡½æ•°æ•´ç†/","content":"java io æ“ä½œæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„å·¥å…·åŒ…,åŒæ ·ä¹Ÿæ˜¯ç½‘ç»œç¼–ç¨‹å’Œå„ç§æ¡†æ¶ç¼–å†™çš„åŸºæœ¬å‡½æ•°åº“,è¿™é‡Œåšä¸€ä¸‹æ•´ç† java ioçš„å±‚æ¬¡ç»“æ„ è¿™é‡Œå°±å…ˆæ•´ç†ä¸€ä¸‹æˆ‘æœ€é•¿ç”¨çš„å§ BufferReaderå’ŒBufferWriter è¿™ä¸¤ä¸ªæä¾›äº†writer å’Œ readLine çš„åŠŸèƒ½InputStreamReaderå’ŒOutputStreamWriter è¿™ä¸¤ä¸ªæä¾›äº†å­—èŠ‚æµè½¬å­—ç¬¦æµçš„æ–¹æ³•PrintWriter å¯ä»¥ è±¡System.out.println() é‚£æ ·çš„è¾“å…¥æµ","date":"2024-12-31","categories":["java"]},{"title":"java-jaråŒ…æ–‡ä»¶è¯»å–æ–¹æ³•å’Œèµ„æºä½¿ç”¨","url":"/2024/12/31/java-jaråŒ…æ–‡ä»¶è¯»å–æ–¹æ³•å’Œèµ„æºä½¿ç”¨/","content":"","date":"2024-12-31","categories":["java"]},{"title":"java-javaæ€æ ·ä¸€è¡Œä¸€è¡Œçš„è¯»å–å­—ç¬¦ä¸²","url":"/2024/12/31/java-javaæ€æ ·ä¸€è¡Œä¸€è¡Œçš„è¯»å–å­—ç¬¦ä¸²/","content":"æœ€è¿‘å¼€å‘ä¸­é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜,éœ€è¦ä¸€è¡Œä¸€è¡Œçš„è¯»å–å­—ç¬¦ä¸²,è‡ªå·±æƒ³äº†æƒ³æ€»ç»“äº†ä¸¤ç§æ–¹æ³•\\ æ–¹æ³•ä¸€ ä½¿ç”¨Scannerç±» è¿™ç§æ–¹æ³•å°±æ˜¯ä½¿ç”¨äº†Scannerç‰¹æ€§,æ€è·¯æ˜¯å°†å¸¦æ¢è¡Œç¬¦çš„å­—ç¬¦ä¸²æƒ³è±¡æˆèªæ˜è¡Œè¿›è¡Œè¾“å…¥çš„ æ–¹æ³•äºŒ ä½¿ç”¨Readerè¿›è¡Œå¤„ç†","date":"2024-12-31","categories":["java"]},{"title":"java-javaçš„SPIå’ŒAPIè¯¦è§£","url":"/2024/12/31/java-javaçš„SPIå’ŒAPIè¯¦è§£/","content":"api æœºåˆ¶ å¥½è¯´å…¶å®å°±æ˜¯å®šä¹‰ä¸€ä¸ªæ¥å£ç„¶åä½¿ç”¨ä»–çš„ä¸€ä¸ªå®ç°ç±»å»è¿›è¡Œä¸Šè½¬å‹ ä½†æ˜¯ä½¿ç”¨spiåˆ™æ˜¯å¦ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³• SPI å…¨ç§°ä¸º (Service Provider Interface) ,æ˜¯JDKå†…ç½®çš„ä¸€ç§æœåŠ¡æä¾›å‘ç°æœºåˆ¶(ä½¿ç”¨æ¥å£å‘ç°ä»–çš„å®ç°ç±»-ServiceLoader s &#x3D; ServiceLoader.load(Search.class);)ã€‚ ç›®å‰æœ‰ä¸å°‘æ¡†æ¶ç”¨å®ƒæ¥åšæœåŠ¡çš„æ‰©å±•å‘ç°ï¼Œ ç®€å•æ¥è¯´ï¼Œå®ƒå°±æ˜¯ä¸€ç§åŠ¨æ€æ›¿æ¢å‘ç°çš„æœºåˆ¶ï¼Œ ä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼Œ æœ‰ä¸ªæ¥å£ï¼Œæƒ³è¿è¡Œæ—¶åŠ¨æ€çš„ç»™å®ƒæ·»åŠ å®ç°ï¼Œä½ åªéœ€è¦æ·»åŠ ä¸€ä¸ªå®ç°.è€Œåï¼ŒæŠŠæ–°åŠ çš„å®ç°ï¼Œæè¿°ç»™JDKçŸ¥é“å°±è¡Œå•¦ï¼ˆé€šè¿‡æ”¹ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶å³å¯ï¼‰ å…¬å¸å†…éƒ¨ï¼Œç›®å‰Dubboæ¡†æ¶å’Œæ—©æœŸçš„common.logä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚ ä½¿ç”¨çš„ç»“æ„å›¾å¦‚ä¸‹: !()[blogimg&#x2F;1.jpg] å…¶å®ä½¿ç”¨spiçš„æ ¸å¿ƒå°±æ˜¯è¿™ä¸ªé…ç½®æ–‡ä»¶,è¿™ä¸ªé…ç½®æ–‡ä»¶åœ¨jaråŒ…çš„è·¯å¾„å¦‚ä¸‹ æˆ‘ä»¬éƒ½çŸ¥é“vmä½¿ç”¨åŒäº²å§”æ´¾æœºåˆ¶çš„ç±»åŠ è½½å™¨åŠ è½½å„ç§ç±»(ClassLoader A -> System class loader -> Extension class loader -> Bootstrap class loader)åœ¨spi ä¸­,SPI æ¥å£çš„ä»£ç ä¸­ä½¿ç”¨çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨(ä½¿ç”¨ ServiceLoader loaders &#x3D; ServiceLoader.load(æ¥å£åç§°.class);)ï¼Œå°±å¯ä»¥æˆåŠŸçš„åŠ è½½åˆ° SPI å®ç°çš„ç±». å…·ä½“çš„å®ç°è§ä¸‹é¢çš„ä»£ç  çœ‹ä¸€ä¸ªå®ä¾‹ æ¥å£: ä¸‰ä¸ªå®ç°ç±» META-INF&#x2F;services&#x2F;com.liu.spi.IAè¿™ä¸ªæ–‡ä»¶çš„å†…å®¹(å¦‚æœä½¿ç”¨mavenå·¥ç¨‹æ„å»ºåœ¨ src&#x2F;main&#x2F;resources&#x2F;META-INF&#x2F;services&#x2F;com.liu.spi.IAè¿™ä¸ªç›®å½•) è¿è¡Œçš„ä¸»å‡½æ•°","date":"2024-12-31","categories":["java"]},{"title":"java-jvmå¸¸ç”¨å‚æ•°æ•´ç†","url":"/2024/12/31/java-jvmå¸¸ç”¨å‚æ•°æ•´ç†/","content":"å † ï¼Xmså’Œâ€”Xmx å †çš„æœ€å°å€¼ & å †çš„æœ€å¤§å€¼é»˜è®¤å€¼æ˜¯ç‰©ç†å†…å­˜çš„1&#x2F;4(<1GB) & é»˜è®¤å€¼æ˜¯ç‰©ç†å†…å­˜çš„1&#x2F;64(<1GB)ç©ºä½™å †å†…å­˜å°äº40%æ—¶ï¼ŒJVMå°±ä¼šå¢å¤§å †ç›´åˆ°-Xmxçš„æœ€å¤§é™åˆ¶;ç©ºä½™å †å†…å­˜å¤§äº70%æ—¶ï¼ŒJVMä¼šå‡å°‘å †ç›´åˆ° -Xmsçš„æœ€å°é™åˆ¶;é€šå¸¸ä¼šå°† -Xms ä¸ -Xmxä¸¤ä¸ªå‚æ•°é…ç½®ç›¸åŒçš„å€¼ï¼Œç›®çš„æ˜¯ä¸ºäº†èƒ½å¤Ÿåœ¨javaåƒåœ¾å›æ”¶æœºåˆ¶æ¸…ç†å®Œå †åŒºåä¸éœ€è¦é‡æ–°åˆ†éš”è®¡ç®—å †åŒºçš„å¤§å°è€Œæµªè´¹èµ„æºã€‚ æ–°ç”Ÿä»£ -Xmn è®¾ç½®æ–°ç”Ÿä»£å¤§å°ã€‚å€¼ï¼eden+ 2 survivor sunå…¬å¸æ¨èå¤§å°æ•´ä¸ªjavaå †çš„3&#x2F;8 -XX:NewRatio æ–°ç”Ÿä»£ï¼ˆeden+2*Survivorï¼‰å’Œè€å¹´ä»£ï¼ˆä¸åŒ…å«æ°¸ä¹…åŒºï¼‰çš„æ¯”å€¼ -XX:SurvivorRatioï¼ˆå¹¸å­˜ä»£ï¼‰ è®¾ç½®Eden:1ä¸ªSurvivorå†…å­˜ç©ºé—´å¤§å°çš„æ¯”å€¼ -XX:NewSize è®¾ç½®å¹´è½»ä»£å¤§å° -XX:MaxNewSize è®¾ç½®å¹´è½»ä»£æœ€å¤§å€¼ æ ˆ ï¼Xss æ ˆå®¹é‡ï¼ˆpsï¼šï¼Xossç”¨äºè®¾å®šæœ¬åœ°æ–¹æ³•æ ˆå¤§å°ï¼Œä½†æ˜¯å¯¹äºHotSpotæ¥è¯´ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºå…¶ä¸åŒºåˆ†æœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹Ÿæœºæ ˆï¼‰JDK5.0ä»¥åæ¯ä¸ªçº¿ç¨‹å †æ ˆå¤§å°ä¸º1M æ–¹æ³•åŒº ï¼XXï¼šPermSize æ–¹æ³•åŒºå¤§å° ï¼XXï¼šMaxPermSize æœ€å¤§æ–¹æ³•åŒºå¤§å° psï¼šæ–¹æ³•åŒºå¤§å°å’Œæœ€å¤§æ–¹æ³•åŒºå¤§å°é™åˆ¶äº†å¸¸é‡æ± çš„å®¹é‡ å…¶å®ƒ ï¼XXï¼šï¼‹PrintGCDetails æ‰“å°GCæ—¥å¿— ï¼XXï¼šï¼‹&#x2F;-UseTLAB æ˜¯å¦ä½¿ç”¨æœ¬åœ°çº¿ç¨‹åˆ†é…ç¼“å­˜ äº†è§£å‚æ•° -XXThreadStackSize è®¾ç½®çº¿ç¨‹æ ˆçš„å¤§å°(0 means use default stack size) -XXThreadStackSize è®¾ç½®å†…å­˜é¡µçš„å¤§å°ï¼Œä¸å¯è®¾ç½®è¿‡å¤§ï¼Œä¼šå½±å“Permçš„å¤§å° -XX:+UseFastAccessorMethods è®¾ç½®åŸå§‹ç±»å‹çš„å¿«é€Ÿä¼˜åŒ– -XX:+DisableExplicitGCè®¾ç½®å…³é—­System.gc()(è¿™ä¸ªå‚æ•°éœ€è¦ä¸¥æ ¼çš„æµ‹è¯•)-XX:MaxTenuringThresholdè®¾ç½®åƒåœ¾æœ€å¤§å¹´é¾„ã€‚å¦‚æœè®¾ç½®ä¸º0çš„è¯,åˆ™å¹´è½»ä»£å¯¹è±¡ä¸ç»è¿‡SurvivoråŒº,ç›´æ¥è¿›å…¥å¹´è€ä»£. å¯¹äºå¹´è€ä»£æ¯”è¾ƒå¤šçš„åº”ç”¨,å¯ä»¥æé«˜æ•ˆç‡ã€‚å¦‚æœå°†æ­¤å€¼è®¾ç½®ä¸ºä¸€ä¸ªè¾ƒå¤§å€¼,åˆ™å¹´è½»ä»£å¯¹è±¡ä¼šåœ¨SurvivoråŒºè¿›è¡Œå¤šæ¬¡å¤åˆ¶,è¿™æ ·å¯ä»¥å¢åŠ å¯¹è±¡å†å¹´è½»ä»£çš„å­˜æ´»æ—¶é—´,å¢åŠ åœ¨å¹´è½»ä»£å³è¢«å›æ”¶çš„æ¦‚ç‡ã€‚è¯¥å‚æ•°åªæœ‰åœ¨ä¸²è¡ŒGCæ—¶æ‰æœ‰æ•ˆ.-XX:+AggressiveOptsåŠ å¿«ç¼–è¯‘-XX:+UseBiasedLockingé”æœºåˆ¶çš„æ€§èƒ½æ”¹å–„-Xnoclassgcç¦ç”¨åƒåœ¾å›æ”¶-XX:SoftRefLRUPolicyMSPerMBè®¾ç½®æ¯å…†å †ç©ºé—²ç©ºé—´ä¸­SoftReferenceçš„å­˜æ´»æ—¶é—´ï¼Œé»˜è®¤å€¼æ˜¯1s ã€‚ï¼ˆsoftly reachable objects will remain alive for some amount of time after the last time they were referenced. The default value is one second of lifetime per free megabyte in the heapï¼‰-XX:PretenureSizeThresholdè®¾ç½®å¯¹è±¡è¶…è¿‡å¤šå¤§æ—¶ç›´æ¥åœ¨æ—§ç”Ÿä»£åˆ†é…ï¼Œé»˜è®¤å€¼æ˜¯0ã€‚-XX:TLABWasteTargetPercentè®¾ç½®TLABå edenåŒºçš„ç™¾åˆ†æ¯”ï¼Œé»˜è®¤å€¼æ˜¯1% ã€‚-XX:+CollectGen0Firstè®¾ç½®FullGCæ—¶æ˜¯å¦å…ˆYGCï¼Œé»˜è®¤å€¼æ˜¯falseã€‚ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€ŒiCoding91ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚ åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/caoxiaohong1005/article/details/82931474","date":"2024-12-31","categories":["java"]},{"title":"java-webä¹±ç é—®é¢˜è§£å†³","url":"/2024/12/31/java-webä¹±ç é—®é¢˜è§£å†³/","content":"request.setCharacterEncoding(â€œUTF-8â€)&#x2F;&#x2F;ä½œç”¨æ˜¯è®¾ç½®å¯¹å®¢æˆ·ç«¯è¯·æ±‚è¿›è¡Œé‡æ–°ç¼–ç çš„ç¼–ç  è¯¥æ–¹æ³•ç”¨æ¥æŒ‡å®šå¯¹æµè§ˆå™¨å‘é€æ¥çš„æ•°æ®è¿›è¡Œé‡æ–°ç¼–ç ï¼ˆæˆ–è€…ç§°ä¸ºè§£ç ï¼‰æ—¶ï¼Œä½¿ç”¨çš„ç¼–ç ã€‚ response.setCharacterEncoding(â€œUTF-8â€)&#x2F;&#x2F;ä½œç”¨æ˜¯æŒ‡å®šå¯¹æœåŠ¡å™¨å“åº”è¿›è¡Œé‡æ–°ç¼–ç çš„ç¼–ç  æœåŠ¡å™¨åœ¨å°†æ•°æ®å‘é€åˆ°æµè§ˆå™¨å‰ï¼Œå¯¹æ•°æ®è¿›è¡Œé‡æ–°ç¼–ç æ—¶ï¼Œä½¿ç”¨çš„å°±æ˜¯è¯¥ç¼–ç ã€‚","date":"2024-12-31","categories":["java"]},{"title":"java-ä¸€äº›åŸºæœ¬çŸ¥è¯†ç‚¹æ•´ç†","url":"/2024/12/31/java-ä¸€äº›åŸºæœ¬çŸ¥è¯†ç‚¹æ•´ç†/","content":"å­¦ä¹ javaä¸€å®šçš„æ—¶é—´äº†ï¼Œè¿™é‡Œä¸€äº›çŸ¥è¯†ç‚¹çš„æ•´ç† å˜é‡å¿…é¡»æ˜¯å­—æ¯,ä¸‹åˆ’çº¿æˆ–è€…$ç¬¦å¼€å¤´ä¸èƒ½æ˜¯ java å…³é”®å­—å˜é‡å‘½åè§„èŒƒ é©¼å³°å†™æ³•,ç±»é¦–å­—æ¯å¤§å†™é©¼å³°å†™æ³• åŸºæœ¬æ•°æ®ç±»å‹ java è¿ç®—ç¬¦èµ‹å€¼è¿ç®—ç¬¦ : &#x3D;å…³ç³»è¿ç®—ç¬¦ : > , < , >&#x3D; , <&#x3D; , &#x3D;&#x3D; , !&#x3D; , instanceof**é€»è¾‘è¿ç®—ç¬¦** : && , || , !**ä½è¿ç®—ç¬¦** : & , | , ^å¼‚æˆ– , ~é , >> , << , >>>æ¡ä»¶è¿ç®—ç¬¦: ? :æ‰©å±•èµ‹å€¼è¿ç®—ç¬¦ : +&#x3D; , -&#x3D; , *&#x3D; , &#x2F;&#x3D; æµç¨‹æ§åˆ¶è¯­å¥ åŸºç¡€æ–¹æ³• scanner æšä¸¾ç±»å‹ ç®€å•æšä¸¾ç±»å‹ JavaåŒ…æ³¨é‡Š","date":"2024-12-31","categories":["java"]},{"title":"java-ä»AccessController.doPrivilegedçœ‹javaçš„æˆæƒå’Œæ²™ç®±","url":"/2024/12/31/java-ä»AccessController-doPrivilegedçœ‹javaçš„æˆæƒå’Œæ²™ç®±/","content":"è¿™é‡Œä¸»è¦æ˜¯ä»‹ç»javaä»¥ä»£ç ä¸ºæ ¸å¿ƒçš„æˆæƒæ–¹æ³•(è¿˜æœ‰åŸºäºç”¨æˆ·çš„jaasæˆæƒæ–¹æ³•ä¸åšè®¨è®º),è¿™ä¸ªè¿˜æ˜¯æ¯”è¾ƒé‡è¦çš„(å…¶å®æ˜¯çœ‹å¾ˆå¤šæºä»£ç æ¡†æ¶ä½¿ç”¨äº†è¿™ä¸ªæ–¹æ³•,ä¸ºäº†ä¿è¯ä»£ç åœ¨æ²™ç›’ç¯å¢ƒä¸­å¯ä»¥è¿è¡Œ). æƒé™åœ¨Javaå¹³å°å®‰å…¨ä½“ç³»ç»“æ„ä¸­ï¼Œæ‰€æœ‰è®¿é—®æƒé™éƒ½æ˜¯ç±»å‹åŒ–çš„å¹¶ä¸”æœ‰å±‚æ¬¡ç»“æ„ï¼Œå…¶æ ¹æ˜¯æŠ½è±¡ç±» java.security.Permission ã€‚æ ‡å‡†çš„æƒé™ç±»å¤§çº¦æœ‰å¦‚ä¸‹çš„è¿™äº›(ä½¿ç”¨ç±»æ¥æ ‡è®°æƒé™) ç±»å‹ æƒé™å æ“ä½œ ä¾‹å­ æ–‡ä»¶æƒé™ java.io.FilePermission æ–‡ä»¶åï¼ˆå¹³å°ä¾èµ–ï¼‰ è¯»ã€å†™ã€åˆ é™¤ã€æ‰§è¡Œ å…è®¸æ‰€æœ‰é—®ä»·çš„è¯»å†™åˆ é™¤æ‰§è¡Œï¼špermission java.io.FilePermission â€œ<< ALL FILES>>â€, â€œread,write,delete,executeâ€;ã€‚å…è®¸å¯¹ç”¨æˆ·ä¸»ç›®å½•çš„è¯»ï¼špermission java.io.FilePermission â€œ${user.home}&#x2F;-â€œ, â€œreadâ€;ã€‚ å¥—æ¥å­—æƒé™ java.net.SocketPermission ä¸»æœºå:ç«¯å£ æ¥æ”¶ã€ç›‘å¬ã€è¿æ¥ã€è§£æ å…è®¸å®ç°æ‰€æœ‰å¥—æ¥å­—æ“ä½œï¼špermission java.net.SocketPermission â€œ:1-â€œ, â€œaccept,listen,connect,resolveâ€;ã€‚å…è®¸å»ºç«‹åˆ°ç‰¹å®šç½‘ç«™çš„è¿æ¥ï¼špermission java.net.SocketPermission â€œ.abc.com:1-â€œ, â€œconnect,resolveâ€;ã€‚ å±æ€§æƒé™ java.util.PropertyPermission éœ€è¦è®¿é—®çš„jvmå±æ€§å è¯»ã€å†™ è¯»æ ‡å‡†Javaå±æ€§ï¼špermission java.util.PropertyPermission â€œjava.â€œ, â€œreadâ€;ã€‚åœ¨sdoåŒ…ä¸­åˆ›å»ºå±æ€§ï¼špermission java.util.PropertyPermission â€œsdo.â€œ, â€œread,writeâ€;ã€‚ è¿è¡Œæ—¶æƒé™ java.lang.RuntimePermission å¤šç§æƒé™å[è§é™„å½•A] æ—  å…è®¸ä»£ç åˆå§‹åŒ–æ‰“å°ä»»åŠ¡ï¼špermission java.lang.RuntimePermission â€œqueuePrintJobâ€ AWTæƒé™ java.awt.AWTPermission 6ç§æƒé™å[è§é™„å½•B] æ—  å…è®¸ä»£ç å……åˆ†ä½¿ç”¨robotç±»ï¼špermission java.awt.AWTPermission â€œcreateRobotâ€; permission java.awt.AWTPermission â€œreadDisplayPixelsâ€;ã€‚ ç½‘ç»œæƒé™ java.net.NetPermission 3ç§æƒé™å[è§é™„å½•C] æ—  å…è®¸å®‰è£…æµå¤„ç†å™¨ï¼špermission java.net.NetPermission â€œspecifyStreamHandlerâ€;ã€‚ å®‰å…¨æƒé™ java.security.SecurityPermission å¤šç§æƒé™å[è§é™„å½•D] æ—  åºåˆ—åŒ–æƒé™ java.io.SerializablePermission 2ç§æƒé™å[è§é™„å½•E] æ—  åå°„æƒé™ java.lang.reflect.ReflectPermission suppressAccessChecksï¼ˆå…è®¸åˆ©ç”¨åå°„æ£€æŸ¥ä»»æ„ç±»çš„ç§æœ‰å˜é‡ï¼‰ æ—  å®Œå…¨æƒé™ java.security.AllPermission æ— ï¼ˆæ‹¥æœ‰æ‰§è¡Œä»»ä½•æ“ä½œçš„æƒé™ï¼‰ æ—  åœ¨è¿™ç§æ¨¡å¼ä¸‹ jvmçš„æƒé™æ˜¯ç»™ä»£ç çš„(å¯ä»¥è¯´ç±»åæ­£å°±ä»£ç çš„),ä¸€ä¸ªç±»(ä»£ç )å¯ä»¥æœ‰å¤šä¸ªæƒé™(åœ¨$JREHOME&#x2F;lib&#x2F;security&#x2F;java.policyæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ä¸‹é¢è¯´),ä½¿ç”¨PermissionCollectionè¿™æ ·çš„ç±»è¿›è¡Œå°è£…(jvmåœ¨è¿è¡Œçš„æ—¶å€™é€šè¿‡æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆå¥½äº†,ç„¶åé€šè¿‡åå°„è¿›è¡Œæ ¡éªŒè¿™äº›ä¸œè¥¿éƒ½è¢«éšè—èµ·æ¥äº†,ç ”ç©¶ä¸‹å»æ„ä¹‰ä¸å¤§,å°±æ²¡æœ‰æ¥ç€ç ”ç©¶) ä¿æŠ¤åŸŸå’Œä»£ç æº java2 æ˜¯é’ˆå¯¹ä»£ç (å¯¹è±¡ç±»)æ·»åŠ ä¿æŠ¤åŒº,æœ‰ä¸€ä¸ªå†…éƒ¨ç±»ProtectionDomain,é€šè¿‡è¿™ä¸ªç±»æˆæƒè®¿é—®æƒé™,å¦‚æœå¤šä¸ªç±»ä½¿ç”¨åŒä¸€ä¸ªProtectionDomainå°†ä¼šè®¤ä¸ºè¿™ä¸ªæƒé™æ˜¯ç›¸åŒçš„ æ˜¾ç„¶ï¼Œä¸€å®šè¦èƒ½æƒŸä¸€åœ°æ ‡è¯†ä¸€æ®µè¿è¡Œä»£ç ä»¥ä¿è¯å®ƒçš„è®¿é—®æƒé™æ²¡æœ‰å†²çªã€‚è¿è¡Œä»£ç çš„æƒŸä¸€æ ‡è¯†å±æ€§å…±æœ‰ä¸¤é¡¹ï¼šä»£ç çš„æ¥æºï¼ˆä»£ç è£…è½½åˆ°å†…å­˜æ‰€ç”¨çš„ URLï¼‰å’Œä»£ç çš„ signer å®ä½“ï¼ˆç”±å¯¹åº”äºè¿è¡Œä»£ç çš„æ•°å­—ç­¾åçš„ä¸€ç»„å…¬å…±å¯†é’¥æŒ‡å®šï¼‰ã€‚è¿™ä¸¤ç§ç‰¹æ€§çš„ç»„åˆåœ¨ Java 2 å¹³å°å®‰å…¨ä½“ç³»ç»“æ„ä¸­ç¼–å†™ä¸ºç»™å®šè¿è¡Œä»£ç çš„ CodeSource (åœ¨ProtectionDomainå†…éƒ¨å¯ä»¥çœ‹è§è¿™ä¸ªå¯¹è±¡)ã€‚ æƒé™ç”Ÿæˆçš„å…·ä½“è¿‡ç¨‹ Java è¿è¡Œæ—¶é€šè¿‡åä¸º java.security.Policy çš„ç±»ï¼ˆçš„å…·ä½“æ‰©å±•ï¼‰è®¾ç½® ProtectionDomain ä¸æˆäºˆå®ƒçš„æƒé™ä¹‹é—´çš„æ˜ å°„ã€‚ è¿™ä¸ªç±»çš„é»˜è®¤æ‰©å±•æ˜¯ sun.security.provider.PolicyFile ã€‚æ­£å¦‚å…¶åå­—æ‰€è¡¨æ˜çš„ï¼Œ sun.security.provider.PolicyFile ä»ä¸€ä¸ªæ–‡ä»¶ä¸­è·å¾— CodeSource ï¼ˆç”±ä½ç½® URL å’Œ signer æ ‡è¯†åˆ«åï¼‰ä¸æˆäºˆå®ƒçš„æƒé™ä¹‹é—´çš„æ˜ å°„ã€‚ å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ java.security.policy å°†è¿™ä¸ªæ–‡ä»¶çš„ä½ç½®ä½œä¸ºè¾“å…¥æä¾›ç»™ JVMã€‚ Policy ç±»æä¾›äº†ä¸€ä¸ªåä¸º getPermissions() çš„æ–¹æ³•ï¼Œå¯ä»¥è°ƒç”¨å®ƒä»¥è·å¾—æˆäºˆç‰¹å®š CodeSource çš„ä¸€ç»„æƒé™ã€‚ æƒé™åŠ è½½çš„è¿‡ç¨‹ ä¸€ä¸ªç±»ä¸ å…¶ ProtectionDomain ä¹‹é—´çš„æ˜ å°„æ˜¯åœ¨ç±»ç¬¬ä¸€æ¬¡è£…è½½æ—¶è®¾ç½®çš„ï¼Œå¹¶åœ¨ç±»è¢«åƒåœ¾æ”¶é›†ä¹‹å‰ä¸ä¼šæ”¹å˜ã€‚ ä¸€ä¸ªç±»é€šå¸¸æ˜¯ç”±ä¸€ä¸ªåä¸º SecureClassLoader çš„ç‰¹æ®Šç±»è£…è½½çš„ã€‚ SecureClassLoader é¦–å…ˆä»ç›¸åº” URL å¤„è£…è½½å­—èŠ‚ï¼Œå¦‚æœéœ€è¦è¿˜ä¼šéªŒè¯åŒ…å›´æ–‡æ¡£æ–‡ä»¶çš„æ•°å­—ç­¾åã€‚ç„¶åå®ƒè°ƒç”¨ä¸Šè¿° getPermissions() æ–¹æ³•è·å¾—æˆäºˆç±»çš„ CodeSource çš„ä¸€ä¸ªå¡«å……äº†é™æ€ç»‘å®šæƒé™çš„å¼‚ç±» PermissionCollection ã€‚ ç„¶å SecureClassLoader åˆ›å»ºæ–°çš„ ProtectionDomain ï¼Œä¼ é€’ CodeSource åŠå…¶ç›¸å…³çš„æƒé™ä½œä¸ºå…¶æ„é€ å‡½æ•°çš„å‚æ•°ï¼ˆå½“ç„¶ï¼Œè¿™å‡å®šå¯¹äºç»™å®š CodeSource è¿˜ä¸å­˜åœ¨ ProtectionDomain ã€‚å¦‚æœç”¨ä¸€ä¸ªç°æœ‰çš„ CodeSource è£…è½½ç±»ï¼Œé‚£ä¹ˆå°±ä¼šé‡å¤ä½¿ç”¨å®ƒå·²ç»å»ºç«‹çš„ ProtectionDomain ï¼‰ ã€‚ æœ€åï¼Œç”¨è£…è½½çš„ç±»å­—èŠ‚å‘ JVM å®šä¹‰ä¸€ä¸ªç±»ï¼Œå¹¶åœ¨å…³è”çš„ ProtectionDomain ä¸­ç»´æŠ¤ä¸€ä¸ªå¼•ç”¨æŒ‡é’ˆã€‚ æ‰§è¡Œè¿‡ç¨‹ä¸€ä¸ªåä¸º SecurityManager çš„ç±»è´Ÿè´£å®æ–½ç³»ç»Ÿå®‰å…¨ç­–ç•¥ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ä¸å®‰è£…å®‰å…¨ç®¡ç†å™¨ï¼Œå¿…é¡»é€šè¿‡ä¸€ä¸ªåœ¨å¯åŠ¨æ—¶ä¼ é€’ç»™ JVM çš„ã€åä¸º java.security.manager çš„ç¯å¢ƒå˜é‡æ˜¾å¼åœ°æŒ‡å®šã€‚ä»»ä½•åº”ç”¨ç¨‹åºéƒ½å¯æ‰¾åˆ°å®‰è£…çš„ SecurityManager å¹¶è°ƒç”¨å®ƒç›¸åº”çš„ check æ–¹æ³•ã€‚å¦‚æœæ‰€è¦æ±‚çš„æƒé™åœ¨ç»™å®šè¿è¡Œæ—¶ä¸Šä¸‹æ–‡ä¸­æ˜¯æˆäºˆçš„ï¼Œé‚£ä¹ˆè°ƒç”¨å°†æ— å£°åœ°è¿”å›ã€‚å¦‚æœæƒé™æ²¡æœ‰æˆäºˆï¼Œé‚£ä¹ˆå°†æŠ›å‡ºä¸€ä¸ª java.security.AccessControlException ã€‚ Java 2 å¹³å°å®‰å…¨ä½“ç³»ç»“æ„é€šè¿‡å¼•å…¥ä¸€ä¸ªåä¸º AccessController çš„æ–°ç±»ä½¿è¿™ä¸€åˆ‡å˜å¾—ç®€å•äº†ï¼Œå¹¶æ›´å…·æœ‰å¯æ‰©å±•æ€§ã€‚è¿™ä¸ªç±»çš„ç›®çš„ä¸ SecurityManager æ˜¯ä¸€æ ·çš„ï¼Œå³å®ƒè´Ÿè´£åšå‡ºè®¿é—®å†³å®šã€‚å½“ç„¶ï¼Œ ä¸ºäº†å‘åå…¼å®¹æ€§ä¿ç•™äº† SecurityManager ç±»ï¼Œä½†æ˜¯å…¶æ›´æ–°çš„å®ç°å§”æ´¾ç»™äº†åº•å±‚çš„ AccessController ã€‚å¯¹ SecurityManager ç±»è¿›è¡Œçš„æ‰€æœ‰ check æ–¹æ³•è°ƒç”¨éƒ½è§£é‡Šä¸ºç›¸åº”çš„ Permission å¯¹è±¡ï¼Œå¹¶å°†å®ƒä½œä¸ºè¾“å…¥å‚æ•°ä¼ é€’ç»™ AccessController ç±»çš„ checkPermission() æ–¹æ³•ã€‚ æƒé™çš„ç»§æ‰¿å’Œä¼˜åŒ–é—®é¢˜ å¦‚æœè¯´ç±»Aè°ƒç”¨äº†ç±»B,Bè°ƒç”¨äº†ç±»C,é‚£ä¹ˆCçš„æƒé™å°±æ˜¯ABCæƒé™çš„äº¤é›† æœ€ç»ˆèŠ‚-> çœ‹javaçš„AccessController.doPrivileged é€šè¿‡ä¸Šé¢çš„å¼•å­,ç»ˆäºäº†è§£çš„è¿™ä¸ªæ–¹æ³•æ˜¯å¹²å•¥çš„äº†,è¿™ä¸ªæ–¹æ³•å°±æ˜¯è§£å†³è¿™æ ·ä¸€ä¸ªé—®é¢˜,å¦‚æœAè°ƒç”¨äº†B,ä½†æ˜¯Açš„æƒé™å¤ªå°,Bçš„æƒé™å¤ªå¤§å¯¼è‡´,Aå½±å“äº†Bçš„åŠŸèƒ½,è¿™ä¸ªä½¿ç”¨ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•,è¿™ä¸ªæ–¹æ³•å°†ä¼šè®©jvmè¿›è¡Œæƒé™è®¡ç®—çš„æ—¶å€™å°†ä¼šä½¿ç”¨Bæœ€ä¸ºæœ€é¡¶å±‚çš„æƒé™,è¿™ä¸ªæ ·Aæˆ–è€…Aä¹‹å‰çš„æƒé™å°±å¯¹Bå’ŒBä¹‹åçš„ä¸èµ·ä½œç”¨äº† ä¸€ä¸ªç®€å•çš„å°ä¾‹å­ç­–ç•¥æ–‡ä»¶$JREHOME&#x2F;lib&#x2F;security&#x2F;java.policy å‚æ•°æ–‡ä»¶$JREHOME&#x2F;lib&#x2F;security&#x2F;java.security-ç”¨æ¥æŒ‡å®šè¿è¡Œå®‰å…¨æ¨¡å¼ä¸‹çš„å„ç§å‚æ•°(æ¯”å¦‚åœ¨å“ªé‡ŒåŠ è½½ç­–ç•¥æ–‡ä»¶)\\ ä»£ç  å¯åŠ¨å‚æ•°åŠ å…¥-Djava.security.managerä½¿ç”¨å®‰å…¨æ²™ç®±æ¨¡å¼è¿è¡Œ,å°†ä¼šæŠ¥é”™ è¿™æ ·,åœ¨æƒé™æ–‡ä»¶ä¸­æ·»åŠ ä¸€æ¡è¿™æ ·çš„è§„åˆ™ ç„¶åä»£ç å°±é€šè¿‡äº† ç»“è¯­ è¿™ä¸ªç‰¹æ€§æ„Ÿè§‰ä½¿ç”¨çš„åº”è¯¥ä¸å¤š,æ¡†æ¶é‡Œç”¨çš„æŒºå¤š,æ¯”è¾ƒå†·é—¨è®°å½•ä¸€ä¸‹","date":"2024-12-31","categories":["java"]},{"title":"java-ä»javaçº¿ç¨‹æ± æ¥çœ‹javaçš„é˜»å¡é˜Ÿåˆ—","url":"/2024/12/31/java-ä»javaçº¿ç¨‹æ± æ¥çœ‹javaçš„é˜»å¡é˜Ÿåˆ—/","content":"ä¸€è¯´åˆ°javaçš„é˜»å¡é˜Ÿåˆ—ï¼Œæˆ‘ä»¬å°±ä¼šæƒ³åˆ°åœ¨javaçš„jdkä¸­çš„é‚£ä¹ˆå¤šçš„ç±» 1.ArrayDeque, ï¼ˆæ•°ç»„åŒç«¯é˜Ÿåˆ—ï¼‰2.PriorityQueue, ï¼ˆä¼˜å…ˆçº§é˜Ÿåˆ—ï¼‰3.ConcurrentLinkedQueue, ï¼ˆåŸºäºé“¾è¡¨çš„å¹¶å‘é˜Ÿåˆ—ï¼‰4.DelayQueue, ï¼ˆå»¶æœŸé˜»å¡é˜Ÿåˆ—ï¼‰ï¼ˆé˜»å¡é˜Ÿåˆ—å®ç°äº†BlockingQueueæ¥å£ï¼‰5.ArrayBlockingQueue, ï¼ˆåŸºäºæ•°ç»„çš„å¹¶å‘é˜»å¡é˜Ÿåˆ—ï¼‰6.LinkedBlockingQueue, ï¼ˆåŸºäºé“¾è¡¨çš„FIFOé˜»å¡é˜Ÿåˆ—ï¼‰7.LinkedBlockingDeque, ï¼ˆåŸºäºé“¾è¡¨çš„FIFOåŒç«¯é˜»å¡é˜Ÿåˆ—ï¼‰8.PriorityBlockingQueue, ï¼ˆå¸¦ä¼˜å…ˆçº§çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼‰9.SynchronousQueue ï¼ˆå¹¶å‘åŒæ­¥é˜»å¡é˜Ÿåˆ—ï¼‰ è¿™é‡Œä¸å»ç»†è¯´çš„è¿™äº›ä¸œè¥¿ï¼Œè€Œæ˜¯ä»çº¿ç¨‹æ± çš„ä¸€ä¸ªå¼‚å¸¸æ¥èŠèŠè¿™ä¸ªäº‹æƒ… æ„é€ ä¸€ä¸ªçº¿ç¨‹æ± å¼‚å¸¸ - çº¿ç¨‹æ± è¿‡è½½å¼‚å¸¸ è¿™æ®µä»£ç å¦‚æœç›´æ¥è¿è¡Œå°†ä¼šæŠ›å‡ºå¼‚å¸¸ æ€»ç»“ä¸€ä¸‹ï¼š å…¶å®è¿™ä¸ªé—®é¢˜æ˜¯åŠ å…¥çš„çº¿ç¨‹æ•°é‡å·²ç»è¶…è¿‡äº†æ•´ä¸ªçº¿ç¨‹æ± èƒ½è´Ÿè½½çš„æœ€å¤§æ•°é‡äº†ï¼ˆæ–°å»ºçº¿ç¨‹æ± çš„æ—¶å€™ä½¿ç”¨äº†æœ‰ç•Œé˜Ÿåˆ—ï¼‰ï¼Œæ‰€ä»¥æŠ›å‡ºäº†äº†å¼‚å¸¸ é¿å…çº¿ç¨‹æ± æº¢å‡ºå¼‚å¸¸ - ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—å’Œæœ‰ç•Œé˜Ÿåˆ— BlockingQueue è¿™ä¸ªæ˜¯ä¸ºäº†è§£å†³javaå¹¶å‘åŒæ­¥é—®é¢˜çš„ï¼Œæœ¬è´¨ä¸Šæ˜¯è§£å†³çº¿ç¨‹é—´æ¶ˆæ¯åŒæ­¥è€Œè®¾è®¡çš„ æœ‰ä¸€ä¸‹å‡ ä¸ªç±»ï¼š 1.DelayQueue, ï¼ˆå»¶æœŸé˜»å¡é˜Ÿåˆ—ï¼‰ï¼ˆé˜»å¡é˜Ÿåˆ—å®ç°äº†BlockingQueueæ¥å£ï¼‰ è¿™ä¸ªé˜Ÿåˆ—æ˜¯æ— ç•Œçš„ï¼Œå¹¶ä¸”æ²¡æœ‰æŒ‡å®šé•¿åº¦çš„æ„é€ æ–¹æ³•2.ArrayBlockingQueue, ï¼ˆåŸºäºæ•°ç»„çš„å¹¶å‘é˜»å¡é˜Ÿåˆ—ï¼‰ å¿…é¡»è®¾ç½®é•¿åº¦3.LinkedBlockingQueue, ï¼ˆåŸºäºé“¾è¡¨çš„FIFOé˜»å¡é˜Ÿåˆ—ï¼‰ æ²¡æœ‰æŒ‡å®šé•¿åº¦å°±æ˜¯æœ‰ç•Œçš„åä¹‹æ˜¯æœ‰ç•Œçš„4.LinkedBlockingDeque, ï¼ˆåŸºäºé“¾è¡¨çš„FIFOåŒç«¯é˜»å¡é˜Ÿåˆ—ï¼‰ æ²¡æœ‰æŒ‡å®šé•¿åº¦å°±æ˜¯æœ‰ç•Œçš„åä¹‹æ˜¯æœ‰ç•Œçš„5.PriorityBlockingQueue, ï¼ˆå¸¦ä¼˜å…ˆçº§çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼‰ è¿™ä¸ªåªèƒ½ä¼ å…¥Comperableæ¥å£çš„ç±»æ–°ï¼Œä¸æ˜¯æœ‰ç•Œçš„6.SynchronousQueue ï¼ˆå¹¶å‘åŒæ­¥é˜»å¡é˜Ÿåˆ—ï¼‰ä¸èƒ½æŒ‡å®šé•¿åº¦ï¼Œåªèƒ½ä¼ å…¥ä¸€ä¸ªå€¼ï¼Œæœ‰ç•Œ å›è¿‡æ¥çœ‹çœ‹ä¸Šé¢çš„æºç ï¼Œå…¶å®çº¿ç¨‹æ± åœ¨åŠ å…¥çº¿ç¨‹æ—¶å€™çš„é€»è¾‘æ˜¯è¿™æ ·çš„ æ„å»ºå¸¸é©»çº¿ç¨‹coreNumæŒ‡å®šï¼Œå¦‚æœè¶…è¿‡ï¼Œå»ºç«‹ä¸´æ—¶çº¿ç¨‹maxNum , è¿˜ä¸å¤Ÿï¼Œå¢åŠ åˆ°é˜Ÿåˆ—ä¸­ çº¿ç¨‹æ± åˆ¤æ–­èƒ½ä¸èƒ½å¢åŠ ä»…å¯¹åˆ—æ˜¯ä½¿ç”¨çš„é˜Ÿåˆ—çš„offsetæ–¹æ³• å¦‚æœæ˜¯æœ‰ç•Œçš„é˜Ÿåˆ—å…šå¯¹åˆ—æ»¡äº†è‡ªç„¶è¿”å›falseï¼Œå› ä¸ºæ·»åŠ ä¸è¿›å»äº†ï¼Œç„¶åå°±ä¼šæŠ›å‡ºå¼‚å¸¸ æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬åœ¨ä½¿ç”¨javaçº¿ç¨‹æ± çš„æ—¶å€™éœ€è¦åšå¥½å®¹é‡è§„åˆ’ï¼Œå¦‚æœæ— æ³•ç¡®å®šæ˜¯å¦è¶…å‡ºäº†æŒ‡å®šçš„çº¿ç¨‹æ•°é‡ï¼Œå¯ä»¥ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—ï¼Œä½†æ˜¯è¦æ³¨æ„åˆ°é˜²æ­¢å†…å­˜æ³„æ¼","date":"2024-12-31","categories":["java"]},{"title":"java-å…³äºsystem.gc()ä¸finalize()æ–¹æ³•","url":"/2024/12/31/java-å…³äºsystem-gc--ä¸finalize--æ–¹æ³•/","content":"1. finalizeçš„ä½œç”¨ finalize()æ˜¯Objectçš„protectedæ–¹æ³•ï¼Œå­ç±»å¯ä»¥è¦†ç›–è¯¥æ–¹æ³•ä»¥å®ç°èµ„æºæ¸…ç†å·¥ä½œï¼ŒGCåœ¨å›æ”¶å¯¹è±¡ä¹‹å‰è°ƒç”¨è¯¥æ–¹æ³•ã€‚ finalize()ä¸C++ä¸­çš„ææ„å‡½æ•°ä¸æ˜¯å¯¹åº”çš„ã€‚C++ä¸­çš„ææ„å‡½æ•°è°ƒç”¨çš„æ—¶æœºæ˜¯ç¡®å®šçš„ï¼ˆå¯¹è±¡ç¦»å¼€ä½œç”¨åŸŸæˆ–deleteæ‰ï¼‰ï¼Œä½†Javaä¸­çš„finalizeçš„è°ƒç”¨å…·æœ‰ä¸ç¡®å®šæ€§ ä¸å»ºè®®ç”¨finalizeæ–¹æ³•å®Œæˆâ€œéå†…å­˜èµ„æºâ€çš„æ¸…ç†å·¥ä½œï¼Œä½†å»ºè®®ç”¨äºï¼šâ‘  æ¸…ç†æœ¬åœ°å¯¹è±¡(é€šè¿‡JNIåˆ›å»ºçš„å¯¹è±¡)ï¼›â‘¡ ä½œä¸ºç¡®ä¿æŸäº›éå†…å­˜èµ„æº(å¦‚Socketã€æ–‡ä»¶ç­‰)é‡Šæ”¾çš„ä¸€ä¸ªè¡¥å……ï¼šåœ¨finalizeæ–¹æ³•ä¸­æ˜¾å¼è°ƒç”¨å…¶ä»–èµ„æºé‡Šæ”¾æ–¹æ³•ã€‚å…¶åŸå› å¯è§ä¸‹æ–‡[finalizeçš„é—®é¢˜] 2. finalizeçš„é—®é¢˜ ä¸€äº›ä¸finalizeç›¸å…³çš„æ–¹æ³•ï¼Œç”±äºä¸€äº›è‡´å‘½çš„ç¼ºé™·ï¼Œå·²ç»è¢«åºŸå¼ƒäº†ï¼Œå¦‚System.runFinalizersOnExit()æ–¹æ³•ã€Runtime.runFinalizersOnExit()æ–¹æ³•System.gc()ä¸System.runFinalization()æ–¹æ³•å¢åŠ äº†finalizeæ–¹æ³•æ‰§è¡Œçš„æœºä¼šï¼Œä½†ä¸å¯ç›²ç›®ä¾èµ–å®ƒä»¬ Javaè¯­è¨€è§„èŒƒå¹¶ä¸ä¿è¯finalizeæ–¹æ³•ä¼šè¢«åŠæ—¶åœ°æ‰§è¡Œã€è€Œä¸”æ ¹æœ¬ä¸ä¼šä¿è¯å®ƒä»¬ä¼šè¢«æ‰§è¡Œfinalizeæ–¹æ³•å¯èƒ½ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ã€‚å› ä¸ºJVMé€šå¸¸åœ¨å•ç‹¬çš„ä½ä¼˜å…ˆçº§çº¿ç¨‹ä¸­å®Œæˆfinalizeçš„æ‰§è¡Œå¯¹è±¡å†ç”Ÿé—®é¢˜ï¼šfinalizeæ–¹æ³•ä¸­ï¼Œå¯å°†å¾…å›æ”¶å¯¹è±¡èµ‹å€¼ç»™GC Rootså¯è¾¾çš„å¯¹è±¡å¼•ç”¨ï¼Œä»è€Œè¾¾åˆ°å¯¹è±¡å†ç”Ÿçš„ç›®çš„ finalizeæ–¹æ³•è‡³å¤šç”±GCæ‰§è¡Œä¸€æ¬¡ä¸”åªæ‰§è¡Œä¸€æ¬¡(ç”¨æˆ·å½“ç„¶å¯ä»¥æ‰‹åŠ¨è°ƒç”¨å¯¹è±¡çš„finalizeæ–¹æ³•ï¼Œä½†å¹¶ä¸å½±å“GCå¯¹finalizeçš„è¡Œä¸º) 3. finalizeçš„æ‰§è¡Œè¿‡ç¨‹(ç”Ÿå‘½å‘¨æœŸ)æè¿°ä¸€ä¸‹finalizeæµç¨‹ï¼š å½“å¯¹è±¡å˜æˆ(GC Roots)ä¸å¯è¾¾æ—¶ï¼ŒGCä¼šåˆ¤æ–­è¯¥å¯¹è±¡æ˜¯å¦è¦†ç›–äº†finalizeæ–¹æ³•ï¼Œè‹¥æœªè¦†ç›–ï¼Œåˆ™ç›´æ¥å°†å…¶å›æ”¶ã€‚å¦åˆ™ï¼Œè‹¥å¯¹è±¡æœªæ‰§è¡Œè¿‡finalizeæ–¹æ³•ï¼Œå°†å…¶æ”¾å…¥F-Queueé˜Ÿåˆ—ï¼Œç”±ä¸€ä½ä¼˜å…ˆçº§çº¿ç¨‹æ‰§è¡Œè¯¥é˜Ÿåˆ—ä¸­å¯¹è±¡çš„finalizeæ–¹æ³•ã€‚ æ‰§è¡Œfinalizeæ–¹æ³•å®Œæ¯•åï¼ŒGCä¼šå†æ¬¡åˆ¤æ–­è¯¥å¯¹è±¡æ˜¯å¦å¯è¾¾ï¼Œè‹¥ä¸å¯è¾¾ï¼Œåˆ™è¿›è¡Œå›æ”¶ï¼Œå¦åˆ™ï¼Œå¯¹è±¡â€œå¤æ´»â€ã€‚ å…·ä½“çš„finalizeæµç¨‹ï¼š å¯¹è±¡å¯ç”±ä¸¤ç§çŠ¶æ€æ§åˆ¶ï¼Œæ¶‰åŠåˆ°ä¸¤ç±»çŠ¶æ€ç©ºé—´ï¼Œä¸€æ˜¯ç»ˆç»“çŠ¶æ€ç©ºé—´ F &#x3D; {unfinalized, finalizable, finalized}ï¼›äºŒæ˜¯å¯è¾¾çŠ¶æ€ç©ºé—´ R &#x3D; {reachable, finalizer-reachable, unreachable}ã€‚ å„çŠ¶æ€å«ä¹‰å¦‚ä¸‹ï¼š unfinalized: æ–°å»ºå¯¹è±¡ä¼šå…ˆè¿›å…¥æ­¤çŠ¶æ€ï¼ŒGCå¹¶æœªå‡†å¤‡æ‰§è¡Œå…¶finalizeæ–¹æ³•ï¼Œå› ä¸ºè¯¥å¯¹è±¡æ˜¯å¯è¾¾çš„ finalizable: è¡¨ç¤ºGCå¯å¯¹è¯¥å¯¹è±¡æ‰§è¡Œfinalizeæ–¹æ³•ï¼ŒGCå·²æ£€æµ‹åˆ°è¯¥å¯¹è±¡ä¸å¯è¾¾ã€‚æ­£å¦‚å‰é¢æ‰€è¿°ï¼ŒGCé€šè¿‡F-Queueé˜Ÿåˆ—å’Œä¸€ä¸“ç”¨çº¿ç¨‹å®Œæˆfinalizeçš„æ‰§è¡Œ finalized: è¡¨ç¤ºGCå·²ç»å¯¹è¯¥å¯¹è±¡æ‰§è¡Œè¿‡finalizeæ–¹æ³• reachable: è¡¨ç¤ºGC Rootså¼•ç”¨å¯è¾¾ finalizer-reachable(f-reachable)ï¼šè¡¨ç¤ºä¸æ˜¯reachableï¼Œä½†å¯é€šè¿‡æŸä¸ªfinalizableå¯¹è±¡å¯è¾¾ unreachableï¼šå¯¹è±¡ä¸å¯é€šè¿‡ä¸Šé¢ä¸¤ç§é€”å¾„å¯è¾¾ çŠ¶æ€å˜è¿å›¾ï¼š å˜è¿è¯´æ˜ï¼š æ–°å»ºå¯¹è±¡é¦–å…ˆå¤„äº[reachable, unfinalized]çŠ¶æ€(A) éšç€ç¨‹åºçš„è¿è¡Œï¼Œä¸€äº›å¼•ç”¨å…³ç³»ä¼šæ¶ˆå¤±ï¼Œå¯¼è‡´çŠ¶æ€å˜è¿ï¼Œä»reachableçŠ¶æ€å˜è¿åˆ°f-reachable(B, C, D)æˆ–unreachable(E, F)çŠ¶æ€ è‹¥JVMæ£€æµ‹åˆ°å¤„äºunfinalizedçŠ¶æ€çš„å¯¹è±¡å˜æˆf-reachableæˆ–unreachableï¼ŒJVMä¼šå°†å…¶æ ‡è®°ä¸ºfinalizableçŠ¶æ€(G,H)ã€‚è‹¥å¯¹è±¡åŸå¤„äº[unreachable, unfinalized]çŠ¶æ€ï¼Œåˆ™åŒæ—¶å°†å…¶æ ‡è®°ä¸ºf-reachable(H)ã€‚ åœ¨æŸä¸ªæ—¶åˆ»ï¼ŒJVMå–å‡ºæŸä¸ªfinalizableå¯¹è±¡ï¼Œå°†å…¶æ ‡è®°ä¸ºfinalizedå¹¶åœ¨æŸä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œå…¶finalizeæ–¹æ³•ã€‚ç”±äºæ˜¯åœ¨æ´»åŠ¨çº¿ç¨‹ä¸­å¼•ç”¨äº†è¯¥å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°†å˜è¿åˆ°(reachable, finalized)çŠ¶æ€(Kæˆ–J)ã€‚è¯¥åŠ¨ä½œå°†å½±å“æŸäº›å…¶ä»–å¯¹è±¡ä»f-reachableçŠ¶æ€é‡æ–°å›åˆ°reachableçŠ¶æ€(L, M, N) å¤„äºfinalizableçŠ¶æ€çš„å¯¹è±¡ä¸èƒ½åŒæ—¶æ˜¯unreachableçš„ï¼Œç”±ç¬¬4ç‚¹å¯çŸ¥ï¼Œå°†å¯¹è±¡finalizableå¯¹è±¡æ ‡è®°ä¸ºfinalizedæ—¶ä¼šç”±æŸä¸ªçº¿ç¨‹æ‰§è¡Œè¯¥å¯¹è±¡çš„finalizeæ–¹æ³•ï¼Œè‡´ä½¿å…¶å˜æˆreachableã€‚è¿™ä¹Ÿæ˜¯å›¾ä¸­åªæœ‰å…«ä¸ªçŠ¶æ€ç‚¹çš„åŸå›  ç¨‹åºå‘˜æ‰‹åŠ¨è°ƒç”¨finalizeæ–¹æ³•å¹¶ä¸ä¼šå½±å“åˆ°ä¸Šè¿°å†…éƒ¨æ ‡è®°çš„å˜åŒ–ï¼Œå› æ­¤JVMåªä¼šè‡³å¤šè°ƒç”¨finalizeä¸€æ¬¡ï¼Œå³ä½¿è¯¥å¯¹è±¡â€œå¤æ´»â€ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ç¨‹åºå‘˜æ‰‹åŠ¨è°ƒç”¨å¤šå°‘æ¬¡ä¸å½±å“JVMçš„è¡Œä¸º è‹¥JVMæ£€æµ‹åˆ°finalizedçŠ¶æ€çš„å¯¹è±¡å˜æˆunreachableï¼Œå›æ”¶å…¶å†…å­˜(I) è‹¥å¯¹è±¡å¹¶æœªè¦†ç›–finalizeæ–¹æ³•ï¼ŒJVMä¼šè¿›è¡Œä¼˜åŒ–ï¼Œç›´æ¥å›æ”¶å¯¹è±¡ï¼ˆOï¼‰ æ³¨ï¼šSystem.runFinalizersOnExit()ç­‰æ–¹æ³•å¯ä»¥ä½¿å¯¹è±¡å³ä½¿å¤„äºreachableçŠ¶æ€ï¼ŒJVMä»å¯¹å…¶æ‰§è¡Œfinalizeæ–¹æ³• æ„æ€çš„ç¤ºä¾‹ä»£ç  å¯¹è±¡å¤æ´» æ³¨æ„ï¼šä¹‹æ‰€ä»¥åªèƒ½è¿›è¡Œä¸€æ¬¡çš„åŸå› æ˜¯å¯¹è±¡çš„ä¸¤ä¸ªçŠ¶æ€å·²ç»æ”¹å˜äº†ä¸èƒ½æ”¹å˜å›æ¥äº† jdkå†…éƒ¨ä¸€äº›åŒ…å°±æ˜¯ä½¿ç”¨è¿™ä¸­æ–¹æ³•è¿›è¡Œèµ„æºçš„é‡Šæ”¾çš„ è¦†ç›–finalizeæ–¹æ³•ä»¥ç¡®ä¿èµ„æºé‡Šæ”¾ ä½œä¸ºä¸€ä¸ªè¡¥å……æ“ä½œï¼Œä»¥é˜²ç”¨æˆ·å¿˜è®°â€œå…³é—­â€œèµ„æºï¼ŒJDKä¸­FileInputStreamã€FileOutputStreamã€Connectionç±»å‡ç”¨äº†æ­¤â€æŠ€æœ¯â€œï¼Œä¸‹é¢ä»£ç æ‘˜è‡ªFileInputStreamç±»","date":"2024-12-31","categories":["java"]},{"title":"java-å››ç§å¼•ç”¨çš„å·®åˆ«å’Œä½¿ç”¨åœºæ™¯","url":"/2024/12/31/java-å››ç§å¼•ç”¨çš„å·®åˆ«å’Œä½¿ç”¨åœºæ™¯/","content":"ä¸€.äº†è§£ å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨çš„æ¦‚å¿µåœ¨Javaä¸­ï¼Œè™½ç„¶ä¸éœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨å»ç®¡ç†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œä½†æ˜¯å¦‚æœå¸Œæœ›æŸäº›å¯¹è±¡å…·å¤‡ä¸€å®šçš„ç”Ÿå‘½å‘¨æœŸçš„è¯ï¼ˆæ¯”å¦‚å†…å­˜ä¸è¶³æ—¶JVMå°±ä¼šè‡ªåŠ¨å›æ”¶æŸäº›å¯¹è±¡ä»è€Œé¿å…OutOfMemoryçš„é”™è¯¯ï¼‰å°±éœ€è¦ç”¨åˆ°è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨äº†ã€‚ ä»Java SE2å¼€å§‹ï¼Œå°±æä¾›äº†å››ç§ç±»å‹çš„å¼•ç”¨ï¼šå¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨å’Œè™šå¼•ç”¨ã€‚Javaä¸­æä¾›è¿™å››ç§å¼•ç”¨ç±»å‹ä¸»è¦æœ‰ä¸¤ä¸ªç›®çš„ï¼šç¬¬ä¸€æ˜¯å¯ä»¥è®©ç¨‹åºå‘˜é€šè¿‡ä»£ç çš„æ–¹å¼å†³å®šæŸäº›å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼›ç¬¬äºŒæ˜¯æœ‰åˆ©äºJVMè¿›è¡Œåƒåœ¾å›æ”¶ã€‚ä¸‹é¢æ¥é˜è¿°ä¸€ä¸‹è¿™å››ç§ç±»å‹å¼•ç”¨çš„æ¦‚å¿µï¼š 1.å¼ºå¼•ç”¨ï¼ˆStrongReferenceï¼‰å¼ºå¼•ç”¨å°±æ˜¯æŒ‡åœ¨ç¨‹åºä»£ç ä¹‹ä¸­æ™®éå­˜åœ¨çš„ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ä¸­çš„objectå’Œstréƒ½æ˜¯å¼ºå¼•ç”¨ï¼š åªè¦æŸä¸ªå¯¹è±¡æœ‰å¼ºå¼•ç”¨ä¸ä¹‹å…³è”ï¼ŒJVMå¿…å®šä¸ä¼šå›æ”¶è¿™ä¸ªå¯¹è±¡ï¼Œå³ä½¿åœ¨å†…å­˜ä¸è¶³çš„æƒ…å†µä¸‹ï¼ŒJVMå®æ„¿æŠ›å‡ºOutOfMemoryé”™è¯¯ä¹Ÿä¸ä¼šå›æ”¶è¿™ç§å¯¹è±¡ã€‚æ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼š å½“è¿è¡Œè‡³Object[] objArr &#x3D; new Object[1000];è¿™å¥æ—¶ï¼Œå¦‚æœå†…å­˜ä¸è¶³ï¼ŒJVMä¼šæŠ›å‡ºOOMé”™è¯¯ä¹Ÿä¸ä¼šå›æ”¶objectæŒ‡å‘çš„å¯¹è±¡ã€‚ä¸è¿‡è¦æ³¨æ„çš„æ˜¯ï¼Œå½“fun1è¿è¡Œå®Œä¹‹åï¼Œobjectå’ŒobjArréƒ½å·²ç»ä¸å­˜åœ¨äº†ï¼Œæ‰€ä»¥å®ƒä»¬æŒ‡å‘çš„å¯¹è±¡éƒ½ä¼šè¢«JVMå›æ”¶ã€‚ å¦‚æœæƒ³ä¸­æ–­å¼ºå¼•ç”¨å’ŒæŸä¸ªå¯¹è±¡ä¹‹é—´çš„å…³è”ï¼Œå¯ä»¥æ˜¾ç¤ºåœ°å°†å¼•ç”¨èµ‹å€¼ä¸ºnullï¼Œè¿™æ ·ä¸€æ¥çš„è¯ï¼ŒJVMåœ¨åˆé€‚çš„æ—¶é—´å°±ä¼šå›æ”¶è¯¥å¯¹è±¡ã€‚ æ¯”å¦‚Vectorç±»çš„clearæ–¹æ³•ä¸­å°±æ˜¯é€šè¿‡å°†å¼•ç”¨èµ‹å€¼ä¸ºnullæ¥å®ç°æ¸…ç†å·¥ä½œçš„ï¼š 2.è½¯å¼•ç”¨ï¼ˆSoftReferenceï¼‰è½¯å¼•ç”¨æ˜¯ç”¨æ¥æè¿°ä¸€äº›æœ‰ç”¨ä½†å¹¶ä¸æ˜¯å¿…éœ€çš„å¯¹è±¡ï¼Œåœ¨Javaä¸­ç”¨java.lang.ref.SoftReferenceç±»æ¥è¡¨ç¤ºã€‚å¯¹äºè½¯å¼•ç”¨å…³è”ç€çš„å¯¹è±¡ï¼Œåªæœ‰åœ¨å†…å­˜ä¸è¶³çš„æ—¶å€™JVMæ‰ä¼šå›æ”¶è¯¥å¯¹è±¡ã€‚å› æ­¤ï¼Œè¿™ä¸€ç‚¹å¯ä»¥å¾ˆå¥½åœ°ç”¨æ¥è§£å†³OOMçš„é—®é¢˜ï¼Œå¹¶ä¸”è¿™ä¸ªç‰¹æ€§å¾ˆé€‚åˆç”¨æ¥å®ç°ç¼“å­˜ï¼šæ¯”å¦‚ç½‘é¡µç¼“å­˜ã€å›¾ç‰‡ç¼“å­˜ç­‰ã€‚ è½¯å¼•ç”¨å¯ä»¥å’Œä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ï¼Œå¦‚æœè½¯å¼•ç”¨æ‰€å¼•ç”¨çš„å¯¹è±¡è¢«JVMå›æ”¶ï¼Œè¿™ä¸ªè½¯å¼•ç”¨å°±ä¼šè¢«åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ç¤ºä¾‹ï¼š 3.å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰å¼±å¼•ç”¨ä¹Ÿæ˜¯ç”¨æ¥æè¿°éå¿…éœ€å¯¹è±¡çš„ï¼Œå½“JVMè¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œæ— è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå›æ”¶è¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡ã€‚åœ¨javaä¸­ï¼Œç”¨java.lang.ref.WeakReferenceç±»æ¥è¡¨ç¤ºã€‚ä¸‹é¢æ˜¯ä½¿ç”¨ç¤ºä¾‹ï¼š è¾“å‡ºç»“æœä¸ºï¼š ç¬¬äºŒä¸ªè¾“å‡ºç»“æœæ˜¯nullï¼Œè¿™è¯´æ˜åªè¦JVMè¿›è¡Œåƒåœ¾å›æ”¶ï¼Œè¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡å¿…å®šä¼šè¢«å›æ”¶æ‰ã€‚ä¸è¿‡è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ‰€è¯´çš„è¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡æ˜¯æŒ‡åªæœ‰å¼±å¼•ç”¨ä¸ä¹‹å…³è”ï¼Œå¦‚æœå­˜åœ¨å¼ºå¼•ç”¨åŒæ—¶ä¸ä¹‹å…³è”ï¼Œåˆ™è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ä¹Ÿä¸ä¼šå›æ”¶è¯¥å¯¹è±¡ï¼ˆè½¯å¼•ç”¨ä¹Ÿæ˜¯å¦‚æ­¤ï¼‰ã€‚ å¼±å¼•ç”¨å¯ä»¥å’Œä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ï¼Œå¦‚æœå¼±å¼•ç”¨æ‰€å¼•ç”¨çš„å¯¹è±¡è¢«JVMå›æ”¶ï¼Œè¿™ä¸ªè½¯å¼•ç”¨å°±ä¼šè¢«åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚ 4.è™šå¼•ç”¨ï¼ˆPhantomReferenceï¼‰è™šå¼•ç”¨å’Œå‰é¢çš„è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ä¸åŒï¼Œå®ƒå¹¶ä¸å½±å“å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚åœ¨javaä¸­ç”¨java.lang.ref.PhantomReferenceç±»è¡¨ç¤ºã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸è™šå¼•ç”¨å…³è”ï¼Œåˆ™è·Ÿæ²¡æœ‰å¼•ç”¨ä¸ä¹‹å…³è”ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚ è¦æ³¨æ„çš„æ˜¯ï¼Œè™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ—å…³è”ä½¿ç”¨ï¼Œå½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹ å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚ç¨‹åºå¯ä»¥é€šè¿‡åˆ¤æ–­å¼•ç”¨é˜Ÿåˆ—ä¸­æ˜¯å¦å·²ç»åŠ å…¥äº†è™šå¼•ç”¨ï¼Œæ¥äº†è§£è¢«å¼•ç”¨çš„å¯¹è±¡æ˜¯å¦å°†è¦è¢«åƒåœ¾å›æ”¶ã€‚å¦‚æœç¨‹åºå‘ç°æŸä¸ªè™šå¼•ç”¨å·²ç»è¢«åŠ å…¥åˆ°å¼•ç”¨é˜Ÿåˆ—ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨æ‰€å¼•ç”¨çš„å¯¹è±¡çš„å†…å­˜è¢«å›æ”¶ä¹‹å‰é‡‡å–å¿…è¦çš„è¡ŒåŠ¨ã€‚ äºŒ.è¿›ä¸€æ­¥ç†è§£è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨å¯¹äºå¼ºå¼•ç”¨ï¼Œæˆ‘ä»¬å¹³æ—¶åœ¨ç¼–å†™ä»£ç æ—¶ç»å¸¸ä¼šç”¨åˆ°ã€‚è€Œå¯¹äºå…¶ä»–ä¸‰ç§ç±»å‹çš„å¼•ç”¨ï¼Œä½¿ç”¨å¾—æœ€å¤šçš„å°±æ˜¯è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨ï¼Œè¿™2ç§æ—¢æœ‰ç›¸ä¼¼ä¹‹å¤„åˆæœ‰åŒºåˆ«ã€‚å®ƒä»¬éƒ½æ˜¯ç”¨æ¥æè¿°éå¿…éœ€å¯¹è±¡çš„ï¼Œä½†æ˜¯è¢«è½¯å¼•ç”¨å…³è”çš„å¯¹è±¡åªæœ‰åœ¨å†…å­˜ä¸è¶³æ—¶æ‰ä¼šè¢«å›æ”¶ï¼Œè€Œè¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡åœ¨JVMè¿›è¡Œåƒåœ¾å›æ”¶æ—¶æ€»ä¼šè¢«å›æ”¶ã€‚ åœ¨SoftReferenceç±»ä¸­ï¼Œæœ‰ä¸‰ä¸ªæ–¹æ³•ï¼Œä¸¤ä¸ªæ„é€ æ–¹æ³•å’Œä¸€ä¸ªgetæ–¹æ³•ï¼ˆWekReferenceç±»ä¼¼ï¼‰ï¼š ä¸¤ä¸ªæ„é€ æ–¹æ³•ï¼š getæ–¹æ³•ç”¨æ¥è·å–ä¸è½¯å¼•ç”¨å…³è”çš„å¯¹è±¡çš„å¼•ç”¨ï¼Œå¦‚æœè¯¥å¯¹è±¡è¢«å›æ”¶äº†ï¼Œåˆ™è¿”å›nullã€‚ åœ¨ä½¿ç”¨è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾ç¤ºåœ°é€šè¿‡System.gc()æ¥é€šçŸ¥JVMè¿›è¡Œåƒåœ¾å›æ”¶ï¼Œä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶å‘å‡ºäº†é€šçŸ¥ï¼ŒJVMä¸ä¸€å®šä¼šç«‹åˆ»æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´è¿™å¥æ˜¯æ— æ³•ç¡®ä¿æ­¤æ—¶JVMä¸€å®šä¼šè¿›è¡Œåƒåœ¾å›æ”¶çš„ã€‚ ä¸‰.å¦‚ä½•åˆ©ç”¨è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨è§£å†³OOMé—®é¢˜å‰é¢è®²äº†å…³äºè½¯å¼•ç”¨å’Œå¼±å¼•ç”¨ç›¸å…³çš„åŸºç¡€çŸ¥è¯†ï¼Œé‚£ä¹ˆåˆ°åº•å¦‚ä½•åˆ©ç”¨å®ƒä»¬æ¥ä¼˜åŒ–ç¨‹åºæ€§èƒ½ï¼Œä»è€Œé¿å…OOMçš„é—®é¢˜å‘¢ï¼Ÿ ä¸‹é¢ä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚æœ‰ä¸€ä¸ªåº”ç”¨éœ€è¦è¯»å–å¤§é‡çš„æœ¬åœ°å›¾ç‰‡ï¼Œå¦‚æœæ¯æ¬¡è¯»å–å›¾ç‰‡éƒ½ä»ç¡¬ç›˜è¯»å–ï¼Œåˆ™ä¼šä¸¥é‡å½±å“æ€§èƒ½ï¼Œä½†æ˜¯å¦‚æœå…¨éƒ¨åŠ è½½åˆ°å†…å­˜å½“ä¸­ï¼Œåˆæœ‰å¯èƒ½é€ æˆå†…å­˜æº¢å‡ºï¼Œæ­¤æ—¶ä½¿ç”¨è½¯å¼•ç”¨å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ è®¾è®¡æ€è·¯æ˜¯ï¼šç”¨ä¸€ä¸ªHashMapæ¥ä¿å­˜å›¾ç‰‡çš„è·¯å¾„ å’Œ ç›¸åº”å›¾ç‰‡å¯¹è±¡å…³è”çš„è½¯å¼•ç”¨ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼Œåœ¨å†…å­˜ä¸è¶³æ—¶ï¼ŒJVMä¼šè‡ªåŠ¨å›æ”¶è¿™äº›ç¼“å­˜å›¾ç‰‡å¯¹è±¡æ‰€å ç”¨çš„ç©ºé—´ï¼Œä»è€Œæœ‰æ•ˆåœ°é¿å…äº†OOMçš„é—®é¢˜ã€‚åœ¨Androidå¼€å‘ä¸­å¯¹äºå¤§é‡å›¾ç‰‡ä¸‹è½½ä¼šç»å¸¸ç”¨åˆ°ã€‚","date":"2024-12-31","categories":["java"]},{"title":"java-åœ¨æ–‡ä»¶ä¸­è¿½åŠ æ•°æ®çš„æ–¹æ³•","url":"/2024/12/31/java-åœ¨æ–‡ä»¶ä¸­è¿½åŠ æ•°æ®çš„æ–¹æ³•/","content":"","date":"2024-12-31","categories":["java"]},{"title":"java-å¼‚å¸¸å¤„ç†-æ›´ä¼˜é›…çš„å…³é—­èµ„æº","url":"/2024/12/31/java-å¼‚å¸¸å¤„ç†-æ›´ä¼˜é›…çš„å…³é—­èµ„æº/","content":"ä¼ ç»Ÿçš„èµ„æºå…³é—­æ–¹å¼ä¸ºäº†ç¡®ä¿å¤–éƒ¨èµ„æºä¸€å®šè¦è¢«å…³é—­ï¼Œé€šå¸¸å…³é—­ä»£ç è¢«å†™å…¥finallyä»£ç å—ä¸­ï¼Œå½“ç„¶æˆ‘ä»¬è¿˜å¿…é¡»æ³¨æ„åˆ°å…³é—­èµ„æºæ—¶å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ï¼Œäºæ˜¯å˜æœ‰äº†ä¸‹é¢çš„ç»å…¸ä»£ç ï¼š è¿™ç§æ–¹æ³•æä¾›ç»Ÿä¸€çš„å…¥å£å°†ç›¸å…³çš„èµ„æºå…³é—­åŠŸèƒ½å¦‚c++çš„ææ„å‡½æ•°ç­‰ï¼Œä¸ç¬¦åˆé¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ–¹æ³• JDK7åŠå…¶ä¹‹åçš„èµ„æºå…³é—­æ–¹å¼ try-with-resourceè¯­æ³• ç¡®å®ï¼Œåœ¨JDK7ä»¥å‰ï¼ŒJavaæ²¡æœ‰è‡ªåŠ¨å…³é—­å¤–éƒ¨èµ„æºçš„è¯­æ³•ç‰¹æ€§ï¼Œç›´åˆ°JDK7ä¸­æ–°å¢äº†try-with-resourceè¯­æ³•ï¼Œæ‰å®ç°äº†è¿™ä¸€åŠŸèƒ½,å°±æ˜¯å½“ä¸€ä¸ªå¤–éƒ¨èµ„æºçš„å¥æŸ„å¯¹è±¡ï¼ˆæ¯”å¦‚FileInputStreamå¯¹è±¡ï¼‰å®ç°äº†AutoCloseableæ¥å£ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†ä¸Šé¢çš„æ¿å¼ä»£ç ç®€åŒ–ä¸ºå¦‚ä¸‹å½¢å¼ï¼š å°†å¤–éƒ¨èµ„æºçš„å¥æŸ„å¯¹è±¡çš„åˆ›å»ºæ”¾åœ¨tryå…³é”®å­—åé¢çš„æ‹¬å·ä¸­ï¼Œå½“è¿™ä¸ªtry-catchä»£ç å—æ‰§è¡Œå®Œæ¯•åï¼ŒJavaä¼šç¡®ä¿å¤–éƒ¨èµ„æºçš„closeæ–¹æ³•è¢«è°ƒç”¨ã€‚ä»£ç æ˜¯ä¸æ˜¯ç¬é—´ç®€æ´è®¸å¤šï¼ å®ç°åŸç†try-with-resourceå¹¶ä¸æ˜¯JVMè™šæ‹Ÿæœºçš„æ–°å¢åŠŸèƒ½ï¼Œåªæ˜¯JDKå®ç°äº†ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå½“ä½ å°†ä¸Šé¢ä»£ç åç¼–è¯‘åä¼šå‘ç°ï¼Œå…¶å®å¯¹JVMè™šæ‹Ÿæœºè€Œè¨€ï¼Œå®ƒçœ‹åˆ°çš„ä¾ç„¶æ˜¯ä¹‹å‰çš„å†™æ³•ï¼š å¼•ç”³: å¼‚å¸¸æŠ‘åˆ¶ é€šè¿‡åç¼–è¯‘çš„ä»£ç ï¼Œå¤§å®¶å¯èƒ½æ³¨æ„åˆ°ä»£ç ä¸­æœ‰ä¸€å¤„å¯¹å¼‚å¸¸çš„ç‰¹æ®Šå¤„ç†ï¼š è¿™æ˜¯try-with-resourceè¯­æ³•æ¶‰åŠçš„å¦å¤–ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œå«åšå¼‚å¸¸æŠ‘åˆ¶ã€‚å½“å¯¹å¤–éƒ¨èµ„æºè¿›è¡Œå¤„ç†ï¼ˆä¾‹å¦‚è¯»æˆ–å†™ï¼‰æ—¶ï¼Œå¦‚æœé­é‡äº†å¼‚å¸¸ï¼Œä¸”åœ¨éšåçš„å…³é—­å¤–éƒ¨èµ„æºè¿‡ç¨‹ä¸­ï¼Œåˆé­é‡äº†å¼‚å¸¸ï¼Œé‚£ä¹ˆä½ catchåˆ°çš„å°†ä¼šæ˜¯å¯¹å¤–éƒ¨èµ„æºè¿›è¡Œå¤„ç†æ—¶é­é‡çš„å¼‚å¸¸ï¼Œå…³é—­èµ„æºæ—¶é­é‡çš„å¼‚å¸¸å°†è¢«â€œæŠ‘åˆ¶â€ä½†ä¸æ˜¯ä¸¢å¼ƒï¼Œé€šè¿‡å¼‚å¸¸çš„getSuppressedæ–¹æ³•ï¼Œå¯ä»¥æå–å‡ºè¢«æŠ‘åˆ¶çš„å¼‚å¸¸ã€‚ æ€»ç»“ å½“ä¸€ä¸ªå¤–éƒ¨èµ„æºçš„å¥æŸ„å¯¹è±¡å®ç°äº†AutoCloseableæ¥å£ï¼ŒJDK7ä¸­ä¾¿å¯ä»¥åˆ©ç”¨try-with-resourceè¯­æ³•æ›´ä¼˜é›…çš„å…³é—­èµ„æºï¼Œæ¶ˆé™¤æ¿å¼ä»£ç ã€‚ try-with-resourceæ—¶ï¼Œå¦‚æœå¯¹å¤–éƒ¨èµ„æºçš„å¤„ç†å’Œå¯¹å¤–éƒ¨èµ„æºçš„å…³é—­å‡é­é‡äº†å¼‚å¸¸ï¼Œâ€œå…³é—­å¼‚å¸¸â€å°†è¢«æŠ‘åˆ¶ï¼Œâ€œå¤„ç†å¼‚å¸¸â€å°†è¢«æŠ›å‡ºï¼Œä½†â€œå…³é—­å¼‚å¸¸â€å¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯å­˜æ”¾åœ¨â€œå¤„ç†å¼‚å¸¸â€çš„è¢«æŠ‘åˆ¶çš„å¼‚å¸¸åˆ—è¡¨ä¸­ã€‚","date":"2024-12-31","categories":["java"]},{"title":"java-å¼‚å¸¸å¤„ç†-è‡ªå®šä¹‰å¼‚å¸¸","url":"/2024/12/31/java-å¼‚å¸¸å¤„ç†-è‡ªå®šä¹‰å¼‚å¸¸/","content":"å­¦ä¹ javaæ„Ÿè§‰ï¼Œjavaçš„å¼‚å¸¸å¤„ç†æœºåˆ¶å¼‚å¸¸çš„å¼ºå¤§ï¼Œä¸ºç¨‹åºçš„ç¼–å†™å’Œè°ƒè¯•æä¾›çš„æ–¹ä¾¿å¿«æ·çš„é”™è¯¯æç¤ºåŠŸèƒ½ï¼Œå¯ä»¥èŠ‚çœå¤§é‡çš„æ—¶é—´ã€‚ç³»ç»Ÿå†…ç½®çš„å¼‚å¸¸å°±ä¸è®°å½•äº†ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹æ€æ ·è‡ªå®šä¹‰å¼‚å¸¸ ä¸€.åˆ›å»ºå¼‚å¸¸ç±» ç»§æ‰¿Exceptionç±»å¹¶ä¸”æ˜¯æƒ³ç›¸å…³çš„æœ‰å‚æ„é€ å‡½æ•° äºŒ.ä½¿ç”¨è‡ªå®šä¹‰çš„å¼‚å¸¸ç±» ä½¿ç”¨throw æŠ›å‡ºè‡ªå®šä¹‰çš„å¼‚å¸¸ ä¸‰.åœ¨å…¶ä»–ç±»ä¸­è¿›è¡Œç›‘å¬æŠ›å‡ºçš„å¼‚å¸¸ å¼‚å¸¸ç±»ä¸­çš„.printStackTrace();å°†ä¼šæ‰“å°å‡ºå¼‚å¸¸å †æ ˆ .getMessage();å°†ä¼šæ‰“å°å‡ºå¼‚å¸¸æè¿°ä¹Ÿå°±æ˜¯è‡ªå·±å®šä¹‰çš„ç±»ä¸­ä¼ å…¥çš„å­—ç¬¦ä¸² å››.æ€»ç»“1.è‡ªå®šä¹‰å¼‚å¸¸ 2.æ ‡è¯†å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ï¼ˆç”¨åœ¨æ–¹æ³•ä¸Šé¢ï¼‰ 3.æ•è·å¼‚å¸¸ 4.å¼‚å¸¸çš„è§£é‡Š è°ƒç”¨å¼‚å¸¸ç±»çš„ç›¸å…³æ–¹æ³• äº”.å¼•ç”³ java7 ä¹‹åtry-catch è¯­å¥å°†ä¼šè‡ªåŠ¨çš„å…³é—­ç›¸å…³çš„èµ„æº,å‰ææ˜¯ç›¸å…³ç±»å¿…é¡»å®ç°AutoCloseableæˆ–è€…Closeableæ¥å£å’Œå®ç°å…¶ä¸­çš„close()æ–¹æ³•æœ¬è´¨ä¸Šæ˜¯ä¸€ç§è§‚å¯Ÿè€…æ¨¡å¼","date":"2024-12-31","categories":["java"]},{"title":"java-å¼‚å¸¸å¤„ç†-è¯¦è§£","url":"/2024/12/31/java-å¼‚å¸¸å¤„ç†-è¯¦è§£/","content":"å¼‚å¸¸çš„ä½“ç³»ç»“æ„JavaæŠŠå¼‚å¸¸å½“ä½œå¯¹è±¡æ¥å¤„ç†ï¼Œå¹¶å®šä¹‰ä¸€ä¸ªåŸºç±»java.lang.Throwableä½œä¸ºæ‰€æœ‰å¼‚å¸¸çš„è¶…ç±»ã€‚ åœ¨Java APIä¸­å·²ç»å®šä¹‰äº†è®¸å¤šå¼‚å¸¸ç±»ï¼Œè¿™äº›å¼‚å¸¸ç±»åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œé”™è¯¯Errorå’Œå¼‚å¸¸Exceptionã€‚ Javaå¼‚å¸¸å±‚æ¬¡ç»“æ„å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºæ‰€æœ‰å¼‚å¸¸ç±»å‹éƒ½æ˜¯å†…ç½®ç±»Throwableçš„å­ç±»ï¼Œå› è€ŒThrowableåœ¨å¼‚å¸¸ç±»çš„å±‚æ¬¡ç»“æ„çš„é¡¶å±‚ã€‚ æ¥ä¸‹æ¥Throwableåˆ†æˆäº†ä¸¤ä¸ªä¸åŒçš„åˆ†æ”¯ï¼Œä¸€ä¸ªåˆ†æ”¯æ˜¯Errorï¼Œå®ƒè¡¨ç¤ºä¸å¸Œæœ›è¢«ç¨‹åºæ•è·æˆ–è€…æ˜¯ç¨‹åºæ— æ³•å¤„ç†çš„é”™è¯¯ã€‚å¦ä¸€ä¸ªåˆ†æ”¯æ˜¯Exceptionï¼Œå®ƒè¡¨ç¤ºç”¨æˆ·ç¨‹åºå¯èƒ½æ•æ‰çš„å¼‚å¸¸æƒ…å†µæˆ–è€…è¯´æ˜¯ç¨‹åºå¯ä»¥å¤„ç†çš„å¼‚å¸¸ã€‚å…¶ä¸­å¼‚å¸¸ç±»Exceptionåˆåˆ†ä¸ºè¿è¡Œæ—¶å¼‚å¸¸(RuntimeException)å’Œéè¿è¡Œæ—¶å¼‚å¸¸ã€‚ Javaå¼‚å¸¸åˆå¯ä»¥åˆ†ä¸ºä¸å—æ£€æŸ¥å¼‚å¸¸ï¼ˆUnchecked Exceptionï¼‰å’Œæ£€æŸ¥å¼‚å¸¸ï¼ˆChecked Exceptionï¼‰ã€‚ ä¸‹é¢å°†è¯¦ç»†è®²è¿°è¿™äº›å¼‚å¸¸ä¹‹é—´çš„åŒºåˆ«ä¸è”ç³»ï¼š Errorï¼šErrorç±»å¯¹è±¡ç”± Java è™šæ‹Ÿæœºç”Ÿæˆå¹¶æŠ›å‡ºï¼Œå¤§å¤šæ•°é”™è¯¯ä¸ä»£ç ç¼–å†™è€…æ‰€æ‰§è¡Œçš„æ“ä½œæ— å…³ã€‚å¦‚Javaè™šæ‹Ÿæœºè¿è¡Œé”™è¯¯ï¼ˆVirtual MachineErrorï¼‰ï¼Œå†…å­˜ä¸è¶³é”™è¯¯OutOfMemoryErrorã€‚è¿™äº›å¼‚å¸¸å‘ç”Ÿæ—¶ï¼ŒJavaè™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸€èˆ¬ä¼šé€‰æ‹©çº¿ç¨‹ç»ˆæ­¢ï¼›è¿˜æœ‰å‘ç”Ÿåœ¨è™šæ‹Ÿæœºè¯•å›¾æ‰§è¡Œåº”ç”¨æ—¶ï¼Œå¦‚ç±»å®šä¹‰é”™è¯¯ï¼ˆNoClassDefFoundErrorï¼‰ã€é“¾æ¥é”™è¯¯ï¼ˆLinkageErrorï¼‰ã€‚è¿™äº›é”™è¯¯æ˜¯ä¸å¯æŸ¥çš„ï¼Œå› ä¸ºå®ƒä»¬åœ¨åº”ç”¨ç¨‹åºçš„æ§åˆ¶å’Œå¤„ç†èƒ½åŠ›ä¹‹å¤–ï¼Œè€Œä¸”ç»å¤§å¤šæ•°æ˜¯ç¨‹åºè¿è¡Œæ—¶ä¸å…è®¸å‡ºç°çš„çŠ¶å†µã€‚å¯¹äºè®¾è®¡åˆç†çš„åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œå³ä½¿ç¡®å®å‘ç”Ÿäº†é”™è¯¯ï¼Œæœ¬è´¨ä¸Šä¹Ÿä¸åº”è¯¥è¯•å›¾å»å¤„ç†å®ƒæ‰€å¼•èµ·çš„å¼‚å¸¸çŠ¶å†µã€‚åœ¨Javaä¸­ï¼Œé”™è¯¯é€šå¸¸æ˜¯ä½¿ç”¨Errorçš„å­ç±»æè¿°ã€‚ Exceptionï¼šåœ¨Exceptionåˆ†æ”¯ä¸­æœ‰ä¸€ä¸ªé‡è¦çš„å­ç±»RuntimeExceptionï¼ˆè¿è¡Œæ—¶å¼‚å¸¸ï¼‰ï¼Œè¯¥ç±»å‹çš„å¼‚å¸¸è‡ªåŠ¨ä¸ºä½ æ‰€ç¼–å†™çš„ç¨‹åºå®šä¹‰ArrayIndexOutOfBoundsExceptionï¼ˆæ•°ç»„ä¸‹æ ‡è¶Šç•Œï¼‰ã€NullPointerExceptionï¼ˆç©ºæŒ‡é’ˆå¼‚å¸¸ï¼‰ã€ArithmeticExceptionï¼ˆç®—æœ¯å¼‚å¸¸ï¼‰ã€MissingResourceExceptionï¼ˆä¸¢å¤±èµ„æºï¼‰ã€ClassNotFoundExceptionï¼ˆæ‰¾ä¸åˆ°ç±»ï¼‰ç­‰å¼‚å¸¸ï¼Œè¿™äº›å¼‚å¸¸æ˜¯ä¸æ£€æŸ¥å¼‚å¸¸ï¼Œç¨‹åºä¸­å¯ä»¥é€‰æ‹©æ•è·å¤„ç†ï¼Œä¹Ÿå¯ä»¥ä¸å¤„ç†ã€‚è¿™äº›å¼‚å¸¸ä¸€èˆ¬æ˜¯ç”±ç¨‹åºé€»è¾‘é”™è¯¯å¼•èµ·çš„ï¼Œç¨‹åºåº”è¯¥ä»é€»è¾‘è§’åº¦å°½å¯èƒ½é¿å…è¿™ç±»å¼‚å¸¸çš„å‘ç”Ÿï¼›è€ŒRuntimeExceptionä¹‹å¤–çš„å¼‚å¸¸æˆ‘ä»¬ç»Ÿç§°ä¸ºéè¿è¡Œæ—¶å¼‚å¸¸ï¼Œç±»å‹ä¸Šå±äºExceptionç±»åŠå…¶å­ç±»ï¼Œä»ç¨‹åºè¯­æ³•è§’åº¦è®²æ˜¯å¿…é¡»è¿›è¡Œå¤„ç†çš„å¼‚å¸¸ï¼Œå¦‚æœä¸å¤„ç†ï¼Œç¨‹åºå°±ä¸èƒ½ç¼–è¯‘é€šè¿‡ã€‚å¦‚IOExceptionã€SQLExceptionç­‰ä»¥åŠç”¨æˆ·è‡ªå®šä¹‰çš„Exceptionå¼‚å¸¸ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸è‡ªå®šä¹‰æ£€æŸ¥å¼‚å¸¸ã€‚ æ³¨æ„ï¼šErrorå’ŒExceptionçš„åŒºåˆ«ï¼šErroré€šå¸¸æ˜¯ç¾éš¾æ€§çš„è‡´å‘½çš„é”™è¯¯ï¼Œæ˜¯ç¨‹åºæ— æ³•æ§åˆ¶å’Œå¤„ç†çš„ï¼Œå½“å‡ºç°è¿™äº›å¼‚å¸¸æ—¶ï¼ŒJavaè™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸€èˆ¬ä¼šé€‰æ‹©ç»ˆæ­¢çº¿ç¨‹ï¼›Exceptioné€šå¸¸æƒ…å†µä¸‹æ˜¯å¯ä»¥è¢«ç¨‹åºå¤„ç†çš„ï¼Œå¹¶ä¸”åœ¨ç¨‹åºä¸­åº”è¯¥å°½å¯èƒ½çš„å»å¤„ç†è¿™äº›å¼‚å¸¸ã€‚ é™¤äº†RuntimeExceptionåŠå…¶å­ç±»ä»¥å¤–ï¼Œå…¶ä»–çš„Exceptionç±»åŠå…¶å­ç±»éƒ½å±äºæ£€æŸ¥å¼‚å¸¸ï¼Œå½“ç¨‹åºä¸­å¯èƒ½å‡ºç°è¿™ç±»å¼‚å¸¸ï¼Œè¦ä¹ˆä½¿ç”¨try-catchè¯­å¥è¿›è¡Œæ•è·ï¼Œè¦ä¹ˆç”¨throwså­å¥æŠ›å‡ºï¼Œå¦åˆ™ç¼–è¯‘æ— æ³•é€šè¿‡ã€‚ ä¸å—æ£€æŸ¥å¼‚å¸¸ï¼šåŒ…æ‹¬RuntimeExceptionåŠå…¶å­ç±»å’ŒErrorã€‚ å¼‚å¸¸æŠ‘åˆ¶(çœ‹ä¸‹é¢è¿™æ®µä»£ç ) å¤§å®¶å¯èƒ½æ³¨æ„åˆ°ä»£ç ä¸­æœ‰ä¸€å¤„å¯¹å¼‚å¸¸çš„ç‰¹æ®Šå¤„ç†ï¼š è¿™æ˜¯try-with-resourceè¯­æ³•æ¶‰åŠçš„å¦å¤–ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œå«åšå¼‚å¸¸æŠ‘åˆ¶ã€‚å½“å¯¹å¤–éƒ¨èµ„æºè¿›è¡Œå¤„ç†ï¼ˆä¾‹å¦‚è¯»æˆ–å†™ï¼‰æ—¶ï¼Œå¦‚æœé­é‡äº†å¼‚å¸¸ï¼Œä¸”åœ¨éšåçš„å…³é—­å¤–éƒ¨èµ„æºè¿‡ç¨‹ä¸­ï¼Œåˆé­é‡äº†å¼‚å¸¸ï¼Œé‚£ä¹ˆä½ catchåˆ°çš„å°†ä¼šæ˜¯å¯¹å¤–éƒ¨èµ„æºè¿›è¡Œå¤„ç†æ—¶é­é‡çš„å¼‚å¸¸ï¼Œå…³é—­èµ„æºæ—¶é­é‡çš„å¼‚å¸¸å°†è¢«â€œæŠ‘åˆ¶â€ä½†ä¸æ˜¯ä¸¢å¼ƒï¼Œé€šè¿‡å¼‚å¸¸çš„getSuppressedæ–¹æ³•ï¼Œå¯ä»¥æå–å‡ºè¢«æŠ‘åˆ¶çš„å¼‚å¸¸ã€‚ java try catch finally åŸºæœ¬å¼‚å¸¸æ¨¡å‹ finally ä¸­å¦‚æœæœ‰return å°†ä¼šå‘ç”Ÿä»€ä¹ˆç¨‹åºå°†è¿”å›finallyä¸­çš„è¿”å›å€¼ï¼Œå¦‚æœå­˜åœ¨finallyä»£ç å—ï¼Œtryä¸­çš„returnè¯­å¥ä¸ä¼šç«‹é©¬è¿”å›è°ƒç”¨è€…ï¼Œè€Œæ˜¯è®°å½•ä¸‹è¿”å›å€¼å¾…finallyä»£ç å—æ‰§è¡Œå®Œæ¯•ä¹‹åå†å‘è°ƒç”¨è€…è¿”å›å…¶å€¼ï¼Œç„¶åå¦‚æœåœ¨finallyä¸­ä¿®æ”¹äº†è¿”å›å€¼ï¼Œå°±ä¼šè¿”å›ä¿®æ”¹åçš„å€¼ã€‚","date":"2024-12-31","categories":["java"]},{"title":"java-æ—¶é—´å¤„ç†å¤ä»¤æ—¶å†¬ä»¤æ—¶è·¨æ—¶åŒºé—®é¢˜å¤„ç†","url":"/2024/12/31/java-æ—¶é—´å¤„ç†å¤ä»¤æ—¶å†¬ä»¤æ—¶è·¨æ—¶åŒºé—®é¢˜å¤„ç†/","content":"ä½œä¸ºä¸€ä¸ªæˆç†Ÿçš„ç¼–ç¨‹è¯­è¨€ï¼Œjavaè‡ªç„¶æœ‰ä¸€å †æ–¹æ³•æ¥è§£å†³çš„æ—¶é—´çš„é—®é¢˜ã€‚æœ‰çš„æ—¶å€™æˆ‘ä»¬ä¼šå› ä¸ºå¯¹javaä¸€äº›å†…ç½®çš„apiä¸æ˜¯å¤ªç†Ÿæ‚‰ï¼Œå¯¹æŸä¸ªåœºæ™¯ä¸ç†Ÿæ‚‰ï¼Œå¯¼è‡´é‡åˆ°äº†æ£˜æ‰‹çš„é—®é¢˜ã€‚æ¯”å¦‚è¿™ä¸ªåœºæ™¯å¤ä»¤æ—¶å’Œå†¬ä»¤æ—¶ å¤ä»¤æ—¶å’Œå†¬ä»¤æ—¶åœ¨åšå…¨çƒæ€§çš„åŠŸèƒ½æ—¶ç»å¯¹å°‘ä¸äº†é‡åˆ°æ—¶åŒºè½¬åŒ–ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨æ—¶é—´æˆ³+javaå†…ç½®çš„apiå°±èƒ½è§£å†³99%çš„é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœé‡åˆ°å¤ä»¤æ—¶æˆ–è€…å†¬ä»¤æ—¶çš„æ—¶å€™è¿™ä¸ªé—®é¢˜å°±å¯èƒ½å˜å¾—ä¸æ˜¯è¿™ä¹ˆå®¹æ˜“ã€‚ é¦–å…ˆè®°å½•ä¸€ä¸‹ä»€ä¹ˆæ˜¯å¤ä»¤æ—¶å’Œå†¬ä»¤æ—¶ï¼šç®€å•çš„è¯´åœ¨è¿™ä¸ªä¸–ç•Œä¸Šçš„æŸäº›å›½å®¶ä¼šè§„å®šåœ¨æŸä¸ªæ—¥æœŸå°†æœ¬å›½æ‰€åœ¨çš„æ—¶åŒºå‘ç”Ÿæ”¹å˜ï¼Œç„¶ååœ¨æŸä¸ªæ—¶é—´å°†ä»–æ”¹å›æ¥ï¼Œè¿›è¡Œæ”¹å˜çš„æ—¥æœŸå°±æ˜¯å¤ä»¤æ—¶æˆ–è€…å†¬ä»¤æ—¶ æ³¨æ„ï¼šè¿™ä¸ªæ¦‚å¿µæ·±å±‚æ¬¡çš„ä¸œè¥¿å¯ä»¥è‡ªè¡Œç”¨æœç´¢å¼•æ“æŸ¥æ‰¾ç›¸å…³å†…å®¹ï¼Œæˆ‘è¿™é‡Œæ²¡æœ‰ç”¨å…¶ä»–äººçš„é‚£ç§è§£é‡Šæ¯”å¦‚å¤ä»¤æ—¶å°±æ˜¯æŠŠè¡¨è°ƒå¿«ä¸€å°æ—¶ï¼Œè€Œæ˜¯ä½¿ç”¨ä¿®æ­£æ—¶åŒºè¿™ä¸ªæ¦‚å¿µï¼Œè¿™ä¹ˆåšæ˜¯ä¸ºäº†æ–¹ä¾¿åšä¸‹é¢çš„è§£é‡Š å¤ä»¤æ—¶å’Œå†¬ä»¤æ—¶äº§ç”Ÿçš„ä¸šåŠ¡åœºæ™¯ä¸¾ä¸ªä¾‹å­ï¼š ä¸€ä¸ªå®è¡Œäº†å¤ä»¤æ—¶å’Œå†¬ä»¤æ—¶çš„å›½å®¶åœ¨å¤ä»¤æœ‰ä¸€ä¸ªæ´»åŠ¨ï¼Œæ¯å¤©11ç‚¹åˆ°1ä¸€ç‚¹å‚åŠ ï¼Œä¸ºæœŸä¸ƒå¤©ï¼Œè€Œè¿™7å¤©æ­£å¥½è¿‡äº†ä»¤æ—¶å˜åŒ–çš„è¿™ä¸€å¤©ï¼Œ è¿™æ ·ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ å› ä¸ºè·¨è¿‡ä»¤æ—¶æ‰€ä»¥è·¨ä»¤æ—¶ä¹‹å‰ä¸€å¤©çš„12ç‚¹20åˆ†å’Œåä¸€å¤©çš„12ç‚¹20åˆ†ä¹‹é—´ç›¸éš”çš„å¹¶ä¸æ˜¯24å°æ—¶ï¼Œå› ä¸ºä»¤æ—¶çš„å˜åŒ–æºå¸¦çš„æ—¶åŒºçš„å˜åŒ–ï¼Œå› ä¸ºæ—¶åŒºå˜åŒ–äº†ï¼Œæ‰€ä»¥ç›¸åŒçš„12ç‚¹20åˆ†å¯¹åº”çš„æ¯«ç§’æ•°æ˜¯ä¸åŒçš„ï¼ˆæ¯«ç§’æ²¡æœ‰æ—¶åŒºé—®é¢˜ï¼‰æ‰€ä»¥ä¸ºæœŸä¸ƒå¤©è¿™ä¸ªè¿‡ç¨‹ä¸èƒ½ç®€å•ä½¿ç”¨+24å°æ—¶æ¥å¤„ç†äº†ï¼Œå› ä¸ºè¿™æ ·å°±å¯èƒ½å¯¼è‡´è·¨ä»¤æ—¶å‰æ˜¯11ç‚¹åˆ°1ç‚¹ï¼Œè·¨ä»¤æ—¶ä¹‹åå°±æ˜¯12ç‚¹åˆ°2ç‚¹äº† æ€ä¹ˆè§£å†³javaæä¾›äº†ä¸€ä¸ªéå¸¸ç‰›é€¼çš„api TimeZone ï¼Œä¸“é—¨ç”¨æ¥å¤„ç†æ—¶åŒºé—®é¢˜ æœ‰ä¸¤ä¸ªapi è¿™æ ·å°±å¾ˆç®€å•äº†,ä½¿ç”¨è¿™ä¸¤ä¸ªapiå¦‚æœè¿”å›çš„å€¼ä¸ç›¸ç­‰,å°±è¯´æ˜å½“å‰æ—¶é—´å¤„äºæŸä¸€ä¸ªä»¤æ—¶ä¸­ è¿›é˜¶ä¸€ä¸‹,è§£å†³ä¸€ä¸‹ä¸Šé¢çš„éœ€æ±‚,è·¨ä»¤æ—¶çš„æ—¶å€™ä¿è¯æ—¥æœŸæ˜¯+1çš„è§£é‡Šä¸€ä¸‹è¿™ä¸ªéœ€æ±‚, ç›´æ¥ç”¨ä¸€ä¸ªæœ€åŸºæœ¬çš„ä¾‹å­æ¥è¯´ æˆ‘ç”¨è¥¿ç­ç‰™å›½å®¶çš„æ—¶åŒºæ¥åšä¸€ä¸ª+24å°æ—¶çš„å¤©æ•°è¿­ä»£,ç†è®ºä¸Šåº”è¯¥è®©2019-10-26 4ç‚¹å’Œ6ç‚¹,å˜æˆ2019-10-27 4ç‚¹å’Œ6ç‚¹ä½†æ˜¯åº”ä¸ºå¤ä»¤æ—¶çš„é—®é¢˜,å…¶å®å˜æˆçš„æ˜¯æˆ2019-10-27 3ç‚¹å’Œ5ç‚¹ è·‘ä¸€ä¸‹ä¸‹é¢çš„ä»£ç  è¾“å‡º: æ‰€ä»¥ä¸èƒ½è¿™ä¹ˆåš,ç›´æ¥ä¸Šä»£ç ,å…¶å®å°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç®—æ³•é¢˜äº† ä¸Šé¢çš„ç®—æ³•ç®€å•çš„è¯´å°±æ˜¯è¡¥å¿æ—¶å·®,å½“å‰çš„æ—¶é—´å’Œä¹‹åçš„è¿›è¡Œæ¯”è¾ƒ,å¦‚æœæœ‰å·®åˆ«å°±+ä¸Šå·®è·å°±è¡Œäº† , è¿™æ ·å°±èƒ½ä¿è¯åœ¨è·¨å¤ä»¤æ—¶çš„æ—¶å€™ä¿è¯æ—¶é—´ç»Ÿä¸€","date":"2024-12-31","categories":["java"]},{"title":"java-æšä¸¾ç±»å‹","url":"/2024/12/31/java-æšä¸¾ç±»å‹/","content":"æšä¸¾ç±»å‹åœ¨javaä¸–ç•Œä½¿ç”¨enumç±»å‹çš„åœºæ™¯æ˜¯éå¸¸å¤šçš„ï¼Œä½†æ˜¯ç›¸æ¯”è¾ƒjavaä¸­å…¶ä»–çš„ç±»å‹è¿™ä¸ªç±»å‹ä½¿ç”¨çš„æ—¶å€™è¿˜æ˜¯æ¯”è¾ƒå°‘çš„è¿™é‡Œè®°å½•ä¸€ä¸‹ æšä¸¾ç±»å‹åˆ›å»º æšä¸¾ç±»å‹çš„åˆ›å»ºå’Œä¼ ç»Ÿçš„ç±»çš„å®ç°æ˜¯ç›¸åŒçš„ï¼Œä¸è¿‡è¦æ³¨æ„æšä¸¾ç±»å‹æ‹¥æœ‰ä¸€ä¸ªé«˜çº§çš„ç”¨æ³•ç”¨æ³•å°±æ˜¯ä½¿ç”¨valueså¯¹æšä¸¾ç±»å‹æ¯éƒ¨çš„å±æ€§è¿›è¡Œè¿­ä»£ï¼Œå’Œä½¿ç”¨valueof è·å¾—æŒ‡å®šçš„æšä¸¾å¯¹è±¡ ä½¿ç”¨switch åˆ¤æ–­Enumå¯¹è±¡ æ³¨æ„è¿™é‡Œä½¿ç”¨çš„getPositionValue æ–¹æ³• å› ä¸ºPOSTOPNç›¸å½“ä¸€ä¸ªå£°æ˜å’ŒStringç±»ä¼¼ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥çš„ä½¿ç”¨sqlPostionæ¥ä½œä¸ºswitchçš„æ ‡è®°ï¼Œéœ€è¦ä½¿ç”¨å®ç°ç±»æ¥æ ‡è®°ï¼Œæ‰€ä»¥ä½¿ç”¨switchçš„å†™æ³•è¦è¿™æ ·å†™","date":"2024-12-31","categories":["java"]},{"title":"java-ç½‘ç»œ-bioç½‘ç»œç¼–ç¨‹","url":"/2024/12/31/java-ç½‘ç»œ-bioç½‘ç»œç¼–ç¨‹/","content":"javaçš„ç½‘ç»œç¼–ç¨‹æ˜¯ä¸€ä¸ªç¡¬èŒ¬ è¿™é‡Œè®°å½•ä¸€ä¸‹java é˜»å¡å¼ç½‘ç»œç¼–ç¨‹çš„æ­£ç¡®å§¿åŠ¿ ç¼–å†™ä¸€ä¸ªæœåŠ¡ç«¯ç¨‹åº clientç«¯ç¨‹åº æ³¨æ„è¿™ç§åº•å±‚ç½‘ç»œç¼–ç¨‹çš„å‘ç‚¹ java çš„ tcp sockt å®ç°ä¸­ä¸€ä¸ªsocketå’Œä¸€ä¸ªsocket ä¸€ä¸€å¯¹åº” è¦æ³¨æ„tcpè¯»å–çš„å­—èŠ‚æ•°é‡çš„é—®é¢˜,æ¯”å¦‚ä½¿ç”¨bufferçš„æ—¶å€™readLine å°±æ˜¯è¯»å–ä¸€ä¸ªæ¢è¡Œå›è½¦çš„æ•°æ®,å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„æ ‡è¯†ç¬¦å°†ä¸ä¼šè¿”å›çš„","date":"2024-12-31","categories":["java"]},{"title":"java-ç½‘ç»œ-nio-nioè§£æ","url":"/2024/12/31/java-ç½‘ç»œ-nio-nioè§£æ/","content":"java nioæ”¯æŒçš„èƒŒåunixç³»ç»Ÿçš„äº”ç§IOæ¨¡å‹(1) é˜»å¡I&#x2F;Oæ¨¡å‹ éå¸¸å¥½ç†è§£æœ€ç®€å•çš„IOæ¨¡å‹ (2) éé˜»å¡I&#x2F;Oæ¨¡å‹ å…¶å®æœ¬è´¨ä¸Šå°±æ˜¯è½®è®­æ¥æŸ¥æ‰¾æ˜¯å¦æœ‰å¯ä»¥è¿›è¡Œè¯»å–çš„èµ„æº (3) I&#x2F;Oå¤ç”¨æ¨¡å‹ è¿™ä¸ªæ˜¯select&#x2F;poll,linux çš„epollæ˜¯è¿›åŒ–ç‰ˆ,åŸºäºäº‹ä»¶é©±åŠ¨æ¨¡å‹æ€§èƒ½æ›´å¥½ (4) ä¿¡å·é©±åŠ¨I&#x2F;Oæ¨¡å‹ (5) å¼‚æ­¥I&#x2F;Oæ¨¡å‹ è¿™ä¸ªå°±æ˜¯AIO å…¨ä¿¡å·é©±åŠ¨æ¨¡å‹ java å‡ ç§ioçš„å¯¹æ¯” java é›†ä¸­ioæ¨¡å‹æ ·ä¾‹BIO æ¨¡å‹java çš„åŒæ­¥é˜»å¡æ¨¡å‹æ˜¯ä¸€å¯¹ä¸€çš„çº¿ç¨‹æ¨¡å‹æœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯ç¼ºå°‘å¼¹æ€§,å•ç”¨æˆ·é‡å¢åŠ çš„æ—¶å€™,ç³»ç»Ÿçš„çº¿ç¨‹æ•°å‡ºäºä¸€ç§çº¿æ€§çš„å¢åŠ çŠ¶æ€ä¸­ æœåŠ¡ç«¯ æœåŠ¡ç«¯ä½¿ç”¨çº¿ç¨‹æ±  å®¢æˆ·ç«¯ è¿™ç§é˜»å¡å¼ç½‘ç»œioæ¨¡å‹çš„ç¼ºç‚¹å’Œä¼˜ç‚¹ ç¼ºç‚¹: çº¿ç¨‹å ç”¨çš„æ¯”è¾ƒå¤š å¦‚æœå¤„ç†å¤šä¸ªè¯·æ±‚ä¸€ä¸ªè¯·æ±‚é˜»å¡äº†,ä¼šå¯¼è‡´æ‰€æœ‰çš„è¯·æ±‚éƒ½é˜»å¡æ‰ java NIOps java nioæ¯”è¾ƒéš¾ , é‡Œé¢æœ‰å¾ˆå¤šçš„ç‚¹éœ€è¦å¤„ç†","date":"2024-12-31","categories":["java"]},{"title":"java-ç½‘è·¯-nio-ä»æºä»£ç åˆ†æjavaNIOçš„è¿è¡Œè¿‡ç¨‹(ä¸€)","url":"/2024/12/31/java-ç½‘è·¯-nio-ä»æºä»£ç åˆ†æjavaNIOçš„è¿è¡Œè¿‡ç¨‹-ä¸€-/","content":"è¿™ä¸€èŠ‚è§£æä¸€ä¸‹ java NIOä¸­ ServerSocketChannelåˆ›å»ºçš„è¿‡ç¨‹ channel åœ¨javaä¸­è¡¨ç¤ºé€šé“ï¼Œæ˜¯ç”¨æ¥è¿›è¡Œæ•°æ®çš„æœ‰æ•ˆä¼ è¾“ å¹¿ä¹‰ä¸Šæ¥è¯´é€šé“å¯ä»¥è¢«åˆ†ä¸ºä¸¤ç±»ï¼šFile I&#x2F;Oå’ŒStream I&#x2F;Oï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶é€šé“å’Œå¥—æ¥å­—é€šé“ å¦‚æœåˆ†çš„æ›´ç»†è‡´ä¸€ç‚¹åˆ™æ˜¯ï¼š FileChannel ä»æ–‡ä»¶è¯»å†™æ•°æ® SocketChannel é€šè¿‡TCPè¯»å†™ç½‘ç»œæ•°æ® ServerSocketChannel å¯ä»¥ç›‘å¬æ–°è¿›æ¥çš„TCPè¿æ¥ï¼Œå¹¶å¯¹æ¯ä¸ªé“¾æ¥åˆ›å»ºå¯¹åº”çš„SocketChannel DatagramChannel é€šè¿‡UDPè¯»å†™ç½‘ç»œä¸­çš„æ•°æ® Pipe é€šé“æ—¢å¯ä»¥æ˜¯å•å‘çš„ä¹Ÿå¯ä»¥æ˜¯åŒå‘çš„ã€‚åªå®ç°ReadableByteChannelæ¥å£ä¸­çš„read()æ–¹æ³•æˆ–è€…åªå®ç°WriteableByteChannelæ¥å£ä¸­çš„write()æ–¹æ³•çš„é€šé“çš†ä¸ºå•å‘é€šé“ï¼ŒåŒæ—¶å®ç°ReadableByteChannelå’ŒWriteableByteChannelä¸ºåŒå‘é€šé“ï¼Œæ¯”å¦‚ByteChannelã€‚å¯¹äºsocketé€šé“æ¥è¯´ï¼Œå®ƒä»¬ä¸€ç›´æ˜¯åŒå‘çš„ï¼Œè€Œå¯¹äºFileChannelæ¥è¯´ï¼Œå®ƒåŒæ ·å®ç°äº†ByteChannelï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“é€šè¿‡FileInputStreamçš„getChannelï¼ˆï¼‰è·å–çš„FileChannelåªå…·æœ‰æ–‡ä»¶çš„åªè¯»æƒé™ï¼Œé‚£æ­¤æ—¶çš„åœ¨è¯¥é€šé“è°ƒç”¨writeï¼ˆï¼‰ä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿä¸å‡ºæ„å¤–çš„æŠ›å‡ºäº†NonWriteChannelExceptionå¼‚å¸¸ã€‚é€šè¿‡ä»¥ä¸Šï¼Œæˆ‘ä»¬å¾—å‡ºç»“è®ºï¼šé€šé“éƒ½ä¸ç‰¹å®šçš„I&#x2F;OæœåŠ¡æŒ‚é’©ï¼Œå¹¶ä¸”é€šé“çš„æ€§èƒ½å—é™äºæ‰€è¿æ¥çš„I&#x2F;OæœåŠ¡çš„æ€§è´¨ã€‚ é€šé“çš„å·¥ä½œæ¨¡å¼æœ‰ä¸¤ç§ï¼šé˜»å¡æˆ–éé˜»å¡ã€‚åœ¨éé˜»å¡æ¨¡å¼ä¸‹ï¼Œè°ƒç”¨çš„çº¿ç¨‹ä¸ä¼šä¼‘çœ ï¼Œè¯·æ±‚çš„æ“ä½œä¼šç«‹åˆ»è¿”å›ç»“æœï¼›åœ¨é˜»å¡æ¨¡å¼ä¸‹ï¼Œè°ƒç”¨çš„çº¿ç¨‹ä¼šäº§ç”Ÿä¼‘çœ ã€‚å¦å¤–é™¤FileChannelä¸èƒ½è¿è¡Œåœ¨éé˜»å¡æ¨¡å¼ä¸‹ï¼Œå…¶ä½™çš„é€šé“éƒ½å¯é˜»å¡è¿è¡Œä¹Ÿå¯ä»¥ä»¥éé˜»å¡çš„æ–¹å¼è¿è¡Œã€‚ å¦å¤–ä»SelectableChannelå¼•ç”³å‡ºçš„ç±»å¯ä»¥å’Œæ”¯æŒæœ‰æ¡ä»¶é€‰æ‹©çš„Selectorç»“åˆä½¿ç”¨ï¼Œè¿›è€Œå……åˆ†åˆ©ç”¨å¤šè·¯å¤ç”¨çš„I&#x2F;Oï¼ˆmultiplexed I&#x2F;Oï¼‰æ¥æé«˜æ€§èƒ½.å¯¹äºSocketé€šé“ç±»æ¥è¯´ï¼Œé€šå¸¸ä¸Selectorå…±åŒä½¿ç”¨ä»¥æé«˜æ€§èƒ½ã€‚éœ€è¦æ³¨æ„çš„æ˜¯é€šé“ä¸èƒ½è¢«é‡å¤ä½¿ç”¨ï¼Œä¸€ä¸ªæ‰“å¼€çš„é€šé“ä»£è¡¨ç€ä¸ä¸€ä¸ªç‰¹å®šI&#x2F;OæœåŠ¡è¿›è¡Œè¿æ¥å¹¶å°è£…äº†è¯¥è¿æ¥çš„çŠ¶æ€ï¼Œé€šé“ä¸€æ—¦å…³é—­ï¼Œè¯¥è¿æ¥ä¾¿ä¼šæ–­å¼€ã€‚é€šé“çš„closeï¼ˆï¼‰æ¯”è¾ƒç‰¹æ®Šï¼Œæ— è®ºåœ¨é€šé“æ—¶åœ¨é˜»å¡æ¨¡å¼ä¸‹è¿˜æ˜¯éé˜»å¡æ¨¡å¼ä¸‹ï¼Œç”±äºcloseï¼ˆï¼‰æ–¹æ³•çš„è°ƒç”¨è€Œå¯¼è‡´åº•å±‚I&#x2F;Oçš„å…³é—­éƒ½å¯èƒ½ä¼šé€ æˆçº¿ç¨‹çš„æš‚æ—¶é˜»å¡ã€‚åœ¨ä¸€ä¸ªå·²å…³é—­çš„é€šé“ä¸Šè°ƒç”¨closeï¼ˆï¼‰å¹¶æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œåªä¼šç«‹å³è¿”å›ã€‚ ç°åœ¨è¿›å…¥æ­£é¢˜ï¼Œè®¨è®ºä¸€ä¸‹ServerSocketChannelJava NIOä¸­çš„ ServerSocketChannel æ˜¯ä¸€ä¸ªå¯ä»¥ç›‘å¬æ–°è¿›æ¥çš„TCPè¿æ¥çš„é€šé“, ç±»ä¼¼ServerSocketä¸€æ ·ã€‚è¦æ³¨æ„çš„æ˜¯å’ŒDatagramChannelå’ŒSocketChannelä¸åŒï¼ŒServerSocketChannelæœ¬èº«ä¸å…·å¤‡ä¼ è¾“æ•°æ®çš„èƒ½åŠ›ï¼Œè€Œåªæ˜¯è´Ÿè´£ç›‘å¬ä¼ å…¥çš„è¿æ¥å’Œåˆ›å»ºæ–°çš„SocketChannelã€‚ åˆ›å»ºä¸€ä¸ªServerSocketå¾ˆç®€å•ï¼Œä»£ç å¦‚ä¸‹ æ·±å…¥ç ”ç©¶ä¸€ä¸‹ï¼Œ è¿›å…¥ServerSocketChannelçš„openæ–¹æ³• ServerSocketChannelç±» openæ–¹æ³• è¿™é‡Œé¦–å…ˆå°†ä¼šè°ƒç”¨SelectorProviderçš„provideræ–¹æ³•,è¿™ä¸€å±€å°†ä¼šè¿”å›ä¸€ä¸ªSelectorProviderå®ä¾‹,ä¸»è¦ä½œç”¨å°±æ˜¯ä½¿ç”¨spiæˆ–è€…-Dxxxå‚æ•°ä¼ å…¥çš„SelectorProviderçš„ç±»urlåœ°å€ï¼ˆç±»çš„åŒ…ååŠ ç±»åï¼‰è¿”å›ä¸€ä¸ªimpå®ä¾‹ SelectorProviderç±» provider() æ–¹æ³• ç„¶åä¼šè°ƒç”¨å®ä¾‹çš„ openServerSocketChannel()æ–¹æ³• è¿™ä¸ªæ–¹æ³•å°†ä¼šçœŸæ­£çš„è¿”å›ä¸€ä¸ªServerSocketChannelImplå®ä¾‹ï¼Œè¿™ä¸ªç±»ä¸€èˆ¬å°±æ˜¯ç”±è™šæ‹Ÿæœºçš„å‚å•†æä¾›çš„ï¼Œè¿™é‡Œå°±ä¸è¿›è¡Œæ·±å…¥çš„ç ”ç©¶äº† æœ€åçœ‹ä¸€ä¸‹è¿™ä¸ªserversocketchannelä¸ªäººè§‰å¾—æœ‰ç”¨çš„æ–¹æ³• public static ServerSocketChannel open() throws IOException å¼€å¯ä¸€ä¸ªserversocketchannel **public final int validOps()**ï¼šè¿”å›è¿™ä¸ªé€šé“æ”¯æŒçš„SelectionKeyå€¼ï¼Œåº”ä¸ºè¿™ä¸ªé€šé“åªæ˜¯å¼€å¯ä¸€ä¸ªSocketChannelå¹¶æ²¡æœ‰ä¿¡æ¯äº¤æ¢çš„åŠŸèƒ½ï¼Œåªæ˜¯ç›‘å¬åŠŸèƒ½ï¼Œæ‰€æœ‰åªèƒ½è¿”å›SelectionKey.OP_ACCEPT **public final ServerSocketChannel bind(SocketAddress local)å’Œpublic final ServerSocketChannel bind(SocketAddress localï¼Œint backlog)**ï¼šå­—å¦‚å…¶æ„å°†ä¸€ä¸ªå¥—æ¥å­—å’Œæœ¬åœ°åœ°å€é“¾æ¥ï¼Œæœ‰ä¸€ä¸ªé‡æ„æ–¹æ³•æä¾›æœ€å¤§é“¾æ¥æ•°æ”¯æŒ **public ServerSocket socket()**ï¼šè¿”å›ä¸€ä¸ªServerSocket public SocketChannel accept() throws IOExceptionï¼šå’Œä¼ ç»Ÿçš„ç½‘ç»œç¼–ç¨‹ç›¸åŒï¼Œå¦‚æœä½¿ç”¨çš„Nioé‚£ä¹ˆå°†ä¼šç«‹å³çš„è¿”å›nullå¦åˆ™å°†ä¼šé˜»å¡ä½ç›´åˆ°æœ‰é“¾æ¥å»ºç«‹ public SocketAddress getLocalAddress() throws IOExceptionï¼šè¿”å›è¿™é‡Œç»‘å®šçš„åœ°å€ public final SelectableChannel configureBlocking(boolean block) throws IOException: æŒ‡å®šè¿™ä¸ªæ¥å£æ˜¯é˜»å¡çš„è¿˜æ˜¯éé˜»å¡çš„","date":"2024-12-31","categories":["java"]},{"title":"java-èµ„æºè·å–-æ–‡ä»¶ç³»ç»Ÿä¸­-jaråŒ…ä¸­-jaråŒ…ä¸­çš„jarä¸­","url":"/2024/12/31/java-èµ„æºè·å–-æ–‡ä»¶ç³»ç»Ÿä¸­-jaråŒ…ä¸­-jaråŒ…ä¸­çš„jarä¸­/","content":"ä¸€å¼€å§‹å…¶å®ç”¨è¿™ä¸ªé¢˜ç›®ä½œä¸ºæ–‡ç« çš„æ ‡é¢˜å¾ˆéš¾å—ï¼Œä½†æ˜¯æ²¡æœ‰åŠæ³•javaçš„æ–‡ä»¶è·å–å°±æ˜¯è¿™ä¹ˆè´Ÿè½½:cold_sweat: javaè·å–æ•°æ®è·å–æ–‡ä»¶ç³»ç»Ÿçš„apiè¿™ä¸ªå°±ä¸ç½—å—¦äº†ï¼Œå°±æ˜¯javaçš„æ–‡ä»¶æ“ä½œFileInputStreamç­‰ç­‰ javaå¦‚æœè·å–jarä¸­çš„æ–‡ä»¶æ€ä¹ˆåšjava æœ‰ä¸€ä¸ªç‰¹æ®Šçš„apiçš„ClassLoader.getResource()ä¸getResources() ç®€å•çš„è¯´è¿™ä¸ªapiæ˜¯å¹²å˜›çš„,åŠ è½½ç±»è·¯å¾„èµ„æºæ–‡ä»¶,ä¹Ÿå°±æ˜¯classPathä¸­çš„ä¸œè¥¿ï¼ˆä¹Ÿå°±æ˜¯å¯ä»¥æ‹¿åˆ°classpathä¸­çš„æ‰€æœ‰ä¸œè¥¿åŒ…æ‹¬jarä¸­çš„ä¸œè¥¿ï¼‰ ç›´æ¥ä¸Šæºç  æ³¨æ„ä»£ç è¿™ä¸€æ®µEnumeration urls &#x3D; getClassLoader().getResources(packageName.replace(â€œ.â€, â€œ&#x2F;â€œ)); è¿”å›å€¼çŸ³URLç±»å‹ï¼Œæ³¨æ„åœ¨javaä¸­è¿™ä¸ªurlå…¶å®æœ‰å¤šç§åè®®æ„æˆçš„ï¼Œfileå‰ç¼€è¡¨ç¤ºåœ¨classpathæ–‡ä»¶è·¯å¾„ä¸­çš„èµ„æºï¼Œè€Œjarå‰ç¼€è¡¨ç¤ºåœ¨jarä¸­çš„èµ„æº å¦‚æœæ˜¯fileå‰ç¼€çš„èµ„æº è¿™ç§æƒ…å†µä¸‹å°±å½“æˆåŸºæœ¬çš„æ–‡ä»¶æ•°æ®æµæ¥å¤„ç†å°±å¥½äº†å…¶å®å¾ˆç®€å• å¦‚æœçŸ³jarå‰ç¼€çš„èµ„æº è¿™ä¸ªåœ°æ–¹è¦æ³¨æ„ä¸€ä¸‹ï¼Œæœ‰ä¸€ä¸ªå‘ï¼Œå°±æ˜¯å¦‚æœjvmå‘ç°è¿™ä¸ªåœ°æ–¹æœ‰æˆ‘ä»¬éœ€è¦çš„èµ„æºæˆ‘ä»¬éœ€è¦é€šè¿‡JarURLConnection jarURLConnection &#x3D; (JarURLConnection) url.openConnection();è¿™ä¸ªapiæ¥è·å–èµ„æºçš„å¼•ç”¨ï¼Œä½†æ˜¯å‘¢è¿™ä¸ªå¼•ç”¨ä¼šå°†è¿™ä¸ªjarä¸­æ‰€æœ‰çš„æ–‡ä»¶éƒ½åŠ è½½è¿›æ¥ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨çš„æ—¶å€™éœ€è¦åšä¸€ä¸ªè¿‡æ»¤ã€‚ æ€»ç»“ä¸€ä¸‹ä¸Šé¢çš„ä»£ç å·²ç»å®ç°äº†ä¸€ä¸ªjava jarä¸­æ–‡ä»¶çš„æœç´¢ï¼Œç½‘ç»œä¸Šæœ‰ç±»ä¼¼çš„ä»£ç ï¼Œä½†æ˜¯å®é™…æƒ…å†µæ˜¯æœ‰ä¸€äº›bugçš„ï¼Œè¿™é‡Œæˆ‘åšäº†ä¸€äº›ä¿®æ”¹ï¼ˆå› ä¸ºæˆ‘ä»¬ä¼ å…¥çš„æ˜¯æŒ‡å®šçš„åŒ…ï¼Œä½†æ˜¯jaråŠ è½½ä¼šæŠŠæ•´ä¸ªjaræ–‡ä»¶å…¨éƒ¨åŠ è½½è¿›æ¥ï¼Œæ‰€ä»¥æˆ‘åœ¨é‡Œé¢åŠ äº†ä¸€ä¸ªè¿‡æ»¤æ“ä½œï¼‰ï¼Œç°åœ¨å·²ç»å¯ä»¥ç¨³å®šè¿è¡Œäº†ã€‚","date":"2024-12-31","categories":["java"]},{"title":"java-é‡è½½-é‡å†™å’Œæ¡¥æ¥æ–¹æ³•","url":"/2024/12/31/java-é‡è½½-é‡å†™å’Œæ¡¥æ¥æ–¹æ³•/","content":"ä»Šå¤©åœ¨è¿›è¡Œ java åå°„åº“çš„å°è£…è¿‡ç¨‹ä¸­,å‘ç°äº†ä¸€ä¸ªé—®é¢˜,ä¹‹å‰å¯¹javaé‡è½½å’Œé‡å†™çš„æœºåˆ¶è®¤è¯†å¹¶ä¸æ˜¯å¾ˆæ·±å…¥.è¿™é‡Œå†³å®šæ·±å…¥çš„æ•´ç†ä¸€ä¸‹ é‡è½½ å®šä¹‰ ä¸€ä¸ªç±»ä¸­å…·æœ‰å¤šä¸ªé‡åçš„æ–¹æ³•,å¦‚æœçˆ¶å­ç±»æ»¡è¶³æ¡ä»¶ä¹Ÿèƒ½æ„æˆé‡è½½æ–¹æ³• ç‰¹ç‚¹ æ–¹æ³•åç§°ç›¸åŒ å‚æ•°åˆ—è¡¨ä¸è®¸ä¸åŒ ä¸ªæ•°ä¸åŒ ä¸ªæ•°ç›¸åŒä½†æ˜¯ç±»å‹ä¸åŒ(åŒ…ä¸åŒ…æ‹¬çˆ¶å­å…³ç³») è¿”å›å€¼,è®¿é—®ä¿®é¥°ç¬¦å·å¯ä»¥ç›¸åŒä¹Ÿå¯ä»¥ä¸ç›¸åŒ æ³¨æ„:è¿™ä¸€ç‚¹æ²¡æœ‰è€ƒè™‘åˆ°å¦‚æœæ˜¯ç»§æ‰¿å…³ç³»,ä¸¤ä¸ªçœ‹ä¼¼é‡è½½çš„çˆ¶å­å…³ç³»æ˜¯å¦å®é™…ä¸Šæ„æˆé‡è½½å…³ç³» é‡å†™ å®šä¹‰ å­ç±»é‡å†™çˆ¶ç±»çš„ä¸€ä¸ªæ–¹æ³• ç‰¹ç‚¹ å­ç±»ç»§æ‰¿çˆ¶ç±» è¿”å›å€¼åç§°å‚æ•°ä¸èƒ½æ”¹å˜(å­ç±»çš„å‚æ•°,è¿”å›å€¼å¯ä»¥æ˜¯çˆ¶ç±»å¯¹åº”çš„å‚æ•°çš„å­ç±») é™åˆ¶(ä¸èƒ½è¿›è¡Œé‡å†™çš„æ–¹æ³•) privateä¿®é¥°çš„æ–¹æ³• æ„é€ å‡½æ•° final,static æ–¹æ³•(static å°†ä¼šè¢«å†æ¬¡å£°æ˜) é‡å†™æ–¹æ³•ä¸èƒ½ç¼©å°çˆ¶æ–¹æ³•çš„æƒé™ é‡å†™æ–¹æ³•ä¸èƒ½æŠ›å‡ºä»»ä½•æ–°çš„å¼ºåˆ¶æ€§å¼‚å¸¸æˆ–è€…æ¯”çˆ¶ç±»æ–¹æ³•èŒƒå›´å¹¿çš„å¼ºåˆ¶æ€§å¼‚å¸¸(è¡¥å……å‡ºåˆ—RuntimeExceptionä¹‹å¤–éƒ½æ˜¯å¼ºåˆ¶å¼‚å¸¸) é‡è½½å’Œé‡å†™çš„å¯¹æ¯” é‡è½½ä¸­äº§ç”Ÿçš„æ¡¥æ¥æ–¹æ³•é‡è½½ä¸­å¯èƒ½æœ‰è¿™æ ·ä¸€ç§æƒ…å†µ:é‡å†™æ–¹æ³•çš„è¿”å›ç±»å‹æ˜¯å…¶çˆ¶ç±»è¿”å›ç±»å‹çš„å­ç±»å‹ åœ¨è¿™ç§æƒ…å†µä¸‹jvmå°†ä¼šè‡ªåŠ¨çš„ç”Ÿæˆæ¡¥æ¥æ–¹æ³•æ¥ä½œä¸ºå­ç±»å’Œçˆ¶ç±»è°ƒç”¨ä¹‹é—´çš„æ¡¥æ¢ æ¯”å¦‚è¿™æ ·çš„ä¸¤ä¸ªç±»,NaiveMerchantç±»ç»§æ‰¿è‡ªMerchant,é‡è½½äº†actionPriceæ–¹æ³•,å¹¶ä¸”Doubleç±»å‹æ˜¯Numberç±»å‹çš„å­ç±» è¿™æ ·åœ¨jvmç¼–è¯‘è¿‡ç¨‹ä¸­å°†ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªä¸­é—´æ–¹æ³• æ³¨æ„è¿™ç§æƒ…å†µåªæ˜¯é’ˆå¯¹,ä½¿ç”¨çˆ¶ç±»è°ƒç”¨å­ç±»é‡å†™çš„é€»è¾‘è¿™ç§æƒ…å†µ å¼•ç”³ä¸€ä¸‹: å…¶å®åœ¨æ³›å‹çš„ä½¿ç”¨ä¸­,åŒæ ·ä¼šå‡ºç°è¿™ç§æƒ…å†µ","date":"2024-12-31","categories":["java"]},{"title":"java-é¢†åŸŸæ¨¡å‹(po,voç­‰)","url":"/2024/12/31/java-é¢†åŸŸæ¨¡å‹-po-voç­‰-/","content":"è¿™ä¸€å—çš„ä¸œè¥¿æ˜¯ä»Šå¤©çœ‹apolloæ¡†æ¶çš„æ—¶å€™ï¼Œå‘ç°äº†ï¼Œå…¶å®æ˜¯ä¸€ä¸ªjavabean çš„å°è£…ï¼Œä½†æ˜¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šåˆæœ‰ä¸€äº›ä¸åŒï¼Œè¿™é‡Œè¯¦ç»†çš„ä»‹ç»ä¸€ä¸‹ã€‚ PO(persistant object) æŒä¹…å¯¹è±¡ åœ¨ o&#x2F;r æ˜ å°„çš„æ—¶å€™å‡ºç°çš„æ¦‚å¿µï¼Œå¦‚æœæ²¡æœ‰ o&#x2F;r æ˜ å°„ï¼Œæ²¡æœ‰è¿™ä¸ªæ¦‚å¿µå­˜åœ¨äº†ã€‚é€šå¸¸å¯¹åº”æ•°æ®æ¨¡å‹ ( æ•°æ®åº“ ), æœ¬èº«è¿˜æœ‰éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘çš„å¤„ç†ã€‚å¯ä»¥çœ‹æˆæ˜¯ä¸æ•°æ®åº“ä¸­çš„è¡¨ç›¸æ˜ å°„çš„ java å¯¹è±¡ã€‚æœ€ç®€å•çš„ PO å°±æ˜¯å¯¹åº”æ•°æ®åº“ä¸­æŸä¸ªè¡¨ä¸­çš„ä¸€æ¡è®°å½•ï¼Œå¤šä¸ªè®°å½•å¯ä»¥ç”¨ PO çš„é›†åˆã€‚ PO ä¸­åº”è¯¥ä¸åŒ…å«ä»»ä½•å¯¹æ•°æ®åº“çš„æ“ä½œã€‚ DOï¼ˆDomain Objectï¼‰é¢†åŸŸå¯¹è±¡ å°±æ˜¯ä»ç°å®ä¸–ç•Œä¸­æŠ½è±¡å‡ºæ¥çš„æœ‰å½¢æˆ–æ— å½¢çš„ä¸šåŠ¡å®ä½“ã€‚ä¸€èˆ¬å’Œæ•°æ®ä¸­çš„è¡¨ç»“æ„å¯¹åº”ã€‚ TO(Transfer Object) ï¼Œæ•°æ®ä¼ è¾“å¯¹è±¡ åœ¨åº”ç”¨ç¨‹åºä¸åŒ tie( å…³ç³» ) ä¹‹é—´ä¼ è¾“çš„å¯¹è±¡ DTOï¼ˆData Transfer Objectï¼‰æ•°æ®ä¼ è¾“å¯¹è±¡ è¿™ä¸ªæ¦‚å¿µæ¥æºäºJ2EEçš„è®¾è®¡æ¨¡å¼ï¼ŒåŸæ¥çš„ç›®çš„æ˜¯ä¸ºäº†EJBçš„åˆ†å¸ƒå¼åº”ç”¨æä¾›ç²—ç²’åº¦çš„æ•°æ®å®ä½“ï¼Œä»¥å‡å°‘åˆ†å¸ƒå¼è°ƒç”¨çš„æ¬¡æ•°ï¼Œä»è€Œæé«˜åˆ†å¸ƒå¼è°ƒç”¨çš„æ€§èƒ½å’Œé™ä½ç½‘ç»œè´Ÿè½½ï¼Œä½†åœ¨è¿™é‡Œï¼Œæˆ‘æ³›æŒ‡ç”¨äºå±•ç¤ºå±‚ä¸æœåŠ¡å±‚ä¹‹é—´çš„æ•°æ®ä¼ è¾“å¯¹è±¡ã€‚ VO(view object) å€¼å¯¹è±¡ è§†å›¾å¯¹è±¡ï¼Œç”¨äºå±•ç¤ºå±‚ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠæŸä¸ªæŒ‡å®šé¡µé¢ï¼ˆæˆ–ç»„ä»¶ï¼‰çš„æ‰€æœ‰æ•°æ®å°è£…èµ·æ¥ã€‚ BO(business object) ä¸šåŠ¡å¯¹è±¡ ä»ä¸šåŠ¡æ¨¡å‹çš„è§’åº¦çœ‹ , è§ UML å…ƒä»¶é¢†åŸŸæ¨¡å‹ä¸­çš„é¢†åŸŸå¯¹è±¡ã€‚å°è£…ä¸šåŠ¡é€»è¾‘çš„ java å¯¹è±¡ , é€šè¿‡è°ƒç”¨ DAO æ–¹æ³• , ç»“åˆ PO,VO è¿›è¡Œä¸šåŠ¡æ“ä½œã€‚ business object: ä¸šåŠ¡å¯¹è±¡ ä¸»è¦ä½œç”¨æ˜¯æŠŠä¸šåŠ¡é€»è¾‘å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡å¯ä»¥åŒ…æ‹¬ä¸€ä¸ªæˆ–å¤šä¸ªå…¶å®ƒçš„å¯¹è±¡ã€‚ æ¯”å¦‚ä¸€ä¸ªç®€å†ï¼Œæœ‰æ•™è‚²ç»å†ã€å·¥ä½œç»å†ã€ç¤¾ä¼šå…³ç³»ç­‰ç­‰ã€‚ æˆ‘ä»¬å¯ä»¥æŠŠæ•™è‚²ç»å†å¯¹åº”ä¸€ä¸ª PO ï¼Œå·¥ä½œç»å†å¯¹åº”ä¸€ä¸ª PO ï¼Œç¤¾ä¼šå…³ç³»å¯¹åº”ä¸€ä¸ª PO ã€‚ å»ºç«‹ä¸€ä¸ªå¯¹åº”ç®€å†çš„ BO å¯¹è±¡å¤„ç†ç®€å†ï¼Œæ¯ä¸ª BO åŒ…å«è¿™äº› PO ã€‚ è¿™æ ·å¤„ç†ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹ BO å»å¤„ç†ã€‚ POJO(plain ordinary java object) ç®€å•æ— è§„åˆ™ java å¯¹è±¡ çº¯çš„ä¼ ç»Ÿæ„ä¹‰çš„ java å¯¹è±¡ã€‚å°±æ˜¯è¯´åœ¨ä¸€äº› Object&#x2F;Relation Mapping å·¥å…·ä¸­ï¼Œèƒ½å¤Ÿåšåˆ°ç»´æŠ¤æ•°æ®åº“è¡¨è®°å½•çš„ persisent object å®Œå…¨æ˜¯ä¸€ä¸ªç¬¦åˆ Java Bean è§„èŒƒçš„çº¯ Java å¯¹è±¡ï¼Œæ²¡æœ‰å¢åŠ åˆ«çš„å±æ€§å’Œæ–¹æ³•ã€‚æˆ‘çš„ç†è§£å°±æ˜¯æœ€åŸºæœ¬çš„ Java Bean ï¼Œåªæœ‰å±æ€§å­—æ®µåŠ setter å’Œ getter æ–¹æ³•ï¼ã€‚ DAO(data access object) æ•°æ®è®¿é—®å¯¹è±¡ æ˜¯ä¸€ä¸ª sun çš„ä¸€ä¸ªæ ‡å‡† j2ee è®¾è®¡æ¨¡å¼ï¼Œ è¿™ä¸ªæ¨¡å¼ä¸­æœ‰ä¸ªæ¥å£å°±æ˜¯ DAO ï¼Œå®ƒè´ŸæŒä¹…å±‚çš„æ“ä½œã€‚ä¸ºä¸šåŠ¡å±‚æä¾›æ¥å£ã€‚æ­¤å¯¹è±¡ç”¨äºè®¿é—®æ•°æ®åº“ã€‚é€šå¸¸å’Œ PO ç»“åˆä½¿ç”¨ï¼Œ DAO ä¸­åŒ…å«äº†å„ç§æ•°æ®åº“çš„æ“ä½œæ–¹æ³•ã€‚é€šè¿‡å®ƒçš„æ–¹æ³• , ç»“åˆ PO å¯¹æ•°æ®åº“è¿›è¡Œç›¸å…³çš„æ“ä½œã€‚å¤¹åœ¨ä¸šåŠ¡é€»è¾‘ä¸æ•°æ®åº“èµ„æºä¸­é—´ã€‚é…åˆ VO, æä¾›æ•°æ®åº“çš„ CRUD æ“ä½œ O&#x2F;R Mapper å¯¹è±¡ &#x2F; å…³ç³» æ˜ å°„ å®šä¹‰å¥½æ‰€æœ‰çš„ mapping ä¹‹åï¼Œè¿™ä¸ª O&#x2F;RMapper å¯ä»¥å¸®æˆ‘ä»¬åšå¾ˆå¤šçš„å·¥ä½œã€‚é€šè¿‡è¿™äº› mappings, è¿™ä¸ª O&#x2F;RMapper å¯ä»¥ç”Ÿæˆæ‰€æœ‰çš„å…³äºå¯¹è±¡ä¿å­˜ï¼Œåˆ é™¤ï¼Œè¯»å–çš„ SQL è¯­å¥ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦å†™é‚£ä¹ˆå¤šè¡Œçš„ DAL ä»£ç äº†ã€‚æœ¬è´¨ä¸Šå°±æ˜¯æ•°æ®è¡¨åˆ°é¢†åŸŸbeançš„å¯¹åº”å…³ç³»","date":"2024-12-31","categories":["java"]},{"title":"java-å¤šçº¿ç¨‹ç¼–ç¨‹1-åŸºç¡€","url":"/2024/12/31/java-å¤šçº¿ç¨‹ç¼–ç¨‹1-åŸºç¡€/","content":"javaçš„jvmè™šæ‹Ÿæœºå°†çº¿ç¨‹æŠ€æœ¯å‘æ‰¬å…‰å¤§äº† çº¿ç¨‹çš„å®ç°æ–¹å¼å®ç°çº¿ç¨‹ä¸»è¦æœ‰3ç§æ–¹å¼:ä½¿ç”¨å†…æ ¸çº¿ç¨‹å®ç°ã€ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹å®ç°å’Œä½¿ç”¨ç”¨æˆ·çº¿ç¨‹åŠ è½»é‡çº§è¿›ç¨‹æ··åˆå®ç°ã€‚ å†…æ ¸çº¿ç¨‹(Kernel-Level Thread,KLT)å°±æ˜¯ç›´æ¥ç”±æ“ä½œç³»ç»Ÿå†…æ ¸(Kernel,ä¸‹ç§°å†…æ ¸)æ”¯æŒçš„çº¿ç¨‹,è¿™ç§çº¿ç¨‹ç”±å†…æ ¸æ¥å®Œæˆçº¿ç¨‹åˆ‡æ¢,å†…æ ¸é€šè¿‡æ“çºµè°ƒåº¦å™¨(Scheduler)å¯¹çº¿ç¨‹è¿›è¡Œè°ƒåº¦,å¹¶è´Ÿè´£å°†çº¿ç¨‹çš„ä»»åŠ¡æ˜ å°„åˆ°å„ä¸ªå¤„ç†å™¨ä¸Šã€‚ ç¨‹åºä¸€èˆ¬ä¸ä¼šç›´æ¥å»ä½¿ç”¨å†…æ ¸çº¿ç¨‹,è€Œæ˜¯å»ä½¿ç”¨å†…æ ¸çº¿ç¨‹çš„ä¸€ç§é«˜çº§æ¥å£â€”â€”è½»é‡çº§è¿›ç¨‹(Light Weight Process,LWP),è½»é‡çº§è¿›ç¨‹å°±æ˜¯æˆ‘ä»¬é€šå¸¸æ„ä¹‰ä¸Šæ‰€è®²çš„çº¿ç¨‹,ç”±äºæ¯ä¸ªè½»é‡çº§è¿›ç¨‹éƒ½ç”±ä¸€ä¸ªå†…æ ¸çº¿ç¨‹æ”¯æŒ,å› æ­¤åªæœ‰å…ˆæ”¯æŒå†…æ ¸çº¿ç¨‹,æ‰èƒ½æœ‰è½»é‡çº§è¿›ç¨‹ï¼Œå¯¹åº”å…³ç³»å¦‚ä¸‹ï¼šï¼ˆp:ç”¨æˆ·ï¼ŒLWPï¼šè½»é‡çº§çº¿ç¨‹ï¼ŒKLTï¼šå†…æ ¸çº¿ç¨‹ï¼ŒThread Scheduerï¼šçº¿ç¨‹æ± ï¼‰ ä½¿ç”¨å†…æ ¸çº¿ç¨‹æ¨¡å¼çš„å±€é™æ€§ï¼šåŸºäºå†…æ ¸çº¿ç¨‹å®ç°çš„,æ‰€ä»¥å„ç§çº¿ç¨‹æ“ä½œ,å¦‚åˆ›å»ºã€ææ„åŠåŒæ­¥,éƒ½éœ€è¦è¿›è¡Œç³»ç»Ÿè°ƒç”¨ã€‚è€Œç³»ç»Ÿè°ƒç”¨çš„ä»£ä»·ç›¸å¯¹è¾ƒé«˜,éœ€è¦åœ¨ç”¨æˆ·æ€(User Mode)å’Œå†…æ ¸æ€(KernelMode)ä¸­æ¥å›åˆ‡æ¢ã€‚å…¶æ¬¡,æ¯ä¸ªè½»é‡çº§è¿›ç¨‹éƒ½éœ€è¦æœ‰ä¸€ä¸ªå†…æ ¸çº¿ç¨‹çš„æ”¯æŒ,å› æ­¤è½»é‡çº§è¿›ç¨‹è¦æ¶ˆè€—ä¸€å®šçš„å†…æ ¸èµ„æº(å¦‚å†…æ ¸çº¿ç¨‹çš„æ ˆç©ºé—´),å› æ­¤ä¸€ä¸ªç³»ç»Ÿæ”¯æŒè½»é‡çº§è¿›ç¨‹çš„æ•°é‡æ˜¯æœ‰é™ ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹å®ç°é€šä¿—æ¥è¯´å°±æ˜¯ä½¿ç”¨å»ºç«‹åœ¨ç”¨æˆ·ç©ºé—´çš„çº¿ç¨‹åº“ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç³»ç»Ÿå†…éƒ¨çš„å†…æ ¸æœºåˆ¶ ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹çš„ä¼˜åŠ¿åœ¨äºä¸éœ€è¦ç³»ç»Ÿå†…æ ¸æ”¯æ´,åŠ£åŠ¿ä¹Ÿåœ¨äºæ²¡æœ‰ç³»ç»Ÿå†…æ ¸çš„æ”¯æ´,æ‰€æœ‰çš„çº¿ç¨‹æ“ä½œéƒ½éœ€è¦ç”¨æˆ·ç¨‹åºè‡ªå·±å¤„ç†ã€‚çº¿ç¨‹çš„åˆ›å»ºã€åˆ‡æ¢å’Œè°ƒåº¦éƒ½æ˜¯éœ€è¦è€ƒè™‘çš„é—®é¢˜,è€Œä¸”ç”±äºæ“ä½œç³»ç»ŸåªæŠŠå¤„ç†å™¨èµ„æºåˆ†é…åˆ°è¿›ç¨‹,é‚£è¯¸å¦‚â€œé˜»å¡å¦‚ä½•å¤„ç†â€ã€â€œå¤šå¤„ç†å™¨ç³»ç»Ÿä¸­å¦‚ä½•å°†çº¿ç¨‹æ˜ å°„åˆ°å…¶ä»–å¤„ç†å™¨ä¸Šâ€è¿™ç±»é—®é¢˜è§£å†³èµ·æ¥å°†ä¼šå¼‚å¸¸å›°éš¾,ç”šè‡³ä¸å¯èƒ½å®Œæˆã€‚ ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹åŠ è½»é‡çº§è¿›ç¨‹æ··åˆå®ç°åœ¨è¿™ç§æ··åˆå®ç°ä¸‹ï¼Œç”¨æˆ·çº¿ç¨‹çš„åˆ›å»ºã€åˆ‡æ¢ã€ææ„ç­‰æ“ä½œä¾ç„¶å»‰ä»·,å¹¶ä¸”å¯ä»¥æ”¯æŒå¤§è§„æ¨¡çš„ç”¨æˆ·çº¿ç¨‹å¹¶å‘ï¼Œæ“ä½œç³»ç»Ÿæä¾›æ”¯æŒçš„è½»é‡çº§è¿›ç¨‹åˆ™ä½œä¸ºç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çº¿ç¨‹ä¹‹é—´çš„æ¡¥æ¢,è¿™æ ·å¯ä»¥ä½¿ç”¨å†…æ ¸æä¾›çš„çº¿ç¨‹è°ƒåº¦åŠŸèƒ½åŠå¤„ç†å™¨æ˜ å°„,å¹¶ä¸”ç”¨æˆ·çº¿ç¨‹çš„ç³»ç»Ÿè°ƒç”¨è¦é€šè¿‡è½»é‡çº§çº¿ç¨‹æ¥å®Œæˆ,å¤§å¤§é™ä½äº†æ•´ä¸ªè¿›ç¨‹è¢«å®Œå…¨é˜»å¡çš„é£é™© å¯¹äºSun JDKæ¥è¯´,å®ƒçš„Windowsç‰ˆä¸Linuxç‰ˆéƒ½æ˜¯ä½¿ç”¨ä¸€å¯¹ä¸€çš„çº¿ç¨‹æ¨¡å‹å®ç°çš„,ä¸€æ¡Javaçº¿ç¨‹å°±æ˜ å°„åˆ°ä¸€æ¡è½»é‡çº§è¿›ç¨‹ä¹‹ä¸­,å› ä¸ºWindowså’ŒLinuxç³»ç»Ÿæä¾›çš„çº¿ç¨‹æ¨¡å‹å°±æ˜¯ä¸€å¯¹ä¸€çš„ ã€‚ java å¤šçº¿ç¨‹æä¾›çš„ç›¸å…³çŸ¥è¯†javaå†…éƒ¨çº¿ç¨‹çŠ¶æ€çš„åˆ‡æ¢æ¨¡å¼ åˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•ç»§æ‰¿ Threadç±»æˆ–è€…å®ç°Runnableå€Ÿå£ javaçº¿ç¨‹çš„ä¸€äº›æ“ä½œæ–¹æ³• javaåŸºç¡€é”æœºåˆ¶ ä½¿ç”¨atomicå·¥å…·å®ç°æ•°æ®å…±äº«","date":"2024-12-31","categories":["java"],"tags":["javaå¤šçº¿ç¨‹"]},{"title":"java-å¤šçº¿ç¨‹ç¼–ç¨‹2-å¹¶å‘æ€§é—®é¢˜-åº•å±‚å®ç°","url":"/2024/12/31/java-å¤šçº¿ç¨‹ç¼–ç¨‹2-å¹¶å‘æ€§é—®é¢˜-åº•å±‚å®ç°/","content":"ç¡¬ä»¶æ•ˆç‡å’Œä¸€è‡´æ€§é—®é¢˜ç”±äºè®¡ç®—æœºçš„å­˜å‚¨è®¾å¤‡ä¸å¤„ç†å™¨çš„è¿ç®—é€Ÿåº¦æœ‰å‡ ä¸ªæ•°é‡çº§çš„å·®è·,æ‰€ä»¥ç°ä»£è®¡ç®—æœºç³»ç»Ÿéƒ½ä¸å¾—ä¸åŠ å…¥ä¸€å±‚è¯»å†™é€Ÿåº¦å°½å¯èƒ½æ¥è¿‘å¤„ç†å™¨è¿ç®—é€Ÿåº¦çš„é«˜é€Ÿç¼“å­˜(Cache)æ¥ä½œä¸ºå†…å­˜ä¸å¤„ç†å™¨ä¹‹é—´çš„ç¼“å†²:å°†è¿ç®—éœ€è¦ä½¿ç”¨åˆ°çš„æ•°æ®å¤åˆ¶åˆ°ç¼“å­˜ä¸­,è®©è¿ç®—èƒ½å¿«é€Ÿè¿›è¡Œ,å½“è¿ç®—ç»“æŸåå†ä»ç¼“å­˜åŒæ­¥å›å†…å­˜ä¹‹ä¸­,è¿™æ ·å¤„ç†å™¨å°±æ— é¡»ç­‰å¾…ç¼“æ…¢çš„å†…å­˜è¯»å†™äº†ã€‚ åŸºäºé«˜é€Ÿç¼“å­˜çš„å­˜å‚¨äº¤äº’å¾ˆå¥½åœ°è§£å†³äº†å¤„ç†å™¨ä¸å†…å­˜çš„é€Ÿåº¦çŸ›ç›¾,ä½†æ˜¯ä¹Ÿä¸ºè®¡ç®—æœºç³»ç»Ÿå¸¦æ¥æ›´é«˜çš„å¤æ‚åº¦,å› ä¸ºå®ƒå¼•å…¥äº†ä¸€ä¸ªæ–°çš„é—®é¢˜:ç¼“å­˜ä¸€è‡´æ€§(Cache Coherence)ã€‚åœ¨å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­,æ¯ä¸ªå¤„ç†å™¨éƒ½æœ‰è‡ªå·±çš„é«˜é€Ÿç¼“å­˜,è€Œå®ƒä»¬åˆå…±äº«åŒä¸€ä¸»å†…å­˜(MainMemory) ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜Javaå†…å­˜æ¨¡å‹è§„å®šäº†æ‰€æœ‰çš„å˜é‡éƒ½å­˜å‚¨åœ¨ä¸»å†…å­˜(Main Memory)ä¸­(æ­¤å¤„çš„ä¸»å†…å­˜ä¸ä»‹ç»ç‰©ç†ç¡¬ä»¶æ—¶çš„ä¸»å†…å­˜åå­—ä¸€æ ·,ä¸¤è€…ä¹Ÿå¯ä»¥äº’ç›¸ç±»æ¯”,ä½†æ­¤å¤„ä»…æ˜¯è™šæ‹Ÿæœºå†…å­˜çš„ä¸€éƒ¨åˆ†)ã€‚æ¯æ¡çº¿ç¨‹è¿˜æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜(Working Memory,å¯ä¸å‰é¢è®²çš„å¤„ç†å™¨é«˜é€Ÿç¼“å­˜ç±»æ¯”),çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ä¿å­˜äº†è¢«è¯¥çº¿ç¨‹ä½¿ç”¨åˆ°çš„å˜é‡çš„ä¸»å†…å­˜å‰¯æœ¬æ‹·è´ ,çº¿ç¨‹å¯¹å˜é‡çš„æ‰€æœ‰æ“ä½œ(è¯»å–ã€èµ‹å€¼ç­‰)éƒ½å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­è¿›è¡Œ,è€Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡ ã€‚ ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´å…·ä½“çš„äº¤äº’åè®®,å³ä¸€ä¸ªå˜é‡å¦‚ä½•ä»ä¸»å†…å­˜æ‹·è´åˆ°å·¥ä½œå†…å­˜ã€å¦‚ä½•ä»å·¥ä½œå†…å­˜åŒæ­¥å›ä¸»å†…å­˜ä¹‹ç±»çš„å®ç°ç»†èŠ‚,Javaå†…å­˜æ¨¡å‹ä¸­å®šä¹‰äº†ä»¥ä¸‹8ç§æ“ä½œæ¥å®Œæˆ,è™šæ‹Ÿæœºå®ç°æ—¶å¿…é¡»ä¿è¯ä¸‹é¢æåŠçš„æ¯ä¸€ç§æ“ä½œéƒ½æ˜¯åŸå­çš„ã€ä¸å¯å†åˆ†çš„ lock(é”å®š):ä½œç”¨äºä¸»å†…å­˜çš„å˜é‡,å®ƒæŠŠä¸€ä¸ªå˜é‡æ ‡è¯†ä¸ºä¸€æ¡çº¿ç¨‹ç‹¬å çš„çŠ¶æ€ã€‚ unlock(è§£é”):ä½œç”¨äºä¸»å†…å­˜çš„å˜é‡,å®ƒæŠŠä¸€ä¸ªå¤„äºé”å®šçŠ¶æ€çš„å˜é‡é‡Šæ”¾å‡ºæ¥,é‡Šæ”¾åçš„å˜é‡æ‰å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹é”å®šã€‚ read(è¯»å–):ä½œç”¨äºä¸»å†…å­˜çš„å˜é‡,å®ƒæŠŠä¸€ä¸ªå˜é‡çš„å€¼ä»ä¸»å†…å­˜ä¼ è¾“åˆ°çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­,ä»¥ä¾¿éšåçš„loadåŠ¨ä½œä½¿ç”¨ã€‚ load(è½½å…¥):ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡,å®ƒæŠŠreadæ“ä½œä»ä¸»å†…å­˜ä¸­å¾—åˆ°çš„å˜é‡å€¼æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬ä¸­ã€‚ use(ä½¿ç”¨):ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡,å®ƒæŠŠå·¥ä½œå†…å­˜ä¸­ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€’ç»™æ‰§è¡Œå¼•æ“,æ¯å½“è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ªéœ€è¦ä½¿ç”¨åˆ°å˜é‡çš„å€¼çš„å­—èŠ‚ç æŒ‡ä»¤æ—¶å°†ä¼šæ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚ assign(èµ‹å€¼):ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡,å®ƒæŠŠä¸€ä¸ªä»æ‰§è¡Œå¼•æ“æ¥æ”¶åˆ°çš„å€¼èµ‹ç»™å·¥ä½œå†…å­˜çš„å˜é‡,æ¯å½“è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ªç»™å˜é‡èµ‹å€¼çš„å­—èŠ‚ç æŒ‡ä»¤æ—¶æ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚ store(å­˜å‚¨):ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡,å®ƒæŠŠå·¥ä½œå†…å­˜ä¸­ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜ä¸­,ä»¥ä¾¿éšåçš„writeæ“ä½œä½¿ç”¨ã€‚ write(å†™å…¥):ä½œç”¨äºä¸»å†…å­˜çš„å˜é‡,å®ƒæŠŠstoreæ“ä½œä»å·¥ä½œå†…å­˜ä¸­å¾—åˆ°çš„å˜é‡çš„å€¼æ”¾å…¥ä¸»å†…å­˜çš„å˜é‡ä¸­ã€‚ volatileå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™å½“ä¸€ä¸ªå˜é‡å®šä¹‰ä¸ºvolatileä¹‹å,å®ƒå°†å…·å¤‡ä¸¤ç§ç‰¹æ€§,ç¬¬ä¸€æ˜¯ä¿è¯æ­¤å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹çš„å¯è§æ€§,è¿™é‡Œçš„â€œå¯è§æ€§â€æ˜¯æŒ‡å½“ä¸€æ¡çº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªå˜é‡çš„å€¼,æ–°å€¼å¯¹äºå…¶ä»–çº¿ç¨‹æ¥è¯´æ˜¯å¯ä»¥ç«‹å³å¾—çŸ¥çš„ã€‚è€Œæ™®é€šå˜é‡ä¸èƒ½åšåˆ°è¿™ä¸€ç‚¹,æ™®é€šå˜é‡çš„å€¼åœ¨çº¿ç¨‹é—´ä¼ é€’å‡éœ€è¦é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆ,ä¾‹å¦‚,çº¿ç¨‹Aä¿®æ”¹ä¸€ä¸ªæ™®é€šå˜é‡çš„å€¼,ç„¶åå‘ä¸»å†…å­˜è¿›è¡Œå›å†™,å¦å¤–ä¸€æ¡çº¿ç¨‹Båœ¨çº¿ç¨‹Aå›å†™å®Œæˆäº†ä¹‹åå†ä»ä¸»å†…å­˜è¿›è¡Œè¯»å–æ“ä½œ,æ–°å˜é‡å€¼æ‰ä¼šå¯¹çº¿ç¨‹Bå¯è§ã€‚ æ³¨æ„è¿™ä¸ªæ–¹æ³•å¹¶ä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œåªèƒ½ä¿è¯å¯è§æ€§ é¢„æœŸè¾“å‡ºä¸º200000å®é™…å¹¶ä¸æ˜¯ï¼Œå› ä¸ºjavaä¸­è¿ç®—æ“ä½œå¹¶ä¸æ˜¯åŸå­æ“ä½œï¼Œä¼šæœ‰å­—èŠ‚ç é‡æ’åºçš„æƒ…å†µå‘ç”Ÿ volatileå¯¹ longå’Œdoubleå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™ Javaå†…å­˜æ¨¡å‹è¦æ±‚lockã€unlockã€readã€loadã€assignã€useã€storeã€writeè¿™8ä¸ªæ“ä½œéƒ½å…·æœ‰åŸå­æ€§,ä½†æ˜¯å¯¹äº64ä½çš„æ•°æ®ç±»å‹(longå’Œdouble),åœ¨æ¨¡å‹ä¸­ç‰¹åˆ«å®šä¹‰äº†ä¸€æ¡ç›¸å¯¹å®½æ¾çš„è§„å®š:å…è®¸è™šæ‹Ÿæœºå°†æ²¡æœ‰è¢«volatileä¿®é¥°çš„64ä½æ•°æ®çš„è¯»å†™æ“ä½œåˆ’åˆ†ä¸ºä¸¤æ¬¡32ä½çš„æ“ä½œæ¥è¿›è¡Œ,å³å…è®¸è™šæ‹Ÿæœºå®ç°é€‰æ‹©å¯ä»¥ä¸ä¿è¯64ä½æ•°æ®ç±»å‹çš„loadã€storeã€readå’Œwriteè¿™4ä¸ªæ“ä½œçš„åŸå­æ€§å¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹å…±äº«ä¸€ä¸ªå¹¶æœªå£°æ˜ä¸ºvolatileçš„longæˆ–doubleç±»å‹çš„å˜é‡,å¹¶ä¸”åŒæ—¶å¯¹å®ƒä»¬è¿›è¡Œè¯»å–å’Œä¿®æ”¹æ“ä½œ,é‚£ä¹ˆæŸäº›çº¿ç¨‹å¯èƒ½ä¼šè¯»å–åˆ°ä¸€ä¸ªæ—¢éåŸå€¼,ä¹Ÿä¸æ˜¯å…¶ä»–çº¿ç¨‹ä¿®æ”¹å€¼çš„ä»£è¡¨äº†â€œåŠä¸ªå˜é‡â€çš„æ•°å€¼ æ³¨æ„ï¼šç›®å‰å„ç§å¹³å°ä¸‹çš„å•†ç”¨è™šæ‹Ÿæœºå‡ ä¹éƒ½é€‰æ‹©æŠŠ64ä½æ•°æ®çš„è¯»å†™æ“ä½œä½œä¸ºåŸå­æ“ä½œæ¥å¯¹å¾…,å› æ­¤æˆ‘ä»¬åœ¨ç¼–å†™ä»£ç æ—¶ä¸€èˆ¬ä¸éœ€è¦æŠŠç”¨åˆ°çš„longå’Œdoubleå˜é‡ä¸“é—¨å£°æ˜ä¸ºvolatile åŸå­æ€§ã€å¯è§æ€§ä¸æœ‰åºæ€§ åŸå­æ€§(Atomicity):ç”±Javaå†…å­˜æ¨¡å‹æ¥ç›´æ¥ä¿è¯çš„åŸå­æ€§å˜é‡æ“ä½œåŒ…æ‹¬readã€loadã€assignã€useã€storeå’Œwrite,æˆ‘ä»¬å¤§è‡´å¯ä»¥è®¤ä¸ºåŸºæœ¬æ•°æ®ç±»å‹çš„è®¿é—®è¯»å†™æ˜¯å…·å¤‡åŸå­æ€§çš„(ä¾‹å¤–å°±æ˜¯longå’Œdoubleçš„éåŸå­æ€§åå®š,è¯»è€…åªè¦çŸ¥é“è¿™ä»¶äº‹æƒ…å°±å¯ä»¥äº†,æ— é¡»å¤ªè¿‡åœ¨æ„è¿™äº›å‡ ä¹ä¸ä¼šå‘ç”Ÿçš„ä¾‹å¤–æƒ…å†µ)ã€‚ å¦‚æœåº”ç”¨åœºæ™¯éœ€è¦ä¸€ä¸ªæ›´å¤§èŒƒå›´çš„åŸå­æ€§ä¿è¯(ç»å¸¸ä¼šé‡åˆ°),Javaå†…å­˜æ¨¡å‹è¿˜æä¾›äº†lockå’Œunlockæ“ä½œæ¥æ»¡è¶³è¿™ç§éœ€æ±‚,å°½ç®¡è™šæ‹ŸæœºæœªæŠŠlockå’Œunlockæ“ä½œç›´æ¥å¼€æ”¾ç»™ç”¨æˆ·ä½¿ç”¨,ä½†æ˜¯å´æä¾›äº†æ›´é«˜å±‚æ¬¡çš„å­—èŠ‚ç æŒ‡ä»¤monitorenterå’Œmonitorexitæ¥éšå¼åœ°ä½¿ç”¨è¿™ä¸¤ä¸ªæ“ä½œ,è¿™ä¸¤ä¸ªå­—èŠ‚ç æŒ‡ä»¤åæ˜ åˆ°Javaä»£ç ä¸­å°±æ˜¯åŒæ­¥å—â€”â€”synchronizedå…³é”®å­—,å› æ­¤åœ¨synchronizedå—ä¹‹é—´çš„æ“ä½œä¹Ÿå…·å¤‡åŸå­æ€§ã€‚ å¯è§æ€§(Visibility):å¯è§æ€§æ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼,å…¶ä»–çº¿ç¨‹èƒ½å¤Ÿç«‹å³å¾—çŸ¥è¿™ä¸ªä¿®æ”¹ã€‚é™¤äº†volatileä¹‹å¤–,Javaè¿˜æœ‰ä¸¤ä¸ªå…³é”®å­—èƒ½å®ç°å¯è§æ€§,å³synchronizedå’Œfinalã€‚ æœ‰åºæ€§(Ordering):Javaå†…å­˜æ¨¡å‹çš„æœ‰åºæ€§åœ¨å‰é¢è®²è§£volatileæ—¶ä¹Ÿè¯¦ç»†åœ°è®¨è®ºè¿‡äº†,Javaç¨‹åºä¸­å¤©ç„¶çš„æœ‰åºæ€§å¯ä»¥æ€»ç»“ä¸ºä¸€å¥è¯:å¦‚æœåœ¨æœ¬çº¿ç¨‹å†…è§‚å¯Ÿ,æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æœ‰åºçš„;å¦‚æœåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è§‚å¯Ÿå¦ä¸€ä¸ªçº¿ç¨‹,æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æ— åºçš„ã€‚å‰åŠå¥æ˜¯æŒ‡â€œçº¿ç¨‹å†…è¡¨ç°ä¸ºä¸²è¡Œçš„è¯­ä¹‰â€(Within-Thread As-If-Serial Semantics),ååŠå¥æ˜¯æŒ‡â€œæŒ‡ä»¤é‡æ’åºâ€ç°è±¡å’Œâ€œå·¥ä½œå†…å­˜ä¸ä¸»å†…å­˜åŒæ­¥å»¶è¿Ÿâ€ç°è±¡ ç»“è®º:ä¸€ä¸ªæ“ä½œâ€œæ—¶é—´ä¸Šçš„å…ˆå‘ç”Ÿâ€ä¸ä»£è¡¨è¿™ä¸ªæ“ä½œä¼šæ˜¯â€œå…ˆè¡Œå‘ç”Ÿâ€œ Javaä¸çº¿ç¨‹å¯¹äºSun JDKæ¥è¯´,å®ƒçš„Windowsç‰ˆä¸Linuxç‰ˆéƒ½æ˜¯ä½¿ç”¨ä¸€å¯¹ä¸€çš„çº¿ç¨‹æ¨¡å‹å®ç°çš„,ä¸€æ¡Javaçº¿ç¨‹å°±æ˜ å°„åˆ°ä¸€æ¡è½»é‡çº§è¿›ç¨‹ä¹‹ä¸­,å› ä¸ºWindowså’ŒLinuxç³»ç»Ÿæä¾›çš„çº¿ç¨‹æ¨¡å‹å°±æ˜¯ä¸€å¯¹ä¸€çš„ Javaçº¿ç¨‹è°ƒåº¦çº¿ç¨‹è°ƒåº¦æ˜¯æŒ‡ç³»ç»Ÿä¸ºçº¿ç¨‹åˆ†é…å¤„ç†å™¨ä½¿ç”¨æƒçš„è¿‡ç¨‹,ä¸»è¦è°ƒåº¦æ–¹å¼æœ‰ä¸¤ç§,åˆ†åˆ«æ˜¯ååŒå¼çº¿ç¨‹è°ƒåº¦(CooperativeThreads-Scheduling)å’ŒæŠ¢å å¼çº¿ç¨‹è°ƒåº¦(PreemptiveThreads-Scheduling) çŠ¶æ€è½¬æ¢ æ–°å»º(New):åˆ›å»ºåå°šæœªå¯åŠ¨çš„çº¿ç¨‹å¤„äºè¿™ç§çŠ¶æ€ã€‚ è¿è¡Œ(Runable):RunableåŒ…æ‹¬äº†æ“ä½œç³»ç»Ÿçº¿ç¨‹çŠ¶æ€ä¸­çš„Runningå’ŒReady,ä¹Ÿå°±æ˜¯å¤„äºæ­¤çŠ¶æ€çš„çº¿ç¨‹æœ‰å¯èƒ½æ­£åœ¨æ‰§è¡Œ,ä¹Ÿæœ‰å¯èƒ½æ­£åœ¨ç­‰å¾…ç€CPUä¸ºå®ƒåˆ†é…æ‰§è¡Œæ—¶é—´ã€‚ æ— é™æœŸç­‰å¾…(Waiting):å¤„äºè¿™ç§çŠ¶æ€çš„çº¿ç¨‹ä¸ä¼šè¢«åˆ†é…CPUæ‰§è¡Œæ—¶é—´,å®ƒä»¬è¦ç­‰å¾…è¢«å…¶ä»–çº¿ç¨‹æ˜¾å¼åœ°å”¤é†’ã€‚ä»¥ä¸‹æ–¹æ³•ä¼šè®©çº¿ç¨‹é™·å…¥æ— é™æœŸçš„ç­‰å¾…çŠ¶æ€:â—æ²¡æœ‰è®¾ç½®Timeoutå‚æ•°çš„Object.wait()æ–¹æ³•ã€‚â—æ²¡æœ‰è®¾ç½®Timeoutå‚æ•°çš„Thread.join()æ–¹æ³•ã€‚â—LockSupport.park()æ–¹æ³•ã€‚ é™æœŸç­‰å¾…(Timed Waiting):å¤„äºè¿™ç§çŠ¶æ€çš„çº¿ç¨‹ä¹Ÿä¸ä¼šè¢«åˆ†é…CPUæ‰§è¡Œæ—¶é—´,ä¸è¿‡æ— é¡»ç­‰å¾…è¢«å…¶ä»–çº¿ç¨‹æ˜¾å¼åœ°å”¤é†’,åœ¨ä¸€å®šæ—¶é—´ä¹‹åå®ƒä»¬ä¼šç”±ç³»ç»Ÿè‡ªåŠ¨å”¤é†’ã€‚ä»¥ä¸‹æ–¹æ³•ä¼šè®©çº¿ç¨‹è¿›å…¥é™æœŸç­‰å¾…çŠ¶æ€:â—Thread.sleep()æ–¹æ³•ã€‚â—è®¾ç½®äº†Timeoutå‚æ•°çš„Object.wait()æ–¹æ³•ã€‚â—è®¾ç½®äº†Timeoutå‚æ•°çš„Thread.join()æ–¹æ³•ã€‚â—LockSupport.parkNanos()æ–¹æ³•ã€‚â—LockSupport.parkUntil()æ–¹æ³•ã€‚ é˜»å¡(Blocked):çº¿ç¨‹è¢«é˜»å¡äº†,â€œé˜»å¡çŠ¶æ€â€ä¸â€œç­‰å¾…çŠ¶æ€â€çš„åŒºåˆ«æ˜¯:â€œé˜»å¡çŠ¶æ€â€åœ¨ç­‰å¾…ç€è·å–åˆ°ä¸€ä¸ªæ’ä»–é”,è¿™ä¸ªäº‹ä»¶å°†åœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ”¾å¼ƒè¿™ä¸ªé”çš„æ—¶å€™å‘ç”Ÿ;è€Œâ€œç­‰å¾…çŠ¶æ€â€åˆ™æ˜¯åœ¨ç­‰å¾…ä¸€æ®µæ—¶é—´,æˆ–è€…å”¤é†’åŠ¨ä½œçš„å‘ç”Ÿã€‚åœ¨ç¨‹åºç­‰å¾…è¿›å…¥åŒæ­¥åŒºåŸŸçš„æ—¶å€™,çº¿ç¨‹å°†è¿›å…¥è¿™ç§çŠ¶æ€ã€‚ ç»“æŸ(Terminated):å·²ç»ˆæ­¢çº¿ç¨‹çš„çº¿ç¨‹çŠ¶æ€,çº¿ç¨‹å·²ç»ç»“æŸæ‰§è¡Œã€‚","date":"2024-12-31","categories":["java"],"tags":["javaå¤šçº¿ç¨‹"]},{"title":"java-å¤šçº¿ç¨‹ç¼–ç¨‹3-çº¿ç¨‹å®‰å…¨","url":"/2024/12/31/java-å¤šçº¿ç¨‹ç¼–ç¨‹3-çº¿ç¨‹å®‰å…¨/","content":"Javaè¯­è¨€ä¸­çš„çº¿ç¨‹å®‰å…¨ç­‰çº§ æŒ‰ç…§çº¿ç¨‹å®‰å…¨çš„â€œå®‰å…¨ç¨‹åº¦â€ç”±å¼ºè‡³å¼±æ¥æ’åº,æˆ‘ä»¬ å¯ä»¥å°†Javaè¯­è¨€ä¸­å„ç§æ“ä½œå…±äº«çš„æ•°æ®åˆ†ä¸ºä»¥ä¸‹5ç±»:ä¸å¯å˜ã€ç»å¯¹çº¿ç¨‹å®‰å…¨ã€ç›¸å¯¹çº¿ç¨‹å®‰å…¨ã€çº¿ç¨‹å…¼å®¹å’Œçº¿ç¨‹å¯¹ç«‹ã€‚ ä¸å¯å˜ï¼šå¦‚finalå…³é”®å­— å®šä¹‰çš„æ•°æ®ä¸å¯ä¿®æ”¹ï¼Œå¯é æ€§æœ€é«˜ ç»å¯¹çº¿ç¨‹å®‰å…¨ï¼šç»å¯¹çš„çº¿ç¨‹å®‰å…¨å®Œå…¨æ»¡è¶³Brian Goetzç»™å‡ºçš„çº¿ç¨‹å®‰å…¨çš„å®šä¹‰,è¿™ä¸ªå®šä¹‰å…¶å®æ˜¯å¾ˆä¸¥æ ¼çš„,ä¸€ä¸ªç±»è¦è¾¾åˆ°â€œä¸ç®¡è¿è¡Œæ—¶ç¯å¢ƒå¦‚ä½•,è°ƒç”¨è€…éƒ½ä¸éœ€è¦ä»»ä½•é¢å¤–çš„åŒæ­¥æªæ–½â€é€šå¸¸éœ€è¦ä»˜å‡ºå¾ˆå¤§çš„,ç”šè‡³æœ‰æ—¶å€™æ˜¯ä¸åˆ‡å®é™…çš„ä»£ä»·ã€‚ ç›¸å¯¹çº¿ç¨‹å®‰å…¨ï¼šç›¸å¯¹çš„çº¿ç¨‹å®‰å…¨å°±æ˜¯æˆ‘ä»¬é€šå¸¸æ„ä¹‰ä¸Šæ‰€è®²çš„çº¿ç¨‹å®‰å…¨,å®ƒéœ€è¦ä¿è¯å¯¹è¿™ä¸ªå¯¹è±¡å•ç‹¬çš„æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„,æˆ‘ä»¬åœ¨è°ƒç”¨çš„æ—¶å€™ä¸éœ€è¦åšé¢å¤–çš„ä¿éšœæªæ–½,ä½†æ˜¯å¯¹äºä¸€äº›ç‰¹å®šé¡ºåºçš„è¿ç»­è°ƒç”¨,å°±å¯èƒ½éœ€è¦åœ¨è°ƒç”¨ç«¯ä½¿ç”¨é¢å¤–çš„åŒæ­¥æ‰‹æ®µæ¥ä¿è¯è°ƒç”¨çš„æ­£ç¡®æ€§ï¼Œåœ¨Javaè¯­è¨€ä¸­,å¤§éƒ¨åˆ†çš„çº¿ç¨‹å®‰å…¨ç±»éƒ½å±äºè¿™ç§ç±»å‹,ä¾‹å¦‚Vectorã€HashTableã€Collectionsçš„synchronizedCollection()æ–¹æ³•åŒ…è£…çš„é›†åˆç­‰ çº¿ç¨‹å…¼å®¹ï¼šçº¿ç¨‹å…¼å®¹æ˜¯æŒ‡å¯¹è±¡æœ¬èº«å¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„,ä½†æ˜¯å¯ä»¥é€šè¿‡åœ¨è°ƒç”¨ç«¯æ­£ç¡®åœ°ä½¿ç”¨åŒæ­¥æ‰‹æ®µæ¥ä¿è¯å¯¹è±¡åœ¨å¹¶å‘ç¯å¢ƒä¸­å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨,æˆ‘ä»¬å¹³å¸¸è¯´ä¸€ä¸ªç±»ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„,ç»å¤§å¤šæ•°æ—¶å€™æŒ‡çš„æ˜¯è¿™ä¸€ç§æƒ…å†µ çº¿ç¨‹å¯¹ç«‹ï¼šçº¿ç¨‹å¯¹ç«‹æ˜¯æŒ‡æ— è®ºè°ƒç”¨ç«¯æ˜¯å¦é‡‡å–äº†åŒæ­¥æªæ–½,éƒ½æ— æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å¹¶å‘ä½¿ç”¨çš„ä»£ç ã€‚ç”±äºJavaè¯­è¨€å¤©ç”Ÿå°±å…·å¤‡å¤šçº¿ç¨‹ç‰¹æ€§,çº¿ç¨‹å¯¹ç«‹è¿™ç§æ’æ–¥å¤šçº¿ç¨‹çš„ä»£ç æ˜¯å¾ˆå°‘å‡ºç°çš„,è€Œä¸”é€šå¸¸éƒ½æ˜¯æœ‰å®³çš„,åº”å½“å°½é‡é¿å… çº¿ç¨‹åŒæ­¥çš„å®ç°æ–¹æ³•äº’æ–¥åŒæ­¥ï¼šäº’æ–¥åŒæ­¥(Mutual Exclusion&Synchronization)æ˜¯å¸¸è§çš„ä¸€ç§å¹¶å‘æ­£ç¡®æ€§ä¿éšœæ‰‹æ®µã€‚åŒæ­¥æ˜¯æŒ‡åœ¨å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«æ•°æ®æ—¶,ä¿è¯å…±äº«æ•°æ®åœ¨åŒä¸€ä¸ªæ—¶åˆ»åªè¢«ä¸€ä¸ª(æˆ–è€…æ˜¯ä¸€äº›,ä½¿ç”¨ä¿¡å·é‡çš„æ—¶å€™)çº¿ç¨‹ä½¿ç”¨ã€‚è€Œäº’æ–¥æ˜¯å®ç°åŒæ­¥çš„ä¸€ç§æ‰‹æ®µ,ä¸´ç•ŒåŒº(CriticalSection)ã€äº’æ–¥é‡(Mutex)å’Œä¿¡å·é‡(Semaphore)éƒ½æ˜¯ä¸»è¦çš„äº’æ–¥å®ç°æ–¹å¼ã€‚å› æ­¤,åœ¨è¿™4ä¸ªå­—é‡Œé¢,äº’æ–¥æ˜¯å› ,åŒæ­¥æ˜¯æœ;äº’æ–¥æ˜¯æ–¹æ³•,åŒæ­¥æ˜¯ç›®çš„ã€‚ å¼•ç”³ï¼šjvmæ‰§è¡ŒmonitorenteræŒ‡ä»¤æ—¶,é¦–å…ˆè¦å°è¯•è·å–å¯¹è±¡çš„é”ã€‚å¦‚æœè¿™ä¸ªå¯¹è±¡æ²¡è¢«é”å®š,æˆ–è€…å½“å‰çº¿ç¨‹å·²ç»æ‹¥æœ‰äº†é‚£ä¸ªå¯¹è±¡çš„é”,æŠŠé”çš„è®¡æ•°å™¨åŠ 1,ç›¸åº”çš„,åœ¨æ‰§è¡ŒmonitorexitæŒ‡ä»¤æ—¶ä¼šå°†é”è®¡æ•°å™¨å‡1,å½“è®¡æ•°å™¨ä¸º0æ—¶,é”å°±è¢«é‡Šæ”¾ java sybcgrinizedæ˜¯é‡é‡çº§é”çš„åŸå› ï¼šJavaçš„çº¿ç¨‹æ˜¯æ˜ å°„åˆ°æ“ä½œç³»ç»Ÿçš„åŸç”Ÿçº¿ç¨‹ä¹‹ä¸Šçš„,å¦‚æœè¦é˜»å¡æˆ–å”¤é†’ä¸€ä¸ªçº¿ç¨‹,éƒ½éœ€è¦æ“ä½œç³»ç»Ÿæ¥å¸®å¿™å®Œæˆ,è¿™å°±éœ€è¦ä»ç”¨æˆ·æ€è½¬æ¢åˆ°æ ¸å¿ƒæ€ä¸­,å› æ­¤çŠ¶æ€è½¬æ¢éœ€è¦è€—è´¹å¾ˆå¤šçš„å¤„ç†å™¨æ—¶é—´ã€‚å¯¹äºä»£ç ç®€å•çš„åŒæ­¥å—(å¦‚è¢«synchronizedä¿®é¥°çš„getter()æˆ–setter()æ–¹æ³•),çŠ¶æ€è½¬æ¢æ¶ˆè€—çš„æ—¶é—´æœ‰å¯èƒ½æ¯”ç”¨æˆ·ä»£ç æ‰§è¡Œçš„æ—¶é—´è¿˜è¦é•¿ã€‚æ‰€ä»¥synchronizedæ˜¯Javaè¯­è¨€ä¸­ä¸€ä¸ªé‡é‡çº§(Heavyweight)çš„æ“ä½œ,æœ‰ç»éªŒçš„ç¨‹åºå‘˜éƒ½ä¼šåœ¨ç¡®å®å¿…è¦çš„æƒ…å†µä¸‹æ‰ä½¿ç”¨è¿™ç§æ“ä½œ æ³¨æ„ï¼šäº’æ–¥åŒæ­¥æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯è¿›è¡Œçº¿ç¨‹é˜»å¡å’Œå”¤é†’æ‰€å¸¦æ¥çš„æ€§èƒ½é—®é¢˜,å› æ­¤è¿™ç§åŒæ­¥ä¹Ÿç§°ä¸ºé˜»å¡åŒæ­¥(Blocking Synchronization)ï¼šäº’æ–¥åŒæ­¥å±äºä¸€ç§æ‚²è§‚çš„å¹¶å‘ç­–ç•¥,æ€»æ˜¯è®¤ä¸ºåªè¦ä¸å»åšæ­£ç¡®çš„åŒæ­¥æªæ–½(ä¾‹å¦‚åŠ é”),é‚£å°±è‚¯å®šä¼šå‡ºç°é—®é¢˜,æ— è®ºå…±äº«æ•°æ®æ˜¯å¦çœŸçš„ä¼šå‡ºç°ç«äº‰,å®ƒéƒ½è¦è¿›è¡ŒåŠ é”(è¿™é‡Œè®¨è®ºçš„æ˜¯æ¦‚å¿µæ¨¡å‹,å®é™…ä¸Šè™šæ‹Ÿæœºä¼šä¼˜åŒ–æ‰å¾ˆå¤§ä¸€éƒ¨åˆ†ä¸å¿…è¦çš„åŠ é”)ã€ç”¨æˆ·æ€æ ¸å¿ƒæ€è½¬æ¢ã€ç»´æŠ¤é”è®¡æ•°å™¨å’Œæ£€æŸ¥æ˜¯å¦æœ‰è¢«é˜»å¡çš„çº¿ç¨‹éœ€è¦å”¤é†’ç­‰æ“ä½œ éé˜»å¡åŒæ­¥:ç¡¬ä»¶æŒ‡ä»¤é›†çš„å‘å±•,å‡ºç°åŸºäºå†²çªæ£€æµ‹çš„ä¹è§‚å¹¶å‘ç­–ç•¥,é€šä¿—åœ°è¯´,å°±æ˜¯å…ˆè¿›è¡Œæ“ä½œ,å¦‚æœæ²¡æœ‰å…¶ä»–çº¿ç¨‹äº‰ç”¨å…±äº«æ•°æ®,é‚£æ“ä½œå°±æˆåŠŸäº†;å¦‚æœå…±äº«æ•°æ®æœ‰äº‰ç”¨,äº§ç”Ÿäº†å†²çª,é‚£å°±å†é‡‡å–å…¶ä»–çš„è¡¥å¿æªæ–½(æœ€å¸¸è§çš„è¡¥å¿æªæ–½å°±æ˜¯ä¸æ–­åœ°é‡è¯•,ç›´åˆ°æˆåŠŸä¸ºæ­¢),è¿™ç§ä¹è§‚çš„å¹¶å‘ç­–ç•¥çš„è®¸å¤šå®ç°éƒ½ä¸éœ€è¦æŠŠçº¿ç¨‹æŒ‚èµ·,å› æ­¤è¿™ç§åŒæ­¥æ“ä½œç§°ä¸ºéé˜»å¡åŒæ­¥(Non-Blocking Synchronization) å¼•ç”³éé˜»å¡çš„å®ç°CASï¼šCASæŒ‡ä»¤éœ€è¦æœ‰3ä¸ªæ“ä½œæ•°,åˆ†åˆ«æ˜¯å†…å­˜ä½ç½®(åœ¨Javaä¸­å¯ä»¥ç®€å•ç†è§£ä¸ºå˜é‡çš„å†…å­˜åœ°å€,ç”¨Vè¡¨ç¤º)ã€æ—§çš„é¢„æœŸå€¼(ç”¨Aè¡¨ç¤º)å’Œæ–°å€¼(ç”¨Bè¡¨ç¤º)ã€‚CASæŒ‡ä»¤æ‰§è¡Œæ—¶,å½“ä¸”ä»…å½“Vå¤„çš„å€¼ç¬¦åˆæ—§é¢„æœŸå€¼Aæ—¶,å¤„ç†å™¨ç”¨æ–°å€¼Bæ›´æ–°Vå¤„çš„å€¼,å¦åˆ™å®ƒå°±ä¸æ‰§è¡Œæ›´æ–°,ä½†æ˜¯æ— è®ºæ˜¯å¦æ›´æ–°äº†Vå¤„çš„å€¼,éƒ½ä¼šè¿”å›Vçš„æ—§å€¼,ä¸Šè¿°çš„å¤„ç†è¿‡ç¨‹æ˜¯ä¸€ä¸ªåŸå­æ“ä½œã€‚ JDK1.5ä¹‹å,Javaç¨‹åºä¸­æ‰å¯ä»¥ä½¿ç”¨CASæ“ä½œï¼šæ“ä½œç”±sun.misc.Unsafeç±»é‡Œé¢çš„compareAndSwapInt()å’ŒcompareAndSwapLong()ç­‰å‡ ä¸ªæ–¹æ³•åŒ…è£…æä¾›ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡å…¶ä»–çš„JavaAPIæ¥é—´æ¥ä½¿ç”¨å®ƒ,å¦‚J.U.CåŒ…é‡Œé¢çš„æ•´æ•°åŸå­ç±»,å…¶ä¸­çš„compareAndSet()å’ŒgetAndIncrement()ç­‰æ–¹æ³•éƒ½ä½¿ç”¨äº†Unsafeç±»çš„CASæ“ä½œ CASç¼ºç‚¹ ABAé—®é¢˜ã€‚å› ä¸ºCASéœ€è¦åœ¨æ“ä½œå€¼çš„æ—¶å€™æ£€æŸ¥ä¸‹å€¼æœ‰æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿå˜åŒ–åˆ™æ›´æ–°ï¼Œä½†æ˜¯å¦‚æœä¸€ä¸ªå€¼åŸæ¥æ˜¯Aï¼Œå˜æˆäº†Bï¼Œåˆå˜æˆäº†Aï¼Œé‚£ä¹ˆä½¿ç”¨CASè¿›è¡Œæ£€æŸ¥æ—¶ä¼šå‘ç°å®ƒçš„å€¼æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯å®é™…ä¸Šå´å˜åŒ–äº†ã€‚ABAé—®é¢˜çš„è§£å†³æ€è·¯å°±æ˜¯ä½¿ç”¨ç‰ˆæœ¬å·ã€‚åœ¨å˜é‡å‰é¢è¿½åŠ ä¸Šç‰ˆæœ¬å·ï¼Œæ¯æ¬¡å˜é‡æ›´æ–°çš„æ—¶å€™æŠŠç‰ˆæœ¬å·åŠ ä¸€ï¼Œé‚£ä¹ˆAï¼Bï¼A å°±ä¼šå˜æˆ1A-2Bï¼3Aã€‚JDKçš„atomicåŒ…é‡Œæä¾›äº†ä¸€ä¸ªç±»AtomicStampedReferenceæ¥è§£å†³ABAé—®é¢˜ã€‚è¿™ä¸ªç±»çš„compareAndSetæ–¹æ³•ä½œç”¨æ˜¯é¦–å…ˆæ£€æŸ¥å½“å‰å¼•ç”¨æ˜¯å¦ç­‰äºé¢„æœŸå¼•ç”¨ï¼Œå¹¶ä¸”å½“å‰æ ‡å¿—æ˜¯å¦ç­‰äºé¢„æœŸæ ‡å¿—ï¼Œå¦‚æœå…¨éƒ¨ç›¸ç­‰ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†è¯¥å¼•ç”¨å’Œè¯¥æ ‡å¿—çš„å€¼è®¾ç½®ä¸ºç»™å®šçš„æ›´æ–°å€¼ã€‚ å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§ã€‚è‡ªæ—‹CASå¦‚æœé•¿æ—¶é—´ä¸æˆåŠŸï¼Œä¼šç»™CPUå¸¦æ¥éå¸¸å¤§çš„æ‰§è¡Œå¼€é”€ã€‚ åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œã€‚å½“å¯¹ä¸€ä¸ªå…±äº«å˜é‡æ‰§è¡Œæ“ä½œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¾ªç¯CASçš„æ–¹å¼æ¥ä¿è¯åŸå­æ“ä½œï¼Œä½†æ˜¯å¯¹å¤šä¸ªå…±äº«å˜é‡æ“ä½œæ—¶ï¼Œå¾ªç¯CASå°±æ— æ³•ä¿è¯æ“ä½œçš„åŸå­æ€§ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨é”ï¼Œæˆ–è€…æœ‰ä¸€ä¸ªå–å·§çš„åŠæ³•ï¼Œå°±æ˜¯æŠŠå¤šä¸ªå…±äº«å˜é‡åˆå¹¶æˆä¸€ä¸ªä»Java1.5å¼€å§‹JDKæä¾›äº†AtomicReferenceç±»æ¥ä¿è¯å¼•ç”¨å¯¹è±¡ä¹‹é—´çš„åŸå­æ€§ï¼Œä½ å¯ä»¥æŠŠå¤šä¸ªå˜é‡æ”¾åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œæ¥è¿›è¡ŒCASæ“ä½œã€‚å…±äº«å˜é‡æ¥æ“ä½œã€‚ æ— éœ€çº¿ç¨‹åŒæ­¥æ–¹æ¡ˆæœ‰äº›æœ‰ä¸€äº›ä»£ç å¤©ç”Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„,ç¬”è€…ç®€å•åœ°ä»‹ç»å…¶ä¸­çš„ä¸¤ç±»ï¼šæ— éœ€åŒæ­¥æ–¹æ¡ˆï¼šæœ‰äº›æœ‰ä¸€äº›ä»£ç å¤©ç”Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„,ç¬”è€…ç®€å•åœ°ä»‹ç»å…¶ä¸­çš„ä¸¤ç±» å¯é‡å…¥ä»£ç (Reentrant Code):ä¸ä¾èµ–å­˜å‚¨åœ¨å †ä¸Šçš„æ•°æ®å’Œå…¬ç”¨çš„ç³»ç»Ÿèµ„æºã€ç”¨åˆ°çš„çŠ¶æ€é‡éƒ½ç”±å‚æ•°ä¸­ä¼ å…¥ã€ä¸è°ƒç”¨éå¯é‡å…¥çš„æ–¹æ³• çº¿ç¨‹æœ¬åœ°å­˜å‚¨(Thread Local Storage):çº¿ç¨‹å”¯ä¸€å˜é‡ï¼Œjavaä¸­çš„java.lang.ThreadLocalç±»æ¥å®ç°çº¿ç¨‹æœ¬åœ°å­˜å‚¨çš„åŠŸèƒ½ ThreadLocalå®ç°åŸç† ä¸€ä¸ªçº¿ç¨‹çš„Threadå¯¹è±¡ä¸­éƒ½æœ‰ä¸€ä¸ªThreadLocalMapå¯¹è±¡,è¿™ä¸ªå¯¹è±¡å­˜å‚¨äº†ä¸€ç»„ä»¥ThreadLocal.threadLocalHashCodeä¸ºé”®,ä»¥æœ¬åœ°çº¿ç¨‹å˜é‡ä¸ºå€¼çš„K-Vå€¼å¯¹,ThreadLocalå¯¹è±¡å°±æ˜¯å½“å‰çº¿ç¨‹çš„ThreadLocalMapçš„è®¿é—®å…¥å£,æ¯ä¸€ä¸ªThreadLocalå¯¹è±¡éƒ½åŒ…å«äº†ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„threadLocalHashCodeå€¼,ä½¿ç”¨è¿™ä¸ªå€¼å°±å¯ä»¥åœ¨çº¿ç¨‹K-Vå€¼å¯¹ä¸­æ‰¾å›å¯¹åº”çš„æœ¬åœ°çº¿ç¨‹å˜é‡ã€‚","date":"2024-12-31","categories":["java"],"tags":["javaå¤šçº¿ç¨‹"]},{"title":"java-å¤šçº¿ç¨‹ç¼–ç¨‹4-è™šæ‹Ÿæœºçš„é”ä¼˜åŒ–æŠ€æœ¯","url":"/2024/12/31/java-å¤šçº¿ç¨‹ç¼–ç¨‹4-è™šæ‹Ÿæœºçš„é”ä¼˜åŒ–æŠ€æœ¯/","content":"è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹è™šæ‹Ÿæœºçš„å¼€å‘å›¢é˜Ÿä¹Ÿæ³¨æ„åˆ°åœ¨è®¸å¤šåº”ç”¨ä¸Š,å…±äº«æ•°æ®çš„é”å®šçŠ¶æ€åªä¼šæŒç»­å¾ˆçŸ­çš„ä¸€æ®µæ—¶é—´,ä¸ºäº†è¿™æ®µæ—¶é—´å»æŒ‚èµ·å’Œæ¢å¤çº¿ç¨‹å¹¶ä¸å€¼å¾—ã€‚å¦‚æœç‰©ç†æœºå™¨æœ‰ä¸€ä¸ªä»¥ä¸Šçš„å¤„ç†å™¨,èƒ½è®©ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„çº¿ç¨‹åŒæ—¶å¹¶è¡Œæ‰§è¡Œ,æˆ‘ä»¬å°±å¯ä»¥è®©åé¢è¯·æ±‚é”çš„é‚£ä¸ªçº¿ç¨‹â€œç¨ç­‰ä¸€ä¸‹â€,ä½†ä¸æ”¾å¼ƒå¤„ç†å™¨çš„æ‰§è¡Œæ—¶é—´,çœ‹çœ‹æŒæœ‰é”çš„çº¿ç¨‹æ˜¯å¦å¾ˆå¿«å°±ä¼šé‡Šæ”¾é”ã€‚ä¸ºäº†è®©çº¿ç¨‹ç­‰å¾…,æˆ‘ä»¬åªéœ€è®©çº¿ç¨‹æ‰§è¡Œä¸€ä¸ªå¿™å¾ªç¯(è‡ªæ—‹),è¿™é¡¹æŠ€æœ¯å°±æ˜¯æ‰€è°“çš„è‡ªæ—‹é” æ³¨æ„ï¼šå¦‚æœè‡ªæ—‹è¶…è¿‡äº†é™å®šçš„æ¬¡æ•°ä»ç„¶æ²¡æœ‰æˆåŠŸè·å¾—é”,å°±åº”å½“ä½¿ç”¨ä¼ ç»Ÿçš„æ–¹å¼å»æŒ‚èµ·çº¿ç¨‹äº†ã€‚è‡ªæ—‹æ¬¡æ•°çš„é»˜è®¤å€¼æ˜¯10æ¬¡,ç”¨æˆ·å¯ä»¥ä½¿ç”¨å‚æ•°-XX:PreBlockSpinæ¥æ›´æ”¹ åœ¨JDK 1.6ä¸­å¼•å…¥äº†è‡ªé€‚åº”çš„è‡ªæ—‹é”ã€‚è‡ªé€‚åº”æ„å‘³ç€è‡ªæ—‹çš„æ—¶é—´ä¸å†å›ºå®šäº†,è€Œæ˜¯ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ—¶é—´åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®šã€‚è‡ªæ—‹æˆåŠŸç‡é«˜å°±è‡ªæ—‹å¤šæ¬¡ï¼Œåä¹‹å°±å‡å°‘ é”æ¶ˆé™¤é”æ¶ˆé™¤æ˜¯æŒ‡è™šæ‹Ÿæœºå³æ—¶ç¼–è¯‘å™¨åœ¨è¿è¡Œæ—¶,å¯¹ä¸€äº›ä»£ç ä¸Šè¦æ±‚åŒæ­¥,ä½†æ˜¯è¢«æ£€æµ‹åˆ°ä¸å¯èƒ½å­˜åœ¨å…±äº«æ•°æ®ç«äº‰çš„é”è¿›è¡Œæ¶ˆé™¤ã€‚é”æ¶ˆé™¤çš„ä¸»è¦åˆ¤å®šä¾æ®æ¥æºäºé€ƒé€¸åˆ†æçš„æ•°æ®æ”¯æŒ(ç¬¬11ç« å·²ç»è®²è§£è¿‡é€ƒé€¸åˆ†ææŠ€æœ¯),å¦‚æœåˆ¤æ–­åœ¨ä¸€æ®µä»£ç ä¸­,å †ä¸Šçš„æ‰€æœ‰æ•°æ®éƒ½ä¸ä¼šé€ƒé€¸å‡ºå»ä»è€Œè¢«å…¶ä»–çº¿ç¨‹è®¿é—®åˆ°,é‚£å°±å¯ä»¥æŠŠå®ƒä»¬å½“åšæ ˆä¸Šæ•°æ®å¯¹å¾…,è®¤ä¸ºå®ƒä»¬æ˜¯çº¿ç¨‹ç§æœ‰çš„,åŒæ­¥åŠ é”è‡ªç„¶å°±æ— é¡»è¿›è¡Œ ç®€å•æ€»ç»“ï¼Œå°±æ˜¯ç¼–è¾‘å™¨åˆ†æå‡ºè¿™æ®µä»£ç å¹¶ä¸éœ€è¦è¿›è¡Œä¸Šé”å°±ä¸è¿›è¡ŒåŒæ­¥å¤„ç† ä¸Šé¢ä»£ç ä¸­æ¯ä¸ªStringBuffer.append()æ–¹æ³•ä¸­éƒ½æœ‰ä¸€ä¸ªåŒæ­¥å—,é”å°±æ˜¯sbå¯¹è±¡ã€‚è™šæ‹Ÿæœºè§‚å¯Ÿå˜é‡sb,å¾ˆå¿«å°±ä¼šå‘ç°å®ƒçš„åŠ¨æ€ä½œç”¨åŸŸè¢«é™åˆ¶åœ¨concatString()æ–¹æ³•å†…éƒ¨ã€‚ä¹Ÿå°±æ˜¯è¯´,sbçš„æ‰€æœ‰å¼•ç”¨æ°¸è¿œä¸ä¼šâ€œé€ƒé€¸â€åˆ°concatString()æ–¹æ³•ä¹‹å¤–,å…¶ä»–çº¿ç¨‹æ— æ³•è®¿é—®åˆ°å®ƒ,å› æ­¤,è™½ç„¶è¿™é‡Œæœ‰é”,ä½†æ˜¯å¯ä»¥è¢«å®‰å…¨åœ°æ¶ˆé™¤æ‰,åœ¨å³æ—¶ç¼–è¯‘ä¹‹å,è¿™æ®µä»£ç å°±ä¼šå¿½ç•¥æ‰æ‰€æœ‰çš„åŒæ­¥è€Œç›´æ¥æ‰§è¡Œäº† é”ç²—åŒ– å¦‚æœä¸€ç³»åˆ—çš„è¿ç»­æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åå¤åŠ é”å’Œè§£é”,ç”šè‡³åŠ é”æ“ä½œæ˜¯å‡ºç°åœ¨å¾ªç¯ä½“ä¸­çš„,é‚£å³ä½¿æ²¡æœ‰çº¿ç¨‹ç«äº‰,é¢‘ç¹åœ°è¿›è¡Œäº’æ–¥åŒæ­¥æ“ä½œä¹Ÿä¼šå¯¼è‡´ä¸å¿…è¦çš„æ€§èƒ½æŸè€— è¿ç»­çš„append()æ–¹æ³•å°±å±äºè¿™ç±»æƒ…å†µã€‚å¦‚æœè™šæ‹Ÿæœºæ¢æµ‹åˆ°æœ‰è¿™æ ·ä¸€ä¸²é›¶ç¢çš„æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åŠ é”,å°†ä¼šæŠŠåŠ é”åŒæ­¥çš„èŒƒå›´æ‰©å±•(ç²—åŒ–)åˆ°æ•´ä¸ªæ“ä½œåºåˆ—çš„å¤–éƒ¨,ä»¥ä»£ç æ¸…å•13-7ä¸ºä¾‹,å°±æ˜¯æ‰©å±•åˆ°ç¬¬ä¸€ä¸ªappend()æ“ä½œä¹‹å‰ç›´è‡³æœ€åä¸€ä¸ªappend()æ“ä½œä¹‹å,è¿™æ ·åªéœ€è¦åŠ é”ä¸€æ¬¡å°±å¯ä»¥äº† åå‘é”å’Œè½»é‡çº§é”å’Œé‡é‡çº§é”ä»‹ç»åœ¨äº†è§£é”çš„æ—¶å€™é¦–å…ˆéœ€è¦ç†è§£javaçš„å¯¹è±¡å¤´ javaå¯¹è±¡å¤´ï¼šæ‰€æœ‰é”çš„å®ç°éƒ½ä¾èµ–äºå¯¹è±¡å¤´ é”æ˜¯å­˜åœ¨Javaå¯¹è±¡å¤´é‡Œçš„ã€‚å¦‚æœå¯¹è±¡æ˜¯æ•°ç»„ç±»å‹,åˆ™è™šæ‹Ÿæœºç”¨3ä¸ªå­—å®½(Word)å­˜å‚¨å¯¹è±¡å¤´,å¦‚æœå¯¹è±¡æ˜¯éæ•°ç»„ç±»å‹,åˆ™ç”¨2å­—å®½å­˜å‚¨å¯¹è±¡å¤´ã€‚åœ¨32ä½è™šæ‹Ÿæœºä¸­,1å­—å®½ç­‰äº4å­—èŠ‚,å³32bit,å¦‚è¡¨ Javaå¯¹è±¡å¤´é‡Œçš„Mark Wordé‡Œé»˜è®¤å­˜å‚¨å¯¹è±¡çš„HashCodeã€åˆ†ä»£å¹´é¾„å’Œé”æ ‡è®°ä½ã€‚32ä½JVMçš„Mark Wordçš„é»˜è®¤å­˜å‚¨ç»“æ„å¦‚è¡¨ javaä¸­é”ä¸€å…±æœ‰4ç§çŠ¶æ€,çº§åˆ«ä»ä½åˆ°é«˜ä¾æ¬¡æ˜¯:æ— é”çŠ¶æ€ã€åå‘é”çŠ¶æ€ã€è½»é‡çº§é”çŠ¶æ€å’Œé‡é‡çº§é”çŠ¶æ€,è¿™å‡ ä¸ªçŠ¶æ€ä¼šéšç€ç«äº‰æƒ…å†µé€æ¸å‡çº§ã€‚é”å¯ä»¥å‡çº§ä½†ä¸èƒ½é™çº§,æ„å‘³ç€åå‘é”å‡çº§æˆè½»é‡çº§é”åä¸èƒ½é™çº§æˆåå‘é”ã€‚è¿™ç§é”å‡çº§å´ä¸èƒ½é™çº§çš„ç­–ç•¥,ç›®çš„æ˜¯ä¸ºäº†æé«˜è·å¾—é”å’Œé‡Šæ”¾é”çš„æ•ˆç‡ åå‘é”å¤§å¤šæ•°æƒ…å†µä¸‹,é”ä¸ä»…ä¸å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰,è€Œä¸”æ€»æ˜¯ç”±åŒä¸€çº¿ç¨‹å¤šæ¬¡è·å¾— è¿‡ç¨‹ï¼šä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥å—å¹¶è·å–é”æ—¶,ä¼šåœ¨å¯¹è±¡å¤´å’Œæ ˆå¸§ä¸­çš„é”è®°å½•é‡Œå­˜å‚¨é”åå‘çš„çº¿ç¨‹ID,ä»¥åè¯¥çº¿ç¨‹åœ¨è¿›å…¥å’Œé€€å‡ºåŒæ­¥å—æ—¶ä¸éœ€è¦è¿›è¡ŒCASæ“ä½œæ¥åŠ é”å’Œè§£é”,åªéœ€ç®€å•åœ°æµ‹è¯•ä¸€ä¸‹å¯¹è±¡å¤´çš„Mark Wordé‡Œæ˜¯å¦å­˜å‚¨ç€æŒ‡å‘å½“å‰çº¿ç¨‹çš„åå‘é”ã€‚å¦‚æœæµ‹è¯•æˆåŠŸ,è¡¨ç¤ºçº¿ç¨‹å·²ç»è·å¾—äº†é”ã€‚å¦‚æœæµ‹è¯•å¤±è´¥,åˆ™éœ€è¦å†æµ‹è¯•ä¸€ä¸‹Mark Wordä¸­åå‘é”çš„æ ‡è¯†æ˜¯å¦è®¾ç½®æˆ1(è¡¨ç¤ºå½“å‰æ˜¯åå‘é”):å¦‚æœæ²¡æœ‰è®¾ç½®,åˆ™ä½¿ç”¨CASç«äº‰é”;å¦‚æœè®¾ç½®äº†,åˆ™å°è¯•ä½¿ç”¨CASå°†å¯¹è±¡å¤´çš„åå‘é”æŒ‡å‘å½“å‰çº¿ç¨‹ã€‚ è½»é‡çº§é” è·å–é”è¿‡ç¨‹ çº¿ç¨‹åœ¨æ‰§è¡ŒåŒæ­¥å—ä¹‹å‰,JVMä¼šå…ˆåœ¨å½“å‰çº¿ç¨‹çš„æ ˆæ¡¢ä¸­åˆ›å»ºç”¨äºå­˜å‚¨é”è®°å½•çš„ç©ºé—´,å¹¶å°†å¯¹è±¡å¤´ä¸­çš„Mark Wordå¤åˆ¶åˆ°é”è®°å½•ä¸­,å®˜æ–¹ç§°ä¸ºDisplaced Mark Wordã€‚ç„¶åçº¿ç¨‹å°è¯•ä½¿ç”¨CASå°†å¯¹è±¡å¤´ä¸­çš„Mark Wordæ›¿æ¢ä¸ºæŒ‡å‘é”è®°å½•çš„æŒ‡é’ˆã€‚å¦‚æœæˆåŠŸ,å½“å‰çº¿ç¨‹è·å¾—é”,å¦‚æœå¤±è´¥,è¡¨ç¤ºå…¶ä»–çº¿ç¨‹ç«äº‰é”,å½“å‰çº¿ç¨‹ä¾¿å°è¯•ä½¿ç”¨è‡ªæ—‹æ¥è·å–é”ã€‚ è§£é”è¿‡ç¨‹ è½»é‡çº§è§£é”æ—¶,ä¼šä½¿ç”¨åŸå­çš„CASæ“ä½œå°†Displaced Mark Wordæ›¿æ¢å›åˆ°å¯¹è±¡å¤´,å¦‚æœæˆåŠŸ,åˆ™è¡¨ç¤ºæ²¡æœ‰ç«äº‰å‘ç”Ÿã€‚å¦‚æœå¤±è´¥,è¡¨ç¤ºå½“å‰é”å­˜åœ¨ç«äº‰,é”å°±ä¼šè†¨èƒ€æˆé‡é‡çº§é”ã€‚ å› ä¸ºè‡ªæ—‹ä¼šæ¶ˆè€—CPU,ä¸ºäº†é¿å…æ— ç”¨çš„è‡ªæ—‹(æ¯”å¦‚è·å¾—é”çš„çº¿ç¨‹è¢«é˜»å¡ä½äº†),ä¸€æ—¦é”å‡çº§æˆé‡é‡çº§é”,å°±ä¸ä¼šå†æ¢å¤åˆ°è½»é‡çº§é”çŠ¶æ€ã€‚å½“é”å¤„äºè¿™ä¸ªçŠ¶æ€ä¸‹,å…¶ä»–çº¿ç¨‹è¯•å›¾è·å–é”æ—¶,éƒ½ä¼šè¢«é˜»å¡ä½,å½“æŒæœ‰é”çš„çº¿ç¨‹é‡Šæ”¾é”ä¹‹åä¼šå”¤é†’è¿™äº›çº¿ç¨‹,è¢«å”¤é†’çš„çº¿ç¨‹å°±ä¼šè¿›è¡Œæ–°ä¸€è½®çš„å¤ºé”ä¹‹äº‰","date":"2024-12-31","categories":["java"],"tags":["javaå¤šçº¿ç¨‹"]},{"title":"java-å¤šçº¿ç¨‹ç¼–ç¨‹5-é‡æ¸©å¤šçº¿ç¨‹ç¼–ç¨‹-CASç”¨æ³•","url":"/2024/12/31/java-å¤šçº¿ç¨‹ç¼–ç¨‹5-é‡æ¸©å¤šçº¿ç¨‹ç¼–ç¨‹-CASç”¨æ³•/","content":"java åœ¨å¤šçº¿çº¿ç¨‹ç¼–ç¨‹ä¸­æœ‰ä¸ªè®¸è®¸å¤šå¤šçš„ä¼˜åŠ¿,å…¶ä¸­ä¸€ä¸ªå°±æ˜¯javaçš„åŸºäºCASç†è®ºè€Œåˆ›å»ºçš„é”ReentrantLock,è¿™é‡Œä¸»è¦æ˜¯å›é¡¾ä¸€ä¸‹CASæ˜¯å¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨çš„ CASç®€ä»‹ å…¶å®cas å¾ˆç®€å• ,ä½¿ç”¨çš„æ˜¯â€æ¯”è¾ƒäº¤æ¢ç®—æ³•â€, æ ¸å¿ƒä½“ç°åœ¨AtomicReference.compareAndSet(xx,xx2) ä¸Š , è¿™ä¸ªå‡½æ•°å°†ä¼šæ¯”è¾ƒä¼ å…¥çš„xx å’Œ AtomicReference ä¸­å­˜è¿‡çš„å€¼æ˜¯å¦å‘ç”Ÿå˜åŒ–å¦‚æœæ²¡æœ‰å‘ç”Ÿå˜åŒ–,å°†ä¼šå°†xx2 çš„å€¼èµ‹ç»™xx,å¦åˆ™è¿™ä¸ªå‡½æ•°å°†ä¼šè¿”å›false é€šè¿‡AtomicReference.compareAndSet(xx,xx2) è¿™ç§ç‰¹æ€§æˆ‘ä»¬å¯æ˜¯è®¾è®¡ä¸€ç§å›æ»šç­–ç•¥æ¥å°†å®ç°å¹¶å‘æ—¶,å…¬å…±å±æ€§å¾ç”¨çš„é—®é¢˜ ç”¨java æ ˆæ¥ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ é¦–å…ˆå®šä¹‰ä¸€ä¸ªæ–°çš„javaæ ˆå¯¹è±¡ æ¥ä¸‹æ¥ç¼–å†™javaçš„mainæ–¹æ³•,è¿™é‡Œé‡‡ç”¨çš„å¤šçº¿çš„æ–¹æ³•,æ¯ä¸ªçº¿ç¨‹å¤„ç†ä¸€ä¸ªå˜é‡å¹¶ä¸”å°†è¿™ä¸ªå˜é‡åŠ å…¥åˆ°å…¬å…±çš„åˆ—è¡¨ä¸­ å¤§å¤šæ•°æƒ…å†µä¸‹ä¼šäº§ç”Ÿçš„ç»“æœå’Œä¸‹é¢çš„ç›¸åŒ ä½†æ˜¯åœ¨ç‰¹æ®Šçš„æƒ…å†µä¸‹ä¼šå‡ºç°å¤šçº¿ç¨‹çš„é—®é¢˜ æˆ‘æ²¡ä¿®æ”¹pushæ–¹æ³•çš„è¿™é‡Œ è¿™é‡Œä¼šå‡ºç°ç©ºæŒ‡é’ˆçš„é—®é¢˜ è¿™é‡Œåˆ†æä¸€ä¸‹è¿™ç§æ–¹æ³•çš„è¿è¡Œè¿‡ç¨‹ æ‰§è¡Œé¡ºåº thread-0 thread-1 thread-2 1 Node newHead &#x3D; new Node<>(item); â€“ â€“ 2 head&#x3D;newHead; â€“ â€“ 3 (Resume) â€“ â€“ 4 â€“ Node newHead &#x3D; new Node<>(item); â€“ 5 â€“ â€“ Node newHead &#x3D; new Node<>(item); 6 â€“ newHead.next &#x3D; head; â€“ 7 â€“ â€“ newHead.next &#x3D; head; 8 â€“ head&#x3D;newHead; â€“ 9 â€“ â€“ head&#x3D;newHead; 10 â€“ (Resume) 11 â€“ â€“ (Resume) å¼‚å¸¸ç»“æœæ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿ å½“thread-0æ‰§è¡Œåˆ°é¡ºåº3æ—¶ï¼Œheadè¡¨ç¤ºçš„é“¾è¡¨ä¸ºnode(1)ã€‚ å½“thread-1æ‰§è¡Œåˆ°é¡ºåº10æ—¶ï¼Œheadè¡¨ç¤ºçš„é“¾è¡¨ä¸ºnode(2)->node(1)ã€‚ å½“thread-2æ‰§è¡Œåˆ°é¡ºåº11æ—¶ï¼Œheadè¡¨ç¤ºçš„é“¾è¡¨ä¸ºnode(3)->node(1)ã€‚ å½“ä¸‰ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œheadçš„æœ€ç»ˆè¡¨ç¤ºä¸ºnode(3)->node(1)ï¼Œä¹Ÿå°±æ˜¯è¯´thread-2å°†thread-1çš„æ‰§è¡Œç»“æœè¦†ç›–äº†ã€‚ è§£å†³åŠæ³• synchronized å…³é”®å­—æˆ–è€… ReentrantLock çº¿ç¨‹é” è¿™ç§åŠ é”çš„æ–¹æ³•å¾ˆç®€å•ä¸å¤šè¯´äº†, ä¸»è¦è®²è®²ç¬¬äºŒç§CASåŸå­æ€§æ“ä½œçš„åšæ³•, ä¸Šä»£ç  å…¶å®å°±åƒæˆ‘å¼€ç¯‡è¯´çš„ä¸€æ ·å…¶å®æ ¸å¿ƒå°±æ˜¯compareAndSetæ–¹æ³•æ ¡éªŒåœ¨äº‰ç”¨ç¯å¢ƒä¸‹,æˆ‘è‡ªå·±è·å–çš„å€¼æ˜¯å¦å‘ç”Ÿè¿‡ä¿®æ”¹,å¦‚æœå‘ç”Ÿè¿‡ä¿®æ”¹å°±è¿›è¡Œå›æ»šçš„æ“ä½œ å…¶å®ä¸Šé¢çš„ä¾‹å­ä¸­è¿˜è¦æ³¨æ„ä¸€ä¸ªåœ°æ–¹å°±æ˜¯ä¸¤ä¸ªerror é”™è¯¯ç‚¹å°±æ˜¯ç”¨cas.get()æ–¹æ³•æ¥å°½å¿ƒè·å–,è¿™æ ·å¹¶ä¸å¯å–å› ä¸º,æ“ä½œcompareAndSetä¼šå¯¼è‡´cas.get()æ–¹æ³•ä¸­çš„æ•°æ®å‘ç”Ÿæ”¹å˜,ä»è€Œå¯¼è‡´çº¿ç¨‹å®‰å…¨å¤±è´¥","date":"2024-12-31","categories":["java"],"tags":["javaå¤šçº¿ç¨‹"]},{"title":"javaç‰ˆæœ¬è¿½æœ”-java7","url":"/2024/12/31/javaç‰ˆæœ¬è¿½æœ”-java7/","content":"å°è¯•ä½¿ç”¨èµ„æºjava7 é’ˆå¯¹èµ„æºä½¿ç”¨çš„æ”¹è¿›,é€šè¿‡è¿™ç§æ–¹æ³•,å°±ä¸éœ€è¦æ˜¾ç¤ºçš„å£°æ˜æ–‡ä»¶å…³é—­çš„è¯­å¥äº† åŸºæœ¬ä¸Šï¼Œæ˜¯ä¸Šé¢çš„ä»£ç åœ¨Java 7ä¸­ç­‰åŒäºä¸‹é¢çš„Java 6ï¼š ä½†æ˜¯è¿˜æœ‰ä¸€äº›ä¸åŒçš„,å°±æ˜¯ä½¿ç”¨java7 å…¶å®å®åœ¨catchä¹‹å‰å°±å…³é—­èµ„æºçš„ java7 æ•è·å¤šä¸ªå¼‚å¸¸ java7ä¸­å¯ä»¥ç®€å†™ä¸ºï¼š ç¬¦åˆ å¯ä»¥ å†™å¤šä¸ªï¼Œç¬¦åˆå…¶ä¸­ä¹‹ä¸€ï¼› java7 fork join å’Œnio2.0è¿™ä¸ªè¯´è¿‡å¾ˆå¤šäº†å°±ä¸è¡¥å……äº† æ”¯æŒjvm è™šæ‹Ÿæœºä¸­çš„åŠ¨æ€ç±»å‹è¯­è¨€å›åˆ°æœ¬æ–‡çš„ä¸»é¢˜ï¼Œæ¥çœ‹çœ‹Javaè¯­è¨€ã€è™šæ‹Ÿæœºä¸åŠ¨æ€ç±»å‹è¯­è¨€ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»ã€‚Javaè™šæ‹Ÿæœºæ¯«æ— ç–‘é—®æ˜¯Javaè¯­è¨€çš„è¿è¡Œå¹³å°ï¼Œä½†ä»–çš„ä½¿å‘½å¹¶ä¸ä»…é™äºæ­¤ï¼Œæ—©åœ¨1997å¹´å‡ºç‰ˆçš„ã€Šè™šæ‹Ÿæœºè§„èŒƒã€‹ä¸­å°±è§„åˆ’äº†è¿™æ ·ä¸€ä¸ªæ„¿æ™¯ï¼šâ€œåœ¨æœªæ¥ï¼Œæˆ‘ä»¬ä¼šå¯¹Javaè™šæ‹Ÿæœºè¿›è¡Œé€‚å½“çš„æ‰©å±•ï¼Œä»¥ä¾¿æ›´å¥½åœ°æ”¯æŒå…¶ä»–è¯­è¨€è¿è¡ŒäºJavaè™šæ‹Ÿæœºä¹‹ä¸Šâ€ã€‚è€Œç›®å‰ç¡®å®å·²ç»æœ‰è®¸å¤šåŠ¨æ€ç±»å‹è¯­è¨€è¿è¡ŒäºJavaè™šæ‹Ÿæœºä¹‹ä¸Šäº†ï¼Œå¦‚Clojureã€Groovyã€Jythonå’ŒJRubyç­‰ï¼Œèƒ½å¤Ÿåœ¨åŒä¸€ä¸ªè™šæ‹Ÿæœºä¸Šå¯ä»¥è¾¾åˆ°é™æ€ç±»å‹è¯­è¨€çš„ä¸¥è°¨æ€§ä¸åŠ¨æ€ç±»å‹è¯­è¨€çš„çµæ´»æ€§ï¼Œè¿™æ˜¯ä¸€ä»¶å¾ˆç¾å¦™çš„äº‹æƒ…ã€‚ä½†é—æ†¾çš„æ˜¯ï¼šJavaè™šæ‹Ÿæœºå±‚é¢å¯¹åŠ¨æ€ç±»å‹è¯­è¨€çš„æ”¯æŒä¸€ç›´éƒ½æœ‰æ‰€æ¬ ç¼ºï¼Œä¸»è¦è¡¨ç°åœ¨æ–¹æ³•è°ƒç”¨æ–¹é¢ï¼šJDK 1.7ä»¥å‰çš„å­—èŠ‚ç æŒ‡ä»¤é›†ä¸­ï¼Œ4æ¡æ–¹æ³•è°ƒç”¨æŒ‡ä»¤ï¼ˆinvokevirtualã€invokespecialã€invokestaticã€invokeinterfaceï¼‰çš„ç¬¬ä¸€ä¸ªå‚æ•°éƒ½æ˜¯è¢«è°ƒç”¨çš„æ–¹æ³•çš„ç¬¦å·å¼•ç”¨ï¼ˆCONSTANT_Methodref_infoæˆ–è€…CONSTANT_InterfaceMethodref_infoå¸¸é‡ï¼‰ï¼Œå‰é¢å·²ç»æåˆ°è¿‡ï¼Œæ–¹æ³•çš„ç¬¦å·å¼•ç”¨åœ¨ç¼–è¯‘æ—¶äº§ç”Ÿï¼Œè€ŒåŠ¨æ€ç±»å‹è¯­è¨€åªæœ‰åœ¨è¿è¡ŒæœŸæ‰èƒ½ç¡®å®šæ¥æ”¶è€…ç±»å‹ã€‚è¿™æ ·ï¼Œåœ¨Javaè™šæ‹Ÿæœºä¸Šå®ç°çš„åŠ¨æ€ç±»å‹è¯­è¨€å°±ä¸å¾—ä¸ä½¿ç”¨å…¶ä»–æ–¹å¼ï¼ˆå¦‚ç¼–è¯‘æ—¶ç•™ä¸ªå ä½ç¬¦ç±»å‹ï¼Œè¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆå­—èŠ‚ç å®ç°å…·ä½“ç±»å‹åˆ°å ä½ç¬¦ç±»å‹çš„é€‚é…ï¼‰æ¥å®ç°ï¼Œè¿™æ ·åŠ¿å¿…è®©åŠ¨æ€ç±»å‹è¯­è¨€å®ç°çš„å¤æ‚åº¦å¢åŠ ï¼Œä¹Ÿå¯èƒ½å¸¦æ¥é¢å¤–çš„æ€§èƒ½æˆ–è€…å†…å­˜å¼€é”€ã€‚å°½ç®¡å¯ä»¥åˆ©ç”¨ä¸€äº›åŠæ³•ï¼ˆå¦‚Call Site Cachingï¼‰è®©è¿™äº›å¼€é”€å°½é‡å˜å°ï¼Œä½†è¿™ç§åº•å±‚é—®é¢˜ç»ˆå½’æ˜¯åº”å½“åœ¨è™šæ‹Ÿæœºå±‚é¢ä¸Šå»è§£å†³æ‰æœ€åˆé€‚ï¼Œå› æ­¤åœ¨Javaè™šæ‹Ÿæœºå±‚é¢ä¸Šæä¾›åŠ¨æ€ç±»å‹çš„ç›´æ¥æ”¯æŒå°±æˆä¸ºäº†javaå¹³å°çš„å‘å±•è¶‹åŠ¿ä¹‹ä¸€ï¼Œè¿™å°±æ˜¯JDK1.7ï¼ˆJSRï¼‰ä¸­invokedynamicæŒ‡ä»¤ä»¥åŠjava.lang.invokeåŒ…å‡ºç°çš„æŠ€æœ¯èƒŒæ™¯ã€‚ ç®€å•æ¥è¯´,å°±æ˜¯æ–¹æ³•åœ¨ç¼–è¯‘æœŸé—´å¿…é¡»çŸ¥é“ä»–æ‰€å±çš„å¯¹è±¡,ä½†æ˜¯é’ˆå¯¹ä¸€äº›å¼±ç±»å‹è¯­è¨€å¹¶ä¸éœ€è¦çŸ¥é“æ‰€å±çš„å¯¹è±¡æ˜¯è°,å¯¹ä¸€äº›jvmç¼–ç¨‹è¯­è¨€çš„å¼€å‘é€ æˆäº†ä¸€å®šçš„å›°éš¾ java.lang.invokeåŒ… çš„methodHandleæ”¯æŒ MethodHandleçš„ä½¿ç”¨æ–¹æ³•å’Œæ•ˆæœä¸Reflectionæœ‰ä¼—å¤šç›¸ä¼¼ä¹‹å¤„ï¼Œä¸è¿‡ï¼Œä»–ä»¬è¿˜æ˜¯æœ‰ä»¥ä¸‹è¿™äº›åŒºåˆ«ï¼šä»æœ¬è´¨ä¸Šè®²ï¼ŒReflectionå’ŒMethodHandleæœºåˆ¶éƒ½æ˜¯åœ¨æ¨¡æ‹Ÿæ–¹æ³•è°ƒç”¨ï¼Œä½†Reflectionæ˜¯åœ¨æ¨¡æ‹ŸJavaä»£ç å±‚æ¬¡çš„æ–¹æ³•è°ƒç”¨ï¼Œè€ŒMethodHandleæ˜¯åœ¨æ¨¡æ‹Ÿå­—èŠ‚ç å±‚æ¬¡çš„æ–¹æ³•è°ƒç”¨ã€‚åœ¨MethodHandles.lookupä¸­çš„3ä¸ªæ–¹æ³•â€”â€”findStatic()ã€findVirtual()ã€findSpecial()æ­£æ˜¯ä¸ºäº†å¯¹åº”äºinvokestaticã€invokevirtual&invokeinterfaceå’Œinvokespecialè¿™å‡ æ¡å­—èŠ‚ç æŒ‡ä»¤çš„æ‰§è¡Œæƒé™æ ¡éªŒè¡Œä¸ºï¼Œè€Œè¿™äº›åº•å±‚ç»†èŠ‚åœ¨ä½¿ç”¨Reflection APIæ—¶æ˜¯ä¸éœ€è¦å…³å¿ƒçš„ã€‚ Reflectionä¸­çš„java.lang.reflect.Methodå¯¹è±¡è¿œæ¯”MethodHandleæœºåˆ¶ä¸­çš„java.lang.invoke.MethodHandleå¯¹è±¡æ‰€åŒ…å«çš„ä¿¡æ¯å¤šã€‚å‰è€…æ˜¯æ–¹æ³•åœ¨Javaä¸€ç«¯çš„å…¨é¢æ˜ åƒï¼ŒåŒ…å«äº†æ–¹æ³•çš„ç­¾åã€æè¿°åºœä»¥åŠæ–¹æ³•å±æ€§è¡¨ä¸­å„ç§å±æ€§çš„javaç«¯è¡¨ç¤ºæ–¹å¼ï¼Œè¿˜åŒ…å«æ‰§è¡Œæƒé™ç­‰çš„è¿è¡ŒæœŸä¿¡æ¯ã€‚è€Œåè€…ä»…ä»…åŒ…å«ä¸æ‰§è¡Œè¯¥æ–¹æ³•ç›¸å…³çš„ä¿¡æ¯ã€‚ç”¨é€šä¿—çš„è¯æ¥è®²ï¼ŒReflectionæ˜¯é‡é‡çº§ï¼Œè€ŒMethodHandleæ˜¯è½»é‡çº§ã€‚ ç”±äºMethodHandleæ˜¯å¯¹å­—èŠ‚ç çš„æ–¹æ³•æŒ‡ä»¤è°ƒç”¨çš„æ¨¡æ‹Ÿï¼Œæ‰€ä»¥ç†è®ºä¸Šè™šæ‹Ÿæœºåœ¨è¿™æ–¹é¢åšçš„å„ç§ä¼˜åŒ–ï¼ˆå¦‚æ–¹æ³•å†…è”ï¼‰ï¼Œåœ¨MethodHandleä¸Šä¹Ÿåº”å½“å¯ä»¥é‡‡ç”¨ç±»ä¼¼æ€è·¯å»æ”¯æŒã€‚è€Œé€šè¿‡åå°„å»è°ƒç”¨æ–¹æ³•åˆ™ä¸è¡Œã€‚MethodHandleä¸Reflectioné™¤äº†ä¸Šé¢åˆ—ä¸¾çš„åŒºåˆ«å¤–ï¼Œæœ€å…³é”®çš„ä¸€ç‚¹è¿˜åœ¨äºå»æ‰å‰é¢è®¨è®ºæ–½åŠ çš„å‰æâ€œä»…ç«™åœ¨Javaè¯­è¨€çš„è§’åº¦æ¥çœ‹â€ï¼šReflection APIçš„è®¾è®¡ç›®æ ‡æ˜¯åªä¸ºjavaè¯­è¨€æœåŠ¡çš„ï¼Œè€ŒMethodHandleåˆ™è®¾è®¡æˆå¯æœåŠ¡äºæ‰€æœ‰Javaè™šæ‹Ÿæœºä¹‹ä¸Šçš„è¯­è¨€ï¼Œå…¶ä¸­ä¹ŸåŒ…æ‹¬Javaè¯­è¨€ã€‚","date":"2024-12-31","categories":["java"],"tags":["javaç‰ˆæœ¬å’Œæ›´æ–°å†…å®¹"]},{"title":"javaç‰ˆæœ¬è¿½æœ”-java8","url":"/2024/12/31/javaç‰ˆæœ¬è¿½æœ”-java8/","content":"lamberstreamjava çš„ js å¼•æ“","date":"2024-12-31","categories":["java"],"tags":["javaç‰ˆæœ¬å’Œæ›´æ–°å†…å®¹"]},{"title":"javaç‰ˆæœ¬è¿½æœ”-java9","url":"/2024/12/31/javaç‰ˆæœ¬è¿½æœ”-java9/","content":"æ¨¡å—ç³»ç»Ÿ","date":"2024-12-31","categories":["java"],"tags":["javaç‰ˆæœ¬å’Œæ›´æ–°å†…å®¹"]},{"title":"java-streamå’Œlamble(1)-lambleåŸºæœ¬è¯­æ³•","url":"/2024/12/31/java-streamå’Œlamble-1--lambleåŸºæœ¬è¯­æ³•/","content":"é¦–å…ˆæˆ‘ä»¬å…ˆèŠä¸€èŠjavaçš„lambleè¡¨è¾¾å¼ è¿™é‡Œç»™å‡ºä¸€ä¸ªç®€å•çš„ä¾‹å­ æ³¨æ„:lambleçš„newçš„å¯¹è±¡å¿…é¡»ä¸ºæ¥å£ï¼Œå¹¶ä¸”æ¥å£ä¸­å¿…é¡»åªæœ‰ä¸€ä¸ªå‡½æ•°,ä½†æ˜¯å¯ä»¥æœ‰é»˜è®¤å®ç°å‡½æ•°,æ¯”å¦‚ä¸‹é¢è¿™æ · javaä¸­lambleè¡¨è¾¾å¼çš„å†™æ³• æœ€åŸºæœ¬å†™æ³•(åªæœ‰ä¸€ä¸ªå‚æ•°å’Œä¸€è¡Œä»£ç çš„æ—¶å€™) lambleæ¥å£ç±» ä½¿ç”¨æ ·ä¾‹ lambleçš„å…¶ä»–å½¢å¼ lamble è¡¨è¾¾å¼å¸¸ç”¨çš„ä¸€äº›æ¥å£ lambleè¡¨è¾¾å¼çš„ä½œç”¨åŸŸlambleè¡¨è¾¾å¼å°†ä¼šä½¿ç”¨ä½œç”¨åŸŸçš„å¼•ç”¨,æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ javaçš„å®é™…è¾“å‡ºç»“æœæ˜¯ itemå¯¹åº”çš„å€¼ æ³¨æ„åœ¨ä½¿ç”¨lambleè¡¨è¾¾å¼çš„æ—¶å€™,ä¼ å…¥ç»™å†…éƒ¨çš„å˜é‡å¿…é¡»æ˜¯ä¸å¯å˜åŒ–çš„å˜é‡(ä½¿ç”¨finalä¿®é¥°ç¬¦) lamble å…¶ä»–éœ€è¦æ³¨æ„çš„åœ°æ–¹ å½“å³ä¾§å…·æœ‰è¿”å›å€¼çš„æ—¶å€™ ä¸€ä¸ªlambleæ¥å£: å½“lambleè¡¨è¾¾å¼å…·æœ‰è¿”å›å€¼çš„æ—¶å€™,åº”ä¿è¯å³ä¾§çš„è¡¨è¾¾å¼æˆ–è€…ä»£ç å¿«èƒ½è¿”å›å‡½æ•°ä¸­å®šä¹‰çš„å˜é‡ ä½†ä½¿ç”¨èŒƒå‹çš„æ—¶å€™ æ³¨æ„å½“ä½¿ç”¨çš„æ˜¯èŒƒå‹çš„æ—¶å€™,è¦æ³¨æ„lambleè¡¨è¾¾å¼çš„å„ç§å±æ€§åº”è¯¥æ»¡è¶³èŒƒå‹å®šä¹‰çš„å„ç§ç±»å‹(å£°æ˜æ—¶T,Rçš„ç±»å‹) æ³¨æ„ä¸‰ï¼Œä½¿ç”¨lambleå¯èƒ½æœ‰å‡½æ•°ç­¾åä¸ä¸€è‡´çš„é—®é¢˜ è¿™ä¸ªé—®é¢˜çš„æœ¬è´¨æ˜¯åº”ä¸ºlambleè¡¨è¾¾å¼åªæ˜¯å…³å¿ƒæ¥å£ä¸­å‡½æ•°çš„å½¢å¼è€Œè¿™ä¸ªå‡½æ•°æ‰€åœ¨çš„æ¥å£å…¶å®lambleå¹¶ä¸å…³å¿ƒåœ¨javaå†…éƒ¨çš„è™šæ‹Ÿæœºå®ç°è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™æœ¬è´¨ä¸Šæ˜¯å¯»æ‰¾æœ‰æ²¡æœ‰ä¸€ä¸ªæ¥å£èƒ½å¤Ÿè¯»åº”è¿™ä¸ªè¡¨è¾¾å¼,ä»è€Œé€šè¿‡è¿™ç§æ–¹æ³•æ‰¾åˆ°å¯¹åº”çš„æ¥å£ ä¾‹å­ï¼š ä¸è¿‡ç”±äºè¿™ç§é‡è½½å¯¼è‡´çš„é—®é¢˜å¯ä»¥ä½¿ç”¨å¼ºåˆ¶è½¬æ¢è§£å†³,å¦‚æœå‚æ•°çš„æ•°é‡ç›¸åŒä½†æ˜¯ç±»å‹ä¸åŒï¼Œå¯ä»¥ä½¿ç”¨æœ‰ç±»å‹çš„lambleè¡¨è¾¾å¼ æ€»ç»“: Lambda è¡¨è¾¾å¼ä½œä¸ºå‚æ•°æ—¶ï¼Œ å…¶ç±»å‹ç”±å®ƒçš„ç›®æ ‡ç±»å‹æ¨å¯¼å¾—å‡ºï¼Œ æ¨å¯¼è¿‡ç¨‹éµå¾ªå¦‚ä¸‹è§„åˆ™ï¼š å¦‚æœåªæœ‰ä¸€ä¸ªå¯èƒ½çš„ç›®æ ‡ç±»å‹ï¼Œ ç”±ç›¸åº”å‡½æ•°æ¥å£é‡Œçš„å‚æ•°ç±»å‹æ¨å¯¼å¾—å‡ºï¼› å¦‚æœæœ‰å¤šä¸ªå¯èƒ½çš„ç›®æ ‡ç±»å‹ï¼Œ ç”±æœ€å…·ä½“çš„ç±»å‹æ¨å¯¼å¾—å‡ºï¼› å¦‚æœæœ‰å¤šä¸ªå¯èƒ½çš„ç›®æ ‡ç±»å‹ä¸”æœ€å…·ä½“çš„ç±»å‹ä¸æ˜ç¡®ï¼Œ åˆ™éœ€äººä¸ºæŒ‡å®šç±»å‹ã€‚ ps ï¼š æœ€åä¸€ç‚¹javaä¸­æ²¡æœ‰nullè¿™ä¸ªå¯¹è±¡","date":"2024-12-31","categories":["java"],"tags":["javaçš„stream"]},{"title":"java-streamå’Œlamble(2)-streamåŸºæœ¬ä½¿ç”¨","url":"/2024/12/31/java-streamå’Œlamble-2--streamåŸºæœ¬ä½¿ç”¨/","content":"ä¸Šä¸€èŠ‚æˆ‘ä»¬æ¢³ç†äº†java lambleç›¸å…³çš„ä¸œè¥¿,è¿™é‡Œæ¢³ç†ä¸€ä¸‹java8 streamç›¸å…³çš„ä¸œè¥¿ javaé›†åˆç±»å‹çš„è¿­ä»£æ–¹æ³• å¤–éƒ¨è¿­ä»£ - å¾ªç¯ä½“å’Œè¿­ä»£çš„é€»è¾‘åœ¨å¤–éƒ¨ æœ¬è´¨ä¸Šæ¥è®²å°±æ˜¯è¿­ä»£çš„æµç¨‹åœ¨å¤–éƒ¨ç”¨æˆ·å¯è§ å†…éƒ¨è¿­ä»£ è¿™ä¸ªæ˜¯java8çš„æ–°ä¸œè¥¿,æ‰€æœ‰çš„ç»“åˆç±»éƒ½å¯ä»¥ä½¿ç”¨streamæ¥å£è¿›è¡Œè¿­ä»£ è¿™é‡Œå†™ä¸€ä¸ªä¾‹å­,è¿­ä»£å‡ºæ‰€æœ‰çš„å¶æ•° æœ¬è´¨ä¸Šæ˜¯å†…éƒ¨å®ç°æ•°æ®çš„è¿­ä»£æ›´æ–°,è€Œå¤–éƒ¨åªæ˜¯å®ç°å†…éƒ¨çš„è¿­ä»£é€»è¾‘ç½¢äº† å†…éƒ¨è¿­ä»£æœ¬è´¨ä¸Šå¯ä»¥æ˜¯ä¸€ç§å‡½æ•°è°ƒç”¨,ä¸Šé¢è¿™ä¸ªä¾‹å­å¹²äº†ä¸¤ä»¶äº‹è¯· è¿‡æ»¤å‡ºæ‰€æœ‰çš„å¶æ•° ç”Ÿæˆä¸€ä¸ªæ–°çš„é›†åˆ æ³¨æ„è¿™é‡Œå¥½åƒæ˜¯è¿­ä»£äº†ä¸¤æ¬¡ä½†æ˜¯æœ¬è´¨ä¸Šå¹¶æ²¡æœ‰,è®°ä¸‹æ¥è¯´æ˜ä¸€ä¸‹å®ç°çš„åŸç† java streamè¿­ä»£çš„å†…éƒ¨å®ç°åœ¨javaçš„å®ç°åŸç†ä¸­æœ‰ä¸¤ç§ç±»å‹,ä¸€ç§æ˜¯ æƒ°æ€§æ±‚å€¼ å¦ä¸€ç§æ˜¯ å°½æ—©æ±‚å€¼ æƒ°æ€§æ±‚å€¼å’Œå°½æ—©æ±‚å€¼åŒºåˆ†æ–¹æ³•å…¶å®è¿™ä¸ªå¾ˆå¥½è®° å°±æ˜¯å¦‚æœè¿”å›æ˜¯streamç±»çš„éƒ½æ˜¯æƒ°æ€§æ±‚å€¼,åä¹‹å°±æ˜¯å°½æ—©æ±‚å€¼ æƒ°æ€§æ±‚å€¼å’Œå°½æ—©æ±‚å€¼çš„å·®åˆ«æƒ°æ€§æ±‚å€¼å…¶å®æœ¬è´¨ä¸Šæ˜¯ä¸ä¼šè¿è¡Œå…¶ä¸­çš„ä»£ç çš„,åªæœ‰åœ¨å°½åœ¨æ±‚å€¼çš„æ—¶å€™æ‰æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„æ‰§è¡Œé€»è¾‘ æ¯”å¦‚è¿™æ ·ä¸€ä¸ªä»£ç  åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸ä¼šè¾“å‡ºitemå¯¹åº”çš„å€¼ å¼•ç”³ä¸€ä¸‹:å…¶å®è¿™ä¸ªè¿‡ç¨‹å’Œå»ºé€ è€…æ¨¡å¼ç±»ä¼¼,åœ¨çœŸæ­£å®ç°ä¹‹å‰ä¸åœçš„æ·»åŠ é…ç½®å’Œæ“ä½œ,åªæœ‰åœ¨æœ€åçš„Buildè¿‡ç¨‹ä¸­æ‰çœŸæ­£çš„æ‰§è¡Œ java stream çš„å¸¸ç”¨æ“ä½œ1. collect(toList); åŠæ—©æ±‚å€¼ å°±ä¸ç½—å—¦äº†ä¸è¿‡è¿™ä¸ªæœ‰ä¸¤ç§ç§ç»“æ„ 2. mapç±»å‹è¿™ä¸ªæ–¹æ³•å¾ˆå¸¸ç”¨,å°±åƒä»–çš„åå­—æ˜ å°„,ä½¿ç”¨è¿™ç§æ–¹æ³•å¯ä»¥ç›´æ¥å°†ä¸€ä¸ªæµè½¬åŒ–æˆå¦ä¸€ä¸ªæµ ä¸€ä¸ªä¾‹å­,è¿›è¡Œä¸€ä¸‹å¯¹æ¯” 2.1 mapToLong mapToInt mapToDoubleè¿™ä¸‰ä¸ªæ–¹æ³•æ˜¯java çš„stream é’ˆå¯¹javaå¯¹åŸºæœ¬ç±»å‹çš„è‡ªåŠ¨è£…ç®±å’Œè‡ªåŠ¨æ‹†ç®±çš„ä¼˜åŒ– ä¼ å…¥çš„å‚æ•°æ‹¿ Longç±»å‹ä¸¾ä¾‹ ToLongFunction -> å®ç°å¯¹è±¡åˆ°long ç±»å‹çš„è½¬æ¢ è¿™äº›æ–¹æ³•å°†ä¼šè¿”å›ä¸€ä¸‹ç‰¹æ®Šçš„stream æ¯”å¦‚LongStreamç­‰ç­‰ è€Œè¿™ç§streamé’ˆå¯¹ä¸åŒçš„è¾“å‡º,æ‹¥æœ‰ä¸åŒçš„é€‚é…æ–¹æ³• æ¯”å¦‚longè½¬doubleä¼šæœ‰ LongToDoubleFunctionæ¥å£æ¯”å¦‚longè½¬Long å¯¹è±¡ ä¼šæœ‰ LongFunctionæ¥å£è€Œè¿™ç§stream å®ç°çš„mapæ¥å£æ˜¯LongUnaryOperator,é€šè¿‡è¿™ç§æ–¹æ³•å®ç°æ€§èƒ½ä¸Šçš„é«˜æ•ˆ ****å¼•ç”³ javaåœ¨é’ˆå¯¹æ•°å­—ç»Ÿè®¡çš„æ—¶å€™,æœ‰æ„è¯†çš„æä¾›äº†é¢å¤–çš„æ–¹æ³•æ¥ç»Ÿè®¡æ•°æ®->summaryStatistics æ–¹æ³•,è¿™ä¸ªæ–¹æ³•èƒ½è®¡ç®—å‡ºå„ç§å„æ ·çš„ç»Ÿè®¡å€¼ï¼Œ å¦‚ IntStream å¯¹è±¡å†…æ‰€æœ‰å…ƒç´ ä¸­çš„æœ€å°å€¼ã€ æœ€å¤§å€¼ã€ å¹³å‡å€¼ä»¥åŠæ•°å€¼æ€»å’Œ,ä¾‹å­å¦‚ä¸‹ 3. filterè¿™ä¸ªæ˜¯è¿‡æ»¤å™¨,é€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥å°†æ„Ÿå…´è¶£çš„streamæµä¸­çš„å¯¹è±¡æ•´åˆè¿›æ–°çš„å¯¹è±¡ä¸­ 4. flapMapmap çš„å‡çº§ç‰ˆ flatMap æ–¹æ³•å¯ç”¨ Stream æ›¿æ¢å€¼ï¼Œç„¶åå°†å¤šä¸ª Stream è¿æ¥æˆä¸€ä¸ª Stream,è¯´ç™½äº†å°±æ˜¯æ•´åˆæµç”¨çš„ 5. maxå’Œmin max å’Œminä¸€æ ·åªè¦æœ‰ä¸€ä¸ªæ¯”è¾ƒå™¨å°±å¥½äº†,ä½†æ˜¯javaåº•å±‚æœ‰å…³è¿™ä¸€å±‚çš„å°è£…ç‰¹æ€§æ¯”è¾ƒå¤æ‚,æ¥ä¸‹æ¥å¼•ç”³ä¸€ä¸‹java Comparator#comparingæ–¹æ³•çš„ç›¸å…³å®ç° é¦–å…ˆçœ‹ä¸€ä¸‹æ¥å£çš„å®šä¹‰ T åªæ˜¯ä¸€ä¸ªæ™®é€šçš„å˜é‡ Uåœ¨è¿™é‡Œå¿…é¡»æ˜¯ä¸€ä¸ªå®ç°äº†Comparableæ¥å£çš„ç±»(javaç±»å†…éƒ¨æ¯”è¾ƒå‡½æ•°), è€Œä¼ å…¥çš„Function Lamble è¡¨è¾¾å¼çš„è¿”å›å€¼ä¹Ÿæ˜¯u,è¿™æ ·å°±å¯ä»¥ç†è§£äº†java Comparatorçš„è¿™ä¸ªæ–¹æ³•å¹²äº†ä»€ä¹ˆäº†-> ä¼ å…¥ä¸€ä¸ªå¯ä»¥ç”Ÿæˆå¯æ¯”è¾ƒç±»çš„Function lamble è¡¨è¾¾å¼,è¿”å›ä¸€ä¸ªComparator æ¯”è¾ƒé€»è¾‘ ps: å°è½¬çš„å¾ˆç‰›é€¼! æ³¨æ„è¿™é‡Œæœ‰ä¸€ä¸ªjava8 çš„å…¨æ–°è¯­æ³• ç±»1 & ç±»2 å…¶å®è¿™ä¸ªæ¥å£ç›¸å½“äºå¼ºåˆ¶è½¬åŒ–æˆä¸€ä¸ªåŒæ—¶ ç»§æ‰¿äº†ç±»1 ç±»2 çš„å¯¹è±¡,è¿™ä¸ªç”¨æ³•çš„è§„åˆ™é€šjavaçš„ç»§æ‰¿è§„åˆ™ å…¶å®java å¦‚æœç¼–å†™ç›¸å…³çš„é€»è¾‘çš„æ—¶å€™ä½¿ç”¨çš„å†™æ³•ç±»ä¼¼è¿™æ ·çš„ *** : å…¶å®çœ‹ä¸€ä¸‹jdkåº•å±‚çš„æºä»£ç å°±çŸ¥é“äº†,å…¶å®è¿™ä¸ªä¸œè¥¿æœ¬è´¨ä¸Šæ˜¯è°ƒç”¨äº†reduce æ–¹æ³•æ¥ä¸‹æ¥æ¥è¯´ä¸€ä¸‹reduceè¿™ä¸ªæ–¹æ³• 6. reduceä¸€ä¸ªè°ƒç”¨çš„ä¾‹å­ reduceæ¨¡å¼çš„æ ¸å¿ƒå°±æ˜¯accumulator è¿­ä»£å™¨, è¿™ä¸ªæ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¯æ¬¡è¿­ä»£çš„è¿”å›å€¼,ç¬¬äºŒä¸ªå‚æ•°æ˜¯å½“å‰è¿›è¡Œè¿­ä»£çš„å€¼, è½¬æ¢æˆjavaä»£ç å°±æ˜¯å¦‚ä¸‹çš„å½¢å¼ reduceä¸»è¦æœ‰ä¸‰ç§å½¢å¼ ç±»å‹1 å’Œ 2 æ²¡ä»€ä¹ˆå¥½è¯´çš„éƒ½æ˜¯è¿­ä»£æ±‚å€¼,ç½¢äº† æ³¨æ„ç¬¬äºŒç§æ–¹æ³•æ˜¯Optionalç±»å‹çš„è¿”å›å€¼ ç±»å‹3 æœ‰ä¸¤ä¸ªç›¸åŒçš„è¿­ä»£å‡½æ•° accumulator å’Œ combiner,å…·æœ‰è¿™ä¸ªè®¾è®¡çš„åŸå› æ˜¯è¿™æ ·çš„,Streamæ˜¯æ”¯æŒå¹¶å‘æ“ä½œçš„ï¼Œä¸ºäº†é¿å…ç«äº‰ï¼Œå¯¹äºreduceçº¿ç¨‹éƒ½ä¼šæœ‰ç‹¬ç«‹çš„resultï¼Œcombinerçš„ä½œç”¨åœ¨äºåˆå¹¶æ¯ä¸ªçº¿ç¨‹çš„resultå¾—åˆ°æœ€ç»ˆç»“æœã€‚è¿™ä¹Ÿè¯´æ˜äº†äº†ç¬¬ä¸‰ä¸ªå‡½æ•°å‚æ•°çš„æ•°æ®ç±»å‹å¿…é¡»ä¸ºè¿”å›æ•°æ®ç±»å‹äº† 8. æµå¼è¿­ä»£æ“ä½œå…¶å®javaçš„æ‰€æœ‰æƒ°æ€§æ±‚å€¼éƒ½å¯ä»¥ä¸åœçš„ç¬¬è¿­ä»£(æµå¼æ“ä½œ)))çš„, æ¯”å¦‚æƒ³ä¸‹é¢è¿™æ · 9. foreach è¿­ä»£ä¸€ä¸ªåŸºæœ¬çš„java è¿­ä»£æ“ä½œåƒå¦‚ä¸‹çš„å½¢å¼ ä½¿ç”¨foreach æ”¹é€ æˆå‡½æ•°å¼ç¼–ç¨‹å˜æˆå¦‚ä¸‹çš„å½¢å¼ 10. sortedæ’åºæ–¹æ³•,å’Œlistçš„é›†åˆsortä¸€æ · æƒ°æ€§æ±‚å€¼æ–¹æ³• 11. unorderedunorderedæ“ä½œä¸ä¼šè¿›è¡Œä»»ä½•æ˜¾å¼çš„æ‰“ä¹±æµçš„æ“ä½œã€‚å®ƒçš„å·¥ä½œæ˜¯ï¼šæ¶ˆé™¤æµä¸­å¿…é¡»ä¿æŒçš„æœ‰åºçº¦æŸï¼Œå› æ­¤å…è®¸ä¹‹åçš„æ“ä½œä½¿ç”¨ ä¸å¿…è€ƒè™‘æœ‰åºçš„ä¼˜åŒ–ã€‚ 12. é’ˆå¯¹mapçš„æ–°æ“ä½œ ä¸€ä¸ªé«˜çº§ä¾‹å­é¦–å…ˆæˆ‘ä»¬å®šä¹‰ç¨å¾®å¤æ‚çš„å¯¹è±¡,School å­¦æ ¡å¯¹è±¡,Student ç”¨æˆ·å¯¹è±¡ å®šä¹‰åˆå§‹åŒ–æ–¹æ³•allInit è¿™é‡Œå®šä¹‰ä¸€ä¸ªéœ€æ±‚,æ‰¾åˆ°è¿™ä¸¤ä¸ªå¤§å­¦æ‰¾å‡ºå…¶ä¸­æ‰€æœ‰å¹´çºªå¤§äº14å²çš„æ‰€æœ‰å­¦ç”Ÿçš„å§“åå’Œå­¦æ ¡å§“å æœ€åŸºæœ¬çš„éå†æ–¹æ³• (ç®€å•åŒå±‚forå¾ªç¯éå†) foreach å¤„ç†è¿­ä»£ ä½¿ç”¨ filterè¿‡æ»¤ç”¨æˆ·å¹´é¾„ä½¿ç”¨ map ç”Ÿæˆæ–°çš„å¯¹è±¡ è¿›é˜¶ ä½¿ç”¨flatmap é…åˆ collect(collection.toset())ä¸€æ¬¡æ€§ç”Ÿæˆ è¿™é‡Œç®€å•çš„åŸå› æ˜¯ flatMapæ•´åˆäº†æµ,è€Œcollect ç»“åˆäº†list @FunctionalInterface æ³¨è§£å…¶å®çœ‹ä¸€ä¸‹æ‰€æœ‰java å†…ç½®çš„å‡½æ•°åŒ–æ¥å£å…¶å®éƒ½ä½¿ç”¨äº†è¿™ä¸ªæ³¨è§£ è¯¥æ³¨è§£ä¼šå¼ºåˆ¶ javac æ£€æŸ¥ä¸€ä¸ªæ¥å£æ˜¯å¦ç¬¦åˆå‡½æ•°æ¥å£çš„æ ‡å‡†ã€‚å¦‚æœè¯¥æ³¨é‡Šæ·»åŠ ç»™ä¸€ä¸ªæšä¸¾ç±»å‹ã€ç±»æˆ–å¦ä¸€ä¸ªæ³¨é‡Šï¼Œæˆ–è€…æ¥å£åŒ…å«ä¸æ­¢ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œjavac å°±ä¼šæŠ¥é”™ã€‚é‡æ„ä»£ç æ—¶ï¼Œä½¿ç”¨å®ƒèƒ½å¾ˆå®¹æ˜“å‘ç°é—®é¢˜ã€‚ java æ”¶é›†å™¨java streamçš„æ”¶é›†å™¨å°±æ˜¯ä¸ºäº†å°†æ•°æ®æ•´ç†æˆåŒä¸€ç»“æ„çš„å·¥å…· java å†…éƒ¨ç±»åº“å®ç°çš„éƒ¨åˆ†æ”¶é›†å™¨ tolist toSet ä»¥ä¸Šä¸¤ä¸ªå¼æœ€ç®€å•çš„,å°±æ˜¯å°†streamä¸­çš„æ–¹æ³•å½¢æˆæ–°çš„é›†åˆ toCollection ä¸Šé¢è¿™ä¸ªå¯ä»¥å°† list è½¬åŒ–æˆstreamæ–¹æ³•å®šä¹‰æ¥å£çš„ç›¸åŒçš„é›†åˆå®ç°è‡ªå®šä¹‰ æ¯”å¦‚streamæ˜¯å®šä¹‰åœ¨collectionæ¥å£ä¸Šçš„,é‚£ä¸ªé€šè¿‡è¿™ä¸ªæ–¹æ³•èƒ½å®ç°listå’Œsetçš„ç›¸äº’è½¬åŒ– ps è¿™ä¸ªæ–¹æ³•çš„å®ç°å»ºè®®ä»”ç»†çš„ç ”ç©¶ä¸€ä¸‹ minBy maxBy è¿™ä¸ªæ–¹æ³•å°†ä¼šæŠŠè¿™ä¸ªé›†åˆä¸­åˆ¶å®šå‚æ•°æœ€å°çš„é‚£ä¸ªå¯¹è±¡è¿”å› averagingInt å¹³å‡æ•° summarizingInt æ±‚åˆ è¿™ä¸ªæ–¹æ³•å¯ä»¥è·å–è¿™ä¸ªintegeræ•°ç»„çš„å¹³å‡å€¼ partitioningBy åˆ†ç»„ç­›é€‰ æ•°æ®åˆ†ç»„ï¼Œ é€šè¿‡ä¸€ä¸ªè¿”å›booleanç±»å‹çš„è¡¨è¾¾å¼ä»è€Œå®ç°ä¸¤ç§è¿”å›å€¼çš„ç‰¹æ®Šæ”¶é›†å™¨ java å­—ç¬¦ä¸²æ‹¼æ¥æ–¹æ³• joiningä¸­çš„å„ç§æ–¹æ³•åˆ†åˆ«è¡¨ç¤ºå‚æ•°çš„åˆ†éš”ç¬¦ï¼Œå¼€å§‹ç¬¦å·å’Œç»“æŸç¬¦å· groupingBy mapping è‡ªå®šä¹‰åˆ†ç»„ è¿™ä¸ªæ–¹æ³•æ˜¯ä¸Šé¢çš„æ‰©å±•,å‡½æ•°å°†ä¼šä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‡½æ•°æ˜¯ç”Ÿæˆè¿”å›çš„keyï¼Œç¬¬äºŒä¸ªå‡½æ•°æ˜¯ç”Ÿæˆvalue ä¾‹å­ä¸­æˆ‘ä»¬éƒ½ç”¨åˆ°äº†ç¬¬äºŒä¸ªæ”¶é›†å™¨,ç”¨ä»¥æ”¶é›†æœ€ç»ˆç»“æœçš„ä¸€ä¸ªå­é›†ã€‚è¿™äº›æ”¶é›†å™¨å«ä½œä¸‹æ¸¸æ”¶é›†å™¨ã€‚æ”¶é›†å™¨æ˜¯ç”Ÿæˆæœ€ç»ˆç»“æœçš„ä¸€å‰‚é…æ–¹,ä¸‹æ¸¸æ”¶é›†å™¨åˆ™æ˜¯ç”Ÿæˆéƒ¨åˆ†ç»“æœçš„é…æ–¹,ä¸»æ”¶é›†å™¨ä¸­ä¼šç”¨åˆ°ä¸‹æ¸¸æ”¶é›†å™¨ã€‚è¿™ç§ç»„åˆä½¿ç”¨æ”¶é›†å™¨çš„æ–¹å¼,ä½¿å¾—å®ƒä»¬åœ¨ Stream ç±»åº“ä¸­çš„ä½œç”¨æ›´åŠ å¼ºå¤§ã€‚ é‚£äº›ä¸ºåŸºæœ¬ç±»å‹ç‰¹æ®Šå®šåˆ¶çš„å‡½æ•°,å¦‚ averagingInt ã€ summarizingLong ç­‰,äº‹å®ä¸Šå’Œè°ƒç”¨ç‰¹æ®Š Stream ä¸Šçš„æ–¹æ³•æ˜¯ç­‰ä»·çš„,åŠ ä¸Šå®ƒä»¬æ˜¯ä¸ºäº†å°†å®ƒä»¬å½“ä½œä¸‹æ¸¸æ”¶é›†å™¨æ¥ä½¿ç”¨çš„ å…¶ä»–çš„ä¸€äº›api listè½¬map â€“ è¿™ä¸ªéå¸¸å¸¸ç”¨ï¼ŒFunction.identity è‡ªå®šä¹‰java stream æ”¶é›†å™¨æœ‰çš„æ—¶å€™javaå†…ç½®çš„ç»„åˆå™¨å…¶å®å¹¶ä¸èƒ½çœŸæ­£çš„å®ç°æˆ‘ä»¬çš„éœ€æ±‚ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦è‡ªå®šä¹‰æ”¶é›†å™¨æ¥å®ç°æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ æ¯”å¦‚æˆ‘ä»¬æœ‰è¿™æ ·çš„ä¸€ä¸ªä¸šåŠ¡ï¼Œå­˜åœ¨å¦‚ä¸‹çš„ä¸€ç§å¯¹è±¡å’Œå¯¹è±¡çš„listé›†åˆï¼Œæˆ‘ä»¬éœ€è¦éå†çš„listé›†åˆï¼Œå–å‡ºæ‰‹æœ‰çš„nameä¿¡æ¯ï¼Œæ•´åˆæˆä»¥â€{â€œç¬¦åˆå¼€å¤´,â€]â€ç¬¦å·ç»“å°¾,â€,â€ç¬¦å·åˆ†éš”çš„å­—ç¬¦ä¸² æ–¹æ³•1 ä¼ ç»Ÿéå†æ³• æ–¹æ³•2 ä½¿ç”¨foreachéå† æ–¹æ³•3 å‘ç°æ˜¯ä¸€ç§è¿­ä»£æ¨¡å‹ä½¿ç”¨reduceå®ç° æ–¹æ³•4 å®ç°Collector<T, A, R> æ¥å£ é¦–å…ˆè¯´ä¸€ä¸‹Collector<T, A, R>æ¥å£ä¸­çš„ä¸‰ä¸ªèŒƒå‹ T å¾…æ”¶é›†å…ƒç´ çš„ç±»å‹,è¿™é‡Œæ˜¯ String ; A ç´¯åŠ å™¨çš„ç±»å‹ StringCombiner ; R æœ€ç»ˆç»“æœçš„ç±»å‹,è¿™é‡Œä¾ç„¶æ˜¯ String ã€‚ å‡ ä¸ªé‡è¦çš„æ–¹æ³• supplier åˆå§‹åŒ–å®¹å™¨ï¼Œå…¶å®ä¹Ÿå°±æ˜¯é»˜è®¤çš„å€¼æˆ–è€…å¤„ç†ç±» accumulator è¿­ä»£æ–¹æ³• combiner åŒæµåˆå¹¶æ–¹æ³• finish æœ€ç»ˆç”Ÿæˆæ–¹æ³• characteristics ä¸€ä¸ªä¼˜åŒ–ç”¨çš„åˆ—è¡¨ å®šä¹‰å¥½äº†è‡ªå®šä¹‰çš„collectä¹‹åå°±ç®€å•äº†ï¼Œç›´æ¥è°ƒç”¨å°±å¯ä»¥äº†","date":"2024-12-31","categories":["java"],"tags":["javaçš„stream"]},{"title":"java-streamå’Œlamble(3)-æ¥å£é»˜è®¤æ–¹æ³•å’Œç»§æ‰¿é—®é¢˜","url":"/2024/12/31/java-streamå’Œlamble-3--æ¥å£é»˜è®¤æ–¹æ³•å’Œç»§æ‰¿é—®é¢˜/","content":"java8 stream åœ¨collectionæ¥å£ä¸­æ·»åŠ äº†ä¸€ä¸ªæ–°çš„æ–¹æ³•å«åšstream,ä¹‹å‰å¦‚æœè‡ªå·±å®šä¹‰çš„å­ç±»å¦‚æœåœ¨java8 ä¸­æ²¡æœ‰å®ç°å°†ä¼šæŠ¥é”™ æ‰€ä»¥javaåœ¨æ¥å£ä¸Šæ·»åŠ äº†é»˜è®¤æ–¹æ³• defaultå­—æ®µæ¥å®ç°æ›´åŠ æ–¹ä¾¿çš„æ‰©å±• æ¥å£default çš„ç»§æ‰¿æ€§é—®é¢˜é¦–å…ˆæ€»ç»“ä¸€ä¸‹ç»§æ‰¿çš„è§„åˆ™: ç±»èƒœäºæ¥å£ã€‚å¦‚æœåœ¨ç»§æ‰¿é“¾ä¸­æœ‰æ–¹æ³•ä½“æˆ–æŠ½è±¡çš„æ–¹æ³•å£°æ˜ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¿½ç•¥æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚ å­ç±»èƒœäºçˆ¶ç±»ã€‚å¦‚æœä¸€ä¸ªæ¥å£ç»§æ‰¿äº†å¦ä¸€ä¸ªæ¥å£ï¼Œä¸”ä¸¤ä¸ªæ¥å£éƒ½å®šä¹‰äº†ä¸€ä¸ªé»˜è®¤æ–¹æ³•ï¼Œé‚£ä¹ˆå­ç±»ä¸­å®šä¹‰çš„æ–¹æ³•èƒœå‡º.å¦‚æœåŒæ—¶ç»§æ‰¿äº†ä¸¤ä¸ªå…·æœ‰ç›¸åŒæ–¹ç­¾åçš„æ¥å£,å°†ä¼šæŠ¥é”™,å› ä¸ºç¼–è¾‘å™¨ä¸çŸ¥é“é€‰æ‹©å“ªä¸€ä¸ª,ä½†æ˜¯å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ¥å…¼å®¹(åº”ç”¨äº†è§„åˆ™1) å¦‚æœä¸Šé¢ä¸¤æ¡è§„åˆ™ä¸é€‚ç”¨ï¼Œå­ç±»è¦ä¹ˆéœ€è¦å®ç°è¯¥æ–¹æ³•ï¼Œè¦ä¹ˆå°†è¯¥æ–¹æ³•å£°æ˜ä¸ºæŠ½è±¡æ–¹æ³•. æ³¨æ„defaultæ˜¯é’ˆå¯¹æ¥å£çš„,æ‰€ä»¥ä¸å­˜åœ¨ç»§æ‰¿çš„é—®é¢˜,å®ç°æ¥å£çš„ç±»åªæ˜¯è¦†ç›–,ä¸èƒ½æƒ³ç±»é‚£æ ·ä½¿ç”¨superå»è°ƒç”¨çˆ¶ç±»çš„ä¸œè¥¿ java æ¥å£ä¸­statiså’Œ defaultç›¸åŒç‚¹å’ŒåŒºåˆ« staticå’Œä¹‹å‰çš„è§„åˆ™ç›¸åŒ,å¹¶ä¸ä¼šäº§ç”Ÿç»§æ‰¿æ•ˆæœå¹¶ä¸”å¦‚æœè¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•,åªèƒ½ä½¿ç”¨å®šä¹‰çš„æ—¶å€™çš„ç±»æˆ–è€…æ¥å£æ¥è¿›è¡Œè°ƒç”¨ defaule åŒæ ·æ˜¯ä¸€ä¸ªé»˜è®¤æ–¹æ³•,ä½†æ˜¯defaultå¯ä»¥ä½¿ç”¨ç»§æ‰¿çš„æˆ–è€…å®ç°çš„ç±»æ¥è¿›è¡Œè°ƒç”¨,ä½†æ˜¯å­ç±»æˆ–è€…æ¥å£å¦‚æœå®ç°äº†é‡è½½ æ³¨æ„: å¦‚æœå­ç±»æˆ–è€…å­æ¥å£è¦æƒ³è°ƒç”¨çˆ¶æ¥å£ä¸­çš„defaultæ–¹æ³•,å¯ä»¥ä½¿ç”¨æ¥å£åç§°+super+æ–¹æ³•åç§°è°ƒç”¨","date":"2024-12-31","categories":["java"],"tags":["javaçš„stream"]},{"title":"java-streamå’Œlamble(4)-optional","url":"/2024/12/31/java-streamå’Œlamble-4--optional/","content":"åœ¨java8çš„å‡½æ•°å¼ç¼–ç¨‹ä¸­,å¤„ç†æµå¼å¤„ç†è¿˜æä¾›äº†ç©ºå€¼çš„æµå¼å¤„ç†Optional è¿™ä¸ªæ–¹æ³•å‡ ä¸ªé‡è¦çš„æ–¹æ³• 1. orElse(value) å’Œ orElseGet(function) å’Œ orElseThrowè·å–ä¸€ä¸ªå€¼, å¦‚æœæ²¡æœ‰å°†ä¼š å°†ä¼šä½¿ç”¨valueæ›¿ä»£,å¦‚æœä¼ å…¥çš„å‡½æ•°å°†ä¼šè¿è¡Œå‡½æ•°è¿”å›æŒ‡å®šçš„å€¼,å¦‚æœå¼å¼‚å¸¸å°†ä¼šè·‘å‡ºç©ºå€¼ 2. isEmpty isPresentå‰è€…å¦‚æœoptionalä¸ºç©ºå°†ä¼šè¿”å›true åè€…å°†ä¼šè¿”å›false 3. of å’Œ ofNullableåˆ›å»ºä¸€ä¸ªoptional å‰è€…ä¸èƒ½ä¼ é€’null åè€…å¯ä»¥ä¼ é€’null","date":"2024-12-31","categories":["java"],"tags":["javaçš„stream"]},{"title":"java-streamå’Œlamble(5)-é«˜çº§å†™æ³•","url":"/2024/12/31/java-streamå’Œlamble-5--é«˜çº§å†™æ³•/","content":"1. æ–¹æ³•å¼•ç”¨Lambda è¡¨è¾¾å¼æœ‰ä¸€ä¸ªå¸¸è§çš„ç”¨æ³•ï¼šLambda è¡¨è¾¾å¼ç»å¸¸è°ƒç”¨å‚æ•°ã€‚æ¯”å¦‚æƒ³å¾—åˆ°è‰ºæœ¯å®¶çš„å§“åï¼ŒLambda çš„è¡¨è¾¾å¼å¦‚ä¸‹ï¼š java ä¸ºè¿™ç§å†™æ³•æä¾›äº†æ›´åŠ ç®€å•çš„å®ç° æ„é€ å‡½æ•°ä¹Ÿæœ‰åŒæ ·çš„ç¼©å†™å½¢å¼ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨ Lambda è¡¨è¾¾å¼åˆ›å»ºä¸€ä¸ª Artist å¯¹è±¡ï¼Œå¯èƒ½ä¼šå†™å‡ºå¦‚ä¸‹ä»£ç ï¼š ä½¿ç”¨æ–¹æ³•å¼•ç”¨ï¼Œä¸Šè¿°ä»£ç å¯å†™ä¸ºï¼š","date":"2024-12-31","categories":["java"],"tags":["javaçš„stream"]},{"title":"java-streamå’Œlamble(6)-å¹¶è¡ŒåŒ–è®¡ç®—","url":"/2024/12/31/java-streamå’Œlamble-6--å¹¶è¡ŒåŒ–è®¡ç®—/","content":"java çš„å‡½æ•°å¼å˜æˆå°†ä¸€ä¸ªstreamæ“ä½œå˜æˆå¹¶è¡ŒåŒ–çš„è¿‡ç¨‹éå¸¸ç®€å•ï¼Œåªè¦ä½¿ç”¨parallelStream() æ–¹æ³•æ›¿ä»£stream()æ–¹æ³•å°±å¥½äº†","date":"2024-12-31","categories":["java"],"tags":["javaçš„stream"]},{"title":"Java-æ³›å‹(1)-åŸºæœ¬ä½¿ç”¨æ–¹æ³•1","url":"/2024/12/31/Java-æ³›å‹-1--åŸºæœ¬ä½¿ç”¨æ–¹æ³•1/","content":"ä¸€.å®šä¹‰èŒƒå‹ (1)èŒƒå‹å¯ä»¥ä½¿ç”¨æœ‰ç•Œè¡¨ç¤ºæ³•extends è¡¨ç¤ºä¸‹ç•Œsurper è¡¨ç¤ºä¸Šç•Œclass B {} # è¡¨ç¤ºåªæœ‰Aæˆ–è€…Açš„å­ç±»å¯æ¥å—class C{} # è¡¨ç¤ºåªæœ‰Fæˆ–è€…æ˜¯Fçš„çˆ¶ç±»å¯æ¥å— æ³¨æ„ ï¼šèŒƒå‹ä¸­çš„Tä¸èƒ½è¿›è¡Œå¼ºåˆ¶è½¬åŒ–â€”é™æ€ç¼–è¯‘å‹è¯­è¨€ç‰¹ç‚¹ (2)èŒƒå‹é€šé…ç¬¦ ? ä¸‰.ç»§æ‰¿ä¸­çš„èŒƒå‹ åªè¦ä¿è¯å¤–éƒ¨çš„èŒƒå‹ç±»å‹å¿…é¡»å®ç°å†…éƒ¨çš„ å››.èŒƒå‹çš„åº•å±‚å®ç°ä¸ºäº†å®ç°ä¸éæ³›å‹ä»£ç çš„å…¼å®¹ï¼ŒJavaè¯­è¨€çš„æ³›å‹é‡‡ç”¨æ“¦é™¤(Erasure)æ¥å®ç°ï¼Œä¹Ÿå°±æ˜¯æ³›å‹åŸºæœ¬ä¸Šç”±ç¼–è¯‘å™¨æ¥å®ç°ï¼Œç”±ç¼–è¯‘å™¨æ‰§è¡Œç±»å‹æ£€æŸ¥å’Œç±»å‹æ¨æ–­ï¼Œç„¶ååœ¨ç”Ÿæˆå­—èŠ‚ç ä¹‹å‰å°†å…¶æ¸…é™¤æ‰ï¼Œè™šæ‹Ÿæœºæ˜¯ä¸çŸ¥é“æ³›å‹å­˜åœ¨çš„ã€‚è¿™æ ·çš„è¯ï¼Œæ³›å‹å’Œéæ³›å‹çš„ä»£ç å°±å¯ä»¥æ··åˆè¿è¡Œï¼Œå½“ç„¶äº†ï¼Œä¹Ÿæ˜¾å¾—ç›¸å½“æ··ä¹±ã€‚ åœ¨ä½¿ç”¨æ³›å‹æ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªå¯¹åº”çš„ç±»å‹å«åšåŸç”Ÿç±»å‹(rawtype)ï¼Œæ³›å‹ç±»å‹ä¼šè¢«æ“¦é™¤åˆ°åŸç”Ÿç±»å‹ï¼Œå¦‚Genericä¼šè¢«æŸ¥å¤„åˆ°Genericï¼Œ**List**ä¼šè¢«æŸ¥å¤„åˆ°Listï¼Œç”±äºæ“¦é™¤ï¼Œåœ¨è™šæ‹Ÿæœºä¸­æ— æ³•è·å¾—ä»»ä½•ç±»å‹ä¿¡æ¯ï¼Œè™šæ‹ŸæœºåªçŸ¥é“åŸç”Ÿç±»å‹ã€‚ä¸‹é¢çš„ä»£ç å°†å±•ç¤ºJavaæ³›å‹çš„çœŸç›¸â€“æ“¦é™¤ï¼š ä½¿ç”¨javapåç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°å¦‚ä¸‹ä»£ç ï¼š ä»åç¼–è¯‘å‡ºæ¥çš„å­—èŠ‚ç å¯ä»¥çœ‹åˆ°ï¼Œæ³›å‹Erasureè¢«æ“¦é™¤åˆ°äº†Erasureï¼Œå…¶å†…éƒ¨çš„å­—æ®µTè¢«æ“¦é™¤åˆ°äº†Objectï¼Œå¯ä»¥çœ‹åˆ°getå’Œsetæ–¹æ³•ä¸­éƒ½æ˜¯æŠŠtä½œä¸ºObjectæ¥ä½¿ç”¨çš„ã€‚æœ€å€¼å¾—å…³æ³¨çš„æ˜¯ï¼Œåç¼–è¯‘ä»£ç çš„å€’æ•°ç¬¬ä¸‰è¡Œï¼Œå¯¹åº”åˆ°Javaä»£ç å°±æ˜¯Stringvalue &#x3D;eras.get();ç¼–è¯‘å™¨æ‰§è¡Œäº†ç±»å‹è½¬æ¢ã€‚è¿™å°±æ˜¯Javaæ³›å‹çš„æœ¬è´¨ï¼šå¯¹ä¼ é€’è¿›æ¥çš„å€¼è¿›è¡Œé¢å¤–çš„ç¼–è¯‘æœŸæ£€æŸ¥ï¼Œå¹¶æ’å…¥å¯¹ä¼ é€’å‡ºå»çš„å€¼çš„è½¬å‹ã€‚è¿™æ ·çš„æ³›å‹çœŸçš„æ˜¯æ³›å‹å—ï¼Ÿ å³ä¾¿æˆ‘ä»¬å¯ä»¥è¯´ï¼ŒJavaä¸­çš„æ³›å‹ç¡®å®ä¸æ˜¯çœŸæ­£çš„æ³›å‹ï¼Œä½†æ˜¯å®ƒå¸¦æ¥çš„å¥½å¤„è¿˜æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œå®ƒä½¿å¾—Javaçš„ç±»å‹å®‰å…¨å‰è¿›äº†ä¸€å¤§æ­¥ï¼ŒåŸæœ¬éœ€è¦ç¨‹åºå‘˜æ˜¾å¼æ§åˆ¶çš„ç±»å‹è½¬æ¢ï¼Œç°åœ¨æ”¹ç”±ç¼–è¯‘å™¨æ¥å®ç°ï¼Œåªè¦ä½ æŒ‰ç…§æ³›å‹çš„è§„èŒƒå»ç¼–å†™ä»£ç ï¼Œæ€»ä¼šå¾—åˆ°å®‰å…¨çš„ä¿éšœã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸å¾—ä¸æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼Œç†è§£Javaæ³›å‹ï¼Œé‚£ä¹ˆå…¶æ ¸å¿ƒç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ä¸ªäººè®¤ä¸ºï¼ŒJavaæ³›å‹çš„æ ¸å¿ƒç›®çš„åœ¨äºå®‰å…¨æ€§ï¼Œå°¤å…¶æ˜¯åœ¨ç†è§£æ³›å‹é€šé…ç¬¦æ—¶ï¼Œä¸€åˆ‡å¥‡æ€ªçš„è§„åˆ™ï¼Œå½’æ ¹ç»“åº•éƒ½æ˜¯å¤„äºå®‰å…¨çš„ç›®çš„ã€‚ è¿™é‡Œä½¿ç”¨æ³›å‹æ³¨æ„æ“¦é™¤åˆ°çš„æ˜¯åŸå§‹ç±»å‹,ä¹Ÿå°±æ˜¯åº•çº¿,æ³›å‹å¦‚æœæ˜¯è¿™æ ·å®šä¹‰çš„ é‚£ä¹ˆåº•çº¿å°±æ˜¯String ç±»å‹ä¿¡æ¯çš„ä¸¢å¤± ç”±äºæ“¦é™¤çš„åŸå› ï¼Œåœ¨æ³›å‹ä»£ç å†…éƒ¨ï¼Œæ— æ³•è·å¾—ä»»ä½•æœ‰å…³æ³›å‹å‚æ•°ç±»å‹çš„ä¿¡æ¯ã€‚åœ¨è¿è¡Œæ—¶ï¼Œè™šæ‹Ÿæœºæ— æ³•è·å¾—ç¡®åˆ‡çš„ç±»å‹ä¿¡æ¯ï¼Œä¸€åˆ‡ä»¥æ¥ç¡®åˆ‡ç±»å‹ä¿¡æ¯çš„å·¥ä½œéƒ½æ— æ³•å®Œæˆï¼Œæ¯”å¦‚instanceofæ“ä½œï¼Œå’Œnewè¡¨è¾¾å¼ï¼Œ äº”.å‹çš„ç›¸å…³å‘ç‚¹ èŒƒå‹ä¸æ˜¯ç±»å‹ç»‘å®šçš„æ‰€ä»¥ List å’Œ List ä¸æ˜¯åŒä¸€ä¸ªç±»å¯ä»¥ä½¿ç”¨é€šé…ç¬¦å°†ä¸¤ä¸ªå±æ€§å˜æˆç›¸åŒçš„ æ³›å‹ç±»ä¸­çš„æ•°ç»„å¯¹æ•°ç»„çš„é™åˆ¶ ä¸èƒ½å®ä¾‹åŒ–æ³›å‹æ•°ç»„ å…¶æ¬¡ä¸èƒ½å£°æ˜ æ³›å‹ç»„æˆçš„æ•°ç»„ ä¸èƒ½å®ä¾‹åŒ–èŒƒå‹ new T();","date":"2024-12-31","categories":["java"],"tags":["javaèŒƒå‹åå°„ç±»å‹ç³»ç»Ÿ"]},{"title":"java-æ³›å‹(2)-åŸºæœ¬ä½¿ç”¨æ–¹æ³•2","url":"/2024/12/31/java-æ³›å‹-2--åŸºæœ¬ä½¿ç”¨æ–¹æ³•2/","content":"æ³›å‹çš„ä½¿ç”¨æ³›å‹æœ‰ä¸‰ç§ä½¿ç”¨æ–¹å¼ï¼Œåˆ†åˆ«ä¸ºï¼šæ³›å‹ç±»ã€æ³›å‹æ¥å£ã€æ³›å‹æ–¹æ³• æ³›å‹ç±»å’Œæ³›å‹æ¥å£æ³›å‹ç±»çš„æœ€åŸºæœ¬å†™æ³• ä¸€ä¸ªæœ€æ™®é€šçš„æ³›å‹ç±»ï¼š æ³¨æ„ï¼šèŒƒå‹ç±»ä¹Ÿå¯ä»¥ä¼ å…¥èŒƒå‹å®å‚ï¼ŒåŒæ ·ä¹Ÿä¼šè¢«ç±»çš„å®šä¹‰æ‰€é™åˆ¶ èŒƒå‹æ–¹æ³•æ³›å‹ç±»ï¼Œæ˜¯åœ¨å®ä¾‹åŒ–ç±»çš„æ—¶å€™æŒ‡æ˜æ³›å‹çš„å…·ä½“ç±»å‹ï¼›æ³›å‹æ–¹æ³•ï¼Œæ˜¯åœ¨è°ƒç”¨æ–¹æ³•çš„æ—¶å€™æŒ‡æ˜æ³›å‹çš„å…·ä½“ç±»å‹ ã€‚ æ³¨æ„ï¼šå³ä½¿åœ¨èŒƒå‹ç±»ä¸­æŒ‡å®šèŒƒå‹æ ‡è¯†å’Œç±»ä¸­çš„èŒƒå‹æ–¹æ³•ä½¿ç”¨çš„èŒƒå‹æ ‡è¯†ç›¸åŒï¼Œç±»ä¸­çš„èŒƒå‹æ–¹æ³•ä½¿ç”¨çš„èŒƒå‹æ ‡è¯†ä¹Ÿç›¸å½“äºä¸€ä¸ªæ–°çš„æ ‡è¯† æ³¨æ„ï¼šé™æ€æ–¹æ³•åªèƒ½å£°æ˜ä¸ºèŒƒå‹å‡½æ•°ï¼Œå¦åˆ™ä¸å¯ä»¥å¸¦æœ‰èŒƒå‹ æ³›å‹ä¸Šä¸‹è¾¹ç•Œå’Œé€šé…ç¬¦java ä½¿ç”¨extends å’Œ super åˆ†åˆ«è¡¨ç¤º èŒƒå‹å£°æ˜æ—¶çš„åªèƒ½æ˜¯extendsåŠå…¶å­ç±»ï¼Œå’Œä½¿ç”¨æ—¶å¿…é¡»æ˜¯superåŠå…¶çˆ¶ç±»çš„é™åˆ¶ ä¸Šé¢çš„ä¾‹å­ä¸­ä½¿ç”¨äº†é€šé…ç¬¦ åœ¨java çš„èŒƒå‹ä¸­é€šé…ç¬¦è§£å†³äº†èŒƒå‹å¤šç‰ˆæœ¬ä¸å…¼å®¹çš„é—®é¢˜ æ¯”å¦‚Genericä¸èƒ½è¢«çœ‹ä½œä¸º&#96;Genericçš„å­ç±»ã€‚æ‰€ä»¥åŒä¸€ç§æ³›å‹å¯ä»¥å¯¹åº”å¤šä¸ªç‰ˆæœ¬ï¼ˆå› ä¸ºå‚æ•°ç±»å‹æ˜¯ä¸ç¡®å®šçš„ï¼‰ï¼Œä¸åŒç‰ˆæœ¬çš„æ³›å‹ç±»å®ä¾‹æ˜¯ä¸å…¼å®¹çš„ã€‚ å› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåœ¨é€»è¾‘ä¸Šå¯ä»¥è¡¨ç¤ºåŒæ—¶æ˜¯Genericå’ŒGenericçˆ¶ç±»çš„å¼•ç”¨ç±»å‹ã€‚ç”±æ­¤ç±»å‹é€šé…ç¬¦åº”è¿è€Œç”Ÿã€‚ ä¾‹å­å¦‚ä¸‹ å°†ç¨‹åºæ”¹æˆè¿™æ ·æ—¢å¯ä»¥é€šè¿‡ ç±»å‹é€šé…ç¬¦ä¸€èˆ¬æ˜¯ä½¿ç”¨ï¼Ÿä»£æ›¿å…·ä½“çš„ç±»å‹å®å‚ï¼Œæ³¨æ„äº†ï¼Œæ­¤å¤„â€™ï¼Ÿâ€™æ˜¯ç±»å‹å®å‚ï¼Œè€Œä¸æ˜¯ç±»å‹å½¢å‚ ï¼Œå¯ä»¥æŠŠï¼Ÿçœ‹æˆæ‰€æœ‰ç±»å‹çš„çˆ¶ç±»ã€‚æ˜¯ä¸€ç§çœŸå®çš„ç±»å‹ã€‚ èŒƒå‹æ•°ç»„ï¼ˆèŒƒå‹çš„é™åˆ¶ï¼‰å…³äºæ³›å‹æ•°ç»„è¦æä¸€ä¸‹çœ‹åˆ°äº†å¾ˆå¤šæ–‡ç« ä¸­éƒ½ä¼šæèµ·æ³›å‹æ•°ç»„ï¼Œç»è¿‡æŸ¥çœ‹sunçš„è¯´æ˜æ–‡æ¡£ï¼Œåœ¨javaä¸­æ˜¯â€ä¸èƒ½åˆ›å»ºä¸€ä¸ªç¡®åˆ‡çš„æ³›å‹ç±»å‹çš„æ•°ç»„â€çš„ã€‚ ä¹Ÿå°±æ˜¯è¯´ä¸‹é¢çš„è¿™ä¸ªä¾‹å­æ˜¯ä¸å¯ä»¥çš„ï¼š è€Œä½¿ç”¨é€šé…ç¬¦åˆ›å»ºæ³›å‹æ•°ç»„æ˜¯å¯ä»¥çš„ï¼Œå¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š è¿™æ ·ä¹Ÿæ˜¯å¯ä»¥çš„ï¼š ä¸‹é¢ä½¿ç”¨Sunçš„ä¸€ç¯‡æ–‡æ¡£çš„ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼š å…¶å®è¯´ç™½äº†å°±æ˜¯javaåœ¨å®ç°èŒƒå‹çš„æ—¶å€™ä½¿ç”¨äº†æ“¦é™¤çš„æ–¹æ³•ï¼Œæ‰€ä»¥åœ¨ä¸Šé¢ä»£ç çš„æœ€åä¸€è¡Œå°†ä¼šå‡ºç°string &#x3D; object è¿™ç§ç±»å‹ä¸åŒ¹é…çš„æƒ…å†µ ä¸‹é¢é‡‡ç”¨é€šé…ç¬¦çš„æ–¹å¼æ˜¯è¢«å…è®¸çš„:æ•°ç»„çš„ç±»å‹ä¸å¯ä»¥æ˜¯ç±»å‹å˜é‡ï¼Œé™¤éæ˜¯é‡‡ç”¨é€šé…ç¬¦çš„æ–¹å¼ï¼Œå› ä¸ºå¯¹äºé€šé…ç¬¦çš„æ–¹å¼ï¼Œæœ€åå–å‡ºæ•°æ®æ˜¯è¦åšæ˜¾å¼çš„ç±»å‹è½¬æ¢çš„ã€‚","date":"2024-12-31","categories":["java"],"tags":["javaèŒƒå‹åå°„ç±»å‹ç³»ç»Ÿ"]},{"title":"java-æ³›å‹(3)-åŒ¿åå†…éƒ¨ç±»+åå°„+æ³›å‹å®ç°çœŸå®åå°„æœºåˆ¶","url":"/2024/12/31/java-æ³›å‹-3--åŒ¿åå†…éƒ¨ç±»-åå°„-æ³›å‹å®ç°çœŸå®åå°„æœºåˆ¶/","content":"javaé’ˆå¯¹æ³›å‹ç±»å‹çš„å®ç°æ–¹æ³•,å’Œåå°„ä¹‹é—´çš„åº”ç”¨javaçš„æ³›å‹å®ç°å› ä¸ºè€ƒè™‘åˆ°å…¼å®¹å‹çš„é—®é¢˜,æ‰€ä»¥ä¸€å¼€å§‹é‡‡ç”¨äº†ç±»å‹æ“¦é™¤çš„æœºåˆ¶å®ç°ç›¸å…³çš„åŠŸèƒ½. ä½†æ˜¯è¿™ç§ç±»å‹æ“¦é™¤çš„æœºåˆ¶åˆå¸¦æ¥äº†ä¸€ä¸ªæ–°çš„é—®é¢˜,æ¯”å¦‚è¿™æ ·çš„åœºæ™¯ å› ä¸ºTä¼šåœ¨javaè¿è¡Œçš„æ—¶å€™è¿›è¡Œæ“¦é™¤,æ‰€ä»¥è¿™é‡Œè¾“å‡ºçš„å†…å®¹æ˜¯Object å¦‚æœæƒ³è¦è·å–è¿™ä¸ªå‚æ•°çš„ç±»å‹,æˆ‘ä»¬åªèƒ½åœ¨æ³›å‹ç±»çš„å†…éƒ¨è·å–åˆ° ä¸ºä»€ä¹ˆä¼šè¿™æ ·çš„å‘¢,è¿™é‡Œæ²¡æœ‰å¾—åˆ°æƒå¨çš„ç­”æ¡ˆ,ä½†æ˜¯æŒ‰ç…§æˆ‘çš„çŒœæƒ³,åº”è¯¥æ˜¯è¿™æ ·çš„è¿‡ç¨‹ æˆ‘ä»¬çœ‹ä¸€ä¸‹javaç”Ÿæˆçš„classæ–‡ä»¶,å‘ç°ä¸Šé¢è¿™ä¸ªç±»å…¶å®ç”Ÿæˆäº†ä¸‰ä¸ªç±» ç¬¬ä¸€ä¸ª å’Œæœ€åä¸€ä¸ªå°±ä¸ç”¨å¤šè¯´äº†,é‡ç‚¹å…³å¿ƒä¸€ä¸‹ä¸­é—´è¿™ä¸ª,åç¼–è¯‘çœ‹çœ‹ çœ‹åˆ°è¿™é‡Œå·®ä¸å¤šæ¥äº†å°±èƒ½çŸ¥é“javaè™šæ‹Ÿæœºåº•å±‚æ˜¯æ€ä¹ˆå¤„ç†è¿™é‡Œçš„äº† æˆ‘ä»¬å°†ä»£ç ä¿®æ”¹ä¸€ä¸‹å˜æˆè¿™æ · å†çœ‹çœ‹ç”Ÿæˆçš„classæ–‡ä»¶ä¿¡æ¯ ä¸Šé¢çš„ä»£ç ä¸­ç”Ÿæˆäº†4ä¸ªæ³›å‹åŒ¿åå†…éƒ¨ç±»ç±»,ç„¶ååœ¨javaçš„class æ–‡ä»¶ä¸­åŒæ ·ç”Ÿæˆäº†å››ä¸ª ç±»å+$+ç¼–å·çš„ åŠ¨æ€ç”Ÿæˆclass ps è¿™ä¸ªæœºåˆ¶å…¶å®æ˜¯javaå®ç°åŒ¿åå†…éƒ¨ç±»çš„åŸç†,jdkè‡ªå·±newäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡æ¥å®ç°ç±»çš„ç”Ÿæˆ è¿™æ ·å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ä½¿ç”¨çš„æ—¶å€™èƒ½è·å–åˆ°ç±»å‹çš„åŸå› ,å’Œè·å–æ³›å‹ç±»å‹çš„æ–¹æ³•æ˜¯Type superClass &#x3D; getClass().getGenericSuperclass();ä½¿ç”¨çš„æ˜¯supper ç±». å› ä¸ºjavaåŠ¨æ€ç”Ÿæˆä¸€ä¸ªç»§æ‰¿äº†æºå¸¦æ³›å‹çœŸå®ç±»å‹çš„classç±»,åœ¨è¿è¡Œçš„æ—¶å€™è¿›è¡Œäº†ç±»å‹çš„åŠ¨æ€æ›¿æ¢ é€šè¿‡ä¸Šé¢çš„ä¾‹å­å…¶å®æˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸€ä¸ªè§„å¾‹:å¦‚æœæ³›å‹æƒ³è¦æ‹¿åˆ°å‚æ•°,å¿…é¡»åœ¨å£°æ˜ç±»çš„æ—¶å€™å°±å°†æ³›å‹å¯¹åº”çš„å‚æ•°ä¼ é€’è¿›å…¥é€šè¿‡è¿™ç§ä¾‹å­æˆ‘ä»¬å°±å¯ä»¥åœ¨å£°æ˜çš„æ—¶å€™å¤§å¿«äººå¿ƒçš„ä½¿ç”¨æ³›å‹äº† å½“ç„¶æˆ‘ä»¬äº¦å¯ä»¥å‚è€ƒå¼€ç¯‡çš„åˆ†æä½¿ç”¨åŒ¿åå†…éƒ¨ç±»æ¥è®©jvmè‡ªåŠ¨çš„æ—¶å€™è¿™ä¸ªè¿‡ç¨‹,ä½†æ˜¯ä¸æ¨èè¿™æ ·ä½¿ç”¨,å› ä¸ºè¿™ä¸ªæ—¶å€™javaå·²ç»é€€åŒ–æˆä¸€ä¸ªåŠ¨æ€è¯­è¨€äº†,jvmæ— æ³•è¿›è¡Œä¼˜åŒ–","date":"2024-12-31","categories":["java"],"tags":["javaèŒƒå‹åå°„ç±»å‹ç³»ç»Ÿ"]},{"title":"java-æ³¨è§£åå°„åŠ¨æ€ä»£ç†(1)-æ³¨è§£","url":"/2024/12/31/java-æ³¨è§£åå°„åŠ¨æ€ä»£ç†-1--æ³¨è§£/","content":"javaæ³¨è§£ï¼Œ@ï¼Œæ³¨è§£æœ‰ä»€ä¹ˆç”¨@æ˜¯javaæ³¨è§£ï¼Œå³annotationã€‚ å¯ä»¥ç†è§£ä¸ºæ’ä»¶ï¼Œæ˜¯ä»£ç çº§åˆ«çš„æ’ä»¶ï¼Œåœ¨ç±»çš„æ–¹æ³•ä¸Šå†™ï¼š@XXXï¼Œå°±æ˜¯åœ¨ä»£ç ä¸Šæ’å…¥äº†ä¸€ä¸ªæ’ä»¶ã€‚ Javaæ³¨è§£æ˜¯é™„åŠ åœ¨ä»£ç ä¸­çš„ä¸€äº›å…ƒä¿¡æ¯ï¼Œç”¨äºä¸€äº›å·¥å…·åœ¨ç¼–è¯‘ã€è¿è¡Œæ—¶è¿›è¡Œè§£æå’Œä½¿ç”¨ï¼Œèµ·åˆ°è¯´æ˜ã€é…ç½®çš„åŠŸèƒ½ã€‚æ³¨è§£ä¸ä¼šä¹Ÿä¸èƒ½å½±å“ä»£ç çš„å®é™…é€»è¾‘ï¼Œä»…ä»…èµ·åˆ°è¾…åŠ©æ€§çš„ä½œç”¨ å…ƒæ³¨è§£å’Œè‡ªå®šä¹‰æ³¨è§£javaä¸­æœ‰å¾ˆå¤šçš„æ³¨è§£æ¯”å¦‚@Overrideç­‰ç­‰ï¼Œè¿™äº›æ³¨è§£å…¶å®æ˜¯jdkå†…éƒ¨è‡ªå·±å£°æ˜çš„æ³¨è§£ï¼Œè€Œè¿™äº›æ³¨è§£çš„å£°æ˜å°±ä¾èµ–äºæ³¨è§£çš„æ³¨è§£çš„å…ƒæ³¨è§£ å…ƒæ³¨è§£ç±»å‹ @target å£°æ˜æ³¨è§£çš„å¯¹è±¡èŒƒå›´ æ³¨è§£ç±»å‹åŒ…æ‹¬ ç±»å‹åç§° é™åˆ¶èŒƒå›´ construction æ„é€ å‡½æ•° FIeld å˜é‡åŸŸ LOCAL_VARIABLE ç”¨äºæè¿°å±€éƒ¨å˜é‡ METHOD ç”¨äºæè¿°æ–¹æ³• PACKAGE ç”¨äºæè¿°åŒ… PARAMETER ç”¨äºæè¿°å‚æ•° TYPE ç”¨äºæè¿°ç±»ã€æ¥å£(åŒ…æ‹¬æ³¨è§£ç±»å‹) æˆ–enumå£°æ˜ @Retentionå£°æ˜æ³¨è§£çš„ä¿ç•™èŒƒå›´ ç±»å‹ ä¿ç•™èŒƒå›´ SOURCE åœ¨æºæ–‡ä»¶ä¸­æœ‰æ•ˆï¼ˆå³æºæ–‡ä»¶ä¿ç•™ï¼‰ CLASS åœ¨classæ–‡ä»¶ä¸­æœ‰æ•ˆï¼ˆå³classä¿ç•™ï¼‰ RUNTIME åœ¨è¿è¡Œæ—¶æœ‰æ•ˆï¼ˆå³è¿è¡Œæ—¶ä¿ç•™ï¼‰ @Documentedæ³¨è§£çš„æ–‡æ¡£çš„åŒ– ç”¨äºæè¿°å…¶å®ƒç±»å‹çš„annotationåº”è¯¥è¢«ä½œä¸ºè¢«æ ‡æ³¨çš„ç¨‹åºæˆå‘˜çš„å…¬å…±APIï¼Œå› æ­¤å¯ä»¥è¢«ä¾‹å¦‚javadocæ­¤ç±»çš„å·¥å…·æ–‡æ¡£åŒ–ã€‚Documentedæ˜¯ä¸€ä¸ªæ ‡è®°æ³¨è§£ï¼Œæ²¡æœ‰æˆå‘˜ã€‚ @Inherited â€“æ³¨è§£çš„ç»§æ‰¿åŒ– å…ƒæ³¨è§£æ˜¯ä¸€ä¸ªæ ‡è®°æ³¨è§£ï¼Œ@Inheritedé˜è¿°äº†æŸä¸ªè¢«æ ‡æ³¨çš„ç±»å‹æ˜¯è¢«ç»§æ‰¿çš„ã€‚å¦‚æœä¸€ä¸ªä½¿ç”¨äº†@Inheritedä¿®é¥°çš„annotationç±»å‹è¢«ç”¨äºä¸€ä¸ªclassï¼Œåˆ™è¿™ä¸ªannotationå°†è¢«ç”¨äºè¯¥classçš„å­ç±»ã€‚ æ³¨æ„ï¼š@Inherited annotationç±»å‹æ˜¯è¢«æ ‡æ³¨è¿‡çš„classçš„å­ç±»æ‰€ç»§æ‰¿ã€‚ç±»å¹¶ä¸ä»å®ƒæ‰€å®ç°çš„æ¥å£ç»§æ‰¿annotationï¼Œæ–¹æ³•å¹¶ä¸ä»å®ƒæ‰€é‡è½½çš„æ–¹æ³•ç»§æ‰¿annotationã€‚ æ³¨æ„ï¼šå½“@Inherited annotationç±»å‹æ ‡æ³¨çš„annotationçš„Retentionæ˜¯RetentionPolicy.RUNTIMEï¼Œåˆ™åå°„APIå¢å¼ºäº†è¿™ç§ç»§æ‰¿æ€§ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨java.lang.reflectå»æŸ¥è¯¢ä¸€ä¸ª@Inherited annotationç±»å‹çš„annotationæ—¶ï¼Œåå°„ä»£ç æ£€æŸ¥å°†å±•å¼€å·¥ä½œï¼šæ£€æŸ¥classå’Œå…¶çˆ¶ç±»ï¼Œç›´åˆ°å‘ç°æŒ‡å®šçš„annotationç±»å‹è¢«å‘ç°ï¼Œæˆ–è€…åˆ°è¾¾ç±»ç»§æ‰¿ç»“æ„çš„é¡¶å±‚ã€‚","date":"2024-12-31","categories":["java"],"tags":["javaèŒƒå‹åå°„ç±»å‹ç³»ç»Ÿ"]},{"title":"java-æ³¨è§£åå°„åŠ¨æ€ä»£ç†(2)-åå°„1-åŸºç¡€æ–¹æ³•","url":"/2024/12/31/java-æ³¨è§£åå°„åŠ¨æ€ä»£ç†-2--åå°„1-åŸºç¡€æ–¹æ³•/","content":"åå°„çš„å®šä¹‰åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§ï¼›è¿™ç§åŠ¨æ€è·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸ºåå°„ã€‚ åœ¨javaä¸­åå°„æ˜¯åŸºäºclassä¿¡æ¯çš„ å…³äºClass:Classæ˜¯ä¸€ä¸ªç±»ï¼Œä¸€ä¸ªæè¿°ç±»çš„ç±»ï¼ˆä¹Ÿå°±æ˜¯æè¿°ç±»æœ¬èº«ï¼‰ï¼Œå°è£…äº†æè¿°æ–¹æ³•çš„Methodï¼Œæè¿°å­—æ®µçš„Filedï¼Œæè¿°æ„é€ å™¨çš„Constructorç­‰å±æ€§ javaåå°„ç›¸å…³çš„æ¥å£æ–¹æ³•å’Œæœ€ä½³å®è·µclassclass æ˜¯javaåå°„çš„æœ€ç²—é›†åˆ,åˆ†è£…äº†classå¯¹åº”çš„å„ç§å±æ€§ è·å–class åç§°æˆ–è€…ç±»å‹åç§° javaçš„class å¯¹è±¡æä¾›äº†ä¸¤ä¸ªæ–¹æ³•è·å–åç§°å­—ç¬¦ä¸² getName è¿™ä¸ªæ–¹æ³•ä¼šè¿”å›è¿™ä¸ªclassçš„è§£æåç§°,ç»æè§„åˆ™å¦‚ä¸‹ å¦‚æœæ˜¯å¯¹è±¡,å°±è¿”å›å¯¹è±¡çš„å…¨é™å®šåç§°(æ²¡æœ‰æ³›å‹ä¿¡æ¯)å¦‚æœæ˜¯æ•°ç»„è¿”å›å¦‚ä¸‹ä¿¡æ¯,[è¡¨ç¤ºç»´åº¦[Z &#x3D; boolean[B &#x3D; byte[S &#x3D; short[I &#x3D; int[J &#x3D; long[F &#x3D; float[D &#x3D; double[C &#x3D; char[L &#x3D; any non-primitives(Object) getTypeName è¿”å›ç±»å‹é€šgetNameæ–¹æ³• å¦‚æœæ˜¯æ•°ç»„é›†åˆæˆ–è€…å¯¹è±¡,è¿”å›è¿™ä¸ªçš„å®šä¹‰æ ¼å¼ æ¯”å¦‚å¦‚æœæ˜¯int[][][] å°†ä¼šè¿”å›int[][][] class ç»§æ‰¿å…³ç³»çŠ¶æ€è·å– é€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥å¿«é€ŸæŸ¥æ‰¾classçš„ç»§æ‰¿å…³ç³» class æœ‰å…³java Typeä½“ç³»çš„ä¿¡æ¯è·å– class æœ‰å…³åŒ…ä¿¡æ¯çš„æ–¹æ³• classçš„è®¿é—®çº§åˆ« class å¯¹è±¡æˆ–è€…classç±»å¼ºåˆ¶è½¬åŒ–æä¾›çš„åŠŸèƒ½ é’ˆå¯¹ç‰¹æ®Šç±»å‹æ¯”å¦‚arrç±»å‹æšä¸¾çš„ç‰¹æ®Šå¤„ç†æ–¹æ³• å„ç§isæ–¹æ³• æ³¨è§£ä½¿ç”¨æ–¹æ³• ç±»åŠ è½½å™¨è·å– èµ„æºè·å– fieldfieldæ˜¯javaå‚æ•°å±æ€§çš„è½½ä½“. fieldè·å–æ–¹æ³• fieldä¸€äº›å±æ€§ä¿¡æ¯æ–¹æ³• fieldè®¾ç½®å’Œè·å–æ–¹æ³• fieldç±»å‹è·å–æ–¹æ³• é’ˆå¯¹æ³¨è§£çš„æ–¹æ³• method è·å–æ–¹æ³• methodå‚æ•°ç›¸å…³æ“ä½œæ–¹æ³•æ–¹æ³• methodè¿”å›å€¼ç›¸å…³å‚æ•°æ–¹æ³• è¿è¡Œæ–¹æ³• æ³¨è§£æ–¹æ³• ç›¸æ¯”è¾ƒå…¶ä»–çš„ç¼–ç¨‹è¯­è¨€æ–¹æ³•,methodåªæ˜¯å¤šäº†è·å–å‚æ•°çš„æ³¨è§£æ–¹æ³• å¼‚å¸¸æ•è· methodå±æ€§æ“ä½œç›¸å…³æ–¹æ³• 8. Constructorjavaçš„constructerå¯ä»¥ç†è§£æˆç‰¹æ®Šçš„æ–¹æ³•(javaä¸­å¹¶ä¸ç­‰åŒ,å¤„ç†æ–¹æ³•,ç»§æ‰¿ä¿¡æ¯ç­‰ç­‰éƒ½æ˜¯ä¸ç›¸åŒçš„),æ–¹æ³•éƒ½æ˜¯é€šç”¨çš„,è¿™é‡Œè®°å½•ä¸€ä¸‹ä¸åŒçš„æ–¹æ³• constructorè·å–æ–¹æ³• è¿™é‡Œä¸è§£é‡Šäº†,æ²¡æœ‰Declaredçš„æ–¹æ³•è¡¨ç¤ºè·å–æ‰€æœ‰çš„publicæ„é€ å‡½æ•°,æœ‰çš„å°†ä¼šè·å–è¿™ä¸ªç±»ä¸­ç›´æ¥å®šä¹‰çš„æ„é€ å¥½ä¹¦ æ„é€ å‡½æ•°åˆ›å»ºå®ä½“ç±» array èŒƒå‹ AccessibleObject AccessibleObjectæ˜¯ Method Fielt Constructionçš„ä¸€ä¸ªçˆ¶ç±»-éƒ½å®ç°äº†æ­¤ç±»çš„æ–¹æ³•,è¿™ä¸ªç±»ä¸»è¦æ˜¯æ‰©å±•äº†è®¿é—®æƒé™çš„æ§åˆ¶ å°¤å…¶è¦æ³¨æ„è¿™ä¸ªåœ°æ–¹setAccessible(true); æ­£æ˜¯é€šè¿‡è¿™ä¸ªé…ç½®æ–¹æ³•çš„è®¿é—®æƒé™ è¿™é‡Œå…¶å®è¦è®°å½•ä¸€ä¸‹æœ‰å…³äºæ³›å‹åå°„çš„ä¸€äº›ä¸œè¥¿æˆ‘ä»¬éƒ½çŸ¥é“javaçš„æ³›å‹å®ç°æ˜¯åŸºäºç±»å‹æ“¦é™¤çš„,è¿™å°†ä¼šä¼šå¯¼è‡´è¿™ä¸ªæ³›å‹çš„ç±»å‹å°†åœ¨åå°„çš„æ—¶å€™è¿”å›å…·ä½“ç±»å‹(é»˜è®¤æ˜¯object)ä½†æ˜¯è¿™ç§æƒ…å†µå¹¶ä¸æ˜¯ç»å¯¹äº†,ç›®å‰æˆ‘æ€»ç»“äº†ä¸‰ç§æƒ…å†µä¸‹javaä¼šä¿è¯åŸæ¥çš„ç±»å‹ ç”ŸæˆåŒ¿åå†…éƒ¨ç±»çš„æ—¶å€™ ä¹Ÿå°±æ˜¯newä¸€ä¸ªæ¥å£æˆ–è€…newä¸€ä¸ªæŠ½è±¡ç±» è¿™ç§æƒ…å†µä¸‹å°†ä¼šä¿ç•™åŸæ¥çš„å±æ€§ å®ç°çš„åŸç†æ˜¯javaé’ˆå¯¹åŒ¿åå†…éƒ¨ç±»å°†ä¼šåŠ¨æ€çš„ç”Ÿæˆæ–°çš„class è€Œè¿™ä¸ªclassçš„æ³›å‹æ˜¯å¸¦æœ‰å‚æ•°çš„ æ–¹æ³•çš„è¿”å›å€¼ æ‰€æœ‰çš„æ–¹æ³•çš„æ–¹æ³•å¦‚æœä½¿ç”¨æ³›å‹ç±»,æ¯”å¦‚ List è¿™ç§æƒ…å†µä¸‹æ˜¯èƒ½è·å–åˆ°æ³›å‹ä¸­çš„ç±»å‹çš„ å­ç±»ç»§æ‰¿æ³›å‹çˆ¶ç±» å…¶å®è¿™ç§æƒ…å†µæ˜¯1 ç±»å‹çš„æ‰‹åŠ¨å®ç°ä¹Ÿå°±æ˜¯å®ç°ä¸‹é¢è¿™ç§æƒ…å†µd æ€»ç»“ä¸€äº›,å¦‚æœæ³›å‹æƒ³è¦æ‹¿åˆ°å‚æ•°,å¿…é¡»åœ¨å£°æ˜ç±»çš„æ—¶å€™å°±å°†æ³›å‹å¯¹åº”çš„å‚æ•°ä¼ é€’è¿›å…¥","date":"2024-12-31","categories":["java"],"tags":["javaèŒƒå‹åå°„ç±»å‹ç³»ç»Ÿ"]},{"title":"java-æ³¨è§£åå°„åŠ¨æ€ä»£ç†(2)-åå°„2-javaTypeç±»å‹ä½“ç³»","url":"/2024/12/31/java-æ³¨è§£åå°„åŠ¨æ€ä»£ç†-2--åå°„2-javaTypeç±»å‹ä½“ç³»/","content":"Java Typeä½“ç³»ç®€ä»‹Typeæ˜¯Java ç¼–ç¨‹è¯­è¨€ä¸­æ‰€æœ‰ç±»å‹çš„å…¬å…±é«˜çº§æ¥å£,æ³¨æ„è¿™ä¸ªç±»å‹å¹¶ä¸æ˜¯æˆ‘ä»¬ä¼ ç»Ÿä¸Šå¸¸è¯´çš„intã€Stringã€Listã€Mapç­‰æ•°æ®ç±»å‹è€Œæ˜¯ä»Javaè¯­è¨€è§’åº¦æ¥è¯´ï¼Œå¯¹åŸºæœ¬ç±»å‹ã€å¼•ç”¨ç±»å‹å‘ä¸Šçš„æŠ½è±¡ Typeä½“ç³»ä¸­ç±»å‹çš„åŒ…æ‹¬ï¼š åŸå§‹ç±»å‹\\åŸºæœ¬ç±»å‹(Class) : å¸¸æ‰€æŒ‡çš„ç±»ï¼Œè¿˜åŒ…æ‹¬æšä¸¾ã€æ•°ç»„ã€æ³¨è§£ç­‰ å‚æ•°åŒ–ç±»å‹(ParameterizedType) : æŒ‡æ³›å‹,å¦‚æ³›å‹Listã€Mapæˆ–æ³›å‹ç±» æ•°ç»„ç±»å‹(GenericArrayType) : æŒ‡å¸¦æœ‰æ³›å‹çš„æ•°ç»„ï¼Œå³T[] ç±»å‹å˜é‡(TypeVariable) : ç±»å‹å˜é‡ï¼Œå³æ³›å‹ä¸­çš„å˜é‡ï¼›ä¾‹å¦‚ï¼šTã€Kã€Vç­‰å˜é‡ï¼Œå¯ä»¥è¡¨ç¤ºä»»ä½•ç±» æ³›å‹è¡¨è¾¾å¼(WildcardType) : è¿™ä¸ªtypeç±»å‹æ˜¯è§£å†³æ³›å‹? extend Numberã€? super Integerè¿™æ ·çš„è¡¨è¾¾å¼,ç›¸å…³ç±»å‹çš„ç‰¹æ®ŠTypeå­ç±»(è¿™ä¸ªç±»å’ŒTypeVariableå¯¹åº”,TypeVariableç›¸å½“äºå…·ä½“çš„ç±»å‹è€ŒWildcardTypeç›¸å½“äºçœŸå®çš„ç±»å‹) è¿™é‡Œå…·ä½“çš„ä»‹ç»ä¸€ä¸‹ç›¸å…³çš„å†…å®¹ 1. ParameterizedTypeParameterizedTypeè¡¨ç¤ºå‚æ•°åŒ–ç±»å‹ï¼Œä¹Ÿå°±æ˜¯æ³›å‹ï¼Œä¾‹å¦‚Listã€Setç­‰, åœ¨ParameterizedTypeæ¥å£ä¸­ï¼Œæœ‰3ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯getActualTypeArgumen ts()ã€ getRawType()ã€ getOwnerType(); getActualTypeArguments() è·å–æ³›å‹ä¸­çš„å®é™…ç±»å‹ï¼Œå¯èƒ½ä¼šå­˜åœ¨å¤šä¸ªæ³›å‹ï¼Œä¾‹å¦‚Map<K,V>,æ‰€ä»¥ä¼šè¿”å›Type[]æ•°ç»„ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ— è®º<>ä¸­æœ‰å‡ å±‚åµŒå¥—(List<Map<String,Integer>)ï¼ŒgetActualTypeArguments()æ–¹æ³•æ°¸è¿œéƒ½æ˜¯è„±å»æœ€å¤–å±‚çš„<>(ä¹Ÿå°±æ˜¯List<>)ï¼Œå°†å£å·å†…çš„å†…å®¹ï¼ˆMap<String,Integer>ï¼‰è¿”å›ï¼›æˆ‘ä»¬ç»å¸¸é‡åˆ°çš„Listï¼Œé€šè¿‡getActualTypeArguments()æ–¹æ³•ï¼Œå¾—åˆ°çš„è¿”å›å€¼æ˜¯TypeVariableImplå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯TypeVariableç±»å‹(åé¢ä»‹ç»); getRawType() è·å–å£°æ˜æ³›å‹çš„ç±»æˆ–è€…æ¥å£ï¼Œä¹Ÿå°±æ˜¯æ³›å‹ä¸­<>å‰é¢çš„é‚£ä¸ªå€¼ï¼› getOwnerType() é€šè¿‡æ–¹æ³•çš„åç§°ï¼Œæˆ‘ä»¬å¤§æ¦‚äº†è§£åˆ°ï¼Œæ­¤æ–¹æ³•æ˜¯è·å–æ³›å‹çš„æ‹¥æœ‰è€…ï¼Œé‚£ä¹ˆæ‹¥æœ‰è€…æ˜¯ä¸ªä»€ä¹ˆæ„æ€ï¼ŸReturns a {@code Type} object representing the type that this type * is a member of. For example, if this type is {@code O.I}, * return a representation of {@code O}. ï¼ˆæ‘˜è‡ªJDKæ³¨é‡Šï¼‰é€šè¿‡æ³¨è§£ï¼Œæˆ‘ä»¬å¾—çŸ¥ï¼Œâ€œæ‹¥æœ‰è€…â€è¡¨ç¤ºçš„å«ä¹‰â€“å†…éƒ¨ç±»çš„â€œçˆ¶ç±»â€ï¼Œé€šè¿‡getOwnerType()æ–¹æ³•å¯ä»¥è·å–åˆ°å†…éƒ¨ç±»çš„â€œæ‹¥æœ‰è€…â€ï¼›ä¾‹å¦‚ï¼š Map å°±æ˜¯ Map.Entry<String,String>çš„æ‹¥æœ‰è€…ï¼› 2. GenericArrayTypeæ³›å‹æ•°ç»„ç±»å‹ï¼Œä¾‹å¦‚List[] ã€T[]ç­‰ï¼› åœ¨GenericArrayTypeæ¥å£ä¸­ï¼Œä»…æœ‰1ä¸ªæ–¹æ³•ï¼Œå°±æ˜¯getGenericComponentType()ï¼› getGenericComponentType() è¿”å›æ³›å‹æ•°ç»„ä¸­å…ƒç´ çš„Typeç±»å‹ï¼Œå³List[] ä¸­çš„ Listï¼ˆParameterizedTypeImplï¼‰ã€T[] ä¸­çš„Tï¼ˆTypeVariableImplï¼‰ï¼› å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ— è®ºæ˜¯å‡ ç»´æ•°ç»„ï¼ŒgetGenericComponentType()æ–¹æ³•éƒ½åªä¼šè„±å»æœ€å³è¾¹çš„[]ï¼Œè¿”å›å‰©ä¸‹çš„å€¼ 3. TypeVariableæ³›å‹çš„ç±»å‹å˜é‡ï¼ŒæŒ‡çš„æ˜¯Listã€Map<K,V>ä¸­çš„Tï¼ŒKï¼ŒVç­‰å€¼ï¼Œå®é™…çš„Javaç±»å‹æ˜¯TypeVariableImplï¼ˆTypeVariableçš„å­ç±»ï¼‰ï¼›æ­¤å¤–ï¼Œè¿˜å¯ä»¥å¯¹ç±»å‹å˜é‡åŠ ä¸Šextendé™å®šï¼Œè¿™æ ·ä¼šæœ‰ç±»å‹å˜é‡å¯¹åº”çš„ä¸Šé™ åœ¨TypeVariableæ¥å£ä¸­ï¼Œæœ‰3ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ä¸ºgetBounds()ã€getGenericDeclaration()ã€getName() getBounds() è·å¾—è¯¥ç±»å‹å˜é‡çš„ä¸Šé™ï¼Œä¹Ÿå°±æ˜¯æ³›å‹ä¸­extendå³è¾¹çš„å€¼ï¼›ä¾‹å¦‚ List ï¼ŒNumberå°±æ˜¯ç±»å‹å˜é‡Tçš„ä¸Šé™ï¼›å¦‚æœæˆ‘ä»¬åªæ˜¯ç®€å•çš„å£°æ˜äº†Listï¼ˆæ— æ˜¾å¼å®šä¹‰extendsï¼‰ï¼Œé‚£ä¹ˆé»˜è®¤ä¸ºObjectï¼› æ— æ˜¾å¼å®šä¹‰extendsï¼š å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç±»å‹å˜é‡çš„ä¸Šé™å¯ä»¥ä¸ºå¤šä¸ªï¼Œå¿…é¡»ä½¿ç”¨&ç¬¦å·ç›¸è¿æ¥ï¼Œä¾‹å¦‚ List<T extends Number & Serializable>ï¼›å…¶ä¸­ï¼Œ& åå¿…é¡»ä¸ºæ¥å£ï¼› getGenericDeclaration() è·å–å£°æ˜è¯¥ç±»å‹å˜é‡å®ä½“ï¼Œä¹Ÿå°±æ˜¯TypeVariableTestä¸­çš„TypeVariableTest getName() è·å–ç±»å‹å˜é‡åœ¨æºç ä¸­å®šä¹‰çš„åç§° è¯´åˆ°TypeVariableç±»ï¼Œå°±ä¸å¾—ä¸æåŠJava-Typeä½“ç³»ä¸­å¦ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„æ¥å£â€”GenericDeclarationï¼›å«ä¹‰ä¸ºï¼šå£°æ˜ç±»å‹å˜é‡çš„æ‰€æœ‰å®ä½“çš„å…¬å…±æ¥å£ï¼›ä¹Ÿå°±æ˜¯è¯´è¯¥æ¥å£å®šä¹‰äº†å“ªäº›åœ°æ–¹å¯ä»¥å®šä¹‰ç±»å‹å˜é‡ï¼ˆæ³›å‹ï¼‰ï¼› é€šè¿‡æŸ¥çœ‹æºç å‘ç°ï¼ŒGenericDeclarationä¸‹æœ‰ä¸‰ä¸ªå­ç±»ï¼Œåˆ†åˆ«ä¸ºClassã€Methodã€Constructorï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å®šä¹‰æ³›å‹åªèƒ½åœ¨ä¸€ä¸ªç±»ä¸­è¿™3ä¸ªåœ°æ–¹è‡ªå®šä¹‰æ³›å‹ï¼› æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¸ç¦è¦é—®ï¼Œæˆ‘ä»¬ä¸æ˜¯ç»å¸¸åœ¨ç±»ä¸­çš„å±æ€§å£°æ˜æ³›å‹å—ï¼Œæ€ä¹ˆFieldæ²¡æœ‰å®ç° GenericDeclarationæ¥å£å‘¢ï¼Ÿ å…¶å®ï¼Œæˆ‘ä»¬åœ¨Fieldä¸­å¹¶æ²¡æœ‰å£°æ˜æ³›å‹ï¼Œè€Œæ˜¯åœ¨ä½¿ç”¨æ³›å‹è€Œå·² æ­£å› ä¸ºæ˜¯ä½¿ç”¨æ³›å‹ï¼Œæ‰€ä»¥Fieldå¹¶æ²¡æœ‰å®ç°GenericDeclarationæ¥å£ 4. WildcardTypeï¼Ÿâ€”é€šé…ç¬¦è¡¨è¾¾å¼ï¼Œè¡¨ç¤ºé€šé…ç¬¦æ³›å‹ï¼Œä½†æ˜¯WildcardTypeå¹¶ä¸å±äºJava-Typeä¸­çš„ä¸€é’Ÿï¼›ä¾‹å¦‚ï¼šList<? extends Number> å’Œ List<? super Integer> åœ¨WildcardTypeæ¥å£ä¸­ï¼Œæœ‰2ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ä¸ºgetUpperBounds()ã€getLowerBounds(); getUpperBounds() è·å–æ³›å‹å˜é‡çš„ä¸Šè¾¹ç•Œï¼ˆextendsï¼‰ getLowerBounds è·å–æ³›å‹å˜é‡çš„ä¸‹è¾¹ç•Œï¼ˆsuperï¼‰","date":"2024-12-31","categories":["java"],"tags":["javaèŒƒå‹åå°„ç±»å‹ç³»ç»Ÿ"]},{"title":"java-æ³¨è§£åå°„åŠ¨æ€ä»£ç†(3)-åŠ¨æ€ä»£ç†","url":"/2024/12/31/java-æ³¨è§£åå°„åŠ¨æ€ä»£ç†-3--åŠ¨æ€ä»£ç†/","content":"ä»£ç†æ¨¡å¼æ˜¯è½¯ä»¶å·¥ç¨‹ä¸€ç§å¸¸è§çš„è®¾è®¡æ¨¡å¼,ä¹Ÿæ˜¯springæ¡†æ¶å®ç°aopçš„æ ¸å¿ƒæ–¹æ³•,è¿™é‡Œæ–¹ä¾¿ç«‹å³é¦–å…ˆè®°å½•ä¸€ä¸‹é™æ€ä»£ç†æ¨¡å¼ é™æ€ä»£ç†æ¨¡å¼é¦–å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£å’Œä¸€ä¸ªæ¥å£å®ç°ç±» æˆ‘ä»¬å°†é€šè¿‡é™æ€ä»£ç†å¯¹ UserServiceImpl è¿›è¡ŒåŠŸèƒ½å¢å¼ºï¼Œåœ¨è°ƒç”¨ select å’Œ update ä¹‹å‰è®°å½•ä¸€äº›æ—¥å¿—ã€‚å†™ä¸€ä¸ªä»£ç†ç±» UserServiceProxyï¼Œä»£ç†ç±»éœ€è¦å®ç° UserService å®¢æˆ·ç«¯æµ‹è¯• è¾“å‡º é€šè¿‡é™æ€ä»£ç†ï¼Œæˆ‘ä»¬è¾¾åˆ°äº†åŠŸèƒ½å¢å¼ºçš„ç›®çš„ï¼Œè€Œä¸”æ²¡æœ‰ä¾µå…¥åŸä»£ç ï¼Œè¿™æ˜¯é™æ€ä»£ç†çš„ä¸€ä¸ªä¼˜ç‚¹ã€‚ é™æ€ä»£ç†çš„ç¼ºç‚¹ å½“éœ€è¦ä»£ç†å¤šä¸ªç±»çš„æ—¶å€™ï¼Œç”±äºä»£ç†å¯¹è±¡è¦å®ç°ä¸ç›®æ ‡å¯¹è±¡ä¸€è‡´çš„æ¥å£ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š åªç»´æŠ¤ä¸€ä¸ªä»£ç†ç±»ï¼Œç”±è¿™ä¸ªä»£ç†ç±»å®ç°å¤šä¸ªæ¥å£ï¼Œä½†æ˜¯è¿™æ ·å°±å¯¼è‡´ä»£ç†ç±»è¿‡äºåºå¤§ æ–°å»ºå¤šä¸ªä»£ç†ç±»ï¼Œæ¯ä¸ªç›®æ ‡å¯¹è±¡å¯¹åº”ä¸€ä¸ªä»£ç†ç±»ï¼Œä½†æ˜¯è¿™æ ·ä¼šäº§ç”Ÿè¿‡å¤šçš„ä»£ç†ç±» å½“æ¥å£éœ€è¦å¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹æ–¹æ³•çš„æ—¶å€™ï¼Œç›®æ ‡å¯¹è±¡ä¸ä»£ç†ç±»éƒ½è¦åŒæ—¶ä¿®æ”¹ï¼Œä¸æ˜“ç»´æŠ¤ã€‚ javaæä¾›çš„jdkä»£ç†java ä½œä¸ºé¢å‘å¯¹è±¡çš„åšæŒºå®ç°è€…,å¿…ç„¶æ”¯æŒåŠ¨æ€ä»£ç†,è¿™é‡Œä»‹ç»ä¸€ä¸‹javaåŸºäºæ¥å£è®¾è®¡çš„åŠ¨æ€ä»£ç†æ¨¡å¼ javaåŠ¨æ€ä»£ç†çš„å®ç°è€… InvocationHandler æ¥å£ æ¯ä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»éƒ½å¿…é¡»è¦å®ç°InvocationHandlerè¿™ä¸ªæ¥å£ï¼Œå¹¶ä¸”æ¯ä¸ªä»£ç†ç±»çš„å®ä¾‹éƒ½å…³è”åˆ°äº†ä¸€ä¸ªhandlerï¼Œå½“æˆ‘ä»¬é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨ä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œè¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨å°±ä¼šè¢«è½¬å‘ä¸ºç”±InvocationHandlerè¿™ä¸ªæ¥å£çš„ invoke æ–¹æ³•æ¥è¿›è¡Œè°ƒç”¨ã€‚ è¿™ä¸ªæ–¹æ³•æ‹¥æœ‰ä¸‰ä¸ªå‚æ•°åˆ†åˆ«è¡¨ç¤º proxy:æŒ‡ä»£æˆ‘ä»¬æ‰€ä»£ç†çš„é‚£ä¸ªçœŸå®å¯¹è±¡ method:æŒ‡ä»£çš„æ˜¯æˆ‘ä»¬æ‰€è¦è°ƒç”¨çœŸå®å¯¹è±¡çš„æŸä¸ªæ–¹æ³•çš„Methodå¯¹è±¡ args:æŒ‡ä»£çš„æ˜¯è°ƒç”¨çœŸå®å¯¹è±¡æŸä¸ªæ–¹æ³•æ—¶æ¥å—çš„å‚æ•° åˆ›å»ºä»£ç†çš„ç±»Proxy ä¹‹å‰è¯´äº†é€šè¿‡å®ç°Invocationhandleæ¥å£å¯ä»¥åˆ›å»ºä»£ç†,java è¿˜æä¾›äº†ä¸€ä¸ªç‰¹æ®Šçš„ç±»æ¥æ–¹ä¾¿æˆ‘ä»¬åˆ›å»ºä»£ç†å¯¹è±¡å®ä¾‹ proxyç±»æœ‰å¾ˆå¤šæ–¹æ³•,è¿™é‡Œæˆ‘ä»¬åªè§‚å¯Ÿæœ€å¸¸ç”¨çš„æ–¹æ³• è¿™ä¸ªæ–¹æ³•æœ‰ä¸‰ä¸ªå‚æ•°,è¿™é‡Œåˆ—ä¸¾ä¸€ä¸‹è¿™äº›æ–¹æ³•çš„ä½œç”¨ loader:ä¸€ä¸ªClassLoaderå¯¹è±¡ï¼Œå®šä¹‰äº†ç”±å“ªä¸ªClassLoaderå¯¹è±¡æ¥å¯¹ç”Ÿæˆçš„ä»£ç†å¯¹è±¡è¿›è¡ŒåŠ è½½ interfaces:ä¸€ä¸ªInterfaceå¯¹è±¡çš„æ•°ç»„ï¼Œè¡¨ç¤ºçš„æ˜¯æˆ‘å°†è¦ç»™æˆ‘éœ€è¦ä»£ç†çš„å¯¹è±¡æä¾›ä¸€ç»„ä»€ä¹ˆæ¥å£ï¼Œå¦‚æœæˆ‘æä¾›äº†ä¸€ç»„æ¥å£ç»™å®ƒï¼Œé‚£ä¹ˆè¿™ä¸ªä»£ç†å¯¹è±¡å°±å®£ç§°å®ç°äº†è¯¥æ¥å£(å¤šæ€)ï¼Œè¿™æ ·æˆ‘å°±èƒ½è°ƒç”¨è¿™ç»„æ¥å£ä¸­çš„æ–¹æ³•äº† h:ä¸€ä¸ªInvocationHandlerå¯¹è±¡ï¼Œè¡¨ç¤ºçš„æ˜¯å½“æˆ‘è¿™ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡åœ¨è°ƒç”¨æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šå…³è”åˆ°å“ªä¸€ä¸ªInvocationHandlerå¯¹è±¡ä¸Š è¿™é‡Œåˆ—ä¸€ä¸ªåˆ—å­ æ¥å£å’Œå®ç°ç±» InvocationHandleæ¥å£å®ç°ç±» è°ƒç”¨æ–¹æ³• è¾“å‡ºç»“æœ å¼•ç”³: javaæ˜¯åŠ¨æ€ç”Ÿæˆä»£ç†,è°ƒç”¨çš„æ˜¯çœŸå®çš„ç±»çš„æ–¹æ³• ä¸Šé¢Mainæ–¹æ³•ä¸­é€šè¿‡åŠ¨æ€ä»£ç†ç”Ÿæˆçš„å¯¹è±¡,å…¶å®å¹¶ä¸æ˜¯TestInterfaceå¯¹è±¡,è€Œæ˜¯$Proxy0..2 è¿™æ ·çš„å¯¹è±¡,è¿™ä¸ªæ˜¯javaä¸€ä¸ªç‰¹æ®Šçš„ä»£ç†å¯¹è±¡,å¯ä»¥å¼ºåˆ¶è½¬åŒ–æˆProxyçš„newProxyInstanceæ–¹æ³•ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥çš„æ‰€æœ‰ç±»å‹ å½“è¿™ä¸ªæ–¹æ³•è°ƒç”¨å¯¹åº”çš„æ–¹æ³•æ—¶,å°†ä¼šåŠ¨æ€çš„æ¡¥æ¥ç»™å®ç°Invocationhandleæ¥å£çš„ä»£ç†ç±»çš„invokeæ–¹æ³•,å…¶å®methodè§£é‡Šè¿™ä¸ªæ¥å£è¿™ä¸ªæ–¹æ³•çš„Methodåå°„","date":"2024-12-31","categories":["java"],"tags":["javaèŒƒå‹åå°„ç±»å‹ç³»ç»Ÿ"]},{"title":"junit4-ä½¿ç”¨æ•´ç†(1)","url":"/2024/12/31/junit4-ä½¿ç”¨æ•´ç†-1-/","content":"æœ€ç”¨åœ¨ä¼ä¸šä¸­è¿›è¡Œå®ä¹ ä½¿ç”¨äº†junit4è¿›è¡Œå•å…ƒæµ‹è¯•è¿™é‡Œè¿›è¡Œä¸€ä¸‹ç›¸å…³çš„çŸ¥è¯†ç‚¹çš„æ€»ç»“ JUnitæ˜¯ä»€ä¹ˆJUnitæ˜¯ç”¨äºç¼–å†™å’Œè¿è¡Œå¯é‡å¤çš„è‡ªåŠ¨åŒ–æµ‹è¯•çš„å¼€æºæµ‹è¯•æ¡†æ¶ï¼Œ è¿™æ ·å¯ä»¥ä¿è¯æˆ‘ä»¬çš„ä»£ç æŒ‰é¢„æœŸå·¥ä½œã€‚JUnitå¯å¹¿æ³›ç”¨äºå·¥ä¸šå’Œä½œä¸ºæ”¯æ¶(ä»å‘½ä»¤è¡Œ)æˆ–IDE(å¦‚Eclipse)å†…å•ç‹¬çš„Javaç¨‹åºã€‚ JUnitçš„æä¾› æ–­è¨€æµ‹è¯•é¢„æœŸç»“æœã€‚ æµ‹è¯•åŠŸèƒ½å…±äº«é€šç”¨çš„æµ‹è¯•æ•°æ®ã€‚ æµ‹è¯•å¥—ä»¶è½»æ¾åœ°ç»„ç»‡å’Œè¿è¡Œæµ‹è¯•ã€‚ å›¾å½¢å’Œæ–‡æœ¬æµ‹è¯•è¿è¡Œã€‚ JUnitç”¨äºæµ‹è¯• æ•´ä¸ªå¯¹è±¡ å¯¹è±¡çš„ä¸€éƒ¨åˆ† â€“ äº¤äº’çš„æ–¹æ³•æˆ–ä¸€äº›æ–¹æ³• å‡ ä¸ªå¯¹è±¡ä¹‹é—´çš„äº’åŠ¨(äº¤äº’) JUnitçš„ç‰¹ç‚¹ JUnitæ˜¯ç”¨äºç¼–å†™å’Œè¿è¡Œæµ‹è¯•çš„å¼€æºæ¡†æ¶ã€‚ æä¾›äº†æ³¨é‡Šï¼Œä»¥ç¡®å®šæµ‹è¯•æ–¹æ³•ã€‚ æä¾›æ–­è¨€æµ‹è¯•é¢„æœŸç»“æœã€‚ æä¾›äº†æµ‹è¯•è¿è¡Œçš„è¿è¡Œæµ‹è¯•ã€‚ JUnitæµ‹è¯•è®©æ‚¨å¯ä»¥æ›´å¿«åœ°ç¼–å†™ä»£ç ï¼Œæé«˜è´¨é‡ JUnitæ˜¯ä¼˜é›…ç®€æ´ã€‚å®ƒæ˜¯ä¸é‚£ä¹ˆå¤æ‚ä»¥åŠä¸éœ€è¦èŠ±è´¹å¤ªå¤šçš„æ—¶é—´ã€‚ JUnitæµ‹è¯•å¯ä»¥è‡ªåŠ¨è¿è¡Œï¼Œæ£€æŸ¥è‡ªå·±çš„ç»“æœï¼Œå¹¶æä¾›å³æ—¶åé¦ˆã€‚æ²¡æœ‰å¿…è¦é€šè¿‡æµ‹è¯•ç»“æœæŠ¥å‘Šæ¥æ‰‹åŠ¨æ¢³ç†ã€‚ JUnitæµ‹è¯•å¯ä»¥ç»„ç»‡æˆæµ‹è¯•å¥—ä»¶åŒ…å«æµ‹è¯•æ¡ˆä¾‹ï¼Œç”šè‡³å…¶ä»–æµ‹è¯•å¥—ä»¶ã€‚ Junitæ˜¾ç¤ºæµ‹è¯•è¿›åº¦çš„ï¼Œå¦‚æœæµ‹è¯•æ˜¯æ²¡æœ‰é—®é¢˜æ¡å½¢æ˜¯ç»¿è‰²çš„ï¼Œæµ‹è¯•å¤±è´¥åˆ™ä¼šå˜æˆçº¢è‰²ã€‚ junit4ç®€å•ä¾‹å­ æ–°å»ºä¸€ä¸ªæµ‹è¯•ç±» åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç±» è¿‡ç¨‹ï¼šæŒ‡å®šä¸€ä¸ªæµ‹è¯•ç”¨çš„å·¥å…·åŒ…å³é”®>>new>>other>>æœç´¢junit>>é€‰æ‹© Junit Test Case åˆ›å»ºåçš„ç±» è¿›è¡Œæµ‹è¯• å³é”®>>run as Test","date":"2024-12-31","categories":["java"],"tags":["junit4"]},{"title":"junit4-ä½¿ç”¨æ•´ç†(2)","url":"/2024/12/31/junit4-ä½¿ç”¨æ•´ç†-2-/","content":"JUnit4ä½¿ç”¨çš„åŸºæœ¬æ³¨è§£JUnit4åŸºæœ¬æ³¨é‡Šï¼Œä¸‹è¡¨åˆ—å‡ºäº†è¿™äº›æ³¨é‡Šçš„æ¦‚æ‹¬ï¼š æ³¨è§£ æè¿° @Test public void method() æµ‹è¯•æ³¨é‡ŠæŒ‡ç¤ºè¯¥å…¬å…±æ— æ•ˆæ–¹æ³•å®ƒæ‰€é™„ç€å¯ä»¥ä½œä¸ºä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ã€‚å¯ä»¥æŒ‡å®šä¸€ä¸ªå¼‚å¸¸è¿™ä¸ªå·²æˆå°†ä¼šæ•è·æµ‹è¯•ä¼šæˆåŠŸï¼Œè¿˜å¯ä»¥æŒ‡å®šè¶…æ—¶æ—¶é—´è¶…è¿‡æŒ‡å®šçš„è¿è¡Œæ—¶é—´ä»·å°†ä¼šè‡ªåŠ¨åˆ¤æ–­ä¸ºè¶…æ—¶ @Before public void method() æ³¨é‡Šè¡¨ç¤ºï¼Œè¯¥æ–¹æ³•å¿…é¡»åœ¨ç±»ä¸­çš„æ¯ä¸ªæµ‹è¯•ä¹‹å‰æ‰§è¡Œï¼Œä»¥ä¾¿æ‰§è¡Œæµ‹è¯•æŸäº›å¿…è¦çš„å…ˆå†³æ¡ä»¶ @BeforeClass public static void method() BeforeClassæ³¨é‡ŠæŒ‡å‡ºè¿™æ˜¯é™„ç€åœ¨é™æ€æ–¹æ³•å¿…é¡»æ‰§è¡Œä¸€æ¬¡å¹¶åœ¨ç±»çš„æ‰€æœ‰æµ‹è¯•ä¹‹å‰ã€‚å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ä¸€èˆ¬æ˜¯æµ‹è¯•è®¡ç®—å…±äº«é…ç½®æ–¹æ³•(å¦‚è¿æ¥åˆ°æ•°æ®åº“) @After public void method() æ³¨é‡ŠæŒ‡ç¤ºï¼Œè¯¥æ–¹æ³•åœ¨æ‰§è¡Œæ¯é¡¹æµ‹è¯•åæ‰§è¡Œ(å¦‚æ‰§è¡Œæ¯ä¸€ä¸ªæµ‹è¯•åé‡ç½®æŸäº›å˜é‡ï¼Œåˆ é™¤ä¸´æ—¶å˜é‡ç­‰) @AfterClass public static void method() å½“éœ€è¦æ‰§è¡Œæ‰€æœ‰çš„æµ‹è¯•åœ¨JUnitæµ‹è¯•ç”¨ä¾‹ç±»åæ‰§è¡Œï¼ŒAfterClassæ³¨è§£å¯ä»¥ä½¿ç”¨ä»¥æ¸…ç†å»ºç«‹æ–¹æ³•ï¼Œ(ä»æ•°æ®åº“å¦‚æ–­å¼€è¿æ¥)ã€‚æ³¨æ„ï¼šé™„æœ‰æ­¤æ‰¹æ³¨(ç±»ä¼¼äºBeforeClass)çš„æ–¹æ³•å¿…é¡»å®šä¹‰ä¸ºé™æ€ @Ignore public static void method() å½“æƒ³æš‚æ—¶ç¦ç”¨ç‰¹å®šçš„æµ‹è¯•æ‰§è¡Œå¯ä»¥ä½¿ç”¨å¿½ç•¥æ³¨é‡Šã€‚æ¯ä¸ªè¢«æ³¨è§£ä¸º@Ignoreçš„æ–¹æ³•å°†ä¸è¢«æ‰§è¡Œ ä¸€ä¸ªä¾‹å­ æ§åˆ¶å°è¾“å‡ºçš„ç»“ç»“æœ æ€»ç»“ï¼šå¯¹äºjavaçš„ç±»æ¥è¯´æ‰€æœ‰BeforeClass ä¼šåœ¨æ‰€æœ‰çš„æµ‹è¯•è°ƒç”¨å‰è¿›è¡Œè°ƒç”¨ AfterClass å°†ä¼šåœ¨æ‰€æœ‰çš„æµ‹è¯•ä½¿ç”¨å®Œæˆååœ¨è¿›è¡Œè°ƒç”¨ Before After å°†ä¼šåœ¨æ‰€æœ‰çš„æµ‹è¯•å®Œæˆçš„æ—¶å€™è¿›è¡Œè°ƒç”¨ junitæ–­è¨€è¿™äº›æ–¹æ³•éƒ½å—åˆ° Assert ç±»æ‰©å±•äº†java.lang.Objectç±»å¹¶ä¸ºå®ƒä»¬æä¾›ç¼–å†™æµ‹è¯•ï¼Œä»¥ä¾¿æ£€æµ‹æ•…éšœã€‚ä¸‹è¡¨ä¸­æœ‰ä¸€ç§æœ€å¸¸ç”¨çš„æ–­è¨€æ–¹æ³•çš„æ›´è¯¦ç»†çš„è§£é‡Š æ–­è¨€ æè¿° void assertEquals([String message], expected value, actual value) æ–­è¨€ä¸¤ä¸ªå€¼ç›¸ç­‰ã€‚å€¼å¯èƒ½æ˜¯ç±»å‹æœ‰ int, short, long, byte, char or java.lang.Object. ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯é€‰çš„å­—ç¬¦ä¸²æ¶ˆæ¯ void assertTrue([String message], boolean condition) æ–­è¨€ä¸€ä¸ªæ¡ä»¶ä¸ºçœŸ void assertFalse([String message],boolean condition) æ–­è¨€ä¸€ä¸ªæ¡ä»¶ä¸ºå‡ void assertNotNull([String message], java.lang.Object object) æ–­è¨€ä¸€ä¸ªå¯¹è±¡ä¸ä¸ºç©º(null) void assertNull([String message], java.lang.Object object) æ–­è¨€ä¸€ä¸ªå¯¹è±¡ä¸ºç©º(null) void assertSame([String message], java.lang.Object expected, java.lang.Object actual) æ–­è¨€ï¼Œä¸¤ä¸ªå¯¹è±¡å¼•ç”¨ç›¸åŒçš„å¯¹è±¡ void assertNotSame([String message], java.lang.Object unexpected, java.lang.Object actual) æ–­è¨€ï¼Œä¸¤ä¸ªå¯¹è±¡ä¸æ˜¯å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ void assertArrayEquals([String message], expectedArray, resultArray) æ–­è¨€é¢„æœŸæ•°ç»„å’Œç»“æœæ•°ç»„ç›¸ç­‰ã€‚æ•°ç»„çš„ç±»å‹å¯èƒ½æ˜¯ int, long, short, char, byte or java.lang.Object. åœ¨ä»¥ä¸Šç±»ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™äº›æ–­è¨€æ–¹æ³•æ˜¯å¯ä»¥å·¥ä½œçš„ã€‚ assertEquals() å¦‚æœæ¯”è¾ƒçš„ä¸¤ä¸ªå¯¹è±¡æ˜¯ç›¸ç­‰çš„ï¼Œæ­¤æ–¹æ³•å°†æ­£å¸¸è¿”å›ï¼›å¦åˆ™å¤±è´¥æ˜¾ç¤ºåœ¨JUnitçš„çª—å£æµ‹è¯•å°†ä¸­æ­¢ã€‚ assertSame() å’Œ assertNotSame() æ–¹æ³•æµ‹è¯•ä¸¤ä¸ªå¯¹è±¡å¼•ç”¨æŒ‡å‘å®Œå…¨ç›¸åŒçš„å¯¹è±¡ã€‚ assertNull() å’Œ assertNotNull() æ–¹æ³•æµ‹è¯•ä¸€ä¸ªå˜é‡æ˜¯å¦ä¸ºç©ºæˆ–ä¸ä¸ºç©º(null)ã€‚ assertTrue() å’Œ assertFalse() æ–¹æ³•æµ‹è¯•ifæ¡ä»¶æˆ–å˜é‡æ˜¯trueè¿˜æ˜¯falseã€‚ assertArrayEquals() å°†æ¯”è¾ƒä¸¤ä¸ªæ•°ç»„ï¼Œå¦‚æœå®ƒä»¬ç›¸ç­‰ï¼Œåˆ™è¯¥æ–¹æ³•å°†ç»§ç»­è¿›è¡Œä¸ä¼šå‘å‡ºé”™è¯¯ã€‚å¦åˆ™å¤±è´¥å°†æ˜¾ç¤ºåœ¨JUnitçª—å£å’Œä¸­æ­¢æµ‹è¯•ã€‚ JUnit4å¥—ä»¶æµ‹è¯•æµ‹è¯•å¥—ä»¶æ˜¯ä¸€äº›æµ‹è¯•ä¸åŒç±»ç”¨ä¾‹ï¼Œå¯ä»¥ä½¿ç”¨@RunWithå’Œ@Suiteæ³¨è§£è¿è¡Œæ‰€æœ‰ä¸œè¥¿åœ¨ä¸€èµ·ã€‚å¦‚æœæœ‰å¾ˆå¤šæµ‹è¯•ç±»ï¼Œæƒ³è®©å®ƒä»¬éƒ½è¿è¡Œåœ¨åŒä¸€æ—¶é—´ï¼Œè€Œä¸æ˜¯å•ä¸€åœ°è¿è¡Œæ¯ä¸ªæµ‹è¯•ï¼Œè¿™æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ å½“ä¸€ä¸ªç±»è¢«æ³¨è§£ä¸º**@RunWith**ï¼Œ JUnit å°†è°ƒç”¨è¢«åœ¨å…¶ä¸­æ³¨è§£ï¼Œä»¥ä¾¿è¿è¡Œæµ‹è¯•ç±»ï¼Œè€Œä¸ä½¿ç”¨å†…ç½®çš„ JUnit è¿è¡Œæ–¹æ³•ã€‚ å¿«é€Ÿç”Ÿæˆï¼šåŒ…å³é”®>>new>>JUnit test Suite>>finish æŒ‡å®šå¥—ä»¶ç±» ä¸¤ä¸ªæµ‹è¯•ç±» è¾“å‡ºç»“æœ javaå‚æ•°åŒ–è‡ªåŠ¨æµ‹è¯•ä¸€ä¸ªæµ‹è¯•ç±»ä¹Ÿå¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªå‚æ•°åŒ–æµ‹è¯•ç±»è¦æ»¡è¶³ä¸‹åˆ—æ‰€æœ‰è¦æ±‚ï¼š è¯¥ç±»è¢«æ³¨è§£ä¸º @RunWith(Parameterized.class). å¦‚å‰ä¸€èŠ‚ä¸­æ‰€è¯´æ˜çš„, @RunWith æ³¨è§£è®©JUnitæ¥è°ƒç”¨å…¶ä¸­çš„æ³¨é‡Šæ¥è¿è¡Œæµ‹è¯•ç±»ï¼Œä»£æ›¿ä½¿ç”¨å†…ç½®çš„JUnitè¿è¡Œå™¨ï¼ŒParameterized æ˜¯ä¸€ä¸ªåœ¨JUnitå†…çš„è¿è¡Œå™¨å°†è¿è¡Œç›¸åŒçš„æµ‹è¯•ç”¨ä¾‹ç»„åœ¨ä¸åŒçš„è¾“å…¥ã€‚ è¿™ä¸ªç±»æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå­˜å‚¨æµ‹è¯•æ•°æ®ã€‚ è¿™ä¸ªç±»æœ‰ä¸€ä¸ªé™æ€æ–¹æ³•ç”Ÿæˆå¹¶è¿”å›æµ‹è¯•æ•°æ®ï¼Œå¹¶æ³¨æ˜@Parametersæ³¨è§£ã€‚ è¿™ä¸ªç±»æœ‰ä¸€ä¸ªæµ‹è¯•ï¼Œå®ƒéœ€è¦æ³¨è§£@Teståˆ°æ–¹æ³•ã€‚ Junitåº•å±‚é€šè¿‡å¤šæ¬¡ç”Ÿæˆæ–°çš„ç±»è¿›è¡Œå¤šæ¬¡æµ‹è¯• æµ‹è¯•ç»“æœ","date":"2024-12-31","categories":["java"],"tags":["junit4"]},{"title":"junit4-ä½¿ç”¨æ•´ç†(3)springæ•´åˆ","url":"/2024/12/31/junit4-ä½¿ç”¨æ•´ç†-3-springæ•´åˆ/","content":"è¿™é‡Œè®°å½•ä¸€ä¸‹spring å’Œ junit4è¿›è¡Œæ•´åˆä¾‹å­ ç°åœ¨æƒ…å†µä¸‹springæ”¯æŒçš„junitç‰ˆæœ¬ä¸æ˜¯å¾ˆé«˜ ä½¿ç”¨junit4.1.2è¿›è¡Œå¼€å‘ @RunWithï¼šç”¨äºæŒ‡å®šjunitè¿è¡Œç¯å¢ƒï¼Œæ˜¯junitæä¾›ç»™å…¶ä»–æ¡†æ¶æµ‹è¯•ç¯å¢ƒæ¥å£æ‰©å±•ï¼Œä¸ºäº†ä¾¿äºä½¿ç”¨springçš„ä¾èµ–æ³¨å…¥ï¼Œspringæä¾›äº†org.springframework.test.context.junit4.SpringJUnit4ClassRunnerä½œä¸ºJunitæµ‹è¯•ç¯å¢ƒ @ContextConfiguration({â€œclasspath:applicationContext.xmlâ€,â€classpath:spring&#x2F;buyer&#x2F;applicationContext-service.xmlâ€}) å¯¼å…¥é…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘çš„applicationContexté…ç½®æ–‡ä»¶æ˜¯æ ¹æ®æ¨¡å—æ¥åˆ†ç±»çš„ã€‚å¦‚æœæœ‰å¤šä¸ªæ¨¡å—å°±å¼•å…¥å¤šä¸ªâ€œapplicationContext-service.xmlâ€æ–‡ä»¶ã€‚å¦‚æœæ‰€æœ‰çš„éƒ½æ˜¯å†™åœ¨â€œapplicationContextã€‚xmlâ€ä¸­åˆ™è¿™æ ·å¯¼å…¥","date":"2024-12-31","categories":["java"],"tags":["junit4"]},{"title":"java-æ·±å…¥ç†è§£jvmè™šæ‹Ÿæœº-å†…å­˜åˆ†é…å’Œåƒåœ¾å›æ”¶ç­–ç•¥","url":"/2024/12/31/java-æ·±å…¥ç†è§£jvmè™šæ‹Ÿæœº-å†…å­˜åˆ†é…å’Œåƒåœ¾å›æ”¶ç­–ç•¥/","content":"å†…å­˜çš„åˆ†é…åŸåˆ™ å¯¹è±¡ä¼˜å…ˆåœ¨Edenåˆ†é… : å¤§å¤šæ•°æƒ…å†µä¸‹,å¯¹è±¡åœ¨æ–°ç”Ÿä»£EdenåŒºä¸­åˆ†é…ã€‚å½“EdenåŒºæ²¡æœ‰è¶³å¤Ÿç©ºé—´è¿›è¡Œåˆ†é…æ—¶,è™šæ‹Ÿæœºå°†å‘èµ·ä¸€æ¬¡Minor GCã€‚ å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£ : å¯¹è±¡åœ¨Edenå‡ºç”Ÿå¹¶ç»è¿‡ç¬¬ä¸€æ¬¡Minor GCåä»ç„¶å­˜æ´»,å¹¶ä¸”èƒ½è¢«Survivorå®¹çº³çš„è¯,å°†è¢«ç§»åŠ¨åˆ°Survivorç©ºé—´ä¸­,å¹¶ä¸”å¯¹è±¡å¹´é¾„è®¾ä¸º1ã€‚å¯¹è±¡åœ¨SurvivoråŒºä¸­æ¯â€œç†¬è¿‡â€ä¸€æ¬¡Minor GC,å¹´é¾„å°±å¢åŠ 1å²,å½“å®ƒçš„å¹´é¾„å¢åŠ åˆ°ä¸€å®šç¨‹åº¦(é»˜è®¤ä¸º15å²),å°±å°†ä¼šè¢«æ™‹å‡åˆ°è€å¹´ä»£ä¸­ã€‚å¯¹è±¡æ™‹å‡è€å¹´ä»£çš„å¹´é¾„é˜ˆå€¼,å¯ä»¥é€šè¿‡å‚æ•°**-XX:MaxTenuringThresholdè®¾ç½®** åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š : è™šæ‹Ÿæœºå¹¶ä¸æ˜¯æ°¸è¿œåœ°è¦æ±‚å¯¹è±¡çš„å¹´é¾„å¿…é¡»è¾¾åˆ°äº†MaxTenuringThresholdæ‰èƒ½æ™‹å‡è€å¹´ä»£,å¦‚æœåœ¨Survivorç©ºé—´ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äºSurvivorç©ºé—´çš„ä¸€åŠ,å¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å°±å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£,æ— é¡»ç­‰åˆ°MaxTenuringThresholdä¸­è¦æ±‚çš„å¹´é¾„ javaä¸¤ç§ä½ç½®çš„gc-æ–°ç”Ÿä»£GC(Minor GC):æŒ‡å‘ç”Ÿåœ¨æ–°ç”Ÿä»£çš„åƒåœ¾æ”¶é›†åŠ¨ä½œ,å› ä¸ºJavaå¯¹è±¡å¤§å¤šéƒ½å…·å¤‡æœç”Ÿå¤•ç­çš„ç‰¹æ€§,æ‰€ä»¥Minor GCéå¸¸é¢‘ç¹,ä¸€èˆ¬å›æ”¶é€Ÿåº¦ä¹Ÿæ¯”è¾ƒå¿«ã€‚ è€å¹´ä»£GC(Major GC&#x2F;Full GC):æŒ‡å‘ç”Ÿåœ¨è€å¹´ä»£çš„GC,å‡ºç°äº†Major GC,ç»å¸¸ä¼šä¼´éšè‡³å°‘ä¸€æ¬¡çš„Minor GC(ä½†éç»å¯¹çš„,åœ¨Parallel Scavengeæ”¶é›†å™¨çš„æ”¶é›†ç­–ç•¥é‡Œå°±æœ‰ç›´æ¥è¿›è¡ŒMajor GCçš„ç­–ç•¥é€‰æ‹©è¿‡ç¨‹)ã€‚Major GCçš„é€Ÿåº¦ä¸€èˆ¬ä¼šæ¯”Minor GCæ…¢10å€ä»¥ä¸Šã€‚ Minor GC å¤§å¤šæ•°æƒ…å†µä¸‹,å¯¹è±¡åœ¨æ–°ç”Ÿä»£EdenåŒºä¸­åˆ†é…ã€‚å½“EdenåŒºæ²¡æœ‰è¶³å¤Ÿç©ºé—´è¿›è¡Œåˆ†é…æ—¶,è™šæ‹Ÿæœºå°†å‘èµ·ä¸€æ¬¡Minor GCã€‚ æ³¨æ„è¿™æ¬¡çš„gcåªæ˜¯å°†å¯¹è±¡æ”¾å…¥ä¸€ä¸ªsurviveåŒºä¸­ï¼Œä½¿ç”¨æ ‡è®°æ•´ç†æ–¹æ³•ï¼Œä¸€ä¸ªsurviveåŒºç©ºé—´ä¸º0 è€Œå¦ä¸€ä¸ªç©ºé—´æ— ç¢ç‰‡ã€‚å½“survive æ²¡æœ‰ç©ºé—´çš„æ—¶å€™å°†ä¼šç›´æ¥çš„æ”¾å…¥è€å¹´ä»£ä¸­ Full gc åœ¨å‘ç”ŸMinor GCä¹‹å‰,è™šæ‹Ÿæœºä¼šå…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´,å¦‚æœè¿™ä¸ªæ¡ä»¶æˆç«‹,é‚£ä¹ˆMinor GCå¯ä»¥ç¡®ä¿æ˜¯å®‰å…¨çš„ã€‚å¦‚æœä¸æˆç«‹,åˆ™è™šæ‹Ÿæœºä¼šæŸ¥çœ‹HandlePromotionFailureè®¾ç½®å€¼æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥ã€‚å¦‚æœå…è®¸,é‚£ä¹ˆä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°,å¦‚æœå¤§äº,å°†å°è¯•ç€è¿›è¡Œä¸€æ¬¡Minor GC,å°½ç®¡è¿™æ¬¡Minor GCæ˜¯æœ‰é£é™©çš„;å¦‚æœå°äº,æˆ–è€…HandlePromotionFailureè®¾ç½®ä¸å…è®¸å†’é™©,é‚£è¿™æ—¶ä¹Ÿè¦æ”¹ä¸ºè¿›è¡Œä¸€æ¬¡Full GCã€‚","date":"2024-12-31","categories":["java"],"tags":["jvmè™šæ‹Ÿæœº"]},{"title":"java-æ·±å…¥ç†è§£jvmè™šæ‹Ÿæœº-å†…å­˜åˆ’åˆ†æ–¹æ³•","url":"/2024/12/31/java-æ·±å…¥ç†è§£jvmè™šæ‹Ÿæœº-å†…å­˜åˆ’åˆ†æ–¹æ³•/","content":"ä¸€.è¿è¡Œæ—¶çš„æ•°æ®åŒºåŸŸ ï¼ˆ1ï¼‰ç¨‹åºè®¡æ•°å™¨ç¨‹åºè®¡æ•°å™¨(Program Counter Register)æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´,å®ƒå¯ä»¥çœ‹ä½œæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨â€”â€“ç¼–è¯‘åŸç†ä¸­æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤çš„ä½ç½® Javaè™šæ‹Ÿæœºçš„å¤šçº¿ç¨‹æ˜¯é€šè¿‡çº¿ç¨‹è½®æµåˆ‡æ¢å¹¶åˆ†é…å¤„ç†å™¨æ‰§è¡Œæ—¶é—´çš„æ–¹å¼æ¥å®ç°çš„ï¼Œæ¯æ¡çº¿ç¨‹éƒ½éœ€è¦æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨,å„æ¡çº¿ç¨‹ä¹‹é—´è®¡æ•°å™¨äº’ä¸å½±å“,ç‹¬ç«‹å­˜å‚¨,æˆ‘ä»¬ç§°è¿™ç±»å†…å­˜åŒºåŸŸä¸ºâ€œçº¿ç¨‹ç§æœ‰â€çš„å†…å­˜ æ³¨æ„ï¼š å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªJavaæ–¹æ³•,è¿™ä¸ªè®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ å¦‚æœæ­£åœ¨æ‰§è¡Œçš„æ˜¯Nativeæ–¹æ³•,è¿™ä¸ªè®¡æ•°å™¨å€¼åˆ™ä¸ºç©º(Undefined) ï¼ˆ2ï¼‰Javaè™šæ‹Ÿæœºæ ˆJavaè™šæ‹Ÿæœºæ ˆ(Java Virtual Machine Stacks)ä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„,å®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒã€‚ è™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹:æ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§(Stack Frame )ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹,å°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚ å±€éƒ¨å˜é‡è¡¨å­˜æ”¾äº†ç¼–è¯‘æœŸå¯çŸ¥çš„å„ç§åŸºæœ¬æ•°æ®ç±»å‹ã€å¯¹è±¡å¼•ç”¨ï¼ˆreferenceå­—æ®µï¼‰å’Œäº†ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼Œæ–¹æ³•çš„å¼€å§‹ ä¸€ä¸ªé‡è¦çš„å¼‚å¸¸ stackOverflowError å½“å†…å­˜ä¸å¤Ÿçš„æ—¶å€™æŠ›å‡º OutofMenoryError ï¼ˆ3ï¼‰æœ¬åœ°æ–¹æ³•æ ˆåŒºå’Œè™šæ‹Ÿæœºæ ˆç›¸ä¼¼å€¼ä¸è¿‡ä½¿ç”¨çš„æ˜¯nativeçš„æ–¹æ³•æœåŠ¡ æ ˆåŒºå¤§å°ä½¿ç”¨ -Xssè¿›è¡Œé…ç½® å¼•ç”³ï¼šå‚æ•° -XXï¼šPermSize -XX ï¼šMaxPermSize â€” æŒ‡å®šéå †å†…å­˜çš„æœ€å¤§å®¹é‡ ï¼ˆ4ï¼‰javaå †Javaå †(Java Heap)æ˜¯Javaè™šæ‹Ÿæœºæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ã€‚Javaå †æ˜¯è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸ,åœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºï¼Œç”¨æ¥å­˜æ”¾å¯¹è±¡å®ä¾‹ æŒ‡å®šjavaå †å¤§å°çš„å‚æ•° -Xms -Xmx â€“æœ€å¤§å€¼å’Œæœ€å°å€¼ ï¼ˆ5ï¼‰æ–¹æ³•åŒºæ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œå­˜å‚¨å¸¸é‡é™æ€å¸¸é‡ï¼Œç¼–è¯‘åçš„å„ç§ä»£ç ç­‰æ•°æ® è¿è¡Œæ—¶å¸¸é‡æ± -æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ç”¨æ¥å‚¨å­˜javaçš„classç±»çš„å„ç§å…¶ä»–ä¿¡æ¯ ï¼ˆ6ï¼‰é¢å¤–éƒ¨åˆ† ç›´æ¥å†…å­˜ä½¿ç”¨â€™å½“javaä½¿ç”¨NIOçš„æ—¶å€™ï¼Œç›´æ¥ä½¿ç”¨å¤–éƒ¨å†…å­˜è€Œä¸æ˜¯ä½¿ç”¨ è™šæ‹Ÿæœºçš„è™šæ‹Ÿå†…å­˜","date":"2024-12-31","categories":["java"],"tags":["jvmè™šæ‹Ÿæœº"]},{"title":"java-æ·±å…¥ç†è§£jvmè™šæ‹Ÿæœº-åƒåœ¾å›æ”¶","url":"/2024/12/31/java-æ·±å…¥ç†è§£jvmè™šæ‹Ÿæœº-åƒåœ¾å›æ”¶/","content":"1.åƒåœ¾å›æ”¶ç®—æ³•æŠ€æœ¯ç±»å‹ï¼š å¼•ç”¨æŠ€æœ¯æ³• é—®é¢˜å­˜åœ¨å¾ªç¯å¼•ç”¨çš„é—®é¢˜ å¯è¾¾æ€§åˆ†æç®—æ³• é€šè¿‡å¼•ç”¨è¿›è¡Œéå†æœç´¢å½¢æˆä¸€å¼ å¼•ç”¨å…³ç³»å›¾ï¼Œå°†å›¾å¤–çš„å†…å­˜è¿›è¡Œå›æ”¶ 1.ç›¸å…³ç®—æ³•ï¼ˆ1ï¼‰æ ‡è®°æ¸…é™¤ç®—æ³• è€å¹´ä»£æœ‰åº”ç”¨ ï¼ˆ2ï¼‰å¤åˆ¶ç®—æ³• ä¸»è¦ç”¨åœ¨æ–°ç”Ÿä»£ï¼Œå‘ç”Ÿgcçš„æ—¶å€™å°†EdenåŒºçš„æ•°æ®è½¬ç§»åˆ°surveråŒº ï¼ˆ3ï¼‰æ ‡è®°æ•´ç†ç®—æ³• ä¸»è¦ç”¨åœ¨è€å¹´ä»£æ€æƒ³å°±æ˜¯æ ‡è®°+ç§»åŠ¨ ï¼ˆ4ï¼‰åˆ†ä»£æ”¶é›†ç®—æ³•é’ˆå¯¹ä¸åŒçš„åŒºåŸŸä½¿ç”¨åˆé€‚çš„åƒåœ¾å›æ”¶ç®—æ³• æ–°ç”Ÿä»£ â€“ å¤åˆ¶ç®—æ³• è€å¹´ä»£-æ ‡è®°æ¸…æ¥šæˆ–è€…æ ‡è®°æ•´ç† å½“å‰å•†ä¸šè™šæ‹Ÿæœºçš„åƒåœ¾æ”¶é›†éƒ½é‡‡ç”¨â€œåˆ†ä»£æ”¶é›†â€(Generational Collection)ç®—æ³•,è¿™ç§ç®—æ³•å¹¶æ²¡æœ‰ä»€ä¹ˆæ–°çš„æ€æƒ³,åªæ˜¯æ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ’åˆ†ä¸ºå‡ å—ã€‚ä¸€èˆ¬æ˜¯æŠŠJavaå †åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£,è¿™æ ·å°±å¯ä»¥æ ¹æ®å„ä¸ªå¹´ä»£çš„ç‰¹ç‚¹é‡‡ç”¨æœ€é€‚å½“çš„æ”¶é›†ç®—æ³•ã€‚åœ¨æ–°ç”Ÿä»£ä¸­,æ¯æ¬¡åƒåœ¾æ”¶é›†æ—¶éƒ½å‘ç°æœ‰å¤§æ‰¹å¯¹è±¡æ­»å»,åªæœ‰å°‘é‡å­˜æ´»,é‚£å°±é€‰ç”¨å¤åˆ¶ç®—æ³•,åªéœ€è¦ä»˜å‡ºå°‘é‡å­˜æ´»å¯¹è±¡çš„å¤åˆ¶æˆæœ¬å°±å¯ä»¥å®Œæˆæ”¶é›†ã€‚è€Œè€å¹´ä»£ä¸­å› ä¸ºå¯¹è±¡å­˜æ´»ç‡é«˜ã€æ²¡æœ‰é¢å¤–ç©ºé—´å¯¹å®ƒè¿›è¡Œåˆ†é…æ‹…ä¿,å°±å¿…é¡»ä½¿ç”¨â€œæ ‡è®°â€”æ¸…ç†â€æˆ–è€…â€œæ ‡è®°â€”æ•´ç†â€ç®—æ³•æ¥è¿›è¡Œå›æ”¶ã€‚ 2.javaçš„å¼•ç”¨ç±»å‹ å¼ºå¼•ç”¨å°±æ˜¯æŒ‡åœ¨ç¨‹åºä»£ç ä¹‹ä¸­æ™®éå­˜åœ¨çš„,ç±»ä¼¼â€œObject obj&#x3D;new Object()â€è¿™ç±»çš„å¼•ç”¨,åªè¦å¼ºå¼•ç”¨è¿˜å­˜åœ¨,åƒåœ¾æ”¶é›†å™¨æ°¸è¿œä¸ä¼šå›æ”¶æ‰è¢«å¼•ç”¨çš„å¯¹è±¡ã€‚ è½¯å¼•ç”¨æ˜¯ç”¨æ¥æè¿°ä¸€äº›è¿˜æœ‰ç”¨ä½†å¹¶éå¿…éœ€çš„å¯¹è±¡ã€‚å¯¹äºè½¯å¼•ç”¨å…³è”ç€çš„å¯¹è±¡,åœ¨ç³»ç»Ÿå°†è¦å‘ç”Ÿå†…å­˜æº¢å‡ºå¼‚å¸¸ä¹‹å‰,å°†ä¼šæŠŠè¿™äº›å¯¹è±¡åˆ—è¿›å›æ”¶èŒƒå›´ä¹‹ä¸­è¿›è¡Œç¬¬äºŒæ¬¡å›æ”¶ã€‚å¦‚æœè¿™æ¬¡å›æ”¶è¿˜æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜,æ‰ä¼šæŠ›å‡ºå†…å­˜æº¢å‡ºå¼‚å¸¸ã€‚åœ¨JDK 1.2ä¹‹å,æä¾›äº†SoftReferenceç±»æ¥å®ç°è½¯å¼•ç”¨ã€‚ å¼±å¼•ç”¨ä¹Ÿæ˜¯ç”¨æ¥æè¿°éå¿…éœ€å¯¹è±¡çš„,ä½†æ˜¯å®ƒçš„å¼ºåº¦æ¯”è½¯å¼•ç”¨æ›´å¼±ä¸€äº›,è¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡åªèƒ½ç”Ÿå­˜åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†å‘ç”Ÿä¹‹å‰ã€‚å½“åƒåœ¾æ”¶é›†å™¨å·¥ä½œæ—¶ï¼Œæ— è®ºå½“å‰å†…å­˜æ˜¯å¦è¶³å¤Ÿ,éƒ½ä¼šå›æ”¶æ‰åªè¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡ã€‚åœ¨JDK1.2ä¹‹å,æä¾›äº†WeakReferenceç±»æ¥å®ç°å¼±å¼•ç”¨ã€‚ è™šå¼•ç”¨ä¹Ÿç§°ä¸ºå¹½çµå¼•ç”¨æˆ–è€…å¹»å½±å¼•ç”¨,å®ƒæ˜¯æœ€å¼±çš„ä¸€ç§å¼•ç”¨å…³ç³»ã€‚ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æœ‰è™šå¼•ç”¨çš„å­˜åœ¨,å®Œå…¨ä¸ä¼šå¯¹å…¶ç”Ÿå­˜æ—¶é—´æ„æˆå½±å“,ä¹Ÿæ— æ³•é€šè¿‡è™šå¼•ç”¨æ¥å–å¾—ä¸€ä¸ªå¯¹è±¡å®ä¾‹ã€‚ä¸ºä¸€ä¸ªå¯¹è±¡è®¾ç½®è™šå¼•ç”¨å…³è”çš„å”¯ä¸€ç›®çš„å°±æ˜¯èƒ½åœ¨è¿™ä¸ªå¯¹è±¡è¢«æ”¶é›†å™¨å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ã€‚åœ¨JDK 1.2ä¹‹å,æä¾›PhantomReferenceç±»æ¥å®ç°è™šå¼•ç”¨ã€‚ 3.finilizeæ–¹æ³•å¯¹è±¡åœ¨å°†è¦è¢«gcçš„æ—¶å€™æ‰ä¼šè¢«è§¦å‘ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è¿›è¡Œè‡ªæ•‘è¡Œä¸ºï¼Œä½†æ˜¯æ³¨æ„è¿™ä¸ªæ–¹æ³•åªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œè¿™ä¸ªå¯¹è±¡ç¬¬äºŒæ¬¡è¢«gcçš„æ—¶å€™å°†ä¸ä¼šæ‰§è¡Œè¿™ä¸ªæ–¹æ³• 4.åƒåœ¾æ”¶é›†å™¨ è®¨è®ºçš„æ”¶é›†å™¨åŸºäºJDK 1.7 Update 14ä¹‹åçš„HotSpotè™šæ‹Ÿæœº æ˜ç¡®ä¸€ä¸ªè§‚ç‚¹:è™½ç„¶æˆ‘ä»¬æ˜¯åœ¨å¯¹å„ä¸ªæ”¶é›†å™¨è¿›è¡Œæ¯”è¾ƒ,ä½†å¹¶éä¸ºäº†æŒ‘é€‰å‡ºä¸€ä¸ªæœ€å¥½çš„æ”¶é›†å™¨ã€‚å› ä¸ºç›´åˆ°ç°åœ¨ä¸ºæ­¢è¿˜æ²¡æœ‰æœ€å¥½çš„æ”¶é›†å™¨å‡ºç°,æ›´åŠ æ²¡æœ‰ä¸‡èƒ½çš„æ”¶é›†å™¨,æ‰€ä»¥æˆ‘ä»¬é€‰æ‹©çš„åªæ˜¯å¯¹å…·ä½“åº”ç”¨æœ€åˆé€‚çš„æ”¶é›†å™¨ã€‚è¿™ç‚¹ä¸éœ€è¦å¤šåŠ è§£é‡Šå°±èƒ½è¯æ˜:å¦‚æœæœ‰ä¸€ç§æ”¾ä¹‹å››æµ·çš†å‡†ã€ä»»ä½•åœºæ™¯ä¸‹éƒ½é€‚ç”¨çš„å®Œç¾æ”¶é›†å™¨å­˜åœ¨,é‚£HotSpotè™šæ‹Ÿæœºå°±æ²¡å¿…è¦å®ç°é‚£ä¹ˆå¤šä¸åŒçš„æ”¶é›†å™¨äº†ã€‚ ï¼ˆ1ï¼‰Serialæ”¶é›†å™¨ï¼ˆä¸²è¡Œæ”¶é›†å™¨ï¼‰åªä¼šä½¿ç”¨ä¸€ä¸ªCPUæˆ–ä¸€æ¡æ”¶é›†çº¿ç¨‹å»å®Œæˆåƒåœ¾æ”¶é›†å·¥ä½œ,æ›´é‡è¦çš„æ˜¯åœ¨å®ƒè¿›è¡Œåƒåœ¾æ”¶é›†æ—¶,å¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹,ç›´åˆ°å®ƒæ”¶é›†ç»“æŸ é€‚åˆåœ¨å•çº¿æˆç¯å¢ƒä¸‹è¿›è¡Œä½¿ç”¨ï¼Œç¼ºç‚¹æ€§èƒ½å¤ªä½ ï¼ˆ2ï¼‰ParNewæ”¶é›†å™¨ï¼ˆä¸²è¡Œæ”¶é›†å™¨å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼‰CMSä½œä¸ºè€å¹´ä»£çš„æ”¶é›†å™¨,å´æ— æ³•ä¸JDK 1.4.0ä¸­å·²ç»å­˜åœ¨çš„æ–°ç”Ÿä»£æ”¶é›†å™¨Parallel Scavengeé…åˆå·¥ä½œ ,æ‰€ä»¥åœ¨JDK 1.5ä¸­ä½¿ç”¨CMSæ¥æ”¶é›†è€å¹´ä»£çš„æ—¶å€™,æ–°ç”Ÿä»£åªèƒ½é€‰æ‹©ParNewæˆ–è€…Serialæ”¶é›†å™¨ä¸­çš„ä¸€ä¸ªæ˜¯è®¸å¤šè¿è¡Œåœ¨Serveræ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºä¸­é¦–é€‰çš„æ–°ç”Ÿä»£æ”¶é›†å™¨,å…¶ä¸­æœ‰ä¸€ä¸ªä¸æ€§èƒ½æ— å…³ä½†å¾ˆé‡è¦çš„åŸå› æ˜¯,é™¤äº†Serialæ”¶é›†å™¨å¤–,ç›®å‰åªæœ‰å®ƒèƒ½ä¸CMSæ”¶é›†å™¨é…åˆå·¥ä½œ ï¼ˆ3ï¼‰Parallel Scavengeæ”¶é›†å™¨ç‰¹ç‚¹æ˜¯å®ƒçš„å…³æ³¨ç‚¹ä¸å…¶ä»–æ”¶é›†å™¨ä¸åŒ,CMSç­‰æ”¶é›†å™¨çš„å…³æ³¨ç‚¹æ˜¯å°½å¯èƒ½åœ°ç¼©çŸ­åƒåœ¾æ”¶é›†æ—¶ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´,è€ŒParallel Scavengeæ”¶é›†å™¨çš„ç›®æ ‡åˆ™æ˜¯è¾¾åˆ°ä¸€ä¸ªå¯æ§åˆ¶çš„ååé‡(Throughput) ï¼ˆ4ï¼‰serial oldç›¸å½“äºserialæ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ ï¼ˆ5ï¼‰paroldç›¸å½“äºparnew æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ ï¼ˆ6ï¼‰CMSæ”¶é›†å™¨CMS(Concurrent Mark Sweep)æ”¶é›†å™¨æ˜¯ä¸€ç§ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ã€‚ç›®å‰å¾ˆå¤§ä¸€éƒ¨åˆ†çš„Javaåº”ç”¨é›†ä¸­åœ¨äº’è”ç½‘ç«™æˆ–è€…B&#x2F;Sç³»ç»Ÿçš„æœåŠ¡ç«¯ä¸Š,è¿™ç±»åº”ç”¨å°¤å…¶é‡è§†æœåŠ¡çš„å“åº”é€Ÿåº¦,å¸Œæœ›ç³»ç»Ÿåœé¡¿æ—¶é—´æœ€çŸ­,ä»¥ç»™ç”¨æˆ·å¸¦æ¥è¾ƒå¥½çš„ä½“éªŒã€‚ ç‰¹ç‚¹ï¼š ç»å¤§éƒ¨åˆ†æ–°ç”Ÿæˆçš„å¯¹è±¡éƒ½æ”¾åœ¨EdenåŒºï¼Œå½“EdenåŒºå°†æ»¡ï¼ŒJVMä¼šå› ç”³è¯·ä¸åˆ°å†…å­˜ï¼Œè€Œè§¦å‘Young GC ,è¿›è¡ŒEdenåŒº+æœ‰å¯¹è±¡çš„SurvivoråŒº(è®¾ä¸ºS0åŒº)åƒåœ¾å›æ”¶ï¼ŒæŠŠå­˜æ´»çš„å¯¹è±¡ç”¨å¤åˆ¶ç®—æ³•æ‹·è´åˆ°ä¸€ä¸ªç©ºçš„Survivor(S1)ä¸­ï¼Œæ­¤æ—¶EdenåŒºè¢«æ¸…ç©ºï¼Œå¦å¤–ä¸€ä¸ªSurvivor S0ä¹Ÿä¸ºç©ºã€‚ä¸‹æ¬¡è§¦å‘Young GCå›æ”¶Eden+S0ï¼Œå°†å­˜æ´»å¯¹è±¡æ‹·è´åˆ°S1ä¸­ã€‚æ–°ç”Ÿä»£åƒåœ¾å›æ”¶ç®€å•ã€ç²—æš´ã€é«˜æ•ˆã€‚ è‹¥å‘ç°SurvivoråŒºæ»¡äº†ï¼Œåˆ™å°†è¿™äº›å¯¹è±¡æ‹·è´åˆ°oldåŒºæˆ–è€…Survivoræ²¡æ»¡ä½†æŸäº›å¯¹è±¡è¶³å¤ŸOld,ä¹Ÿæ‹·è´åˆ°OldåŒº(æ¯æ¬¡Young GCéƒ½ä¼šä½¿SurvivoråŒºå­˜æ´»å¯¹è±¡å€¼+1ï¼Œç›´åˆ°é˜ˆå€¼)ã€‚ 3.OldåŒºä¹Ÿä¼šè¿›è¡Œåƒåœ¾æ”¶é›†(Young GC),å‘ç”Ÿä¸€æ¬¡ Major GC è‡³å°‘ä¼´éšä¸€æ¬¡Young GCï¼Œä¸€èˆ¬æ¯”Young GCæ…¢åå€ä»¥ä¸Šã€‚ JVMåœ¨OldåŒºç”³è¯·ä¸åˆ°å†…å­˜ï¼Œä¼šè¿›è¡ŒFull GCã€‚OldåŒºä½¿ç”¨ä¸€èˆ¬é‡‡ç”¨Concurrent-Markâ€“Sweepç­–ç•¥å›æ”¶å†…å­˜ã€‚ç¼ºç‚¹ï¼š GCè¿‡ç¨‹ä¸­ä¼šå‡ºç°STW(Stop-The-World)ï¼Œè‹¥OldåŒºå¯¹è±¡å¤ªå¤šï¼ŒSTWè€—è´¹å¤§é‡æ—¶é—´ã€‚ CMSæ”¶é›†å™¨å¯¹CPUèµ„æºå¾ˆæ•æ„Ÿã€‚ CMSæ”¶é›†å™¨æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾ï¼Œå¯èƒ½å‡ºç°â€œConcurrent Mode Failureâ€å¤±è´¥è€Œå¯¼è‡´å¦ä¸€æ¬¡Full GCçš„äº§ç”Ÿã€‚ CMSå¯¼è‡´å†…å­˜ç¢ç‰‡é—®é¢˜ã€‚ ï¼ˆ7ï¼‰g1åƒåœ¾å›æ”¶åœ¨G1ä¸­ï¼Œå †è¢«åˆ’åˆ†æˆ è®¸å¤šä¸ªè¿ç»­çš„åŒºåŸŸ(region)ã€‚æ¯ä¸ªåŒºåŸŸå¤§å°ç›¸ç­‰ï¼Œåœ¨1M~32Mä¹‹é—´ã€‚JVMæœ€å¤šæ”¯æŒ2000ä¸ªåŒºåŸŸï¼Œå¯æ¨ç®—G1èƒ½æ”¯æŒçš„æœ€å¤§å†…å­˜ä¸º2000*32M&#x3D;62.5Gã€‚åŒºåŸŸ(region)çš„å¤§å°åœ¨JVMåˆå§‹åŒ–çš„æ—¶å€™å†³å®šï¼Œä¹Ÿå¯ä»¥ç”¨-XX:G1HeapReginSizeè®¾ç½®ã€‚ åœ¨G1ä¸­æ²¡æœ‰ç‰©ç†ä¸Šçš„Yong(Eden&#x2F;Survivor)&#x2F;Old Generationï¼Œå®ƒä»¬æ˜¯é€»è¾‘çš„ï¼Œä½¿ç”¨ä¸€äº›éè¿ç»­çš„åŒºåŸŸ(Region)ç»„æˆçš„ã€‚ æ–°ç”Ÿä»£æ”¶é›† G1çš„æ–°ç”Ÿä»£æ”¶é›†è·ŸParNewç±»ä¼¼ï¼Œå½“æ–°ç”Ÿä»£å ç”¨è¾¾åˆ°ä¸€å®šæ¯”ä¾‹çš„æ—¶å€™ï¼Œå¼€å§‹å‡ºå‘æ”¶é›†ã€‚ è¢«åœˆèµ·çš„ç»¿è‰²éƒ¨åˆ†ä¸ºæ–°ç”Ÿä»£çš„åŒºåŸŸ(region)ï¼Œç»è¿‡Young GCåå­˜æ´»çš„å¯¹è±¡è¢«å¤åˆ¶åˆ°ä¸€ä¸ªæˆ–è€…å¤šä¸ªåŒºåŸŸç©ºé—²ä¸­ï¼Œè¿™äº›è¢«å¡«å……çš„åŒºåŸŸå°†æ˜¯æ–°çš„æ–°ç”Ÿä»£ï¼›å½“æ–°ç”Ÿä»£å¯¹è±¡çš„å¹´é¾„(é€ƒé€¸è¿‡ä¸€æ¬¡Young GCå¹´é¾„å¢åŠ ï¼‘)å·²ç»è¾¾åˆ°æŸä¸ªé˜ˆå€¼(ParNewé»˜è®¤15)ï¼Œè¢«å¤åˆ¶åˆ°è€å¹´ä»£çš„åŒºåŸŸä¸­ã€‚ å›æ”¶è¿‡ç¨‹æ˜¯åœé¡¿çš„(STW,Stop-The-Word);å›æ”¶å®Œæˆä¹‹åæ ¹æ®Young GCçš„ç»Ÿè®¡ä¿¡æ¯è°ƒæ•´Edenå’ŒSurvivorçš„å¤§å°ï¼Œæœ‰åŠ©äºåˆç†åˆ©ç”¨å†…å­˜ï¼Œæé«˜å›æ”¶æ•ˆç‡ã€‚ å›æ”¶çš„è¿‡ç¨‹å¤šä¸ªå›æ”¶çº¿ç¨‹å¹¶å‘æ”¶é›†ã€‚ è€å¹´ä»£æ”¶é›† å’ŒCMSç±»ä¼¼ï¼ŒG1æ”¶é›†å™¨æ”¶é›†è€å¹´ä»£å¯¹è±¡ä¼šæœ‰çŸ­æš‚åœé¡¿ã€‚ æ ‡è®°é˜¶æ®µï¼Œé¦–å…ˆåˆå§‹æ ‡è®°(Initial-Mark),è¿™ä¸ªé˜¶æ®µæ˜¯åœé¡¿çš„(Stop the World Event)ï¼Œå¹¶ä¸”ä¼šè§¦å‘ä¸€æ¬¡æ™®é€šMintor GCã€‚å¯¹åº”GC log:GC pause (young) (inital-mark) Root Region Scanningï¼Œç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä¼šå›æ”¶survivoråŒº(å­˜æ´»åˆ°è€å¹´ä»£)ï¼Œè¿™ä¸€è¿‡ç¨‹å¿…é¡»åœ¨young GCä¹‹å‰å®Œæˆã€‚ Concurrent Markingï¼Œåœ¨æ•´ä¸ªå †ä¸­è¿›è¡Œå¹¶å‘æ ‡è®°(å’Œåº”ç”¨ç¨‹åºå¹¶å‘æ‰§è¡Œ)ï¼Œæ­¤è¿‡ç¨‹å¯èƒ½è¢«young GCä¸­æ–­ã€‚åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µï¼Œè‹¥å‘ç°åŒºåŸŸå¯¹è±¡ä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯åƒåœ¾ï¼Œé‚£ä¸ªè¿™ä¸ªåŒºåŸŸä¼šè¢«ç«‹å³å›æ”¶(å›¾ä¸­æ‰“X)ã€‚åŒæ—¶ï¼Œå¹¶å‘æ ‡è®°è¿‡ç¨‹ä¸­ï¼Œä¼šè®¡ç®—æ¯ä¸ªåŒºåŸŸçš„å¯¹è±¡æ´»æ€§(åŒºåŸŸä¸­å­˜æ´»å¯¹è±¡çš„æ¯”ä¾‹)ã€‚ Remark, å†æ ‡è®°ï¼Œä¼šæœ‰çŸ­æš‚åœé¡¿(STW)ã€‚å†æ ‡è®°é˜¶æ®µæ˜¯ç”¨æ¥æ”¶é›† å¹¶å‘æ ‡è®°é˜¶æ®µ äº§ç”Ÿæ–°çš„åƒåœ¾(å¹¶å‘é˜¶æ®µå’Œåº”ç”¨ç¨‹åºä¸€åŒè¿è¡Œ)ï¼›G1ä¸­é‡‡ç”¨äº†æ¯”CMSæ›´å¿«çš„åˆå§‹å¿«ç…§ç®—æ³•:snapshot-at-the-beginning (SATB)ã€‚ Copy&#x2F;Clean upï¼Œå¤šçº¿ç¨‹æ¸…é™¤å¤±æ´»å¯¹è±¡ï¼Œä¼šæœ‰STWã€‚G1å°†å›æ”¶åŒºåŸŸçš„å­˜æ´»å¯¹è±¡æ‹·è´åˆ°æ–°åŒºåŸŸï¼Œæ¸…é™¤Remember Setsï¼Œå¹¶å‘æ¸…ç©ºå›æ”¶åŒºåŸŸå¹¶æŠŠå®ƒè¿”å›åˆ°ç©ºé—²åŒºåŸŸé“¾è¡¨ä¸­ã€‚ å¤åˆ¶&#x2F;æ¸…é™¤è¿‡ç¨‹åã€‚å›æ”¶åŒºåŸŸçš„æ´»æ€§å¯¹è±¡å·²ç»è¢«é›†ä¸­å›æ”¶åˆ°æ·±è“è‰²å’Œæ·±ç»¿è‰²åŒºåŸŸã€‚ å…³äºRemembered Setæ¦‚å¿µï¼šG1æ”¶é›†å™¨ä¸­ï¼ŒRegionä¹‹é—´çš„å¯¹è±¡å¼•ç”¨ä»¥åŠå…¶ä»–æ”¶é›†å™¨ä¸­çš„æ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¹‹é—´çš„å¯¹è±¡å¼•ç”¨æ˜¯ä½¿ç”¨Remembered Setæ¥é¿å…æ‰«æå…¨å †ã€‚G1ä¸­æ¯ä¸ªRegionéƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„Remembered Setï¼Œè™šæ‹Ÿæœºå‘ç°ç¨‹åºå¯¹Referenceç±»å‹æ•°æ®è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªWrite Barrieræš‚æ—¶ä¸­æ–­å†™æ“ä½œï¼Œæ£€æŸ¥Referenceå¼•ç”¨çš„å¯¹è±¡æ˜¯å¦å¤„äºä¸åŒçš„Regionä¹‹é—´(åœ¨åˆ†ä»£ä¸­ä¾‹å­ä¸­å°±æ˜¯æ£€æŸ¥æ˜¯å¦è€å¹´ä»£ä¸­çš„å¯¹è±¡å¼•ç”¨äº†æ–°ç”Ÿä»£çš„å¯¹è±¡)ï¼Œå¦‚æœæ˜¯ä¾¿é€šè¿‡CardTableæŠŠç›¸å…³å¼•ç”¨ä¿¡æ¯è®°å½•åˆ°è¢«å¼•ç”¨å¯¹è±¡æ‰€å±çš„Regionçš„Remembered Setä¸­ã€‚å½“å†…å­˜å›æ”¶æ—¶ï¼Œåœ¨GCæ ¹èŠ‚ç‚¹çš„æšä¸¾èŒƒå›´åŠ å…¥Remembered Setå³å¯ä¿è¯ä¸å¯¹å…¨å±€å †æ‰«æä¹Ÿä¸ä¼šæœ‰é—æ¼ã€‚ G1è™½ç„¶ä¿ç•™äº†CMSå…³äºä»£çš„æ¦‚å¿µï¼Œä½†æ˜¯ä»£å·²ç»ä¸æ˜¯ç‰©ç†ä¸Šè¿ç»­åŒºåŸŸï¼Œè€Œæ˜¯ä¸€ä¸ªé€»è¾‘çš„æ¦‚å¿µã€‚åœ¨æ ‡è®°è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªåŒºåŸŸçš„å¯¹è±¡æ´»æ€§éƒ½è¢«è®¡ç®—ï¼Œåœ¨å›æ”¶æ—¶å€™ï¼Œå°±å¯ä»¥æ ¹æ®ç”¨æˆ·è®¾ç½®çš„åœé¡¿æ—¶é—´ï¼Œé€‰æ‹©æ´»æ€§è¾ƒä½çš„åŒºåŸŸæ”¶é›†ï¼Œè¿™æ ·æ—¢èƒ½ä¿è¯åƒåœ¾å›æ”¶ï¼Œåˆèƒ½ä¿è¯åœé¡¿æ—¶é—´ï¼Œè€Œä¸”ä¹Ÿä¸ä¼šé™ä½å¤ªå¤šçš„ååé‡ã€‚Remarké˜¶æ®µæ–°ç®—æ³•çš„è¿ç”¨ï¼Œä»¥åŠæ”¶é›†è¿‡ç¨‹ä¸­çš„å‹ç¼©ï¼Œéƒ½å¼¥è¡¥äº†CMSä¸è¶³ã€‚å¼•ç”¨Oracleå®˜ç½‘çš„ä¸€å¥è¯ï¼šâ€œG1 is planned as the long term replacement for the Concurrent Mark-Sweep Collector (CMS)â€ã€‚","date":"2024-12-31","categories":["java"],"tags":["jvmè™šæ‹Ÿæœº"]},{"title":"java-æ·±å…¥ç†è§£jvmè™šæ‹Ÿæœº-ç±»åŠ è½½æœºåˆ¶","url":"/2024/12/31/java-æ·±å…¥ç†è§£jvmè™šæ‹Ÿæœº-ç±»åŠ è½½æœºåˆ¶/","content":"ç±»åŠ è½½è¿‡ç¨‹ç±»ä»è¢«åŠ è½½åˆ°è™šæ‹Ÿæœºå†…å­˜ä¸­å¼€å§‹,åˆ°å¸è½½å‡ºå†…å­˜ä¸ºæ­¢,å®ƒçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬:**åŠ è½½(Loading)ã€éªŒè¯(Verification)ã€å‡†å¤‡(Preparation)ã€è§£æ(Resolution)ã€åˆå§‹åŒ–(Initialization)ã€ä½¿ç”¨(Using)å’Œå¸è½½(Unloading)**7ä¸ªé˜¶æ®µã€‚å…¶ä¸­éªŒè¯ã€å‡†å¤‡ã€è§£æ3ä¸ªéƒ¨åˆ†ç»Ÿç§°ä¸ºè¿æ¥(Linking) ï¼ˆ1ï¼‰åŠ è½½é˜¶æ®µè§¦å‘æ¡ä»¶ ä¸»åŠ¨å¼•ç”¨ ä½¿ç”¨newå…³é”®å­—å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™ã€è¯»å–æˆ–è®¾ç½®ä¸€ä¸ªç±»çš„é™æ€å­—æ®µ(è¢«finalä¿®é¥°ã€å·²åœ¨ç¼–è¯‘æœŸæŠŠç»“æœæ”¾å…¥å¸¸é‡æ± çš„é™æ€å­—æ®µé™¤å¤–)çš„æ—¶å€™,ä»¥åŠè°ƒç”¨ä¸€ä¸ªç±»çš„é™æ€æ–¹æ³•çš„æ—¶å€™ã€‚ ä½¿ç”¨java.lang.reflectåŒ…çš„æ–¹æ³•å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨çš„æ—¶å€™,å¦‚æœç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–,åˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚ å½“åˆå§‹åŒ–ä¸€ä¸ªç±»çš„æ—¶å€™,å¦‚æœå‘ç°å…¶çˆ¶ç±»è¿˜æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–,åˆ™éœ€è¦å…ˆè§¦å‘å…¶çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚ å½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶,ç”¨æˆ·éœ€è¦æŒ‡å®šä¸€ä¸ªè¦æ‰§è¡Œçš„ä¸»ç±»(åŒ…å«main()æ–¹æ³•çš„é‚£ä¸ªç±»),è™šæ‹Ÿæœºä¼šå…ˆåˆå§‹åŒ–è¿™ä¸ªä¸»ç±»ã€‚ å½“ä½¿ç”¨JDK1.7çš„åŠ¨æ€è¯­è¨€æ”¯æŒæ—¶,å¦‚æœä¸€ä¸ªjava.lang.invoke.MethodHandleå®ä¾‹æœ€åçš„è§£æç»“æœREF_getStaticã€REF_putStaticã€REF_invokeStaticçš„æ–¹æ³•å¥æŸ„,å¹¶ä¸”è¿™ä¸ªæ–¹æ³•å¥æŸ„æ‰€å¯¹åº”çš„ç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–,åˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚ å¯¹äºè¿™5ç§ä¼šè§¦å‘ç±»è¿›è¡Œåˆå§‹åŒ–çš„åœºæ™¯,è™šæ‹Ÿæœºè§„èŒƒä¸­ä½¿ç”¨äº†ä¸€ä¸ªå¾ˆå¼ºçƒˆçš„é™å®šè¯­:â€œæœ‰ä¸”åªæœ‰â€,è¿™5ç§åœºæ™¯ä¸­çš„è¡Œä¸ºç§°ä¸ºå¯¹ä¸€ä¸ªç±»è¿›è¡Œä¸»åŠ¨å¼•ç”¨ã€‚é™¤æ­¤ä¹‹å¤–,æ‰€æœ‰å¼•ç”¨ç±»çš„æ–¹å¼éƒ½ä¸ä¼šè§¦å‘åˆå§‹åŒ–,ç§°ä¸ºè¢«åŠ¨å¼•ç”¨ã€‚ è¢«åŠ¨å¼•ç”¨ä¸¾ä¾‹ è¢«åŠ¨ä½¿ç”¨ç±»å­—æ®µ: é€šè¿‡å­ç±»å¼•ç”¨çˆ¶ç±»çš„é™æ€å­—æ®µ,ä¸ä¼šå¯¼è‡´å­ç±»åˆå§‹åŒ– å¯¹åº”ä¸Šé¢çš„è§¦å‘æ¡ä»¶ï¼ˆ1ï¼‰ï¼Œè°ƒç”¨äº†è°çš„static è§¦å‘è° ï¼ˆ2ï¼‰ç±»åŠ è½½å™¨ bootstrapClassLoaderï¼šåŠ è½½æ ¸å¿ƒjar Extension ClassLoaderï¼šåŠ è½½lib&#x2F;extä¸­çš„jar Application ClassLoaderï¼šåŠ è½½pathä¸­çš„jar User ClassLoaderï¼šç”¨æˆ·è‡ªå®šä¹‰çš„jar javaä¸­å­˜åœ¨è¿™ä¹ˆå¤šç±»åŠ è½½æœºåˆ¶çš„ä¸»è¦åŸå› å°±æ˜¯è¦ä¿è¯æ ¸å¿ƒç±»åŠ è½½çš„è¿‡ç¨‹ç›¸åŒï¼Œè¯†åˆ«ç›¸åŒï¼Œå› ä¸ºjava åœ¨ åˆ¤è¯»ä¸€ä¸ªç±»æ˜¯å¦æ˜¯ç›¸åŒçš„åˆ¤æ–­æ–¹æ³•é™¤äº†ä½¿ç”¨ç±»åç§°è¿˜ä½¿ç”¨ç±»çš„åŠ è½½æœºåˆ¶æ¥è¿›è¡Œç›¸å…³çš„åˆ¤æ–­çš„ 2.éªŒè¯é˜¶æ®µéªŒè¯æ˜¯è¿æ¥é˜¶æ®µçš„ç¬¬ä¸€æ­¥,è¿™ä¸€é˜¶æ®µçš„ç›®çš„æ˜¯ä¸ºäº†ç¡®ä¿Classæ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«çš„ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºçš„è¦æ±‚,å¹¶ä¸”ä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«çš„å®‰å…¨ æ–‡ä»¶æ ¼å¼éªŒè¯æ˜¯å¦æ˜¯é­”æ•°0xCAFEBABEå¼€å¤´ å…ƒæ•°æ®éªŒè¯ å­—èŠ‚ç éªŒè¯ ç¬¦å·å¼•ç”¨éªŒè¯ 3.å‡†å¤‡é˜¶æ®µå‡†å¤‡é˜¶æ®µæ˜¯æ­£å¼ä¸ºç±»å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡åˆå§‹å€¼çš„é˜¶æ®µ,è¿™äº›å˜é‡æ‰€ä½¿ç”¨çš„å†…å­˜éƒ½å°†åœ¨æ–¹æ³•åŒºä¸­è¿›è¡Œåˆ†é…ã€‚è¿™ä¸ªé˜¶æ®µä¸­æœ‰ä¸¤ä¸ªå®¹æ˜“äº§ç”Ÿæ··æ·†çš„æ¦‚å¿µéœ€è¦å¼ºè°ƒä¸€ä¸‹,é¦–å…ˆ,è¿™æ—¶å€™è¿›è¡Œå†…å­˜åˆ†é…çš„ä»…åŒ…æ‹¬ç±»å˜é‡(è¢«staticä¿®é¥°çš„å˜é‡),è€Œä¸åŒ…æ‹¬å®ä¾‹å˜é‡,å®ä¾‹å˜é‡å°†ä¼šåœ¨å¯¹è±¡å®ä¾‹åŒ–æ—¶éšç€å¯¹è±¡ä¸€èµ·åˆ†é…åœ¨Javaå †ä¸­ã€‚ æ³¨æ„è¿™é‡Œåˆå§‹çš„æ˜¯åˆå§‹å€¼ å€¼çš„åˆå§‹åŒ–çš„æ—¶é—´å°†æ˜¯åœ¨åˆå§‹åŒ–é˜¶æ®µèµ‹å€¼ï¼Œå½“å‰é˜¶æ®µåªæ˜¯ä½¿ç”¨é»˜è®¤å€¼0 4.è§£æè§£æå„ç§ç±»å±æ€§ 5.åˆå§‹åŒ–æœ€åé˜¶æ®µå„ç§å±æ€§æœ€ç»ˆèµ‹å€¼","date":"2024-12-31","categories":["java"],"tags":["jvmè™šæ‹Ÿæœº"]},{"title":"maven å®æˆ˜ç¬”è®° ï¼ˆäºŒï¼‰mavenå¸¸ç”¨æ’ä»¶","url":"/2024/12/31/maven-å®æˆ˜ç¬”è®°--äºŒ-mavenå¸¸ç”¨æ’ä»¶/","content":"","date":"2024-12-31","categories":["java"],"tags":["maven"]},{"title":"maven-å®æˆ˜ç¬”è®°(1)åŸºæœ¬é…ç½®","url":"/2024/12/31/maven-å®æˆ˜ç¬”è®°-1-åŸºæœ¬é…ç½®/","content":"maven å®æˆ˜ç¬”è®°ï¼ˆä¸€ï¼‰åŸºæœ¬é…ç½®åœ¨javaä¸–ç•Œä¸­mavenåº”è¯¥æ˜¯åº”ç”¨æœ€ä¸ºå¹¿æ³›çš„é¡¹ç›®æ„å»ºå·¥å…·ï¼Œä¹‹å‰ä½¿ç”¨è¿‡mavenä½†æ˜¯æ²¡å“Ÿè¿›è¡Œç»†è‡´ç³»ç»Ÿçš„å­¦ä¹ ï¼Œè¿™æ¬¡å¼€ä¸€ä¸ªä¸“é¢˜è¿›è¡Œä¸€ä¸‹ç³»ç»Ÿçš„æ•´ç† mavenæ–‡ä»¶ç›®å½•ç»“æ„ binï¼šmavençš„è¿è¡Œæ—¶ç›®å½•ï¼Œæ”¾ç½®mavenè¿è¡Œæ—¶çš„è„šæœ¬ï¼Œç›®å½•ä¸­è¿˜æœ‰ä¸€ä¸ªmvnDebugæ–‡ä»¶ï¼Œç›¸æ¯”è¾ƒmvnæ–‡ä»¶æ·»åŠ äº†è°ƒè¯•åŠŸèƒ½ï¼Œæ–‡ä»¶å¤¹ä¸­çš„m2.confï¼Œæ˜¯classworldsçš„é…ç½®æ–‡ä»¶ bootï¼šä¸­åªæœ‰ä¸€ä¸ªæ–‡ä»¶plexus-classworlds-2.5.2.jarï¼ˆmaven3.5ï¼‰è¿™ä¸ªæ˜¯mavenè‡ªå·±çš„å®ç°çš„ç±»åŠ è½½å™¨ï¼ˆè¿™ä¸ªå…¶å®æ˜¯å®ç°jarä¸‹è½½ç­‰åŠŸèƒ½æ‰€å¿…éœ€çš„ï¼‰ confï¼šå…¶ä¸­çš„settting.xmlæ–‡ä»¶å…¨å±€å®šä¹‰mavençš„è¡Œä¸ºï¼Œåœ¨ä½¿ç”¨ä¸Šæ›´åŠ å€¾å‘äºè§æ­¤æ–‡ä»¶æ‹·è´è‡³~&#x2F;.m2æ–‡ä»¶å¤¹ä¸­è¿›è¡Œç§æœ‰åŒ–å®šåˆ¶libï¼šé˜²æ­¢mavençš„å„ç§ä¾èµ–æ–‡ä»¶ ä¸€ä¸ªå‘½ä»¤ï¼šmvn help:system æ‰“å°å‡ºæ‰€æœ‰javaç³»ç»Ÿå±æ€§å’Œç¯å¢ƒå˜é‡ mavenä½¿ç”¨ä»£ç† æœ‰çš„æ—¶å€™éœ€è¦è¿›è¡Œé…ç½®ç›¸å…³çš„ä»£ç†æ‰èƒ½æ­£å¸¸çš„è®¿é—®å¤–éƒ¨ä»“åº“ï¼Œmavenæä¾›è¿™æ ·çš„é…ç½® maven pom æ–‡ä»¶ maven é¡¹ç›®çš„æ ¸å¿ƒæ˜¯ pomæ–‡ä»¶ å®šä¹‰äº†é¡¹ç›®çš„åŸºæœ¬ä¿¡æ¯ä¾‹å¦‚ä¸‹é¢çš„é…ç½®æ–‡ä»¶ pom æ–‡ä»¶æ ¸å¿ƒæ ‡ç­¾projectæ ‡ç­¾-è¡¨ç¤ºä¸€ä¸ªmavené¡¹ç›®çš„æœ€å¤–å±‚æ ‡ç­¾å­æ ‡ç­¾ æ ‡ç­¾åç§° ä½œç”¨ modelversion æŒ‡å®šPOMæ¨¡å‹çš„ç‰ˆæœ¬ç°åœ¨åªèƒ½ä½¿ç”¨4.0.0ã€‚gounpId,artifactId,version,packaging,classifier ä¸‰è¦ç´ ï¼Œå®šä¹‰äº†ä¸€ä¸ªé¡¹ç›®çš„åæ ‡ï¼ŒgroupIdå®šä¹‰é¡¹ç›®å±äºå“ªä¸€ä¸ªç»„ï¼ŒartifactIdå®šä¹‰å½“å‰é¡¹ç›®åœ¨ç»„ä¸­çš„å”¯ä¸€idï¼ŒversionæŒ‡å®šå½“å‰çš„é¡¹ç›®çš„ç‰ˆæœ¬å·ï¼ŒpackagingæŒ‡å®šæ‰“åŒ…çš„æ–¹å¼é»˜è®¤ä½¿ç”¨jaråŒ…ï¼Œclassifierç”¨æ¥æ˜‚ä½å®šä¹‰æ„å»ºè¾“å‡ºä¸€äº›é™„å±æ„å»º name å£°åä¸€ä¸ªå¯¹ç”¨æˆ·å‹å¥½çš„åç§°ï¼Œä¸æ˜¯å¿…é¡»çš„ dependencies dependenc æ ‡ç­¾çš„å‰¯æ ‡ç­¾ï¼Œå¯ä»¥åŒ…å«å¤šä¸ªdependencyæ ‡ç­¾ï¼Œç›¸å¯¹äºdependencyManagementï¼Œæ‰€æœ‰ç”Ÿå‘½åœ¨dependenciesé‡Œçš„ä¾èµ–éƒ½ä¼šè‡ªåŠ¨å¼•å…¥ï¼Œå¹¶é»˜è®¤è¢«æ‰€æœ‰çš„å­é¡¹ç›®ç»§æ‰¿ã€‚ dependencyManagement ä¸€ä¸ªä¾èµ–ç®¡ç†è€…ä¸€èˆ¬éƒ½æ˜¯ä¸æ˜¯åœ¨é¡¶å±‚çš„maven æ¨¡å—ä¸Šé¢ï¼Œå­æ¨¡å—é€šè¿‡ç»§æ‰¿çˆ¶mavené¡¹ç›®ï¼Œå¯ä»¥åœ¨è‡ªå·±çš„ä¾èµ–ä¸­ä¸ç”¨æŒ‡æ˜ç‰ˆæœ¬å·è€Œç›´æ¥ä½¿ç”¨çˆ¶mavené¡¹ç›®ä¸­çš„dependencyManagementé…ç½®çš„ç‰ˆæœ¬å·ã€‚åœ¨æˆ‘ä»¬é¡¹ç›®é¡¶å±‚çš„POMæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°dependencyManagementå…ƒç´ ã€‚é€šè¿‡å®ƒå…ƒç´ æ¥ç®¡ç†jaråŒ…çš„ç‰ˆæœ¬ï¼Œè®©å­é¡¹ç›®ä¸­å¼•ç”¨ä¸€ä¸ªä¾èµ–è€Œä¸ç”¨æ˜¾ç¤ºçš„åˆ—å‡ºç‰ˆæœ¬å·ã€‚ dependencyManagementå’ŒdependenciesåŒºåˆ« dependencies:å³ä½¿åœ¨å­é¡¹ç›®ä¸­ä¸å†™è¯¥ä¾èµ–é¡¹ï¼Œé‚£ä¹ˆå­é¡¹ç›®ä»ç„¶ä¼šä»çˆ¶é¡¹ç›®ä¸­ç»§æ‰¿è¯¥ä¾èµ–é¡¹ï¼ˆå…¨éƒ¨ç»§æ‰¿ï¼‰ dependencyManagement:é‡Œåªæ˜¯å£°æ˜ä¾èµ–ï¼Œå¹¶ä¸å®ç°å¼•å…¥ï¼Œå› æ­¤å­é¡¹ç›®éœ€è¦æ˜¾ç¤ºçš„å£°æ˜éœ€è¦ç”¨çš„ä¾èµ–ã€‚å¦‚æœä¸åœ¨å­é¡¹ç›®ä¸­å£°æ˜ä¾èµ–ï¼Œæ˜¯ä¸ä¼šä»çˆ¶é¡¹ç›®ä¸­ç»§æ‰¿ä¸‹æ¥çš„ï¼›åªæœ‰åœ¨å­é¡¹ç›®ä¸­å†™äº†è¯¥ä¾èµ–é¡¹ï¼Œå¹¶ä¸”æ²¡æœ‰æŒ‡å®šå…·ä½“ç‰ˆæœ¬ï¼Œæ‰ä¼šä»çˆ¶é¡¹ç›®ä¸­ç»§æ‰¿è¯¥é¡¹ï¼Œå¹¶ä¸”versionå’Œscopeéƒ½è¯»å–è‡ªçˆ¶pom;å¦å¤–å¦‚æœå­é¡¹ç›®ä¸­æŒ‡å®šäº†ç‰ˆæœ¬å·ï¼Œé‚£ä¹ˆä¼šä½¿ç”¨å­é¡¹ç›®ä¸­æŒ‡å®šçš„jarç‰ˆæœ¬ã€‚ dependencyæ ‡ç­¾-è¡¨ç¤ºä¸€ä¸ªä¾èµ–åæ ‡å­æ ‡ç­¾ æ ‡ç­¾åç§° ä½œç”¨ gounpId,artifactId,version ä¸‰è¦ç´ ï¼Œå®šä¹‰äº†ä¸€ä¸ªé¡¹ç›®çš„åæ ‡ï¼ŒgroupIdå®šä¹‰é¡¹ç›®å±äºå“ªä¸€ä¸ªç»„ï¼ŒartifactIdå®šä¹‰å½“å‰é¡¹ç›®åœ¨ç»„ä¸­çš„å”¯ä¸€idï¼ŒversionæŒ‡å®šå½“å‰çš„é¡¹ç›®çš„ç‰ˆæœ¬å· scope ï¼ˆç¼–è¯‘æŒ‡çš„æ˜¯mavenè¿›è¡Œç¼–è¯‘é¡¹ç›®ï¼‰è¡¨ç¤ºä¾èµ–èŒƒå›´ 1.compileï¼šç¼–è¯‘ä¾èµ–èŒƒå›´ ç¼–è¯‘æµ‹è¯•è¿è¡Œéƒ½æœ‰æ•ˆ2.testï¼šæµ‹è¯•ä¾èµ–èŒƒå›´ ç¼–è¯‘å’Œè¿è¡Œæ—¶æ— æ³•ä½¿ç”¨ï¼Œæµ‹è¯•ä¸‹ä½¿ç”¨ï¼ˆjunitï¼‰3.provided å·²æä¾›ä¾èµ–èŒƒå›´ è¿è¡Œæ—¶æ— æ•ˆï¼ˆå„ç§web serviceä¾èµ–ï¼‰ 4.runtime ç¼–è¯‘æ—¶æ— æ•ˆ ï¼ˆå¦‚jdbcï¼‰5.system ç³»ç»Ÿä¾èµ–èŒƒå›´å’Œprovidedç±»ä¼¼ä½†æ˜¯ éœ€è¦ä½¿ç”¨systenPathæ ‡ç­¾æ‰‹åŠ¨æŒ‡å®šä¾èµ–èŒƒå›´6,importï¼šä¸€èˆ¬å’ŒdependencyManagementç»„åˆä½¿ç”¨ type å£°åä¾èµ–ç±»å‹ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨jar optional æ ‡è®°ä¾èµ–æ˜¯å¦å¯é€‰ exclusions æ’é™¤ä¼ é€’æ€§ä¾èµ– æ˜¯å®šgroupIdå’ŒartifactIdå°†ä¼šå°†æŒ‡å®šçš„ä¾èµ–é©±é™¤æ‰ï¼Œè§ä¸‹é¢ä¾‹å­ repositoriesæ ‡ç­¾-æ·»åŠ è¿œç¨‹ä»“åº“åˆ°æŒ‡å®šçš„ä½ç½®ä¸­ èšåˆä¸ç»§æ‰¿ï¼ˆä¸€èˆ¬ä¸€èµ·ä½¿ç”¨å› ä¸ºçˆ¶çº§æ‰“åŒ…æ–¹å¼å¼ºåˆ¶è¦æ±‚pomæ–¹å¼ï¼‰èšåˆï¼šèšåˆï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯æŠŠå¤šä¸ªæ¨¡å—æˆ–é¡¹ç›®èšåˆåˆ°ä¸€èµ·ï¼Œæˆ‘ä»¬å¯ä»¥å»ºç«‹ä¸€ä¸ªä¸“é—¨è´Ÿè´£èšåˆå·¥ä½œçš„Maven project â€” aggregatorã€‚ å»ºç«‹è¯¥projectçš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š è¯¥aggregatoræœ¬èº«ä¹Ÿåšä¸ºä¸€ä¸ªMavené¡¹ç›®ï¼Œå®ƒå¿…é¡»æœ‰è‡ªå·±çš„POM,å®ƒçš„æ‰“åŒ…æ–¹å¼å¿…é¡»ä¸ºï¼š pom å¼•å…¥äº†æ–°çš„å…ƒç´ ï¼šmodulesâ€”module ä¸­ å†™çš„æ˜¯åœ°å€ ç‰ˆæœ¬ï¼šèšåˆæ¨¡å—çš„ç‰ˆæœ¬å’Œè¢«èšåˆæ¨¡å—ç‰ˆæœ¬ä¸€è‡´ ä¸­æŒ‡å®šçš„ç‰ˆæœ¬å· relative pathï¼šæ¯ä¸ªmoduleçš„å€¼éƒ½æ˜¯ä¸€ä¸ªå½“å‰POMçš„ç›¸å¯¹ç›®å½• ç›®å½•åç§°ï¼šä¸ºäº†æ–¹ä¾¿çš„å¿«é€Ÿå®šä½å†…å®¹ï¼Œæ¨¡å—æ‰€å¤„çš„ç›®å½•åº”å½“ä¸å…¶artifactIdä¸€è‡´(Mavençº¦å®šè€Œä¸æ˜¯ç¡¬æ€§è¦æ±‚)ï¼Œæ€»ä¹‹ï¼Œæ¨¡å—æ‰€å¤„çš„ç›®å½•å¿…é¡»å’Œæ¨¡å—æ‰€å¤„çš„ç›®å½•ç›¸ä¸€è‡´ã€‚ ä¹Ÿå°±æ˜¯è¯´å­æ¨¡å—åº”è¯¥åœ¨çˆ¶æ¨¡å—pom.xmlæ–‡ä»¶æ‰€åœ¨ç›®å½•çš„ä¸‹é¢çš„æŒ‡å®šçš„ç›¸å…³ç›®å½•åœ°å€ ä¹ æƒ¯çº¦å®šï¼šä¸ºäº†æ–¹ä¾¿æ„å»ºï¼Œé€šå¸¸å°†èšåˆæ¨¡å—æ”¾åœ¨é¡¹ç›®ç›®å½•å±‚çš„æœ€é¡¶å±‚ï¼Œå…¶å®ƒèšåˆæ¨¡å—ä½œä¸ºå­ç›®å½•å­˜åœ¨ã€‚è¿™æ ·å½“æˆ‘ä»¬æ‰“å¼€é¡¹ç›®çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªçœ‹åˆ°çš„å°±æ˜¯èšåˆæ¨¡å—çš„POM èšåˆæ¨¡å—å‡å°‘çš„å†…å®¹ï¼šèšåˆæ¨¡å—çš„å†…å®¹ä»…ä»…æ˜¯ä¸€ä¸ªpom.xmlæ–‡ä»¶ï¼Œå®ƒä¸åŒ…å«src&#x2F;main&#x2F;javaã€src&#x2F;test&#x2F;javaç­‰ç›®å½•ï¼Œå› ä¸ºå®ƒåªæ˜¯ç”¨æ¥å¸®åŠ©å…¶å®ƒæ¨¡å—æ„å»ºçš„å·¥å…·ï¼Œæœ¬èº«å¹¶æ²¡æœ‰å®è´¨çš„å†…å®¹ã€‚ èšåˆæ¨¡å—å’Œå­æ¨¡å—çš„ç›®å½•ï¼šä»–ä»¬å¯ä»¥æ˜¯çˆ¶å­ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯å¹³è¡Œç»“æ„ï¼Œå½“ç„¶å¦‚æœä½¿ç”¨å¹³è¡Œç»“æ„ï¼Œé‚£ä¹ˆèšåˆæ¨¡å—çš„POMä¹Ÿéœ€è¦åšå‡ºç›¸åº”çš„æ›´æ”¹ã€‚ ç»§æ‰¿ï¼šåšé¢å‘å¯¹è±¡ç¼–ç¨‹çš„äººéƒ½ä¼šè§‰å¾—è¿™æ˜¯ä¸€ä¸ªæ²¡æ„ä¹‰çš„é—®é¢˜ï¼Œæ˜¯çš„ï¼Œç»§æ‰¿å°±æ˜¯é¿å…é‡å¤ï¼Œmavençš„ç»§æ‰¿ä¹Ÿæ˜¯è¿™æ ·ï¼Œå®ƒè¿˜æœ‰ä¸€ä¸ªå¥½å¤„å°±æ˜¯è®©é¡¹ç›®æ›´åŠ å®‰å…¨ é…ç½®ç»§æ‰¿ï¼š ç»§æ‰¿è‚¯å®šæ˜¯ä¸€ä¸ªçˆ¶å­ç»“æ„ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨aggregatorä¸­æ¥åˆ›å»ºä¸€ä¸ªparent project ä½¿ç”¨ æ ‡ç­¾ : ä½œä¸ºçˆ¶æ¨¡å—çš„POMï¼Œå…¶æ‰“åŒ…ç±»å‹ä¹Ÿå¿…é¡»ä¸ºPOMç»“æ„ï¼šçˆ¶æ¨¡å—åªæ˜¯ä¸ºäº†å¸®åŠ©æˆ‘ä»¬æ¶ˆé™¤é‡å¤ï¼Œæ‰€ä»¥å®ƒä¹Ÿä¸éœ€è¦src&#x2F;main&#x2F;javaã€src&#x2F;test&#x2F;javaç­‰ç›®å½• æ–°çš„å…ƒç´ ï¼š ï¼Œ å®ƒæ˜¯è¢«ç”¨åœ¨å­æ¨¡å—ä¸­çš„å…ƒç´ çš„å±æ€§ï¼š: è¡¨ç¤ºçˆ¶æ¨¡å—POMçš„ç›¸å¯¹è·¯å¾„ï¼Œåœ¨æ„å»ºçš„æ—¶å€™ï¼ŒMavenä¼šå…ˆæ ¹æ®relativePathæ£€æŸ¥çˆ¶POMï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œå†ä»æœ¬åœ°ä»“åº“æŸ¥æ‰¾ æŒ‡å®šå»é‚£é‡Œå¯»æ‰¾ çˆ¶pom.xml relativePathçš„é»˜è®¤å€¼ï¼š ..&#x2F;pom.xml å­æ¨¡å—çœç•¥groupIdå’Œversionï¼š ä½¿ç”¨äº†ç»§æ‰¿çš„å­æ¨¡å—ä¸­å¯ä»¥ä¸å£°æ˜groupIdå’Œversion, å­æ¨¡å—å°†éšå¼çš„ç»§æ‰¿çˆ¶æ¨¡å—çš„è¿™ä¸¤ä¸ªå…ƒç´  ç»§æ‰¿çš„POMå…ƒç´  groupId:é¡¹ç›®ç»„ID,é¡¹ç›®åæ ‡çš„æ ¸å¿ƒå…ƒç´  version: é¡¹ç›®ç‰ˆæœ¬, é¡¹ç›®åæ ‡çš„æ ¸å¿ƒå…ƒç´  description: é¡¹ç›®çš„æè¿°ä¿¡æ¯ organization: é¡¹ç›®çš„ç»„ç»‡ä¿¡æ¯ inceptionYear: é¡¹ç›®çš„åˆ›å§‹å¹´ä»½ url: é¡¹ç›®çš„URLåœ°å€ developers: é¡¹ç›®å¼€å‘è€…ä¿¡æ¯ contributors: é¡¹ç›®çš„è´¡çŒ®è€…ä¿¡æ¯ distributionManagement: é¡¹ç›®çš„éƒ¨ç½²é…ç½® issueManagement: é¡¹ç›®çš„ç¼ºé™·è·Ÿè¸ªç³»ç»Ÿä¿¡æ¯ ciManagement: é¡¹ç›®çš„æŒç»­é›†æˆç³»ç»Ÿä¿¡æ¯ scm: é¡¹ç›®çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¿¡æ¯ mailingLists: é¡¹ç›®çš„é‚®ä»¶åˆ—è¡¨ä¿¡æ¯ properties: è‡ªå®šä¹‰çš„mavenå±æ€§ dependencies: é¡¹ç›®çš„ä¾èµ–é…ç½® dependencyManagement: é¡¹ç›®çš„ä¾èµ–ç®¡ç†é…ç½® repositories: é¡¹ç›®çš„ä»“åº“é…ç½® build: åŒ…æ‹¬é¡¹ç›®çš„æºç ç›®å½•é…ç½®ã€è¾“å‡ºç›®å½•é…ç½®ã€æ’ä»¶é…ç½®ã€æ’ä»¶ç®¡ç†é…ç½®ç­‰ reporting: åŒ…æ‹¬é¡¹ç›®çš„æŠ¥å‘Šè¾“å‡ºç›®å½•é…ç½®ã€æŠ¥å‘Šæ’ä»¶é…ç½®ç­‰ èšåˆç»§æ‰¿ä¸‹çš„ä¾èµ–ç®¡ç†ä¾èµ–ç»§æ‰¿ç®¡ç†ï¼šdependencyManagement dependencyManagementçš„ç‰¹æ€§ï¼šåœ¨dependencyManagementä¸­é…ç½®çš„å…ƒç´ æ—¢ä¸ä¼šç»™parentå¼•å…¥ä¾èµ–ï¼Œä¹Ÿä¸ä¼šç»™å®ƒçš„å­æ¨¡å—å¼•å…¥ä¾èµ–ï¼Œä»…ä»…æ˜¯å®ƒçš„é…ç½®æ˜¯å¯ç»§æ‰¿çš„ çˆ¶pom é…ç½®ä¾èµ–çš„ç‰ˆæœ¬ å­pom é€‰æ‹©æ€§çš„ç»§æ‰¿ æ’ä»¶ç»§æ‰¿ç®¡ç†ï¼š è¿™ä¸ªå…ƒç´ å’Œç›¸ç±»ä¼¼ï¼Œå®ƒæ˜¯ç”¨æ¥è¿›è¡Œæ’ä»¶ç®¡ç†çš„ã€‚åœ¨æˆ‘ä»¬é¡¹ç›®å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šé¢‘ç¹çš„å¼•å…¥æ’ä»¶ï¼Œæ‰€ä»¥è§£å†³è¿™äº›å¤æ‚é…ç½®çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨æ’ä»¶ç®¡ç† çˆ¶pom é…ç½®æ’ä»¶ä¾èµ– å­pom é€‰æ‹©æ’ä»¶ç»§æ‰¿ èšåˆä¸ç»§æ‰¿çš„æ€»ç»“å½“æˆ‘ä»¬æ˜ç™½èšåˆä¸ç»§æ‰¿çš„ç»†èŠ‚ä¹‹åï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼šå¯¹äºèšåˆæ¨¡å—æ¥è¯´ï¼Œå®ƒçŸ¥é“æœ‰å“ªäº›è¢«èšåˆçš„æ¨¡å—ï¼Œè€Œå¯¹äºè¢«èšåˆçš„æ¨¡å—æ¥è¯´ï¼Œå®ƒä»¬ä¸çŸ¥é“è¢«è°èšåˆäº†ï¼Œä¹Ÿä¸çŸ¥é“å®ƒçš„å­˜åœ¨å¯¹äºç»§æ‰¿å…³ç³»çš„çˆ¶POMæ¥è¯´ï¼Œå®ƒä¸çŸ¥é“è‡ªå·±è¢«å“ªäº›å­æ¨¡å—ç»§æ‰¿äº†ï¼Œå¯¹äºå­POMæ¥è¯´ï¼Œå®ƒå¿…é¡»çŸ¥é“è‡ªå·±çš„çˆ¶POMæ˜¯è°åœ¨ä¸€äº›æœ€ä½³å®è·µä¸­æˆ‘ä»¬ä¼šå‘ç°ï¼šä¸€ä¸ªPOMæ—¢æ˜¯èšåˆPOMï¼Œåˆæ˜¯çˆ¶POMï¼Œè¿™ä¹ˆåšä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿ã€‚","date":"2024-12-31","categories":["java"],"tags":["maven"]},{"title":"maven-å®æˆ˜ç¬”è®°(2)mavenå¸¸ç”¨æ’ä»¶","url":"/2024/12/31/maven-å®æˆ˜ç¬”è®°-2-mavenå¸¸ç”¨æ’ä»¶/","content":"maven å®æˆ˜ç¬”è®° ï¼ˆäºŒï¼‰mavenå¸¸ç”¨æ’ä»¶maven-source-plugin è¿™æ ·åœ¨mvn packageåä¾¿ä¼šåœ¨targetç›®å½•ä¸‹ç”Ÿæˆ*-sources.jaræºç åŒ…ã€‚ maven-javadoc-plugin è¿™æ ·åœ¨mvn packageåä¾¿ä¼šåœ¨targetç›®å½•ä¸‹ç”Ÿæˆ*-javadoc.jaræ–‡æ¡£åŒ…ã€‚ maven-compiler-pluginæŒ‡å®šJDKç‰ˆæœ¬å’Œç¼–ç maven 2.1é»˜è®¤ç”¨jdk 1.3æ¥ç¼–è¯‘ï¼Œmaven3 è²Œä¼¼æ˜¯ç”¨jdk 1.5ï¼Œå¦‚æœé¡¹ç›®ç”¨çš„jdk 1.6ä¹Ÿä¼šæœ‰é—®é¢˜ï¼Œcompileræ’ä»¶å¯ä»¥æŒ‡å®šJDKç‰ˆæœ¬ä¸º1.6ã€‚windowsé»˜è®¤ä½¿ç”¨GBKç¼–ç ï¼Œjavaé¡¹ç›®ç»å¸¸ç¼–ç ä¸ºutf8ï¼Œä¹Ÿéœ€è¦åœ¨compileræ’ä»¶ä¸­æŒ‡å‡ºï¼Œå¦åˆ™ä¸­æ–‡ä¹±ç å¯èƒ½ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ã€‚ maven-shade-pluginmvn clean packageåï¼Œtargetä¸‹å¯ä»¥çœ‹åˆ°mvn-test-0.0.1-SNAPSHOT.jarå’Œoriginal-mvn-test-0.0.1-SNAPSHOT.jarä¸¤ä¸ªjaråŒ…ï¼Œå‰è€…æ˜¯å¸¦æœ‰ä¾èµ–åŒ…(ä¼šè§£å‹)å’ŒMain-Classä¿¡æ¯çš„å¯è¿è¡ŒjaråŒ…ï¼Œåè€…æ˜¯åŸå§‹çš„jaråŒ…(ä¸åŒ…å«ä¾èµ–åŠMain-Classä¿¡æ¯)ã€‚æ‰“å¼€mvn-test-0.0.1-SNAPSHOT.jar&#x2F;META-INF&#x2F;MANIFEST.MFå¯çœ‹åˆ°Main-Class: com.adu.mvn_test.HelloWorldä¿¡æ¯ã€‚å¯è¿è¡ŒjaråŒ…çš„æ‰§è¡Œï¼š$java -jar mvn-test-0.0.1-SNAPSHOT.jar æˆ–è€…ç›´æ¥åŒå‡»ã€‚","date":"2024-12-31","categories":["java"],"tags":["maven"]},{"title":"mybatis-æ·±å…¥ç†è§£mybatis(1)åŸºç¡€é…ç½®","url":"/2024/12/31/mybatis-æ·±å…¥ç†è§£mybatis-1-åŸºç¡€é…ç½®/","content":"title: æ·±å…¥ç†è§£mybatis(ä¸€) åŸºç¡€é…ç½®date: 2018-10-09 15:48:08updated: 2018-10-09 15:48:08tags: - mybatis - ormcategories:- æ•°æ®åº“- ormæ¡†æ¶- mybatisæ·±å…¥ç†è§£mybatis(ä¸€) åŸºç¡€é…ç½®MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå®ƒæ”¯æŒå®šåˆ¶åŒ– SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis é¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°ä»¥åŠè·å–ç»“æœé›†ã€‚MyBatis å¯ä»¥ä½¿ç”¨ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°†æ¥å£å’Œ Java çš„ POJOs(Plain Old Java Objects,æ™®é€šçš„ Javaå¯¹è±¡)æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ã€‚ mybatisåŸºç¡€é…ç½®å’Œä½¿ç”¨ ç›¸å…³æ ‡ç­¾æ³¨æ„äº‹é¡¹typeAliases åˆ«åé…ç½®å¼•ç”³å¦‚æœä½¿ç”¨packageçš„æ ‡ç­¾çš„æ—¶å€™å°†ä¼šä½¿ç”¨å°†ç±»åé¦–å­—æ¯å°å†™å’Œå¯¹åº”çš„å¯¹è±¡å®Œæ•´ç±»åæ˜ å°„ï¼Œå¯ä»¥é€šè¿‡@Alias(name) æ³¨è§£æ¥æ›´æ”¹æ˜ å°„çš„è§„åˆ™ propertiesæ ‡ç­¾é™¤äº†ä½¿ç”¨xmlè¿›è¡Œç›¸å…³å±æ€§é…ç½®ï¼Œè¿˜å¯ä»¥ä½¿ç”¨java apiçš„å½¢å¼å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹æ³•è¿›è¡Œé…ç½® ä½¿ç”¨javaä»£ç åŠ¨æ€çš„å¯¼å…¥å±æ€§ å¦‚æœå±æ€§åœ¨ä¸åªä¸€ä¸ªåœ°æ–¹è¿›è¡Œäº†é…ç½®ï¼Œé‚£ä¹ˆ MyBatis å°†æŒ‰ç…§ä¸‹é¢çš„é¡ºåºæ¥åŠ è½½ï¼š åœ¨ properties å…ƒç´ ä½“å†…æŒ‡å®šçš„å±æ€§é¦–å…ˆè¢«è¯»å–ã€‚ ç„¶åæ ¹æ® properties å…ƒç´ ä¸­çš„ resource å±æ€§è¯»å–ç±»è·¯å¾„ä¸‹å±æ€§æ–‡ä»¶æˆ–æ ¹æ® url å±æ€§æŒ‡å®šçš„è·¯å¾„è¯»å–å±æ€§æ–‡ä»¶ï¼Œå¹¶è¦†ç›–å·²è¯»å–çš„åŒåå±æ€§ã€‚ æœ€åè¯»å–ä½œä¸ºæ–¹æ³•å‚æ•°ä¼ é€’çš„å±æ€§ï¼Œå¹¶è¦†ç›–å·²è¯»å–çš„åŒåå±æ€§ã€‚ å› æ­¤ï¼Œé€šè¿‡æ–¹æ³•å‚æ•°ä¼ é€’çš„å±æ€§å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§ï¼Œresource&#x2F;url å±æ€§ä¸­æŒ‡å®šçš„é…ç½®æ–‡ä»¶æ¬¡ä¹‹ï¼Œæœ€ä½ä¼˜å…ˆçº§çš„æ˜¯ properties å±æ€§ä¸­æŒ‡å®šçš„å±æ€§ã€‚ ä½¿ç”¨è¾“å…¥æµè¿›è¡Œæ„å»º typeHandlers-é‡å†™ç±»å‹å¤„ç†å™¨æˆ–åˆ›å»ºä½ è‡ªå·±çš„ç±»å‹å¤„ç†å™¨æ¥å¤„ç†ä¸æ”¯æŒçš„æˆ–éæ ‡å‡†çš„ç±»å‹å…·ä½“åšæ³•ä¸ºï¼šå®ç° org.apache.ibatis.type.TypeHandler æ¥å£ï¼Œ æˆ–ç»§æ‰¿ä¸€ä¸ªå¾ˆä¾¿åˆ©çš„ç±» org.apache.ibatis.type.BaseTypeHandlerï¼Œ ç„¶åå¯ä»¥é€‰æ‹©æ€§åœ°å°†å®ƒæ˜ å°„åˆ°ä¸€ä¸ª JDBC ç±»å‹ã€‚ mybatisåœ¨ä½¿ç”¨è‡ªå®šä¹‰çš„typeçš„æ—¶å€™ï¼Œéœ€è¦åœ¨ç»“æœå±æ€§ï¼ˆresultMapä¸­çš„propertyæˆ–è€…idå±æ€§ä¸­ï¼‰ä½¿ç”¨javatypeå’ŒJDBCtypeå±æ€§è¿›è¡Œç›¸å…³è”ï¼Œæˆ–è€…ç›´æ¥æŒ‡å®štypehandler æšä¸¾ç±»å‹çš„ç‰¹æ®Šå¤„ç†è‹¥æƒ³æ˜ å°„æšä¸¾ç±»å‹ Enumï¼Œåˆ™éœ€è¦ä» EnumTypeHandler æˆ–è€… EnumOrdinalTypeHandler ä¸­é€‰ä¸€ä¸ªæ¥ä½¿ç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒMyBatis ä¼šåˆ©ç”¨ EnumTypeHandler æ¥æŠŠ Enum å€¼è½¬æ¢æˆå¯¹åº”çš„åå­—ã€‚ æ³¨æ„ EnumTypeHandler åœ¨æŸç§æ„ä¹‰ä¸Šæ¥è¯´æ˜¯æ¯”è¾ƒç‰¹åˆ«çš„ï¼Œå…¶ä»–çš„å¤„ç†å™¨åªé’ˆå¯¹æŸä¸ªç‰¹å®šçš„ç±»ï¼Œè€Œå®ƒä¸åŒï¼Œå®ƒä¼šå¤„ç†ä»»æ„ç»§æ‰¿äº† Enum çš„ç±»ã€‚ è‡ªåŠ¨æ˜ å°„å™¨ï¼ˆauto-mapperï¼‰ä¼šè‡ªåŠ¨åœ°é€‰ç”¨ EnumOrdinalTypeHandler æ¥å¤„ç†ï¼Œ æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³ç”¨æ™®é€šçš„ EnumTypeHandlerï¼Œå°±å¿…é¡»è¦æ˜¾å¼åœ°ä¸ºé‚£äº› SQL è¯­å¥è®¾ç½®è¦ä½¿ç”¨çš„ç±»å‹å¤„ç†å™¨ã€‚ objectFactory-è¦†ç›–å¯¹è±¡å·¥å‚çš„é»˜è®¤è¡Œä¸ºï¼Œåˆ›å»ºè‡ªå·±çš„å¯¹è±¡å·¥å‚ã€‚MyBatis æ¯æ¬¡åˆ›å»ºç»“æœå¯¹è±¡çš„æ–°å®ä¾‹æ—¶ï¼Œå®ƒéƒ½ä¼šä½¿ç”¨ä¸€ä¸ªå¯¹è±¡å·¥å‚ï¼ˆObjectFactoryï¼‰å®ä¾‹æ¥å®Œæˆã€‚ plugins-MyBatis å…è®¸ä½ åœ¨å·²æ˜ å°„è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­çš„æŸä¸€ç‚¹è¿›è¡Œæ‹¦æˆªè°ƒç”¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒMyBatis å…è®¸ä½¿ç”¨æ’ä»¶æ¥æ‹¦æˆªçš„æ–¹æ³•è°ƒç”¨åŒ…æ‹¬ï¼ˆæ ¼å¼ï¼šç±»åç§°ï¼ˆç±»ä¸‹çš„æ–¹æ³•ï¼‰ï¼‰ï¼š Executor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed) ParameterHandler (getParameterObject, setParameters) ResultSetHandler (handleResultSets, handleOutputParameters) StatementHandler (prepare, parameterize, batch, update, query) é€šè¿‡ MyBatis æä¾›çš„å¼ºå¤§æœºåˆ¶ï¼Œä½¿ç”¨æ’ä»¶æ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€å®ç° Interceptor æ¥å£ï¼Œå¹¶æŒ‡å®šäº†æƒ³è¦æ‹¦æˆªçš„æ–¹æ³•ç­¾åå³å¯ ä¸‹é¢çš„æ’ä»¶å°†ä¼šæ‹¦æˆªåœ¨ Executor å®ä¾‹ä¸­æ‰€æœ‰çš„ â€œupdateâ€ æ–¹æ³•è°ƒç”¨ï¼Œ è¿™é‡Œçš„ Executor æ˜¯è´Ÿè´£æ‰§è¡Œä½å±‚æ˜ å°„è¯­å¥çš„å†…éƒ¨å¯¹è±¡ã€‚æ³¨æ„@Interceptsæ³¨è§£ environments-MyBatiså¯ä»¥é€šè¿‡è¿™ä¸ªé…ç½®é¡¹é…ç½®æˆé€‚åº”å¤šç§ç¯å¢ƒè¿™ç§æœºåˆ¶æœ‰åŠ©äºå°† SQL æ˜ å°„åº”ç”¨äºå¤šç§æ•°æ®åº“ä¹‹ä¸­ï¼Œ ç°å®æƒ…å†µä¸‹æœ‰å¤šç§ç†ç”±éœ€è¦è¿™ä¹ˆåšã€‚ä¾‹å¦‚ï¼Œå¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒéœ€è¦æœ‰ä¸åŒçš„é…ç½®ï¼›æˆ–è€…å…±äº«ç›¸åŒ Schema çš„å¤šä¸ªç”Ÿäº§æ•°æ®åº“ï¼Œ æƒ³ä½¿ç”¨ç›¸åŒçš„ SQL æ˜ å°„ã€‚è®¸å¤šç±»ä¼¼çš„ç”¨ä¾‹ã€‚ ä¸è¿‡è¦è®°ä½ï¼šå°½ç®¡å¯ä»¥é…ç½®å¤šä¸ªç¯å¢ƒï¼Œæ¯ä¸ª SqlSessionFactory å®ä¾‹åªèƒ½é€‰æ‹©å…¶ä¸€ã€‚ä¸ºäº†æŒ‡å®šåˆ›å»ºå“ªç§ç¯å¢ƒï¼Œåªè¦å°†å®ƒä½œä¸ºå¯é€‰çš„å‚æ•°ä¼ é€’ç»™ SqlSessionFactoryBuilder å³å¯ åœ¨ç¯å¢ƒé…ç½®ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„é…ç½®ä¸€ä¸ªæ˜¯äº‹åŠ¡ç®¡ç†å™¨transactionManagerï¼Œå¦ä¸€ä¸ªæ˜¯æ•°æ®æºdataSource ï¼ˆå…·ä½“çš„é…ç½®ä¿¡æ¯å¯ä»¥å‚è€ƒä¹‹å‰ä½¿ç”¨çš„xml é…ç½®æ–¹æ³•ï¼‰ transactionManageräº‹åŠ¡ç®¡ç†å™¨ ä»»ä½•åœ¨ XML ä¸­é…ç½®çš„å±æ€§åœ¨å®ä¾‹åŒ–ä¹‹åå°†ä¼šè¢«ä¼ é€’ç»™ setProperties() æ–¹æ³•ã€‚ä½ ä¹Ÿéœ€è¦åˆ›å»ºä¸€ä¸ª Transaction æ¥å£çš„å®ç°ç±»ï¼Œè¿™ä¸ªæ¥å£ä¹Ÿå¾ˆç®€å•ï¼š databaseIdProviderMyBatis å¯ä»¥æ ¹æ®ä¸åŒçš„æ•°æ®åº“å‚å•†æ‰§è¡Œä¸åŒçš„è¯­å¥ï¼Œè¿™ç§å¤šå‚å•†çš„æ”¯æŒæ˜¯åŸºäºæ˜ å°„è¯­å¥ä¸­çš„ databaseId å±æ€§ã€‚ MyBatis ä¼šåŠ è½½ä¸å¸¦ databaseId å±æ€§å’Œå¸¦æœ‰åŒ¹é…å½“å‰æ•°æ®åº“ databaseId å±æ€§çš„æ‰€æœ‰è¯­å¥ã€‚ å¦‚æœåŒæ—¶æ‰¾åˆ°å¸¦æœ‰ databaseId å’Œä¸å¸¦ databaseId çš„ç›¸åŒè¯­å¥ï¼Œåˆ™åè€…ä¼šè¢«èˆå¼ƒã€‚ mappersè¡¨ç¤ºæ˜ å°„å™¨æ³¨æ„ï¼šä¸€ä¸ªconfigæ–‡ä»¶å¯ä»¥å¯¼å…¥å¤šä¸ªé…ç½®æ–‡ä»¶ å¯ä»¥ä½¿ç”¨urlåœ°å€æˆ–è€…resource å¼•å…¥é…ç½®æ–‡ä»¶æˆ–è€… ä½¿ç”¨åŒ…åç§°æˆ–è€…classæ–‡ä»¶","date":"2024-12-31","categories":["java"],"tags":["mybatis"]},{"title":"mybatis-æ·±å…¥ç†è§£mybatis(2)æ˜ å°„æ–‡ä»¶","url":"/2024/12/31/mybatis-æ·±å…¥ç†è§£mybatis-2-æ˜ å°„æ–‡ä»¶/","content":"æ·±å…¥ç†è§£mybatisï¼ˆäºŒï¼‰æ˜ å°„æ–‡ä»¶MyBatis çš„çœŸæ­£å¼ºå¤§åœ¨äºå®ƒçš„æ˜ å°„è¯­å¥ï¼Œä¹Ÿæ˜¯å®ƒçš„é­”åŠ›æ‰€åœ¨ã€‚ç”±äºå®ƒçš„å¼‚å¸¸å¼ºå¤§ï¼Œæ˜ å°„å™¨çš„ XML æ–‡ä»¶å°±æ˜¾å¾—ç›¸å¯¹ç®€å•ã€‚å¦‚æœæ‹¿å®ƒè·Ÿå…·æœ‰ç›¸åŒåŠŸèƒ½çš„ JDBC ä»£ç è¿›è¡Œå¯¹æ¯”ï¼Œä½ ä¼šç«‹å³å‘ç°çœæ‰äº†å°†è¿‘ 95% çš„ä»£ç ã€‚MyBatis å°±æ˜¯é’ˆå¯¹ SQL æ„å»ºçš„ï¼Œå¹¶ä¸”æ¯”æ™®é€šçš„æ–¹æ³•åšçš„æ›´å¥½ã€‚ é…ç½®æ–‡ä»¶æ€»è§ˆ SQL æ˜ å°„æ–‡ä»¶æœ‰å¾ˆå°‘çš„å‡ ä¸ªé¡¶çº§å…ƒç´ ï¼ˆæŒ‰ç…§å®ƒä»¬åº”è¯¥è¢«å®šä¹‰çš„é¡ºåºï¼‰ï¼š cache â€“ ç»™å®šå‘½åç©ºé—´çš„ç¼“å­˜é…ç½®ã€‚ cache-ref â€“ å…¶ä»–å‘½åç©ºé—´ç¼“å­˜é…ç½®çš„å¼•ç”¨ã€‚ resultMap â€“ æ˜¯æœ€å¤æ‚ä¹Ÿæ˜¯æœ€å¼ºå¤§çš„å…ƒç´ ï¼Œç”¨æ¥æè¿°å¦‚ä½•ä»æ•°æ®åº“ç»“æœé›†ä¸­æ¥åŠ è½½å¯¹è±¡ã€‚ parameterMap â€“ å·²åºŸå¼ƒï¼è€å¼é£æ ¼çš„å‚æ•°æ˜ å°„ã€‚å†…è”å‚æ•°æ˜¯é¦–é€‰,è¿™ä¸ªå…ƒç´ å¯èƒ½åœ¨å°†æ¥è¢«ç§»é™¤ï¼Œè¿™é‡Œä¸ä¼šè®°å½•ã€‚ sql â€“ å¯è¢«å…¶ä»–è¯­å¥å¼•ç”¨çš„å¯é‡ç”¨è¯­å¥å—ã€‚ insert â€“ æ˜ å°„æ’å…¥è¯­å¥ update â€“ æ˜ å°„æ›´æ–°è¯­å¥ delete â€“ æ˜ å°„åˆ é™¤è¯­å¥ select â€“ æ˜ å°„æŸ¥è¯¢è¯­å¥ æ ‡ç­¾ä½¿ç”¨è¯¦è§£select insert update deleteseleteæ ‡ç­¾ç›¸å…³çš„å±æ€§ å‚æ•°å å‚æ•°ä½œç”¨ id åœ¨å‘½åç©ºé—´ä¸­å”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œå¯ä»¥è¢«ç”¨æ¥å¼•ç”¨è¿™æ¡è¯­å¥ã€‚ parameterType å°†ä¼šä¼ å…¥è¿™æ¡è¯­å¥çš„å‚æ•°ç±»çš„å®Œå…¨é™å®šåæˆ–åˆ«åã€‚è¿™ä¸ªå±æ€§æ˜¯å¯é€‰çš„ï¼Œå› ä¸º MyBatis å¯ä»¥é€šè¿‡ TypeHandler æ¨æ–­å‡ºå…·ä½“ä¼ å…¥è¯­å¥çš„å‚æ•°ï¼Œé»˜è®¤å€¼ä¸º unsetã€‚ parameterMap è¿™æ˜¯å¼•ç”¨å¤–éƒ¨ parameterMap çš„å·²ç»è¢«åºŸå¼ƒçš„æ–¹æ³•ã€‚ä½¿ç”¨å†…è”å‚æ•°æ˜ å°„å’Œ parameterType å±æ€§ã€‚ resultType ä»è¿™æ¡è¯­å¥ä¸­è¿”å›çš„æœŸæœ›ç±»å‹çš„ç±»çš„å®Œå…¨é™å®šåæˆ–åˆ«åã€‚æ³¨æ„å¦‚æœæ˜¯é›†åˆæƒ…å½¢ï¼Œé‚£åº”è¯¥æ˜¯é›†åˆå¯ä»¥åŒ…å«çš„ç±»å‹ï¼Œè€Œä¸èƒ½æ˜¯é›†åˆæœ¬èº«ã€‚ä½¿ç”¨ resultType æˆ– resultMapï¼Œä½†ä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚ resultMap å¤–éƒ¨ resultMap çš„å‘½åå¼•ç”¨ã€‚ç»“æœé›†çš„æ˜ å°„æ˜¯ MyBatis æœ€å¼ºå¤§çš„ç‰¹æ€§ï¼Œå¯¹å…¶æœ‰ä¸€ä¸ªå¾ˆå¥½çš„ç†è§£çš„è¯ï¼Œè®¸å¤šå¤æ‚æ˜ å°„çš„æƒ…å½¢éƒ½èƒ½è¿åˆƒè€Œè§£ã€‚ä½¿ç”¨ resultMap æˆ– resultTypeï¼Œä½†ä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚ flushCache å°†å…¶è®¾ç½®ä¸º trueï¼Œä»»ä½•æ—¶å€™åªè¦è¯­å¥è¢«è°ƒç”¨ï¼Œéƒ½ä¼šå¯¼è‡´æœ¬åœ°ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜éƒ½ä¼šè¢«æ¸…ç©ºï¼Œé»˜è®¤å€¼ï¼šfalseã€‚ useCache å°†å…¶è®¾ç½®ä¸º trueï¼Œå°†ä¼šå¯¼è‡´æœ¬æ¡è¯­å¥çš„ç»“æœè¢«äºŒçº§ç¼“å­˜ï¼Œé»˜è®¤å€¼ï¼šå¯¹ select å…ƒç´ ä¸º trueã€‚ timeout è¿™ä¸ªè®¾ç½®æ˜¯åœ¨æŠ›å‡ºå¼‚å¸¸ä¹‹å‰ï¼Œé©±åŠ¨ç¨‹åºç­‰å¾…æ•°æ®åº“è¿”å›è¯·æ±‚ç»“æœçš„ç§’æ•°ã€‚é»˜è®¤å€¼ä¸º unsetï¼ˆä¾èµ–é©±åŠ¨ï¼‰ã€‚ fetchSize è¿™æ˜¯å°è¯•å½±å“é©±åŠ¨ç¨‹åºæ¯æ¬¡æ‰¹é‡è¿”å›çš„ç»“æœè¡Œæ•°å’Œè¿™ä¸ªè®¾ç½®å€¼ç›¸ç­‰ã€‚é»˜è®¤å€¼ä¸º unsetï¼ˆä¾èµ–é©±åŠ¨ï¼‰ã€‚ statementType STATEMENTï¼ŒPREPARED æˆ– CALLABLE çš„ä¸€ä¸ªã€‚è¿™ä¼šè®© MyBatis åˆ†åˆ«ä½¿ç”¨ Statementï¼ŒPreparedStatement æˆ– CallableStatementï¼Œé»˜è®¤å€¼ï¼šPREPAREDã€‚ resultSetType FORWARD_ONLYï¼ŒSCROLL_SENSITIVE æˆ– SCROLL_INSENSITIVE ä¸­çš„ä¸€ä¸ªï¼Œé»˜è®¤å€¼ä¸º unset ï¼ˆä¾èµ–é©±åŠ¨ï¼‰ã€‚ databaseId å¦‚æœé…ç½®äº† databaseIdProviderï¼ŒMyBatis ä¼šåŠ è½½æ‰€æœ‰çš„ä¸å¸¦ databaseId æˆ–åŒ¹é…å½“å‰ databaseIdçš„è¯­å¥ï¼›å¦‚æœå¸¦æˆ–è€…ä¸å¸¦çš„è¯­å¥éƒ½æœ‰ï¼Œåˆ™ä¸å¸¦çš„ä¼šè¢«å¿½ç•¥ã€‚ resultOrdered è¿™ä¸ªè®¾ç½®ä»…é’ˆå¯¹åµŒå¥—ç»“æœ select è¯­å¥é€‚ç”¨ï¼šå¦‚æœä¸º trueï¼Œå°±æ˜¯å‡è®¾åŒ…å«äº†åµŒå¥—ç»“æœé›†æˆ–æ˜¯åˆ†ç»„äº†ï¼Œè¿™æ ·çš„è¯å½“è¿”å›ä¸€ä¸ªä¸»ç»“æœè¡Œçš„æ—¶å€™ï¼Œå°±ä¸ä¼šå‘ç”Ÿæœ‰å¯¹å‰é¢ç»“æœé›†çš„å¼•ç”¨çš„æƒ…å†µã€‚è¿™å°±ä½¿å¾—åœ¨è·å–åµŒå¥—çš„ç»“æœé›†çš„æ—¶å€™ä¸è‡³äºå¯¼è‡´å†…å­˜ä¸å¤Ÿç”¨ã€‚é»˜è®¤å€¼ï¼šfalseã€‚ resultSets è¿™ä¸ªè®¾ç½®ä»…å¯¹å¤šç»“æœé›†çš„æƒ…å†µé€‚ç”¨ï¼Œå®ƒå°†åˆ—å‡ºè¯­å¥æ‰§è¡Œåè¿”å›çš„ç»“æœé›†å¹¶æ¯ä¸ªç»“æœé›†ç»™ä¸€ä¸ªåç§°ï¼Œåç§°æ˜¯é€—å·åˆ†éš”çš„ã€‚ insert update deleteå±æ€§ç›¸å…³æ ‡ç­¾ å‚æ•°å å‚æ•°ä½œç”¨ id å‘½åç©ºé—´ä¸­çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå¯è¢«ç”¨æ¥ä»£è¡¨è¿™æ¡è¯­å¥ã€‚ parameterType å°†è¦ä¼ å…¥è¯­å¥çš„å‚æ•°çš„å®Œå…¨é™å®šç±»åæˆ–åˆ«åã€‚è¿™ä¸ªå±æ€§æ˜¯å¯é€‰çš„ï¼Œå› ä¸º MyBatis å¯ä»¥é€šè¿‡ TypeHandler parameterMap è¿™æ˜¯å¼•ç”¨å¤–éƒ¨ parameterMap çš„å·²ç»è¢«åºŸå¼ƒçš„æ–¹æ³•ã€‚ä½¿ç”¨å†…è”å‚æ•°æ˜ å°„å’Œ parameterType å±æ€§ã€‚ flushCache å°†å…¶è®¾ç½®ä¸º trueï¼Œä»»ä½•æ—¶å€™åªè¦è¯­å¥è¢«è°ƒç”¨ï¼Œéƒ½ä¼šå¯¼è‡´æœ¬åœ°ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜éƒ½ä¼šè¢«æ¸…ç©ºï¼Œé»˜è®¤å€¼ï¼štrueï¼ˆå¯¹åº”æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤è¯­å¥ï¼‰ã€‚ timeout è¿™ä¸ªè®¾ç½®æ˜¯åœ¨æŠ›å‡ºå¼‚å¸¸ä¹‹å‰ï¼Œé©±åŠ¨ç¨‹åºç­‰å¾…æ•°æ®åº“è¿”å›è¯·æ±‚ç»“æœçš„ç§’æ•°ã€‚é»˜è®¤å€¼ä¸º unsetï¼ˆä¾èµ–é©±åŠ¨ï¼‰ã€‚ statementType STATEMENTï¼ŒPREPARED æˆ– CALLABLE çš„ä¸€ä¸ªã€‚è¿™ä¼šè®© MyBatis åˆ†åˆ«ä½¿ç”¨ Statementï¼ŒPreparedStatement æˆ– CallableStatementï¼Œé»˜è®¤å€¼ï¼šPREPAREDã€‚ useGeneratedKeys ï¼ˆä»…å¯¹ insert å’Œ update æœ‰ç”¨ï¼‰è¿™ä¼šä»¤ MyBatis ä½¿ç”¨ JDBC çš„ getGeneratedKeys keyProperty ï¼ˆä»…å¯¹ insert å’Œ update æœ‰ç”¨ï¼‰å”¯ä¸€æ ‡è®°ä¸€ä¸ªå±æ€§ï¼ŒMyBatis ä¼šé€šè¿‡ getGeneratedKeys çš„è¿”å›å€¼æˆ–è€…é€šè¿‡ insert è¯­å¥çš„ selectKey å­å…ƒç´ è®¾ç½®å®ƒçš„é”®å€¼ï¼Œé»˜è®¤ï¼šunsetã€‚å¦‚æœå¸Œæœ›å¾—åˆ°å¤šä¸ªç”Ÿæˆçš„åˆ—ï¼Œä¹Ÿå¯ä»¥æ˜¯é€—å·åˆ†éš”çš„å±æ€§åç§°åˆ—è¡¨ã€‚ keyColumn ï¼ˆä»…å¯¹ insert å’Œ update æœ‰ç”¨ï¼‰é€šè¿‡ç”Ÿæˆçš„é”®å€¼è®¾ç½®è¡¨ä¸­çš„åˆ—åï¼Œè¿™ä¸ªè®¾ç½®ä»…åœ¨æŸäº›æ•°æ®åº“ï¼ˆåƒ PostgreSQLï¼‰æ˜¯å¿…é¡»çš„ï¼Œå½“ä¸»é”®åˆ—ä¸æ˜¯è¡¨ä¸­çš„ç¬¬ä¸€åˆ—çš„æ—¶å€™éœ€è¦è®¾ç½®ã€‚å¦‚æœå¸Œæœ›å¾—åˆ°å¤šä¸ªç”Ÿæˆçš„åˆ—ï¼Œä¹Ÿå¯ä»¥æ˜¯é€—å·åˆ†éš”çš„å±æ€§åç§°åˆ—è¡¨ã€‚ databaseId å¦‚æœé…ç½®äº† databaseIdProviderï¼ŒMyBatis ä¼šåŠ è½½æ‰€æœ‰çš„ä¸å¸¦ databaseId æˆ–åŒ¹é…å½“å‰ databaseId çš„è¯­å¥ï¼›å¦‚æœå¸¦æˆ–è€…ä¸å¸¦çš„è¯­å¥éƒ½æœ‰ï¼Œåˆ™ä¸å¸¦çš„ä¼šè¢«å¿½ç•¥ã€‚ æ³¨æ„ï¼šuseGeneratedKeys keyProperty keyColumn parameterTypeä¸»è¦ç”¨æ¥è¿›è¡Œ è‡ªå¢åŠ ä¸»é”®çš„ å›è°ƒæ“ä½œï¼Œå°±æ˜¯å½“è¿›è¡Œæ’å…¥æ“ä½œçš„ä¹‹åï¼Œè‡ªåŠ¨ç”Ÿæˆçš„ä¸»é”®é‡æ–°æ³¨å…¥åˆ°ä¼ å…¥çš„ parameterTypeå¯¹åº”çš„javabeanä¸­ï¼Œï¼ˆåº•å±‚ä½¿ç”¨jbdcçš„getGeneratedKeysæ–¹æ³•ï¼‰ selectKey å’Œ keyProperty keyColumn ç»“åˆä½¿ç”¨è¿›è¡Œä¸»é”®å›å¡«æ“ä½œåœ¨insert å’Œ update æ ‡ç­¾ä¸­æ‰ä¼šæœ‰ç”¨çš„ä¸€ä¸ªæ ‡ç­¾ ä¼šåœ¨æ‰§è¡Œè¯­å¥ä¹‹å‰å…ˆè¿›è¡Œä¸€æ¬¡æŸ¥è¯¢ï¼Œå¹¶å°†å¾—åˆ°çš„æ•°æ®æ”¾å…¥ keyPropertyå±æ€§æŒ‡å®šåç§°çš„å­—æ®µä¸­ï¼ˆè°ƒç”¨ä¼ å…¥çš„å˜é‡çš„keypropertyæŒ‡å®šåç§°çš„åœ°æ–¹ï¼‰ä½œä¸ºåé¢è¿›è¡Œæ“ä½œçš„æ•°æ®ï¼Œä¸€èˆ¬ç”¨åœ¨ å¯¹äºä¸æ”¯æŒè‡ªåŠ¨ç”Ÿæˆç±»å‹çš„æ•°æ®åº“æˆ–å¯èƒ½ä¸æ”¯æŒè‡ªåŠ¨ç”Ÿæˆä¸»é”® JDBC é©±åŠ¨ï¼Œæ¥ç”Ÿæˆä¸»é”®ã€‚ å‚æ•°å å‚æ•°ä½œç”¨ keyProperty selectKey è¯­å¥ç»“æœåº”è¯¥è¢«è®¾ç½®çš„ç›®æ ‡å±æ€§ã€‚å¦‚æœå¸Œæœ›å¾—åˆ°å¤šä¸ªç”Ÿæˆçš„åˆ—ï¼Œä¹Ÿå¯ä»¥æ˜¯é€—å·åˆ†éš”çš„å±æ€§åç§°åˆ—è¡¨ã€‚ keyColumn åŒ¹é…å±æ€§çš„è¿”å›ç»“æœé›†ä¸­çš„åˆ—åç§°ã€‚å¦‚æœå¸Œæœ›å¾—åˆ°å¤šä¸ªç”Ÿæˆçš„åˆ—ï¼Œä¹Ÿå¯ä»¥æ˜¯é€—å·åˆ†éš”çš„å±æ€§åç§°åˆ—è¡¨ã€‚ æ³¨æ„ Propertyå’ŒColumnä¸€ä¸€å¯¹åº” resultType ç»“æœçš„ç±»å‹ã€‚MyBatis é€šå¸¸å¯ä»¥æ¨ç®—å‡ºæ¥ï¼Œä½†æ˜¯ä¸ºäº†æ›´åŠ ç¡®å®šå†™ä¸Šä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ã€‚MyBatis å…è®¸ä»»ä½•ç®€å•ç±»å‹ç”¨ä½œä¸»é”®çš„ç±»å‹ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²ã€‚å¦‚æœå¸Œæœ›ä½œç”¨äºå¤šä¸ªç”Ÿæˆçš„åˆ—ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä¸€ä¸ªåŒ…å«æœŸæœ›å±æ€§çš„ Object æˆ–ä¸€ä¸ª Mapã€‚ order è¿™å¯ä»¥è¢«è®¾ç½®ä¸º BEFORE æˆ– AFTERã€‚å¦‚æœè®¾ç½®ä¸º BEFOREï¼Œé‚£ä¹ˆå®ƒä¼šé¦–å…ˆé€‰æ‹©ä¸»é”®ï¼Œè®¾ç½® keyProperty ç„¶åæ‰§è¡Œæ’å…¥è¯­å¥ã€‚å¦‚æœè®¾ç½®ä¸º AFTERï¼Œé‚£ä¹ˆå…ˆæ‰§è¡Œæ’å…¥è¯­å¥ï¼Œç„¶åæ˜¯ selectKey å…ƒç´  â€“ è¿™å’Œåƒ Oracle çš„æ•°æ®åº“ç›¸ä¼¼ï¼Œåœ¨æ’å…¥è¯­å¥å†…éƒ¨å¯èƒ½æœ‰åµŒå…¥ç´¢å¼•è°ƒç”¨ã€‚ statementType ä¸å‰é¢ç›¸åŒï¼ŒMyBatis æ”¯æŒ STATEMENTï¼ŒPREPARED å’Œ CALLABLE è¯­å¥çš„æ˜ å°„ç±»å‹ï¼Œåˆ†åˆ«ä»£è¡¨ PreparedStatement å’Œ CallableStatement ç±»å‹ã€‚ sqlæ ‡ç­¾å’Œinclude æ ‡ç­¾sqlå’Œinclude æ ‡ç­¾ä¸€èˆ¬è¿›è¡Œç»„åˆä½¿ç”¨ï¼Œå½¢æˆå„ç§å‚æ•°åŒ–é…ç½® ç»“æœé›†æ˜ å°„æ–¹æ³•æŸ¥è¯¢è¯­å¥ ç»“æœé›† resultmapæ ‡ç­¾ è¡¨ç¤ºä¸€ä¸ªæ˜ å°„ç»“æœé›† ç›¸å…³å±æ€§ï¼š å‚æ•°å å‚æ•°ä½œç”¨ id å½“å‰å‘½åç©ºé—´ä¸­çš„ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œç”¨äºæ ‡è¯†ä¸€ä¸ªresult map. type ç±»çš„å…¨é™å®šå, æˆ–è€…ä¸€ä¸ªç±»å‹åˆ«å (å†…ç½®çš„åˆ«åå¯ä»¥å‚è€ƒä¸Šé¢çš„è¡¨æ ¼). autoMapping å¦‚æœè®¾ç½®è¿™ä¸ªå±æ€§ï¼ŒMyBatiså°†ä¼šä¸ºè¿™ä¸ªResultMapå¼€å¯æˆ–è€…å…³é—­è‡ªåŠ¨æ˜ å°„ã€‚è¿™ä¸ªå±æ€§ä¼šè¦†ç›–å…¨å±€çš„å±æ€§autoMappingBehaviorã€‚é»˜è®¤å€¼ä¸ºï¼šunsetã€‚ resultmapæ ‡ç­¾å­æ ‡ç­¾id&resultè®¾ç½®å¯¹åº”ç»“æœé›†ä¸­ç±»çš„å„ç§å‚æ•°ï¼Œæ³¨æ„è¦æœ‰setæ–¹æ³•ï¼ŒåŒºåˆ« id è¡¨ç¤ºçš„æ ‡è¯†å±æ€§ï¼ˆä¸€èˆ¬å°±æ˜¯è¡¨çš„ä¸»é”®ï¼‰ ç›¸å…³å±æ€§ å‚æ•°å å‚æ•°ä½œç”¨ property æ˜ å°„åˆ°åˆ—ç»“æœçš„å­—æ®µæˆ–å±æ€§ã€‚å¦‚æœåŒ¹é…çš„æ˜¯å­˜åœ¨çš„,å’Œç»™å®šåç§°ç›¸åŒ çš„ JavaBeans çš„å±æ€§,é‚£ä¹ˆå°±ä¼šä½¿ç”¨ã€‚å¦åˆ™ MyBatis å°†ä¼šå¯»æ‰¾ç»™å®šåç§° property çš„å­—æ®µã€‚è¿™ä¸¤ç§æƒ…å½¢ä½ å¯ä»¥ä½¿ç”¨é€šå¸¸ç‚¹å¼çš„å¤æ‚å±æ€§å¯¼èˆªã€‚æ¯”å¦‚,ä½  å¯ä»¥è¿™æ ·æ˜ å°„ä¸€äº›ä¸œè¥¿: â€œusernameâ€ ,æˆ–è€…æ˜ å°„åˆ°ä¸€äº›å¤æ‚çš„ä¸œè¥¿: â€œaddress.street.numberâ€ ã€‚ column ä»æ•°æ®åº“ä¸­å¾—åˆ°çš„åˆ—å,æˆ–è€…æ˜¯åˆ—åçš„é‡å‘½åæ ‡ç­¾ã€‚è¿™ä¹Ÿæ˜¯é€šå¸¸å’Œä¼š ä¼ é€’ç»™ resultSet.getString(columnName)æ–¹æ³•å‚æ•°ä¸­ç›¸åŒçš„å­—ç¬¦ä¸²ã€‚ javaType ä¸€ä¸ª Java ç±»çš„å®Œå…¨é™å®šå,æˆ–ä¸€ä¸ªç±»å‹åˆ«å(å‚è€ƒä¸Šé¢å†…å»ºç±»å‹åˆ«å çš„åˆ—è¡¨) ã€‚å¦‚æœä½ æ˜ å°„åˆ°ä¸€ä¸ª JavaBean,MyBatis é€šå¸¸å¯ä»¥æ–­å®šç±»å‹ã€‚ ç„¶è€Œ,å¦‚æœä½ æ˜ å°„åˆ°çš„æ˜¯ HashMap,é‚£ä¹ˆä½ åº”è¯¥æ˜ç¡®åœ°æŒ‡å®š javaType æ¥ä¿è¯æ‰€éœ€çš„è¡Œä¸ºã€‚ jdbcType åœ¨è¿™ä¸ªè¡¨æ ¼ä¹‹åçš„æ‰€æ”¯æŒçš„ JDBC ç±»å‹åˆ—è¡¨ä¸­çš„ç±»å‹ã€‚JDBC ç±»å‹æ˜¯ä»… ä»…éœ€è¦å¯¹æ’å…¥,æ›´æ–°å’Œåˆ é™¤æ“ä½œå¯èƒ½ä¸ºç©ºçš„åˆ—è¿›è¡Œå¤„ç†ã€‚è¿™æ˜¯ JDBC jdbcType çš„éœ€è¦,è€Œä¸æ˜¯ MyBatis çš„ã€‚å¦‚æœä½ ç›´æ¥ä½¿ç”¨ JDBC ç¼–ç¨‹,ä½ éœ€è¦æŒ‡å®š è¿™ä¸ªç±»å‹-ä½†ä»…ä»…å¯¹å¯èƒ½ä¸ºç©ºçš„å€¼ã€‚ typeHandler æˆ‘ä»¬åœ¨å‰é¢è®¨è®ºè¿‡é»˜è®¤çš„ç±»å‹å¤„ç†å™¨ã€‚ä½¿ç”¨è¿™ä¸ªå±æ€§,ä½ å¯ä»¥è¦†ç›–é»˜ è®¤çš„ç±»å‹å¤„ç†å™¨ã€‚è¿™ä¸ªå±æ€§å€¼æ˜¯ç±»çš„å®Œå…¨é™å®šåæˆ–è€…æ˜¯ä¸€ä¸ªç±»å‹å¤„ç† å™¨çš„å®ç°,æˆ–è€…æ˜¯ç±»å‹åˆ«åã€‚ constructoræ ‡ç­¾constructoræ ‡ç­¾ ä½¿ç”¨æ„é€ æ–¹æ³•è¿›è¡Œæ³¨å…¥ï¼Œæ³¨æ„å¿…é¡»æä¾›ç›¸å¯¹åº”çš„æ„é€ æ–¹æ³•ï¼Œå‚æ•°çš„ä¹¦å†™é¡ºåºå’Œæ„é€ å‡½æ•°çš„é¡ºåºç›¸åŒï¼ˆ3.4.3èµ·å¯ä»¥ä¸åŒä½†æ˜¯è¦å¯¹æ„é€ å‡½æ•°æ·»åŠ @Paramæ³¨è§£ï¼Œå’Œå¯ç”¨useActualParamnameï¼‰ ç›¸å…³å±æ€§ å‚æ•°å å‚æ•°ä½œç”¨ column æ¥è‡ªæ•°æ®åº“çš„ç±»å,æˆ–é‡å‘½åçš„åˆ—æ ‡ç­¾ã€‚è¿™å’Œé€šå¸¸ä¼ é€’ç»™ resultSet.getString(columnName)æ–¹æ³•çš„å­—ç¬¦ä¸²æ˜¯ç›¸åŒçš„ã€‚ javaType ä¸€ä¸ªJava ç±»çš„å®Œå…¨é™å®šå,æˆ–ä¸€ä¸ªç±»å‹åˆ«å(å‚è€ƒä¸Šé¢å†…å»ºç±»å‹åˆ«åçš„åˆ—è¡¨)ã€‚å¦‚æœä½ æ˜ å°„åˆ°ä¸€ä¸ª JavaBean,MyBatis é€šå¸¸å¯ä»¥æ–­å®šç±»å‹ã€‚ç„¶è€Œ,å¦‚ æœä½ æ˜ å°„åˆ°çš„æ˜¯ HashMap,é‚£ä¹ˆä½ åº”è¯¥æ˜ç¡®åœ°æŒ‡å®š javaType æ¥ä¿è¯æ‰€éœ€çš„ è¡Œä¸ºã€‚ jdbcType åœ¨è¿™ä¸ªè¡¨æ ¼ä¹‹å‰çš„æ‰€æ”¯æŒçš„ JDBC ç±»å‹åˆ—è¡¨ä¸­çš„ç±»å‹ã€‚JDBC ç±»å‹æ˜¯ä»…ä»… éœ€è¦å¯¹æ’å…¥, æ›´æ–°å’Œåˆ é™¤æ“ä½œå¯èƒ½ä¸ºç©ºçš„åˆ—è¿›è¡Œå¤„ç†ã€‚è¿™æ˜¯ JDBC çš„éœ€è¦, jdbcType è€Œä¸æ˜¯ MyBatis çš„ã€‚å¦‚æœä½ ç›´æ¥ä½¿ç”¨ JDBC ç¼–ç¨‹,ä½ éœ€è¦æŒ‡å®šè¿™ä¸ªç±»å‹-ä½† ä»…ä»…å¯¹å¯èƒ½ä¸ºç©ºçš„å€¼ã€‚ typeHandler æˆ‘ä»¬åœ¨å‰é¢è®¨è®ºè¿‡é»˜è®¤çš„ç±»å‹å¤„ç†å™¨ã€‚ä½¿ç”¨è¿™ä¸ªå±æ€§,ä½ å¯ä»¥è¦†ç›–é»˜è®¤çš„ ç±»å‹å¤„ç†å™¨ã€‚è¿™ä¸ªå±æ€§å€¼æ˜¯ç±»çš„å®Œå…¨é™å®šåæˆ–è€…æ˜¯ä¸€ä¸ªç±»å‹å¤„ç†å™¨çš„å®ç°, æˆ–è€…æ˜¯ç±»å‹åˆ«åã€‚ select ç”¨äºåŠ è½½å¤æ‚ç±»å‹å±æ€§çš„æ˜ å°„è¯­å¥çš„ID,ä»columnä¸­æ£€ç´¢å‡ºæ¥çš„æ•°æ®ï¼Œå°†ä½œä¸ºæ­¤selectè¯­å¥çš„å‚æ•°ã€‚å…·ä½“è¯·å‚è€ƒAssociationæ ‡ç­¾ã€‚ resultMap ResultMapçš„IDï¼Œå¯ä»¥å°†åµŒå¥—çš„ç»“æœé›†æ˜ å°„åˆ°ä¸€ä¸ªåˆé€‚çš„å¯¹è±¡æ ‘ä¸­ï¼ŒåŠŸèƒ½å’Œselectå±æ€§ç›¸ä¼¼ï¼Œå®ƒå¯ä»¥å®ç°å°†å¤šè¡¨è¿æ¥æ“ä½œçš„ç»“æœæ˜ å°„æˆä¸€ä¸ªå•ä¸€çš„ResultSetã€‚è¿™æ ·çš„ResultSetå°†ä¼šå°†åŒ…å«é‡å¤æˆ–éƒ¨åˆ†æ•°æ®é‡å¤çš„ç»“æœé›†æ­£ç¡®çš„æ˜ å°„åˆ°åµŒå¥—çš„å¯¹è±¡æ ‘ä¸­ã€‚ä¸ºäº†å®ç°å®ƒ, MyBatiså…è®¸ä½  â€œä¸²è”â€ ResultMap,ä»¥ä¾¿è§£å†³åµŒå¥—ç»“æœé›†çš„é—®é¢˜ã€‚æƒ³äº†è§£æ›´å¤šå†…å®¹ï¼Œè¯·å‚è€ƒä¸‹é¢çš„Associationå…ƒç´ ã€‚ name æ„é€ æ–¹æ³•å½¢å‚çš„åå­—ã€‚é€šè¿‡æŒ‡å®šå…·ä½“çš„åå­—ä½ å¯ä»¥ä»¥ä»»æ„é¡ºåºå†™å…¥argå…ƒç´ ã€‚å‚çœ‹ä¸Šé¢çš„è§£é‡Šã€‚ä»3.4.3ç‰ˆæœ¬èµ·ã€‚ cache-äºŒçº§ç¼“å­˜é»˜è®¤æƒ…å†µä¸‹åªæ˜¯é»˜è®¤å¼€å¯äº†ä¸€çº§ç¼“å­˜ï¼Œä¹Ÿå°±æ˜¯å¯¹åŒä¸€ä¸ªsqlsessionç¼“å­˜ç›¸å…³çš„å„ç§æ•°æ®ï¼Œå¼€èµ·äºŒçº§ç¼“å­˜å°†ä¼šåœ¨sqlsessionFactoryçº§åˆ«è¿›è¡Œç¼“å­˜ï¼Œç¼“å­˜çš„æ•°æ®æ‰€æœ‰çš„sqlsessionå…±äº« å‚æ•°å å‚æ•°ä½œç”¨ eviction å›æ”¶ç­–ç•¥ï¼ŒLRU â€“ æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„:ç§»é™¤æœ€é•¿æ—¶é—´ä¸è¢«ä½¿ç”¨çš„å¯¹è±¡ã€‚ FIFO â€“ å…ˆè¿›å…ˆå‡º:æŒ‰å¯¹è±¡è¿›å…¥ç¼“å­˜çš„é¡ºåºæ¥ç§»é™¤å®ƒä»¬ã€‚ SOFT â€“ è½¯å¼•ç”¨:ç§»é™¤åŸºäºåƒåœ¾å›æ”¶å™¨çŠ¶æ€å’Œè½¯å¼•ç”¨è§„åˆ™çš„å¯¹è±¡ã€‚WEAK â€“ å¼±å¼•ç”¨:æ›´ç§¯æåœ°ç§»é™¤åŸºäºåƒåœ¾æ”¶é›†å™¨çŠ¶æ€å’Œå¼±å¼•ç”¨è§„åˆ™çš„å¯¹è±¡ã€‚ flushInterval(åˆ·æ–°é—´éš”) å¯ä»¥è¢«è®¾ç½®ä¸ºä»»æ„çš„æ­£æ•´æ•°,è€Œä¸”å®ƒä»¬ä»£è¡¨ä¸€ä¸ªåˆç†çš„æ¯«ç§’ å½¢å¼çš„æ—¶é—´æ®µã€‚é»˜è®¤æƒ…å†µæ˜¯ä¸è®¾ç½®,ä¹Ÿå°±æ˜¯æ²¡æœ‰åˆ·æ–°é—´éš”,ç¼“å­˜ä»…ä»…è°ƒç”¨è¯­å¥æ—¶åˆ·æ–°ã€‚ size(å¼•ç”¨æ•°ç›®) å¯ä»¥è¢«è®¾ç½®ä¸ºä»»æ„æ­£æ•´æ•°,è¦è®°ä½ä½ ç¼“å­˜çš„å¯¹è±¡æ•°ç›®å’Œä½ è¿è¡Œç¯å¢ƒçš„ å¯ç”¨å†…å­˜èµ„æºæ•°ç›®ã€‚é»˜è®¤å€¼æ˜¯ 1024 readOnly(åªè¯») å±æ€§å¯ä»¥è¢«è®¾ç½®ä¸º true æˆ– falseã€‚åªè¯»çš„ç¼“å­˜ä¼šç»™æ‰€æœ‰è°ƒç”¨è€…è¿”å›ç¼“ å­˜å¯¹è±¡çš„ç›¸åŒå®ä¾‹ã€‚å› æ­¤è¿™äº›å¯¹è±¡ä¸èƒ½è¢«ä¿®æ”¹ã€‚è¿™æä¾›äº†å¾ˆé‡è¦çš„æ€§èƒ½ä¼˜åŠ¿ã€‚å¯è¯»å†™çš„ç¼“å­˜ ä¼šè¿”å›ç¼“å­˜å¯¹è±¡çš„æ‹·è´(é€šè¿‡åºåˆ—åŒ–) ã€‚è¿™ä¼šæ…¢ä¸€äº›,ä½†æ˜¯å®‰å…¨,å› æ­¤é»˜è®¤æ˜¯ falseã€‚ å¼•ç”³mybatisä½¿ç”¨è‡ªå®šä¹‰ç¼“å­˜é™¤äº†è¿™äº›è‡ªå®šä¹‰ç¼“å­˜çš„æ–¹å¼, ä½ ä¹Ÿå¯ä»¥é€šè¿‡å®ç°ä½ è‡ªå·±çš„ç¼“å­˜æˆ–ä¸ºå…¶ä»–ç¬¬ä¸‰æ–¹ç¼“å­˜æ–¹æ¡ˆ åˆ›å»ºé€‚é…å™¨æ¥å®Œå…¨è¦†ç›–ç¼“å­˜è¡Œä¸ºã€‚ è¿™ä¸ªç¤º ä¾‹å±• ç¤ºäº† å¦‚ä½• ä½¿ç”¨ ä¸€ä¸ª è‡ªå®šä¹‰ çš„ç¼“ å­˜å® ç°ã€‚type å± æ€§æŒ‡ å®šçš„ ç±»å¿… é¡»å®ç° org.mybatis.cache.Cache æ¥å£ã€‚è¿™ä¸ªæ¥å£æ˜¯ MyBatis æ¡†æ¶ä¸­å¾ˆå¤šå¤æ‚çš„æ¥å£ä¹‹ä¸€,ä½†æ˜¯ç®€å• ç»™å®šå®ƒåšä»€ä¹ˆå°±è¡Œã€‚ è¦é…ç½®ä½ çš„ç¼“å­˜, ç®€å•å’Œå…¬æœ‰çš„ JavaBeans å±æ€§æ¥é…ç½®ä½ çš„ç¼“å­˜å®ç°, è€Œä¸”æ˜¯é€šè¿‡ cache å…ƒç´ æ¥ä¼ é€’å±æ€§, æ¯”å¦‚, ä¸‹é¢ä»£ç ä¼šåœ¨ä½ çš„ç¼“å­˜å®ç°ä¸­è°ƒç”¨ä¸€ä¸ªç§°ä¸º â€œsetCacheFile(String file)â€ çš„æ–¹æ³•: ä½ å¯ä»¥ä½¿ç”¨æ‰€æœ‰ç®€å•ç±»å‹ä½œä¸º JavaBeans çš„å±æ€§,MyBatis ä¼šè¿›è¡Œè½¬æ¢ã€‚ And you can specify a placeholder(e.g. ${cache.file}) to replace value defined at configuration properties. ä»3.4.2ç‰ˆæœ¬å¼€å§‹ï¼ŒMyBatiså·²ç»æ”¯æŒåœ¨æ‰€æœ‰å±æ€§è®¾ç½®å®Œæ¯•ä»¥åå¯ä»¥è°ƒç”¨ä¸€ä¸ªåˆå§‹åŒ–æ–¹æ³•ã€‚å¦‚æœä½ æƒ³è¦ä½¿ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œè¯·åœ¨ä½ çš„è‡ªå®šä¹‰ç¼“å­˜ç±»é‡Œå®ç° org.apache.ibatis.builder.InitializingObject æ¥å£ã€‚","date":"2024-12-31","categories":["java"],"tags":["mybatis"]},{"title":"mybatis-æ·±å…¥ç†è§£mybatis(3)é«˜çº§æ˜ å°„æ–‡ä»¶","url":"/2024/12/31/mybatis-æ·±å…¥ç†è§£mybatis-3-é«˜çº§æ˜ å°„æ–‡ä»¶/","content":"æ·±å…¥ç†è§£mybatisï¼ˆä¸‰ï¼‰é«˜çº§æ˜ å°„æ–‡ä»¶mybatisé«˜çº§éƒ¨åˆ†è§£å†³å„ç§é«˜çº§æ˜ å°„é—®é¢˜ association ä¸€å¯¹ä¸€å…³è” å…³è”ä¸­ä¸åŒçš„æ˜¯ä½ éœ€è¦å‘Šè¯‰ MyBatis å¦‚ä½•åŠ è½½å…³è”ã€‚MyBatis åœ¨è¿™æ–¹é¢ä¼šæœ‰ä¸¤ç§ä¸åŒçš„ æ–¹å¼: åµŒå¥—æŸ¥è¯¢:é€šè¿‡æ‰§è¡Œå¦å¤–ä¸€ä¸ª SQL æ˜ å°„è¯­å¥æ¥è¿”å›é¢„æœŸçš„å¤æ‚ç±»å‹ã€‚ åµŒå¥—ç»“æœ:ä½¿ç”¨åµŒå¥—ç»“æœæ˜ å°„æ¥å¤„ç†é‡å¤çš„è”åˆç»“æœçš„å­é›†ã€‚åŸºæœ¬å±æ€§ï¼ˆå’Œidå’Œresultfulç›¸åŒï¼‰ å‚æ•°å±æ€§ å±æ€§ä¿¡æ¯ property æ˜ å°„åˆ°åˆ—ç»“æœçš„å­—æ®µæˆ–å±æ€§ã€‚å¦‚æœåŒ¹é…çš„æ˜¯å­˜åœ¨çš„,å’Œç»™å®šåç§°ç›¸åŒçš„ property JavaBeans çš„å±æ€§, é‚£ä¹ˆå°±ä¼šä½¿ç”¨ã€‚å¦åˆ™ MyBatis å°†ä¼šå¯»æ‰¾ç»™å®šåç§°çš„å­—æ®µã€‚ è¿™ä¸¤ç§æƒ…å½¢ä½ å¯ä»¥ä½¿ç”¨é€šå¸¸ç‚¹å¼çš„å¤æ‚å±æ€§å¯¼èˆªã€‚æ¯”å¦‚,ä½ å¯ä»¥è¿™æ ·æ˜ å°„ ä¸€ äº› ä¸œ è¥¿ :â€œ username â€, æˆ– è€… æ˜  å°„ åˆ° ä¸€ äº› å¤ æ‚ çš„ ä¸œ è¥¿ : â€œaddress.street.numberâ€ ã€‚ javaType ä¸€ä¸ªJava ç±»çš„å®Œå…¨é™å®šå,æˆ–ä¸€ä¸ªç±»å‹åˆ«å(å‚è€ƒä¸Šé¢å†…å»ºç±»å‹åˆ«åçš„åˆ— è¡¨) ã€‚å¦‚æœä½ æ˜ å°„åˆ°ä¸€ä¸ª JavaBean,MyBatis é€šå¸¸å¯ä»¥æ–­å®šç±»å‹ã€‚ç„¶è€Œ,å¦‚ javaType æœä½ æ˜ å°„åˆ°çš„æ˜¯ HashMap,é‚£ä¹ˆä½ åº”è¯¥æ˜ç¡®åœ°æŒ‡å®š javaType æ¥ä¿è¯æ‰€éœ€çš„ è¡Œä¸ºã€‚ jdbcType åœ¨è¿™ä¸ªè¡¨æ ¼ä¹‹å‰çš„æ‰€æ”¯æŒçš„ JDBC ç±»å‹åˆ—è¡¨ä¸­çš„ç±»å‹ã€‚JDBC ç±»å‹æ˜¯ä»…ä»… éœ€è¦å¯¹æ’å…¥, æ›´æ–°å’Œåˆ é™¤æ“ä½œå¯èƒ½ä¸ºç©ºçš„åˆ—è¿›è¡Œå¤„ç†ã€‚è¿™æ˜¯ JDBC çš„éœ€è¦, jdbcType è€Œä¸æ˜¯ MyBatis çš„ã€‚å¦‚æœä½ ç›´æ¥ä½¿ç”¨ JDBC ç¼–ç¨‹,ä½ éœ€è¦æŒ‡å®šè¿™ä¸ªç±»å‹-ä½† ä»…ä»…å¯¹å¯èƒ½ä¸ºç©ºçš„å€¼ã€‚ typeHandler æˆ‘ä»¬åœ¨å‰é¢è®¨è®ºè¿‡é»˜è®¤çš„ç±»å‹å¤„ç†å™¨ã€‚ä½¿ç”¨è¿™ä¸ªå±æ€§,ä½ å¯ä»¥è¦†ç›–é»˜è®¤çš„ typeHandler ç±»å‹å¤„ç†å™¨ã€‚ è¿™ä¸ªå±æ€§å€¼æ˜¯ç±»çš„å®Œå…¨é™å®šåæˆ–è€…æ˜¯ä¸€ä¸ªç±»å‹å¤„ç†å™¨çš„å®ç°, æˆ–è€…æ˜¯ç±»å‹åˆ«åã€‚ ä½¿ç”¨åµŒå¥—æŸ¥è¯¢æ–¹æ³• å‚æ•°å±æ€§ å±æ€§ä¿¡æ¯ column æ¥è‡ªæ•°æ®åº“çš„ç±»å,æˆ–é‡å‘½åçš„åˆ—æ ‡ç­¾ã€‚è¿™å’Œé€šå¸¸ä¼ é€’ç»™ resultSet.getString(columnName)æ–¹æ³•çš„å­—ç¬¦ä¸²æ˜¯ç›¸åŒçš„ã€‚ column æ³¨ æ„ : è¦ å¤„ ç† å¤ åˆ ä¸» é”® , ä½  å¯ ä»¥ æŒ‡ å®š å¤š ä¸ª åˆ— å é€š è¿‡ column&#x3D; â€ {prop1&#x3D;col1,prop2&#x3D;col2} â€ è¿™ç§è¯­æ³•æ¥ä¼ é€’ç»™åµŒå¥—æŸ¥è¯¢è¯­ å¥ã€‚è¿™ä¼šå¼•èµ· prop1 å’Œ prop2 ä»¥å‚æ•°å¯¹è±¡å½¢å¼æ¥è®¾ç½®ç»™ç›®æ ‡åµŒå¥—æŸ¥è¯¢è¯­å¥ã€‚ select å¦å¤–ä¸€ä¸ªæ˜ å°„è¯­å¥çš„ ID,å¯ä»¥åŠ è½½è¿™ä¸ªå±æ€§æ˜ å°„éœ€è¦çš„å¤æ‚ç±»å‹ã€‚è·å–çš„ åœ¨åˆ—å±æ€§ä¸­æŒ‡å®šçš„åˆ—çš„å€¼å°†è¢«ä¼ é€’ç»™ç›®æ ‡ select è¯­å¥ä½œä¸ºå‚æ•°ã€‚è¡¨æ ¼åé¢ æœ‰ä¸€ä¸ªè¯¦ç»†çš„ç¤ºä¾‹ã€‚select æ³¨ æ„ : è¦ å¤„ ç† å¤ åˆ ä¸» é”® , ä½  å¯ ä»¥ æŒ‡ å®š å¤š ä¸ª åˆ— å é€š è¿‡ column&#x3D; â€ {prop1&#x3D;col1,prop2&#x3D;col2} â€ è¿™ç§è¯­æ³•æ¥ä¼ é€’ç»™åµŒå¥—æŸ¥è¯¢è¯­ å¥ã€‚è¿™ä¼šå¼•èµ· prop1 å’Œ prop2 ä»¥å‚æ•°å¯¹è±¡å½¢å¼æ¥è®¾ç½®ç»™ç›®æ ‡åµŒå¥—æŸ¥è¯¢è¯­å¥ã€‚ fetchType å¯é€‰çš„ã€‚æœ‰æ•ˆå€¼ä¸º lazyå’Œeagerã€‚å¦‚æœä½¿ç”¨äº†ï¼Œå®ƒå°†å–ä»£å…¨å±€é…ç½®å‚æ•°lazyLoadingEnabledã€‚ è¿™ç§æ–¹å¼å¾ˆç®€å•, ä½†æ˜¯å¯¹äºå¤§å‹æ•°æ®é›†åˆå’Œåˆ—è¡¨å°†ä¸ä¼šè¡¨ç°å¾ˆå¥½ã€‚ é—®é¢˜å°±æ˜¯æˆ‘ä»¬ç†ŸçŸ¥çš„ â€œN+1 æŸ¥è¯¢é—®é¢˜â€ã€‚æ¦‚æ‹¬åœ°è®²,N+1 æŸ¥è¯¢é—®é¢˜å¯ä»¥æ˜¯è¿™æ ·å¼•èµ·çš„: ä½ æ‰§è¡Œäº†ä¸€ä¸ªå•ç‹¬çš„ SQL è¯­å¥æ¥è·å–ç»“æœåˆ—è¡¨(å°±æ˜¯â€œ+1â€)ã€‚ å¯¹è¿”å›çš„æ¯æ¡è®°å½•,ä½ æ‰§è¡Œäº†ä¸€ä¸ªæŸ¥è¯¢è¯­å¥æ¥ä¸ºæ¯ä¸ªåŠ è½½ç»†èŠ‚(å°±æ˜¯â€œNâ€)ã€‚ ä½¿ç”¨åµŒå¥—ç»“æœæ–¹æ³• å‚æ•°å±æ€§ å±æ€§ä¿¡æ¯ resultMap è¿™æ˜¯ç»“æœæ˜ å°„çš„ ID,å¯ä»¥æ˜ å°„å…³è”çš„åµŒå¥—ç»“æœåˆ°ä¸€ä¸ªåˆé€‚çš„å¯¹è±¡å›¾ä¸­ã€‚è¿™ æ˜¯ä¸€ç§æ›¿ä»£æ–¹æ³•æ¥è°ƒç”¨å¦å¤–ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚è¿™å…è®¸ä½ è”åˆå¤šä¸ªè¡¨æ¥åˆæˆåˆ° resultMap ä¸€ä¸ªå•ç‹¬çš„ç»“æœé›†ã€‚è¿™æ ·çš„ç»“æœé›†å¯èƒ½åŒ…å«é‡å¤,æ•°æ®çš„é‡å¤ç»„éœ€è¦è¢«åˆ† è§£,åˆç†æ˜ å°„åˆ°ä¸€ä¸ªåµŒå¥—çš„å¯¹è±¡å›¾ã€‚ä¸ºäº†ä½¿å®ƒå˜å¾—å®¹æ˜“,MyBatis è®©ä½ â€œé“¾ æ¥â€ç»“æœæ˜ å°„,æ¥å¤„ç†åµŒå¥—ç»“æœã€‚ä¸€ä¸ªä¾‹å­ä¼šå¾ˆå®¹æ˜“æ¥ä»¿ç…§,è¿™ä¸ªè¡¨æ ¼å é¢ä¹Ÿæœ‰ä¸€ä¸ªç¤ºä¾‹ã€‚ columnPrefix å½“è¿æ¥å¤šè¡¨æ—¶ï¼Œä½ å°†ä¸å¾—ä¸ä½¿ç”¨åˆ—åˆ«åæ¥é¿å…ResultSetä¸­çš„é‡å¤åˆ—åã€‚æŒ‡å®šcolumnPrefixå…è®¸ä½ æ˜ å°„åˆ—ååˆ°ä¸€ä¸ªå¤–éƒ¨çš„ç»“æœé›†ä¸­ã€‚è¯·çœ‹åé¢çš„ä¾‹å­ã€‚ notNullColumn é»˜è®¤æƒ…å†µä¸‹ï¼Œå­å¯¹è±¡ä»…åœ¨è‡³å°‘ä¸€ä¸ªåˆ—æ˜ å°„åˆ°å…¶å±æ€§éç©ºæ—¶æ‰åˆ›å»ºã€‚é€šè¿‡å¯¹è¿™ä¸ªå±æ€§æŒ‡å®šéç©ºçš„åˆ—å°†æ”¹å˜é»˜è®¤è¡Œä¸ºï¼Œè¿™æ ·åšä¹‹åMybatiså°†ä»…åœ¨è¿™äº›åˆ—éç©ºæ—¶æ‰åˆ›å»ºä¸€ä¸ªå­å¯¹è±¡ã€‚å¯ä»¥æŒ‡å®šå¤šä¸ªåˆ—åï¼Œä½¿ç”¨é€—å·åˆ†éš”ã€‚é»˜è®¤å€¼ï¼šæœªè®¾ç½®(unset)ã€‚ autoMapping å¦‚æœä½¿ç”¨äº†ï¼Œå½“æ˜ å°„ç»“æœåˆ°å½“å‰å±æ€§æ—¶ï¼ŒMybatiså°†å¯ç”¨æˆ–è€…ç¦ç”¨è‡ªåŠ¨æ˜ å°„ã€‚è¯¥å±æ€§è¦†ç›–å…¨å±€çš„è‡ªåŠ¨æ˜ å°„è¡Œä¸ºã€‚ æ³¨æ„å®ƒå¯¹å¤–éƒ¨ç»“æœé›†æ— å½±å“ï¼Œæ‰€ä»¥åœ¨select or resultMapå±æ€§ä¸­è¿™ä¸ªæ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚é»˜è®¤å€¼ï¼šæœªè®¾ç½®(unset)ã€‚ ä½¿ç”¨columnPrefixè¿›è¡Œå»é‡æ“ä½œ æ³¨æ„ä½¿ç”¨äº†æ–°åˆ—CAÃ—Ã— åŒ…å«ä¸€ä¸ªæ–°çš„å‰ç¼€co_ å†æ¬¡è°ƒç”¨Authorçš„resultMapå°†å®šä¹‰å¦‚ä¸‹ï¼š å› ä¸ºç»“æœä¸­çš„åˆ—åä¸resultMapä¸­çš„åˆ—åä¸åŒã€‚ ä½ éœ€è¦æŒ‡å®šcolumnPrefixå»é‡ç”¨æ˜ å°„co-authorç»“æœçš„resultMapã€‚ é›†åˆcollectionä¸€å¯¹å¤šå…³è”å’Œä¸€å¯¹ä¸€å…³è”çš„å”¯ä¸€å·®åˆ«å°±æ˜¯æœ‰ä¸€ä¸ªoftypeå±æ€§ï¼Œè¿™ä¸ªå±æ€§è¡¨ç¤ºçš„Listä¸­xxxçš„ç±»å‹ æœ€åä¸€å®šè¦æ³¨æ„ä¸€ç‚¹æ— è®ºæ˜¯ä¸€å¯¹ä¸€è¿˜æ˜¯ä¸€å¯¹å¤šä¸€å®šè¦å†™ ä¸»é”®å…³è” å¦åˆ™å°†ä¼šå¯¼è‡´æ•´ä¸ªç»“æœé›†æ‰«æè¿›è¡Œå±æ€§å…³è”ï¼Œä¸¥é‡é™ä½æ€§èƒ½ é‰´åˆ«å™¨æœ‰æ—¶ä¸€ä¸ªå•ç‹¬çš„æ•°æ®åº“æŸ¥è¯¢ä¹Ÿè®¸è¿”å›å¾ˆå¤šä¸åŒ (ä½†æ˜¯å¸Œæœ›æœ‰äº›å…³è”) æ•°æ®ç±»å‹çš„ç»“æœé›†ã€‚ é‰´åˆ«å™¨å…ƒç´ å°±æ˜¯è¢«è®¾è®¡æ¥å¤„ç†è¿™ä¸ªæƒ…å†µçš„, è¿˜æœ‰åŒ…æ‹¬ç±»çš„ç»§æ‰¿å±‚æ¬¡ç»“æ„ã€‚ é‰´åˆ«å™¨éå¸¸å®¹æ˜“ç† è§£,å› ä¸ºå®ƒçš„è¡¨ç°å¾ˆåƒ Java è¯­è¨€ä¸­çš„ switch è¯­å¥ã€‚ åŒä¸Šé¢çš„ä¾‹å­ ä½¿ç”¨å¤–éƒ¨å…³è”ç‰ˆ ç»“åˆç‰ˆ","date":"2024-12-31","categories":["java"],"tags":["mybatis"]},{"title":"mybatis-æ·±å…¥ç†è§£mybatis(4)åŠ¨æ€sql","url":"/2024/12/31/mybatis-æ·±å…¥ç†è§£mybatis-4-åŠ¨æ€sql/","content":"æ·±å…¥ç†è§£mybatisï¼ˆå››ï¼‰åŠ¨æ€sqlé€šå¸¸ä½¿ç”¨åŠ¨æ€ SQL ä¸å¯èƒ½æ˜¯ç‹¬ç«‹çš„ä¸€éƒ¨åˆ†,MyBatis å½“ç„¶ä½¿ç”¨ä¸€ç§å¼ºå¤§çš„åŠ¨æ€ SQL è¯­è¨€æ¥æ”¹è¿›è¿™ç§æƒ…å½¢,è¿™ç§è¯­è¨€å¯ä»¥è¢«ç”¨åœ¨ä»»æ„çš„ SQL æ˜ å°„è¯­å¥ä¸­ã€‚ MyBatis 3 å¤§å¤§æå‡äº†å®ƒä»¬,ç°åœ¨ç”¨ä¸åˆ°åŸå…ˆä¸€åŠçš„å…ƒç´ å°±å¯ä»¥äº†ã€‚MyBatis é‡‡ç”¨åŠŸèƒ½å¼ºå¤§çš„åŸºäº OGNL çš„è¡¨è¾¾å¼æ¥æ¶ˆé™¤å…¶ä»–å…ƒç´ ã€‚ if choose (when, otherwise) trim (where, set) foreach å¼•ç”³:ognlè¡¨è¾¾å¼ä»‹ç» MyBatiså¸¸ç”¨OGNLè¡¨è¾¾å¼ e1 or e2 e1 and e2 e1 &#x3D;&#x3D; e2,e1 eq e2 e1 !&#x3D; e2,e1 neq e2 e1 lt e2ï¼šå°äº e1 lte e2ï¼šå°äºç­‰äºï¼Œå…¶ä»–gtï¼ˆå¤§äºï¼‰,gteï¼ˆå¤§äºç­‰äºï¼‰ e1 in e2 e1 not in e2 e1 + e2,e1 * e2,e1&#x2F;e2,e1 â€“ e2,e1%e2 !e,not eï¼šéï¼Œæ±‚å e.method(args)è°ƒç”¨å¯¹è±¡æ–¹æ³• e.propertyå¯¹è±¡å±æ€§å€¼ e1[ e2 ]æŒ‰ç´¢å¼•å–å€¼ï¼ŒList,æ•°ç»„å’ŒMap @class@method(args)è°ƒç”¨ç±»çš„é™æ€æ–¹æ³• @class@fieldè°ƒç”¨ç±»çš„é™æ€å­—æ®µå€¼ mybatisä¸­çš„# å’Œ $ â€˜#â€™ä¼šå°†å­—ç¬¦ä¸²è¿›è¡Œè½¬è¯‘ â€˜$â€™ç›´æ¥è¿›è¡Œå­—ç¬¦ä¸²æ›¿æ¢ if å…³é”®å­— choose, when, otherwise å…³é”®å­—ç›¸å½“äºjavaä¸­çš„switchè¯­å¥ trim, where, set å…³é”®å­—è§£å†³æ‹¼æ¥å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œwhere and ç­‰å­—æ®µå¤šä½™çš„é—®é¢˜ æ¯”å¦‚è¿™æ ·çš„è¯­å¥ å¦‚æœè¿™äº›æ¡ä»¶æ²¡æœ‰ä¸€ä¸ªèƒ½åŒ¹é…ä¸Šï¼Œæœ€ç»ˆçš„ç»“æœç«Ÿä¼šå˜æˆè¿™æ · ä½¿ç”¨whereæ ‡ç­¾åŒ…è£¹å°†ä¼šè§£å†³è¿™ä¸ªé—®é¢˜ ç±»ä¼¼çš„ trim ç›¸æ¯” where åªæ˜¯å¤šäº†å®šåˆ¶å±æ€§ å‚æ•° ä½œç”¨ prefix æŒ‡å®šåŒ…è£¹å—ç”Ÿæˆsqlä¹‹åè¦æ·»åŠ çš„å‰ç¼€ prefixOverrides å¿½ç•¥ç¬¬ä¸€ä¸ªæŒ‡å®šçš„æ ‡è¯†ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨ suffix æŒ‡å®šåŒ…è£¹å—ç”Ÿæˆsqlä¹‹åè¦æ·»åŠ çš„åç¼€ suffixOverrides å¿½ç•¥æœ€åä¸€ä¸ªæŒ‡å®šçš„æ ‡è¯†ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨ setè¯­å¥ä¸€èˆ¬ç”¨åœ¨è¿›è¡ŒåŠ¨æ€æ·»åŠ åˆ—å±æ€§ foreachåŠ¨æ€ SQL çš„å¦å¤–ä¸€ä¸ªå¸¸ç”¨çš„å¿…è¦æ“ä½œæ˜¯éœ€è¦å¯¹ä¸€ä¸ªé›†åˆè¿›è¡Œéå†ï¼Œé€šå¸¸æ˜¯åœ¨æ„å»º IN æ¡ä»¶è¯­å¥çš„æ—¶å€™ã€‚æ¯”å¦‚ï¼š foreach å…ƒç´ çš„åŠŸèƒ½æ˜¯éå¸¸å¼ºå¤§çš„ï¼Œå®ƒå…è®¸ä½ æŒ‡å®šä¸€ä¸ªé›†åˆï¼Œå£°æ˜å¯ä»¥ç”¨åœ¨å…ƒç´ ä½“å†…çš„é›†åˆé¡¹å’Œç´¢å¼•å˜é‡ã€‚å®ƒä¹Ÿå…è®¸ä½ æŒ‡å®šå¼€é—­åŒ¹é…çš„å­—ç¬¦ä¸²ä»¥åŠåœ¨è¿­ä»£ä¸­é—´æ”¾ç½®åˆ†éš”ç¬¦ã€‚è¿™ä¸ªå…ƒç´ æ˜¯å¾ˆæ™ºèƒ½çš„ï¼Œå› æ­¤å®ƒä¸ä¼šå¶ç„¶åœ°é™„åŠ å¤šä½™çš„åˆ†éš”ç¬¦ã€‚ æ³¨æ„ï¼šä½ å¯ä»¥å°†ä»»ä½•å¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚åˆ—è¡¨ã€é›†åˆç­‰ï¼‰å’Œä»»ä½•çš„å­—å…¸æˆ–è€…æ•°ç»„å¯¹è±¡ä¼ é€’ç»™foreachä½œä¸ºé›†åˆå‚æ•°ã€‚å½“ä½¿ç”¨å¯è¿­ä»£å¯¹è±¡æˆ–è€…æ•°ç»„æ—¶ï¼Œindexæ˜¯å½“å‰è¿­ä»£çš„æ¬¡æ•°ï¼Œitemçš„å€¼æ˜¯æœ¬æ¬¡è¿­ä»£è·å–çš„å…ƒç´ ã€‚å½“ä½¿ç”¨å­—å…¸ï¼ˆæˆ–è€…Map.Entryå¯¹è±¡çš„é›†åˆï¼‰æ—¶ï¼Œindexæ˜¯é”®ï¼Œitemæ˜¯å€¼ã€‚","date":"2024-12-31","categories":["java"],"tags":["mybatis"]},{"title":"mybatis-æ·±å…¥ç†è§£mybatis(5)java api","url":"/2024/12/31/mybatis-æ·±å…¥ç†è§£mybatis-5-java-api/","content":"æ·±å…¥ç†è§£mybatisï¼ˆäº”ï¼‰java apiSqlSessionFactoryBuilderã€SqlSessionFactoryã€SqlSessionå¯ä»¥è¯´æ¯ä¸ªMyBatiséƒ½æ˜¯ä»¥ä¸€ä¸ªSqlSessionFactoryå®ä¾‹ä¸ºä¸­å¿ƒçš„ã€‚SqlSessionFactoryå®ä¾‹å¯ä»¥é€šè¿‡SqlSessionFactoryBuilderæ¥æ„å»ºã€‚ä¸€æ˜¯å¯ä»¥é€šè¿‡XMLé…ç½®æ–‡ä»¶çš„æ–¹å¼æ¥æ„å»ºSqlSessionFactoryï¼ŒäºŒæ˜¯å¯ä»¥é€šè¿‡Java APIçš„æ–¹å¼æ¥æ„å»ºã€‚ä½†ä¸ç®¡é€šè¿‡ä»€ä¹ˆæ–¹å¼éƒ½æœ‰ä¸€ä¸ªConfigurationè´¯ç©¿å§‹ç»ˆï¼Œå„ç§é…ç½®æ­£æ˜¯é€šè¿‡Configurationå®ä¾‹æ¥å®Œæˆå®ç°ã€‚ sqlSessionfactoryBuilerç”ŸæˆSqlSessionFactoryçš„æ–¹æ³• ä½¿ç”¨javaç±»é…ç½®å®ç°(SqlSessionFactoryBuilder) ä½¿ç”¨xmlæ–‡æ¡£ è¾“å…¥æµå®ç° SqlSessionFactory åˆ›å»ºSqlSessionå®ä¾‹ ç›¸å…³å‚æ•°é…ç½®ï¼š äº‹ç‰©éš”ç¦»çº§åˆ« NONE(æ— ),READ_UNCOMMITTED(è¯»æœªæäº¤),READ_COMMITTED(è¯»å·²æäº¤),REPEA TABLE_READ(å¯é‡å¤é˜…è¯»),SERIALIZA BLE(åºåˆ—åŒ–) ExecutorType(æ‰§è¡Œæ–¹å¼) ExecutorType.SIMPLE: è¿™ä¸ªæ‰§è¡Œå™¨ç±»å‹ä¸åšç‰¹æ®Šçš„äº‹æƒ…ã€‚å®ƒä¸ºæ¯ä¸ªè¯­å¥çš„æ‰§è¡Œåˆ›å»ºä¸€ä¸ªæ–°çš„é¢„å¤„ç†è¯­å¥ã€‚ ExecutorType.REUSE: è¿™ä¸ªæ‰§è¡Œå™¨ç±»å‹ä¼šå¤ç”¨é¢„å¤„ç†è¯­å¥ã€‚ ExecutorType.BATCH: è¿™ä¸ªæ‰§è¡Œå™¨ä¼šæ‰¹é‡æ‰§è¡Œæ‰€æœ‰æ›´æ–°è¯­å¥,å¦‚æœ - - SELECT åœ¨å®ƒä»¬ä¸­é—´æ‰§è¡Œè¿˜ä¼šæ ‡å®šå®ƒä»¬æ˜¯ å¿…é¡»çš„,æ¥ä¿è¯ä¸€ä¸ªç®€å•å¹¶æ˜“äºç†è§£çš„è¡Œä¸ºã€‚ SqlSession æœ€æ ¸å¿ƒçš„ä¼šè¯æ“ä½œç±» è¯­å¥æ‰§è¡Œæ–¹æ³• è¿™äº›æ–¹æ³•è¢«ç”¨æ¥æ‰§è¡Œå®šä¹‰åœ¨ SQL æ˜ å°„çš„ XML æ–‡ä»¶ä¸­çš„ SELECT,INSERT,UPDA E T å’Œ DELETE è¯­å¥ã€‚å®ƒä»¬éƒ½ä¼šè‡ªè¡Œè§£é‡Š,æ¯ä¸€å¥éƒ½ä½¿ç”¨è¯­å¥çš„ ID å±æ€§å’Œå‚æ•°å¯¹è±¡,å‚æ•°å¯ä»¥ æ˜¯åŸç”Ÿç±»å‹(è‡ªåŠ¨è£…ç®±æˆ–åŒ…è£…ç±») ,JavaBean,POJO æˆ– Mapã€‚ æ³¨æ„ï¼šselectOne å’Œ selectList çš„ä¸åŒä»…ä»…æ˜¯ selectOne å¿…é¡»è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚ å¦‚æœå¤šä½™ä¸€ä¸ª, æˆ–è€… æ²¡æœ‰è¿”å› (æˆ–è¿”å›äº† null) é‚£ä¹ˆå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ , å¦‚æœä½ ä¸çŸ¥é“éœ€è¦å¤šå°‘å¯¹è±¡, ä½¿ç”¨ selectListã€‚ æœ€å,è¿˜æœ‰æŸ¥è¯¢æ–¹æ³•çš„ä¸‰ä¸ªé«˜çº§ç‰ˆæœ¬,å®ƒä»¬å…è®¸ä½ é™åˆ¶è¿”å›è¡Œæ•°çš„èŒƒå›´,æˆ–è€…æä¾›è‡ªå®š ä¹‰ç»“æœæ§åˆ¶é€»è¾‘,è¿™é€šå¸¸ç”¨äºå¤§é‡çš„æ•°æ®é›†åˆã€‚ RowBounds å‚æ•°ä¼šå‘Šè¯‰ MyBatis ç•¥è¿‡æŒ‡å®šæ•°é‡çš„è®°å½•,è¿˜æœ‰é™åˆ¶è¿”å›ç»“æœçš„æ•°é‡ã€‚ ResultHandler å‚æ•°å…è®¸ä½ æŒ‰ä½ å–œæ¬¢çš„æ–¹å¼å¤„ç†æ¯ä¸€è¡Œã€‚ å®ƒçš„æ¥å£å¾ˆç®€å•ã€‚ ResultContext å‚æ•°å…è®¸ä½ è®¿é—®ç»“æœå¯¹è±¡æœ¬èº«ã€è¢«åˆ›å»ºçš„å¯¹è±¡æ•°ç›®ã€ä»¥åŠè¿”å›å€¼ä¸º Boolean çš„ stop æ–¹æ³•ï¼Œä½ å¯ä»¥ä½¿ç”¨æ­¤ stop æ–¹æ³•æ¥åœæ­¢ MyBatis åŠ è½½æ›´å¤šçš„ç»“æœã€‚ä½¿ç”¨ ResultHandler çš„æ—¶å€™éœ€è¦æ³¨æ„ä»¥ä¸‹ä¸¤ç§é™åˆ¶ï¼š ä»è¢« ResultHandler è°ƒç”¨çš„æ–¹æ³•è¿”å›çš„æ•°æ®ä¸ä¼šè¢«ç¼“å­˜ã€‚ å½“ä½¿ç”¨ç»“æœæ˜ å°„é›†ï¼ˆresultMapï¼‰æ—¶ï¼ŒMyBatis å¤§å¤šæ•°æƒ…å†µä¸‹éœ€è¦æ•°è¡Œç»“æœæ¥æ„é€ å¤–é”®å¯¹è±¡ã€‚å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ ResultHandlerï¼Œä½ å¯ä»¥ç»™å‡ºå¤–é”®ï¼ˆassociationï¼‰æˆ–è€…é›†åˆï¼ˆcollectionï¼‰å°šæœªèµ‹å€¼çš„å¯¹è±¡ã€‚ æ‰¹é‡ç«‹å³æ›´æ–°æ–¹æ³•(Flush Method) æœ‰ä¸€ä¸ªæ–¹æ³•å¯ä»¥åˆ·æ–°ï¼ˆæ‰§è¡Œï¼‰å­˜å‚¨åœ¨JDBCé©±åŠ¨ç±»ä¸­çš„æ‰¹é‡æ›´æ–°è¯­å¥ã€‚å½“ä½ å°†ExecutorType.BATCHä½œä¸ºExecutorTypeä½¿ç”¨æ—¶å¯ä»¥é‡‡ç”¨æ­¤æ–¹æ³•ã€‚ äº‹åŠ¡æ§åˆ¶æ–¹æ³• æ³¨æ„ï¼šå¦‚æœä½ å·²ç»é€‰æ‹©äº†è‡ªåŠ¨æäº¤æˆ–ä½ æ­£åœ¨ä½¿ç”¨å¤–éƒ¨äº‹åŠ¡ç®¡ç†å™¨,è¿™å°±æ²¡æœ‰ä»»ä½•æ•ˆæœäº† æ¸…ç†Sessionçº§çš„ç¼“å­˜ SqlSession å®ä¾‹æœ‰ä¸€ä¸ªæœ¬åœ°ç¼“å­˜åœ¨æ‰§è¡Œ update,commit,rollback å’Œ close æ—¶è¢«æ¸…ç†ã€‚è¦ æ˜ç¡®åœ°å…³é—­å®ƒ(è·å–æ‰“ç®—åšæ›´å¤šçš„å·¥ä½œ) ,ä½ å¯ä»¥è°ƒç”¨ clearCache()ã€‚ ç¡®ä¿ SqlSession è¢«å…³é—­ é«˜çº§åº”ç”¨ ä½¿ç”¨æ˜ å°„å™¨ å’Œå¸¸ç”¨æ³¨é‡Šæ“ä½œ typeæ˜¯mybatisçš„æ˜ å°„å™¨ç±»ï¼Œæ˜¯ä¸€ä¸ªjavaæ¥å£ï¼Œå¯ä»¥å°†æ¥å£ç±»æ¯”æˆmybatisçš„mapæ–‡ä»¶ï¼ŒåŒ…åç§°ç›¸å½“äºxmlä¸­çš„namespaceï¼Œè€Œ select delete insert update ä¸­çš„idå±æ€§ å¯¹åº”çš„ æ¥å£ä¸­çš„æ–¹æ³• æœ€å¸¸ç”¨æ³¨è§£ï¼Œç”¨æ¥è¿›è¡ŒåŠ¨æ€çš„æ³¨å…¥å±æ€§ æ³¨è§£ ä½¿ç”¨å¯¹è±¡ ç›¸å¯¹åº”çš„XML æè¿° @CacheNamespace ç±» <cache> ä¸ºç»™å®šçš„å‘½åç©ºé—´ï¼ˆæ¯”å¦‚ç±»ï¼‰é…ç½®ç¼“å­˜ã€‚å±æ€§æœ‰ï¼šimplemetation,eviction,flushInterval,size,readWrite,blockingå’Œpropertiesã€‚ @Property N&#x2F;A <property> æŒ‡å®šå‚æ•°å€¼æˆ–å ä½å€¼ï¼ˆplaceholderï¼‰ï¼ˆèƒ½è¢«mybatis-config.xmlå†…çš„é…ç½®å±æ€§è¦†ç›–ï¼‰ã€‚å±æ€§æœ‰ï¼šname,valueã€‚ï¼ˆä»…åœ¨MyBatis3.4.2ä»¥ä¸Šç‰ˆæœ¬ç”Ÿæ•ˆï¼‰ @CacheNamespaceRef ç±» <cacheRef> å‚ç…§å¦å¤–ä¸€ä¸ªå‘½åç©ºé—´çš„ç¼“å­˜æ¥ä½¿ç”¨ã€‚å±æ€§æœ‰ï¼švalue,nameã€‚å¦‚æœä½ ä½¿ç”¨äº†è¿™ä¸ªæ³¨è§£ï¼Œä½ åº”è®¾ç½®valueæˆ–è€…nameå±æ€§çš„å…¶ä¸­ä¸€ä¸ªã€‚valueå±æ€§ç”¨äºæŒ‡å®šJavaç±»å‹è€ŒæŒ‡å®šå‘½åç©ºé—´ï¼ˆå‘½åç©ºé—´åå°±æ˜¯æŒ‡å®šçš„Javaç±»å‹çš„å…¨é™å®šåï¼‰ï¼Œnameå±æ€§ï¼ˆè¿™ä¸ªå±æ€§ä»…åœ¨MyBatis3.4.2ä»¥ä¸Šç‰ˆæœ¬ç”Ÿæ•ˆï¼‰ç›´æ¥æŒ‡å®šäº†å‘½åç©ºé—´çš„åå­—ã€‚ @ConstructorArgs æ–¹æ³• <constructor> æ”¶é›†ä¸€ç»„ç»“æœä¼ é€’ç»™ä¸€ä¸ªç»“æœå¯¹è±¡çš„æ„é€ æ–¹æ³•ã€‚å±æ€§æœ‰ï¼švalueï¼Œå®ƒæ˜¯å½¢å¼å‚æ•°æ•°ç»„ã€‚ @Arg N&#x2F;A <arg> å•å‚æ•°æ„é€ æ–¹æ³•ï¼Œæ˜¯ConstructorArgsé›†åˆçš„ä¸€éƒ¨åˆ†ã€‚å±æ€§æœ‰ï¼šid,column,javaType,jdbcType,typeHandler,selectå’ŒresultMapã€‚idå±æ€§æ˜¯å¸ƒå°”å€¼ï¼Œæ¥æ ‡è¯†ç”¨äºæ¯”è¾ƒçš„å±æ€§ï¼Œå’Œ<idArg>XMLå…ƒç´ ç›¸ä¼¼ã€‚ <idArg> @TypeDiscriminator æ–¹æ³• <discriminator> ä¸€ç»„å®ä¾‹å€¼è¢«ç”¨æ¥å†³å®šç»“æœæ˜ å°„çš„è¡¨ç°ã€‚å±æ€§æœ‰ï¼šcolumn,javaType,jdbcType,typeHandlerå’Œcasesã€‚caseså±æ€§æ˜¯å®ä¾‹æ•°ç»„ã€‚ @Case N&#x2F;A <case> å•ç‹¬å®ä¾‹çš„å€¼å’Œå®ƒå¯¹åº”çš„æ˜ å°„ã€‚å±æ€§æœ‰ï¼švalue,type,resultsã€‚resultså±æ€§æ˜¯ç»“æœæ•°ç»„ï¼Œå› æ­¤è¿™ä¸ªæ³¨è§£å’Œå®é™…çš„ResultMapå¾ˆç›¸ä¼¼ï¼Œç”±ä¸‹é¢çš„Resultsæ³¨è§£æŒ‡å®šã€‚ @Results æ–¹æ³• <resultMap> ç»“æœæ˜ å°„çš„åˆ—è¡¨ï¼ŒåŒ…å«äº†ä¸€ä¸ªç‰¹åˆ«ç»“æœåˆ—å¦‚ä½•è¢«æ˜ å°„åˆ°å±æ€§æˆ–å­—æ®µçš„è¯¦æƒ…ã€‚å±æ€§æœ‰ï¼švalue,idã€‚valueå±æ€§æ˜¯Resultæ³¨è§£çš„æ•°ç»„ã€‚è¿™ä¸ªidçš„å±æ€§æ˜¯ç»“æœæ˜ å°„çš„åç§°ã€‚ @Result N&#x2F;A <result> åœ¨åˆ—å’Œå±æ€§æˆ–å­—æ®µä¹‹é—´çš„å•ç‹¬ç»“æœæ˜ å°„ã€‚å±æ€§æœ‰ï¼šid,column,javaType,jdbcType,typeHandler,one,manyã€‚idå±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œæ¥æ ‡è¯†åº”è¯¥è¢«ç”¨äºæ¯”è¾ƒï¼ˆå’Œåœ¨XMLæ˜ å°„ä¸­çš„<id>ç›¸ä¼¼ï¼‰çš„å±æ€§ã€‚oneå±æ€§æ˜¯å•ç‹¬çš„è”ç³»ï¼Œå’Œ<association>ç›¸ä¼¼ï¼Œè€Œmanyå±æ€§æ˜¯å¯¹é›†åˆè€Œè¨€çš„ï¼Œå’Œ<collection>ç›¸ä¼¼ã€‚å®ƒä»¬è¿™æ ·å‘½åæ˜¯ä¸ºäº†é¿å…åç§°å†²çªã€‚ <id> @One N&#x2F;A <association> å¤æ‚ç±»å‹çš„å•ç‹¬å±æ€§å€¼æ˜ å°„ã€‚å±æ€§æœ‰ï¼šselectï¼Œå·²æ˜ å°„è¯­å¥ï¼ˆä¹Ÿå°±æ˜¯æ˜ å°„å™¨æ–¹æ³•ï¼‰çš„å…¨é™å®šåï¼Œå®ƒå¯ä»¥åŠ è½½åˆé€‚ç±»å‹çš„å®ä¾‹ã€‚fetchTypeä¼šè¦†ç›–å…¨å±€çš„é…ç½®å‚æ•°lazyLoadingEnabledã€‚æ³¨æ„è”åˆæ˜ å°„åœ¨æ³¨è§£APIä¸­æ˜¯ä¸æ”¯æŒçš„ã€‚è¿™æ˜¯å› ä¸ºJavaæ³¨è§£çš„é™åˆ¶,ä¸å…è®¸å¾ªç¯å¼•ç”¨ã€‚ @Many N&#x2F;A <collection> æ˜ å°„åˆ°å¤æ‚ç±»å‹çš„é›†åˆå±æ€§ã€‚å±æ€§æœ‰ï¼šselectï¼Œå·²æ˜ å°„è¯­å¥ï¼ˆä¹Ÿå°±æ˜¯æ˜ å°„å™¨æ–¹æ³•ï¼‰çš„å…¨é™å®šåï¼Œå®ƒå¯ä»¥åŠ è½½åˆé€‚ç±»å‹çš„å®ä¾‹çš„é›†åˆï¼ŒfetchTypeä¼šè¦†ç›–å…¨å±€çš„é…ç½®å‚æ•°lazyLoadingEnabledã€‚æ³¨æ„è”åˆæ˜ å°„åœ¨æ³¨è§£APIä¸­æ˜¯ä¸æ”¯æŒçš„ã€‚è¿™æ˜¯å› ä¸ºJavaæ³¨è§£çš„é™åˆ¶ï¼Œä¸å…è®¸å¾ªç¯å¼•ç”¨ @MapKey æ–¹æ³• è¿™æ˜¯ä¸€ä¸ªç”¨åœ¨è¿”å›å€¼ä¸ºMapçš„æ–¹æ³•ä¸Šçš„æ³¨è§£ã€‚å®ƒèƒ½å¤Ÿå°†å­˜æ”¾å¯¹è±¡çš„Listè½¬åŒ–ä¸ºkeyå€¼ä¸ºå¯¹è±¡çš„æŸä¸€å±æ€§çš„Mapã€‚å±æ€§æœ‰ï¼švalueï¼Œå¡«å…¥çš„æ˜¯å¯¹è±¡çš„å±æ€§åï¼Œä½œä¸ºMapçš„keyå€¼ã€‚ @Options æ–¹æ³• æ˜ å°„è¯­å¥çš„å±æ€§ è¿™ä¸ªæ³¨è§£æä¾›è®¿é—®å¤§èŒƒå›´çš„äº¤æ¢å’Œé…ç½®é€‰é¡¹çš„å…¥å£ï¼Œå®ƒä»¬é€šå¸¸åœ¨æ˜ å°„è¯­å¥ä¸Šä½œä¸ºå±æ€§å‡ºç°ã€‚Optionsæ³¨è§£æä¾›äº†é€šä¿—æ˜“æ‡‚çš„æ–¹å¼æ¥è®¿é—®å®ƒä»¬ï¼Œè€Œä¸æ˜¯è®©æ¯æ¡è¯­å¥æ³¨è§£å˜å¤æ‚ã€‚å±æ€§æœ‰ï¼šuseCache&#x3D;true,flushCache&#x3D;FlushCachePolicy.DEFAULT,resultSetType&#x3D;FORWARD_ONLY,statementType&#x3D;PREPARED,fetchSize&#x3D;-1,timeout&#x3D;-1,useGeneratedKeys&#x3D;false,keyProperty&#x3D;â€idâ€,keyColumn&#x3D;â€â€,resultSets&#x3D;â€â€ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒJavaæ³¨è§£æ— æ³•æŒ‡å®šnullå€¼ã€‚å› æ­¤ï¼Œä¸€æ—¦ä½ ä½¿ç”¨äº†Optionsæ³¨è§£ï¼Œä½ çš„è¯­å¥å°±ä¼šè¢«ä¸Šè¿°å±æ€§çš„é»˜è®¤å€¼æ‰€å½±å“ã€‚è¦æ³¨æ„é¿å…é»˜è®¤å€¼å¸¦æ¥çš„é¢„æœŸä»¥å¤–çš„è¡Œä¸ºã€‚ æ³¨æ„ï¼škeyColumnå±æ€§åªåœ¨æŸäº›æ•°æ®åº“ä¸­æœ‰æ•ˆï¼ˆå¦‚Oracleã€PostgreSQLç­‰ï¼‰ã€‚è¯·åœ¨æ’å…¥è¯­å¥ä¸€èŠ‚æŸ¥çœ‹æ›´å¤šå…³äºkeyColumnå’ŒkeyPropertyä¸¤è€…çš„æœ‰æ•ˆå€¼è¯¦æƒ…ã€‚ @Insert æ–¹æ³• <insert> è¿™å››ä¸ªæ³¨è§£åˆ†åˆ«ä»£è¡¨å°†ä¼šè¢«æ‰§è¡Œçš„SQLè¯­å¥ã€‚å®ƒä»¬ç”¨å­—ç¬¦ä¸²æ•°ç»„ï¼ˆæˆ–å•ä¸ªå­—ç¬¦ä¸²ï¼‰ä½œä¸ºå‚æ•°ã€‚å¦‚æœä¼ é€’çš„æ˜¯å­—ç¬¦ä¸²æ•°ç»„ï¼Œå­—ç¬¦ä¸²ä¹‹é—´å…ˆä¼šè¢«å¡«å……ä¸€ä¸ªç©ºæ ¼å†è¿æ¥æˆå•ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸²ã€‚è¿™æœ‰æ•ˆé¿å…äº†ä»¥Javaä»£ç æ„å»ºSQLè¯­å¥æ—¶çš„â€œä¸¢å¤±ç©ºæ ¼â€çš„é—®é¢˜ã€‚ç„¶è€Œï¼Œä½ ä¹Ÿå¯ä»¥æå‰æ‰‹åŠ¨è¿æ¥å¥½å­—ç¬¦ä¸²ã€‚å±æ€§æœ‰ï¼švalueï¼Œå¡«å…¥çš„å€¼æ˜¯ç”¨æ¥ç»„æˆå•ä¸ªSQLè¯­å¥çš„å­—ç¬¦ä¸²æ•°ç»„ã€‚ @Update <update> @Delete <delete> @Select <select> @InsertProvider æ–¹æ³• <insert> å…è®¸æ„å»ºåŠ¨æ€SQLã€‚è¿™äº›å¤‡é€‰çš„SQLæ³¨è§£å…è®¸ä½ æŒ‡å®šç±»åå’Œè¿”å›åœ¨è¿è¡Œæ—¶æ‰§è¡Œçš„SQLè¯­å¥çš„æ–¹æ³•ã€‚ï¼ˆè‡ªä»MyBatis3.4.6å¼€å§‹ï¼Œä½ å¯ä»¥ç”¨CharSequenceä»£æ›¿Stringæ¥è¿”å›ç±»å‹è¿”å›å€¼äº†ã€‚ï¼‰å½“æ‰§è¡Œæ˜ å°„è¯­å¥çš„æ—¶å€™ï¼ŒMyBatisä¼šå®ä¾‹åŒ–ç±»å¹¶æ‰§è¡Œæ–¹æ³•ï¼Œç±»å’Œæ–¹æ³•å°±æ˜¯å¡«å…¥äº†æ³¨è§£çš„å€¼ã€‚ä½ å¯ä»¥æŠŠå·²ç»ä¼ é€’ç»™æ˜ å°„æ–¹æ³•äº†çš„å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œâ€Mapperinterfacetypeâ€å’Œâ€Mappermethodâ€ä¼šç»è¿‡ProviderContextï¼ˆä»…åœ¨MyBatis3.4.5åŠä»¥ä¸Šæ”¯æŒï¼‰ä½œä¸ºå‚æ•°å€¼ã€‚ï¼ˆMyBatis3.4åŠä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œæ”¯æŒå¤šå‚æ•°ä¼ å…¥ï¼‰å±æ€§æœ‰ï¼štype,methodã€‚typeå±æ€§éœ€å¡«å…¥ç±»ã€‚methodéœ€å¡«å…¥è¯¥ç±»å®šä¹‰äº†çš„æ–¹æ³•åã€‚æ³¨æ„æ¥ä¸‹æ¥çš„å°èŠ‚å°†ä¼šè®¨è®ºç±»ï¼Œèƒ½å¸®åŠ©ä½ æ›´è½»æ¾åœ°æ„å»ºåŠ¨æ€SQLã€‚ @UpdateProvider <update> @DeleteProvider <delete> @SelectProvider <select> @Param å‚æ•° N&#x2F;A å¦‚æœä½ çš„æ˜ å°„æ–¹æ³•çš„å½¢å‚æœ‰å¤šä¸ªï¼Œè¿™ä¸ªæ³¨è§£ä½¿ç”¨åœ¨æ˜ å°„æ–¹æ³•çš„å‚æ•°ä¸Šå°±èƒ½ä¸ºå®ƒä»¬å–è‡ªå®šä¹‰åå­—ã€‚è‹¥ä¸ç»™å‡ºè‡ªå®šä¹‰åå­—ï¼Œå¤šå‚æ•°ï¼ˆä¸åŒ…æ‹¬RowBoundså‚æ•°ï¼‰åˆ™å…ˆä»¥â€paramâ€ä½œå‰ç¼€ï¼Œå†åŠ ä¸Šå®ƒä»¬çš„å‚æ•°ä½ç½®ä½œä¸ºå‚æ•°åˆ«åã€‚ä¾‹å¦‚#{param1},#{param2}ï¼Œè¿™ä¸ªæ˜¯é»˜è®¤å€¼ã€‚å¦‚æœæ³¨è§£æ˜¯@Param(â€œpersonâ€)ï¼Œé‚£ä¹ˆå‚æ•°å°±ä¼šè¢«å‘½åä¸º#{person}ã€‚ @SelectKey æ–¹æ³• <selectKey> è¿™ä¸ªæ³¨è§£çš„åŠŸèƒ½ä¸<selectKey>æ ‡ç­¾å®Œå…¨ä¸€è‡´ï¼Œç”¨åœ¨å·²ç»è¢«@Insertæˆ–@InsertProvideræˆ–@Updateæˆ–@UpdateProvideræ³¨è§£äº†çš„æ–¹æ³•ä¸Šã€‚è‹¥åœ¨æœªè¢«ä¸Šè¿°å››ä¸ªæ³¨è§£çš„æ–¹æ³•ä¸Šä½œ@SelectKeyæ³¨è§£åˆ™è§†ä¸ºæ— æ•ˆã€‚å¦‚æœä½ æŒ‡å®šäº†@SelectKeyæ³¨è§£ï¼Œé‚£ä¹ˆMyBatiså°±ä¼šå¿½ç•¥æ‰ç”±@Optionsæ³¨è§£æ‰€è®¾ç½®çš„ç”Ÿæˆä¸»é”®æˆ–è®¾ç½®ï¼ˆconfigurationï¼‰å±æ€§ã€‚å±æ€§æœ‰ï¼šstatementå¡«å…¥å°†ä¼šè¢«æ‰§è¡Œçš„SQLå­—ç¬¦ä¸²æ•°ç»„ï¼ŒkeyPropertyå¡«å…¥å°†ä¼šè¢«æ›´æ–°çš„å‚æ•°å¯¹è±¡çš„å±æ€§çš„å€¼ï¼Œbeforeå¡«å…¥trueæˆ–falseä»¥æŒ‡æ˜SQLè¯­å¥åº”è¢«åœ¨æ’å…¥è¯­å¥çš„ä¹‹å‰è¿˜æ˜¯ä¹‹åæ‰§è¡Œã€‚resultTypeå¡«å…¥keyPropertyçš„Javaç±»å‹å’Œç”¨Statementã€PreparedStatementå’ŒCallableStatementä¸­çš„STATEMENTã€PREPAREDæˆ–CALLABLEä¸­ä»»ä¸€å€¼å¡«å…¥statementTypeã€‚é»˜è®¤å€¼æ˜¯PREPAREDã€‚ @ResultMap æ–¹æ³• N&#x2F;A è¿™ä¸ªæ³¨è§£ç»™@Selectæˆ–è€…@SelectProvideræä¾›åœ¨XMLæ˜ å°„ä¸­çš„<resultMap>çš„idã€‚è¿™ä½¿å¾—æ³¨è§£çš„selectå¯ä»¥å¤ç”¨é‚£äº›å®šä¹‰åœ¨XMLä¸­çš„ResultMapã€‚å¦‚æœåŒä¸€selectæ³¨è§£ä¸­è¿˜å­˜åœ¨@Resultsæˆ–è€…@ConstructorArgsï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ³¨è§£å°†è¢«æ­¤æ³¨è§£è¦†ç›–ã€‚ @ResultType æ–¹æ³• N&#x2F;A æ­¤æ³¨è§£åœ¨ä½¿ç”¨äº†ç»“æœå¤„ç†å™¨çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿”å›ç±»å‹ä¸ºvoidï¼Œæ‰€ä»¥Mybatiså¿…é¡»æœ‰ä¸€ç§æ–¹å¼å†³å®šå¯¹è±¡çš„ç±»å‹ï¼Œç”¨äºæ„é€ æ¯è¡Œæ•°æ®ã€‚å¦‚æœæœ‰XMLçš„ç»“æœæ˜ å°„ï¼Œè¯·ä½¿ç”¨@ResultMapæ³¨è§£ã€‚å¦‚æœç»“æœç±»å‹åœ¨XMLçš„<select>èŠ‚ç‚¹ä¸­æŒ‡å®šäº†ï¼Œå°±ä¸éœ€è¦å…¶ä»–çš„æ³¨è§£äº†ã€‚å…¶ä»–æƒ…å†µä¸‹åˆ™ä½¿ç”¨æ­¤æ³¨è§£ã€‚æ¯”å¦‚ï¼Œå¦‚æœ@Selectæ³¨è§£åœ¨ä¸€ä¸ªå°†ä½¿ç”¨ç»“æœå¤„ç†å™¨çš„æ–¹æ³•ä¸Šï¼Œé‚£ä¹ˆè¿”å›ç±»å‹å¿…é¡»æ˜¯voidå¹¶ä¸”è¿™ä¸ªæ³¨è§£ï¼ˆæˆ–è€…@ResultMapï¼‰å¿…é€‰ã€‚è¿™ä¸ªæ³¨è§£ä»…åœ¨æ–¹æ³•è¿”å›ç±»å‹æ˜¯voidçš„æƒ…å†µä¸‹ç”Ÿæ•ˆã€‚ @Flush æ–¹æ³• N&#x2F;A å¦‚æœä½¿ç”¨äº†è¿™ä¸ªæ³¨è§£ï¼Œå®šä¹‰åœ¨Mapperæ¥å£ä¸­çš„æ–¹æ³•èƒ½å¤Ÿè°ƒç”¨SqlSession#flushStatements()æ–¹æ³•ã€‚ï¼ˆMybatis3.3åŠä»¥ä¸Šï¼‰","date":"2024-12-31","categories":["java"],"tags":["mybatis"]},{"title":"mybatis-æ·±å…¥ç†è§£mybatis(6)mybatisæ’ä»¶å’Œåº•å±‚å®ç°åŸç†","url":"/2024/12/31/mybatis-æ·±å…¥ç†è§£mybatis-6-mybatisæ’ä»¶å’Œåº•å±‚å®ç°åŸç†/","content":"æ·±å…¥ç†è§£mybatisï¼ˆå…­ï¼‰mybatisæ’ä»¶å’Œåº•å±‚å®ç°åŸç†æ’ä»¶ï¼ˆpluginsï¼‰MyBatis å…è®¸ä½ åœ¨å·²æ˜ å°„è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­çš„æŸä¸€ç‚¹è¿›è¡Œæ‹¦æˆªè°ƒç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒMyBatis å…è®¸ä½¿ç”¨æ’ä»¶æ¥æ‹¦æˆªçš„æ–¹æ³•è°ƒç”¨åŒ…æ‹¬ï¼š Executor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed) ParameterHandler (getParameterObject, setParameters) ResultSetHandler (handleResultSets, handleOutputParameters) StatementHandler (prepare, parameterize, batch, update, query) è¿™äº›ç±»ä¸­æ–¹æ³•çš„ç»†èŠ‚å¯ä»¥é€šè¿‡æŸ¥çœ‹æ¯ä¸ªæ–¹æ³•çš„ç­¾åæ¥å‘ç°ï¼Œæˆ–è€…ç›´æ¥æŸ¥çœ‹ MyBatis çš„å‘è¡ŒåŒ…ä¸­çš„æºä»£ç ã€‚ å‡è®¾ä½ æƒ³åšçš„ä¸ä»…ä»…æ˜¯ç›‘æ§æ–¹æ³•çš„è°ƒç”¨ï¼Œé‚£ä¹ˆä½ åº”è¯¥å¾ˆå¥½çš„äº†è§£æ­£åœ¨é‡å†™çš„æ–¹æ³•çš„è¡Œä¸ºã€‚ å› ä¸ºå¦‚æœåœ¨è¯•å›¾ä¿®æ”¹æˆ–é‡å†™å·²æœ‰æ–¹æ³•çš„è¡Œä¸ºçš„æ—¶å€™ï¼Œä½ å¾ˆå¯èƒ½åœ¨ç ´å MyBatis çš„æ ¸å¿ƒæ¨¡å—ã€‚ è¿™äº›éƒ½æ˜¯æ›´ä½å±‚çš„ç±»å’Œæ–¹æ³•ï¼Œæ‰€ä»¥ä½¿ç”¨æ’ä»¶çš„æ—¶å€™è¦ç‰¹åˆ«å½“å¿ƒã€‚ é€šè¿‡ MyBatis æä¾›çš„å¼ºå¤§æœºåˆ¶ï¼Œä½¿ç”¨æ’ä»¶æ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€å®ç° Interceptor æ¥å£ï¼Œå¹¶æŒ‡å®šäº†æƒ³è¦æ‹¦æˆªçš„æ–¹æ³•ç­¾åå³å¯ã€‚","date":"2024-12-31","categories":["java"],"tags":["mybatis"]},{"title":"mybatis-æ·±å…¥ç†è§£mybatis(7)mybatiså’Œspringç»“åˆ","url":"/2024/12/31/mybatis-æ·±å…¥ç†è§£mybatis-7-mybatiså’Œspringç»“åˆ/","content":"æ·±å…¥ç†è§£mybatisï¼ˆä¸ƒï¼‰mybatiså’Œspringç»“åˆå®ç°mybatiså’Œspringçš„æ•´åˆçš„æ—¶å€™æ³¨æ„springåœ¨å’Œmybatisæ•´åˆçš„æ—¶å€™éœ€è¦ä½¿ç”¨é¢å¤–çš„ä¾èµ–é…ç½® SqlSessionFactoryBeanåœ¨åŸºæœ¬çš„ MyBatis ä¸­,session å·¥å‚å¯ä»¥ä½¿ç”¨ SqlSessionFactoryBuilder æ¥åˆ›å»ºã€‚è€Œåœ¨ MyBatis-Spring ä¸­,åˆ™ä½¿ç”¨ SqlSessionFactoryBean æ¥æ›¿ä»£ã€‚ è¦æ³¨æ„è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸éœ€è¦æ˜¯ä¸€ä¸ªå®Œæ•´çš„ MyBatis é…ç½®ã€‚ç¡®åˆ‡åœ°è¯´,ä»»æ„ç¯å¢ƒ,æ•°æ®æº å’Œ MyBatis çš„äº‹åŠ¡ç®¡ç†å™¨éƒ½ä¼šè¢«å¿½ç•¥ã€‚SqlSessionFactoryBean ä¼šåˆ›å»ºå®ƒè‡ªå·±çš„,ä½¿ç”¨è¿™äº› å€¼å®šåˆ¶ MyBatis çš„ Environment æ—¶æ˜¯éœ€è¦çš„ã€‚ å¦‚æœMyBatisæ˜ å°„å™¨XMLæ–‡ä»¶åœ¨å’Œæ˜ å°„å™¨ç±»ç›¸åŒçš„è·¯å¾„ä¸‹ä¸å­˜åœ¨,é‚£ä¹ˆå¦å¤–ä¸€ä¸ªéœ€è¦ é…ç½®æ–‡ä»¶çš„åŸå› å°±æ˜¯å®ƒäº†ã€‚ä½¿ç”¨è¿™ä¸ªé…ç½®,æœ‰ä¸¤ç§é€‰æ‹©ã€‚ç¬¬ä¸€æ˜¯æ‰‹åŠ¨åœ¨ MyBatis çš„ XML é… ç½®æ–‡ä»¶ä¸­ä½¿ç”¨éƒ¨åˆ†æ¥æŒ‡å®šç±»è·¯å¾„ã€‚ç¬¬äºŒæ˜¯ä½¿ç”¨å·¥å‚beançš„mapperLocationså±æ€§ã€‚ ä»¥ä¸Šé…ç½®æ–‡ä»¶ç›¸å½“äºä»¥ä¸‹javaè¯­å¥ è¦æ³¨æ„ SqlSessionFactoryBean å®ç°äº† Spring çš„ FactoryBean æ¥å£(è¯·å‚è€ƒ Spring æ–‡ æ¡£çš„ 3.8 ç« èŠ‚)è¿™å°±è¯´æ˜äº†ç”± Spring æœ€ç»ˆåˆ›å»ºçš„ bean ä¸æ˜¯ SqlSessionFactoryBean æœ¬èº«, ã€‚ è€Œæ˜¯å·¥å‚ç±»çš„ getObject()è¿”å›çš„æ–¹æ³•çš„ç»“æœã€‚ æ·»åŠ äº‹ç‰©ç®¡ç†å¾ˆç®€å•åªè¦å°†å£°æ˜å¹¶ä¸”ä¼ å…¥SqlSessionFactoryBeanä¸­çš„datasourceæ·»åŠ ä¸Šç›¸å…³äº‹åŠ¡æ€§æ“ä½œçš„å°±å¥½äº† å’Œ ä¸€èˆ¬çš„springäº‹åŠ¡é…ç½®ç›¸åŒ ä½¿ç”¨ SqlSessionTemplate ä»£æ›¿sqlSessionSqlSessionTemplate å¯¹è±¡å¯ä»¥ä½¿ç”¨ SqlSessionFactory ä½œä¸ºæ„é€ æ–¹æ³•çš„å‚æ•°æ¥ä»£æ›¿Sqlsessionã€‚åº”ä¸ºå®ƒå®ç°äº†Sqlsessionæ¥å£&#96; å°†SqlSessioné…ç½®åˆ°beanä¸­ javaä»£ç ä½¿ç”¨æ³¨å…¥è¿›æ¥çš„SqlSession SqlSessionTemplate æœ‰ä¸€ä¸ªä½¿ç”¨ ExecutorType ä½œä¸ºå‚æ•°çš„æ„é€ æ–¹æ³•ã€‚è¿™å…è®¸ä½ ç”¨æ¥ åˆ›å»ºå¯¹è±¡,æ¯”å¦‚,ä¸€ä¸ªæ‰¹é‡ SqlSession,ä½†æ˜¯ä½¿ç”¨äº†ä¸‹åˆ— Spring é…ç½®çš„ XML æ–‡ä»¶: ç°åœ¨ä½ æ‰€æœ‰çš„è¯­å¥å¯ä»¥æ‰¹é‡æ“ä½œäº†,ä¸‹é¢çš„è¯­å¥å°±å¯ä»¥åœ¨ DAO ä¸­ä½¿ç”¨äº†ã€‚ MapperFactoryBeanä¸ºäº†ä»£æ›¿æ‰‹å·¥ä½¿ç”¨ SqlSessionDaoSupport æˆ– SqlSessionTemplate ç¼–å†™æ•°æ®è®¿é—®å¯¹è±¡ (DAO)çš„ä»£ç ,MyBatis-Spring æä¾›äº†ä¸€ä¸ªåŠ¨æ€ä»£ç†çš„å®ç°:MapperFactoryBeanã€‚è¿™ä¸ªç±» å¯ä»¥è®©ä½ ç›´æ¥æ³¨å…¥æ•°æ®æ˜ å°„å™¨æ¥å£åˆ°ä½ çš„ service å±‚ bean ä¸­ã€‚å½“ä½¿ç”¨æ˜ å°„å™¨æ—¶,ä½ ä»…ä»…å¦‚è°ƒ ç”¨ä½ çš„ DAO ä¸€æ ·è°ƒç”¨å®ƒä»¬å°±å¯ä»¥äº†,ä½†æ˜¯ä½ ä¸éœ€è¦ç¼–å†™ä»»ä½• DAO å®ç°çš„ä»£ç ,å› ä¸º MyBatis-Spring å°†ä¼šä¸ºä½ åˆ›å»ºä»£ç†ã€‚ é…ç½®æ–¹æ³• é€šè¿‡é…ç½®å¾—åˆ°çš„beanç­‰ä»·äºä½¿ç”¨sqlSession.getMapper(xxx.class);æ–¹æ³•çš„è¿”å›ç»“æœ æ³¨æ„ï¼šä¼ å…¥çš„æ¥å£ä¿¡æ¯ï¼Œåº”è¯¥å¯ä»¥åœ¨ä¼ å…¥çš„SqlSessionFactoryé…ç½®çš„mapperæ˜ å°„æ–‡ä»¶ä¸­æœ‰ç›¸åº”çš„namespace æ³¨æ„,å½“ MapperFactoryBean éœ€è¦ SqlSessionFactory æˆ– SqlSessionTemplate æ—¶ã€‚ è¿™äº›å¯ä»¥é€šè¿‡å„è‡ªçš„ SqlSessionFactory æˆ– SqlSessionTemplate å±æ€§æ¥è®¾ç½®, æˆ–è€…å¯ä»¥ç”± Spring æ¥è‡ªåŠ¨è£…é…ã€‚å¦‚æœä¸¤ä¸ªå±æ€§éƒ½è®¾ç½®äº†,é‚£ä¹ˆ SqlSessionFactory å°±ä¼šè¢«å¿½ç•¥,å› ä¸º SqlSessionTemplate æ˜¯éœ€è¦æœ‰ä¸€ä¸ª session å·¥å‚çš„è®¾ç½®; é‚£ä¸ªå·¥å‚ä¼šç”± MapperFactoryBean. æ¥ä½¿ç”¨ã€‚ å¯ä»¥ç›´æ¥åœ¨ business&#x2F;service å¯¹è±¡ä¸­ä»¥å’Œæ³¨å…¥ä»»æ„ Spring bean çš„ç›¸åŒæ–¹å¼ç›´æ¥æ³¨å…¥æ˜  å°„å™¨: ä½¿ç”¨MapperScannerConfigurerç®€åŒ–é…ç½®ä½¿ç”¨mapperFactoryBeançš„æ—¶å€™æ„Ÿè§‰æ¯ä¸€ä¸ªæ˜ å°„æ¥å£éƒ½è¦è¿›è¡Œç›¸å…³çš„é…ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸ºä¸€ä¸ªå¯ä»¥è‡ªåŠ¨è¿›è¡Œæ‰€æœ‰é…ç½®çš„æ•´åˆé…ç½®æ–¹æ³• è¿™ä¸ªæ³¨è§£å¯ä»¥æ›¿ä»£mapperFactoryBeanï¼Œè€Œä¸”ï¼Œåªè¦æŒ‡å®šåŒ…åç§°ï¼Œæ¡†æ¶å°†ä¼šè‡ªåŠ¨æŒ‰ç…§springæ³¨è§£çš„å‘½åè§„åˆ™å°†ç›¸å…³æ¥å£æ³¨å…¥åˆ°springçš„å‘½åç©ºé—´ä¸­ï¼ˆå¯ä»¥ä½¿ç”¨springçš„è‡ªåŠ¨æ‰«ææ³¨è§£ï¼ŒæŒ‡å®šæ˜ å°„åç§°ï¼‰ 2018å¹´8æœˆè¡¥å…… é€šè¿‡é˜…è¯»æºä»£ç å‘ç° @Mapperè¿™ä¸ªæ³¨è§£åœ¨spring-mybatiså’Œmybatis æœ¬èº«ä¸­æ›´æœ¬ä¸èµ·é“ä»»ä½•ä½œç”¨ï¼Œåªæœ‰åœ¨spring bootä¸­æœ‰è¿‡ä½¿ç”¨ï¼ˆä¸è¿‡å¤§å¤šæ•°çš„éƒ½æ˜¯ç›´æ¥ä½¿ç”¨@MapperScanï¼‰ ä¸€ä¸ªå®ä¾‹ mybatisçš„ç›¸å…³é…ç½®æ–‡ä»¶ mybatis-config.xml mymapper.xml beanç›¸å…³é…ç½®æ–‡ä»¶å’Œæ•°æ®åº“è¿æ¥æ± ç›¸å…³é…ç½® datasource.properties bean.xml ä½¿ç”¨mapperconfigè¿›è¡Œé…ç½® javabeanâ€“org.useråŒ… mybatisæ˜ å°„æ¥å£-org.daoåŒ… è¿™é‡Œè¦æ³¨æ„ï¼šmybatiså‚æ•°ä¼ é€’çš„è§„åˆ™ï¼Œé»˜è®¤åªèƒ½ä¼ å…¥ä¸€ä¸ªç±»ï¼Œå¦‚æœæ˜¯åŸºæœ¬ç±»å‹ ä½¿ç”¨#{xxx}(xxxä¸ºä»»æ„å­—æ®µ)å°±å¯ä»¥è¿›è¡Œå¯¼å…¥ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªç±»#{xxx}(xxxä¸ºç±»ä¸­çš„ä»»æ„å±æ€§)ï¼Œå½“ä½¿ç”¨@Paramæ³¨è§£æ—¶å€™ï¼Œä½¿ç”¨çš„æ—¶å€™å¿…é¡»ç›¸å¯¹åº”çš„åç§°ï¼ˆåº•å±‚mybatis æŠŠä»–å‚æ•°å˜æˆmapç±»å‹äº†ï¼‰ æ•°æ®åº“åº”ç”¨æœåŠ¡ç±»-org.service mainå‡½æ•°","date":"2024-12-31","categories":["java"],"tags":["mybatis"]},{"title":"mybatis-æ·±å…¥ç†è§£mybatis(8)mybatisåå°„å±‚è®¾è®¡","url":"/2024/12/31/mybatis-æ·±å…¥ç†è§£mybatis-8-mybatisåå°„å±‚è®¾è®¡/","content":"mybatis æ•´ä½“åå°„æ¡†æ¶è®¾è®¡ å¯ä»¥çœ‹åˆ°ï¼ŒMybatiså¯¹è¿™ä¸€å—æŠ½è±¡çš„æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰å‡ ä¸ªæ¯”è¾ƒä¸»è¦çš„éƒ¨åˆ†ï¼šReflectorã€Invokerã€PropertyTokenizerã€MetaClassï¼ŒMetaObjectå’ŒObjectWrapperï¼Œä¸‹é¢æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªè§£æè¿™å‡ ä¸ªéƒ¨åˆ†ï¼Œæœ€ååˆå¹¶åœ¨ä¸€èµ·çœ‹çœ‹ä»–ä»¬æ˜¯å¦‚ä½•åä½œå·¥ä½œçš„ã€‚ Reflectoræˆ‘å¯¹Reflectorçš„ç†è§£æ˜¯ Reflectoræ˜¯å¯¹ç±»çš„æè¿° ï¼Œæˆ‘ä»¬ä»ä¸€æ®µUTå¼€å§‹ï¼ˆä»£ç ä½äºReflectorTestï¼‰ï¼š è¿™ä¸ªæµ‹è¯•æ–¹æ³•é¦–å…ˆåˆ›å»ºäº†ä¸ªReflectorFactoryå¯¹è±¡ï¼Œç„¶åç”¨è¿™ä¸ªfactoryåˆ›å»ºäº†ä¸€ä¸ªSectionç±»çš„Reflectorï¼Œç„¶ååˆ¤æ–­Sectionç±»ä¸­idçš„setteræ–¹æ³•æ˜¯Longç±»å‹çš„ã€‚ ReflectorFactoryæ˜¯å¯¹Reflectoråšçš„ä¸€ä¸ªç®€å•çš„å·¥å‚ï¼Œæä¾›ç±»åå°„çš„ç¼“å­˜ï¼ˆæ‰€ä»¥åå°„è¿™å—çš„å¼€é”€åŸºæœ¬ä¸Šå¯ä»¥ä¸è®¡äº†ï¼Œæ—¢çµæ´»åˆå¿«æ·ï¼‰ DefaultReflectorFactory æ˜¯ Reflectorçš„é»˜è®¤å®ç°ç±»ï¼Œç”¨ä¸€ä¸ªConcurrentMapç¼“å­˜æ‰€æœ‰çš„Reflectorç¤ºä¾‹ï¼Œå®ƒçš„findForClassæ–¹æ³•å¦‚ä¸‹ï¼Œå®ƒé¦–å…ˆå°è¯•ä»mapä¸­è·å–Reflectorï¼Œè·å–å¤±è´¥è°ƒç”¨Reflectorçš„æ„é€ æ–¹æ³•åˆ›å»ºç¤ºä¾‹ï¼Œç¼“å­˜å¹¶è¿”å›ï¼š ä¹‹åæ˜¯Reflectorçš„æ„é€ æ–¹æ³•ï¼š è¿™ä¸€å—ä¸å†ç»†ç»†å±•å¼€ï¼Œæ–¹æ³•åè§åçŸ¥ä¹‰ï¼Œé¦–å…ˆå°†typeæˆå‘˜è®¾ç½®ä¸ºåŸå§‹çš„classå¯¹è±¡ï¼Œä¹‹åè·å–classçš„æ„é€ æ–¹æ³•ï¼Œgetter&#x2F;setterå±æ€§ï¼Œæˆå‘˜å­—æ®µï¼Œä¹‹åå°†å±æ€§åè½¬å¤§å†™å­˜æ”¾åˆ°caseInsensitivePropertyMapä¸­ï¼Œä¸ºäº†åé¢çš„æŸ¥æ‰¾ï¼Œå¤§å°å†™ä¸æ•æ„Ÿã€‚ Reflectorçš„å…¶ä»–æ–¹æ³•å°±æ˜¯å¯¹æˆ‘ä»¬ä¿å­˜çš„è¿™äº›ç±»çš„æè¿°åšæŸ¥æ‰¾ï¼Œ å…¶ä¸­æœ‰ä¸¤ä¸ªç‰¹åˆ«çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦è®¨è®ºçš„ getSetInvokerå’Œ getGetInvoker InvokerInvokerï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯è°ƒç”¨ï¼Œå¯ä»¥è°ƒç”¨çš„ä¸œè¥¿ï¼Œä»–æœ‰ä¸€ä¸ªinvokeæ–¹æ³•ï¼Œæ„æ€å°±æ˜¯è°ƒç”¨ï¼Œå‚æ•°æ˜¯targetå’Œargsï¼Œå°±æ˜¯è°ƒç”¨çš„å¯¹è±¡å’Œè°ƒç”¨çš„å‚æ•°ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸‹å®ƒçš„å‡ ä¸ªå®ç°ç±»ï¼š MethodInvoker: æ–¹æ³•è°ƒç”¨ SetFieldInvokerï¼šSetteræ–¹æ³•è°ƒç”¨ GetFieldInvokerï¼šGetteræ–¹æ³•è°ƒç”¨MethodInvokerä¸­invokeæ–¹æ³•çš„å®ç°ï¼š å°±æ˜¯ç®€å•çš„method.invoke PropertyTokenizerè¿™ä¸ªå°±æ¯”è¾ƒç‰›é€¼äº†ï¼Œä»–å¯ä»¥å¤„ç†å±æ€§è¡¨è¾¾å¼ï¼ŒPropertyTokenizerè¿˜å®ç°äº†Iteratoræ¥å£ï¼Œè¿™æ„å‘³ç€ä»–å¯ä»¥å¤„ç†å¤æ‚çš„åµŒå¥—å±æ€§ å­—æ®µçš„å«ä¹‰ï¼Œnameè¡¨ç¤ºå½“å‰å¯¹è±¡çš„åå­—ï¼ŒindexedNameæ˜¯å½“å‰å¯¹è±¡çš„åå­—åŠ ä¸Šåé¢çš„ç´¢å¼•ï¼ˆ[]ï¼‰å¦‚æœæœ‰çš„è¯ï¼Œindexæ˜¯ç´¢å¼•ä¸‹æ ‡ï¼Œchildrenæ˜¯å»¶ä¼¸å±æ€§ï¼ˆå­å¯¹è±¡ï¼‰æ¯”å¦‚ï¼šç”¨PropertyTokenizerå»è§£æ â€œrichType.richList[0].valueâ€ï¼Œé‚£ä¹ˆ name&#x3D;richType, indexedName&#x3D;richTypeï¼Œindex&#x3D;nullï¼Œchildren&#x3D;richList[0].valueä¹‹åæ‰§è¡Œtokenizer.next()å¾—åˆ°æ–°çš„tokenizerï¼Œæ­¤æ—¶ name&#x3D;richList, indexdName&#x3D;richList[0],index&#x3D;0, children&#x3D;valueä¹‹åæˆ‘ä»¬ä¼šç»“åˆMetaClasså’ŒMetaObjectçœ‹çœ‹ä»–æœ‰å¤šç‰›é€¼ MetaClassMetaClasså®é™…ä¸Šæ˜¯å¯¹Reflectorå’ŒProeprtyTokenizerçš„ä¸€ç§ç»“åˆï¼Œæ˜¯æˆ‘ä»¬å¯ä»¥ç”¨å¤æ‚çš„å±æ€§è¡¨è¾¾å¼æ¥è·å–ç±»å‹çš„æè¿°ã€‚ åŒæ ·çš„ï¼Œæˆ‘ä»¬ç»“åˆUTæ¥çœ‹çœ‹å®ƒæ˜¯æ€æ ·å·¥ä½œçš„ï¼Œé¦–å…ˆæ˜¯ä¸€ä¸ªç¤ºä¾‹çš„å¤æ‚ç±»å‹ RichType è¿™æ®µä»£ç è¯´æ˜äº†metaClass.hasGetteræ–¹æ³•å¯ä»¥æ¥å—ä¸€ä¸ªå¤æ‚çš„å±æ€§è¡¨è¾¾å¼æ¥æ‰¾åˆ°å¯¹åº”çš„ç±»å‹æè¿°ï¼ˆåˆ©ç”¨PropertyTokenizerï¼‰ï¼Œè¿™ä¸ªç¥å¥‡çš„åŠŸèƒ½æ˜¯è¿™ä¹ˆå®ç°çš„ï¼š é¦–å…ˆæ£€æŸ¥tokenizerçš„nameå­—æ®µå¯¹åº”çš„å±æ€§æ˜¯ä¸æ˜¯æœ‰getteræ–¹æ³•ï¼Œä¹‹åè¿­ä»£å­å±æ€§ï¼Œç›´åˆ°æœ€åï¼Œchildrenä¸ºç©ºã€‚ MetaClassä¸­çš„è¿˜æœ‰å‡ ä¸ªæ–¹æ³•çš„å®ç°å’Œè¿™ä¸ªç±»ä¼¼ï¼ŒhasSetter, getGetterType, getSetterType ä»¥ä¸Šéƒ½æ˜¯ç±»çº§åˆ«çš„åå°„æŠ½è±¡ï¼Œä¸‹é¢çœ‹çœ‹å¯¹è±¡çº§åˆ«çš„ ObjectWrapperObjectWrapperæ˜¯å¯¹å¯¹è±¡çš„æè¿°çš„æŠ½è±¡ï¼Œå®ƒæŠ½è±¡å‡ºä¸€ç³»åˆ—å¯¹å¯¹è±¡æè¿°çš„æŸ¥è¯¢å’Œæ›´æ–°çš„æ¥å£ ObjectWrapperæœ‰ä¸ªå‡ ä¸ªå®ç°ç±» BeanWrapperï¼ŒåŒ…è£…Javabeançš„æè¿°ï¼Œ MapWrapperï¼ŒåŒ…è£…Mapï¼ˆé”®å€¼å¯¹ï¼‰çš„æè¿° CollectionWrapperï¼ŒåŒ…è£…Collectionï¼ˆé›†åˆï¼‰çš„æè¿° ObjectWrapperFactory äº†æ“ä½œå®ä¾‹åŒ–ObjectWrapperçš„å·¥å‚æ–¹æ³•çš„æŠ½è±¡ï¼Œå¯è‡ªå®šä¹‰å®ç° MetaObjectMetaObjectä¹Ÿæ˜¯å¯¹å¯¹è±¡çš„æè¿°ï¼Œå®ƒä»£ç†äº†objectWrapperçš„å¤§éƒ¨åˆ†æ–¹æ³•ï¼Œå’ŒMetaClassä¸€æ ·ï¼Œå®ƒåˆ©ç”¨PropertyTokenizeråšäº†å¯¹å¤æ‚å±æ€§è¡¨è¾¾å¼çš„å¤„ç† MetaObjectæœ‰5ä¸ªæˆå‘˜å­—æ®µï¼Œ originalObjectï¼šåŸå§‹å¯¹è±¡ï¼Œ objectWrapperï¼Œè¢«åŒ…è£…çš„objectWrapperï¼Œ objectFactoryï¼Œå¯¹è±¡åˆ›å»ºå·¥å‚ï¼Œç”¨äºåœ¨setValueæ–¹æ³•ä¸­åˆ›å»ºä¸å­˜åœ¨çš„å¯¹è±¡å±æ€§å®ä¾‹ï¼Œ objectWrapperFactoryï¼Œåˆ›å»ºç‰¹å®šçš„objectWrapperï¼Œ reflectorFactoryï¼Œç”¨æ¥è‡ªå®šä¸€åå°„ç±»ç”Ÿæˆçš„ï¼Œå¦‚æœéœ€è¦å¯ä»¥è‡ªè¡Œçš„æ‰©å±• åä½œåå°„å±‚çš„ç±»äº’ç›¸åä½œï¼Œæœ€ç»ˆæ ¹æ®å…¥å‚åˆ¶ä½œå‡ºæ¥ä¸€ä¸ªå®Œç¾çš„MetaObjectå’ŒMetaClassç»™å…¶ä»–ç»„ä»¶ä½¿ç”¨ï¼Œè¿™å…¶ä¸­ï¼Œæ¯”è¾ƒé‡è¦çš„æ–¹æ³•æœ‰ï¼š Configuration.newMetaObjectï¼Œæ ¹æ®ä¼ å…¥çš„objectå’Œé…ç½®çš„factoryåˆ›å»ºå¯¹è±¡æè¿° å®é™…ä¸Šï¼ŒObjectFactoryï¼ŒObjectWrapperFactoryï¼ŒReflectorFactoryæ˜¯å¯ä»¥åœ¨XMLä¸­é…ç½®æˆè‡ªå®šä¹‰çš„ï¼Œå·¥å‚å¯¹è±¡å…¨å±€å•ä¾‹ï¼ˆConfigurationå¯¹è±¡ä¸­ï¼‰ XMlConfigBuilder.settingsAsPropertiesæ–¹æ³•ä½¿ç”¨MetaClassæ£€æŸ¥Propertieså‚æ•°æœ‰æ²¡æœ‰éæ³•çš„key MetaObjectå’ŒMetaClassåœ¨Sessionçš„æ‰§è¡Œå‘¨æœŸï¼ˆexecutor, mapping, builderâ€¦ï¼‰ä¸­è¿˜å…·æœ‰å¹¿æ³›çš„åº”ç”¨","date":"2024-12-31","categories":["java"],"tags":["mybatis"]},{"title":"mybatis-æ·±å…¥ç†è§£mybatis(9)mybatisè¿è¡ŒåŸç†å’Œåˆ†æ","url":"/2024/12/31/mybatis-æ·±å…¥ç†è§£mybatis-9-mybatisè¿è¡ŒåŸç†å’Œåˆ†æ/","content":"mybatis æ„å»ºè¿‡ç¨‹sessionfactory æ„å»ºsqlsessionmybatis ä½¿ç”¨sqlSessionåŒæ•°æ®åº“è¿›è¡Œç›¸å…³çš„æ“ä½œæ‰€ä»¥åœ¨ä½¿ç”¨ä¹‹å‰éœ€è¦è·å–è¿™ä¸ªç±»ï¼Œåœ¨mybatis ä¸­ä½¿ç”¨sessionfactory è¿›è¡Œ é€šå¸¸æƒ…å†µä¸‹ï¼Œmybatisä½¿ç”¨çš„æ˜¯SqlSessionFactoryBuilderçš„builderæ–¹æ³•è·å–sessionfacotry ï¼Œå…¶å®è¿™æ˜¯ä¸€ç§å°è£…ï¼ŒæŸ¥çœ‹æºä»£ç å¯çŸ¥ï¼Œå…¶å®ä»–æ˜¯å°è£…äº†ä¸€ä¸ªDefaultSqlSessionFactoryç±»,é€šè¿‡ä¼ å…¥çš„Configè¿›è¡Œåˆå§‹åŒ–çš„ å…¶å®é€šè¿‡ä¸Šé¢çš„åˆ†æå°±èƒ½çŸ¥é“å…¶å®åœ¨ä½¿ç”¨çš„Configurationç±»ï¼ˆè¿™ä¸ªç±»åŒ…å«äº†mybatiså‡ ä¹æ‰€æœ‰çš„é…ç½®ï¼‰ï¼Œæ¥åˆå§‹åŒ–SqlSessionfacotoryçš„ configurationå¯¹è±¡mybatisæ€»ä½“çš„é…ç½®æ–‡ä»¶åŒ…æ‹¬å¦‚ä¸‹çš„éƒ¨åˆ† propertiseï¼šå‚æ•°åç§° setting ï¼šè®¾ç½® typeAliasesï¼šåˆ«å typeHandlerï¼šç±»å‹å¤„ç†å™¨ ObjectFacotry: è¿”å›å€¼å¤„ç†å·¥å‚å¯¹è±¡ pluginï¼šæ’ä»¶ enviromentï¼šç¯å¢ƒå˜é‡ DataBaseIdProivderï¼šæ•°æ®åº“æ ‡è¯† Mapperï¼šæ˜ å°„å™¨ mybatisæœ€æ ¸å¿ƒè¿è¡Œè¿‡ç¨‹SqlSessioné¦–å…ˆçœ‹ä¸€ä¸‹SqlSessionè¿™ä¸ªæ¥å£çš„æºä»£ç  SqlSessionå®šä¹‰äº†å¯¹æ•°æ®åº“çš„åŸºæœ¬æ“ä½œï¼ŒCURDæ“ä½œï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•éœ€è¦æ³¨æ„getMapper è¿™ä¸ªæ–¹æ³•å°†ä¼šè¿”å›ä¸€ä¸ªMapperæ¥å£å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡çš„æ–¹æ³•å°±å¯ä»¥è¿›è¡Œå¢åˆ æ”¹ä»è€Œå¹¶ä¸éœ€è¦ä½¿ç”¨åŸæ¥çš„æ–¹æ³•è¿›è¡Œå¤„ç†,mapperæ­¤æ—¶å°±æˆä¸ºæ“ä½œæ•°æ®åº“çš„æ–¹æ³•äº†ï¼Œæ¥ä¸‹æ¥åˆ†æä¸€ä¸‹mapper æ·±å…¥åˆ†æmapperåˆå§‹åŒ–æœºåˆ¶ mybatisçš„mapperæ˜¯åœ¨ä¸€å¼€å§‹çš„æ—¶å€™å°±é€šè¿‡configå°±ç”Ÿæˆäº† ç•™å¿ƒconfiguration å¯¹è±¡ä¸­çš„mapperRegistry è¿™ä¸ªå±æ€§çš„å¯¹è±¡ï¼Œmybatisåˆå§‹åŒ–æ‰€æœ‰çš„mapperéƒ½å‚¨å­˜åœ¨è¿™ä¸ªå¯¹è±¡ä¹‹ä¸­ è·Ÿè¿›addMapperæ–¹æ³•å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªæ–¹æ³•çš„å¤„ç†æ–¹å¼å…¶å®æ˜¯è®©classä½œä¸ºå¥ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„ä»£ç†å¯¹è±¡MapperProxyFactoryä½œä¸ºå€¼å€¼å­˜å…¥knownMappersè¿™ä¸ªHashMap æ·±å…¥åˆ†æmapperçš„åˆå§‹åŒ–è°ƒç”¨æœºåˆ¶åœ¨SqlSession.getMapperè·å–Mapperçš„æ—¶å€™åŒæ ·æ˜¯é€šè¿‡è¿™ä¸ªæ–¹å¼åæ–¹å‘æ–¹æ³•è·å–MapperProxyFactoryè¿™ä¸ªå¯¹è±¡ ä»ä»£ç ä¸­å¯ä»¥çœ‹çœ‹å‡ºæ¥å…¶å®æ­¤æ—¶ä½¿ç”¨çš„mapperæ˜¯é€šè¿‡proxyfactoryç”Ÿæˆçš„ä»£ç†å¯¹è±¡ æˆ‘ä»¬éƒ½çŸ¥é“ä»£ç†æ˜¯æŒ‡å®šinvokeæ–¹æ³•æ¥å®ç°å›è°ƒçš„è¿™é‡Œæˆ‘ä»¬è·Ÿè¿›ä¸€ä¸‹çœ‹ä¸€ä¸‹mapperProxyçš„ä»£ç  å…¶å®è·Ÿè¸ªåˆ°è¿™é‡Œå·²ç»éå¸¸æ˜ç¡®çš„ å…¶å®ä»–æ˜¯ä½¿ç”¨äº†mapperMethod.execute(sqlSession, args)æ¥æ‰§è¡Œè¯­å¥ï¼Œçœ‹ä¸€ä¸‹ ä»£ç é€»è¾‘éå¸¸æ¸…æ™°å…¶å®å°±æ˜¯ä½¿ç”¨sqlSessionçš„å¯¹åº”æ–¹æ³•ï¼Œmapperçš„æŠ¥ååŠ ä¸Šç±»åæ„æˆäº†ä¸€å¼€å§‹çš„åç§° åˆ†æSqlSessionè¿è¡Œç›¸å…³æ•°æ®åº“æ“ä½œçš„è¯¦ç»†åˆ†æé€šè¿‡æºä»£ç åˆ†æå…¶å®æœ€ç»ˆæƒ…å†µä¸‹sqlå°†æ“ä½œåˆ†æˆäº†ä¸¤ç§ç±»å‹ doupdateç±»å‹å’Œqueryè¿™é‡Œå…ˆçœ‹ä¸€ä¸‹query çœŸæ­£æ‰§è¡Œç›¸å…³çš„queryæ“ä½œçš„æ–¹æ³•æ˜¯deQueryæ–¹æ³•(executorç±»çš„doQuery) ä»ä¸Šé¢çš„æ–¹æ³•ä¸­æˆ‘ä»¬å¯ä»¥çœ‹è§ä¸€ä¸ªæ–¹æ³•å«MappedStatement,è§‚å¯Ÿä¸€ä¸‹ä»–çš„äº§ç”Ÿ MappedStatement äº§ç”Ÿè¿‡ç¨‹é€šè¿‡è·å–æ–¹æ³•å¯ä»¥åˆ¤æ–­å‡º,è¿™ä¸ªç±»å…¶å®æ˜¯ä¸€å¼€å°±åœ¨configrationé…ç½®æˆåŠŸçš„ å¦‚æœè·Ÿè¸ªä¸€å¼€å§‹åˆå§‹åŒ–çš„çŠ¶æ€éœ€è¦è·Ÿè¸ªåˆ°SqlSessionFactoryBuilderç±»ä¸­,ä¸€å¼€å§‹mybatisså°†æ‰€æœ‰çŠ¶æ€åˆå§‹åŒ–çš„è¿‡ç¨‹ SqlSessionFactoryBuilderåœ¨é»˜è®¤æƒ…å†µä¸‹ä¼šä½¿ç”¨XMLConfigBuilderæ¥ç”Ÿæˆconfigration æ¥ä¸‹æ¥è·Ÿè¸ªè¿›å»å‘ç°äº†åˆå§‹åŒ–ä¸€ä¸ªç±»XPathParser,å¹¶ä¸”ä½¿ç”¨åµŒå¥—æ„é€ å‡½æ•°çš„æ–¹æ³•è¿›è¡Œæ–¹æ³•åµŒå¥—ä½¿ç”¨ è¿™ä¸ªç±»å…¶å®å°±æ˜¯å°†xmlæ–‡ä»¶æ•´ç†æˆnodeèŠ‚ç‚¹çš„å½¢å¼æ–¹ä¾¿ä¹‹åçš„è°ƒç”¨,å…¶å®æ˜¯ä¸€ä¸ªè§£æç”¨çš„å·¥å…· ç„¶åä¸Šè°ƒç”¨è€…(sqlSessionFactoryBuilder)å°†ä¼šè°ƒç”¨XMLConfigBuilderçš„parseæ–¹æ³•è¿›è¡Œç”Ÿäº§configrationå¯¹è±¡è¿™é‡Œæ‰æ˜¯æ•´ä¸ªmybatisé…ç½®çœŸæ­£äº§ç”Ÿçš„åœ°æ–¹ ç»ˆäºåˆ°äº†å…³é”®çš„åœ°æ–¹MappedStatementçš„ç”Ÿæˆéƒ¨åˆ†,MappedStatementç”±åç§°å°±èƒ½çŸ¥é“æ˜¯ä»mapperElement()æ–¹æ³•ä¸­äº§ç”Ÿçš„ åœ¨XMLConfigBuilderä¸­å®šä¹‰çš„è¿™ä¸ªæ–¹æ³• æˆ‘æˆªå–äº†ä¸€æ®µä»£ç è¿™æ®µä»£ç æ˜¯å¤„ç†ä½¿ç”¨åŒ…åæ‰«æmapperçš„ä»£ç ,è¿›å…¥åˆ°å…¶ä¸­çš„configuration.addMappers(mapperPackage);æ–¹æ³•,å‘ç°è¿™é‡Œä½¿ç”¨äº†configrationä¸­çš„addMappersæ–¹æ³•,è¿›å…¥åˆ°mapperRegistryç±»çš„è¿™ä¸ªæ–¹æ³•ä¸­ è·Ÿè¸ªåˆ°è¿™é‡Œå…¶å®æ€è·¯æ¯”è¾ƒæ¸…æ™°äº†,è¿™é‡Œå°±æ˜¯åˆå§‹åŒ–ä¸€ä¸ªmapperå’Œmapperä¸­å„ç§mathodçš„åœ°æ–¹ï¼ˆMapperRegistryï¼‰ æ³¨æ„åˆ°MapperStatueså’ŒMethodæ˜¯ä¸€ä¸€å¯¹åº”çš„ è€ŒMappedStatementçš„åˆå§‹åŒ–å°±åœ¨è¿™ä¸ªMapperAnnotationBuilder.parse() ä»ä¸Šé¢æˆ‘ä»¬å°±å¯ä»¥å¾—å‡ºMapperStatementçš„ä½œç”¨å°±æ˜¯é…ç½®ä¸€ä¸ªsqlçš„å„ç§ä¿¡æ¯ï¼Œæ¯”å¦‚æ“ä½œæ–¹æ³•ï¼ˆselect|upadteç­‰ï¼‰ï¼Œé…ç½®çš„sql ï¼Œ sqlçš„id ï¼Œç¼“å­˜ä¿¡æ¯ï¼ŒresultMapï¼ŒparameterTypeï¼ŒresultTypeï¼ŒlanguageDriverï¼Œç­‰","date":"2024-12-31","categories":["java"],"tags":["mybatis"]},{"title":"mybatis-æºç é˜…è¯»è®°å½•(1)-buildingåŒ…","url":"/2024/12/31/mybatis-æºç é˜…è¯»è®°å½•-1--buildingåŒ…/","content":"building åŒ…æ˜¯ç”¨æ¥æ„é€ Mapperçš„åŒ…å«å¦‚ä¸‹çš„ç±» buildingåŒ…è´Ÿè´£æ¥å£ mapper æ¨¡å¼çš„ä»£ç†ç±»,å…¶ä¸­mapperProxyå®ç”¨äº†java7 çš„æ”¾å°„æ–°ç‰¹æ€§è¿™ä¸ªéœ€è¦æ³¨æ„ä¸€ä¸‹ building åŒ…","date":"2024-12-31","categories":["java"],"tags":["mybatis"]},{"title":"netty-(0)-netty demo å’Œnettyçš„åŸºæœ¬ç»„å»º","url":"/2024/12/31/netty--0--netty-demo-å’Œnettyçš„åŸºæœ¬ç»„å»º/","content":"netty(0)-netty demo å’Œnettyçš„åŸºæœ¬ç»„å»ºä¸€.é¦–å…ˆå±•ç¤ºè¿™ä¸ªdemoçš„ç›®å½•ç»“æ„EchoClient å’Œ EchoServer åˆ†åˆ«è¡¨ç¤º å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„è¿è¡Œç¨‹åºï¼Œå¯¹åº”çš„Handler æ•°æ®è°ƒç”¨çš„æ—¶å€™ç›¸å…³çš„æ“ä½œæ–¹æ³• äºŒ.ä»£ç  choClient.class EchoClientHandler.class EchoServer.class EchoServerHandler.class ä»‹ç»ä¸€ä¸‹nettyçš„åŸºæœ¬ç»„æˆæœ‰é‚£äº›Bootstrapè¿™ä¸ªåŸºæœ¬ç±»æ˜¯ä¸€ä¸ªä¾¿åˆ©çš„åŸºæœ¬å·¥å‚ç”¨æ¥å®ç°netty å¿«é€Ÿé…ç½®çš„æ–¹æ³•ç±» bootstrapå®ç°nettyå¿«é€Ÿé…ç½®çš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„ netty å…¶å®æä¾›äº†ä¸¤ç»„çš„bootstrap ï¼Œ å’ŒserverBootstrap åˆ†åˆ«å¯¹åº”clientç«¯å’Œserverç«¯ eventloop groupnetty æ˜¯åŸºäºäº‹ä»¶å¾ªç¯çš„ï¼Œå¹¶ä¸”æ˜¯muilt-eventLoop ï¼ˆå¤šçº¿ç¨‹ç‰ˆeventloopï¼‰ åœ¨æœåŠ¡ç«¯ï¼Œnettyæä¾›äº†ä¸¤å¥—çº¿ç¨‹ç»„ç±»æ¥ä¾›eventloopä½¿ç”¨ bossloopGroup å’Œ wordloopGroup ï¼ åˆ†ç¦»çš„å–å†³äºnettyçš„æ¶æ„è®¾è®¡ï¼Œä¹‹å‰æˆ‘ä»¬è¯´è¿‡nettyçš„æœåŠ¡ç«¯channelåˆ†ä¸ºparent channel å’Œchildern channelï¼Œåˆ†åˆ«è´Ÿè´£åˆ›å»ºé“¾æ¥å’Œä½¿ç”¨é“¾æ¥ loopGroupä¹Ÿæ˜¯è¿™æ ·è¿›è¡Œåˆ†ç»„çš„ bossLoopGroup è¡¨ç¤ºæœåŠ¡å™¨è¿æ¥ç›‘å¬çº¿ç¨‹ç»„ï¼Œä¸“é—¨æ¥å— accept æ–°çš„å®¢æˆ·ç«¯client è¿æ¥ workerGroup è¡¨ç¤ºå¤„ç†æ¯ä¸€æ¡è¿æ¥çš„æ•°æ®æ”¶å‘çš„çº¿ç¨‹ç»„ åœ¨çº¿ç¨‹ç»„å’Œå¯åŠ¨å™¨éƒ½åˆ›å»ºå®Œæˆåï¼Œå°±å¯ä»¥å¼€å§‹è®¾ç½®çº¿ç¨‹ç»„ï¼šé€šè¿‡ b.group(bossGroup, workerGroup) æ–¹æ³•ï¼Œç»™å¼•å¯¼å™¨é…ç½®ä¸¤å¤§çº¿ç¨‹ç»„ã€‚é…ç½®å®Œæˆä¹‹åï¼Œæ•´ä¸ªå¼•å¯¼ç±»çš„ reactor çº¿ç¨‹æ­£å¼ç¡®å®šã€‚è¿™é‡Œç¡®å®šçš„å·¥ä½œæ¨¡å¼ï¼Œä¸ºçˆ¶å­çº¿ç¨‹çš„æ¨¡å‹ã€‚ å¦‚æœåªè®¾ç½®ä¸€ä¸ªçº¿ç¨‹ç»„ï¼Œå…·ä½“çš„æ–¹æ³•ä¸º â€”â€” b.group( workerGroup) ã€‚é…ç½®å®Œæˆä¸€ä¸ªçº¿ç¨‹ç»„ï¼Œåˆ™æ‰€æœ‰çš„ channel ï¼ŒåŒ…æ‹¬æœåŠ¡ç›‘å¬é€šé“çˆ¶äº²channel å’Œæ‰€æœ‰çš„å­channel ï¼Œéƒ½å·¥ä½œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ç»„ä¸­ã€‚ channel Channelhandle ChannelHandleContext ChannelPipelinechannelåœ¨nettyä¸­å…¶å®æ˜¯å¯¹åº”ä¸€ç§é“¾æ¥ç±»å‹ï¼ˆæˆ–è€…è¯´socketçš„ç±»å‹ï¼‰ netty ç›®å‰çš„é“¾æ¥ç±»å‹å¤§çº¦æ˜¯å¦‚ä¸‹çš„å‡ ç§ NioSocketChannel, ä»£è¡¨å¼‚æ­¥çš„å®¢æˆ·ç«¯ TCP Socket è¿æ¥. NioServerSocketChannel, å¼‚æ­¥çš„æœåŠ¡å™¨ç«¯ TCP Socket è¿æ¥. NioDatagramChannel, å¼‚æ­¥çš„ UDP è¿æ¥ NioSctpChannel, å¼‚æ­¥çš„å®¢æˆ·ç«¯ Sctp è¿æ¥. NioSctpServerChannel, å¼‚æ­¥çš„ Sctp æœåŠ¡å™¨ç«¯è¿æ¥. OioSocketChannel, åŒæ­¥çš„å®¢æˆ·ç«¯ TCP Socket è¿æ¥. OioServerSocketChannel, åŒæ­¥çš„æœåŠ¡å™¨ç«¯ TCP Socket è¿æ¥. OioDatagramChannel, åŒæ­¥çš„ UDP è¿æ¥ OioSctpChannel, åŒæ­¥çš„ Sctp æœåŠ¡å™¨ç«¯è¿æ¥. OioSctpServerChannel, åŒæ­¥çš„å®¢æˆ·ç«¯ TCP Socket è¿æ¥. netty å…¶å®å¯ä»¥è¯´90%ä»¥ä¸Šçš„è®¾è®¡ç‚¹éƒ½æ˜¯åœ¨channelæ–¹æ³•ä¸Šï¼Œè¿™é‡Œè¯´æ˜ä¸€ä¸‹nettyçš„chanelæœ‰é‚£äº› 1. netty channelnettyåœ¨è®¾è®¡çš„æ—¶å€™å…¶å®channelåˆ†ä¸ºparent channelå’Œchildern channel parent channel:æœåŠ¡å™¨è¿æ¥ç›‘å¬çš„channel,ç”¨æ¥åšç›‘å¬æœåŠ¡å™¨é“¾æ¥å’Œåˆ›å»ºé“¾æ¥childern channel:ä¸€ä¸ªsocket å¯¹åº”çš„channel,ç”±parent channel åˆ›å»ºçš„channel æ€»ç»“channelå…¶å®å°±æ˜¯nettyå®é™…é“¾æ¥çš„ä¸€ç§æŠ½è±¡ 2. channelhandleChannelHandlerç”¨äºå¤„ç†Channelå¯¹åº”çš„äº‹ä»¶ ï¼ˆnettyå®šä¹‰äº†å¤§é‡çš„äº‹ä»¶ï¼Œé€šè¿‡è¿™äº›äº‹ä»¶è°ƒç”¨å¯¹åº”çš„handleæ–¹æ³•ï¼‰ChannelHandleræ¥å£é‡Œé¢åªå®šä¹‰äº†ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œæˆ‘ä»¬ä¸»è¦å®ç°å®ƒçš„å­æ¥å£ChannelInboundHandlerå’ŒChannelOutboundHandlerï¼Œä¸ºäº†ä¾¿åˆ©ï¼Œæ¡†æ¶æä¾›äº†ChannelInboundHandlerAdapterï¼ŒChannelOutboundHandlerAdapterå’ŒChannelDuplexHandlerè¿™ä¸‰ä¸ªé€‚é…ç±»ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™åªéœ€è¦å®ç°ä½ å…³æ³¨çš„æ–¹æ³•å³å¯ ChannelInboundHandler äº‹ä»¶ï¼š å›è°ƒæ–¹æ³• è§¦å‘æ—¶æœº client server channelRegistered å½“å‰channelæ³¨å†Œåˆ°EventLoop true true channelUnregistered å½“å‰channelä»EventLoopå–æ¶ˆæ³¨å†Œ true true channelActive å½“å‰channelæ¿€æ´»çš„æ—¶å€™ true true channelInactive å½“å‰channelä¸æ´»è·ƒçš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯å½“å‰channelåˆ°äº†å®ƒç”Ÿå‘½å‘¨æœŸæœ« true true channelRead å½“å‰channelä»è¿œç«¯è¯»å–åˆ°æ•°æ® true true channelReadComplete channel readæ¶ˆè´¹å®Œè¯»å–çš„æ•°æ®çš„æ—¶å€™è¢«è§¦å‘ true true userEventTriggered ç”¨æˆ·äº‹ä»¶è§¦å‘çš„æ—¶å€™ FALSE FALSE channelWritabilityChanged channelçš„å†™çŠ¶æ€å˜åŒ–çš„æ—¶å€™è§¦å‘ FALSE FALSE ChannelOutboundHandlerï¼š å›è°ƒæ–¹æ³• è§¦å‘æ—¶æœº client server bind bindæ“ä½œæ‰§è¡Œå‰è§¦å‘ false true connect connect æ“ä½œæ‰§è¡Œå‰è§¦å‘ true false disconnect disconnect æ“ä½œæ‰§è¡Œå‰è§¦å‘ true false close closeæ“ä½œæ‰§è¡Œå‰è§¦å‘ false true deregister deregisteræ“ä½œæ‰§è¡Œå‰è§¦å‘ read readæ“ä½œæ‰§è¡Œå‰è§¦å‘ true true write writeæ“ä½œæ‰§è¡Œå‰è§¦å‘ true true flush flushæ“ä½œæ‰§è¡Œå‰è§¦å‘ true true 3. channelhandlecontextè¿™ä¸ªæ˜¯ channelhandleçš„ä¸€ç§å°è£…ï¼Œå¯ä»¥ç†è§£ä¸ºä¸­é—´å±‚ï¼Œç›¸å½“äºnettyçš„æ•°æ®å±‚å’Œè°ƒåº¦å±‚çš„ä¸­é—´å±‚ å½“ä¸€ä¸ªchannelHandle åŠ å…¥åˆ°nettyä¸­çš„æ—¶å€™ï¼Œnettyå°†ä¼šè‡ªåŠ¨çš„å°†è¿™ä¸ªchannelhandleåŒ…è£…æˆ channelhandlecontextï¼Œä¾›ä¸Šæ–¹ä½¿ç”¨ æ³¨æ„channelhandleContextçš„æ•°æ®å…¶å®éå¸¸å°é—­çš„ï¼Œä»–åªèƒ½å¤„ç†è‡ªå·±çš„å’Œä¹‹åçš„æ•°æ® å¹¶ä¸èƒ½åº”ä¿®æ”¹è¿™ä¸ªæµç¨‹ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œå¦‚æœè¿›è¡Œä¿®æ”¹çš„æ˜¯channelæˆ–è€…channlePipeline çš„è¯ï¼Œä»å¤´é‡æ–°æ‰ç”¨æ•°æ® 3. ChannelPipelineè¿™ä¸ªå°±æ˜¯ä¸€ä¸ªchannelhandlecontextå¤„ç†èŠ‚ç‚¹çš„ä¸€ä¸ªé›†åˆï¼Œ ä¸€ä¸ªchannelï¼ˆæ•°æ®æºï¼‰å¯¹åº”ä¸€ä¸ªchannelPopelineï¼Œä¸€ä¸ªchannelPipelineå¯¹åº”ä¸€ç»„channelhandleContext. channelPipeline > å…¶å®å°±æ˜¯eventloopå¤„ç†é˜Ÿåˆ—çš„ä¸€ä¸ªæŠ½è±¡ï¼Œä¿®æ”¹channelPipelineä¸­çš„æ•°æ®å°†ä¼šå½±å“æ•´ä¸ªnettyå¯¹åº”è¿™ä¸ªchannelçš„å¤„ç†æ–¹å¼ 4 .æ•´ä½“æ€»ç»“ ä¸€ä¸ªchannelå¯¹åº”ä¸€ä¸ªchannelPopeline ä¸€ä¸ªchannelPipeline å¯¹åº”ä¸€ç»„ channelContext ä¸€ä¸ªchannelContextæ‰¿è½½ä¸€ä¸ªchannelhandle å¤„ç†è¿›å…¥çš„æ—¶å€™èµ°çš„æ˜¯ChannelInboundHandleræ¥å£çš„å¤„ç†å®ç°ç±»ï¼Œåå‡ºçš„æ—¶å€™èµ°çš„æ˜¯ChannelOutboundHandleræ¥å£çš„å®ç°ç±» nettyæä¾›äº†ä¸¤ä¸ªé€šç”¨çš„handle HeadContext HeadContextå®ç°äº†ChannelOutboundHandlerï¼ŒChannelInboundHandlerè¿™ä¸¤ä¸ªæ¥å£ å› ä¸ºåœ¨å¤´éƒ¨ï¼Œæ‰€ä»¥è¯´HeadContextä¸­å…³äºinå’Œoutçš„å›è°ƒæ–¹æ³•éƒ½ä¼šè§¦å‘å…³äºChannelInboundHandlerï¼ŒHeadContextçš„ä½œç”¨æ˜¯è¿›è¡Œä¸€äº›å‰ç½®æ“ä½œï¼Œä»¥åŠæŠŠäº‹ä»¶ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªChannelHandlerContextçš„ChannelInboundHandlerä¸­å» TailContextTailContextå®ç°äº†ChannelInboundHandleræ¥å£ï¼Œä¼šåœ¨ChannelInboundHandlerè°ƒç”¨é“¾æœ€åæ‰§è¡Œï¼Œåªè¦æ˜¯å¯¹è°ƒç”¨é“¾å®Œæˆå¤„ç†çš„æƒ…å†µè¿›è¡Œå¤„ç†ï¼Œçœ‹ä¸‹channelReadå®ç° ChannelFutureè¿™ä¸ªå·²ç»æ˜¯nettyæœ€åä¸€ä¸ªç»„å»ºï¼Œè¿™ä¸ªæ–¹æ³•ç”¨æ¥é€šçŸ¥nettyä¸­channelçš„çŠ¶æ€ï¼Œå› ä¸ºnettyæ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥é€šè¿‡è¿™ç§æ–¹æ³•æ¥å®ç°ä¸€ä¸ªç›‘æ§ ps ä»è¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ˜ç™½äº†å…¶å®å¦‚æœnettyéœ€è¦å¢åŠ ä¸€ä¸ªé“¾æ¥ä¸€å®šä¼šå†å®ç°ä¸Šé¢çš„è¿™ä¸€å¥—æ“ä½œåˆ›å»ºä¸€ä¸ªæ–°çš„future","date":"2024-12-31","categories":["java"],"tags":["netty"]},{"title":"netty-(1)ä¼ è¾“api","url":"/2024/12/31/netty--1-ä¼ è¾“api/","content":"ä¼ è¾“APIçš„æ ¸å¿ƒæ˜¯interfaceChannelï¼Œå®ƒè¢«ç”¨äºæ‰€æœ‰çš„I&#x2F;Oæ“ä½œã€‚Channelç±»çš„å±‚æ¬¡ç»“æ„å¦‚å›¾ æ¯ä¸ªChanneléƒ½å°†ä¼šè¢«åˆ†é…ä¸€ä¸ªChannelPipelineå’ŒChannelConfigã€‚ChannelConfigåŒ…å«äº†è¯¥Channelçš„æ‰€æœ‰é…ç½®è®¾ç½®ï¼Œå¹¶ä¸”æ”¯æŒçƒ­æ›´æ–°ã€‚ç”±äºç‰¹å®šçš„ä¼ è¾“å¯èƒ½å…·æœ‰ç‹¬ç‰¹çš„è®¾ç½®ï¼Œæ‰€ä»¥å®ƒå¯èƒ½ä¼šå®ç°ä¸€ä¸ªChannelConfigçš„å­ç±»å‹ã€‚ï¼ˆè¯·å‚è€ƒChannelConfigå®ç°å¯¹åº”çš„Javadocã€‚ï¼‰ ç”±äºChannelæ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œæ‰€ä»¥ä¸ºäº†ä¿è¯é¡ºåºå°†Channelå£°æ˜ä¸ºjava.lang.Comparableçš„ä¸€ä¸ªå­æ¥å£ã€‚å› æ­¤ï¼Œå¦‚æœä¸¤ä¸ªä¸åŒçš„Channelå®ä¾‹éƒ½è¿”å›äº†ç›¸åŒçš„æ•£åˆ—ç ï¼Œé‚£ä¹ˆAbstractChannelä¸­çš„compareTo()æ–¹æ³•çš„å®ç°å°†ä¼šæŠ›å‡ºä¸€ä¸ªErrorã€‚ ChannelPipelineæŒæœ‰æ‰€æœ‰å°†åº”ç”¨äºå…¥ç«™å’Œå‡ºç«™æ•°æ®ä»¥åŠäº‹ä»¶çš„ChannelHandlerå®ä¾‹ï¼Œè¿™äº›ChannelHandlerå®ç°äº†åº”ç”¨ç¨‹åºç”¨äºå¤„ç†çŠ¶æ€å˜åŒ–ä»¥åŠæ•°æ®å¤„ç†çš„é€»è¾‘ã€‚ ChannelHandlerçš„å…¸å‹ç”¨é€”åŒ…æ‹¬ï¼š å°†æ•°æ®ä»ä¸€ç§æ ¼å¼è½¬æ¢ä¸ºå¦ä¸€ç§æ ¼å¼ï¼› æä¾›å¼‚å¸¸çš„é€šçŸ¥ï¼› æä¾›Channelå˜ä¸ºæ´»åŠ¨çš„æˆ–è€…éæ´»åŠ¨çš„é€šçŸ¥ï¼› æä¾›å½“Channelæ³¨å†Œåˆ°EventLoopæˆ–è€…ä»EventLoopæ³¨é”€æ—¶çš„é€šçŸ¥ï¼› æä¾›æœ‰å…³ç”¨æˆ·è‡ªå®šä¹‰äº‹ä»¶çš„é€šçŸ¥ channel çš„æ–¹æ³• æ–¹æ³•å æè¿° eventLoop è¿”å›åˆ†é…ç»™Channelçš„EventLoop pipeline è¿”å›åˆ†é…ç»™Channelçš„ChannelPipeline isActive å¦‚æœChannelæ˜¯æ´»åŠ¨çš„ï¼Œåˆ™è¿”å›trueã€‚æ´»åŠ¨çš„æ„ä¹‰å¯èƒ½ä¾èµ–äºåº•å±‚çš„ä¼ è¾“ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªSocketä¼ è¾“ä¸€æ—¦è¿æ¥åˆ°äº†è¿œç¨‹èŠ‚ç‚¹ä¾¿æ˜¯æ´»åŠ¨çš„ï¼Œè€Œä¸€ä¸ªDatagramä¼ è¾“ä¸€æ—¦è¢«æ‰“å¼€ä¾¿æ˜¯æ´»åŠ¨çš„ localAddress è¿”å›æœ¬åœ°çš„SocketAddress remoteAddress è¿”å›è¿œç¨‹çš„SocketAddress write å°†æ•°æ®å†™åˆ°è¿œç¨‹èŠ‚ç‚¹ã€‚è¿™ä¸ªæ•°æ®å°†è¢«ä¼ é€’ç»™ChannelPipelineï¼Œå¹¶ä¸”æ’é˜Ÿç›´åˆ°å®ƒè¢«å†²åˆ· flush å°†ä¹‹å‰å·²å†™çš„æ•°æ®å†²åˆ·åˆ°åº•å±‚ä¼ è¾“ï¼Œå¦‚ä¸€ä¸ªSocket writeAndFlush ä¸€ä¸ªç®€ä¾¿çš„æ–¹æ³•ï¼Œç­‰åŒäºè°ƒç”¨write()å¹¶æ¥ç€è°ƒç”¨flush()","date":"2024-12-31","categories":["java"],"tags":["netty"]},{"title":"netty-(2)byteBuf","url":"/2024/12/31/netty--2-byteBuf/","content":"netty byteBufNettyçš„æ•°æ®å¤„ç†APIé€šè¿‡ä¸¤ä¸ªç»„ä»¶æš´éœ²â€”â€”abstract class ByteBufå’Œinterface ByteBufHolderã€‚ ä¸‹é¢æ˜¯ä¸€äº›ByteBuf APIçš„ä¼˜ç‚¹ï¼š å®ƒå¯ä»¥è¢«ç”¨æˆ·è‡ªå®šä¹‰çš„ç¼“å†²åŒºç±»å‹æ‰©å±•ï¼› é€šè¿‡å†…ç½®çš„å¤åˆç¼“å†²åŒºç±»å‹å®ç°äº†é€æ˜çš„é›¶æ‹·è´ï¼› å®¹é‡å¯ä»¥æŒ‰éœ€å¢é•¿ï¼ˆç±»ä¼¼äºJDKçš„StringBuilderï¼‰ï¼› åœ¨è¯»å’Œå†™è¿™ä¸¤ç§æ¨¡å¼ä¹‹é—´åˆ‡æ¢ä¸éœ€è¦è°ƒç”¨ByteBufferçš„flip()æ–¹æ³•ï¼› è¯»å’Œå†™ä½¿ç”¨äº†ä¸åŒçš„ç´¢å¼•ï¼› æ”¯æŒæ–¹æ³•çš„é“¾å¼è°ƒç”¨ï¼› æ”¯æŒå¼•ç”¨è®¡æ•°ï¼› æ”¯æŒæ± åŒ–ã€‚ byteBuf çš„å·¥ä½œæ–¹å¼byteBufæ‹¥æœ‰ä¸¤ä¸ªä¸åŒçš„ç´¢å¼•- è®°å½•è¯»ä½ç½®çš„readerIndex å’Œè®°å½•å†™ä½ç½®çš„writerIndex å¯è¯»çš„ä½ç½®å°±æ˜¯ readerIndex åˆ°writerIndex ä¹‹é—´çš„ä½ç½® å¯å†™çš„ä½ç½®å°±æ˜¯writerIndex åˆ°è¿™ä¸ªç¼“å­˜çš„ç»“å°¾ æ³¨æ„nettyåœ¨å®ç°çš„æ—¶å€™å¹¶æ²¡æœ‰ä½¿ç”¨å¾ªç¯é˜Ÿåˆ—æ¥ä¼˜åŒ–æ€§èƒ½ å¯ä»¥çœ‹ä¸€ä¸‹ distuptoræ¡†æ¶ byteBuf çš„ ä¸‰ç§ä½¿ç”¨æ¨¡å¼ ä½¿ç”¨å †ç¼“å†²åŒº æœ€å¸¸ç”¨çš„ByteBufæ¨¡å¼æ˜¯å°†æ•°æ®å­˜å‚¨åœ¨JVMçš„å †ç©ºé—´ä¸­ã€‚è¿™ç§æ¨¡å¼è¢«ç§°ä¸ºæ”¯æ’‘æ•°ç»„ï¼ˆbacking arrayï¼‰ï¼Œå®ƒèƒ½åœ¨æ²¡æœ‰ä½¿ç”¨æ± åŒ–çš„æƒ…å†µä¸‹æä¾›å¿«é€Ÿçš„åˆ†é…å’Œé‡Šæ”¾ã€‚éå¸¸é€‚åˆäºæœ‰é—ç•™çš„æ•°æ®éœ€è¦å¤„ç†çš„æƒ…å†µã€‚ ç›´æ¥ç¼“å†²åŒº ç›´æ¥ç¼“å†²åŒºæ˜¯å¦å¤–ä¸€ç§ByteBufæ¨¡å¼ã€‚æˆ‘ä»¬æœŸæœ›ç”¨äºå¯¹è±¡åˆ›å»ºçš„å†…å­˜åˆ†é…æ°¸è¿œéƒ½æ¥è‡ªäºå †ä¸­ï¼Œä½†è¿™å¹¶ä¸æ˜¯å¿…éœ€çš„â€”â€”NIOåœ¨JDK 1.4ä¸­å¼•å…¥çš„ByteBufferç±»å…è®¸JVMå®ç°é€šè¿‡æœ¬åœ°è°ƒç”¨æ¥åˆ†é…å†…å­˜ã€‚è¿™ä¸»è¦æ˜¯ä¸ºäº†é¿å…åœ¨æ¯æ¬¡è°ƒç”¨æœ¬åœ°I&#x2F;Oæ“ä½œä¹‹å‰ï¼ˆæˆ–è€…ä¹‹åï¼‰å°†ç¼“å†²åŒºçš„å†…å®¹å¤åˆ¶åˆ°ä¸€ä¸ªä¸­é—´ç¼“å†²åŒºï¼ˆæˆ–è€…ä»ä¸­é—´ç¼“å†²åŒºæŠŠå†…å®¹å¤åˆ¶åˆ°ç¼“å†²åŒºï¼‰ã€‚ ç›´æ¥ç¼“å†²åŒºçš„ä¸»è¦ç¼ºç‚¹æ˜¯ï¼Œç›¸å¯¹äºåŸºäºå †çš„ç¼“å†²åŒºï¼Œå®ƒä»¬çš„åˆ†é…å’Œé‡Šæ”¾éƒ½è¾ƒä¸ºæ˜‚è´µã€‚å¦‚æœå¤„ç†é—ç•™çš„æ•°æ®å°†å¿…é¡»å°†æ•°æ®ä»ç›´æ¥ç¼“å†²åŒºèµ‹å€¼åˆ°å †ç©ºé—´ä¸­ å¤åˆç¼“å†²åŒº ä¸¾ä¾‹è¯´æ˜ï¼Œè®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹ä¸€ä¸ªç”±ä¸¤éƒ¨åˆ†â€”â€”å¤´éƒ¨å’Œä¸»ä½“â€”â€”ç»„æˆçš„å°†é€šè¿‡HTTPåè®®ä¼ è¾“çš„æ¶ˆæ¯ã€‚è¿™ä¸¤éƒ¨åˆ†ç”±åº”ç”¨ç¨‹åºçš„ä¸åŒæ¨¡å—äº§ç”Ÿï¼Œå°†ä¼šåœ¨æ¶ˆæ¯è¢«å‘é€çš„æ—¶å€™ç»„è£…ã€‚è¯¥åº”ç”¨ç¨‹åºå¯ä»¥é€‰æ‹©ä¸ºå¤šä¸ªæ¶ˆæ¯é‡ç”¨ç›¸åŒçš„æ¶ˆæ¯ä¸»ä½“ã€‚å½“è¿™ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œå¯¹äºæ¯ä¸ªæ¶ˆæ¯éƒ½å°†ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¤´éƒ¨ã€‚ å› ä¸ºæˆ‘ä»¬ä¸æƒ³ä¸ºæ¯ä¸ªæ¶ˆæ¯éƒ½é‡æ–°åˆ†é…è¿™ä¸¤ä¸ªç¼“å†²åŒºï¼Œæ‰€ä»¥ä½¿ç”¨CompositeByteBufæ˜¯ä¸€ä¸ªå®Œç¾çš„é€‰æ‹©ã€‚å®ƒåœ¨æ¶ˆé™¤äº†æ²¡å¿…è¦çš„å¤åˆ¶çš„åŒæ—¶ï¼Œæš´éœ²äº†é€šç”¨çš„ByteBuf API bytebufferåˆ†é…æ–¹å¼ ByteBufAllocatoræ¥å£çš„å®ç°ç±»å®ç°åˆ†é… å ç§° æ è¿° buffer() è¿”å›ä¸€ä¸ªåŸºäºå †æˆ–è€…ç›´æ¥å†…å­˜å­˜å‚¨çš„ByteBuf buffer(intinitialCapacity); buffer(intinitialCapacity,intmaxCapacity); heapBuffer() è¿”å›ä¸€ä¸ªåŸºäºå †å†…å­˜å­˜å‚¨çš„ByteBuf heapBuffer(intinitialCapacity) heapBuffer(intinitialCapacity,intmaxCapacity) directBuffer() è¿”å›ä¸€ä¸ªåŸºäºç›´æ¥å†…å­˜å­˜å‚¨çš„ByteBuf directBuffer(intinitialCapacity) directBuffer(intinitialCapacity,intmaxCapacity) compositeBuffer() è¿”å›ä¸€ä¸ªå¯ä»¥é€šè¿‡æ·»åŠ æœ€å¤§åˆ°æŒ‡å®šæ•°ç›®çš„åŸºäºå †çš„æˆ–è€…ç›´æ¥å†…å­˜å­˜å‚¨çš„ç¼“å†²åŒºæ¥æ‰©å±•çš„CompositeByteBuf compositeBuffer(intmaxNumComponents) compositeDirectBuffer() compositeDirectBuffer(intmaxNumComponents); compositeHeapBuffer() compositeHeapBuffer(intmaxNumComponents); ioBuffer()[8] è¿”å›ä¸€ä¸ªç”¨äºå¥—æ¥å­—çš„I&#x2F;Oæ“ä½œçš„ByteBuf è·å–æ–¹æ³• é€šè¿‡channel æˆ–è€…ç»‘å®šåˆ°ChannelHandlerçš„ChannelHandlerContext Nettyæä¾›äº†ä¸¤ç§ByteBufAllocatorçš„å®ç° PooledByteBufAllocator:æ± åŒ–äº†ByteBufçš„å®ä¾‹ä»¥æé«˜æ€§èƒ½å¹¶æœ€å¤§é™åº¦åœ°å‡å°‘å†…å­˜ç¢ç‰‡ã€‚æ­¤å®ç°ä½¿ç”¨äº†ä¸€ç§ç§°ä¸ºjemalloc[9]çš„å·²è¢«å¤§é‡ç°ä»£æ“ä½œç³»ç»Ÿæ‰€é‡‡ç”¨çš„é«˜æ•ˆæ–¹æ³•æ¥åˆ†é…å†…å­˜ Unpooled-ByteBufAllocator:ä¸æ± åŒ–ByteBufå®ä¾‹ï¼Œå¹¶ä¸”åœ¨æ¯æ¬¡å®ƒè¢«è°ƒç”¨æ—¶éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚ Unpooled ç¼“å†²åŒº å¯èƒ½æŸäº›æƒ…å†µä¸‹ï¼Œä½ æœªèƒ½è·å–ä¸€ä¸ªåˆ°ByteBufAllocatorçš„å¼•ç”¨ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼ŒNettyæä¾›äº†ä¸€ä¸ªç®€å•çš„ç§°ä¸ºUnpooledçš„å·¥å…·ç±»ï¼Œå®ƒæä¾›äº†é™æ€çš„è¾…åŠ©æ–¹æ³•æ¥åˆ›å»ºæœªæ± åŒ–çš„ByteBuf å ç§° æ è¿° buffer() è¿”å›ä¸€ä¸ªæœªæ± åŒ–çš„åŸºäºå †å†…å­˜å­˜å‚¨çš„ByteBuf buffer(intinitialCapacity) buffer(intinitialCapacity,intmaxCapacity) directBuffer() è¿”å›ä¸€ä¸ªæœªæ± åŒ–çš„åŸºäºç›´æ¥å†…å­˜å­˜å‚¨çš„ByteBuf directBuffer(intinitialCapacity) directBuffer(intinitialCapacity,intmaxCapacity) wrappedBuffer() è¿”å›ä¸€ä¸ªåŒ…è£…äº†ç»™å®šæ•°æ®çš„ByteBuf copiedBuffer() è¿”å›ä¸€ä¸ªå¤åˆ¶äº†ç»™å®šæ•°æ®çš„ByteBuf Unpooledç±»è¿˜ä½¿å¾—ByteBufåŒæ ·å¯ç”¨äºé‚£äº›å¹¶ä¸éœ€è¦Nettyçš„å…¶ä»–ç»„ä»¶çš„éç½‘ç»œé¡¹ç›®ï¼Œä½¿å¾—å…¶èƒ½å¾—ç›Šäºé«˜æ€§èƒ½çš„å¯æ‰©å±•çš„ç¼“å†²åŒºAPIã€‚ ByteBufUtilç±» ByteBufUtilæä¾›äº†ç”¨äºæ“ä½œByteBufçš„é™æ€çš„è¾…åŠ©æ–¹æ³•ã€‚å› ä¸ºè¿™ä¸ªAPIæ˜¯é€šç”¨çš„ï¼Œå¹¶ä¸”å’Œæ± åŒ–æ— å…³ï¼Œæ‰€ä»¥è¿™äº›æ–¹æ³•å·²ç„¶åœ¨åˆ†é…ç±»çš„å¤–éƒ¨å®ç°ã€‚ è¿™äº›é™æ€æ–¹æ³•ä¸­æœ€æœ‰ä»·å€¼çš„å¯èƒ½å°±æ˜¯hexdump()æ–¹æ³•ï¼Œå®ƒä»¥åå…­è¿›åˆ¶çš„è¡¨ç¤ºå½¢å¼æ‰“å°ByteBufçš„å†…å®¹ã€‚è¿™åœ¨å„ç§æƒ…å†µä¸‹éƒ½å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚ï¼Œå‡ºäºè°ƒè¯•çš„ç›®çš„è®°å½•ByteBufçš„å†…å®¹ã€‚åå…­è¿›åˆ¶çš„è¡¨ç¤ºé€šå¸¸ä¼šæä¾›ä¸€ä¸ªæ¯”å­—èŠ‚å€¼çš„ç›´æ¥è¡¨ç¤ºå½¢å¼æ›´åŠ æœ‰ç”¨çš„æ—¥å¿—æ¡ç›®ï¼Œæ­¤å¤–ï¼Œåå…­è¿›åˆ¶çš„ç‰ˆæœ¬è¿˜å¯ä»¥å¾ˆå®¹æ˜“åœ°è½¬æ¢å›å®é™…çš„å­—èŠ‚è¡¨ç¤ºã€‚ å¦ä¸€ä¸ªæœ‰ç”¨çš„æ–¹æ³•æ˜¯boolean equals(ByteBuf, ByteBuf)ï¼Œå®ƒè¢«ç”¨æ¥åˆ¤æ–­ä¸¤ä¸ªByteBufå®ä¾‹çš„ç›¸ç­‰æ€§ã€‚å¦‚æœä½ å®ç°è‡ªå·±çš„ByteBufå­ç±»ï¼Œä½ å¯èƒ½ä¼šå‘ç°ByteBufUtilçš„å…¶ä»–æœ‰ç”¨æ–¹æ³•ã€‚","date":"2024-12-31","categories":["java"],"tags":["netty"]},{"title":"netty-(3)channelHandler","url":"/2024/12/31/netty--3-channelHandler/","content":"ä¹‹å‰æœ‰ä¸€ä¸ªnettyçš„æ•°æ®æµå¤„ç†å›¾ åœ¨è¿™å¼ å›¾ä¸­å¯ä»¥ä½“ç°å‡ºåœ¨ChannelPipelineä¸­å°†ChannelHandleré“¾æ¥åœ¨ä¸€èµ·ä»¥ç»„ç»‡å¤„ç†é€»è¾‘,å¹¶ä¸”ä½¿ç”¨ChannelHandlerContextä¼ é€’å‚æ•° ChannelHandlerå®¶æ— channnelçš„ç”Ÿå‘½å‘¨æœŸ çŠ¶ æ€ æ è¿° ChannelUnregistered Channelå·²ç»è¢«åˆ›å»ºï¼Œä½†è¿˜æœªæ³¨å†Œåˆ°EventLoop ChannelRegistered Channelå·²ç»è¢«æ³¨å†Œåˆ°äº†EventLoop ChannelActive Channelå¤„äºæ´»åŠ¨çŠ¶æ€ï¼ˆå·²ç»è¿æ¥åˆ°å®ƒçš„è¿œç¨‹èŠ‚ç‚¹ï¼‰ã€‚å®ƒç°åœ¨å¯ä»¥æ¥æ”¶å’Œå‘é€æ•°æ®äº† ChannelInactive Channelæ²¡æœ‰è¿æ¥åˆ°è¿œç¨‹èŠ‚ç‚¹ channelHandlerçš„çŠ¶æ€æ‰­è½¬å¦‚ä¸‹ channelHandlerç”Ÿå‘½å‘¨æœŸ åœ¨ChannelHandlerè¢«æ·»åŠ åˆ°ChannelPipelineä¸­æˆ–è€…è¢«ä»ChannelPipelineä¸­ç§»é™¤æ—¶ä¼šè°ƒç”¨è¿™äº›æ“ä½œã€‚è¿™äº›æ–¹æ³•ä¸­çš„æ¯ä¸€ä¸ªéƒ½æ¥å—ä¸€ä¸ªChannelHandlerContextå‚æ•° channelHandlerContextåœ¨ç”Ÿå‘½å‘¨æœŸä¸­çš„å›è°ƒæ–¹æ³• ç±» å‹ æ è¿° handlerAdded å½“æŠŠChannelHandleræ·»åŠ åˆ°ChannelPipelineä¸­æ—¶è¢«è°ƒç”¨ handlerRemoved å½“ä»ChannelPipelineä¸­ç§»é™¤ChannelHandleræ—¶è¢«è°ƒç”¨ exceptionCaught å½“å¤„ç†è¿‡ç¨‹ä¸­åœ¨ChannelPipelineä¸­æœ‰é”™è¯¯äº§ç”Ÿæ—¶è¢«è°ƒç”¨ ChannelInactive Channelæ²¡æœ‰è¿æ¥åˆ°è¿œç¨‹èŠ‚ç‚¹ Nettyå®šä¹‰äº†ä¸‹é¢ä¸¤ä¸ªé‡è¦çš„ChannelHandlerå­æ¥å£ï¼š ChannelInboundHandlerâ€”â€”å¤„ç†å…¥ç«™æ•°æ®ä»¥åŠå„ç§çŠ¶æ€å˜åŒ–ï¼› ChannelOutboundHandlerâ€”â€”å¤„ç†å‡ºç«™æ•°æ®å¹¶ä¸”å…è®¸æ‹¦æˆªæ‰€æœ‰çš„æ“ä½œã€‚ channelInBoundHandler ç”¨æ¥å¤„ç†è¾“å…¥æµçš„å¤„ç†æ–¹æ³•,ç›¸æ¯”è¾ƒåŸå§‹çš„channelhandleræ¥å£,æœ¬æ–¹æ³•æ‰©å±•äº†ä¸€å†™ä¸€channelçŠ¶æ€ç›¸å…³çš„æ–¹æ³•,è¿™äº›æ–¹æ³•å°†ä¼šåœ¨æ•°æ®è¢«æ¥æ”¶æ—¶æˆ–è€…ä¸å…¶å¯¹åº”çš„ChannelçŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶è¢«è°ƒç”¨ã€‚æ­£å¦‚æˆ‘ä»¬å‰é¢æ‰€æåˆ°çš„ï¼Œè¿™äº›æ–¹æ³•å’ŒChannelçš„ç”Ÿå‘½å‘¨æœŸå¯†åˆ‡ç›¸å…³ ç±» å‹ æ è¿° channelRegistered å½“Channelå·²ç»æ³¨å†Œåˆ°å®ƒçš„EventLoopå¹¶ä¸”èƒ½å¤Ÿå¤„ç†I&#x2F;Oæ—¶è¢«è°ƒç”¨ channelUnregistered å½“Channelä»å®ƒçš„EventLoopæ³¨é”€å¹¶ä¸”æ— æ³•å¤„ç†ä»»ä½•I&#x2F;Oæ—¶è¢«è°ƒç”¨ channelActive å½“Channelå¤„äºæ´»åŠ¨çŠ¶æ€æ—¶è¢«è°ƒç”¨ï¼›Channelå·²ç»è¿æ¥&#x2F;ç»‘å®šå¹¶ä¸”å·²ç»å°±ç»ª channelInactive å½“Channelç¦»å¼€æ´»åŠ¨çŠ¶æ€å¹¶ä¸”ä¸å†è¿æ¥å®ƒçš„è¿œç¨‹èŠ‚ç‚¹æ—¶è¢«è°ƒç”¨ channelReadComplete å½“Channelä¸Šçš„ä¸€ä¸ªè¯»æ“ä½œå®Œæˆæ—¶è¢«è°ƒç”¨[1] channelRead å½“ä»Channelè¯»å–æ•°æ®æ—¶è¢«è°ƒç”¨ ChannelWritabilityChanged å½“Channelçš„å¯å†™çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶è¢«è°ƒç”¨ã€‚ç”¨æˆ·å¯ä»¥ç¡®ä¿å†™æ“ä½œä¸ä¼šå®Œæˆå¾—å¤ªå¿«ï¼ˆä»¥é¿å…å‘ç”ŸOutOfMemoryErrorï¼‰æˆ–è€…å¯ä»¥åœ¨Channelå˜ä¸ºå†æ¬¡å¯å†™æ—¶æ¢å¤å†™å…¥ã€‚å¯ä»¥é€šè¿‡è°ƒç”¨Channelçš„isWritable()æ–¹æ³•æ¥æ£€æµ‹Channelçš„å¯å†™æ€§ã€‚ä¸å¯å†™æ€§ç›¸å…³çš„é˜ˆå€¼å¯ä»¥é€šè¿‡Channel.config().setWriteHighWaterMark()å’ŒChannel.config().setWriteLowWaterMark()æ–¹æ³•æ¥è®¾ç½® userEventTriggered å½“ChannelnboundHandler.fireUserEventTriggered()æ–¹æ³•è¢«è°ƒç”¨æ—¶è¢«è°ƒç”¨ï¼Œå› ä¸ºä¸€ä¸ªPOJOè¢«ä¼ ç»äº†ChannelPipeline å½“æŸä¸ªChannelInboundHandlerçš„å®ç°é‡å†™channelRead()æ–¹æ³•æ—¶ï¼Œå®ƒå°†è´Ÿè´£æ˜¾å¼åœ°é‡Šæ”¾ä¸æ± åŒ–çš„ByteBufå®ä¾‹ç›¸å…³çš„å†…å­˜ã€‚Nettyä¸ºæ­¤æä¾›äº†ä¸€ä¸ªå®ç”¨æ–¹æ³•ReferenceCount-Util.release() è¿™æ ·æ‰‹åŠ¨çš„è¿›è¡Œèµ„æºçš„é‡Šæ”¾æ˜¯æ¯”è¾ƒéº»çƒ¦çš„,nettyæä¾›äº†SimpleChannelInboundHandlerå¯ä»¥è‡ªåŠ¨çš„é‡Šæ”¾èµ„æº ç”±äºSimpleChannelInboundHandlerä¼šè‡ªåŠ¨é‡Šæ”¾èµ„æºï¼Œæ‰€ä»¥ä½ ä¸åº”è¯¥å­˜å‚¨æŒ‡å‘ä»»ä½•æ¶ˆæ¯çš„å¼•ç”¨ä¾›å°†æ¥ä½¿ç”¨ï¼Œå› ä¸ºè¿™äº›å¼•ç”¨éƒ½å°†ä¼šå¤±æ•ˆã€‚ ChannelOutBoundHandler å‡ºç«™æ“ä½œå’Œæ•°æ®å°†ç”±ChannelOutboundHandlerå¤„ç†ã€‚å®ƒçš„æ–¹æ³•å°†è¢«Channelã€Channel- Pipelineä»¥åŠChannelHandlerContextè°ƒç”¨ã€‚ ChannelOutboundHandlerçš„ä¸€ä¸ªå¼ºå¤§çš„åŠŸèƒ½æ˜¯å¯ä»¥æŒ‰éœ€æ¨è¿Ÿæ“ä½œæˆ–è€…äº‹ä»¶ï¼Œè¿™ä½¿å¾—å¯ä»¥é€šè¿‡ä¸€äº›å¤æ‚çš„æ–¹æ³•æ¥å¤„ç†è¯·æ±‚ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåˆ°è¿œç¨‹èŠ‚ç‚¹çš„å†™å…¥è¢«æš‚åœäº†ï¼Œé‚£ä¹ˆä½ å¯ä»¥æ¨è¿Ÿå†²åˆ·æ“ä½œå¹¶åœ¨ç¨åç»§ç»­ã€‚ ç±» å‹ æ è¿° bind(ChannelHandlerContext,SocketAddress,ChannelPromise) å½“è¯·æ±‚å°†Channelç»‘å®šåˆ°æœ¬åœ°åœ°å€æ—¶è¢«è°ƒç”¨ connect(ChannelHandlerContext, å½“è¯·æ±‚å°†Channelè¿æ¥åˆ°è¿œç¨‹èŠ‚ç‚¹æ—¶è¢«è°ƒç”¨ SocketAddress,SocketAddress,ChannelPromise) disconnect(ChannelHandlerContext,ChannelPromise) å½“è¯·æ±‚å°†Channelä»è¿œç¨‹èŠ‚ç‚¹æ–­å¼€æ—¶è¢«è°ƒç”¨ close(ChannelHandlerContext,ChannelPromise) å½“è¯·æ±‚å…³é—­Channelæ—¶è¢«è°ƒç”¨ deregister(ChannelHandlerContext,ChannelPromise) å½“è¯·æ±‚å°†Channelä»å®ƒçš„EventLoopæ³¨é”€æ—¶è¢«è°ƒç”¨ read(ChannelHandlerContext) å½“è¯·æ±‚ä»Channelè¯»å–æ›´å¤šçš„æ•°æ®æ—¶è¢«è°ƒç”¨ flush(ChannelHandlerContext) å½“è¯·æ±‚é€šè¿‡Channelå°†å…¥é˜Ÿæ•°æ®å†²åˆ·åˆ°è¿œç¨‹èŠ‚ç‚¹æ—¶è¢«è°ƒç”¨ write(ChannelHandlerContext,Object,ChannelPromise) å½“è¯·æ±‚é€šè¿‡Channelå°†æ•°æ®å†™åˆ°è¿œç¨‹èŠ‚ç‚¹æ—¶è¢«è°ƒç”¨ ChannelPromiseä¸ChannelFuture ChannelOutboundHandlerä¸­çš„å¤§éƒ¨åˆ†æ–¹æ³•éƒ½éœ€è¦ä¸€ä¸ªChannelPromiseå‚æ•°ï¼Œä»¥ä¾¿åœ¨æ“ä½œå®Œæˆæ—¶å¾—åˆ°é€šçŸ¥ã€‚ChannelPromiseæ˜¯ChannelFutureçš„ä¸€ä¸ªå­ç±»ï¼Œå…¶å®šä¹‰äº†ä¸€äº›å¯å†™çš„æ–¹æ³•ï¼Œå¦‚setSuccess()å’ŒsetFailure()ï¼Œä»è€Œä½¿ChannelFutureä¸å¯å˜[2]ã€‚ netty å†…ç½®å¤„ç†å™¨å®ç°ç±»ChannelInboundHandlerAdapterå’ŒChannelOutboundHandlerAdapterä½ å¯ä»¥ä½¿ç”¨ChannelInboundHandlerAdapterå’ŒChannelOutboundHandlerAdapterç±»ä½œä¸ºè‡ªå·±çš„ChannelHandlerçš„èµ·å§‹ç‚¹ã€‚è¿™ä¸¤ä¸ªé€‚é…å™¨åˆ†åˆ«æä¾›äº†ChannelInboundHandlerå’ŒChannelOutboundHandlerçš„åŸºæœ¬å®ç°ã€‚é€šè¿‡æ‰©å±•æŠ½è±¡ç±»ChannelHandlerAdapterï¼Œå®ƒä»¬è·å¾—äº†å®ƒä»¬å…±åŒçš„è¶…æ¥å£ChannelHandlerçš„æ–¹æ³•ã€‚ ChannelHandlerAdapterè¿˜æä¾›äº†å®ç”¨æ–¹æ³•isSharable() å¦‚æœå…¶å¯¹åº”çš„å®ç°è¢«æ ‡æ³¨ä¸ºSharableï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°†è¿”å›trueï¼Œè¡¨ç¤ºå®ƒå¯ä»¥è¢«æ·»åŠ åˆ°å¤šä¸ªChannelPipelineä¸­ åœ¨ChannelInboundHandlerAdapterå’ŒChannelOutboundHandlerAdapterä¸­æ‰€æä¾›çš„æ–¹æ³•ä½“è°ƒç”¨äº†å…¶ç›¸å…³è”çš„ChannelHandlerContextä¸Šçš„ç­‰æ•ˆæ–¹æ³•ï¼Œä»è€Œå°†äº‹ä»¶è½¬å‘åˆ°äº†ChannelPipelineä¸­çš„ä¸‹ä¸€ä¸ªChannelHandlerä¸­ã€‚ nettyèµ„æºçš„æ ‡å‡†å†™æ³• æ³¨æ„ç‚¹: ä½¿ç”¨ReferenceCountUtil.release(msg); é‡Šæ”¾èµ„æº ä½¿ç”¨promise.setSuccess();é€šçŸ¥ChannelPromiseæ•°æ®å·²ç»è¢«å¤„ç†äº† netty å†…ç½®èµ„æºæ³„æ¼æ£€æµ‹å·¥å…·æ¯å½“é€šè¿‡è°ƒç”¨ChannelInboundHandler.channelRead()æˆ–è€…ChannelOutbound- Handler.write()æ–¹æ³•æ¥å¤„ç†æ•°æ®æ—¶ï¼Œä½ éƒ½éœ€è¦ç¡®ä¿æ²¡æœ‰ä»»ä½•çš„èµ„æºæ³„æ¼ã€‚ä½ å¯èƒ½è¿˜è®°å¾—åœ¨å‰é¢çš„ç« èŠ‚ä¸­æ‰€æåˆ°çš„ï¼ŒNettyä½¿ç”¨å¼•ç”¨è®¡æ•°æ¥å¤„ç†æ± åŒ–çš„ByteBufã€‚æ‰€ä»¥åœ¨å®Œå…¨ä½¿ç”¨å®ŒæŸä¸ªByteBufåï¼Œè°ƒæ•´å…¶å¼•ç”¨è®¡æ•°æ˜¯å¾ˆé‡è¦çš„ã€‚ ä¸ºäº†å¸®åŠ©ä½ è¯Šæ–­æ½œåœ¨çš„ï¼ˆèµ„æºæ³„æ¼ï¼‰é—®é¢˜ï¼ŒNettyæä¾›äº†class ResourceLeakDetector[3]ï¼Œå®ƒå°†å¯¹ä½ åº”ç”¨ç¨‹åºçš„ç¼“å†²åŒºåˆ†é…åšå¤§çº¦1%çš„é‡‡æ ·æ¥æ£€æµ‹å†…å­˜æ³„éœ²ã€‚ netty çš„ channelPipeLine æ¥å£channelPipline å…¶å®æ˜¯ä¸€ä¸ªè°ƒåº¦é“¾å¤„ç†å™¨,ç”¨æ¥å¤„ç†channelå’Œå¯¹åº”çš„handleçš„æ‰§è¡Œè¿‡ç¨‹ æ¯ä¸€ä¸ªchanneléƒ½è¢«åˆ†é…äº†ä¸€ä¸ªå”¯ä¸€çš„pipeline,è¿™é¡¹å…³è”æ˜¯æ°¸ä¹…æ€§çš„ï¼›Channelæ—¢ä¸èƒ½é™„åŠ å¦å¤–ä¸€ä¸ªChannelPipelineï¼Œä¹Ÿä¸èƒ½åˆ†ç¦»å…¶å½“å‰çš„ã€‚ æ ¹æ®äº‹ä»¶çš„èµ·æºï¼Œäº‹ä»¶å°†ä¼šè¢«ChannelInboundHandleræˆ–è€…ChannelOutboundHandlerå¤„ç†ã€‚éšåï¼Œé€šè¿‡è°ƒç”¨ChannelHandlerContextçš„å®ç°ï¼Œå®ƒå°†è¢«è½¬å‘ç»™åŒä¸€è¶…ç±»å‹çš„ä¸‹ä¸€ä¸ªChannelHandler ChannelHandlerContext:ChannelHandlerContextä½¿å¾—ChannelHandlerèƒ½å¤Ÿå’Œå®ƒçš„ChannelPipelineä»¥åŠå…¶ä»–çš„ChannelHandleräº¤äº’ã€‚ChannelHandlerå¯ä»¥é€šçŸ¥å…¶æ‰€å±çš„ChannelPipelineä¸­çš„ä¸‹ä¸€ä¸ªChannelHandlerï¼Œç”šè‡³å¯ä»¥åŠ¨æ€ä¿®æ”¹å®ƒæ‰€å±çš„ChannelPipelineã€‚ å½“ä½ å®Œæˆäº†é€šè¿‡è°ƒç”¨ChannelPipeline.add*()æ–¹æ³•å°†å…¥ç«™å¤„ç†å™¨ï¼ˆChannelInboundHandlerï¼‰å’Œå‡ºç«™å¤„ç†å™¨ï¼ˆChannelOutboundHandlerï¼‰æ··åˆæ·»åŠ åˆ°ChannelPipelineä¹‹åï¼Œæ¯ä¸€ä¸ªChannelHandlerä»å¤´éƒ¨åˆ°å°¾ç«¯çš„é¡ºåºä½ç½®æ­£å¦‚åŒæˆ‘ä»¬æ·»åŠ çš„æ—¶å€™é‚£æ ·ã€‚ åœ¨ChannelPipelineä¼ æ’­äº‹ä»¶æ—¶ï¼Œå®ƒä¼šæµ‹è¯•ChannelPipelineä¸­çš„ä¸‹ä¸€ä¸ªChannel- Handlerçš„ç±»å‹æ˜¯å¦å’Œäº‹ä»¶çš„è¿åŠ¨æ–¹å‘ç›¸åŒ¹é…ã€‚å¦‚æœä¸åŒ¹é…ï¼ŒChannelPipelineå°†è·³è¿‡è¯¥ChannelHandlerå¹¶å‰è¿›åˆ°ä¸‹ä¸€ä¸ªï¼Œç›´åˆ°å®ƒæ‰¾åˆ°å’Œè¯¥äº‹ä»¶æ‰€æœŸæœ›çš„æ–¹å‘ç›¸åŒ¹é…çš„ä¸ºæ­¢ã€‚ channelPipelineæ¥å£çš„æ–¹æ³• å ç§° æ è¿° addFirst å°†ä¸€ä¸ªChannelHandleræ·»åŠ åˆ°ChannelPipelineä¸­ addBeforeaddAfteraddLast remove å°†ä¸€ä¸ªChannelHandlerä»ChannelPipelineä¸­ç§»é™¤ replace å°†ChannelPipelineä¸­çš„ä¸€ä¸ªChannelHandleræ›¿æ¢ä¸ºå¦ä¸€ä¸ªChannelHandler æœ‰æ—¶å¯èƒ½éœ€è¦ä¸é‚£äº›ä½¿ç”¨é˜»å¡APIçš„é—ç•™ä»£ç è¿›è¡Œäº¤äº’ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼ŒChannelPipelineæœ‰ä¸€äº›æ¥å—ä¸€ä¸ªEventExecutorGroupçš„add()æ–¹æ³•ã€‚å¦‚æœä¸€ä¸ªäº‹ä»¶è¢«ä¼ é€’ç»™ä¸€ä¸ªè‡ªå®šä¹‰çš„EventExecutor- Groupï¼Œå®ƒå°†è¢«åŒ…å«åœ¨è¿™ä¸ªEventExecutorGroupä¸­çš„æŸä¸ªEventExecutoræ‰€å¤„ç†ï¼Œä»è€Œè¢«ä»è¯¥Channelæœ¬èº«çš„EventLoopä¸­ç§»é™¤ã€‚å¯¹äºè¿™ç§ç”¨ä¾‹ï¼ŒNettyæä¾›äº†ä¸€ä¸ªå«DefaultEventExecutor- Groupçš„é»˜è®¤å®ç°ã€‚ channelPipeline æ¥è®¿é—®ChannelHandlerçš„æ–¹æ³• å ç§° æ è¿° get é€šè¿‡ç±»å‹æˆ–è€…åç§°è¿”å›ChannelHandler context è¿”å›å’ŒChannelHandlerç»‘å®šçš„ChannelHandlerContext names è¿”å›ChannelPipelineä¸­æ‰€æœ‰ChannelHandlerçš„åç§° channelPipeline äº‹ä»¶è§¦å‘æ–¹æ³• å…¥ç«™äº‹ä»¶ æ–¹æ³•åç§° æ è¿° fireChannelRegistered è°ƒç”¨ChannelPipelineä¸­ä¸‹ä¸€ä¸ªChannelInboundHandlerçš„channelRegistered(ChannelHandlerContext)æ–¹æ³• fireChannelUnregistered è°ƒç”¨ChannelPipelineä¸­ä¸‹ä¸€ä¸ªChannelInboundHandlerçš„channelUnregistered(ChannelHandlerContext)æ–¹æ³• fireChannelActive è°ƒç”¨ChannelPipelineä¸­ä¸‹ä¸€ä¸ªChannelInboundHandlerçš„channelActive(ChannelHandlerContext)æ–¹æ³• fireChannelInactive è°ƒç”¨ChannelPipelineä¸­ä¸‹ä¸€ä¸ªChannelInboundHandlerçš„channelInactive(ChannelHandlerContext)æ–¹æ³• fireExceptionCaught è°ƒç”¨ChannelPipelineä¸­ä¸‹ä¸€ä¸ªChannelInboundHandlerçš„exceptionCaught(ChannelHandlerContext,Throwable)æ–¹æ³• fireUserEventTriggered è°ƒç”¨ChannelPipelineä¸­ä¸‹ä¸€ä¸ªChannelInboundHandlerçš„userEventTriggered(ChannelHandlerContext,Object)æ–¹æ³• fireChannelRead è°ƒç”¨ChannelPipelineä¸­ä¸‹ä¸€ä¸ªChannelInboundHandlerçš„channelRead(ChannelHandlerContext,Objectmsg)æ–¹æ³• fireChannelReadComplete è°ƒç”¨ChannelPipelineä¸­ä¸‹ä¸€ä¸ªChannelInboundHandlerçš„channelReadComplete(ChannelHandlerContext)æ–¹æ³• fireChannelWritabilityChanged è°ƒç”¨ChannelPipelineä¸­ä¸‹ä¸€ä¸ªChannelInboundHandlerçš„channelWritabilityChanged(ChannelHandlerContext)æ–¹æ³• å‡ºç«™äº‹ä»¶ æ–¹æ³•åç§° æ è¿° bind å°†Channelç»‘å®šåˆ°ä¸€ä¸ªæœ¬åœ°åœ°å€ï¼Œè¿™å°†è°ƒç”¨ChannelPipelineä¸­çš„ä¸‹ä¸€ä¸ªChannelOutboundHandlerçš„bind(ChannelHandlerContext,SocketAddress,ChannelPromise)æ–¹æ³• connect å°†Channelè¿æ¥åˆ°ä¸€ä¸ªè¿œç¨‹åœ°å€ï¼Œè¿™å°†è°ƒç”¨ChannelPipelineä¸­çš„ä¸‹ä¸€ä¸ªChannelOutboundHandlerçš„connect(ChannelHandlerContext,SocketAddress,ChannelPromise)æ–¹æ³• disconnect å°†Channelæ–­å¼€è¿æ¥ã€‚è¿™å°†è°ƒç”¨ChannelPipelineä¸­çš„ä¸‹ä¸€ä¸ªChannelOutboundHandlerçš„disconnect(ChannelHandlerContext,ChannelPromise)æ–¹æ³• close å°†Channelå…³é—­ã€‚è¿™å°†è°ƒç”¨ChannelPipelineä¸­çš„ä¸‹ä¸€ä¸ªChannelOutboundHandlerçš„close(ChannelHandlerContext,ChannelPromise)æ–¹æ³• deregister å°†Channelä»å®ƒå…ˆå‰æ‰€åˆ†é…çš„EventExecutorï¼ˆå³EventLoopï¼‰ä¸­æ³¨é”€ã€‚è¿™å°†è°ƒç”¨ChannelPipelineä¸­çš„ä¸‹ä¸€ä¸ªChannelOutboundHandlerçš„deregister(ChannelHandlerContext,ChannelPromise)æ–¹æ³• flush å†²åˆ·Channelæ‰€æœ‰æŒ‚èµ·çš„å†™å…¥ã€‚è¿™å°†è°ƒç”¨ChannelPipelineä¸­çš„ä¸‹ä¸€ä¸ªChannelOutboundHandlerçš„flush(ChannelHandlerContext)æ–¹æ³• write å°†æ¶ˆæ¯å†™å…¥Channelã€‚è¿™å°†è°ƒç”¨ChannelPipelineä¸­çš„ä¸‹ä¸€ä¸ªChannelOutboundHandlerçš„write(ChannelHandlerContext,Objectmsg,ChannelPromise)æ–¹æ³•ã€‚æ³¨æ„ï¼šè¿™å¹¶ä¸ä¼šå°†æ¶ˆæ¯å†™å…¥åº•å±‚çš„Socketï¼Œè€Œåªä¼šå°†å®ƒæ”¾å…¥é˜Ÿåˆ—ä¸­ã€‚è¦å°†å®ƒå†™å…¥Socketï¼Œéœ€è¦è°ƒç”¨flush()æˆ–è€…writeAndFlush()æ–¹æ³• writeAndFlush è¿™æ˜¯ä¸€ä¸ªå…ˆè°ƒç”¨write()æ–¹æ³•å†æ¥ç€è°ƒç”¨flush()æ–¹æ³•çš„ä¾¿åˆ©æ–¹æ³• read è¯·æ±‚ä»Channelä¸­è¯»å–æ›´å¤šçš„æ•°æ®ã€‚è¿™å°†è°ƒç”¨ChannelPipelineä¸­çš„ä¸‹ä¸€ä¸ªChannelOutboundHandlerçš„read(ChannelHandlerContext)æ–¹æ³• æ€»ç»“ä¸€ä¸‹ï¼š ChannelPipelineä¿å­˜äº†ä¸Channelç›¸å…³è”çš„ChannelHandlerï¼› ChannelPipelineå¯ä»¥æ ¹æ®éœ€è¦ï¼Œé€šè¿‡æ·»åŠ æˆ–è€…åˆ é™¤ChannelHandleræ¥åŠ¨æ€åœ°ä¿®æ”¹ï¼› ChannelPipelineæœ‰ç€ä¸°å¯Œçš„APIç”¨ä»¥è¢«è°ƒç”¨ï¼Œä»¥å“åº”å…¥ç«™å’Œå‡ºç«™äº‹ä»¶ã€‚ channelHandlerContextæ¥å£ChannelHandlerContextä»£è¡¨äº†ChannelHandlerå’ŒChannelPipelineä¹‹é—´çš„å…³è”ï¼Œæ¯å½“æœ‰ChannelHandleræ·»åŠ åˆ°ChannelPipelineä¸­æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºChannelHandler- Contextã€‚ChannelHandlerContextçš„ä¸»è¦åŠŸèƒ½æ˜¯ç®¡ç†å®ƒæ‰€å…³è”çš„ChannelHandlerå’Œåœ¨åŒä¸€ä¸ªChannelPipelineä¸­çš„å…¶ä»–ChannelHandlerä¹‹é—´çš„äº¤äº’ ChannelHandlerContextæœ‰å¾ˆå¤šçš„æ–¹æ³•ï¼Œå…¶ä¸­ä¸€äº›æ–¹æ³•ä¹Ÿå­˜åœ¨äºChannelå’ŒChannel- Pipelineæœ¬èº«ä¸Šï¼Œä½†æ˜¯æœ‰ä¸€ç‚¹é‡è¦çš„ä¸åŒã€‚å¦‚æœè°ƒç”¨Channelæˆ–è€…ChannelPipelineä¸Šçš„è¿™äº›æ–¹æ³•ï¼Œå®ƒä»¬å°†æ²¿ç€æ•´ä¸ªChannelPipelineè¿›è¡Œä¼ æ’­ã€‚è€Œè°ƒç”¨ä½äºChannelHandlerContextä¸Šçš„ç›¸åŒæ–¹æ³•ï¼Œåˆ™å°†ä»å½“å‰æ‰€å…³è”çš„ChannelHandlerå¼€å§‹ï¼Œå¹¶ä¸”åªä¼šä¼ æ’­ç»™ä½äºè¯¥ChannelPipelineä¸­çš„ä¸‹ä¸€ä¸ªèƒ½å¤Ÿå¤„ç†è¯¥äº‹ä»¶çš„ChannelHandlerã€‚ æ–¹æ³•åç§° æ è¿° alloc è¿”å›å’Œè¿™ä¸ªå®ä¾‹ç›¸å…³è”çš„Channelæ‰€é…ç½®çš„ByteBufAllocator bind ç»‘å®šåˆ°ç»™å®šçš„SocketAddressï¼Œå¹¶è¿”å›ChannelFuture channel è¿”å›ç»‘å®šåˆ°è¿™ä¸ªå®ä¾‹çš„Channel close å…³é—­Channelï¼Œå¹¶è¿”å›ChannelFuture connect è¿æ¥ç»™å®šçš„SocketAddressï¼Œå¹¶è¿”å›ChannelFuture deregister ä»ä¹‹å‰åˆ†é…çš„EventExecutoræ³¨é”€ï¼Œå¹¶è¿”å›ChannelFuture disconnect ä»è¿œç¨‹èŠ‚ç‚¹æ–­å¼€ï¼Œå¹¶è¿”å›ChannelFuture executor è¿”å›è°ƒåº¦äº‹ä»¶çš„EventExecutor fireChannelActive è§¦å‘å¯¹ä¸‹ä¸€ä¸ªChannelInboundHandlerä¸Šçš„channelActive()æ–¹æ³•ï¼ˆå·²è¿æ¥ï¼‰çš„è°ƒç”¨ fireChannelInactive è§¦å‘å¯¹ä¸‹ä¸€ä¸ªChannelInboundHandlerä¸Šçš„channelInactive()æ–¹æ³•ï¼ˆå·²å…³é—­ï¼‰çš„è°ƒç”¨ fireChannelRead è§¦å‘å¯¹ä¸‹ä¸€ä¸ªChannelInboundHandlerä¸Šçš„channelRead()æ–¹æ³•ï¼ˆå·²æ¥æ”¶çš„æ¶ˆæ¯ï¼‰çš„è°ƒç”¨ fireChannelReadComplete è§¦å‘å¯¹ä¸‹ä¸€ä¸ªChannelInboundHandlerä¸Šçš„channelReadComplete()æ–¹æ³•çš„è°ƒç”¨ fireChannelRegistered è§¦å‘å¯¹ä¸‹ä¸€ä¸ªChannelInboundHandlerä¸Šçš„fireChannelRegistered()æ–¹æ³•çš„è°ƒç”¨ fireChannelUnregistered è§¦å‘å¯¹ä¸‹ä¸€ä¸ªChannelInboundHandlerä¸Šçš„fireChannelUnregistered()æ–¹æ³•çš„è°ƒç”¨ fireChannelWritabilityChanged è§¦å‘å¯¹ä¸‹ä¸€ä¸ªChannelInboundHandlerä¸Šçš„fireChannelWritabilityChanged()æ–¹æ³•çš„è°ƒç”¨ fireExceptionCaught è§¦å‘å¯¹ä¸‹ä¸€ä¸ªChannelInboundHandlerä¸Šçš„fireExceptionCaught(Throwable)æ–¹æ³•çš„è°ƒç”¨ fireUserEventTriggered è§¦å‘å¯¹ä¸‹ä¸€ä¸ªChannelInboundHandlerä¸Šçš„fireUserEventTriggered(Objectevt)æ–¹æ³•çš„è°ƒç”¨ handler è¿”å›ç»‘å®šåˆ°è¿™ä¸ªå®ä¾‹çš„ChannelHandler isRemoved å¦‚æœæ‰€å…³è”çš„ChannelHandlerå·²ç»è¢«ä»ChannelPipelineä¸­ç§»é™¤åˆ™è¿”å›true name è¿”å›è¿™ä¸ªå®ä¾‹çš„å”¯ä¸€åç§° pipeline è¿”å›è¿™ä¸ªå®ä¾‹æ‰€å…³è”çš„ChannelPipeline read å°†æ•°æ®ä»Channelè¯»å–åˆ°ç¬¬ä¸€ä¸ªå…¥ç«™ç¼“å†²åŒºï¼›å¦‚æœè¯»å–æˆåŠŸåˆ™è§¦å‘[5]ä¸€ä¸ªchannelReadäº‹ä»¶ï¼Œå¹¶ï¼ˆåœ¨æœ€åä¸€ä¸ªæ¶ˆæ¯è¢«è¯»å–å®Œæˆåï¼‰é€šçŸ¥ChannelInboundHandlerçš„channelReadComplete(ChannelHandlerContext)æ–¹æ³• write é€šè¿‡è¿™ä¸ªå®ä¾‹å†™å…¥æ¶ˆæ¯å¹¶ç»è¿‡ChannelPipeline writeAndFlush é€šè¿‡è¿™ä¸ªå®ä¾‹å†™å…¥å¹¶å†²åˆ·æ¶ˆæ¯å¹¶ç»è¿‡ChannelPipeline å½“ä½¿ç”¨ChannelHandlerContextçš„APIçš„æ—¶å€™ï¼Œè¯·ç‰¢è®°ä»¥ä¸‹ä¸¤ç‚¹ï¼š ChannelHandlerContextå’ŒChannelHandlerä¹‹é—´çš„å…³è”ï¼ˆç»‘å®šï¼‰æ˜¯æ°¸è¿œä¸ä¼šæ”¹å˜çš„ï¼Œæ‰€ä»¥ç¼“å­˜å¯¹å®ƒçš„å¼•ç”¨æ˜¯å®‰å…¨çš„ï¼› å¦‚åŒæˆ‘ä»¬åœ¨æœ¬èŠ‚å¼€å¤´æ‰€è§£é‡Šçš„ä¸€æ ·ï¼Œç›¸å¯¹äºå…¶ä»–ç±»çš„åŒåæ–¹æ³•ï¼ŒChannelHandlerContextçš„æ–¹æ³•å°†äº§ç”Ÿæ›´çŸ­çš„äº‹ä»¶æµï¼Œåº”è¯¥å°½å¯èƒ½åœ°åˆ©ç”¨è¿™ä¸ªç‰¹æ€§æ¥è·å¾—æœ€å¤§çš„æ€§èƒ½ã€‚ netty çš„å¼‚å¸¸å¤„ç†å¼‚å¸¸å¤„ç†æ˜¯ä»»ä½•çœŸå®åº”ç”¨ç¨‹åºçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå®ƒä¹Ÿå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼æ¥å®ç°ã€‚å› æ­¤ï¼ŒNettyæä¾›äº†å‡ ç§æ–¹å¼ç”¨äºå¤„ç†å…¥ç«™æˆ–è€…å‡ºç«™å¤„ç†è¿‡ç¨‹ä¸­æ‰€æŠ›å‡ºçš„å¼‚å¸¸ã€‚ å¦‚æœåœ¨å¤„ç†å…¥ç«™äº‹ä»¶çš„è¿‡ç¨‹ä¸­æœ‰å¼‚å¸¸è¢«æŠ›å‡ºï¼Œé‚£ä¹ˆå®ƒå°†ä»å®ƒåœ¨ChannelInboundHandleré‡Œè¢«è§¦å‘çš„é‚£ä¸€ç‚¹å¼€å§‹æµç»ChannelPipelineã€‚è¦æƒ³å¤„ç†è¿™ç§ç±»å‹çš„å…¥ç«™å¼‚å¸¸ï¼Œä½ éœ€è¦åœ¨ä½ çš„ChannelInboundHandlerå®ç°ä¸­é‡å†™ä¸‹é¢çš„æ–¹æ³•ã€‚ å› ä¸ºå¼‚å¸¸ä¼šå‘å…¥ç«™æ–¹å‘æµåŠ¨,ï¼Œæ‰€ä»¥å®ç°äº†å‰é¢æ‰€ç¤ºé€»è¾‘çš„ChannelInboundHandleré€šå¸¸ä½äºChannelPipelineçš„æœ€å,ç¡®ä¿äº†æ‰€æœ‰çš„å…¥ç«™å¼‚å¸¸éƒ½æ€»æ˜¯ä¼šè¢«å¤„ç†ï¼Œæ— è®ºå®ƒä»¬å¯èƒ½ä¼šå‘ç”Ÿåœ¨ChannelPipelineä¸­çš„ä»€ä¹ˆä½ç½® ä½ åº”è¯¥å¦‚ä½•å“åº”å¼‚å¸¸ï¼Œå¯èƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºä½ çš„åº”ç”¨ç¨‹åºã€‚ä½ å¯èƒ½æƒ³è¦å…³é—­Channelï¼ˆå’Œè¿æ¥ï¼‰ï¼Œä¹Ÿå¯èƒ½ä¼šå°è¯•è¿›è¡Œæ¢å¤ã€‚å¦‚æœä½ ä¸å®ç°ä»»ä½•å¤„ç†å…¥ç«™å¼‚å¸¸çš„é€»è¾‘ï¼ˆæˆ–è€…æ²¡æœ‰æ¶ˆè´¹è¯¥å¼‚å¸¸ï¼‰ï¼Œé‚£ä¹ˆNettyå°†ä¼šè®°å½•è¯¥å¼‚å¸¸æ²¡æœ‰è¢«å¤„ç†çš„äº‹å®[7]ã€‚ æ€»ç»“ä¸€ä¸‹ï¼š ChannelHandler.exceptionCaught()çš„é»˜è®¤å®ç°æ˜¯ç®€å•åœ°å°†å½“å‰å¼‚å¸¸è½¬å‘ç»™ChannelPipelineä¸­çš„ä¸‹ä¸€ä¸ªChannelHandlerï¼› å¦‚æœå¼‚å¸¸åˆ°è¾¾äº†ChannelPipelineçš„å°¾ç«¯ï¼Œå®ƒå°†ä¼šè¢«è®°å½•ä¸ºæœªè¢«å¤„ç†ï¼› è¦æƒ³å®šä¹‰è‡ªå®šä¹‰çš„å¤„ç†é€»è¾‘ï¼Œä½ éœ€è¦é‡å†™exceptionCaught()æ–¹æ³•ã€‚ç„¶åä½ éœ€è¦å†³å®šæ˜¯å¦éœ€è¦å°†è¯¥å¼‚å¸¸ä¼ æ’­å‡ºå»ã€‚ ç”¨äºå¤„ç†å‡ºç«™æ“ä½œä¸­çš„æ­£å¸¸å®Œæˆä»¥åŠå¼‚å¸¸çš„é€‰é¡¹ï¼Œéƒ½åŸºäºä»¥ä¸‹çš„é€šçŸ¥æœºåˆ¶ã€‚ æ¯ä¸ªå‡ºç«™æ“ä½œéƒ½å°†è¿”å›ä¸€ä¸ªChannelFutureã€‚æ³¨å†Œåˆ°ChannelFutureçš„Channel- FutureListenerå°†åœ¨æ“ä½œå®Œæˆæ—¶è¢«é€šçŸ¥è¯¥æ“ä½œæ˜¯æˆåŠŸäº†è¿˜æ˜¯å‡ºé”™äº†ã€‚ å‡ ä¹æ‰€æœ‰çš„ChannelOutboundHandlerä¸Šçš„æ–¹æ³•éƒ½ä¼šä¼ å…¥ä¸€ä¸ªChannelPromiseçš„å®ä¾‹ã€‚ä½œä¸ºChannelFutureçš„å­ç±»ï¼ŒChannelPromiseä¹Ÿå¯ä»¥è¢«åˆ†é…ç”¨äºå¼‚æ­¥é€šçŸ¥çš„ç›‘å¬å™¨ã€‚ä½†æ˜¯ï¼ŒChannelPromiseè¿˜å…·æœ‰æä¾›ç«‹å³é€šçŸ¥çš„å¯å†™æ–¹æ³•ï¼š æ·»åŠ ChannelFutureListeneråªéœ€è¦è°ƒç”¨ChannelFutureå®ä¾‹ä¸Šçš„addListener(ChannelFutureListener)æ–¹æ³•ï¼Œå¹¶ä¸”æœ‰ä¸¤ç§ä¸åŒçš„æ–¹å¼å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚ æ–¹æ³•ä¸€æ˜¯ï¼Œè°ƒç”¨å‡ºç«™æ“ä½œï¼ˆå¦‚write()æ–¹æ³•ï¼‰æ‰€è¿”å›çš„ChannelFutureä¸Šçš„addListener()æ–¹æ³•ã€‚ ç¬¬äºŒç§æ–¹å¼æ˜¯å°†ChannelFutureListeneræ·»åŠ åˆ°å³å°†ä½œä¸ºå‚æ•°ä¼ é€’ç»™ChannelOut- boundHandlerçš„æ–¹æ³•çš„ChannelPromise è¿™ç§æ–¹å¼å¯ä»¥åœ¨å…¨å±€ä¸Šåšäº†ç›‘å¬,ä¹Ÿå°±æ˜¯è¯´å¦‚æœæ•´ä¸ªChannelOutboundHandlerå‡ºç°äº†é—®é¢˜,å°†ä¼šåœ¨ChannelPromiseæ³¨å†Œçš„ç›‘å¬å…¶ä¸­è¿›è¡Œç›‘å¬","date":"2024-12-31","categories":["java"],"tags":["netty"]},{"title":"netty-(4)EventLoopå’Œçº¿ç¨‹æ¨¡å‹","url":"/2024/12/31/netty--4-EventLoopå’Œçº¿ç¨‹æ¨¡å‹/","content":"çº¿ç¨‹æ± æ¨¡å‹æ¦‚è¿°åŸºæœ¬çš„çº¿ç¨‹æ± åŒ–æ¨¡å¼å¯ä»¥æè¿°ä¸ºï¼š ä»æ± çš„ç©ºé—²çº¿ç¨‹åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªThreadï¼Œå¹¶ä¸”æŒ‡æ´¾å®ƒå»è¿è¡Œä¸€ä¸ªå·²æäº¤çš„ä»»åŠ¡ï¼ˆä¸€ä¸ªRunnableçš„å®ç°ï¼‰ï¼›å½“ä»»åŠ¡å®Œæˆæ—¶ï¼Œå°†è¯¥Threadè¿”å›ç»™è¯¥åˆ—è¡¨ï¼Œä½¿å…¶å¯è¢«é‡ç”¨ã€‚ nettyä¸­çº¿ç¨‹æ¨¡å‹(eventLoop)ä½¿ç”¨ EventLoopæ¥å£ è¿è¡Œä»»åŠ¡æ¥å¤„ç†åœ¨è¿æ¥çš„ç”Ÿå‘½å‘¨æœŸå†…å‘ç”Ÿçš„äº‹ä»¶æ˜¯ä»»ä½•ç½‘ç»œæ¡†æ¶çš„åŸºæœ¬åŠŸèƒ½ã€‚ä¸ä¹‹ç›¸åº”çš„ç¼–ç¨‹ä¸Šçš„æ„é€ é€šå¸¸è¢«ç§°ä¸ºäº‹ä»¶å¾ªç¯â€”â€”ä¸€ä¸ªNettyä½¿ç”¨äº†interface io.netty.channel. EventLoopæ¥é€‚é…çš„æœ¯è¯­ã€‚ ä¸€æ®µä»£ç è¡¨ç¤º,äº‹ä»¶å¾ªç¯çš„åŸºæœ¬æ€æƒ³ï¼Œå…¶ä¸­æ¯ä¸ªä»»åŠ¡éƒ½æ˜¯ä¸€ä¸ªRunnableçš„å®ä¾‹ netty ä¸­EventLoopå’Œchannelä¹‹é—´çš„äº¤äº’çŠ¶æ€çš„åˆå¹¶æ–¹å¼ Nettyçš„EventLoopæ˜¯ååŒè®¾è®¡çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒé‡‡ç”¨äº†ä¸¤ä¸ªåŸºæœ¬çš„APIï¼šå¹¶å‘å’Œç½‘ç»œç¼–ç¨‹ã€‚é¦–å…ˆï¼Œio.netty.util.concurrentåŒ…æ„å»ºåœ¨JDKçš„java.util.concurrentåŒ…ä¸Šï¼Œç”¨æ¥æä¾›çº¿ç¨‹æ‰§è¡Œå™¨ã€‚å…¶æ¬¡ï¼Œio.netty.channelåŒ…ä¸­çš„ç±»ï¼Œä¸ºäº†ä¸Channelçš„äº‹ä»¶è¿›è¡Œäº¤äº’ï¼Œæ‰©å±•äº†è¿™äº›æ¥å£&#x2F;ç±»ã€‚ åœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œä¸€ä¸ªEventLoopå°†ç”±ä¸€ä¸ªæ°¸è¿œéƒ½ä¸ä¼šæ”¹å˜çš„Threadé©±åŠ¨ï¼ŒåŒæ—¶ä»»åŠ¡ï¼ˆRunnableæˆ–è€…Callableï¼‰å¯ä»¥ç›´æ¥æäº¤ç»™EventLoopå®ç°ï¼Œä»¥ç«‹å³æ‰§è¡Œæˆ–è€…è°ƒåº¦æ‰§è¡Œã€‚ æ ¹æ®é…ç½®å’Œå¯ç”¨æ ¸å¿ƒçš„ä¸åŒï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤šä¸ªEventLoopå®ä¾‹ç”¨ä»¥ä¼˜åŒ–èµ„æºçš„ä½¿ç”¨ï¼Œå¹¶ä¸”å•ä¸ªEventLoopå¯èƒ½ä¼šè¢«æŒ‡æ´¾ç”¨äºæœåŠ¡å¤šä¸ªChannelã€‚ åœ¨Netty 4ä¸­ï¼Œæ‰€æœ‰çš„I&#x2F;Oæ“ä½œå’Œäº‹ä»¶éƒ½ç”±å·²ç»è¢«åˆ†é…ç»™äº†EventLoopçš„é‚£ä¸ªThreadæ¥å¤„ç† jdkå»¶æ—¶ä»»åŠ¡å’Œnettyçš„å»¶æ—¶ä»»åŠ¡åœ¨æ‰§è¡Œå»¶æ—¶ä»»åŠ¡çš„æ—¶å€™jdkçš„åšæ³•å’Œnettyçš„åšæ³•æ˜¯ä¸åŒçš„ javaä½¿ç”¨å¤šçº¿ç¨‹æœºåˆ¶å®ç°å»¶è¿Ÿæ“ä½œScheduledExecutorServiceç­‰java.util.concurrent.Executors ç±» ä¸€ä¸ªä¾‹å­ åœ¨nettyæ‰€æœ‰çš„äº‹ä»¶æœ¬è´¨ä¸Šéƒ½æ˜¯ä½¿ç”¨æ—¶é—´è½®è®­çš„æ–¹æ³•å®ç°çš„ æ‰€ä»¥Nettyé€šè¿‡Channelçš„EventLoopå®ç°ä»»åŠ¡è°ƒåº¦è§£å†³äº†è¿™ä¸€é—®é¢˜ ç»è¿‡60ç§’ä¹‹åï¼ŒRunnableå®ä¾‹å°†ç”±åˆ†é…ç»™Channelçš„EventLoopæ‰§è¡Œã€‚å¦‚æœè¦è°ƒåº¦ä»»åŠ¡ä»¥æ¯éš”60ç§’æ‰§è¡Œä¸€æ¬¡ï¼Œè¯·ä½¿ç”¨scheduleAtFixedRate()æ–¹æ³• æ³¨æ„:Nettyçš„EventLoopæ‰©å±•äº†ScheduledExecutorServiceï¼ˆè§å›¾7-2ï¼‰ï¼Œæ‰€ä»¥å®ƒæä¾›äº†ä½¿ç”¨JDKå®ç°å¯ç”¨çš„æ‰€æœ‰æ–¹æ³•ï¼ŒåŒ…æ‹¬åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ä½¿ç”¨åˆ°çš„schedule()å’ŒscheduleAtFixedRate()æ–¹æ³• è¦æƒ³å–æ¶ˆæˆ–è€…æ£€æŸ¥ï¼ˆè¢«è°ƒåº¦ä»»åŠ¡çš„ï¼‰æ‰§è¡ŒçŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨æ¯ä¸ªå¼‚æ­¥æ“ä½œæ‰€è¿”å›çš„Scheduled- Future","date":"2024-12-31","categories":["java"],"tags":["netty"]},{"title":"netty-(5)bootstrap","url":"/2024/12/31/netty--5-bootstrap/","content":"å…¶å®å¯¹äºä»»ä½•æ¡†æ¶æ¥è¯´,éƒ½ä¼šæœ‰ä¸€ä¸ªå…¬å…±çš„å…¥å£,åœ¨nettyä¸­è¿™ä¸ªå…¥å£è¢«å«åš bootstrap å¼•å¯¼ å¼•å¯¼ç±»çš„å±‚æ¬¡ç»“æ„åŒ…æ‹¬ä¸€ä¸ªæŠ½è±¡çš„çˆ¶ç±»å’Œä¸¤ä¸ªå…·ä½“çš„å¼•å¯¼å­ç±» é’ˆå¯¹ä¸Šå›¾æˆ‘ä»¬èƒ½çœ‹å‡ºæ¥,ç‰¹å®šäºå®¢æˆ·ç«¯æˆ–è€…æœåŠ¡å™¨çš„å¼•å¯¼æ­¥éª¤åˆ™åˆ†åˆ«ç”±Bootstrapæˆ–ServerBootstrapå¤„ç† æ³¨æ„: ä½ æœ‰æ—¶å¯èƒ½ä¼šéœ€è¦åˆ›å»ºå¤šä¸ªå…·æœ‰ç±»ä¼¼é…ç½®æˆ–è€…å®Œå…¨ç›¸åŒé…ç½®çš„Channelã€‚ä¸ºäº†æ”¯æŒè¿™ç§æ¨¡å¼è€Œåˆä¸éœ€è¦ä¸ºæ¯ä¸ªChanneléƒ½åˆ›å»ºå¹¶é…ç½®ä¸€ä¸ªæ–°çš„å¼•å¯¼ç±»å®ä¾‹ï¼ŒAbstractBootstrapè¢«æ ‡è®°ä¸ºäº†Cloneable[5]ã€‚åœ¨ä¸€ä¸ªå·²ç»é…ç½®å®Œæˆçš„å¼•å¯¼ç±»å®ä¾‹ä¸Šè°ƒç”¨clone()æ–¹æ³•å°†è¿”å›å¦ä¸€ä¸ªå¯ä»¥ç«‹å³ä½¿ç”¨çš„å¼•å¯¼ç±»å®ä¾‹ã€‚ æ³¨æ„:è¿™ç§æ–¹å¼åªä¼šåˆ›å»ºå¼•å¯¼ç±»å®ä¾‹çš„EventLoopGroupçš„ä¸€ä¸ªæµ…æ‹·è´ï¼Œæ‰€ä»¥ï¼Œåè€…[6]å°†åœ¨æ‰€æœ‰å…‹éš†çš„Channelå®ä¾‹ä¹‹é—´å…±äº«ã€‚è¿™æ˜¯å¯ä»¥æ¥å—çš„ï¼Œå› ä¸ºé€šå¸¸è¿™äº›å…‹éš†çš„Channelçš„ç”Ÿå‘½å‘¨æœŸéƒ½å¾ˆçŸ­æš‚ï¼Œä¸€ä¸ªå…¸å‹çš„åœºæ™¯æ˜¯â€”â€”åˆ›å»ºä¸€ä¸ªChannelä»¥è¿›è¡Œä¸€æ¬¡HTTPè¯·æ±‚ã€‚ å®¢æˆ·ç«¯å¼•å¯¼ç¨‹åºBootstrapç±»è´Ÿè´£ä¸ºå®¢æˆ·ç«¯å’Œä½¿ç”¨æ— è¿æ¥åè®®çš„åº”ç”¨ç¨‹åºåˆ›å»ºChannel æœåŠ¡ç«¯å¼•å¯¼ç¨‹åºä¸‹å›¾å±•ç¤ºäº†ServerBootstrapåœ¨bind()æ–¹æ³•è¢«è°ƒç”¨æ—¶åˆ›å»ºäº†ä¸€ä¸ªServerChannelï¼Œå¹¶ä¸”è¯¥ServerChannelç®¡ç†äº†å¤šä¸ªå­Channelã€‚ å½“ä»channelä¸­ç”Ÿæˆå¼•å¯¼ä½¿ç”¨æ–°çš„EventLoopåœ¨nettyä¸­ä¸€ä¸ªEventLoopå¯¹åº”ä¸€ä¸ªçº¿ç¨‹,ä¸ºäº†é™ä½ç³»ç»Ÿçš„æ€§èƒ½æŸè€—,åœ¨nettyä¸­ä½¿ç”¨äº†Bootstrapçš„groupæ–¹æ³•æ¥é‡ç”¨EventLoop netty handleçš„åˆå§‹åŒ–æ“ä½œNettyæä¾›äº†ä¸€ä¸ªç‰¹æ®Šçš„ChannelInboundHandlerAdapterå­ç±» æå®ç°äº†ä¸€ä¸ªç‰¹æ®Šæ–¹æ³• è¿™ä¸ªå­ç±»æˆ–è€…è¯´handle ä¸€æ—¦è¢«æ³¨å†Œåˆ°äº†å®ƒçš„EventLoopä¹‹åï¼Œå°±ä¼šè°ƒç”¨ä½ çš„initChannel()æ–¹æ³•ã€‚åœ¨è¯¥æ–¹æ³•è¿”å›ä¹‹åï¼ŒChannelInitializerçš„å®ä¾‹å°†ä¼šä»Channel-Pipelineä¸­ç§»é™¤å®ƒè‡ªå·±ã€‚ netty çš„é…ç½®å±æ€§å’Œä¼ é€’æ€§å‚æ•°å±æ€§nettyçš„bootstrap æä¾›äº† option() æ–¹æ³•æ¥å°†ChannelOption é…ç½®è¿›ç³»ç»Ÿä¸­,æä¾›äº†æ–¹ä¾¿çš„é…ç½®æ–¹æ³• å¹¶ä¸”nettyçš„å¼•å¯¼è¿˜æä¾›äº†AttributeMap(ä¸€ä¸ªç”±Channelå’Œå¼•å¯¼ç±»æä¾›çš„é›†åˆ)å’ŒAttributeKey(ä¸€ä¸ªç”¨äºæ’å…¥å’Œè·å–å±æ€§å€¼çš„æ³›å‹ç±»),é€šè¿‡è¿™ç§æ–¹æ³•,å°±å¯ä»¥å°†ç›¸å…³çš„å±æ€§ä¼ é€’åˆ°æœåŠ¡ä¸­çš„channelä¸­å»äº† nettyçš„å…³é—­nettyçš„ä¼˜é›…å…³é—­ ä½ éœ€è¦å…³é—­EventLoopGroupï¼Œå®ƒå°†å¤„ç†ä»»ä½•æŒ‚èµ·çš„äº‹ä»¶å’Œä»»åŠ¡ï¼Œå¹¶ä¸”éšåé‡Šæ”¾æ‰€æœ‰æ´»åŠ¨çš„çº¿ç¨‹ã€‚è¿™å°±æ˜¯è°ƒç”¨EventLoopGroup.shutdownGracefully()æ–¹æ³•çš„ä½œç”¨ã€‚è¿™ä¸ªæ–¹æ³•è°ƒç”¨å°†ä¼šè¿”å›ä¸€ä¸ªFutureï¼Œè¿™ä¸ªFutureå°†åœ¨å…³é—­å®Œæˆæ—¶æ¥æ”¶åˆ°é€šçŸ¥ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒshutdownGracefully()æ–¹æ³•ä¹Ÿæ˜¯ä¸€ä¸ªå¼‚æ­¥çš„æ“ä½œï¼Œæ‰€ä»¥ä½ éœ€è¦é˜»å¡ç­‰å¾…ç›´åˆ°å®ƒå®Œæˆï¼Œæˆ–è€…å‘æ‰€è¿”å›çš„Futureæ³¨å†Œä¸€ä¸ªç›‘å¬å™¨ä»¥åœ¨å…³é—­å®Œæˆæ—¶è·å¾—é€šçŸ¥ã€‚ æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨è°ƒç”¨EventLoopGroup.shutdownGracefully()æ–¹æ³•ä¹‹å‰ï¼Œæ˜¾å¼åœ°åœ¨æ‰€æœ‰æ´»åŠ¨çš„Channelä¸Šè°ƒç”¨Channel.close()æ–¹æ³•ã€‚ä½†æ˜¯åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œéƒ½è¯·è®°å¾—å…³é—­EventLoopGroupæœ¬èº«ã€‚","date":"2024-12-31","categories":["java"],"tags":["netty"]},{"title":"netty-é«˜æ€§èƒ½ç½‘ç»œæ¡†æ¶-Nettyçš„ç»„å»ºå’Œè®¾è®¡","url":"/2024/12/31/netty-é«˜æ€§èƒ½ç½‘ç»œæ¡†æ¶-Nettyçš„ç»„å»ºå’Œè®¾è®¡/","content":"nettyé«˜æ€§èƒ½ç½‘ç»œæ¡†æ¶-Nettyçš„ç»„å»ºå’Œè®¾è®¡ åœ¨Nettyæ¡†æ¶ä¸­æœ‰ä¸‰å¤§å…³é”®ç»„å»º ChannelEventLoopchannelFutureChannelHandlerchannelPipelinebootstrap å¦‚æœå’Œç½‘ç»œä¸­çš„ç›¸å…³æ¦‚å¿µç›¸äº’å¯¹åº”å°†ä¼šæ˜¯å¦‚ä¸‹çš„ç»“æœï¼š Channelâ€”â€”Socket EventLoopâ€”â€”æ§åˆ¶æµã€å¤šçº¿ç¨‹å¤„ç†ã€å¹¶å‘ ChannelFutureâ€”â€”å¼‚æ­¥é€šçŸ¥ ä¸€.Chanelæ¥å£è¿™ä¸ªæ¥å£å®ç°åŸºæœ¬çš„ioæ“ä½œ(bind()ã€connect()ã€read()ã€write())ï¼Œæ˜ å°„ä¼ ç»ŸjavaSocketçš„ç¼–ç¨‹è¿‡ç¨‹ï¼Œå¤§å¤§é™ä½ç›¸å…³çš„ç›´æ¥ä½¿ç”¨socketçš„å¤æ‚ç¨‹åº¦ã€‚ç›¸å…³çš„å®ç°ç±»å·¥ç¨‹å¸ˆ NioSocketChannel NioSocketServerChannel äºŒ.EventLoopæ¥å£è¿™ä¸ªæ¥å£ç›¸å½“äºä¸€ä¸ªäººå®¹å™¨ï¼Œæ§åˆ¶é“¾æ¥ç”Ÿå‘½å‘¨æœŸæ‰€å‘ç”Ÿçš„ç›¸å…³æ‰€æœ‰çš„äº‹ä»¶ã€‚ Channelã€EventLoopã€Threadã€EventLoopGroupä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾ï¼š ä¸‰.ChannelFuureæ¥å£åœ¨nettyä¸­å¤„ç†I&#x2F;Oæ“ä½œå¼‚æ­¥è¿”å›å€¼çš„æ–¹æ³•å°±æ˜¯ChannelFutrueæ¥å£ï¼Œè¿™ä¸ªæ¥å£çš„addListeneræ–¹æ³•å¯ä»¥æ³¨å†Œä¸€ä¸ªChannelFutureListeneræ–¹æ³•ï¼Œæ–¹ä¾¿åœ¨æŸä¸ªæ“ä½œå®Œæˆçš„æ—¶å€™å¾—åˆ°é€šçŸ¥ å››.ChannelHandleræ¥å£ç®¡ç†æ•°æ®æµå’Œæ‰§è¡Œåº”ç”¨ç¨‹åºé€»è¾‘çš„é‡è¦ç»„ä»¶ï¼ŒChannelHandlerå……å½“äº†æ‰€æœ‰å¤„ç†å…¥ç«™å’Œå‡ºç«™ç›¸å…³åº”ç”¨çš„é€»è¾‘å¤„ç†çš„å®¹å™¨ æœ‰ä¸¤ä¸ªéå¸¸å¸¸ç”¨çš„å­æ¥å£ ChannelInBoundHandlerå’ŒChannelOutboundHandleråˆ†åˆ«ä»£è¡¨å‡ºç«™å’Œå…¥ç«™çš„ç›¸å…³å¤„ç†é€»è¾‘ äº”.ChannelPipelineæ¥å£chanelPpelineæ¥å£ä¸ºChannelHandleré“¾æä¾›äº†å®¹å™¨ï¼Œå¹¶å®šä¹‰äº†ç”¨åœ¨è¯¥é“¾ä¸Šä¼ æ’­å…¥ç«™å’Œå‡ºç«™æ—¶é—´æµçš„apiï¼Œå½“channlè¢«åˆ›å»ºçš„æ—¶å€™å°†è‡ªåŠ¨çš„åˆ†é…åˆ°ä»–ä¸“å±çš„ChannelPipelineä¸­è¢«ç›¸å…³çš„channlhandleå¤„ç† ChnanelPipelineä¸­æµåŠ¨çš„æ˜¯äº‹ä»¶ï¼ˆäº‹ä»¶ä¸­å¯èƒ½é™„åŠ æ•°æ®ï¼‰ã€‚Nettyå®šä¹‰äº†ä¸¤ç§äº‹ä»¶ç±»å‹ï¼šå…¥ç«™ï¼ˆinboundï¼‰äº‹ä»¶å’Œå‡ºç«™ï¼ˆoutboundï¼‰äº‹ä»¶ã€‚ChannelPipelineä½¿ç”¨æ‹¦æˆªè¿‡æ»¤å™¨æ¨¡å¼ä½¿ç”¨æˆ·å¯ä»¥æŒæ§ChannelHandlerå¤„ç†äº‹ä»¶çš„æµç¨‹ã€‚æ³¨æ„ï¼šäº‹ä»¶åœ¨ChannelPipelineä¸­ä¸è‡ªåŠ¨æµåŠ¨è€Œéœ€è¦è°ƒç”¨ChannelHandlerContextä¸­è¯¸å¦‚fileXXX()æˆ–è€…read()ç±»ä¼¼çš„æ–¹æ³•å°†äº‹ä»¶ä»ä¸€ä¸ªChannelHandlerä¼ æ’­åˆ°ä¸‹ä¸€ä¸ªChannelHandler ç‰¹æ®Šä¸œè¥¿ChannelHandlerContext ContextæŒ‡ä¸Šä¸‹æ–‡å…³ç³»ï¼ŒChannelHandlerçš„ContextæŒ‡çš„æ˜¯ChannleHandlerä¹‹é—´çš„å…³ç³»ä»¥åŠChannelHandlerä¸ChannelPipelineä¹‹é—´çš„å…³ç³»ã€‚ChannelPipelineä¸­çš„äº‹ä»¶ä¼ æ’­ä¸»è¦ä¾èµ–äºChannelHandlerContextå®ç°ï¼Œç”±äºChannelHandlerContextä¸­æœ‰ChannelHandlerä¹‹é—´çš„å…³ç³»ï¼Œæ‰€ä»¥èƒ½å¾—åˆ°ChannelHandlerçš„åç»§èŠ‚ç‚¹ï¼Œä»è€Œå°†äº‹ä»¶ä¼ æ’­åˆ°ä¸‹ä¸€ä¸ªChannelHandler å…­.å¼•å¯¼bootstrap å¼•å¯¼å­—å¦‚å…¶æ„ï¼Œå°±æ˜¯è¿›è¡Œç›¸å…³é“¾æ¥å¤„ç†çš„å·¥å…·æ–¹æ³• ç±»åˆ« BootStrap ServerBootStrap ç½‘ç»œä¸­ç¼–ç¨‹çš„ä½œç”¨ é“¾æ¥è¿œç¨‹çš„ä¸»æœºå’Œç«¯å£ ç»‘å®šåˆ°ä¸€ä¸ªæœ¬åœ°ç«¯å£ EventLoopGroupçš„æ•°é‡ 1 2 æ³¨æ„:è¿™é‡ŒæœåŠ¡ç«¯çš„LoopGroupéœ€è¦ä¸¤ä¸ªï¼Œ,é»˜è®¤æœ‰ä¸¤ä¸ªeventloopåˆ†åˆ«æ˜¯bossGroupå’Œ workGroupï¼Œå…¶ä¸­bossç”¨æ¥ç›‘æ§tcpé“¾æ¥,workerç”¨æ¥å¤„ç†ioäº‹ä»¶ã€‚","date":"2024-12-31","categories":["java"],"tags":["netty"]},{"title":"spirngå›é¡¾(1)-spring-core","url":"/2024/12/31/spirngå›é¡¾-1--spring-core/","content":"spring ä»3.0 å¼€å§‹æ”¯æŒjavaé…ç½®æ‰€ä»¥è¿™é‡Œæ•´ç†ä¸€ä¸‹spring 3ä¹‹åé‡è¦çš„çŸ¥è¯† spring applicationå›é¡¾ä¸€ä¸‹applicationçš„ä¸œè¥¿ï¼Œè´Ÿè´£åˆå§‹åŒ–spring beanå®¹å™¨çš„éå¸¸é‡è¦çš„ç±» beanåœ¨springä¸­æ‰€æœ‰çš„javabeanéƒ½å°†ä¼šåˆå§‹åŒ–ä¸ºBeanDefinitionå¯¹è±¡ è¿™ä¸ªç±»å…¶å®æ‰¿è½½äº†javabeanä¸­æ‰€æœ‰çš„å…ƒæ•°æ®åŒ…æ‹¬ï¼š javabeanä¸­çš„å„ç§å±æ€§ï¼Œç±»åç­‰ javabeançš„å®ä¾‹åŒ–å¯¹è±¡ Beanè¡Œä¸ºé…ç½®å…ƒç´ ï¼Œç”¨äºå£°æ˜Beanåœ¨å®¹å™¨ä¸­çš„è¡Œä¸ºï¼ˆä½œç”¨åŸŸï¼Œç”Ÿå‘½å‘¨æœŸå›è°ƒç­‰ï¼‰ å¯¹å…¶ä»–beanè¿›è¡Œå·¥ä½œæ‰€éœ€çš„å¼•ç”¨ã€‚è¿™äº›å¼•ç”¨ä¹Ÿç§°ä¸ºåä½œè€…æˆ–ä¾èµ–é¡¹ é™¤äº†åŒ…å«æœ‰å…³å¦‚ä½•åˆ›å»ºç‰¹å®šbeançš„ä¿¡æ¯çš„beanå®šä¹‰ä¹‹å¤–ï¼Œé€šè¿‡applicationcontextæ–¹æ³•getBeanFactory()è¿”å›çš„BeanFactory å®ç°DefaultListableBeanFactoryå¯ä»¥å®ç°javabeançš„æ‰‹åŠ¨æ³¨å…¥ã€‚DefaultListableBeanFactory é€šè¿‡registerSingleton(..)å’Œ registerBeanDefinition(..)æ–¹æ³•æ”¯æŒæ­¤æ³¨å†Œã€‚ beançš„ä½¿ç”¨èŒƒå›´ èŒƒå›´ å†…å®¹ singleton (é»˜è®¤)å°†æ¯ä¸ªSpring IoCå®¹å™¨çš„å•ä¸ªbeanå®šä¹‰èŒƒå›´é™å®šä¸ºå•ä¸ªå¯¹è±¡å®ä¾‹ prototype å°†å•ä¸ªbeanå®šä¹‰çš„ä½œç”¨åŸŸé™å®šä¸ºä»»æ„æ•°é‡çš„å¯¹è±¡å®ä¾‹ request å°†å•ä¸ªbeanå®šä¹‰çš„èŒƒå›´é™å®šä¸ºå•ä¸ªHTTPè¯·æ±‚çš„ç”Ÿå‘½å‘¨æœŸ session å°†å•ä¸ªbeanå®šä¹‰çš„ä½œç”¨åŸŸé™å®šä¸ºHTTPä¼šè¯çš„ç”Ÿå‘½å‘¨æœŸ application å°†å•ä¸ªbeanå®šä¹‰çš„ä½œç”¨åŸŸé™å®šä¸ºServletContextçš„ç”Ÿå‘½å‘¨æœŸ websocket å°†å•ä¸ªbeanå®šä¹‰çš„ä½œç”¨åŸŸé™å®šä¸ºWebSocketçš„ç”Ÿå‘½å‘¨æœŸ åœ¨javaé…ç½®æ–¹æ³•ä¸­å¯ä»¥ä½¿ç”¨@ApplicationScopeæ¥åˆ¶å®šä½œç”¨ç¯å¢ƒ beanä½œç”¨åŸŸè‡ªå®šä¹‰æš‚æ—¶çœç•¥ spring bean ç”Ÿå‘½å‘¨æœŸæ§åˆ¶spring bean ç”Ÿå‘½å‘¨æœŸå›è°ƒé’©å­spring æä¾›äº†ä¸¤ç§ç”Ÿå‘½å‘¨æœŸå›è°ƒé’©å­ æ¥æ‰£å’Œæ³¨è§£ å®ç°Spring InitializingBeanå’ŒDisposableBeanæ¥å£ï¼Œåˆ†åˆ«æä¾›äº†afterPropertiesSet()å’Œdestroy()åè€…ä½¿beanåœ¨åˆå§‹åŒ–å’Œé”€æ¯â€‹â€‹beanæ—¶æ‰§è¡ŒæŸäº›æ“ä½œ ä½¿ç”¨@PostConstructå’Œ@PreDestroy æ³¨è§£ ç›‘å¬å®¹å™¨å’Œspring çŠ¶æ€çš„é’©å­ Lifecycleæ¥å£ï¼Œç”¨æ¥ç›‘å¬spring beançŠ¶æ€çš„é’©å­ LifecycleProcessor ç”¨æ¥å¯¹ApplicationContextçš„é‡å¯å’Œå…³é—­åšååº”çš„æ¥å£ Phased å’ŒSmartLifecycle Phasedæ¥å£æä¾›æä¾›äº†ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå°è¶Šæ—©è¿è¡Œè¶Šæ™šå…³é—­ SmartLifecycle è¯¥LifecycleProcessoræ¥å£è¿˜å®šä¹‰äº†ç”¨äºåˆ·æ–°å’Œå…³é—­ä¸Šä¸‹æ–‡çš„å›è°ƒæ–¹æ³•ã€‚åè€…é©±åŠ¨å…³é—­è¿‡ç¨‹ï¼Œå°±å¥½åƒstop()å·²ç»æ˜¾å¼è°ƒç”¨äº†å®ƒä¸€æ ·ï¼Œä½†æ˜¯å®ƒåœ¨ä¸Šä¸‹æ–‡å…³é—­æ—¶å‘ç”Ÿã€‚å¦ä¸€æ–¹é¢ï¼Œâ€œåˆ·æ–°â€å›è°ƒå¯ç”¨äº†SmartLifecyclebeançš„å¦ä¸€ä¸ªåŠŸèƒ½ ã€‚åˆ·æ–°ä¸Šä¸‹æ–‡æ—¶ï¼ˆåœ¨æ‰€æœ‰å¯¹è±¡éƒ½è¢«å®ä¾‹åŒ–å’Œåˆå§‹åŒ–ä¹‹åï¼‰ï¼Œè¯¥å›è°ƒå°†è¢«è°ƒç”¨ã€‚æ­¤æ—¶ï¼Œé»˜è®¤çš„ç”Ÿå‘½å‘¨æœŸå¤„ç†å™¨å°†æ£€æŸ¥æ¯ä¸ªSmartLifecycleå¯¹è±¡çš„isAutoStartup()æ–¹æ³•è¿”å›çš„å¸ƒå°”å€¼ ã€‚å¦‚æœä¸ºtrueï¼Œåˆ™åœ¨è¯¥ç‚¹å¯åŠ¨è¯¥å¯¹è±¡ï¼Œè€Œä¸æ˜¯ç­‰å¾…ä¸Šä¸‹æ–‡æˆ–å…¶è‡ªèº«çš„æ˜¾å¼è°ƒç”¨start()æ–¹æ³•ï¼ˆä¸ä¸Šä¸‹æ–‡åˆ·æ–°ä¸åŒï¼Œå¯¹äºæ ‡å‡†ä¸Šä¸‹æ–‡å®ç°ï¼Œä¸Šä¸‹æ–‡å¯åŠ¨ä¸ä¼šè‡ªåŠ¨å‘ç”Ÿï¼‰ ä¼˜é›…å…³é—­spring éwebé¡¹ç›®ä½¿ç”¨ ä½¿ç”¨applicationContext çš„ registerShutdownHook() æ–¹æ³•å³å¯ ApplicationContextAwareå’ŒBeanNameAwareè¿™ä¸¤ä¸ªæ¥å£ ä¸€ä¸ªè·å–ä¸Šä¸‹æ–‡ä¿¡æ¯ ä¸€ä¸ªè·å–beançš„åç§° å…¶ä»–Aware åç§° æ³¨å…¥ä¾èµ– åœ¨â€¦ä¸­è§£é‡Š ApplicationContextAware å®£å‘ŠApplicationContextã€‚ ApplicationContextAware å’Œ BeanNameAware ApplicationEventPublisherAware é™„ä»¶çš„äº‹ä»¶å‘å¸ƒè€…ApplicationContextã€‚ çš„å…¶ä»–åŠŸèƒ½ ApplicationContext BeanClassLoaderAware ç±»åŠ è½½å™¨ï¼Œç”¨äºåŠ è½½Beanç±»ã€‚ å®ä¾‹åŒ–è±† BeanFactoryAware å®£å‘ŠBeanFactoryã€‚ ApplicationContextAware å’Œ BeanNameAware BeanNameAware å£°æ˜beançš„åç§°ã€‚ ApplicationContextAware å’Œ BeanNameAware BootstrapContextAware BootstrapContextå®¹å™¨åœ¨å…¶ä¸­è¿è¡Œçš„èµ„æºé€‚é…å™¨ã€‚é€šå¸¸ä»…åœ¨æ”¯æŒJCAçš„ApplicationContextå®ä¾‹ä¸­å¯ç”¨ã€‚ JCA CCI LoadTimeWeaverAware å®šä¹‰çš„ç¼–ç»‡å™¨ï¼Œç”¨äºåœ¨åŠ è½½æ—¶å¤„ç†ç±»å®šä¹‰ã€‚ åœ¨Spring Frameworkä¸­ä½¿ç”¨AspectJè¿›è¡ŒåŠ è½½æ—¶ç¼–ç»‡ MessageSourceAware è§£å†³æ¶ˆæ¯çš„å·²é…ç½®ç­–ç•¥ï¼ˆæ”¯æŒå‚æ•°åŒ–å’Œå›½é™…åŒ–ï¼‰ã€‚ çš„å…¶ä»–åŠŸèƒ½ ApplicationContext NotificationPublisherAware Spring JMXé€šçŸ¥å‘å¸ƒè€…ã€‚ é€šçŸ¥äº‹é¡¹ ResourceLoaderAware é…ç½®çš„åŠ è½½ç¨‹åºï¼Œç”¨äºå¯¹èµ„æºçš„ä½çº§åˆ«è®¿é—®ã€‚ èµ„æºèµ„æº ServletConfigAware å½“å‰ServletConfigå®¹å™¨åœ¨å…¶ä¸­è¿è¡Œã€‚ä»…åœ¨å¯æ„ŸçŸ¥ç½‘ç»œçš„Springä¸­æœ‰æ•ˆ ApplicationContextã€‚ æ˜¥å­£MVC ServletContextAware å½“å‰ServletContextå®¹å™¨åœ¨å…¶ä¸­è¿è¡Œã€‚ä»…åœ¨å¯æ„ŸçŸ¥ç½‘ç»œçš„Springä¸­æœ‰æ•ˆ ApplicationContextã€‚ æ˜¥å­£MVC BeanPostProcessorè¿™ä¸ªæ¥å£å¯ä»¥åœ¨spring beanåˆå§‹åŒ–å®Œæˆä¹‹åä¹‹å‰çš„å›è°ƒæ¥å£ PropertySourcesPlaceholderConfigurer å’Œ BeanFactoryPostProcessor æš‚æ—¶ä¸ç ”ç©¶FactoryBeanFactoryBeanç•Œé¢æä¾›äº†ä¸‰ç§æ–¹æ³•ï¼š Object getObject()ï¼šè¿”å›æ­¤å·¥å‚åˆ›å»ºçš„å¯¹è±¡çš„å®ä¾‹ã€‚å®ä¾‹å¯ä»¥å…±äº«ï¼Œå…·ä½“å–å†³äºè¯¥å·¥å‚æ˜¯å¦è¿”å›å•ä¾‹æˆ–åŸå‹ã€‚ boolean isSingleton()ï¼štrueå¦‚æœFactoryBeanè¿”å›å•ä¾‹æˆ–falseå…¶ä»–ï¼Œåˆ™è¿”å› ã€‚ Class getObjectType()ï¼šè¿”å›getObject()æ–¹æ³•è¿”å›çš„å¯¹è±¡ç±»å‹ï¼Œæˆ–è€…nullå¦‚æœç±»å‹æœªçŸ¥ï¼Œåˆ™è¿”å›è¯¥å¯¹è±¡ç±»å‹ã€‚ spring èµ„æºåŒ–å¤„ç†Resource InputStreamSource æ ¸å¿ƒå®ç°UrlResourceï¼šèƒ½è·å–ç½‘ç»œç­‰æ‰€æœ‰çš„å±æ€§ClassPathResourceï¼šèƒ½è·å–jaråŒ…ä¸­çš„æ–‡ä»¶FileSystemResourceï¼šåŸºæœ¬æ–‡ä»¶æ“ä½œServletContextResourceInputStreamResourceByteArrayResource ä½¿ç”¨applicationContext çš„ ResourceLoader è·å–Resourceæ³¨æ„æ‰€æœ‰çš„applicationContextéƒ½å®ç°äº†ResourceLoaderæ¥å£ é’ˆå¯¹ClassPathXmlApplicationContextï¼Œè¯¥ä»£ç è¿”å›ClassPathResourceã€‚å¦‚æœå¯¹FileSystemXmlApplicationContextå®ä¾‹æ‰§è¡Œç›¸åŒçš„æ–¹æ³•ï¼Œåˆ™å°†è¿”å› FileSystemResourceã€‚å¯¹äºWebApplicationContextï¼Œå®ƒå°†è¿”å› ServletContextResourceã€‚ç±»ä¼¼åœ°ï¼Œå®ƒå°†ä¸ºæ¯ä¸ªä¸Šä¸‹æ–‡è¿”å›é€‚å½“çš„å¯¹è±¡ å¦ä¸€æ–¹é¢ï¼ŒClassPathResourceæ— è®ºåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ç±»å‹å¦‚ä½•ï¼Œæ‚¨éƒ½å¯ä»¥é€šè¿‡æŒ‡å®šç‰¹æ®Šclasspath:å‰ç¼€æ¥å¼ºåˆ¶ä½¿ç”¨ è¿˜å¯ä»¥ä½¿ç”¨ResourceLoaderAware æ¥å£ç›´æ¥è·å¾—ä¸Šä¸‹æ–‡çš„ResourceLooaderç±»ä¼¼applicationAwareçš„æ¨¡å¼ spring è‡ªåŠ¨åŒ–é…ç½®@Requiredæ³¨é‡Šé€‚ç”¨äºbeanå±æ€§setteræ–¹æ³•ï¼Œ 5.1 å¼ƒç”¨ @Autoweiterä½¿ç”¨ä½ç½®è¿™ä¸ªæ³¨è§£æ˜¯spring æ¨èä½¿ç”¨çš„æ³¨è§£,æ”¯æŒä¸‰ä¸ªä½ç½®çš„æ³¨å…¥ å±æ€§ æ„é€ å‡½æ•° æ³¨æ„ : ä»Spring Framework 4.3å¼€å§‹ï¼Œ@Autowiredå¦‚æœç›®æ ‡beanåªå®šä¹‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œåˆ™ä¸å†éœ€è¦åœ¨è¯¥æ„é€ å‡½æ•°ä¸Šæ·»åŠ æ³¨é‡Šã€‚ä½†æ˜¯ï¼Œå¦‚æœæœ‰å‡ ä¸ªæ„é€ å‡½æ•°å¯ç”¨ï¼Œåˆ™å¿…é¡»è‡³å°‘æ³¨é‡Šä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œ@Autowiredä»¥æŒ‡ç¤ºå®¹å™¨ä½¿ç”¨å“ªä¸ªæ„é€ å‡½æ•°ã€‚ æ™®é€šæ–¹æ³• å¤šä¸ªç›¸åŒçš„ç±»å‹æ”¯æŒå®ç”¨AutoWrite é»˜è®¤æƒ…å†µä¸‹æ˜¯ä½¿ç”¨ç±»å‹è¿›è¡Œæ³¨å…¥çš„,å¦‚æœæœ‰å¤šä¸ªç±»å‹å°±ä¼šæŠ¥é”™,æ‰€æœ‰springæ”¯æŒæ•°ç»„æ¥æ”¶æ–¹æ³• spring è¿˜æ”¯æŒmap æ³¨å…¥çš„æ–¹æ³• é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ç»™å®šæ³¨å…¥ç‚¹æ²¡æœ‰åŒ¹é…çš„å€™é€‰beanå¯ç”¨æ—¶ï¼Œè‡ªåŠ¨è£…é…å°†å¤±è´¥ã€‚å¯¹äºå£°æ˜çš„æ•°ç»„ï¼Œé›†åˆæˆ–æ˜ å°„ï¼Œè‡³å°‘åº”æœ‰ä¸€ä¸ªåŒ¹é…å…ƒç´ ã€‚???&#x2F; @AutoWrite spring5 æ–°æ³¨è§£ä»Spring Framework 5.0å¼€å§‹ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨@Nullableæ³¨é‡Šï¼ˆä»»ä½•åŒ…ä¸­çš„ä»»ä½•æ³¨é‡Šï¼Œä¾‹å¦‚ï¼Œjavax.annotation.Nullableæ¥è‡ªJSR-305 çš„æ³¨é‡Šï¼‰ å…¶ä»–æ‚¨è¿˜å¯ä»¥ä½¿ç”¨@Autowiredå¯¹äºé‚£äº›ä¼—æ‰€å‘¨çŸ¥çš„è§£æä¾èµ–æ¥å£ï¼šBeanFactoryï¼ŒApplicationContextï¼ŒEnvironmentï¼ŒResourceLoaderï¼Œ ApplicationEventPublisherï¼Œå’ŒMessageSourceã€‚è¿™äº›æ¥å£åŠå…¶æ‰©å±•æ¥å£ï¼ˆä¾‹å¦‚ConfigurableApplicationContextæˆ–ResourcePatternResolverï¼‰å°†è‡ªåŠ¨è§£æï¼Œè€Œæ— éœ€è¿›è¡Œç‰¹æ®Šè®¾ç½®ã€‚ä»¥ä¸‹ç¤ºä¾‹è‡ªåŠ¨è£…é…ApplicationContextå¯¹è±¡ï¼š @AutoWrite å…¶ä»–å†…å®¹@AutoWriteæ³¨è§£åœ¨æ–¹æ³•ä¸Šçš„åœºæ™¯??? @Primaryç”¨äºå½“æœ‰å¤šä¸ªå€™é€‰è€…çš„æ—¶å€™è¿›è¡Œè£…é…ä¼˜å…ˆæ˜¯ä½¿ç”¨çš„æ ‡è®° @Qualifierå¯ç”¨äºè‡ªå®šä¹‰æ„é€ é™åˆ¶æ¡ä»¶çš„æ³¨è§£,ç›¸å½“äºä¸€ä¸ªè‡ªå®šä¹‰æ„é€ æ³¨å…¥çš„æ‰©å±•ç‚¹ æ¯”å¦‚é’ˆå¯¹å¦‚ä¸‹çš„å®šä¹‰ è‡ªåŠ¨è£…é…æ³›å‹æ”¯æŒspring å…¶å®è¿˜æ”¯æŒæ³›å‹çš„è‡ªåŠ¨è£…é…,ä¸åŒçš„æ³›å‹ç±»å‹åœ¨javaä¸­ç®—æ˜¯ä¸åŒçš„ç±»å‹??? Resourceå’Œ @AutoWrite ç±»å‹ç›¸åŒ , åªæ˜¯è¿™ä¸ªå¯ä»¥æºå¸¦ä¸Šnameå…³é”®å­—è¡¨ç¤ºå®ç”¨åç§°æ¥è¿›è¡Œæ³¨å…¥ spring æ³¨è§£é«˜çº§ç©æ³•å…ƒæ³¨è§£ç»„åˆåœ¨springä¸­å¯ä»¥è®²ä¸€äº›æ³¨è§£è¿›è¡Œä»»æ„çš„ç»„åˆç”Ÿæˆæ–°çš„æ³¨è§£,å¹¶åŒ…å«ç»„åˆçš„æ³¨è§£çš„åŠŸèƒ½ @AliasForæ³¨è§£è¡¨ç¤ºä½¿ç”¨ç»§æ‰¿çš„æ³¨è§£çš„å“ªä¸ªå±æ€§,å¯¹å¤–æš´æ¼,è¿™ä¸ªæ—¶å€™æš´æ¼çš„ç†Ÿæ‚‰å±æ€§å¯ä»¥åœ¨å¤–å±‚è¢«è¦†ç›–æ‰ spring è‡ªåŠ¨åŒ–æ‰«æåŠŸèƒ½æ”¯æŒ @Configuration @ComponentScan(basePackages &#x3D; â€œorg.exampleâ€)æ³¨æ„è¿™ä¸ªåŠŸèƒ½å¿…é¡»@Configurationå’ŒComponentScanè¿ç”¨æ‰å¯ä»¥ æŒ‡å®šæ‰«æèŒƒå›´ æŒ‡å®šèŒƒå›´æ‰«æè‡ªå®šä¹‰ç­–ç•¥ ??? scoped-proxy ??? æ³¨æ„: è¿™ä¸ªè¿˜æ”¯æŒè¿‡æ»¤åŠŸèƒ½ ??? å¢åŠ æ”¯æŒè¿‡æ»¤çš„è¡¨æ ¼ä¿¡æ¯ @Bean æ³¨å†Œbean å®šä¹‰çš„æ—¶å€™æä¾›é™åˆ¶ç¬¦å· spring è‡ªåŠ¨åŒ–é…ç½® ??? ç§»åŠ¨åˆ°ä¸Šé¢å’Œbeanæ•´ç†åˆ°ä¸€èµ·spring beanè‡ªåŠ¨åŒ–é…ç½®çš„æ‰¿è½½ç±» AnnotationConfigApplicationContextè¿™ä¸ªApplicationContextå…¶å®æ‰¿è½½äº†java configç±»çš„è§£æåŠŸèƒ½ @bean æè¿°ä¾èµ–å…³ç³»åœ¨ä½¿ç”¨@Beanæ¥æè¿°ä¾èµ–å…³ç³»çš„æ—¶å€™,å¯ä»¥ä½¿ç”¨å¯¹åº”æ–¹æ³•ä¸­çš„å‚æ•°æ¥è¿›è¡Œä¾èµ– @Bean ç”Ÿå‘½å‘¨æœŸä¾èµ– beanèŒƒå›´??? @Scope å’Œ scoped-proxySpringæä¾›äº†ä¸€ç§é€šè¿‡ä½œç”¨åŸŸä»£ç†å¤„ç†ä½œç”¨åŸŸä¾èµ–æ€§çš„ä¾¿æ·æ–¹æ³• ã€‚ä½¿ç”¨XMLé…ç½®æ—¶åˆ›å»ºæ­¤ç±»ä»£ç†çš„æœ€ç®€å•æ–¹æ³•æ˜¯aop:scoped-proxy/å…ƒç´ ã€‚ä½¿ç”¨@Scopeæ³¨é‡Šåœ¨Javaä¸­é…ç½®bean å¯ä»¥ä¸ºè¯¥proxyModeå±æ€§æä¾›åŒç­‰çš„æ”¯æŒã€‚é»˜è®¤å€¼ä¸ºæ— ä»£ç†ï¼ˆScopedProxyMode.NOï¼‰ï¼Œä½†æ‚¨å¯ä»¥æŒ‡å®šScopedProxyMode.TARGET_CLASSæˆ–ScopedProxyMode.INTERFACESã€‚ è‡ªå®šä¹‰Beanå‘½å bean @Descriptionæä¾›beançš„æè¿°åŠŸèƒ½ @Configurationconfiguration import åŠ è½½å…¶ä»–ç±»å®šä¹‰ çµæ´»çš„æ³¨å…¥é…ç½®@Conditional","date":"2024-12-31","categories":["java"]},{"title":"spring-boot2.0-(1)å¯åŠ¨ã€è¿è¡Œå’Œç»“æŸ","url":"/2024/12/31/spring-boot2-0--1-å¯åŠ¨-è¿è¡Œå’Œç»“æŸ/","content":"å¯¼å¼•ï¼š spring bootçš„ç®€å•é…ç½®ï¼ŒåŸºæœ¬å¯åŠ¨æ–¹æ³•ï¼Œå’Œç‰¹æ®Šå…³é—­æ¨¡å¼ springboot é…ç½®çš„æ ¸å¿ƒå…ƒç´ spring åªç”¨mavençš„parentç»§æ‰¿çš„æ–¹æ³•ï¼ˆgradleç±»ä¼¼ï¼‰è¿›è¡Œä¾èµ–ç®¡ç†å’Œä½¿ç”¨mavenæ’ä»¶ï¼ˆgradleåŒæ ·ç±»ä¼¼ï¼‰çš„æ–¹æ³•ç”Ÿæˆå¯æ‰§è¡Œçš„jaræ–‡ä»¶ å½“ä¸ä½¿ç”¨parentè¿›è¡Œä¾èµ–é…ç½®çš„æ—¶å€™å¯ä»¥ä½¿ç”¨dependencyManagementæ¥è¿›è¡Œç®¡ç† springBoot starter-springBootå¯ä»¥å®ç°è‡ªåŠ¨åŒ–é…ç½®çš„æ ¸å¿ƒæ–¹æ³•springBootæä¾›äº†ä¸€ç³»åˆ—çš„starteræ–¹ä¾¿è¿›è¡Œè‡ªåŠ¨åŒ–é…ç½®ï¼Œæ¯”å¦‚spring-boot-starter-web springBoot starter æ˜æ˜è§„åˆ™ï¼šå¦‚æœæ˜¯å®˜æ³•çš„starter å°†ä¼šæŒ‰ç…§spring-boot-starter-* æ¥è¿›è¡Œåˆ’åˆ†ï¼Œå¦‚æœæ˜¯è‡ªå·±å®ç°çš„starteræ–¹æ³•ï¼Œå»ºè®®æŒ‰ç…§*-spring-boot-starter æ¥è¿›è¡Œå‘½å è¿™é‡Œä»‹ç»ä¸€ä¸ªç‰¹è¾¹çš„éåº”ç”¨starterï¼Œspring-boot-starter-actuatorï¼Œè¿™ä¸ªstarterå®ç°äº†ç›‘æ§çš„åŠŸèƒ½ spring boot æä¾›äº†éå¸¸å¤šçš„é…ç½®é€‰é¡¹ï¼Œå…·ä½“çš„å¯ä»¥åˆ°å®˜ç½‘ä¸ŠæŸ¥è¯¢ spring boot çƒ­éƒ¨ç½²å·¥å…· Developer Toolsspring boot å®ç°äº†ä¸€å®šç¨‹åº¦ä¸‹çš„çƒ­éƒ¨ç½²åŠŸèƒ½ï¼Œæš‚æ—¶ä¸åšè¿‡å¤šçš„è®¨è®ºé…ç½® spring boot çš„å¯åŠ¨æ–¹æ³• æ³¨æ„è¿™é‡Œä¼ é€’è¿‡å»çš„å‚æ•°æ˜¯ä¸€ä¸ªé…ç½®æºï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªç±»å¿…é¡»æ˜¯@Configurationæˆ–è€…æ˜¯ä¸€ä¸ªç»§æ‰¿@Configurationæ³¨è§£æ ‡è®°çš„ç±» å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨application.propertiesæ–‡ä»¶æ¥é…ç½®SpringApplicationï¼Œä½†æ˜¯è¿™é‡Œæ¶‰åŠåˆ°springbootå¤–éƒ¨åŒ–é…ç½®ï¼Œè§ä¸‹é¢ springboot è¿˜å¯ä»¥ä½¿ç”¨æµå¼å¸ƒå±€æ„å»ºapplicationçš„ä¸Šä¸‹æ–‡å…³ç³»ï¼Œå…·ä½“çš„å®ç°å¦‚ä¸‹ æ³¨æ„ï¼šWebç»„ä»¶å¿…é¡»åŒ…å«åœ¨å­ä¸Šä¸‹æ–‡ä¸­ï¼Œå¹¶ä¸”çˆ¶ç¯å¢ƒå’Œå­ç¯å¢ƒéƒ½ä½¿ç”¨ç›¸åŒçš„ç¯å¢ƒ #spring boot å¸¦æœ‰çŠ¶æ€çš„ç»“æŸ ä½¿ç”¨exit è¿è¡Œç¨‹åº åœ¨è°ƒç”¨SpringApplication.exitï¼ˆï¼‰æ—¶å¸Œæœ›è¿”å›ç‰¹å®šçš„é€€å‡ºä»£ç ï¼Œé‚£ä¹ˆbeanå¯ä»¥å®ç°org.springframework.boot.ExitCodeGeneratoræ¥å£ã€‚ ï¼Œç„¶åå¯ä»¥å°†æ­¤é€€å‡ºä»£ç ä¼ é€’ç»™System.exitï¼ˆï¼‰ä»¥å°†å…¶ä½œä¸ºçŠ¶æ€ä»£ç è¿”å›ï¼Œ","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring-boot2.0-(2)ç›‘å¬å™¨ã€äº‹ä»¶","url":"/2024/12/31/spring-boot2-0--2-ç›‘å¬å™¨-äº‹ä»¶/","content":"å¯¼å¼•ï¼š 1. spring bootç›‘å¬äº‹ä»¶çš„ä½¿ç”¨ 2. spring boot å†…ç½®ç›‘å¬äº‹ä»¶åˆå§‹åŒ–applicationContext 3. CommandLineRunneræ¥å£å’ŒApplicationRunnerç±» spring boot ä¸­çš„ä¸Šä¸‹æ–‡ç›‘å¬å™¨å’Œäº‹ä»¶spring bootçš„äº‹ä»¶å’Œ springåŸç”Ÿçš„äº‹ä»¶æ²¡æœ‰ä»€ä¹ˆå·®åˆ«ä½†æ˜¯ï¼Œspring boot æœ‰ä¸€äº›è‡ªå·±çš„äº‹ä»¶ ApplicationStartingEventåœ¨è¿è¡Œå¼€å§‹æ—¶ä½†åœ¨ä»»ä½•å¤„ç†ä¹‹å‰å‘é€ï¼Œé™¤äº†æ³¨å†Œä¾¦å¬å™¨å’Œåˆå§‹åŒ–å™¨ä¹‹å¤–ã€‚ ApplicationEnvironmentPreparedEventå½“åœ¨ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨çš„ç¯å¢ƒæ˜¯å·²çŸ¥çš„ä½†åœ¨åˆ›å»ºä¸Šä¸‹æ–‡ä¹‹å‰å‘é€ã€‚ ApplicationPreparedEventåœ¨åˆ·æ–°å¼€å§‹ä¹‹å‰ä½†åœ¨beanå®šä¹‰åŠ è½½ä¹‹åå‘é€ã€‚ ApplicationStartedEventåœ¨åˆ·æ–°ä¸Šä¸‹æ–‡ä¹‹åä½†åœ¨è°ƒç”¨ä»»ä½•åº”ç”¨ç¨‹åºå’Œå‘½ä»¤è¡Œå‚èµ›è€…ä¹‹å‰å‘é€ã€‚ ApplicationReadyEventåœ¨ä»»ä½•åº”ç”¨ç¨‹åºå’Œå‘½ä»¤è¡Œå‚æ•°è¢«è°ƒç”¨åå‘é€ã€‚ å®ƒè¡¨ç¤ºåº”ç”¨ç¨‹åºå·²å‡†å¤‡å¥½ä¸ºè¯·æ±‚æä¾›æœåŠ¡ã€‚ ApplicationFailedEventå¦‚æœå¯åŠ¨æ—¶å‡ºç°å¼‚å¸¸ï¼Œåˆ™å‘é€ã€‚ æ³¨æ„æœ‰äº›äº‹ä»¶å¯èƒ½æ˜¯åœ¨applicatincontextä¹‹å‰å°±å‡ºå‘äº†ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨@beançš„æ–¹æ³•æ³¨å†Œåœ¨å®¹å™¨ä¸­ï¼Œåœ¨spring boot ä¸­å¯ä»¥åº”å¦‚ä¸‹çš„æ–¹æ³•æ³¨å†Œç›‘å¬å™¨,ä½¿ç”¨æ–¹æ³•ï¼šSpringApplication.addListeners(â€¦â€‹)ï¼Œ SpringApplicationBuilder.listeners(â€¦â€‹)ï¼Œé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼šMETA-INF&#x2F;spring.factories ä¸­ org.springframework.context.ApplicationListener æ³¨æ„äº†ï¼šå› ä¸ºspringæ‹¥æœ‰ä¸Šä¸‹æ–‡çš„å…³ç³»ï¼Œè€Œç›‘å¬å™¨é™¤äº†ç›‘å¬è‡ªå·±çš„æ—¶é—´è¿˜ä¼šç›‘å¬å­å…ƒç´ çš„äº‹ä»¶ï¼Œæ‰€ä»¥åœ¨å®ç°ç›‘å¬å™¨çš„æ—¶å€™å®˜æ–¹æ¨èåŒæ—¶å®ç°ApplicationContextAwareæ¥å£ï¼Œæ¥æ¯”è¾ƒäº‹ä»¶çš„contextå’Œå’Œè‡ªèº«contextçš„å…³ç³»ã€‚ æ€»ç»“æ·»åŠ äº‹ä»¶çš„ä¸‰ç§æ–¹æ³• @bean SpringApplication.addListeners(â€¦â€‹)ï¼Œ SpringApplicationBuilder.listeners(â€¦â€‹) é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼šMETA-INF&#x2F;spring.factories ä¸­ org.springframework.context.ApplicationListener spring boot åº”ç”¨ç¯å¢ƒçš„åˆ¤æ–­æ„å»ºApplicationContextæˆ‘ä»¬åœ¨æ²¡æœ‰ä½¿ç”¨spring boot å•çº¯çš„ä½¿ç”¨spring æˆ–è€…ä½¿ç”¨spring mvc çš„æ—¶å€™é€šå¸¸ä½¿ç”¨çš„applicationæ˜¯XmlServletWebServerApplicationContextï¼Œæˆ–è€…ClasspathXmlApplicationContext ï¼Œ åŒæ ·spring boot åŸºäºæ³¨è§£æ–¹æ³•ä½¿ç”¨äº†ä¸€å¥—ç‰¹æ®Šçš„context é¦–å…ˆspring boot åˆ¤æ–­è¿™ä¸ªç¯å¢ƒæ˜¯ä¸æ˜¯spring mvc ç¯å¢ƒå¦‚æœæ˜¯é©¬ä¹ˆwebappcationcontext é€‰æ‹©AnnotationConfigServletWebServerApplicationContext å¦åˆ™åˆ¤æ–­æ˜¯å¦æ˜¯webflux ç¯å¢ƒå¦‚æœæ˜¯ å°±ä½¿ç”¨AnnotationConfigReactiveWebApplicationContext æœ€åå¦‚æœéƒ½ä¸æ˜¯ï¼Œä½¿ç”¨AnnotationConfigApplicationContext è¿™æ ·æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœæ˜¯spring mvc å’Œspring webflux åŒæ—¶ä½¿ç”¨çš„æ—¶å€™å°†ä¼šé€ æˆä½¿ç”¨springmvc çš„ç¯å¢ƒï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨setWebApplicationType(WebApplicationType)æ–¹æ³•ï¼Œæˆ–è€…ä½¿ç”¨setApplicationContextClass(â€¦â€‹)æœ‰å¾…ç¡®è®¤. spring bootWå¯åŠ¨å‰æ‰§è¡Œç‰¹å®šçš„ç¨‹åºåœ¨spring bootä¸­ ï¼Œ spring boot ä¼šåœ¨å®¹å™¨å½»åº•å¯åŠ¨å‰è¿è¡Œå®ç°ç°CommandLineRunneræ¥å£çš„beanæˆ–è€…ApplicationRunneræ¥å£çš„bean æ³¨æ„è¿™ä¸¤ä¸ªæ¥å£å…¶ä¸­ç¬¬äºŒä¸ªæ¥å£ä¼ é€’å‘½ä»¤çš„é¢å¤–å‚æ•°ä½¿ç”¨çš„æ˜¯ApplicationArgumentsè¿™ä¸ªç±»ï¼ˆç¬¬ä¸€ä¸ªå’Œmainç›¸åŒï¼‰ æ³¨æ„å¦‚æœç³»ç»Ÿæƒ³ä½¿ç”¨ï¼Œè¿è¡Œçš„æ—¶å€™ä¼ å…¥çš„æ•°æ®çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ApplicationArguments è¿™ä¸ªå‚æ•°å°†ç›¸å…³çš„å€¼æ³¨å…¥è¿›æ¥æˆ–è€…ä½¿ç”¨ApplicationRunneræ¥å£æˆ–è€…CommandLineRunneråˆå§‹åŒ–","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring-boot2.0-(3)é…ç½®è¯»å–","url":"/2024/12/31/spring-boot2-0--3-é…ç½®è¯»å–/","content":"å¯¼å¼•ï¼š spring boot æ€»ä½“ä¸Šæä¾›äº†ä¸‰ç§å¤–åŒ–é…ç½® 1. ä½¿ç”¨@Valueæ³¨é‡Šå°†å±æ€§å€¼ç›´æ¥æ³¨å…¥åˆ°beanä¸­ 2. pringçš„EnvironmentæŠ½è±¡è®¿é—® 3. é€šè¿‡@ConfigurationPropertiesç»‘å®šåˆ°ç»“æ„åŒ–å¯¹è±¡ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹ spring boot å¯ä»¥æä¾›å‚æ•°æ–¹å¼å’Œè¦†ç›–åŸåˆ™spring boot å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•å€’å…¥ç›¸åº”çš„å±æ€§ä¹‹ï¼Œå¹¶ä¸”æŒ‰ç…§å¦‚ä¸‹ä»ä¸Šåˆ°ä¸‹çš„é¡ºåºè¿›è¡Œè¦†ç›– Devtools ä¸»ç›®å½•ä¸Šçš„å…¨å±€è®¾ç½®å±æ€§ï¼ˆ~&#x2F;.spring-boot-devtools.propertieså½“devtoolså¤„äºæ´»åŠ¨çŠ¶æ€æ—¶ï¼‰ã€‚ @TestPropertySource æµ‹è¯•ä¸Šçš„æ³¨é‡Šã€‚ @SpringBootTest#properties æµ‹è¯•ä¸­çš„æ³¨é‡Šå±æ€§ã€‚ å‘½ä»¤è¡Œå‚æ•°ã€‚ æ¥è‡ªSPRING_APPLICATION_JSONï¼ˆåµŒå…¥åœ¨ç¯å¢ƒå˜é‡æˆ–ç³»ç»Ÿå±æ€§ä¸­çš„å†…è”JSONï¼‰çš„å±æ€§ã€‚ ServletConfig initå‚æ•°ã€‚ ServletContext initå‚æ•°ã€‚ JNDIå±æ€§æ¥è‡ªjava:comp&#x2F;envã€‚ Javaç³»ç»Ÿå±æ€§ï¼ˆSystem.getProperties()ï¼‰ã€‚ OSç¯å¢ƒå˜é‡ã€‚ ä¸€RandomValuePropertySourceï¼Œåªæœ‰åœ¨æ‹¥æœ‰æ€§èƒ½random.*ã€‚ ç‰¹å®šäºé…ç½®æ–‡ä»¶çš„åº”ç”¨ç¨‹åºå±æ€§åœ¨æ‰“åŒ…çš„jarï¼ˆapplication-{profile}.propertieså’ŒYAMLå˜ä½“ï¼‰ä¹‹å¤–ã€‚ æ‰“åŒ…åœ¨jarä¸­çš„ç‰¹å®šäºé…ç½®æ–‡ä»¶çš„åº”ç”¨ç¨‹åºå±æ€§ï¼ˆapplication-{profile}.properties ä»¥åŠYAMLå˜ä½“ï¼‰ã€‚ åº”ç”¨ç¨‹åºå±æ€§åœ¨æ‰“åŒ…çš„jarä¹‹å¤–ï¼ˆapplication.propertieså’ŒYAMLå˜ä½“ï¼‰ã€‚ æ‰“åŒ…åœ¨jarä¸­çš„åº”ç”¨ç¨‹åºå±æ€§ï¼ˆapplication.propertieså’ŒYAMLå˜ä½“ï¼‰ã€‚ @PropertySource ä½ çš„@Configurationè¯¾ä¸Šçš„æ³¨é‡Šã€‚ é»˜è®¤å±æ€§ï¼ˆç”±è®¾ç½®æŒ‡å®šSpringApplication.setDefaultPropertiesï¼‰ã€‚ æä¾›ä¸€ä¸ªç®€å•çš„ä½¿ç”¨å†…ç½®å±æ€§çš„åˆ—å­ @Value å°†ä¼šå°†ç¯å¢ƒä¸­çš„nameå‚æ•°æ³¨å…¥åˆ°MyBeançš„nameå±æ€§ä¸­ æ³¨æ„: è¿™é‡Œè§£é‡Šä¸€ä¸‹ä¸Šé¢çš„ç¬¬äº”æ¡ï¼š SPRING_APPLICATION_JSON è¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡å±æ€§ï¼Œå¯ä»¥åœ¨ç¯å¢ƒä¸­è¿›è¡Œç›¸å…³çš„é…ç½®ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨å‘½ä»¤è¡Œ$ SPRING_APPLICATION_JSON&#x3D;â€™{â€œacmeâ€:{â€œnameâ€:â€testâ€}}â€™ java -jar myapp.jarã€‚ æ³¨æ„ï¼š jsonçš„æ–¹å¼è§£æåœ¨spring boot ä¸­æ‹¥æœ‰ä¸¤ä¸ªåœ°æ–¹ï¼Œç¬¬ä¸€ä¸ªä¸Šé¢çš„ç¬¬9æ¡ï¼šjava -Dspring.application.json&#x3D;â€™{â€œnameâ€:â€testâ€}â€™ -jar myapp.jar ã€‚ç¬¬äºŒä¸ªä¸Šé¢çš„ç¬¬4æ¡ï¼Œ$ java -jar myapp.jar â€“spring.application.json&#x3D;â€™{â€œnameâ€:â€testâ€}â€™ æ³¨æ„ï¼š è§£é‡Šä¸Šé¢çš„11 æ¡éšæœºå‚æ•° è¿™ä¸ªæ–¹æ³•å¯ä»¥ç”Ÿæˆéšæœºå‚æ•°å¯ä»¥ç”Ÿæˆæ•´æ•°ï¼Œé•¿æ•´æ•°ï¼Œuuidsæˆ–å­—ç¬¦ä¸²ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š æ³¨æ„æœ€åä¸¤ä¸ªä½¿ç”¨äº†è¡¨è¾¾å¼çš„æ–¹æ³•ï¼Œint[start,end] è¡¨ç¤ºä»startåˆ°endåŒºé—´éšæœºå–æ•° int(max) è¿™ç§æ–¹å¼è¡¨ç¤ºå–çš„å€¼ä¸å¤§äºmax","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring-boot2.0-(4)è‡ªå®šä¹‰é…ç½®(starter)","url":"/2024/12/31/spring-boot2-0--4-è‡ªå®šä¹‰é…ç½®-starter-/","content":"spring boot æä¾›äº†éå¸¸æ–¹ä¾¿çš„æ–¹æ³•å¯ä»¥è‡ªåŠ¨é…ç½®javabean spring bootè‡ªåŠ¨çš„é…ç½®çš„æ ¸å¿ƒä¸€ä¸ªåŸºæœ¬æ³¨è§£@Configurationå’Œæ¡ä»¶æ³¨è§£@Conditionalspringçš„è‡ªåŠ¨é…ç½®æ˜¯ä½¿ç”¨ä¸Šé¢çš„ä¸¤ä¸ªbeanæä¾›åŠŸèƒ½çš„ @Configuration æ ‡è®°è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªconfigé…ç½®ç±» @Conditional è¿™ä¸ªæ˜¯æ§åˆ¶è‡ªåŠ¨é…ç½®æ¡ä»¶çš„ç±» spring boot spispring bootè‡ªå·±å®ç°äº†ä¸€å¥—spiæœºåˆ¶, spring boot è¦æ±‚åœ¨META-INFä¸­ç”Ÿæˆä¸€ä¸ªé…ç½®æ–‡ä»¶","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-(2)-coreæ ¸å¿ƒæ³¨è§£ä½¿ç”¨","url":"/2024/12/31/spring5--2--coreæ ¸å¿ƒæ³¨è§£ä½¿ç”¨/","content":"spring æ³¨è§£é…ç½®æ–¹æ³• æ‰€è°“é›¶é…ç½®ï¼Œå¹¶ä¸æ˜¯è¯´ä¸€ç‚¹é…ç½®éƒ½æ²¡æœ‰äº†ï¼Œè€Œæ˜¯é…ç½®å¾ˆå°‘è€Œå·²ã€‚é€šè¿‡çº¦å®šæ¥å‡å°‘éœ€è¦é…ç½®çš„æ•°é‡ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚æ›´å‰å®³çš„æ˜¯spring boot xmlé…ç½®æ–‡ä»¶ è¯¥éšå¼æ³¨å†Œçš„åå¤„ç†å™¨åŒ…æ‹¬ AutowiredAnnotationBeanPostProcessorï¼Œ CommonAnnotationBeanPostProcessorï¼Œ PersistenceAnnotationBeanPostProcessorï¼Œä»¥åŠå‰è¿° RequiredAnnotationBeanPostProcessor spring ç±»ä¸Šçš„æ³¨è§£è¿™å‡ ä¸ªæ³¨è§£åœ¨ä½¿ç”¨ä¸Šå…¶å®æ˜¯ä¸€æ ·åªæ˜¯ä½¿ç”¨ä¸åŒçš„åç§°æ¥ä½“ç°å¯è¯»æ€§ ç±»å±æ€§çš„æ³¨è§£ @Scopeæ³¨è§£ å¼•ç”³: è¿™ä¸ªæ³¨è§£å­˜åœ¨ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§proxyMode è¿™ä¸ªå±æ€§ç›¸å½“äº aop:scoped-proxy/ è¿™ä¸ªå±æ€§ ä¸è¿‡ä½¿ç”¨çš„æ›´åŠ æ–¹ä¾¿, å…¶ä¸­çš„ScopedProxyMode æä¾›äº†ä¸‰ç§å±æ€§ DEFAULT é»˜è®¤å€¼(ä½¿ç”¨cglibä»£ç†,è¯¦å•äºCLASS_TYPEå±æ€§),NOä¸è¿›è¡Œä»£ç†(ä½œç”¨äºæ§åˆ¶å–å†³äºçˆ¶è¾ˆ),INTERFACE(ä½¿ç”¨jdkä»£ç†),CLASS_TYPE(ä½¿ç”¨cglibä»£ç†) ç±»ä¸­å…ƒç´ ä¸Šçš„æ³¨è§£ @Autowired ä½¿ç”¨æ–¹æ³•å¼•ç”³ ï¼šè¿™ä¸ªæ³¨è§£å¯ä»¥ä½¿ç”¨åœ¨å˜é‡ set æˆ–è€…æ™®é€šæ–¹æ³•ä¸Šï¼Œä»–ä¼šè‡ªåŠ¨çš„å°†ç›¸å…³çš„å±æ€§æ³¨å…¥è¿›å»ï¼Œå¦‚æœæœ‰å¤šä¸ªåŒ¹é…ï¼Œå¯ä»¥ä½¿ç”¨listï¼Œæ•°ç»„ï¼Œsetï¼Œmapè¿›è¡Œæ¥æ”¶ï¼Œå¦åˆ™å°†ä¼šæŠ¥é”™ï¼Œå¦‚æœæƒ³è¦è¯¸å¦‚çš„beanæŒ‰ç…§é¡ºåºï¼Œå¯ä»¥ä½¿ç”¨@orderæˆ–è€…@Priorityåœ¨beanä¸ŠæŒ‡å®šé¡ºåº ç±»ä¸­æ–¹æ³•ä¸Šçš„æ³¨è§£ @Resource, @Autowired å’Œ @Qualifierè‡ªåŠ¨æ³¨å…¥ä½¿ç”¨ @Resourceï¼š é»˜è®¤ä½¿ç”¨nameå±æ€§è¿›è¡Œè‡ªåŠ¨è£…é…ï¼Œ@Resource æ²¡æœ‰æŒ‡å®š name å±æ€§ï¼Œé‚£ä¹ˆä½¿ç”¨ byName åŒ¹é…å¤±è´¥åï¼Œä¼šé€€è€Œä½¿ç”¨ byType ç»§ç»­åŒ¹é…ï¼Œå¦‚æœå†å¤±è´¥ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œå°†å…¶æ ‡æ³¨åœ¨ BeanFactory ç±»å‹ã€ApplicationContext ç±»å‹ã€ResourceLoader ç±»å‹ã€ApplicationEventPublisher ç±»å‹ã€MessageSource ç±»å‹ä¸Šï¼Œé‚£ä¹ˆ Spring ä¼šè‡ªåŠ¨æ³¨å…¥è¿™äº›å®ç°ç±»çš„å®ä¾‹ï¼Œä¸éœ€è¦é¢å¤–çš„æ“ä½œã€‚ @Autowired å’Œ @Qualifier æ³¨è§£æ‰§è¡Œè‡ªåŠ¨è£…é…ï¼š åªèƒ½æ˜¯æ ¹æ®ç±»å‹è¿›è¡ŒåŒ¹é… å¯ä»¥ç”¨äº Setter æ–¹æ³•ã€æ„é€ å‡½æ•°ã€å­—æ®µï¼Œç”šè‡³æ™®é€šæ–¹æ³•ï¼Œå‰ææ˜¯æ–¹æ³•å¿…é¡»æœ‰è‡³å°‘ä¸€ä¸ªå‚æ•° å¯ä»¥ç”¨äºæ•°ç»„å’Œä½¿ç”¨æ³›å‹çš„é›†åˆç±»å‹ã€‚ç„¶å Spring ä¼šå°†å®¹å™¨ä¸­æ‰€æœ‰ç±»å‹ç¬¦åˆçš„ Bean æ³¨å…¥è¿›æ¥ã€‚ æ ‡æ³¨ä½œç”¨äº Map ç±»å‹ï¼Œå°†å®¹å™¨ä¸­æ‰€æœ‰ç±»å‹ç¬¦åˆ Map çš„ value å¯¹åº”çš„ç±»å‹çš„ Bean å¢åŠ è¿›æ¥ï¼Œç”¨ Bean çš„ id æˆ– name ä½œä¸º Map çš„ key 5.@Autowired åé¢å¢åŠ ä¸€ä¸ª @Qualifier æ ‡æ³¨ï¼Œæä¾›ä¸€ä¸ª String ç±»å‹çš„å€¼ä½œä¸ºå€™é€‰çš„ Bean çš„åå­— 5.0 æ–°æ³¨è§£ ä½¿ç”¨@Nullable å¯ä»¥å¿½ç•¥@Autowired åº”åœ¨å‡½æ•°ä¸Šé¢çš„æ—¶å€™çš„å‚æ•° @Autowiredå¯¹äºé‚£äº›ä¼—æ‰€å‘¨çŸ¥çš„è§£æä¾èµ–æ¥å£ï¼šBeanFactoryï¼ŒApplicationContextï¼ŒEnvironmentï¼ŒResourceLoaderï¼Œ ApplicationEventPublisherï¼Œå’ŒMessageSourceã€‚è¿™äº›æ¥å£åŠå…¶æ‰©å±•æ¥å£ï¼ˆå¦‚ConfigurableApplicationContextæˆ–ResourcePatternResolverï¼‰ä¼šè‡ªåŠ¨è§£æï¼Œæ— éœ€ç‰¹æ®Šè®¾ç½®ã€‚ @Autowiredï¼Œ@Injectï¼Œ@Resourceï¼Œå’Œ@Valueæ³¨é‡Šç”±Springå¤„ç† BeanPostProcessorå®ç°ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸å¯ä»¥ä½¿ç”¨ä»¥ä¸Šçš„æ³¨è§£å»è‡ªåŠ¨è£…é…BeanPostProcessoræˆ–BeanFactoryPostProcessorç±»å‹ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚è¿™äº›ç±»å‹å¿…é¡»é€šè¿‡XMLæˆ–ä½¿ç”¨Spring @Beanæ–¹æ³•æ˜ç¡®åœ°æ‰‹åŠ¨åœ°è¿›è¡Œé…ç½® ã€‚ 5,0æ–°æ³¨è§£ ä½¿ç”¨@Primaryå¾®è°ƒåŸºäºæ³¨é‡Šçš„è‡ªåŠ¨è£…é… è¿™é‡ŒæŒ‡å®šäº†ç›¸å…³çš„javaé…ç½®ç±»è¿”å›çš„å‚æ•° åœ¨xmlæ–‡ä»¶ä¸­è¿›è¡Œå¦‚ä¸‹é…ç½® @Qualifieræ³¨è§£ ä¸ºspring å®¹å™¨è‡ªåŠ¨è£…é…æä¾›æ›´å¤šé€‰é¡¹è¿™ä¸ªæ³¨è§£å¯ä»¥è¿›è¡Œæ´¾ç”Ÿ å¯ä»¥è®©autowirteå’Œè‡ªå®šä¹‰çš„genreåŠ¨æ€çš„è¿›è¡Œè¿ç”¨ï¼Œä»è€Œæé«˜è‡ªåŠ¨è£…é…çš„çµæ´»æ€§ æˆ–è€…ä½¿ç”¨xmlè¿›è¡Œé…ç½®ï¼Œqualitier è¿™ä¸ªæ ‡ç­¾çš„attributeä¸­ä½¿ç”¨kyeï¼Œvalueå”¯ä¸€å®šä½ä¸€ä¸ªå±æ€§å¦‚æœï¼Œè‡ªå®šä¹‰æ³¨è§£çš„æ—¶å€™æ²¡æœ‰ç›¸å…³çš„å†…éƒ¨å±æ€§ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨typeæ¥å”¯ä¸€çš„é™å®šä¸€ä¸ªæ ‡è®° @Autowriteæ³¨è§£å…³è”èŒƒå‹ï¼ˆæ¨¡ç³Šç±»å‹å¢å¼ºï¼‰ä¸¾ä¾‹javabean æ–°service æ—§service èŒƒå‹æ³¨å…¥æ”¹è¿› æ”¹è¿›ï¼šä¸éœ€è¦åœ¨setæ–¹æ³•ä¸Šåœ¨è¿›è¡Œä¸€æ¬¡å°è£…ï¼Œç›´æ¥ä½¿ç”¨@Autowriteè¿›è¡Œæ³¨å…¥å°±å¥½äº† æä¾›mapå’Œlistæ³¨å…¥ mapä¼šè¿™æ ·æ³¨å…¥ï¼škeyæ˜¯beanåå­—ï¼›valueå°±æ˜¯æ‰€æœ‰å®ç°äº†BaseServiceçš„Bean listä¼šè¿™æ ·æ³¨å…¥ï¼šè¿™æ ·ä¼šæ³¨å…¥æ‰€æœ‰å®ç°äº†BaseServiceçš„Beanï¼›ä½†æ˜¯é¡ºåºæ˜¯ä¸ç¡®å®šçš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æŒ‰ç…§æŸä¸ªé¡ºåºè·å–ï¼›åœ¨Spring4ä¸­å¯ä»¥ä½¿ç”¨@Orderæˆ–å®ç°Orderedæ¥å£æ¥å®ç°ï¼ˆæŒ‡å®šåŠ è½½çš„é¡ºåºï¼‰ spring5.0 çš„å¢å¼ºæ³¨è§£ @AliasFor è¿™ä¸ªæ³¨è§£å®ç°äº†æ³¨è§£ç»§æ‰¿ä¸­çš„å±æ€§ç»§æ‰¿,ä»æ­¤ springç»„åˆæ³¨è§£ä¸åœ¨åƒä¹‹å‰éœ€è¦åœ¨ç»§æ‰¿çš„æ³¨è§£çš„ä¸­å†™å…¥å€¼,è€Œæ˜¯å¯ä»¥åœ¨æ³¨è§£ä¸­è¿›è¡Œè‡ªå®šä¹‰çš„æ“ä½œ è¿™ä¸ªæ³¨è§£è¿˜æœ‰ä¸€äº›å±æ€§ æ¯”å¦‚ annotation å“ªä¸€ä¸ªæ¥å£(æ³¨æ„è¿™ä¸ªæ¥å£å¿…é¡»æ˜¯ç»§æ‰¿çš„å¦åˆ™ä¼šå‡ºé”™) valueå’Œattribute(è¿™ä¸¤ä¸ªå±æ€§è¡¨ç¤ºæŒ‡å®šç»§æ‰¿æ³¨è§£ä¸­å“ªä¸€ä¸ªå±æ€§,å¦‚æœæ²¡æœ‰é‚£å°±å’ŒæŒ‡å®šçš„æ–¹æ³•åç§°åŒå) ç”Ÿå‘½å‘¨æœŸæ§åˆ¶ é…ç½®ç±»æ³¨è§£@Configuration AnnotationConfigApplicationContext å’Œä½¿ç”¨xmlè¿›è¡Œé…ç½®çš„æ–¹æ³•ä¸åŒ,ä½¿ç”¨configurationåŸºäºjavaé…ç½®çš„æ—¶å€™éœ€è¦ä½¿ç”¨è¿™ä¸ªcontext,è¿™ä¸ªcontextå¯ä»¥åœ¨newä¼ å…¥å‡ ä¸ªjavabean,æ¯ä¸€ä¸ªjavabeanå°†ä¼šæŒ‰ç…§é¡ºåºçš„è¿›è¡Œé…ç½®,æˆ–è€…ä¸ä¼ å…¥ä½¿ç”¨æ‰‹åŠ¨æ³¨å†Œ ä½¿ç”¨é…ç½®æ–‡ä»¶çš„æ–¹æ³•åªæ˜¯ä¸€ç§ç®€å•çš„æ–¹æ³•,è¿™ç§æ–¹æ³•æ— æ³•ä½¿ç”¨xmlä¸­çš„æ¨¡ç‰ˆä¾èµ–è¿™ç§ç‰¹æ€§,springä¸çŸ¥ç”¨cglibè¿™ç§ä»£ç†,è€Œæ˜¯ç”¨ä¸€ç§ç±»ä¼¼å·¥å‚æ–¹æ³•çš„æ–¹å¼å°†éœ€è¦çš„beanæ³¨å…¥åˆ°å®¹å™¨ä¸­. ç›¸å…³çš„æ³¨è§£ @ComponentScan ç±»æ‰©å±•@ComponentScan è¿™ä¸ªç›´æ¥å’Œé…ç½®æ–‡ä»¶ä¸­çš„è‡ªåŠ¨æ‰«æé…ç½®ç›¸åŒ æ”¯æŒçš„æ–¹æ³•æœ‰ï¼š ç±»å‹ ç¤ºä¾‹è¡¨è¾¾ æè¿° annotation(åŒ…åç§°) org.example.SomeAnnotation è¦åœ¨ç›®æ ‡ç»„ä»¶ä¸­çš„ç±»å‹çº§åˆ«å‡ºç°çš„æ³¨é‡Šã€‚ assignable(æŒ‡å®šç±»)org.example.SomeClass ç›®æ ‡ç»„ä»¶å¯åˆ†é…ç»™ï¼ˆæ‰©å±•&#x2F;å®ç°ï¼‰çš„ç±»ï¼ˆæˆ–æ¥å£ï¼‰ã€‚ aspectJ(aop è·¯å¾„é…ç½®) org.example..*Service+ è¦ç”±ç›®æ ‡ç»„ä»¶åŒ¹é…çš„AspectJç±»å‹è¡¨è¾¾å¼ã€‚ regex(æ­£åˆ™è¡¨è¾¾å¼) org.example.Default.* è¦ç”±ç›®æ ‡ç»„ä»¶ç±»ååŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚ custom org.example.MyTypeFilter org.springframework.core.type .TypeFilteræ¥å£çš„è‡ªå®šä¹‰å®ç°ã€‚ ä¾‹å­ æ³¨æ„ä¸Šé¢è¿™é‡Œæœ‰ä¸€ä¸ªå†…éƒ¨æ¥å£æ³¨è§£ @Filter è¿™ä¸ªæ–¹æ³•å¯ä»¥æŒ‡å®šè¿‡æ»¤çš„çº§åˆ« è‡ªå®šçš„æ‰©å±•: å¦‚æœä½ ä¸æƒ³ä¾èµ–é»˜è®¤çš„beanå‘½åç­–ç•¥ï¼Œä½ å¯ä»¥æä¾›ä¸€ä¸ªè‡ªå®šä¹‰çš„beanå‘½åç­–ç•¥ã€‚é¦–å…ˆï¼Œå®ç° BeanNameGenerator æ¥å£ï¼Œå¹¶ç¡®ä¿åŒ…å«ä¸€ä¸ªé»˜è®¤çš„æ— å‚æ•°æ„é€ å‡½æ•°ã€‚ è¦ä¸ºèŒƒå›´è§£ææä¾›è‡ªå®šä¹‰ç­–ç•¥ï¼Œè€Œä¸æ˜¯ä¾èµ–åŸºäºæ³¨é‡Šçš„æ–¹æ³•ï¼Œè¯·å®ç° ScopeMetadataResolver æ¥å£ï¼Œå¹¶ç¡®ä¿åŒ…å«é»˜è®¤çš„æ— å‚æ•°æ„é€ å‡½æ•° scopedProxy :å½“ä½¿ç”¨éå•åˆ©ä½œç”¨åŸŸçš„æ—¶å€™,å¯ä»¥æŒ‡å®šä»£ç†çš„æ–¹æ³• no ,interface ,targer_class xmlé…ç½®æ–¹æ³• @Bean ä½¿ç”¨æ‰©å±• è¿™ä¸ªæ³¨è§£ç›¸å½“äº xmlä¸­çš„æ ‡ç­¾ åœ¨ç±»ä¸­ä½¿ç”¨çš„æ–¹æ³• çœ‹ä¸Šé¢çš„ä¾‹å­, æ³¨æ„ @Bean ä½¿ç”¨æŒ‡å®šçš„æ–¹æ³•,å¯ä»¥å­˜åœ¨å‚æ•°,springå°†ä¼šè‡ªåŠ¨çš„æ³¨å…¥éœ€è¦çš„å±æ€§,åŒæ ·å¯ä»¥ä½¿ç”¨@Autowrite @Bean æ³¨è§£å¯ä»¥æŒ‡å®šå‡½æ•°çš„æ„é€ æ–¹æ³•æˆ–è€…ææ„æ–¹æ³• å¯ä»¥æŒ‡å®šè¿™ä¸ªå¹¶çš„ä½œç”¨åŸŸ@Scope @Bean ä¸­å¯ä»¥æŒ‡å®šä¸€ç»„çš„åç§°æŒ‡å®šåˆ«å config ç±»ä¸­å®ç°javaBeançš„ä¾èµ–å¯ä»¥ç›´æ¥çš„è°ƒç”¨ç›¸å…³çš„å‚æ•°,å¯ä»¥ä½¿ç”¨@Qualitfierä½¿ç”¨idæŒ‡å®šéœ€è¦æ³¨å…¥çš„å…ƒç´ ï¼Œå¦åˆ™å°†ä½¿ç”¨typeè¿›è¡Œä¾èµ–çš„æ³¨å…¥ è¯·æ³¨æ„ï¼Œå•ä¸ªç±»å¯ä»¥@Beanä¸ºåŒä¸€ä¸ªbean ä¿å­˜å¤šä¸ªæ–¹æ³•ï¼Œä½œä¸ºæ ¹æ®è¿è¡Œæ—¶å¯ç”¨ä¾èµ–é¡¹ä½¿ç”¨å¤šä¸ªå·¥å‚æ–¹æ³•çš„å®‰æ’ã€‚è¿™ä¸åœ¨å…¶ä»–é…ç½®æ–¹æ¡ˆä¸­é€‰æ‹©â€œæœ€è´ªå©ªâ€æ„é€ å‡½æ•°æˆ–å·¥å‚æ–¹æ³•çš„ç®—æ³•ç›¸åŒï¼šå°†åœ¨æ„é€ æ—¶é€‰æ‹©å…·æœ‰æœ€å¤šå¯æ»¡è¶³ä¾èµ–é¡¹çš„å˜ä½“ï¼Œç±»ä¼¼äºå®¹å™¨åœ¨å¤šä¸ª@Autowiredæ„é€ å‡½æ•°ä¹‹é—´è¿›è¡Œé€‰æ‹©çš„æ–¹å¼ã€‚ ç‰¹æ®Šæ€§ configuration ç±» åœ¨springå†…éƒ¨ä½¿ç”¨çš„cglibæ–¹æ³•è¿›è¡Œæ„å»ºçš„,å¯¼è‡´ä¸‹é¢çš„ClientDao å°†ä¸ä¼šå‡ºç°æ•°æ®å¯¹è±¡çš„æƒ…å†µ æ³¨æ„ @configuration æ³¨è§£æ¯”è¾ƒç‰¹æ®Š ç³»ç»Ÿä½¿ç”¨cglibè¿›è¡Œåˆå§‹åŒ–è€Œcomponentç³»åˆ—çš„ä½¿ç”¨çš„å’Œxmlç›¸åŒçš„æ–¹æ³• @value æ ‡ç­¾ä½¿ç”¨spEL è¡¨è¾¾å¼è¿›è¡Œé…ç½® ä½¿ç”¨@Conditionalæ³¨è§£å®ç°æ›´åŠ é¢—ç²’åŒ–çš„æ§åˆ¶(åœ¨springboot è‡ªå®šä¹‰starterä¸­è¿˜ä¼šæœ‰è¯´)ä¹‹å‰çœ‹è¿‡äº†ä¸€ä¸ªæ³¨è§£@Profile è¿™ä¸ªæ³¨è§£çœ‹ä¸€ä¸‹æºä»£ç  è¿™ä¸ªæ³¨è§£å…¶å®æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£,æœ‰ä¸€ä¸ªé‡ç‚¹çš„æ³¨è§£å°±æ˜¯ä¸Šé¢çš„@Conditionalå’Œä¼ å…¥çš„é‡Œé¢çš„ProfileCondition.classè¿™ä¸ªç±»,æ¥ä¸‹æ¥çœ‹çœ‹è¿™ä¸ªç±» è¿™ä¸ªç±»å®ç°äº†ä¸€ä¸ªCondition æ¥å£,è¿™ä¸ªæ¥å£æœ‰ä¸€ä¸ªæ–¹æ³•matches() é€šè¿‡è¿”å›falseæˆ–è€…trueæ¥å‘Šè¯‰springå®¹å™¨è¦ä¸è¦æ³¨å…¥çš„è¿™ä¸ªbean,context å°±æ˜¯springçš„ä¸Šä¸‹æ–‡ä¿¡æ¯,æˆ‘å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•è¿›è¡Œç›¸å…³å®¹å™¨çš„é…ç½®.metadataå®ç°äº†æ³¨è§£çš„ç›¸å…³çš„æ•°æ®. @Profile å®ç°ç¯å¢ƒæ§åˆ¶ä¸Šé¢æˆ‘ä»¬å·²ç»çŸ¥é“äº† è¿™ä¸ªæ³¨è§£å…¶å®æ˜¯ä¸€ä¸ªConditionæ³¨è§£çš„ä¸€ä¸ªå­æ³¨è§£,ä»–å¯ä»¥é€šè¿‡ ç¯å¢ƒæ¥åˆ¤æ–­é‚£äº›å±æ€§éœ€è¦è¢«æ³¨å…¥çš„ç›¸å…³çš„å±æ€§ä¸­ æ³¨æ„è¿™ä¸ªæ–¹æ³•context.getEnvironment() è¿™ä¸ªæ–¹æ³•å°†ä¼šå°†ä¼šè·å–ç³»ç»Ÿä¸­ç›¸å…³çš„ç¯å¢ƒä¿¡æ¯è·å–å‡ºæ¥ æ·»åŠ ç¯å¢ƒå˜é‡å±æ€§ ç¬¬ä¸€ç§æ–¹æ³•, ä½¿ç”¨context æ·»åŠ ç›¸å…³çš„å±æ€§ spring.profiles.active ä½¿ç”¨é…ç½®æ–‡ä»¶é…ç½®å±æ€§ ä½¿ç”¨java çš„å¯åŠ¨å‚æ•° -Dspring.profiles.active&#x3D;â€profile1,profile2â€ å»ºè®®ä½¿ç”¨æ³¨è§£çš„æ–¹æ³• ,@PropertySource(â€œclasspath:&#x2F;com&#x2F;myco&#x2F;app.propertiesâ€)ctx.getEnvironment().setActiveProfiles(â€œprofile1â€, â€œprofile2â€); ä½¿ç”¨value å®ç°ç‰¹æ®Šçš„è¡¨è¾¾å¼æ³¨å…¥xmlæ–‡ä»¶ é…ç½®æ–‡ä»¶ ä¸€ä¸ªä¾‹å­ æ³¨æ„:BeanPostProcessorå’ŒBeanFactoryPostProcessor åº”è¯¥å£°æ˜ä¸ºstatic @Beanæ–¹æ³• , é˜²æ­¢processorç”Ÿæ•ˆä¹‹å‰æœ‰æ•°æ®è¢«åˆå§‹åŒ– spring lookup æ–¹æ³•æ³¨å…¥æ³¨è§£@Lookupå…·ä½“çš„åŠŸèƒ½å’Œxmlç›¸åŒï¼ŒLookUpæä¾›äº†ä¸¤ç§å‚æ•°å½“æœ‰å‚æ•°çš„æ—¶å€™å°†ä¼šè‡ªåŠ¨å¯»æ‰¾å®¹å™¨ä¸­beanidå¯¹åº”å‚æ•°çš„beanï¼Œå¦åˆ™å°†ä¼šåŸºäºè¿”å›ç±»å‹è¿›è¡Œæ·»åŠ ","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-(3)-ç”Ÿå‘½å‘¨æœŸ,å®¹å™¨æ‰©å±•,lookupæ¨¡å¼,äº‹ä»¶","url":"/2024/12/31/spring5--3--ç”Ÿå‘½å‘¨æœŸ-å®¹å™¨æ‰©å±•-lookupæ¨¡å¼-äº‹ä»¶/","content":"spring javabeançš„ç”Ÿå‘½å‘¨æœŸ\\å®¹å™¨æ‰©å±•\\lookupæ–¹æ³•\\springäº‹ä»¶javabean ç”Ÿå‘½å‘¨æœŸæ§åˆ¶ ä½¿ç”¨é…ç½®æ–‡ä»¶çš„æ–¹æ³• æ³¨æ„ æ ‡ç­¾ä¸­å¯ä»¥é…ç½®å…¨å±€ä½¿ç”¨çš„åˆå§‹åŒ–æ–¹æ³•å’Œé”€æ¯æ–¹æ³• ä½¿ç”¨æ³¨è§£å’Œæ¥å£ç›¸å…³çš„é…ç½®æ–¹æ³• æ³¨æ„ï¼šæ¥å£çš„æ‰§è¡Œä¼˜å…ˆçº§æ— è®ºæ˜¯åˆå§‹åŒ–æˆ–è€…é”€æ¯éƒ½æ¯”é…ç½®æ–‡ä»¶æ”¾æœ‰é™æ‰§è¡Œ, SmartInitializingSingleton æ‰€æœ‰élazyå•ä¾‹Beanå®ä¾‹åŒ–å®Œæˆåçš„å›è°ƒæ–¹æ³• spring ä¸­beançš„ç”Ÿå‘½å‘¨æœŸçš„é…ç½®é™¤äº†ä½¿ç”¨ xml æŒ‡å®š çš„æ–¹æ³•ä¹‹å¤–è¿˜èƒ½ä½¿ç”¨æ³¨è§£çš„æ–¹æ³•è¿›è¡Œç›¸å…³çš„é…ç½® åŒæ—¶springè¿˜æä¾›äº†è®©beanå’Œå®¹å™¨è¿›è¡Œç›¸å…³å…³è”bean æ–¹æ³• æ‰€æœ‰çš„beanéƒ½å¯ä»¥å®ç°è¿™äº›æ¥å£ï¼Œç„¶ååœ¨å®¹å™¨è¿›è¡Œå¢åŠ æˆ–è€…åˆ é™¤çš„æ—¶å€™å°†ä¼šè‡ªåŠ¨çš„æ‰§è¡Œç›¸å…³çš„æ–¹æ³•ï¼Œæ³¨æ„SmartLifecycle æ¥å£ä¸­çš„stopæ–¹æ³•å°†ä¼šä¼ å…¥ä¸€ä¸ªå®ç°runnabeæ¥å£çš„ç±»ï¼Œå®¹å™¨åœ¨è¿›è¡Œé”€æ¯ä¹‹åå°†ä¼šè‡ªåŠ¨çš„å¼‚æ­¥æ‰§è¡Œè¿™ä¸ªç±»ä¸­çš„ç›¸å…³çš„runæ–¹æ³•ï¼ŒPhasedçš„getphaseå°†ä¼šè®¾ç½®ä¸€ä¸ªç­‰çº§ï¼Œç”¨æ¥è¡¨ç¤ºä¼˜å…ˆçº§ å¼•ç”³ ï¼šspringå®¹å™¨å¯ä»¥ä½¿ç”¨ctx.registerShutdownHook(); æ–¹æ³•å®ç°ä¼˜é›…åœæœºæ“ä½œ spring åç½®å¤„ç†å™¨ (å®¹å™¨æ‰©å±•æ–¹æ³•) BeanPostProcessorsæ¥å£ å¦‚æœè¿™ä¸ªæ¥å£çš„æŸä¸ªå®ç°ç±»è¢«æ³¨å†Œåˆ°æŸä¸ªå®¹å™¨ï¼Œé‚£ä¹ˆè¯¥å®¹å™¨çš„æ¯ä¸ªå—ç®¡Beanåœ¨è°ƒç”¨åˆå§‹åŒ–æ–¹æ³•ä¹‹å‰ï¼Œéƒ½ä¼šè·å¾—è¯¥æ¥å£å®ç°ç±»çš„ä¸€ä¸ªå›è°ƒã€‚å®¹å™¨è°ƒç”¨æ¥å£å®šä¹‰çš„æ–¹æ³•æ—¶ä¼šå°†è¯¥å—ç®¡Beançš„å®ä¾‹å’Œåå­—é€šè¿‡å‚æ•°ä¼ å…¥æ–¹æ³•ï¼Œè¿›è¿‡å¤„ç†åé€šè¿‡æ–¹æ³•çš„è¿”å›å€¼è¿”å›ç»™å®¹å™¨ã€‚ è¦ä½¿ç”¨BeanPostProcessorå›è°ƒï¼Œå°±å¿…é¡»å…ˆåœ¨å®¹å™¨ä¸­æ³¨å†Œå®ç°è¯¥æ¥å£çš„ç±»ï¼ŒBeanFactoryå’ŒApplicationContextå®¹å™¨çš„æ³¨å†Œæ–¹å¼ä¸å¤§ä¸€æ ·ï¼š è‹¥ä½¿ç”¨BeanFactoryï¼Œåˆ™å¿…é¡»è¦æ˜¾ç¤ºçš„è°ƒç”¨å…¶addBeanPostProcessor()æ–¹æ³•è¿›è¡Œæ³¨å†Œï¼Œå‚æ•°ä¸ºBeanPostProcessorå®ç°ç±»çš„å®ä¾‹. å¦‚æœæ˜¯ä½¿ç”¨ApplicationContextï¼Œé‚£ä¹ˆå®¹å™¨ä¼šåœ¨é…ç½®æ–‡ä»¶åœ¨ä¸­è‡ªåŠ¨å¯»æ‰¾å®ç°äº†BeanPostProcessoræ¥å£çš„Beanï¼Œç„¶åè‡ªåŠ¨æ³¨å†Œï¼Œæˆ‘ä»¬è¦åšçš„åªæ˜¯é…ç½®ä¸€ä¸ªBeanPostProcessorå®ç°ç±»çš„Beanå°±å¯ä»¥äº†ã€‚ å‡å¦‚æˆ‘ä»¬ä½¿ç”¨äº†å¤šä¸ªçš„BeanPostProcessorçš„å®ç°ç±»ï¼Œåªè¦å®ç°Orderedæ¥å£ï¼Œè®¾ç½®orderå±æ€§å°±å¯ä»¥ç¡®å®šä¸åŒå®ç°ç±»çš„å¤„ç†é¡ºåºäº†ã€‚ æ³¨æ„å…¶ä¸­çš„afterå’Œbeforeçš„æ–¹æ³•,è¿™ä¸¤ä¸ªæ–¹æ³•å°†ä¼šåœ¨å£°æ˜å‘¨æœŸçš„åˆå§‹åŒ–ä¹‹å‰å’Œåˆå§‹åŒ–ä¹‹åè¿›è¡Œè°ƒç”¨,ä¼ å…¥çš„bean å°±æ˜¯ éœ€è¦ä½¿ç”¨çš„Bean ä¼ å…¥çš„beanNameå°±æ˜¯é…ç½®çš„beanname , ä¸€èˆ¬å°±æ˜¯å¯¹æŒ‡å®šçš„ç›¸å…³çš„beanè¿›è¡Œå¤„ç† BeanFactoryPostProcessoræ¥å£ BeanFactoryPostProcessoræ¥å£å®ç°ç±»å¯ä»¥åœ¨å½“å‰BeanFactoryåˆå§‹åŒ–åï¼Œbeanå®ä¾‹åŒ–ä¹‹å‰å¯¹BeanFactoryåšä¸€äº›å¤„ç†ã€‚BeanFactoryPostProcessoræ˜¯é’ˆå¯¹äºbeanå®¹å™¨çš„ï¼Œåœ¨è°ƒç”¨å®ƒæ—¶ï¼ŒBeanFactoryåªåŠ è½½äº†beançš„å®šä¹‰ï¼Œè¿˜æ²¡æœ‰å¯¹å®ƒä»¬è¿›è¡Œå®ä¾‹åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹BeanFactoryçš„å¤„ç†æ¥è¾¾åˆ°å½±å“ä¹‹åå®ä¾‹åŒ–beançš„æ•ˆæœã€‚è·ŸBeanPostProcessorä¸€æ ·ï¼ŒApplicationContextä¹Ÿèƒ½è‡ªåŠ¨æ£€æµ‹å’Œè°ƒç”¨å®¹å™¨ä¸­çš„BeanFactoryPostProcessorã€‚æ¥å£çš„ä¿¡æ¯å¦‚ä¸‹: åœ¨springä¸­æœ‰ä¸€äº›ç‰¹æ®Šçš„æ“ä½œå°±æ˜¯ä½¿ç”¨BeanFactoryPostProcessoræ¥å£ï¼Œæ¯”å¦‚ç±»åæ›¿æ¢PropertyPlaceholderConfigurerã€‚ä»–å¯ä»¥è‡ªåŠ¨å°†ç›¸å…³çš„java propertiesä¿¡æ¯æ›¿æ¢æˆéœ€è¦çš„,è¿™é‡Œåˆ†æä¸€ä¸‹è¿™ä¸ªç±»: æ¥å£:InitializingBean â€” åªæœ‰ä¸€ä¸ªæ–¹æ³•afterPropertiesSet å½“beanå®ä¾‹åŒ–ä¹‹åå°†ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•,æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œåˆå§‹åŒ–ä¸€ä¸‹å±æ€§æ¥å£:order å¯ä»¥æŒ‡å®šä¼˜å…ˆçº§æ¥å£:BeanNameAwareå’ŒBeanFactory é…ç½®é…ç½®å›è°ƒå°†å®¹å™¨çš„å’Œé…ç½®çš„ç›¸å…³å‚æ•°ä¼ å…¥ç±»: PropertiesLoaderSupport,PropertyResourceConfigurer å°†é…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°è¿›è¡Œç»‘å®š,æä¾›é…ç½®æ–‡ä»¶è§£æåŠŸèƒ½ç±»:PlaceholderConfigurerSupport çœŸæ­£çš„å®ç°æ’å…¥æ–¹æ³•,è¿™ä¸ªç±»æœ€æ ¸å¿ƒçš„æ–¹æ³•: éå†ç»™å®šçš„BeanDefinitionå¯¹è±¡å’Œå®ƒä»¬ä¸­åŒ…å«çš„MutablePropertyValueså’ŒConstructorArgumentValuesã€‚ æ³¨æ„å…¶ä¸­æœ‰BeanFactoryPostProcessorçš„ä½¿ç”¨æ–¹æ³• å…¶ä¸­çš„postProcessBeanFactoryè¿™ä¸ªæ–¹æ³•ä¸­çš„å‚æ•°æ˜¯å†³å®šBeanFactoryPostProcessorå¼ºäºBeanPostProcessorçš„å…³é”®ä¹‹å¤„,å…¶ä¸­æœ‰ä¸€ä¸ªå‚æ•°:ConfigurableListableBeanFactory,è¿™ä¸ªå‚æ•°å¯ä»¥è¿›è¡Œé…ç½®ç›¸å…³çš„é…ç½®é¦–å…ˆå…·ä½“è§ä¸‹ è¿™ä¸ªæ¥å£åªæœ‰ä¸€ä¸ªå®ç°ç±»:DefaultListableBeanFactory çœ‹ä¸€ä¸‹å…³ç³»ç»§æ‰¿å›¾ é‡ç‚¹å…³æ³¨è¿™ä¸ªæ¥å£:ConfigurableListableBeanFactory,è¿™ä¸ªæ¥å£ç»§æ‰¿äº†ListableBeanFactory, AutowireCapableBeanFactory, ConfigurableBeanFactory è¿™ä¸‰ä¸ªæ¥å£ BeanFactory ä¸»è¦æä¾›getbean ,å’ŒisSingleType è¿™æ ·çš„æ–¹æ³• ListableBeanFactory è¿™ä¸ªæ¥å£æ˜¯BeanFactoryæ¥å£çš„å®ç°ä¹‹ä¸€(è¿˜æœ‰HierarchicalBeanFactory,AutowireCapableBeanFactory),è¿™ä¸ªä¸»è¦æ˜¯è·å–å®¹å™¨ä¸­å„ç§ç›¸å…³javabeanå±æ€§çš„æ–¹æ³•,æ¯”å¦‚æœ‰ getBeansOfType,getBeansWithAnnotation è¿™ç§æ–¹æ³•, AutowireCapableBeanFactory æä¾›è‡ªåŠ¨è£…é…æ‰©å±•(ç”¨æ¥åˆ†å±‚å°†åŠŸèƒ½ç»†åŒ–) HierarchicalBeanFactory å…¶ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•,getParentBeanFactory è¿™é‡Œæä¾›åˆ†çº§åŠŸèƒ½,å®ç°äº†è¿™ä¸ªæ¥å£å¯ä»¥è·å–å¤«å·¥å‚æ–¹æ³• ConfigurableListableBeanFactory è¿™ä¸ªæ¥å£åŒæ—¶ç»§æ‰¿äº†ListableBeanFactory,AutowireCapableBeanFactory,HierarchicalBeanFactory. å¦‚æœçœ‹ä¸€äº›ä¸Šé¢è¿™äº›ç±»å°±ä¼šæœ‰ä¸€ä¸ªå¤§è‡´ä¸Šçš„ç†è§£äº† spring é€šè¿‡å„ç§ç»§æ‰¿å’Œæ¥å£æ‰©å±•äº†è¿™ä¸ªç±»çš„ä½¿ç”¨æ–¹æ³•,å°†ç›¸å…³çš„å„ç§åŠŸèƒ½å°½å¿ƒç»„è£…(ä¸€ä¸ªæ¥å£ä¸“æ³¨ä¸€ä¸ªç‚¹è®°æ€§ç»†åŒ–,ä¸Šå±‚å®ç°,å…¸å‹çš„oopæ€æƒ³) ConfigurableListableBeanFactory æ¥å£ç»§æ‰¿äº†ä¸Šé¢çš„è¿™äº›æ¥å£,æ‰€ä»¥ä»–æ‹¥æœ‰è·å–æ‰€æœ‰çš„ç›¸å…³çš„javaBeané›†åˆçš„èƒ½åŠ›,å¹¶ä¸”æ‹¥æœ‰åœ¨åˆå§‹åŒ–ä¹‹å‰å¯¹å±æ€§è¿›è¡Œæ“ä½œçš„èƒ½åŠ›. å•ä¾‹æ¨¡å¼ä¸‹å®ç°å†…éƒ¨å˜é‡éå•ä¾‹é…ç½® ä¹‹å‰åœ¨åšå®¢ä¸­åšè¿‡æµ‹è¯•ï¼Œåœ¨springå®¹å™¨ä¸­å•ä¾‹æ¨¡å¼æ³¨å…¥éå•ä¾‹æ¨¡å¼å±æ€§çš„æ—¶å€™å…¶å®å„ä¸ªå…ƒç´ æ³¨å…¥çš„æ˜¯ç›¸åŒçš„ç±»ï¼ˆä½¿ç”¨å·¥å‚æ–¹æ³•è¿›è¡Œæ³¨å…¥çš„æ—¶å€™ä¹Ÿæ˜¯å¦‚æ­¤ï¼‰ï¼ˆ&#x3D;&#x3D;è¿”å›trueï¼‰ï¼Œæƒ³è¦è·å–ä¸åŒçš„å±æ€§å°±è¦ä½¿ç”¨lookupæ ‡ç­¾ é…ç½®æ–‡ä»¶ springæ¡†æ¶åœ¨æŠ½è±¡ç±»ä¸­å°†ä¼šè‡ªåŠ¨ä½¿ç”¨åŠ¨æ€ä»£ç†å®ç°è¿™ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œè®²æŒ‡å®šçš„beanå¯¹è±¡è¿›è¡Œè¿”å›å¦‚æœå¯¹è±¡å®ç°äº†å€Ÿå£ springæ¡†æ¶å°†ä¼šä½¿ç”¨jdkä»£ç† å¦åˆ™ä½¿ç”¨cglibä»£ç† æ¨èä½¿ç”¨æ¥å£ Lookupç±» javabean spring messageæœºåˆ¶è¯¥ApplicationContextæ¥å£æ‰©å±•äº†ä¸€ä¸ªç§°ä¸ºçš„æ¥å£MessageSourceï¼Œå› æ­¤æä¾›äº†å›½é™…åŒ–ï¼ˆi18nï¼‰åŠŸèƒ½ã€‚Springè¿˜æä¾›äº†HierarchicalMessageSourceå¯ä»¥åˆ†å±‚è§£ææ¶ˆæ¯çš„æ¥å£ã€‚è¿™äº›æ¥å£ä¸€èµ·ä¸ºSpringç‰¹æ•ˆæ¶ˆæ¯è§£ææä¾›äº†åŸºç¡€ã€‚è¿™äº›æ¥å£ä¸Šå®šä¹‰çš„æ–¹æ³•åŒ…æ‹¬ï¼š String getMessage(String code, Object[] args, String default, Locale loc)ï¼šç”¨äºä»ä¸­æ£€ç´¢æ¶ˆæ¯çš„åŸºæœ¬æ–¹æ³•MessageSourceã€‚å¦‚æœæœªæ‰¾åˆ°æŒ‡å®šè¯­è¨€ç¯å¢ƒçš„æ¶ˆæ¯ï¼Œåˆ™ä½¿ç”¨é»˜è®¤æ¶ˆæ¯ã€‚ä½¿ç”¨MessageFormatæ ‡å‡†åº“æä¾›çš„åŠŸèƒ½ï¼Œä¼ å…¥çš„ä»»ä½•å‚æ•°éƒ½å°†æˆä¸ºæ›¿æ¢å€¼ã€‚ String getMessage(String code, Object[] args, Locale loc)ï¼šä¸å‰é¢çš„æ–¹æ³•åŸºæœ¬ç›¸åŒï¼Œä½†æœ‰ä¸€ç‚¹ä¸åŒï¼šä¸èƒ½æŒ‡å®šé»˜è®¤æ¶ˆæ¯; å¦‚æœæ— æ³•æ‰¾åˆ°æ¶ˆæ¯ï¼ŒNoSuchMessageExceptionåˆ™ä¼šæŠ›å‡ºaã€‚ String getMessage(MessageSourceResolvable resolvable, Locale locale)ï¼šå‰é¢æ–¹æ³•ä¸­ä½¿ç”¨çš„æ‰€æœ‰å±æ€§ä¹Ÿéƒ½åŒ…å«åœ¨ä¸€ä¸ªåä¸ºçš„ç±»ä¸­ MessageSourceResolvableï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•ã€‚ æ³¨æ„:å½“ä¸€ä¸ªApplicationContextè¢«åŠ è½½æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨æœç´¢ä¸Šä¸‹æ–‡ä¸­å®ç°MessageSource æ¥å£çš„beanã€‚è¿™ä¸ªbeançš„åå­—å¿…é¡»æ˜¯messageSource,å¦‚æœ ApplicationContextæ— æ³•æ‰¾åˆ°ä»»ä½•æ¶ˆæ¯æºï¼ŒDelegatingMessageSourceåˆ™ä¼šå®ä¾‹åŒ–ä¸€ä¸ªç©º ä»¥ä¾¿èƒ½å¤Ÿæ¥å—å¯¹ä¸Šé¢å®šä¹‰çš„æ–¹æ³•çš„è°ƒç”¨ã€‚ Springæä¾›äº†ä¸¤ä¸ªMessageSourceå®ç°ï¼ŒResourceBundleMessageSourceå¹¶ä¸” StaticMessageSourceã€‚ä¸¤è€…éƒ½æ˜¯HierarchicalMessageSourceä¸ºäº†åšåµŒå¥—æ¶ˆæ¯ä¼ é€’è€Œå®ç°çš„ã€‚è¿™StaticMessageSourceæ˜¯å¾ˆå°‘ä½¿ç”¨ï¼Œä½†æä¾›äº†ç¼–ç¨‹æ–¹å¼æ¥æ·»åŠ æ¶ˆæ¯åˆ°æºã€‚åœ¨ResourceBundleMessageSourceè¢«ç¤ºå‡ºåœ¨ä¸‹é¢çš„ä¾‹å­ï¼š ä¾‹å­ä¸­ æ ‡ç­¾ä¸­çš„æ•°æ®è¡¨ç¤ºçš„æ˜¯æ•°æ®åç§° å¯¹åº”çš„æ–‡ä»¶æ˜¯ format.propertiesæ–‡ä»¶,ä¸¾ä¾‹å­ä¸ºformat.propertiesä¸­çš„ä¿¡æ¯ ä½¿ç”¨è¿™ä¸ªæ–¹æ³• è¾“å‡ºä¸º springäº‹ä»¶ Event å…¶å®å°±æ˜¯å®ç°ä¸€ä¸ªevent å’Œ ä¸€ä¸ªlistenerçš„è¿‡ç¨‹ event ä¸€ä¸ªäº‹ä»¶ å®šä¹‰ä¸€ä¸ªeventäº‹ä»¶:å¹¶ä¸éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼Œæ˜¯éœ€è¦ä½¿ç”¨applicationæ‰‹åŠ¨å‘å‡º å®ç° ApplicationEventæ¥å£ spring å‘å¸ƒä¸€ä¸ªä¸€ä¸ªeventäº‹ä»¶ åœ¨springä¸­ä»»ä½•ä¸€ä¸ªå¯ä»¥å‘å¸ƒäº‹ä»¶çš„æ–¹æ³•éƒ½å®ç°äº†ä¸€ä¸ªApplicationEventPublisheræ¥å£,applicationContextå°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ªå®ç°ç±» æˆ‘ä»¬åœ¨è‡ªå·±è¿›è¡Œå¼€å‘çš„æ—¶å€™å¹¶ä¸éœ€è¦å®ç°è¿™ä¸ªæ¥å£åªè¦å®ç°ä¸€ä¸ªApplicationEventPublisherAware , spring å®¹å™¨å°±å›è‡ªåŠ¨çš„å°†ç›¸å…³çš„å±æ€§æ³¨å…¥åˆ°è¿™ä¸ªè¿™ä¸ªbeanä¸­ springç›‘å¬event ApplicationListener è¿™ä¸ªç›‘å¬å™¨éœ€è¦åœ¨beanä¸­è¿›è¡Œé…ç½®ï¼Œspringå®¹å™¨ä¼šè‡ªåŠ¨çš„å¤„ç†event xmlé…ç½®æ–‡ä»¶ spring beanè·å¾—å®¹å™¨å’Œè‡ªèº«ç›¸å…³å±æ€§spring ä¸­beanè·å¾—spring éœ€è¦å®ç°ä¸€ä¸‹ä¸¤ä¸ªæ¥å£ ApplicationContextAware BeanFactoryAware spring beanè·å¾—è‡ªèº«çš„ç›¸å…³é…ç½®å±æ€§ä½¿ç”¨å¦‚ä¸‹çš„æ¥å£ BeanClassLoaderAware BeanNameAware","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-AOP","url":"/2024/12/31/spring5-AOP/","content":"AOP æ˜¯ä¸€ç§æ–°çš„å±æ€§é…ç½®æ–¹æ³•è¿™ç§æ–¹æ³•ä¸åŒä¸OOPï¼Œä¸æ˜¯ä½¿ç”¨ç»§æ‰¿çš„æ–¹æ³•æ¥å¢å¼ºç›¸å…³çš„å‚æ•°è€Œæ˜¯ä½¿ç”¨æ¨ªå‘çš„åˆ‡é¢ç¼–ç¨‹çš„æ–¹æ³•æ¥è¿›è¡Œç›¸å…³å¢å¼ºçš„ springä¸­ä½¿ç”¨xmlè¿›è¡Œé…ç½®çš„æ–¹æ³•åˆ‡é¢ç±» æ³¨æ„ï¼š aroundæ–¹å¼çš„æ–¹æ³•éœ€è¦ç¬¬ä¸€å‚æ•°ä¸ºProceedingJoinPoint ç±»å‹ ï¼Œå½“éœ€è¦æ¥å—å‚æ•°çš„æ—¶å€™éœ€è¦åœ¨ exectionæ–¹æ³•ä¸­è¿›è¡Œç›¸å…³çš„é…ç½® è¢«åˆ‡å…¥ç±» xmlé…ç½®æ–‡ä»¶ æµ‹è¯•ç±» è¾“å‡ºç»“æœ ä½¿ç”¨æ³¨è§£æ–¹æ³•è¿›è¡Œé…ç½®å¢å¼ºç±» åˆ‡é¢ç±» åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ æ”¯æŒå¦‚ä¸‹çš„å‡ ä¸ª,with(examples.chap03.Horseman) æŒ‡å®šç±»åç§°çš„æ‰€æœ‰æ–¹æ³•,é€šè¿‡ç±»åæŒ‡å®šï¼ŒåŒæ—¶åŒ…å«æ‰€æœ‰å­ç±»target(examples.chap03.Horseman),args(java.util.String) æŒ‡å®šå‚æ•°(å¦‚æœä½¿ç”¨çš„ä¸æ˜¯åŸºæœ¬ç±»å‹,é‚£å°±ä¼šåŒ¹é…å¯¹åº”çš„å˜é‡åç§°),annotation(org.springframework.transaction.annotation.Transactional) æŒ‡å®šæ ‡æ³¨äº†æŒ‡å®šçš„æ³¨è§£çš„æ–¹æ³•,è¿™äº›å‚æ•°å¿…é¡»æ˜¯å…¨é™å®šåç§° xmlæ–‡ä»¶é…ç½®æ–‡ä»¶ æ³¨æ„ä¸Šé¢çš„é…ç½®æ–¹æ³•å…¶å®å¯ä»¥æ›¿æ¢æˆå¦‚ä¸‹çš„æ–¹æ³• æ³¨æ„:å®Œæ•´çš„AspectJåˆ‡å…¥ç‚¹è¯­è¨€æ”¯æŒSpringä¸­ä¸æ”¯æŒçš„å…¶ä»–åˆ‡å…¥ç‚¹æŒ‡ç¤ºç¬¦ã€‚è¿™äº›æ˜¯ï¼šcall, get, set, preinitialization, staticinitialization, initialization, handler, adviceexecution, withincode, cflow, cflowbelow, if, @thisï¼Œå’Œ@withincode æ³¨æ„: ä½¿ç”¨æ³¨è§£çš„ç¼ºç‚¹,æ”¯æŒâ€œsingletonâ€æ–¹é¢çš„å®ä¾‹åŒ–æ¨¡å‹ï¼Œå¹¶ä¸”ä¸å¯èƒ½ç»„åˆä½¿ç”¨XMLå£°æ˜çš„å‘½ååˆ‡å…¥ç‚¹ã€‚ä½¿ç”¨XMLæ–¹æ³•çš„ç¼ºç‚¹æ˜¯æ‚¨æ— æ³•é€šè¿‡ç»„åˆè¿™äº›å®šä¹‰æ¥å®šä¹‰åˆ‡å…¥ç‚¹ã€‚ æ³¨æ„: springä¸æ”¯æŒfinalçš„è°ƒç”¨,åº”ä¸ºfinalä¸æ”¯æŒè¦†ç›– æ³¨æ„å½“åœ¨ä»£ç†ä¸­ä½¿ç”¨æ–¹æ³•çš„æ–¹æ³•çš„æ—¶å€™ä¸èƒ½ä½¿ç”¨ä»£ç†è‡ªå·±çš„æ–¹æ³•,å› ä¸ºè§£æå™¨ä¼šä½¿ç”¨this.xxx()æ¥è¿è¡Œ è€Œä¸æ˜¯ä½¿ç”¨ proxyæ¥è¿è¡Œ,æ‰€ä»¥åº”è¯¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹æ³•è¿›è¡Œä»£ç† æ³¨æ„: ä½¿ç”¨çš„è¡¨è¾¾å¼æ ¼å¼ - execution(modifiers-pattern? ret-type-pattern declaring-type-pattern?name-pattern(param-pattern) throws-pattern?)","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-SpELè¡¨è¾¾å¼","url":"/2024/12/31/spring5-SpELè¡¨è¾¾å¼/","content":"spring5-SpELè¡¨è¾¾å¼SpELæ˜¯ä¸€ç§å¼ºå¤§çš„ã€ç®€æ´çš„è£…é…Beançš„æ–¹å¼ï¼Œå®ƒé€šè¿‡è¿è¡ŒæœŸæ‰§è¡Œçš„è¡¨è¾¾å¼å°†å€¼è£…é…åˆ°Beançš„å±æ€§æˆ–æ„é€ å™¨å‚æ•°ä¸­ã€‚æ¯”å¦‚è¯´ xmlæ–‡ä»¶ä¸­åŠ¨æ€çš„åŠ å…¥ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä½¿ç”¨ç±»çš„é™æ€æ–¹æ³•ç­‰ç›¸å…³æ–¹æ³•è½½å…¥å‚æ•° è½½å…¥åŸºæœ¬ç±»å‹ ä½¿ç”¨xmlé…ç½®æ–‡ä»¶ä¸­çš„å…¶ä»–é…ç½®é€‰é¡¹ è·å–poetä¸­ä¼ å…¥çš„poemå¯¹è±¡çš„ä¸¤ç§æ–¹æ³• è°ƒç”¨æ–¹æ³•è°ƒç”¨å…¶ä»– åå­—ä¸ºpoet beançš„æ–¹æ³• ä¸Šé¢ä½¿ç”¨ ?. è¿ç®—ç¬¦ä»£æ›¿ç‚¹ï¼ˆ.ï¼‰æ¥è®¿é—®toUpperCase()æ–¹æ³•ã€‚åœ¨è®¿é—®é‚®ç¼–æ–¹æ³•ä¹‹å‰ï¼Œè¯¥è¿ç®—ç¬¦ä¼šç¡®ä¿å·¦è¾¹é¡¹çš„å€¼ä¸ä¸ºnullã€‚æ‰€ä»¥ï¼Œå¦‚æœselectorSongè¿”å›nullï¼ŒSpELå°±ä¸å†å°è¯•è°ƒç”¨toUpperCase()æ–¹æ³•ã€‚ åœ¨SpELä¸­ï¼Œä½¿ç”¨T()è¿ç®—ç¬¦ä¼šè°ƒç”¨ç±»ä½œç”¨åŸŸçš„æ–¹æ³•å’Œå¸¸é‡ ä½¿ç”¨é€»è¾‘ç®—æ•°è¿è¡Œç®—æ•°è¡¨è¾¾å¼ æ“ä½œä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼šeq(&#x3D;&#x3D;),lt(<),le(<&#x3D;),gt(>),ge(>&#x3D;)ã€‚é€»è¾‘è¡¨è¾¾å¼ï¼šand,or,notæˆ–!ã€‚æ¡ä»¶è¿ç®—ç¬¦ï¼šä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦ ï¼Ÿï¼š æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-SpELè¡¨è¾¾å¼çš„ä½¿ç”¨","url":"/2024/12/31/spring5-SpELè¡¨è¾¾å¼çš„ä½¿ç”¨/","content":"SpEL è¡¨è¾¾å¼çš„ä½¿ç”¨SpEl è¡¨è¾¾å¼ä¸»è¦ç”¨åœ¨beançš„å®šä¹‰æ˜¯ä¸Š åŸºäºxmlçš„é…ç½® åŸºäºæ³¨è§£çš„é…ç½® åŸºäºæ³¨è§£çš„é…ç½®åœ¨ä½¿ç”¨è‡ªåŠ¨è£…é…çš„æ–¹æ³•å’Œæ„é€ å‡½æ•°æ—¶ä½¿ç”¨@Valueæ³¨è§£é…å¥—æ–¹æ³• è¯­è¨€å‚è€ƒspring å†…ç½®äº†ä¸€ä¸ªè§£æå™¨SpelExpressionParser åŸºæœ¬ç±»å‹è¡¨è¾¾å¼ è·å–å¯¹è±¡çš„å±æ€§ è·å–æ•°ç»„çš„å±æ€§ å†…è”map è°ƒç”¨æ–¹æ³• è¿ç®—ç¬¦è§£æ æ³¨æ„null åœ¨è¿™é‡Œè§†ä¸º0 å’Œ ç©º 1> null è¿”å›true -1>null è¿”å›false æ³¨æ„:æ¯ä¸ªç¬¦å·è¿ç®—ç¬¦ä¹Ÿå¯ä»¥è¢«æŒ‡å®šä¸ºçº¯ç²¹çš„å­—æ¯ç­‰æ•ˆã€‚è¿™é¿å…äº†æ‰€ä½¿ç”¨çš„ç¬¦å·å¯¹åµŒå…¥è¡¨è¾¾å¼çš„æ–‡æ¡£ç±»å‹ï¼ˆä¾‹å¦‚XMLæ–‡æ¡£ï¼‰å…·æœ‰ç‰¹æ®Šå«ä¹‰çš„é—®é¢˜ã€‚æ–‡æœ¬ç­‰ä»·ç‰©å¦‚ä¸‹æ‰€ç¤ºï¼šltï¼ˆ<ï¼‰ï¼Œgtï¼ˆ>ï¼‰ï¼Œleï¼ˆâ‡ï¼‰ï¼Œgeï¼ˆ>&#x3D;ï¼‰ï¼Œeqï¼ˆ&#x3D;&#x3D;ï¼‰ï¼Œ neï¼ˆ!&#x3D;ï¼‰ï¼Œdivï¼ˆ&#x2F;ï¼‰ï¼Œmodï¼ˆ%ï¼‰ï¼Œnotï¼ˆ!ï¼‰ é€»è¾‘è¿ç®—ç¬¦ æ•°å­¦è¿ç®—ç¬¦ å±æ€§èµ‹å€¼ æ„é€ å‡½æ•° ä¸‰å…ƒè¿ç®—ç¬¦å’ŒçŒ«ç‹è¿ç®—ç¬¦ é›†åˆé€‰æ‹© ç€è¡¨è¾¾å¼å°†ä¼šé€‰æ‹© List Menbersä¸­ Nationality ä¸º Serbiançš„æ‰€æœ‰å…ƒç´  å¼•ç”³:é™¤äº†è¿”å›æ‰€æœ‰é€‰å®šçš„å…ƒç´ ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æ£€ç´¢ç¬¬ä¸€ä¸ªæˆ–æœ€åä¸€ä¸ªå€¼ã€‚è¦è·å¾—ä¸é€‰æ‹©ç›¸åŒ¹é…çš„ç¬¬ä¸€ä¸ªæ¡ç›®ï¼Œè¯­æ³•ä½¿ç”¨^[â€¦â€‹],è¦è·å–è¯­æ³•çš„æœ€ååŒ¹é…ä½¿ç”¨$[â€¦â€‹]ã€‚ åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥è¡¨è¾¾å¼æ¨¡ç‰ˆ","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-beanfactoryç³»åˆ—æ¥å£çš„åˆ†æ","url":"/2024/12/31/spring5-beanfactoryç³»åˆ—æ¥å£çš„åˆ†æ/","content":"","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-conditionæ³¨è§£å®ç°beanç»†è‡´æ§åˆ¶","url":"/2024/12/31/spring5-conditionæ³¨è§£å®ç°beanç»†è‡´æ§åˆ¶/","content":"","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-coreæ ¸å¿ƒé…ç½®æ–‡ä»¶ä½¿ç”¨","url":"/2024/12/31/spring5-coreæ ¸å¿ƒé…ç½®æ–‡ä»¶ä½¿ç”¨/","content":"ä¾èµ–æ³¨å…¥å’Œæ§åˆ¶åè½¬IOC inversion of control æ§åˆ¶åè½¬ DI Dependency Injection ä¾èµ–æ³¨å…¥ ä¾èµ–æ³¨å…¥å½“ç„¶æ˜¯æŸä¸ªå¯¹è±¡ä¾èµ–äºIoC&#x2F;DIçš„å®¹å™¨ï¼Œå¯¹è±¡éœ€è¦IoC&#x2F;DIçš„å®¹å™¨æ¥æä¾›å¯¹è±¡éœ€è¦çš„å¤–éƒ¨èµ„æºï¼ŒIoC&#x2F;DIçš„å®¹å™¨ æ³¨å…¥ æŸä¸ªå¯¹è±¡å¹¶ä¸”æ³¨å…¥æŸä¸ªå¯¹è±¡æ‰€éœ€è¦çš„å¤–éƒ¨èµ„æºï¼Œç”±IoC&#x2F;DIçš„å®¹å™¨æ¥æ§åˆ¶å¯¹è±¡äº†ï¼Œæ ¹æœ¬ä¸Šæ˜¯æ§åˆ¶å¯¹è±¡å®ä¾‹çš„åˆ›å»º æ§åˆ¶åè½¬å¦‚æœè¦åœ¨Aé‡Œé¢ä½¿ç”¨Cï¼Œä½ ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿå½“ç„¶æ˜¯ç›´æ¥å»åˆ›å»ºCçš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜¯åœ¨Aç±»ä¸­ä¸»åŠ¨å»è·å–æ‰€éœ€è¦çš„å¤–éƒ¨èµ„æºCï¼Œè¿™ç§æƒ…å†µè¢«ç§°ä¸ºæ­£å‘çš„ã€‚é‚£ä¹ˆä»€ä¹ˆæ˜¯åå‘å‘¢ï¼Ÿå°±æ˜¯Aç±»ä¸å†ä¸»åŠ¨å»è·å–Cï¼Œè€Œæ˜¯è¢«åŠ¨ç­‰å¾…ï¼Œç­‰å¾…IoC&#x2F;DIçš„å®¹å™¨è·å–ä¸€ä¸ªCçš„å®ä¾‹ï¼Œç„¶ååå‘çš„æ³¨å…¥åˆ°Aç±»ä¸­ spring IOC bean é…ç½®æ–‡ä»¶ æ³¨æ„ï¼šä¸ä½¿ç”¨æ„é€ æ³¨å…¥çš„æ—¶å€™ï¼Œå°†ä¼šä½¿ç”¨setteræ³¨å…¥æ‰€ä»¥å¿…é¡»æä¾›setterå‡½æ•° spring è‡ªåŠ¨é…ç½®å†…éƒ¨ç±»å†…éƒ¨ç±»æ³¨å…¥æ–¹å¼ä¸€ï¼šæ·»åŠ å†…éƒ¨ç±»é»˜è®¤æ„é€ å‡½æ•°å‚æ•°éé™æ€çš„å†…éƒ¨ç±»é»˜è®¤çš„æ„é€ å‡½æ•°æœ‰ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æŒ‡å‘å…¶å¤–éƒ¨ç±»çš„å®ä¾‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™æ­¤å†…éƒ¨ç±»çš„beanæ·»åŠ constructor-argèŠ‚ç‚¹ï¼Œå¹¶æŒ‡å‘å¤–éƒ¨ç±»å³å¯ï¼Œé…ç½®æ–‡ä»¶ï¼š å†…éƒ¨ç±»æ³¨å…¥æ–¹å¼äºŒï¼šå°†å†…éƒ¨ç±»ä¿®æ”¹ä¸ºstaticè¿™ä¸ªä½¿ç”¨ä¸éœ€è¦è®¿é—®å¤–éƒ¨ï¼Œæ‰€ä»¥å°±å’Œå¤–éƒ¨ç±»å‹ç­‰åŒäº† æ³¨æ„spring å£°æ˜å†…éƒ¨ç±»çš„æ—¶å€™éœ€è¦ç‰¹æ®Šå¤„ç†,éœ€è¦é€šè¿‡å¤–éƒ¨ç±»$å†…éƒ¨ç±»åæ¥ä½¿ç”¨ parent abstractå’Œlist map set Properties å±æ€§ä½¿ç”¨ parent å’Œ abstract åªæ˜¯ç›¸å½“äºåœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šä¸€ä¸ªå‚æ•°çš„ç»§æ‰¿æ–¹æ³•ï¼Œç›¸å½“äºå®ç°ä¸€ä¸ªå‚æ•°çš„æ¨¡æ¿ï¼Œè€Œé›†åˆç±»å‹çš„é…ç½®ï¼Œä¾‹å­ä¸­ä½¿ç”¨äº†åŸºæœ¬ç±»å‹ä½¿ç”¨valueæ ‡ç­¾è¿›è¡Œé…ç½®å…¶å®å’Œå¯ä»¥ä¼ å…¥beançš„å¼•ç”¨ã€‚ è·å–beanå®¹å™¨ä½¿ç”¨applicationContext è·å¾— spring å®¹å™¨ è€Œ BeanFactoryæ˜¯ applicationçš„çˆ¶ç±» äºŒè€…åŒºåˆ« applicationContextæ¥å£,å®ƒç”±BeanFactoryæ¥å£æ´¾ç”Ÿè€Œæ¥ï¼Œå› è€Œæä¾›BeanFactoryæ‰€æœ‰çš„åŠŸèƒ½ã€‚ApplicationContextä»¥ä¸€ç§æ›´å‘é¢å‘æ¡†æ¶çš„æ–¹å¼å·¥ä½œä»¥åŠå¯¹ä¸Šä¸‹æ–‡è¿›è¡Œåˆ†å±‚å’Œå®ç°ç»§æ‰¿ï¼ŒApplicationContextåŒ…è¿˜æä¾›äº†ä»¥ä¸‹çš„åŠŸèƒ½ï¼š MessageSource, æä¾›å›½é™…åŒ–çš„æ¶ˆæ¯è®¿é—® èµ„æºè®¿é—®ï¼Œå¦‚URLå’Œæ–‡ä»¶ äº‹ä»¶ä¼ æ’­ è½½å…¥å¤šä¸ªï¼ˆæœ‰ç»§æ‰¿å…³ç³»ï¼‰ä¸Šä¸‹æ–‡ ï¼Œä½¿å¾—æ¯ä¸€ä¸ªä¸Šä¸‹æ–‡éƒ½ä¸“æ³¨äºä¸€ä¸ªç‰¹å®šçš„å±‚æ¬¡ï¼Œæ¯”å¦‚åº”ç”¨çš„webå±‚ å…¶ä»–åŒºåˆ«ï¼š BeanFactroyé‡‡ç”¨çš„æ˜¯å»¶è¿ŸåŠ è½½å½¢å¼æ¥æ³¨å…¥Beançš„ï¼Œå³åªæœ‰åœ¨ä½¿ç”¨åˆ°æŸä¸ªBeanæ—¶(è°ƒç”¨getBean())ï¼Œæ‰å¯¹è¯¥Beanè¿›è¡ŒåŠ è½½å®ä¾‹åŒ–ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±ä¸èƒ½å‘ç°ä¸€äº›å­˜åœ¨çš„Springçš„é…ç½®é—®é¢˜ã€‚è€ŒApplicationContextåˆ™ç›¸åï¼Œå®ƒæ˜¯åœ¨å®¹å™¨å¯åŠ¨æ—¶ï¼Œä¸€æ¬¡æ€§åˆ›å»ºäº†æ‰€æœ‰çš„Beanã€‚è¿™æ ·ï¼Œåœ¨å®¹å™¨å¯åŠ¨æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘ç°Springä¸­å­˜åœ¨çš„é…ç½®é”™è¯¯ã€‚ BeanFactoryå’ŒApplicationContextéƒ½æ”¯æŒBeanPostProcessorã€BeanFactoryPostProcessorçš„ä½¿ç”¨ï¼Œä½†ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«æ˜¯ï¼šBeanFactoryéœ€è¦æ‰‹åŠ¨æ³¨å†Œï¼Œè€ŒApplicationContextåˆ™æ˜¯è‡ªåŠ¨æ³¨å†Œ autowrite + autowirte-candidate lazy-initï¼ˆspringåªç”¨åœ¨ä½¿ç”¨çš„æ—¶å€™æ‰ä¼šåŠ è½½beanï¼‰ é€šè¿‡ åç§°æˆ–è€…ç±»å‹è‡ªåŠ¨è£…è½½ä½†æ˜¯è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜å°±æ˜¯å”¯ä¸€æ€§ï¼ˆå§“åçš„å”¯ä¸€æ€§å’Œç±»å‹çš„å”¯ä¸€æ€§ï¼‰ï¼Œæ³¨æ„ï¼Œåœ¨xmlä¸­ä½¿ç”¨autowriteçš„æ—¶å€™å¦‚æœä½¿ç”¨çš„listé›†åˆå°±å¯ä»¥å‡ºç°ç›¸åŒçš„ç±»å‹çš„æƒ…å†µï¼Œspringä¼šå°†æ‰€æœ‰çš„æ­£ç¡®çš„ç±»å‹æ³¨å…¥åˆ°é›†åˆä¸­ autowrite : åªç”¨è‡ªåŠ¨è£…é…çš„æ–¹æ³•autowrite-candidateï¼šå¿½ç•¥è‡ªåŠ¨è£…é…ï¼ˆä¹Ÿå°±æ˜¯æ˜¯è¯´springåœ¨æŸ¥æ‰¾å¯è‡ªåŠ¨è£…é…çš„å€™é€‰é¡¹æ—¶å¿½ç•¥è¿™ä¸ªé€‰é¡¹ï¼Œå°±æ˜¯ä¸èƒ½è¢«è‡ªåŠ¨è£…é…ï¼‰ scopespringæœ‰ å¦‚ä¸‹çš„ä½œç”¨åŸŸï¼ˆåœ¨ä½œç”¨åŸŸå†…é»˜è®¤ä½¿ç”¨å•ä¾‹ï¼‰ï¼Œè¡¨ç¤ºè¿™ä¸ªå¯¹è±¡åœ¨è¿™ä¸€ä¸ªåŒºåŸŸçš„ç‹¬ç«‹æ€§ï¼ˆæ¯”å¦‚å•ä¾‹åœ¨ä¸åŒçš„åŒºåŸŸå°±æ˜¯è¡¨ç°çš„ä¸åŒï¼‰ï¼Œsingleton ï¼Œ prototypeï¼Œrequest ï¼Œsession ï¼Œapplicationï¼ˆservletcontextåšç”¨åŸŸï¼‰ï¼Œwebsocketåé¢çš„å››ç§åªç”¨åœ¨ä½¿ç”¨springmvcæˆ–è€…è¿›è¡Œä¸€äº›é…ç½®å¹¶ä¸”ä½¿ç”¨çš„webåº”ç”¨çš„æ—¶å€™æ‰æœ‰æ•ˆï¼Œé…ç½®å¦‚ä¸‹ï¼š æ³¨æ„äº†ï¼šå¦‚æœé•¿çš„scopeå¼•ç”¨çŸ­çš„scopeä¸­çš„bean å°†ä¼šå¯¼è‡´çŸ­çš„scopeåœ¨é•¿çš„scopeä¸­æ— æ³•éšç€çŸ­çš„scopeç”Ÿå‘½å‘¨æœŸçš„ç»“æŸè€Œç»“æŸï¼Œè€Œæ˜¯ä»¥é•¿çš„scopeä½œä¸ºæ ‡å‡†ï¼Œå¦‚æœæƒ³è¦ä»¥å®Œç¾çš„æ–¹æ³•éœ€è¦è¿›è¡Œå¦‚ä¸‹çš„é…ç½®ï¼Œæ·»åŠ aop:scoped-proxy/ è¿™ç§æ–¹æ³•è®©ä¼ å…¥é•¿çš„scopeä¸­çš„å¯¹è±¡ä¸æ˜¯çŸ­çš„scopeçš„beanè€Œæ˜¯è¿™ä¸ªçŸ­çš„scopeçš„ä»£ç†,ä½¿ç”¨çš„æ˜¯cglibï¼ˆaopï¼‰ï¼Œè¿™ä¸ªä»£ç†åªéšç€sessionçš„åˆ›å»ºè€Œåˆ›å»ºï¼Œé”€æ¯è€Œé”€æ¯ã€‚æ³¨æ„cglibåªèƒ½ä»£ç†å…¬æœ‰æ–¹æ³•ï¼Œæ‰€ä»¥ä¸è¦è°ƒç”¨éå…¬æœ‰æ–¹æ³• ä¹Ÿå¯ä»¥ä½¿ç”¨jdkä»£ç† <aop:scoped-proxy proxy-target-class&#x3D;â€falseâ€&#x2F;>ï¼Œ è¿™ä¸ªæ–¹æ³•å°†ä¼šè‡ªåŠ¨çš„ä½¿ç”¨çš„jdkä»£ç†ã€‚ ä¸€ä¸ªä¾‹å­ï¼šé…ç½®æ–‡ä»¶ï¼š javabeanï¼š æµ‹è¯•ç±»ï¼š æ³¨æ„ä¸€ä¸ªç»“è®ºï¼šæ³¨æ„ä½¿ç”¨åŸå‹æ¨¡å¼æ³¨å…¥ä½†å•ä¾‹æ¨¡å¼çš„æ—¶å€™,æˆ–è€…ä½¿ç”¨å•ä¾‹æ¨¡å¼æ³¨å…¥åŸå‹æ¨¡å¼çš„æ—¶å€™ï¼Œä¸€æ¬¡æ“ä½œä¸­æ³¨å…¥çš„å¯¹è±¡æ˜¯ç›¸åŒçš„ ï¼Œå¦‚æœæƒ³è¦è®©å•ä¾‹æ¨¡å¼æ³¨å…¥åŸå‹æ¨¡å¼çš„æ—¶å€™å–å¾—æ•°æ®ä¸ºåŸå‹æ¨¡å¼å°±è¦ä½¿ç”¨lookupæ–¹æ³• lookup methodä½¿ç”¨lookup æ–¹æ³•ï¼Œå…¶å®æœ¬è´¨ä¸Šå°±æ˜¯è®©ä¸€ä¸ªå•ä¾‹beanä½¿ç”¨ä¸€ä¸ªåŸå‹beançš„æ—¶å€™ï¼Œå»å®ç°è¿™ä¸ªå•ä¾‹beanä¸­çš„ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œè®©è¿™ä¸ªæŠ½è±¡æ–¹æ³•è¿”å›ä¸€ä¸ªå•ä¾‹bean ä¸€ä¸ªæœ‰æŠ½è±¡æ–¹æ³•çš„å•ä¾‹bean å¯¹åº”çš„åŸå‹bean mainå‡½æ•°ä¸­çš„æ–¹æ³• é…ç½®æ–‡ä»¶ è¾“å‡ºç»“æœ å¯ä»¥çœ‹å‡ºBeanTwoçš„ç»“æœæ˜¯ä¸åŒçš„ factory-method factory-bean constructor-arg è¿™ä¸ªå·¥å‚æ–¹æ³•å¹¶ä¸æ˜¯æˆ‘ä»¬å»ä½¿ç”¨çš„è€Œæ˜¯è®©springå®¹å™¨ä½¿ç”¨çš„å·¥å‚æ–¹æ³•ï¼Œspringå®¹å™¨ä½¿ç”¨è¿™ä¸ªå·¥å‚æ–¹æ³•è¿›è¡Œå®ä¾‹çš„ç”Ÿæˆï¼Œåœ¨springä¸­ä½¿ç”¨æ„é€ æ³¨å…¥çš„å½¢å¼è°ƒç”¨æŒ‡å®šçš„å·¥å‚æ³•ï¼Œå¹¶ä¼ å…¥å±æ€§(å¯ä»¥ç†è§£æˆä½¿ç”¨æ–¹æ³•ä½œä¸ºæ„é€ å‡½æ•°è¿›è¡Œæ³¨å…¥)ï¼Œå¼•ç”³springä¹Ÿèƒ½ä½¿ç”¨æ„é€ æ³¨å…¥ä½†æ˜¯éœ€è¦æä¾›å¯¹åº”çš„æ„é€ å‡½æ•° spring ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œåˆå§‹åŒ–å’Œé”€æ¯å®ç°æ–¹æ³• ç»§æ‰¿å¹¶ä¸”å®ç° InitializingBeanï¼ŒDisposableBean æ¥å£ åœ¨xmlæ–‡ä»¶ä¸­beançš„å±æ€§æŒ‡æ˜ destroy-method&#x3D;â€â€ init-method&#x3D;â€â€ å¯¹åº”çš„æ–¹æ³• ä½¿ç”¨æ³¨è§£ @PostConstruct and @PreDestroy @PreConstruct-å®¹å™¨åœ¨å¸è½½è¿™ä¸ªbeançš„æ—¶å€™å°†ä¼šè°ƒç”¨çš„æ–¹æ³• springæ¡†æ¶ é€šè¿‡BeanPostProcessor ç±»æ¥å®ç°ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†çš„ã€‚ å¼•ç”³ä¼˜é›…å…³é—­springå®¹å™¨ å¦‚æœä½¿ç”¨çš„webé¡¹ç›®ä½¿ç”¨webapplicationçš„æ—¶å€™å¹¶ä¸éœ€è¦ç‰¹æ®Šé…ç½®springæ¡†æ¶è‡ªåŠ¨çš„å°†ç›¸å…³çš„å„ç§é…ç½®éƒ½å®ç°äº†å¦‚æœä½¿ç”¨çš„æ˜¯éwebé¡¹ç›®é‚£ä¹ˆéœ€è¦æ‰‹åŠ¨è¿›è¡Œé…ç½®ï¼Œé€šè¿‡ConfigurableApplicationContext ç±»è¿›è¡Œé…ç½®ï¼Œä½¿ç”¨registerShutdownHookæ–¹æ³•ä¼˜é›…åœæœº å¼•ç”³ä¸€ä¸ª:ä½¿ç”¨contextç®€åŒ–é…ç½®æ“ä½œ ç‰¹æ®Šç”¨æ³• methoå®Œå…¨æ›¿æ¢ä½¿ç”¨åŸºäºXMLçš„é…ç½®å…ƒæ•°æ®ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¢«æ›¿æ¢çš„æ–¹æ³•å…ƒç´ å°†å·²æœ‰çš„æ–¹æ³•å®ç°æ›¿æ¢ä¸ºå·²éƒ¨ç½²çš„bean æ¯”å¦‚éœ€è¦æ›¿æ¢MyValueCalculatorç±»çš„cmputeValueæ–¹æ³• MyValueCalculatorç±» æ›¿æ¢çš„æ–¹æ³•éœ€è¦ç»§æ‰¿MethodReplaceræ¥å£å¹¶ä¸”åœ¨xmlä¸­è¿›è¡Œé…ç½®","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-springMVCä½¿ç”¨ç®€ä»‹","url":"/2024/12/31/spring5-springMVCä½¿ç”¨ç®€ä»‹/","content":"spring5-springMVCä½¿ç”¨ä½¿ç”¨ä¸€ä¸ªåŸºæœ¬demoè¿›è¡Œç›¸å…³çš„æ•´ç† java controller å…¶ä»–ä¸€äº›æ³¨è§£ springMVC webapplication é…ç½®æ–‡ä»¶ web.xmlé…ç½®æ–‡ä»¶ springMVCè¿‡æ»¤å™¨ ç›¸å…³æµç¨‹ç®€ä»‹","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-springMVCå¼‚æ­¥è¯·æ±‚æ”¯æŒ","url":"/2024/12/31/spring5-springMVCå¼‚æ­¥è¯·æ±‚æ”¯æŒ/","content":"pring5-springMVCå¼‚æ­¥è¯·æ±‚æ”¯æŒæä¾›AsyncRestTemplateç”¨äºå®¢æˆ·ç«¯éé˜»å¡å¼‚æ­¥æ”¯æŒ æœåŠ¡ç«¯ å®¢æˆ·ç«¯ æ³¨æ„:è¿™ä¸ªæ–¹æ³•åœ¨spring5ä¸­æ˜¯è¿‡æœŸçš„ï¼Œä½¿ç”¨ WebClient","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-springMVCè¯¦è§£","url":"/2024/12/31/spring5-springMVCè¯¦è§£/","content":"è¯´é“springçš„webæ”¯æŒé¦–å…ˆå°±å¯ä»¥æƒ³åˆ°äº†spring MVC çš„æŠ€æœ¯(å…¶ä»–çš„æŠ€æœ¯è¿˜æœ‰springçš„webflux ä»¥åè®¨è®º),ä»è¿™ç‰‡åšå®¢å¼€å§‹è¦è¿›è¡Œç›¸å…³çŸ¥è¯†ç‚¹çš„æ•´ç†. spring MVC æ•´ä½“çš„æ¶æ„è®¾è®¡ spring è‡ªå·±çš„webapplicationæ”¯æŒåµŒå¥—ä½œç”¨åŸŸ,é€šè¿‡è¿™ä¸ªæ–¹æ³•å¯ä»¥å®ç°spring applicationcongtextçš„ç»§æ‰¿ç‰¹æ€§(ç»§æ‰¿ç‰¹æ€§,å­ä½œç”¨åŸŸå¯ä»¥è®¿é—®å¤«ä½œç”¨åŸŸçš„ä¸­çš„å±æ€§,ä½†æ˜¯çˆ¶ä½œç”¨åŸŸä¸­çš„å±æ€§æ— æ³•è®¿é—®å­ä½œç”¨åŸŸä¸­çš„å±æ€§,å…·ä½“çš„ä½¿ç”¨çœ‹HierarchicalBeanFactory) webå®¹å™¨çš„åˆå§‹åŒ–è®¾ç½®springMVC æ”¯æŒä½¿ç”¨xmlè¿›è¡Œé…ç½® ä»spring5.0 å¼€å§‹ springå®˜æ–¹æ–‡æ¡£æå€¡ä½¿ç”¨æ¥å£é…ç½®,å®¹å™¨åœ¨åˆå§‹åŒ–çš„æ—¶å€™å°†ä¼šè‡ªåŠ¨çš„åŠ è½½è¿™ä¸ªæ¥å£çš„å®ç°ç±»ä»è€Œè¿›è¡Œé…ç½®spring mvc çš„è‡ªåŠ¨åŒ–é…ç½®æ˜¯é€šè¿‡ WebApplicationInitializer æ¥å£å®ç°çš„ ä½†æ˜¯ç³»ç»Ÿæä¾›äº†æ›´åŠ é«˜çº§çš„æ¥å£ AbstractAnnotationConfigDispatcherServletInitializer å¦‚æœä½¿ç”¨åŸºäºxml çš„ springé…ç½®è¿˜å¯ä»¥ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•è¿›è¡Œç›¸å…³çš„è°ƒç”¨è¿™ä¸ªç±»æ˜¯AbstractAnnotationConfigDispatcherServletInitializer å¦‚æœè¦æ·»åŠ filterç­‰é…ç½®ï¼Œå¯ä»¥ä½¿ç”¨WebApplicationInitializerå®ç°äº†çš„ç›¸å…³æ–¹æ³•æ¯”å¦‚ï¼ŒAbstractDispatcherServletInitializerç±»çš„å¦‚ä¸‹çš„æ–¹æ³• è¿™ä¸ªæ–¹æ³•å°†ä¼šä¸ºæ¯ä¸€ä¸ªfilter æ·»åŠ ä¸€ä¸ªé»˜è®¤çš„è¿‡æ»¤å™¨,å¹¶ä¸”è‡ªåŠ¨çš„æ·»åŠ åˆ°å¯¹åº”çš„displayä¸­ å¼•ç”³ï¼šAbstractDispatcherServletInitializerè¿™ä¸ªç±»è¿˜æœ‰ä¸€ä¸ªisisAsyncSupported()æ–¹æ³•ï¼Œé»˜è®¤æƒ…å†µä¸‹è¿”å›true è¡¨ç¤ºspring mvc æ¡†æ¶ä¸­çš„å°†ä¼šè¿›è¡Œå¼‚æ­¥çš„å¤„ç†è¯·æ±‚ spring mvc éxmlé…ç½®çš„å®ç°åŸç†åœ¨servlet3.0 çš„æ ‡å‡†ä¸­ï¼Œæä¾›äº†ä¸€ä¸­ä½¿ç”¨spiæŠ€æœ¯å®ç°é…ç½®çš„æ–¹æ³•ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥å®ç°é›¶xmlé…ç½® å¼•ç”³ï¼š tomcat æ­¤å¤„å®ç°spiæŠ€æœ¯çš„è§£æ springçš„webåŒ…çš„META-INFçš„æ–‡ä»¶å¤¹ä¸­æœ‰ä¸€ä¸ªåä¸ºï¼Œjavax.servlet.ServletContainerInitializerçš„æ–‡ä»¶ï¼Œå…¶ä¸­çš„å†…å®¹org.springframework.web.SpringServletContainerInitializerï¼Œè¡¨ç¤ºå®šä¹‰çš„ServletContainerInitializerå’Œspringçš„å®ç°æ¥å£SpringServletContainerInitializerï¼Œå…¶ä¸­@HandlesTypesæ³¨è§£è¡¨ç¤ºServletContainerInitializerde å¯ä»¥å¤„ç†çš„ç±»ï¼Œå¯ä»¥å°†æ„Ÿå…´è¶£çš„ä¸€äº›ç±»æ³¨å…¥åˆ°ServletContainerInitializerdeçš„onStartupæ–¹æ³•ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚,åœ¨onStartup æ–¹æ³•ä¸­ï¼Œå¯ä»¥é€šè¿‡Set<Class<?>> c è·å–å¾—åˆ°ã€‚ è§ä¸‹é¢ä»£ç ï¼š spring mvcæœ€æ ¸å¿ƒç±» DispatcherServletå¦‚æœè¦è¯´è¿™ä¸ªç±»å°±éœ€è¦çœ‹ä¸€ä¸‹springmvcçš„æµç¨‹å›¾ ; psï¼šæš‚æ—¶ä¸çŸ¥åˆ°è¿™ä¸ªåœ°æ–¹æœ‰ä»€ä¹ˆç”¨ åœ¨è¿™é‡Œä¹‹å‰ DispathcerServlet å°†ä¼šwebapplicationcontextçš„å­—ç¬¦ä¸²å¼•ç”¨æ”¾å…¥javaä¸­ è§£é‡Šä¸€ä¸‹å…¶ä¸­çš„å„ç§ç»„ä»¶ HandlerMapping è¿™ä¸ªç±»è§£å†³äº† urlåœ°å€æ˜ å°„åˆ°å¯¹åº”çš„å¤„ç†ç±»ä¸­ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªå®ç°RequestMappingHandlerMapping-ä¸º@RequestMapping æ³¨è§£æä¾›æ”¯æŒ ï¼ŒSimpleUrlHandlerMappingï¼Œå®ç°ç®€å•çš„urlåœ°å€æ˜ å°„ é€šä¿—ç‚¹è¯´è¿™ä¸ªæ–¹æ³•åœ¨è®¾è®¡çš„æ—¶å€™ç›¸å½“äºä¸€ä¸ªè·¯ç”±ï¼Œé€šè¿‡å‰ç«¯è·å–çš„urlåœ°å€ç­‰åˆ°å¯¹åº”çš„handlerMappingï¼Œä¹‹åå†æ ¹æ®è¿™ä¸ªhandlermappingè·å–handleradapter HandlerExceptionResolver è¿™ä¸ªæ˜¯è¯•å›¾è¿”å›çš„å¼‚å¸¸å¤„ç†åŒ…æ‹¬ç›¸å…³çš„é”™è¯¯å¤„ç†æ–¹æ³• â€“ é€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥å®ç°å…¨å±€çš„å¼‚å¸¸æ•è· HandlerIntercepter Print(a â€¦interface{}) (nPrint(a â€¦interface{}) (n å¤„ç†ç›¸å…³çš„æ¥å£è¿›è¡Œæ‹¦æˆª HandlerAdapter ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ï¼Œå°†è¯•å›¾çš„æ˜ å°„ç”±æŒ‡å®šçš„æ¥å£å¤„ç† å„ç§resolver æä¾›è§†å›¾è§£æå±•ç¤ºçš„åŠŸèƒ½ LocaleResolver, LocaleContextResolverï¼ŒThemeResolverï¼ŒMultipartResolver FlashMapManager å¤„ç†flashçš„æ—¶å€™ä½¿ç”¨çš„ ä¼°è®¡ç”¨ä¸åˆ°äº† spring mvc çš„ Interception æ‹¦æˆªå™¨åœ¨spring MVC ä¸­å£°æ˜springmvc çš„æ–¹æ³•æœ‰å¦‚ä¸‹å‡ ç§ï¼š å®ç°HandlerInterceptoræ¥å£æˆ–è€…å®ç°HandlerInterceptorAdapter æŠ½è±¡ç±» å®ç°WebRequestInterceptoræ¥å£ï¼Œæˆ–è€…å®ç°äº†WebRequestInterceptorçš„ç±» HandlerInterceptor æ¥å£æ–¹æ³•(1)boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handle)æ–¹æ³•ï¼Œè¿™ä¸ªå°†ä¼šåœ¨è¯·æ±‚ä¼ å…¥ä¹‹å‰è¿›è¡Œç›¸å…³çš„å¤„ç†ï¼Œå¦‚æœè¿”å›å€¼æ˜¯trueï¼Œå°†ä¼šè‡ªåŠ¨çš„è¿›è¡Œé“¾å¼è°ƒç”¨å…¶ä»–æŒ‰ç…§é¡ºåºæ‰§è¡Œçš„å®šæ—¶å™¨ï¼Œå¦åˆ™å°†ä¼šç»ˆæ­¢è°ƒç”¨controllå’Œå…¶ä»–æ‹¦æˆªå™¨ã€‚ (2) postHandle (HttpServletRequest request, HttpServletResponse response, Object handle, ModelAndView modelAndView) æ–¹æ³•,è¿™ä¸ªæ–¹æ³•å°†ä¼šåœ¨å¤„ç†å™¨æ‰§è¡Œå®Œåè¿›è¡Œå¤„ç†ï¼Œå’ŒpreHandleçš„æ‰§è¡Œæ–¹æ³•ï¼Œæ³¨æ„è¿™ä¸ªæ–¹æ³•å°†ä¸ä¼šè‡ªåŠ¨æ‹¦æˆª@requsetBodyæ³¨è§£ResponseEntity æ³¨æ„è¿™é‡Œï¼šï¼ˆ1ï¼‰å’Œï¼ˆ2ï¼‰çš„ç¬¬ä¸‰ä¸ªå‚æ•° handle å®˜æ–¹çš„è§£é‡Šæ˜¯@controlleræ ‡è®°çš„æœ¬èº«æˆ–è€…ä½¿ç”¨HandleMethodè¿™ä¸ªç±»ï¼Œå…¶å®è¿™é‡Œæ˜¯springmvc è‡ªå·±å¢å¼ºçš„æ–¹æ³•ï¼Œ å¼•ç”³:ResponseEntity è¿™ä¸ªæ˜¯springä¸­å¯¹ç›¸å…³htttpè¯·æ±‚çš„å°è£…,æä¾›äº†å°è£…åŒ…å¤´,å°è£…httpåè®®bodyå­—æ®µä¸­çš„å†…å®¹çš„åŠŸèƒ½ ResponseEntity è¯¦è§£ï¼š è¿™ä¸ªç±»å…¶å®æ˜¯å¯¹ httpè¯·æ±‚çš„ä¸€ä¸ªå°è£…ï¼Œå°è£…äº†httpçš„æŠ¥å¤´ï¼ŒçŠ¶æ€ç ï¼Œhttp code ç­‰æ•°æ®ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ç§é€šä¿¡åè®® å¦‚æœä½¿ç”¨çš„ä¸æ˜¯stringç±»å‹ï¼Œé‚£ä¹ˆå°†ä¼šæ˜¯ä¸€ç§ç±»ä¼¼rpcåè®® å½“ä½¿ç”¨stringç±»å‹çš„æ—¶å€™å°±å’Œ@ResponceBody+@ResponseStatus(æ‰‹åŠ¨è®¾ç½®httpcode) ç›¸åŒ (3)afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handle, Exception ex) æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¹Ÿæ˜¯éœ€è¦å½“å‰å¯¹åº”çš„Interceptor çš„preHandle æ–¹æ³•çš„è¿”å›å€¼ä¸ºtrue æ—¶æ‰ä¼šæ‰§è¡Œã€‚è¯¥æ–¹æ³•å°†åœ¨æ•´ä¸ªè¯·æ±‚ç»“æŸä¹‹åï¼Œä¹Ÿå°±æ˜¯åœ¨DispatcherServlet æ¸²æŸ“äº†å¯¹åº”çš„è§†å›¾ä¹‹åæ‰§è¡Œã€‚è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦ä½œç”¨æ˜¯ç”¨äºè¿›è¡Œèµ„æºæ¸…ç†å·¥ä½œçš„ã€‚ é™¤äº†å®ç°HandlerInterceptorå¯ä»¥å®ç°æ‹¦æˆªå™¨ä¹‹å¤–ï¼Œä½¿ç”¨WebRequestInterceptor åŒæ ·å¯ä»¥å®ç°æ‹¦æˆªå™¨ï¼Œè¿™ä¸ªæ–¹æ³•å°è£…äº†ä½œç”¨åŸŸå¤„ç† (1)preHandle(WebRequest request) æ–¹æ³•ã€‚æ³¨æ„è¿™ä¸ªæ–¹æ³•æ²¡æœ‰è¿”å›ç›´ï¼Œä¸€èˆ¬ä¸»è¦ç”¨å®ƒæ¥è¿›è¡Œèµ„æºçš„å‡†å¤‡å·¥ä½œï¼Œå…¶ä¸­çš„webrequestå‚æ•°æ˜¯HttpServletRequestçš„åŠ å¼ºç‰ˆï¼Œå¯ä»¥ä½¿ç”¨setAttribute(name, value, scope)æ·»åŠ å‚æ•°åˆ°æŒ‡å®šçš„ä½œç”¨åŸŸä¸­ï¼Œscopeå‚æ•°æœ‰å¦‚ä¸‹çš„å‡ ä¸ªå€¼ï¼š 1. SCOPE_REQUEST ï¼šå®ƒçš„å€¼æ˜¯0 ï¼Œä»£è¡¨åªæœ‰åœ¨request ä¸­å¯ä»¥è®¿é—®ã€‚ 2. SCOPE_SESSION ï¼šå®ƒçš„å€¼æ˜¯1 ï¼Œå¦‚æœç¯å¢ƒå…è®¸çš„è¯å®ƒä»£è¡¨çš„æ˜¯ä¸€ä¸ªå±€éƒ¨çš„éš”ç¦»çš„sessionï¼Œå¦åˆ™å°±ä»£è¡¨æ™®é€šçš„sessionï¼Œå¹¶ä¸”åœ¨è¯¥sessionèŒƒå›´å†…å¯ä»¥è®¿é—®ã€‚ 3. SCOPE_GLOBAL_SESSION ï¼šå®ƒçš„å€¼æ˜¯2 ï¼Œå¦‚æœç¯å¢ƒå…è®¸çš„è¯ï¼Œå®ƒä»£è¡¨çš„æ˜¯ä¸€ä¸ªå…¨å±€å…±äº«çš„sessionï¼Œå¦åˆ™å°±ä»£è¡¨æ™®é€šçš„sessionï¼Œå¹¶ä¸”åœ¨è¯¥session èŒƒå›´å†…å¯ä»¥è®¿é—®ã€‚(2)postHandle(WebRequest request, ModelMap model) æ–¹æ³•ã€‚è¯¥æ–¹æ³•å°†åœ¨è¯·æ±‚å¤„ç†ä¹‹åï¼Œä¹Ÿå°±æ˜¯åœ¨Controller æ–¹æ³•è°ƒç”¨ä¹‹åè¢«è°ƒç”¨ï¼Œä½†æ˜¯ä¼šåœ¨è§†å›¾è¿”å›è¢«æ¸²æŸ“ä¹‹å‰è¢«è°ƒç”¨ï¼Œrequest å°±æ˜¯ä¼ é€’çš„è¯·æ±‚å‚æ•°ï¼Œmodelå°±æ˜¯è¿”å›çš„è§†å›¾(3)afterCompletion(WebRequest request, Exception ex) æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¼šåœ¨æ•´ä¸ªè¯·æ±‚å¤„ç†å®Œæˆï¼Œä¹Ÿå°±æ˜¯åœ¨è§†å›¾è¿”å›å¹¶è¢«æ¸²æŸ“ä¹‹åæ‰§è¡Œã€‚æ‰€ä»¥åœ¨è¯¥æ–¹æ³•ä¸­å¯ä»¥è¿›è¡Œèµ„æºçš„é‡Šæ”¾æ“ä½œã€‚è€ŒWebRequest å‚æ•°å°±å¯ä»¥æŠŠæˆ‘ä»¬åœ¨preHandle ä¸­å‡†å¤‡çš„èµ„æºä¼ é€’åˆ°è¿™é‡Œè¿›è¡Œé‡Šæ”¾ã€‚Exception å‚æ•°è¡¨ç¤ºçš„æ˜¯å½“å‰è¯·æ±‚çš„å¼‚å¸¸å¯¹è±¡ï¼Œå¦‚æœåœ¨Controller ä¸­æŠ›å‡ºçš„å¼‚å¸¸å·²ç»è¢«Spring çš„å¼‚å¸¸å¤„ç†å™¨ç»™å¤„ç†äº†çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªå¼‚å¸¸å¯¹è±¡å°±æ˜¯æ˜¯null ã€‚ springmvc å¼‚å¸¸å¤„ç† HandlerExceptionResolverå¼‚å¸¸å¤„ç†ç”¨äºå¤„ç†@controll è¿™ç§æ¥å£æŠ›å‡ºçš„å„ç§å¼‚å¸¸ï¼Œä¸»è¦æœ‰å¦‚ä¸‹çš„å‡ ç§ SimpleMappingExceptionResolver å¼‚å¸¸ç±»åç§°å’Œé”™è¯¯è§†å›¾åç§°ä¹‹é—´çš„æ˜ å°„ã€‚ç”¨äºåœ¨æµè§ˆå™¨åº”ç”¨ç¨‹åºä¸­å‘ˆç°é”™è¯¯é¡µé¢ã€‚ DefaultHandlerExceptionResolver è§£å†³Spring MVCå¼•å‘çš„å¼‚å¸¸å¹¶å°†å®ƒä»¬æ˜ å°„åˆ°HTTPçŠ¶æ€ä»£ç ã€‚å¦è¯·å‚é˜…å¤‡ç”¨ResponseEntityExceptionHandlerå’ŒREST APIä¾‹å¤–ã€‚ ResponseStatusExceptionResolver æ ¹æ®@ResponseStatusæ³¨é‡Šä¸­çš„å€¼è§£å†³æ³¨é‡Šä¸­çš„å¼‚å¸¸å¹¶å°†å…¶æ˜ å°„åˆ°HTTPçŠ¶æ€ä»£ç ã€‚ ExceptionHandlerExceptionResolver é€šè¿‡è°ƒç”¨@ExceptionHandlerä¸€ä¸ª@Controlleræˆ–ä¸€ä¸ª @ControllerAdviceç±»ä¸­çš„æ–¹æ³•æ¥è§£å†³å¼‚å¸¸ã€‚è¯·å‚é˜…@ExceptionHandleræ–¹æ³•ã€‚ å¯¹äºå¼‚å¸¸å¤„ç†æ¥è¯´é€šå¸¸çš„è§£å†³ç»“æœæœ‰å¦‚ä¸‹çš„å‡ ç§æ–¹æ³• ä½¿ç”¨ModelAndView æŒ‡å‘é”™è¯¯è§†å›¾ã€‚ è¿”å›ç©ºçš„modelandview å¦‚æœå¼‚å¸¸è¢«å¤„ç† å¦‚æœå¼‚å¸¸æ²¡æœ‰è¢«è§£å†³ï¼Œå°†ä¼šä½¿ç”¨å¼‚å¸¸è°ƒç”¨è¿è¿›è¡Œå¤„ç†ï¼Œå¦‚æœè°ƒç”¨åˆ°æœ€åå°†ä¼šæŠ›å‡ºåˆ°servletä¸­ åœ¨spring mvc ä¸­é›†ä¸­è¿›è¡Œå¼‚å¸¸å¤„ç†çš„æœ‰ä¸‰ç§æ–¹æ³• ä½¿ç”¨@ResponseStatus æ³¨é‡Šä¸€ä¸ªå¼‚å¸¸ç±»ï¼Œå½“springä¸­æŠ›å‡ºè¿™ä¸ªå¼‚å¸¸çš„æ—¶å€™å°†ä¼šè‡ªåŠ¨çš„äº¤ç”±è¿™ä¸ªç±»å¤„ç†,å¹¶ä¸”å¯ä»¥åˆ¶å®šhttp codeå€¼ï¼Œæ¯”å¦‚ä¸‹é¢çš„æ–¹æ³•å°†ä¼šè·‘å‡º403é”™è¯¯ æ³¨æ„å¦‚æœè¿™ä¸ªæ³¨è§£ä½¿ç”¨åœ¨ ä¸€ä¸ªæ–¹æ³•ä¸Šçš„æ—¶å€™ ï¼Œ ä¸è®ºç»“æœå¦‚ä½•éƒ½å°†ä¼šæ”¾å›åˆ¶å®šçš„httpcode å¼‚å¸¸ 2.@ControllerAdvice å’Œ @ExceptionHandler è¿™ä¸¤ä¸ªæ³¨è§£åŒæ ·ç”¨äºå¼‚å¸¸å¤„ç† ï¼ˆ1ï¼‰@ExceptionHandler å½“ä¸€ä¸ªControllerä¸­æœ‰æ–¹æ³•åŠ äº†@ExceptionHandlerä¹‹åï¼Œè¿™ä¸ªControllerå…¶ä»–æ–¹æ³•ä¸­æ²¡æœ‰æ•è·çš„å¼‚å¸¸å°±ä¼šä»¥å‚æ•°çš„å½¢å¼ä¼ å…¥åŠ äº†@ExceptionHandleræ³¨è§£çš„é‚£ä¸ªæ–¹æ³•ä¸­ã€‚æ³¨æ„è¿™ä¸ªæ–¹æ³•è¦æœ‰ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å°±æ˜¯æŒ‡å®šè¦å¤„ç†çš„å¼‚å¸¸ ï¼ˆ2ï¼‰@ControllerAdvice å®ç°è¿™ä¸ªæ³¨è§£çš„ç±»å¯ä»¥è®©è¿™ä¸ªç±»ä¸­ @ExceptionHandleræ ‡è®°çš„æ–¹æ³•å®ç°å…¨è§‰å¼‚å¸¸ç›‘å¬ æœ€åå¯¹äºspringmvc å¦‚æœå¼‚å¸¸æ²¡æœ‰è¢«å¤„ç†ï¼Œspringæä¾›äº†é»˜è®¤çš„é¡µé¢å±•ç¤ºå¼‚å¸¸ï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹æ³•é…ç½®xml ï¼š åˆ¶å®šé»˜è®¤é”™è¯¯é¡µé¢ java ï¼š å¤„ç†url ViewResolver æä¾›äº†view åç§°åˆ°viewå®ä¾‹ä¹‹é—´çš„ç»‘å®šï¼Œå¹¶ä¸”å®ŒæˆçœŸæ­£è§†å›¾å±•ç¤ºä¹‹å‰å°†ç›¸å…³æ•°æ®è¿›è¡Œæ•´ç†çš„åŠŸèƒ½spring mvc ä¸­å°†ç›¸å…³çš„è§†å›¾å˜æˆä¸€ä¸ªç½‘é¡µç»å†çš„è¿‡ç¨‹ å°†SpringMVCæ§åˆ¶å™¨ä¸­çš„è¿”å›ç»“æœå°è£…æˆä¸€ä¸ªModelAndViewå¯¹è±¡ã€‚ é€šè¿‡SpringMVCä¸­çš„è§†å›¾è§£æå™¨ï¼Œä½¿ç”¨ViewResolverå¯¹æ§åˆ¶å™¨è¿”å›çš„ModelAndViewå¯¹è±¡è¿›è¡Œè§£æï¼Œå°†é€»è¾‘è§†å›¾è½¬æ¢æˆç‰©ç†è§†å›¾ã€‚ è°ƒç”¨Viewä¸­çš„render()æ–¹æ³•å¯¹ç‰©ç†è§†å›¾è¿›è¡Œæ¸²æŸ“ã€‚ å‡ ä¸ªä¸»è¦çš„è§†å›¾çš„ä»‹ç» AbstractCachingViewResolver: æœ€æŠ½è±¡çš„ç±»æä¾›äº†è§†å›¾ç¼“å­˜çš„åŠŸèƒ½ UrlBasedViewResolver: æä¾›äº†æ›´åŠ ç»†ç²’åº¦çš„urlæ§åˆ¶ï¼Œæ”¯æŒå‰ç¼€åç¼€ç­‰åŠŸèƒ½ï¼Œä½†æ˜¯ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å¿…é¡»åˆ¶å®šç›¸å…³çš„viewè§£æå·¥å…·ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯jspè§£æå·¥å…·InternalResourceViewï¼ˆå’Œå¯ä»¥ä½¿ç”¨å…¶ä»–çš„æ˜¯è§£æå·¥å…·æ¯”å¦‚FreeMarkerViewç­‰ï¼‰ï¼Œ å¹¶ä¸”æä¾›äº†é‡å®šå‘å’Œè½¬å‘çš„åŠŸèƒ½ InternalResourceViewResolverï¼šè¿™ä¸ªæ–¹æ³•æ˜¯ UrlBasedViewResolver çš„å­ç±»ï¼Œæ”¯æŒçˆ¶ç±»çš„æ‰€æœ‰åŠŸèƒ½ï¼ŒInternalResourceViewResolverä¼šæŠŠè¿”å›çš„è§†å›¾åç§°éƒ½è§£æä¸ºInternalResourceViewå¯¹è±¡ï¼Œå†…éƒ¨ä½¿ç”¨é‡å®šå‘çš„æ–¹æ³•ï¼Œå°†controllerè¿”å›çš„view åŒ…è£…æˆInternalResourceViewï¼Œ å¹¶ä¸”é‹å¸¦ä¸Šå‰ç¼€å’Œåç¼€ï¼ŒåŒæ—¶å†è½¬å‘å‡ºå» è§†å›¾è§£æé“¾ï¼šåœ¨SpringMVCä¸­å¯ä»¥åŒæ—¶å®šä¹‰å¤šä¸ªViewResolverè§†å›¾è§£æå™¨ï¼Œç„¶åå®ƒä»¬ä¼šç»„æˆä¸€ä¸ªViewResolveré“¾ã€‚å½“Controllerå¤„ç†å™¨æ–¹æ³•è¿”å›ä¸€ä¸ªé€»è¾‘è§†å›¾åç§°åï¼ŒViewResolveré“¾å°†æ ¹æ®å…¶ä¸­ViewResolverçš„ä¼˜å…ˆçº§æ¥è¿›è¡Œå¤„ç†ã€‚æ‰€æœ‰çš„ViewResolveréƒ½å®ç°äº†Orderedæ¥å£ï¼Œåœ¨Springä¸­å®ç°äº†è¿™ä¸ªæ¥å£çš„ç±»éƒ½æ˜¯å¯ä»¥æ’åºçš„ã€‚åœ¨ViewResolverä¸­æ˜¯é€šè¿‡orderå±æ€§æ¥æŒ‡å®šé¡ºåºçš„ï¼Œé»˜è®¤éƒ½æ˜¯æœ€å¤§å€¼ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‡å®šViewResolverçš„orderå±æ€§æ¥å®ç°ViewResolverçš„ä¼˜å…ˆçº§ï¼Œorderå±æ€§æ˜¯Integerç±»å‹ï¼Œorderè¶Šå°ï¼Œå¯¹åº”çš„ViewResolverå°†æœ‰è¶Šé«˜çš„è§£æè§†å›¾çš„æƒåˆ©ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªè¿›è¡Œè§£æçš„å°†æ˜¯ViewResolveré“¾ä¸­orderå€¼æœ€å°çš„é‚£ä¸ªã€‚å½“ä¸€ä¸ªViewResolveråœ¨è¿›è¡Œè§†å›¾è§£æåè¿”å›çš„Viewå¯¹è±¡æ˜¯nullçš„è¯å°±è¡¨ç¤ºè¯¥ViewResolverä¸èƒ½è§£æè¯¥è§†å›¾ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœè¿˜å­˜åœ¨å…¶ä»–orderå€¼æ¯”å®ƒå¤§çš„ViewResolverå°±ä¼šè°ƒç”¨å‰©ä½™çš„ViewResolverä¸­çš„orderå€¼æœ€å°çš„é‚£ä¸ªæ¥è§£æè¯¥è§†å›¾ï¼Œä¾æ­¤ç±»æ¨ã€‚å½“ViewResolveråœ¨è¿›è¡Œè§†å›¾è§£æåè¿”å›çš„æ˜¯ä¸€ä¸ªéç©ºçš„Viewå¯¹è±¡çš„æ—¶å€™ï¼Œå°±è¡¨ç¤ºè¯¥ViewResolverèƒ½å¤Ÿè§£æè¯¥è§†å›¾ï¼Œé‚£ä¹ˆè§†å›¾è§£æè¿™ä¸€æ­¥å°±å®Œæˆäº†ï¼Œåç»­çš„ViewResolverå°†ä¸ä¼šå†ç”¨æ¥è§£æè¯¥è§†å›¾ã€‚å½“å®šä¹‰çš„æ‰€æœ‰ViewResolveréƒ½ä¸èƒ½è§£æè¯¥è§†å›¾çš„æ—¶å€™ï¼ŒSpringå°±ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ spring é‡å®šå‘å†™æ³• spring mvc å¸¸ç”¨æ³¨è§£spring æä¾›äº†ä¸€æ•´å¥—æ³¨è§£æ¥ç®€åŒ–springç›¸å…³çš„é…ç½® @Controll å’Œ @RestControllerSpring MVCæä¾›äº†ä¸€ç§åŸºäºæ³¨é‡Šçš„ç¼–ç¨‹æ¨¡å‹ï¼Œå…¶ä¸­@Controllerå’Œ@RestControllerç»„ä»¶ä½¿ç”¨æ³¨é‡Šæ¥è¡¨ç¤ºè¯·æ±‚æ˜ å°„ï¼Œè¯·æ±‚è¾“å…¥ï¼Œå¼‚å¸¸å¤„ç†ç­‰ã€‚ å…¶ä¸­çš„@RestController æ˜¯@ResponseBodyå’Œ@Controlleræ³¨è§£çš„ä¸€ç§é›†åˆã€‚ æ³¨æ„ï¼šå¦‚æœä½¿ç”¨aopæ–¹æ³•å¯¹controller è¿›è¡Œå¢å¼ºçš„è¯è¯·ä½¿ç”¨class-based proxyingä»£ç†ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨äº†éspring contextå›è°ƒæ¥å£çš„æ–¹æ³•çš„æ—¶å€™ï¼Œéœ€è¦æ˜ç¡®çš„åˆ¶å®šç›¸å…³çš„é…ç½®ä¿¡æ¯ï¼štx:annotation-driven/, æ”¹å˜ä¸º <tx:annotation-driven proxy-target-class&#x3D;â€trueâ€&#x2F;>. @RequestMapping requestMapping:æœ‰ç®€åŒ–ç‰ˆçš„å„ç§æ³¨è§£@GetMappingï¼Œ@PostMappingï¼Œ@PutMappingï¼Œ@DeleteMappingï¼Œ@PatchMappingï¼ŒæŒ‡å®šäº†ç›¸å…³çš„methodæ–¹æ³•å¯¹åº”çš„å„ç§è¯·æ±‚ request è¯·æ±‚å¯ä»¥æ¥å—çš„è¯·æ±‚å¯ä»¥é€šè¿‡é€šé…ç¬¦æˆ–è€…globå‚æ•°çš„æ–¹æ³•è¿›è¡ŒåŒ¹é… spring mvc çš„åœ°å€åŒ¹é…æ–¹æ³•æ»¡è¶³ä¸€å®šçš„ç›¸å…³åŸåˆ™ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦è¿›è¡ŒåŒ¹é… Wildcard Description ï¼Ÿ åŒ¹é…ä»»ä½•å•å­—ç¬¦ * åŒ¹é…0æˆ–è€…ä»»æ„æ•°é‡çš„å­—ç¬¦ ** åŒ¹é…0æˆ–è€…æ›´å¤šçš„ç›®å½• æ³¨æ„ï¼šspringå°†ä¼šæŒ‰ç…§åŒ¹é…çš„å­—ç¬¦æœ€é•¿çš„é‚£ä¸ªè¿›è¡ŒåŒ¹é…ï¼Œæ¯”å¦‚&#x2F;**&#x2F;.jsp å’Œ&#x2F;app&#x2F;dir&#x2F;.jspï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå°†ä¼šåŒ¹é…åè€…ã€‚ æ³¨æ„ï¼šspring mvc çš„åŒ¹é…åŸåˆ™æ˜¯æŒ‰ç…§åç¼€åŒ¹é…çš„åŸåˆ™ï¼Œæ¯”å¦‚ä¸€ä¸ªurlåœ°å€ &#x2F;nameè¿™ä¸ªåœ°å€ï¼Œè¡¨ç¤ºçš„å°±æ˜¯&#x2F;name.*ï¼Œä¸€å®šç¨‹åº¦ä¸Šå®ç°äº†æ–‡ä»¶æ‰©å±•åå¼•ç”¨ å¦‚æœä½¿ç”¨äº†æ–‡ä»¶æ‰©å±•åç§°è¿™ç§ä¸œè¥¿å¦‚æœæƒ³è¦é…ç½®è¯·æŸ¥çœ‹å¦‚ä¸‹ä¸¤ä¸ªæ¥å£ï¼š åœ¨requestæ˜ å°„çš„æ–¹æ³•ä¸­å¯ä»¥æ¥æ”¶çš„æ•°æ®æ¥å—çš„å‡½æ•°ä½“ä¸­å¯ä»¥ä½¿ç”¨çš„æ³¨è§£å’Œå‚æ•° WebRequest, NativeWebRequest WebRequestæ˜¯Spring Web MVCæä¾›çš„ç»Ÿä¸€è¯·æ±‚è®¿é—®æ¥å£ï¼Œä¸ä»…ä»…å¯ä»¥è®¿é—®è¯·æ±‚ç›¸å…³æ•°æ®ï¼ˆå¦‚å‚æ•°åŒºæ•°æ®ã€è¯·æ±‚å¤´æ•°æ®ï¼Œä½†è®¿é—®ä¸åˆ°CookieåŒºæ•°æ®ï¼‰ï¼Œè¿˜å¯ä»¥è®¿é—®ä¼šè¯å’Œä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®ï¼›NativeWebRequestç»§æ‰¿äº†WebRequestï¼Œå¹¶æä¾›è®¿é—®æœ¬åœ°Servlet APIçš„æ–¹æ³•ã€‚ javax.servlet.ServletRequest, javax.servlet.ServletResponseï¼Œjavax.servlet.http.HttpSession javax æä¾›çš„å…·ä½“æ¥å£æ³¨æ„å…¶ä¸­çš„httpsession ï¼Œä¼šè¯è®¿é—®ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å¦‚æœå…è®¸å¤šä¸ªè¯·æ±‚åŒæ—¶è®¿é—®ä¼šè¯ï¼Œè¯·è€ƒè™‘å°†RequestMappingHandlerAdapterçš„â€œsynchronizeOnSessionâ€æ ‡å¿—è®¾ç½®ä¸ºâ€œtrueâ€ã€‚ HttpMethod è¿™ä¸ªå€¼ä¸­æœ‰ä¼ å…¥çš„æ–¹å¼ï¼Œæ¯”å¦‚getè¿˜æ˜¯post java.io.InputStream, java.io.Readerï¼Œjava.io.OutputStream, java.io.Writer è¯·æ±‚çš„åŸå§‹è¯·æ±‚æ•°æ®æµï¼Œå’ŒåŸå§‹è¿”å›æ•°æ® @PathVariableå’Œ@MatrixVariable ä½¿ç”¨{}è¡¨ç¤ºçš„urlè¯·æ±‚å¯¹åº”çš„ç›¸å…³å‚æ•°, @PathVariable æ²¡ä»€ä¹ˆå¥½è¯´çš„å…³é”®æ˜¯@MatrixVariable ï¼Œ è¿™ä¸ªæ³¨è§£å°†ä¼šè‡ªåŠ¨çš„åŒ¹é…url åœ°å€ä¸­ ;uuu&#x3D;123;iii&#x3D;333 è¿™ç§å‚æ•°ï¼Œå¹¶ä¸”ä¸€å®šçš„ç¨‹åº¦ä¸‹å¹¶ä¸éœ€è¦{jj}ä¸­æŒ‡å®šçš„åç§°æ¥åŒ¹é…ï¼Œå½“å‘ç”Ÿå‚æ•°å†²çªçš„æ—¶å€™å¯ä»¥ä½¿ç”¨pathVarå‚æ•°æŒ‡å®šåç§°ï¼Œç›®å‰æœ‰bugä¸è®°å½•äº† @PathVariable,@MatrixVariable,@RequestParamï¼Œ@RequestBodyï¼Œ@RequestHeaderï¼Œ@CookieValueï¼Œ@RequestPart,@ModelAttribute,@SessionAttribute,@RequestAttribute @PathVariable ,spring mvcæä¾›äº†ä¸€å¥—æ”¯æŒreastfulapiçš„æ–¹æ³•ï¼Œè¿™å¥—æ–¹æ³•å¯ä»¥ä½¿ç”¨{}+é€šé…ç¬¦çš„æ–¹å¼ï¼Œå°†urlä¸­çš„æ•°æ®ä¼ é€’åˆ°method å¯¹åº”çš„å‚æ•°ä¸­ æ³¨æ„ï¼š{}é‡Œé¢çš„å€¼å€¼ä¹Ÿå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œç›¸å…³çš„é…ç½®ï¼Œæ ¼å¼ï¼š{varName:regex} @MatrixVariableï¼Œè¿™ä¸ªæ³¨è§£å°†ä¼šè‡ªåŠ¨çš„åŒ¹é…urlåœ°å€ä¸­;uuu&#x3D;123;iii&#x3D;333è¿™ç§å‚æ•°ï¼Œå¹¶ä¸”ä¸€å®šçš„ç¨‹åº¦ä¸‹å¹¶ä¸éœ€è¦{jj}ä¸­æŒ‡å®šçš„åç§°æ¥åŒ¹é…ï¼Œå½“å‘ç”Ÿå‚æ•°å†²çªçš„æ—¶å€™å¯ä»¥ä½¿ç”¨pathVarå‚æ•°æŒ‡å®šåç§°ï¼Œç›®å‰æœ‰bugä¸è®°å½•äº† @RequestParamæ¥å£å°†ä¼šè‡ªåŠ¨çš„å°†ä¼ å…¥åˆ°æŒ‡å®šçš„åœ°å€ä¸­ å¦‚æœä½¿ç”¨è¿™ä¸ªæ³¨è§£æ ‡è¯†Map<String, String> or MultiValueMap<String, String>ï¼Œå°†ä¼šå°†æ‰€æœ‰çš„å±æ€§æ³¨å…¥è¿›æ¥Aï¼‰ å¸¸ç”¨æ¥å¤„ç†ç®€å•ç±»å‹çš„ç»‘å®šï¼Œé€šè¿‡Request.getParameter() è·å–çš„Stringå¯ç›´æ¥è½¬æ¢ä¸ºç®€å•ç±»å‹çš„æƒ…å†µï¼ˆ Stringâ€“> ç®€å•ç±»å‹çš„è½¬æ¢æ“ä½œç”±ConversionServiceé…ç½®çš„è½¬æ¢å™¨æ¥å®Œæˆï¼‰ï¼›å› ä¸ºä½¿ç”¨request.getParameter()æ–¹å¼è·å–å‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥å¤„ç†get æ–¹å¼ä¸­queryStringçš„å€¼ï¼Œä¹Ÿå¯ä»¥å¤„ç†postæ–¹å¼ä¸­ body dataçš„å€¼ï¼›Bï¼‰ç”¨æ¥å¤„ç†Content-Type: ä¸º application&#x2F;x-www-form-urlencodedç¼–ç çš„å†…å®¹ï¼Œæäº¤æ–¹å¼GETã€POSTï¼›C) è¯¥æ³¨è§£æœ‰ä¸¤ä¸ªå±æ€§ï¼š valueã€requiredï¼› valueç”¨æ¥æŒ‡å®šè¦ä¼ å…¥å€¼çš„idåç§°ï¼Œrequiredç”¨æ¥æŒ‡ç¤ºå‚æ•°æ˜¯å¦å¿…é¡»ç»‘å®šï¼› @RequestBody è¯¥æ³¨è§£å¸¸ç”¨æ¥å¤„ç†Content-Type: ä¸æ˜¯application&#x2F;x-www-form-urlencodedç¼–ç çš„å†…å®¹ï¼Œä¾‹å¦‚application&#x2F;json, application&#x2F;xmlç­‰ï¼›å®ƒæ˜¯é€šè¿‡ä½¿ç”¨HandlerAdapter é…ç½®çš„HttpMessageConvertersæ¥è§£æpost data bodyï¼Œç„¶åç»‘å®šåˆ°ç›¸åº”çš„beanä¸Šçš„ã€‚ ä½¿ç”¨ï¼šHttpMessageConverteræ¥å£ï¼Œéœ€è¦å¼€å¯<mvc:annotation-driven &#x2F;>ã€‚ AnnotationMethodHandlerAdapterå°†ä¼šåˆå§‹åŒ–7ä¸ªè½¬æ¢å™¨ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨AnnotationMethodHandlerAdapterçš„getMessageConverts()æ–¹æ³•æ¥è·å–è½¬æ¢å™¨çš„ä¸€ä¸ªé›†åˆ Listï¼Œè¿™7ä¸ªè½¬åŒ–å™¨å¦‚ä¸‹ï¼š PS:Springé»˜è®¤çš„jsonåè®®è§£æç”±Jacksonå®Œæˆã€‚ è¿™ç§æ–¹å¼çš„æ—¶å€™é»˜è®¤ä½¿ç”¨çš„å°±æ˜¯jsonè§£æã€‚è¿™ä¸ªJackSonéœ€è¦è¿›è¡Œmavené…ç½® é—®é¢˜ å¦‚ä½•æ‰©å±• psï¼šå¦‚æœä½¿ç”¨xml æ–¹å¼ï¼Œéœ€è¦ä½¿ç”¨æ³¨è§£ æ³¨æ„ è¿™é‡Œå¦‚æœè¦ä½¿ç”¨æ³¨æ„spring mvc ç¯å¢ƒçš„é…ç½® ä½¿ç”¨xml è¿›è¡Œé…ç½® ä½¿ç”¨java è¿›è¡Œé…ç½® @RequestPart å’Œæ–‡ä»¶ä¸Šä¼ ç›¸å…³ï¼Œéš¾åº¦æœ‰ç‚¹å¤§ï¼Œå’Œhttpåè®®ç›¸å…³çš„æš‚æ—¶ä¸è€ƒè™‘ @RequestHeader å°†httpåè®®ä¸­ç›¸å…³çš„å¤´æ³¨å…¥åˆ°æŒ‡å®šçš„æ•°æ®ä¸­ @ModelAttribute @sessionAttribute @RequestAttributeï¼ˆå¤„ç†çš„æ˜¯è¡¨å•æ•°æ®ç±»å‹ï¼‰ åœ¨ä½¿ç”¨model view åœºæ™¯ä¸‹ï¼Œæœ‰å¦‚ä¸‹çš„ä¸€åº”ç”¨ å…¨å±€modelé…ç½®ï¼Œåœ¨è·å¾—è¯·æ±‚&#x2F;helloWorld åï¼ŒpopulateModelæ–¹æ³•åœ¨helloWorldæ–¹æ³•ä¹‹å‰å…ˆè¢«è°ƒç”¨ï¼Œå®ƒæŠŠè¯·æ±‚å‚æ•°ï¼ˆ&#x2F;helloWorld?abc&#x3D;textï¼‰åŠ å…¥åˆ°ä¸€ä¸ªåä¸ºattributeNameçš„modelå±æ€§ä¸­ï¼Œåœ¨å®ƒæ‰§è¡Œå helloWorldè¢«è°ƒç”¨ï¼Œè¿”å›è§†å›¾åhelloWorldå’Œmodelå·²ç”±@ModelAttributeæ–¹æ³•ç”Ÿäº§å¥½äº†ã€‚ æŒ‡æ´¾modelé…ç½® è¿”å› helloworld.doè§†å›¾ï¼Œæœ‰ä¸€ä¸ªmodel å‚æ•°æ˜¯attributeNameå’Œå€¼ hi ç»‘å®šapplication&#x2F;x-www-form-urlencoded æäº¤çš„è¯·æ±‚ä¸­ çš„å€¼åˆ°å¯¹è±¡ä¸­ æ”¯æŒuser.xxx,user2.ddd åµŒå¥—å¯¹åº”æ³• è¿™é‡Œæ³¨æ„ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„å°±æ˜¯@RequestBodyè¿™ä¸ªç»‘å®šçš„æ˜¯jsonå¯¹è±¡ @SessionAttribute å’Œ@SessionAttributes è¿™ä¸¤ä¸ªå¯¹å¯¹è±¡æ˜¯é…åˆModeAttributeä½¿ç”¨çš„ é½æ€»SessionAttributeåªæœ‰ä»Sessionä½œç”¨åŸŸä¸­å–æ•°æ®çš„ä½œç”¨è€Œ@SessionAttributes å°±æ˜¯å°†ModeAttributeä¸­åˆ¶å®škeyçš„æ•°æ®è®¾ç½®åˆ°Sessionä½œç”¨åŸŸä¸­æ¥ @RequestAttribute è¿™ä¸ªæ–¹æ³•åªèƒ½å–å‡º requestä½œç”¨åŸŸä¸­çš„æ•°æ® @CookieValue å’Œä¹‹å‰çš„ç›¸åŒï¼Œå°±æ˜¯å°†cookieä¸­ç›¸å…³çš„æ•°æ®æ‹¿å‡ºæ¥ HttpEntity HttpEntityæˆ–å¤šæˆ–å°‘ä¸ä½¿ç”¨@RequestBodyç›¸åŒï¼Œä½†åŸºäºå…¬å¼€è¯·æ±‚æ ‡å¤´å’Œä¸»ä½“çš„å®¹å™¨å¯¹è±¡ã€‚ æ³¨æ„è¿™ä¸ªæ–¹æ³•å¤šæ˜¯ç”¨äºpostè¯·æ±‚ç”¨æ¥é’ˆå¯¹ajaxåºåˆ—åŒ–çš„jsonå¯¹è±¡è§£æï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªgetbodyæ–¹æ³• @InitBinder springè‡ªå¸¦çš„æ•°æ®å¤„ç†æ¨¡å—(æ‰€æœ‰çš„è¡¨å•å¤„ç†ï¼Œç›¸åçš„å‚æ•°æœ‰Model) ç”±@InitBinderè¡¨ç¤ºçš„æ–¹æ³•ï¼Œå¯ä»¥å¯¹WebDataBinderå¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ã€‚WebDataBinderæ˜¯DataBinderçš„å­ç±»ï¼Œç”¨äºå®Œæˆç”±è¡¨å•åˆ°JavaBeanå±æ€§çš„ç»‘å®šã€‚@InitBinderæ–¹æ³•ä¸èƒ½æœ‰è¿”å›å€¼ï¼Œå®ƒå¿…é¡»ç››åä¸ºvoidã€‚@InitBinderæ–¹æ³•çš„å‚æ•°é€šå¸¸æ˜¯WebDataBinderï¼Œ@InitBinderå¯ä»¥å¯¹WebDataBinderè¿›è¡Œåˆå§‹åŒ–ã€‚ æ³¨æ„è¿™ä¸ªæ³¨è§£åªæ˜¯é’ˆå¯¹è¿™ä¸ªcontrollerä¸­çš„æ–¹æ³•èµ·ä½œç”¨ï¼Œæ— æ³•é’ˆå¯¹æ‰€æœ‰çš„controller æ³¨æ„WebDataBinderè¿™ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªæ–¹æ³•registerCustomEditor,è¿™ä¸ªæ–¹æ³•å°†ä¼šè‡ªåŠ¨çš„é…ç½®å±æ€§æ˜ å°„å™¨ï¼Œå°†ç›¸å…³çš„å±æ€§æ˜ å°„åˆ°æŒ‡å®šçš„ä½ç½®ï¼Œå±æ€§æ˜ å°„å™¨å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹æ³•è¿›è¡Œè‡ªå®šä¹‰å®ç°PropertyEditoræˆ–è€…é‡å†™PropertyEditorSupportå¯¹è±¡ä¸­çš„æ–¹æ³•ï¼Œæ³¨æ„è¿™ç§æ–¹æ³•åªèƒ½å®ç°stringåˆ°å¯¹è±¡çš„è½¬æ¢ setValueä¸­å°±æ˜¯è½¬åŒ–åçš„å¯¹è±¡ï¼ŒsetAsTextä¼ å…¥çš„å°±æ˜¯ä¼ å…¥çš„urlå­—ç¬¦ä¸² åŒæ—¶WebDataBinderè¿™ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªaddCustomFormatter å¯ä»¥ç›´æ¥ä½¿ç”¨formatterè¿›è¡Œå‚æ•°è½¬åŒ–æœ¬è´¨ä¸Šæ˜¯ç›¸åŒçš„ addCustomFormatteræœ¬è´¨ä¸Šè¿˜æ˜¯å’ŒregisterCustomEditoræ˜¯ä¸€æ ·çš„è§æºä»£ç  @RequestMapping æ–¹æ³•è¿”å›å€¼ä¸­çš„å‚æ•° @ResponseBody HttpEntity, ResponseEntity HttpEntity HttpEntityæˆ–å¤šæˆ–å°‘ä¸ä½¿ç”¨@RequestBodyç›¸åŒï¼Œä½†åŸºäºå…¬å¼€è¯·æ±‚æ ‡å¤´å’Œä¸»ä½“çš„å®¹å™¨å¯¹è±¡ã€‚ ResponseEntity è¿™ä¸ªç±»å…¶å®æ˜¯å¯¹ httpè¯·æ±‚çš„ä¸€ä¸ªå°è£…ï¼Œå°è£…äº†httpçš„æŠ¥å¤´ï¼ŒçŠ¶æ€ç ï¼Œhttp code ç­‰æ•°æ®ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ç§é€šä¿¡åè®® å¦‚æœä½¿ç”¨çš„ä¸æ˜¯stringç±»å‹ï¼Œé‚£ä¹ˆå°†ä¼šæ˜¯ä¸€ç§ç±»ä¼¼rpcåè®® å½“ä½¿ç”¨stringç±»å‹çš„æ—¶å€™å°±å’Œ@ResponceBody+@ResponseStatus ç›¸åŒ HttpHeaders è¿”å›ä¸€ä¸ªå°è£…çš„httpheadersçš„å¤´ï¼Œè¿™ä¸ªç±»æœ‰ä¸€ä¸ªsetæ–¹æ³•ï¼Œåˆ¶å®šæ–¹æ³•çš„å¤´å’Œå†…å®¹ï¼Œå¦‚æœæƒ³æ·±å…¥çš„ä½¿ç”¨ï¼Œéœ€è¦ç²¾é€šhttpåè®® string æœ€ç®€å•çš„ä¸€ä¸ªæ–¹æ³•ï¼Œspringå°†ä¼šä½¿ç”¨è¿™ä¸ªå­—ç¬¦ä¸²æ‰¾åˆ°å¯¹åº”çš„view java.util.Map, org.springframework.ui.Modelï¼Œ@ModelAttribute spring mvc modelandviewä½“ç³»çš„ä¸œè¥¿ ResponseBodyEmitter, SseEmitterï¼Œ StreamingResponseBody Reactive types â€” Reactor, RxJava, or others via ReactiveAdapterRegistry @ResponseStatus(HttpStatus.CREATED) åˆ¶å®šè¿”å›å€¼çš„å¤´éƒ¨ä¿¡æ¯, æ¯”å¦‚åˆ¶å®š401 402 è¿™ç§http code","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-springMVCè¿”å›å€¼å’Œè¯·æ±‚å€¼é¢„å…ˆå¤„ç†","url":"/2024/12/31/spring5-springMVCè¿”å›å€¼å’Œè¯·æ±‚å€¼é¢„å…ˆå¤„ç†/","content":"ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰çš„æ—¶å€™å¯èƒ½éœ€è¦å¯¹webæ¡†æ¶çš„è¿”å›å€¼è¿›è¡Œä¸€å®šçš„å¤„ç†ï¼Œä½†æ˜¯è¿™ç§æƒ…å†µä¸‹æœ‰ä¸€å®šçš„å±€é™æ€§æ¯”å¦‚ä¸‹é¢è¿™ç§ä½¿ç”¨æ‹¦æˆªå™¨çš„æƒ…å†µ æˆ‘ä»¬ç»§æ‰¿äº†HandlerUbterceotor æ¥å£å¹¶ä¸”å®ç°äº†postHandle æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°†ä¼šåœ¨controllerå¤„ç†å®Œä¹‹åå°†è¿”å›å€¼æ”¾å…¥handlerä¸­ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•æˆ‘ä»¬å¯ä»¥å¯¹handlerä¸­çš„å±æ€§è¿›è¡Œä¿®æ”¹ã€‚ ä½†æ˜¯è¿™æ ·æ˜¯æœ‰å±€é™æ€§çš„ï¼Œé¦–å…ˆæˆ‘ä»¬æ— æ³•å°è£…handler æ¯”å¦‚å°†è¿”å›çš„å€¼æ¢æˆå¦ä¸€ä¸ªç±»ï¼Œå…¶æ¬¡è¿™ä¸ªå¯¹è±¡æ˜¯object æˆ‘ä»¬éœ€è¦å¼ºåˆ¶è½¬åŒ–æ‰èƒ½ä½¿ç”¨ï¼Œè¿™æ ·å°±æœ‰äº†ä¸€å®šçš„å±€é™æ€§ã€‚ æ­£å› ä¸ºè¿™æ ·åœ¨spring4 æ·»åŠ äº†ä¸¤ä¸ªæ–°çš„æ¥å£ RequestBodyAdviceå’ŒResponseBodyAdvice å…¶ä¸­supportsæ–¹æ³•æ˜¯ä¸ºäº†åˆ¤æ–­æ˜¯å¦å¯ä»¥æ‰§è¡Œå¤„ç†é€»è¾‘ï¼Œå‰©ä¸‹çš„æ–¹æ³•å°±å°è£…æ¶åŠ£åœ¨å‚æ•°ç”Ÿæˆä¹‹å‰ä¹‹åç­‰æ“ä½œæ­¥éª¤å’Œæ‹¦æˆªå™¨ç›¸åŒï¼Œå°±ä¸åœ¨å¤šè¯´äº†","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-springäº‹åŠ¡æ“ä½œæ”¯æŒ","url":"/2024/12/31/spring5-springäº‹åŠ¡æ“ä½œæ”¯æŒ/","content":"springäº‹åŠ¡æ¦‚è¿° äº‹ç‰©ï¼šæ•°æ®åº“äº‹åŠ¡(Database Transaction) ï¼Œæ˜¯æŒ‡ä½œä¸ºå•ä¸ªé€»è¾‘å·¥ä½œå•å…ƒæ‰§è¡Œçš„ä¸€ç³»åˆ—æ“ä½œï¼Œè¦ä¹ˆå®Œå…¨åœ°æ‰§è¡Œï¼Œè¦ä¹ˆå®Œå…¨åœ°ä¸æ‰§è¡Œã€‚ä¸€ä¸ªé€»è¾‘å·¥ä½œå•å…ƒè¦æˆä¸ºäº‹åŠ¡ï¼Œå¿…é¡»æ»¡è¶³æ‰€è°“çš„ACIDï¼ˆåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§å’ŒæŒä¹…æ€§ï¼‰å±æ€§ åŸå­æ€§ï¼ˆAtomicï¼‰ï¼ˆAtomicity)ï¼šäº‹åŠ¡å¿…é¡»æ˜¯åŸå­å·¥ä½œå•å…ƒï¼›å¯¹äºå…¶æ•°æ®ä¿®æ”¹ï¼Œè¦ä¹ˆå…¨éƒ½æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ½ä¸æ‰§è¡Œã€‚ éš”ç¦»æ€§ï¼ˆInsulationï¼‰(Isolation)ï¼šç”±å¹¶å‘äº‹åŠ¡æ‰€ä½œçš„ä¿®æ”¹å¿…é¡»ä¸ä»»ä½•å…¶å®ƒå¹¶å‘äº‹åŠ¡æ‰€ä½œçš„ä¿®æ”¹éš”ç¦»ã€‚äº‹åŠ¡æŸ¥çœ‹æ•°æ®æ—¶æ•°æ®æ‰€å¤„çš„çŠ¶æ€ï¼Œè¦ä¹ˆæ˜¯å¦ä¸€å¹¶å‘äº‹åŠ¡ä¿®æ”¹å®ƒä¹‹å‰çš„çŠ¶æ€ï¼Œè¦ä¹ˆæ˜¯å¦ä¸€äº‹åŠ¡ä¿®æ”¹å®ƒä¹‹åçš„çŠ¶æ€ï¼Œäº‹åŠ¡ä¸ä¼šæŸ¥çœ‹ä¸­é—´çŠ¶æ€çš„æ•°æ®ã€‚ ä¸€è‡´æ€§ï¼ˆConsistentï¼‰(Consistency)ï¼šäº‹åŠ¡åœ¨å®Œæˆæ—¶ï¼Œå¿…é¡»ä½¿æ‰€æœ‰çš„æ•°æ®éƒ½ä¿æŒä¸€è‡´çŠ¶æ€ã€‚åœ¨ç›¸å…³æ•°æ®åº“ä¸­ï¼Œæ‰€æœ‰è§„åˆ™éƒ½å¿…é¡»åº”ç”¨äºäº‹åŠ¡çš„ä¿®æ”¹ï¼Œä»¥ä¿æŒæ‰€æœ‰æ•°æ®çš„å®Œæ•´æ€§ã€‚ä¸èƒ½åªä¿®æ”¹äº†ä¸€åŠ æŒä¹…æ€§ï¼ˆDurationï¼‰(Durabilityï¼‰ï¼šäº‹åŠ¡å®Œæˆä¹‹åï¼Œå®ƒå¯¹äºç³»ç»Ÿçš„å½±å“æ˜¯æ°¸ä¹…æ€§çš„ã€‚è¯¥ä¿®æ”¹å³ä½¿å‡ºç°è‡´å‘½çš„ç³»ç»Ÿæ•…éšœä¹Ÿå°†ä¸€ç›´ä¿æŒã€‚ springä¸­äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º PROPAGATION_REQUIREDâ€“æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±æ–°å»ºä¸€ä¸ªäº‹åŠ¡ã€‚è¿™æ˜¯æœ€å¸¸è§çš„é€‰æ‹©ã€‚ PROPAGATION_SUPPORTSâ€“æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œã€‚ PROPAGATION_MANDATORYâ€“æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚ PROPAGATION_REQUIRES_NEWâ€“æ–°å»ºäº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼ŒæŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚ PROPAGATION_NOT_SUPPORTEDâ€“ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚ PROPAGATION_NEVERâ€“ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚ springä¸­äº‹ç‰©çš„éš”ç¦»çº§åˆ« Serializableï¼šæœ€ä¸¥æ ¼çš„çº§åˆ«ï¼Œäº‹åŠ¡ä¸²è¡Œæ‰§è¡Œï¼Œèµ„æºæ¶ˆè€—æœ€å¤§ï¼› repeatable READï¼šä¿è¯äº†ä¸€ä¸ªäº‹åŠ¡ä¸ä¼šä¿®æ”¹å·²ç»ç”±å¦ä¸€ä¸ªäº‹åŠ¡è¯»å–ä½†æœªæäº¤ï¼ˆå›æ»šï¼‰çš„æ•°æ®ã€‚é¿å…äº†â€œè„è¯»å–â€å’Œâ€œä¸å¯é‡å¤è¯»å–â€çš„æƒ…å†µï¼Œä½†æ˜¯å¸¦æ¥äº†æ›´å¤šçš„æ€§èƒ½æŸå¤±ã€‚ READ COMMITTED:å¤§å¤šæ•°ä¸»æµæ•°æ®åº“çš„é»˜è®¤äº‹åŠ¡ç­‰çº§ï¼Œä¿è¯äº†ä¸€ä¸ªäº‹åŠ¡ä¸ä¼šè¯»åˆ°å¦ä¸€ä¸ªå¹¶è¡Œäº‹åŠ¡å·²ä¿®æ”¹ä½†æœªæäº¤çš„æ•°æ®ï¼Œé¿å…äº†â€œè„è¯»å–â€ã€‚è¯¥çº§åˆ«é€‚ç”¨äºå¤§å¤šæ•°ç³»ç»Ÿã€‚ Read Uncommittedï¼šä¿è¯äº†è¯»å–è¿‡ç¨‹ä¸­ä¸ä¼šè¯»å–åˆ°éæ³•æ•°æ®ã€‚ å¹¶å‘ä¸­å¯èƒ½å‘ç”Ÿçš„3ä¸­ä¸è®¨äººå–œæ¬¢çš„äº‹æƒ… Dirty readsâ€“è¯»è„æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯”å¦‚äº‹åŠ¡Açš„æœªæäº¤ï¼ˆè¿˜ä¾ç„¶ç¼“å­˜ï¼‰çš„æ•°æ®è¢«äº‹åŠ¡Bè¯»èµ°ï¼Œå¦‚æœäº‹åŠ¡Aå¤±è´¥å›æ»šï¼Œä¼šå¯¼è‡´äº‹åŠ¡Bæ‰€è¯»å–çš„çš„æ•°æ®æ˜¯é”™è¯¯çš„ã€‚ non-repeatable readsâ€“æ•°æ®ä¸å¯é‡å¤è¯»ã€‚æ¯”å¦‚äº‹åŠ¡Aä¸­ä¸¤å¤„è¯»å–æ•°æ®-total-çš„å€¼ã€‚åœ¨ç¬¬ä¸€è¯»çš„æ—¶å€™ï¼Œtotalæ˜¯100ï¼Œç„¶åäº‹åŠ¡Bå°±æŠŠtotalçš„æ•°æ®æ”¹æˆ200ï¼Œäº‹åŠ¡Aå†è¯»ä¸€æ¬¡ï¼Œç»“æœå°±å‘ç°ï¼Œtotalç«Ÿç„¶å°±å˜æˆ200äº†ï¼Œé€ æˆäº‹åŠ¡Aæ•°æ®æ··ä¹±ã€‚ phantom readsâ€“å¹»è±¡è¯»æ•°æ®ï¼Œè¿™ä¸ªå’Œnon-repeatable readsç›¸ä¼¼ï¼Œä¹Ÿæ˜¯åŒä¸€ä¸ªäº‹åŠ¡ä¸­å¤šæ¬¡è¯»ä¸ä¸€è‡´çš„é—®é¢˜ã€‚ä½†æ˜¯non-repeatable readsçš„ä¸ä¸€è‡´æ˜¯å› ä¸ºä»–æ‰€è¦å–çš„æ•°æ®é›†è¢«æ”¹å˜äº†ï¼ˆæ¯”å¦‚totalçš„æ•°æ®ï¼‰ï¼Œä½†æ˜¯phantom readsæ‰€è¦è¯»çš„æ•°æ®çš„ä¸ä¸€è‡´å´ä¸æ˜¯ä»–æ‰€è¦è¯»çš„æ•°æ®é›†æ”¹å˜ï¼Œè€Œæ˜¯ä»–çš„æ¡ä»¶æ•°æ®é›†æ”¹å˜ã€‚æ¯”å¦‚Select account.id where account.name&#x3D;â€ppgogo*â€,ç¬¬ä¸€æ¬¡è¯»å»äº†6ä¸ªç¬¦åˆæ¡ä»¶çš„idï¼Œç¬¬äºŒæ¬¡è¯»å–çš„æ—¶å€™ï¼Œç”±äºäº‹åŠ¡bæŠŠä¸€ä¸ªå¸å·çš„åå­—ç”±â€ddâ€æ”¹æˆâ€ppgogoâ€ï¼Œç»“æœå–å‡ºæ¥äº†7ä¸ªæ•°æ®ã€‚ springä¸­å…¶ä¸­äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º-åœ¨ä»€ä¹ˆæ—¶å€™æ·»åŠ äº‹åŠ¡ springä¸­äº‹åŠ¡çš„ä½¿ç”¨æ–¹æ³•ä½¿ç”¨é˜¿é‡Œæ•°æ®åº“é“¾æ¥æ± è¿›è¡Œé…ç½®ï¼Œè¿™æ˜¯ä¸‹é¢æ ·ä¾‹ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ åœ¨springæ¡†æ¶ä¸­ï¼Œäº‹åŠ¡çš„å®ç°åŸç†ï¼šé¦–å…ˆå®ç°ä¸€ä¸ªäº‹åŠ¡çš„ç®¡ç†ç±» DataSourceTransactionManager ç„¶åä½¿ç”¨springå†…ç½®çš„æ•°æ®åº“å°è£…ç±»è¿›è¡Œç›¸å…³çš„æ“ä½œï¼šJdbcTemplateï¼Œä¹‹åä½¿ç”¨aopå°†äº‹åŠ¡ç®¡ç†ç›´æ¥æ³¨å…¥åˆ°éœ€è¦å®ç°äº‹åŠ¡çš„æ“ä½œç±»ä¸­ï¼Œä½¿ç”¨åˆ‡é¢å¢å¼ºï¼Œå½“å‘ç”Ÿå¼‚å¸¸çš„æ—¶å€™ï¼Œspringå°†ä¼šè‡ªåŠ¨çš„å°†ä¹‹å‰å°è£…çš„JDBCTempateè¿›è¡Œå›æ»šæ“ä½œ ä½¿ç”¨åŸºäºé…ç½®æ–‡ä»¶çš„é…ç½®æ–¹æ³• xmlé…ç½®æ–‡ä»¶ javaçš„æ•°æ®åº“æ“ä½œç±» java æµ‹è¯•æ–¹æ³• ä½¿ç”¨springæ³¨è§£çš„æ–¹æ³•è¿›è¡Œé…ç½® xmlé…ç½®æ–‡ä»¶ javaæ•°æ®åº“æ“ä½œç±» æµ‹è¯•ç±»","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-webflux(1)ç®€ä»‹","url":"/2024/12/31/spring5-webflux-1-ç®€ä»‹/","content":"","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-å¯¼å…¥èµ„æºæ–‡ä»¶","url":"/2024/12/31/spring5-å¯¼å…¥èµ„æºæ–‡ä»¶/","content":"spring5-å¯¼å…¥èµ„æºæ–‡ä»¶ä¸€èˆ¬æƒ…å†µä¸‹ä¸€äº›é…ç½®å±æ€§éƒ½æ˜¯ä½¿ç”¨é…ç½®æ–‡ä»¶è¿›è¡Œå¯¼å…¥çš„ï¼Œåœ¨ä¸€å®šçš„ç¨‹åº¦ä¸Šè¿›è¡Œäº†è§£è—•ï¼Œè¿™é‡Œæ•´ç†ä¸€ä¸‹java å’Œspringæ¡†æ¶åœ¨è·å–èµ„æºä¸Šçš„ä¸€äº›é…é…ç½® javaè¿›è¡Œèµ„æºçš„é…ç½® å‘ç‚¹ï¼šThread.currentThread().getContextClassLoader() å¯ä»¥è·å¾—é¡¹ç›®ç¼–è¯‘åçš„æ‰§è¡Œæ ¹ç›®å½•ç›¸å½“äº mavené¡¹ç›® çš„resourceï¼Œ è¿™ä¸€ç‚¹éå¸¸é‡è¦ ä½¿ç”¨springçš„bean.xmlé…ç½®æ–‡ä»¶å¯¼å…¥ç›¸å…³çš„é…ç½® spring å¢å¼ºé…ç½®æ–‡ä»¶å¤„ç†ä½¿ç”¨æ³¨è§£è¿›è¡Œç›¸å…³çš„å„ç§é…ç½® ä½¿ç”¨ java çš„@value å’Œ PropertySource æ³¨è§£ç»“åˆä½¿ç”¨ springboot-å¯¼å…¥èµ„æºæ–‡ä»¶å¢å¼ºspring boot é€šè¿‡æ³¨è§£çš„æ–¹æ³•å°†å„ç§å±æ€§é€šè¿‡è‡ªåŠ¨åŒ–çš„å½¢å¼åŠ è½½è¿›javabeanä¸­ï¼Œç®€åŒ–æ“ä½œã€‚ é…ç½®æ–‡ä»¶ @ConfigurationPropertiesæ³¨è§£å°†ä¼šå¯¹ è‡ªåŠ¨æ³¨å…¥ç›¸å…³é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§çœå» å‰ç¼€è‡ªåŠ¨çš„æ³¨å…¥åˆ°ç›¸å…³çš„é…ç½®æ–‡ä»¶ä¸­ å‡çº§ç‰ˆæ³¨è§£ @EnableConfigurationProperties(MyconfigProperties.class) ä¸€èˆ¬ç»“åˆ @configurationæ³¨è§£ä½¿ç”¨ â€”-å°†æŒ‡å®šçš„ç±»ä¼¼ä¸Šé¢javabeançš„bean è‡ªåŠ¨å®Œæˆå±æ€§æ³¨å…¥åŠŸèƒ½","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-å¼‚æ­¥è°ƒç”¨å’Œå®šæ—¶å™¨","url":"/2024/12/31/spring5-å¼‚æ­¥è°ƒç”¨å’Œå®šæ—¶å™¨/","content":"spring5-å¼‚æ­¥è°ƒç”¨å’Œå®šæ—¶å™¨ Eable*ç±»å‹çš„æ³¨è§£æ˜¯å’Œspring configurtionæ³¨è§£æ­é…ä½¿ç”¨çš„ç›®çš„æ˜¯å‡å°‘é…ç½®å’Œä»£ç æ•°é‡ @EnableAsync æ”¯æŒå¼‚æ­¥æ“ä½œ é…ç½®ç±» @EnableAsync javabean ç±» @Async æ‰§è¡Œä¸»å‡½æ•° ç»“æœï¼š ç»“è®ºï¼šå‡½æ•°å˜æˆä¸€éƒ¨æ‰§è¡Œéé˜»å¡å‹ @EnableScheduling å…è®¸è¿›è¡Œå®šæ—¶æ“ä½œ é…ç½®ç±» javabeanç±» æ³¨æ„ï¼šé™¤äº†cronæ ‡è®°çš„å…¶ä»–å…ƒç´ å¦‚æœæ²¡æœ‰ä½¿ç”¨iniiaDelayå‚æ•°å°†ä¼šæ‰§è¡Œä¸¤è¾¹ï¼ˆè°ƒç”¨ä¸€è¾¹ï¼Œæ²¡æœ‰è¿›è¡Œå»¶è¿Ÿä¸€éï¼‰ ï¼Œcronè¡¨è¾¾å¼åªæ”¯æŒå…­ä¸ªå‚æ•° cron è¡¨è¾¾å¼è¯¦è§£ ç¬¦å· Seconds Minutes Hours DayofMonth Month DayofWeek Year ï¼Œ Y Y Y Y Y Y Y â€“ Y Y Y Y Y Y Y * Y Y Y Y Y Y Y &#x2F; Y Y Y Y Y Y Y ? N N N Y N Y N L N N N Y N Y N W N N N Y N N N C N N N Y N Y N # N N N N N Y N ï¼šè¡¨ç¤ºåŒ¹é…è¯¥åŸŸçš„ä»»æ„å€¼ï¼Œå‡å¦‚åœ¨MinutesåŸŸä½¿ç”¨*, å³è¡¨ç¤ºæ¯åˆ†é’Ÿéƒ½ä¼šè§¦å‘äº‹ä»¶ã€‚ ? ï¼šåªèƒ½ç”¨åœ¨DayofMonthå’ŒDayofWeekä¸¤ä¸ªåŸŸã€‚å®ƒä¹ŸåŒ¹é…åŸŸçš„ä»»æ„å€¼ï¼Œä½†å®é™…ä¸ä¼šã€‚å› ä¸º3. DayofMonthå’ŒDayofWeekä¼šç›¸äº’å½±å“ã€‚ä¾‹å¦‚æƒ³åœ¨æ¯æœˆçš„20æ—¥è§¦å‘è°ƒåº¦ï¼Œä¸ç®¡20æ—¥åˆ°åº•æ˜¯æ˜ŸæœŸå‡ ï¼Œåˆ™åªèƒ½ä½¿ç”¨å¦‚ä¸‹å†™æ³•ï¼š 13 13 15 20 * ?, å…¶ä¸­æœ€åä¸€ä½åªèƒ½ç”¨ï¼Ÿï¼Œè€Œä¸èƒ½ä½¿ç”¨ï¼Œå¦‚æœä½¿ç”¨è¡¨ç¤ºä¸ç®¡æ˜ŸæœŸå‡ éƒ½ä¼šè§¦å‘ï¼Œå®é™…ä¸Šå¹¶ä¸æ˜¯è¿™æ ·ã€‚ â€“ :è¡¨ç¤ºèŒƒå›´ï¼Œä¾‹å¦‚åœ¨MinutesåŸŸä½¿ç”¨5-20ï¼Œè¡¨ç¤ºä»5åˆ†åˆ°20åˆ†é’Ÿæ¯åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ &#x2F; ï¼šè¡¨ç¤ºèµ·å§‹æ—¶é—´å¼€å§‹è§¦å‘ï¼Œç„¶åæ¯éš”å›ºå®šæ—¶é—´è§¦å‘ä¸€æ¬¡ï¼Œä¾‹å¦‚åœ¨MinutesåŸŸä½¿ç”¨5&#x2F;20,åˆ™æ„å‘³ç€5åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ï¼Œè€Œ25ï¼Œ45ç­‰åˆ†åˆ«è§¦å‘ä¸€æ¬¡. , ï¼šè¡¨ç¤ºåˆ—å‡ºæšä¸¾å€¼å€¼ã€‚ä¾‹å¦‚ï¼šåœ¨MinutesåŸŸä½¿ç”¨5,20ï¼Œåˆ™æ„å‘³ç€åœ¨5å’Œ20åˆ†æ¯åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ã€‚ L ï¼šè¡¨ç¤ºæœ€åï¼Œåªèƒ½å‡ºç°åœ¨DayofWeekå’ŒDayofMonthåŸŸï¼Œå¦‚æœåœ¨DayofWeekåŸŸä½¿ç”¨5L,æ„å‘³ç€åœ¨æœ€åçš„ä¸€ä¸ªæ˜ŸæœŸå››è§¦å‘ã€‚ W ï¼šè¡¨ç¤ºæœ‰æ•ˆå·¥ä½œæ—¥(å‘¨ä¸€åˆ°å‘¨äº”),åªèƒ½å‡ºç°åœ¨DayofMonthåŸŸï¼Œç³»ç»Ÿå°†åœ¨ç¦»æŒ‡å®šæ—¥æœŸçš„æœ€è¿‘çš„æœ‰æ•ˆå·¥ä½œæ—¥è§¦å‘äº‹ä»¶ã€‚ä¾‹å¦‚ï¼šåœ¨ DayofMonthä½¿ç”¨5Wï¼Œå¦‚æœ5æ—¥æ˜¯æ˜ŸæœŸå…­ï¼Œåˆ™å°†åœ¨æœ€è¿‘çš„å·¥ä½œæ—¥ï¼šæ˜ŸæœŸäº”ï¼Œå³4æ—¥è§¦å‘ã€‚å¦‚æœ5æ—¥æ˜¯æ˜ŸæœŸå¤©ï¼Œåˆ™åœ¨6æ—¥(å‘¨ä¸€)è§¦å‘ï¼›å¦‚æœ5æ—¥åœ¨æ˜ŸæœŸä¸€åˆ°æ˜ŸæœŸäº”ä¸­çš„ä¸€å¤©ï¼Œåˆ™å°±åœ¨5æ—¥è§¦å‘ã€‚å¦å¤–ä¸€ç‚¹ï¼ŒWçš„æœ€è¿‘å¯»æ‰¾ä¸ä¼šè·¨è¿‡æœˆä»½ LW ï¼šè¿™ä¸¤ä¸ªå­—ç¬¦å¯ä»¥è¿ç”¨ï¼Œè¡¨ç¤ºåœ¨æŸä¸ªæœˆæœ€åä¸€ä¸ªå·¥ä½œæ—¥ï¼Œå³æœ€åä¸€ä¸ªæ˜ŸæœŸäº”ã€‚ # ï¼šç”¨äºç¡®å®šæ¯ä¸ªæœˆç¬¬å‡ ä¸ªæ˜ŸæœŸå‡ ï¼Œåªèƒ½å‡ºç°åœ¨DayofMonthåŸŸã€‚ä¾‹å¦‚åœ¨4#2ï¼Œè¡¨ç¤ºæŸæœˆçš„ç¬¬äºŒä¸ªæ˜ŸæœŸä¸‰ã€‚","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-æ‰©å±•(ä¸€)sope(ç”Ÿå‘½å‘¨æœŸ)æ‰©å±•","url":"/2024/12/31/spring5-æ‰©å±•-ä¸€-sope-ç”Ÿå‘½å‘¨æœŸ-æ‰©å±•/","content":"","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-æ‰©å±•(äºŒ)application(é›†è£…ç®±æ‰©å±•)","url":"/2024/12/31/spring5-æ‰©å±•-äºŒ-application-é›†è£…ç®±æ‰©å±•-/","content":"","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-æ‰©å±•æ·±å…¥åˆ†æspringçš„è£…ç®±æ‰©å±•","url":"/2024/12/31/spring5-æ‰©å±•æ·±å…¥åˆ†æspringçš„è£…ç®±æ‰©å±•/","content":"BeanPostProcessor","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-æ•°æ®åº“æ”¯æŒ","url":"/2024/12/31/spring5-æ•°æ®åº“æ”¯æŒ/","content":"JdbcTemplate spring æ•°æ®åº“æ“ä½œåŸºç¡€ç±»è¿™ä¸ªç±»æ˜¯springè¿›è¡Œjdbcæ“ä½œçš„æ ¸å¿ƒï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•å°†èŠ‚çœæ•°æ®åº“æ“ä½œï¼Œå’Œé¿å…ä¸€äº›ä½çº§é”™è¯¯ï¼Œæ¯”å¦‚èµ„æºæ²¡å“Ÿé‡Šæ”¾ç­‰ç­‰ select æ“ä½œ update delete insertæ“ä½œ ä½¿ç”¨æ•°æ®æ“ä½œè¯­å¥è¿›è¡Œæ“ä½œçš„é€šç”¨æ–¹æ³•è¿™ä¸ªæ–¹æ³•å¯ä»¥æ‰§è¡Œä»»ä½•è¯­å¥ jdbcTemple åˆå§‹åŒ–ä¼ å…¥ä¸€ä¸ªæ•°æ®åº“é“¾æ¥çš„ç›¸å…³ä¿¡æ¯å’Œæ˜¯å¦ä½¿ç”¨å»¶è¿ŸåŠ è½½çš„æ–¹æ³• NamedParameterJdbcTemplateè¿™ä¸ªæ¥å£æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å­˜åœ¨ï¼Œåº•å±‚ä½¿ç”¨JDBCTemplateåŒæ—¶å°†ä¹‹å‰ä½¿ç”¨é€‚é…ç¬¦çš„ï¼Ÿè¿›è¡Œäº†æ›¿æ¢ è¿™ä¸ªæ¥å£çš„ä¸€ä¸ªé«˜çº§åº”ç”¨å°±æ˜¯ä½¿ç”¨ SqlParameterSource è¿›è¡Œåˆ†è£… ï¼Œ spring å®˜æ–¹æ–‡æ¡£ä¸­ä¸»è¦æä¾›äº†å¦‚ä¸‹çš„ä¸‰ç§æ–¹æ³•è¿›è¡Œç›¸å…³çš„æ“ä½œ DriverManagerDataSource spring å†…ç½®æ•°æ®åº“çš„å®ç° spring è¿›è¡Œæ‰¹å¤„ç†ä½¿ç”¨JDBCTempleteè¿›è¡Œæ‰¹å¤„ç† ä½¿ç”¨namedParameterJdbcTemplate è¿›è¡Œæ‰¹å¤„ç† ç»“è¯­ï¼š è¿™é‡Œçš„è¿™äº›ç‰¹æ€§å…¶å®å°±æ˜¯åœ¨ä½¿ç”¨ç›¸å…³çš„æŠ€æœ¯çš„æ—¶å€™æ„Ÿå…´è¶£æ‰çœ‹çš„ï¼ŒçœŸæ­£åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨ mybatisè¿™ç§æŒä¹…å±‚æ¡†æ¶æ¯”è¾ƒå¤š","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-æ¡ä»¶æ³¨è§£@Conditional","url":"/2024/12/31/spring5-æ¡ä»¶æ³¨è§£-Conditional/","content":"spring5-æ¡ä»¶æ³¨è§£@Conditional@Conditionalå°†ä¼šæŒ‰ç…§æ¡ä»¶è‡ªåŠ¨çš„åˆ›å»ºç›¸å…³çš„javabeanç±»å‹ ç»§æ‰¿Conditionæ¥å£åˆ›å»ºæ¡ä»¶åˆ¤æ–­ç±» ä¸€ä¸ªbeanç±»å‹ é…ç½®ç±» é…ç½®ç±»å°†ä¼šé€šè¿‡Conditionè¿”å›æ˜¯å¦æ˜¯trueè¿›è¡Œç›¸å…³åˆ¤æ–­å¦‚æœè¿”å›çš„ç»“æœæ˜¯trueå°†ä¼šè‡ªåŠ¨çš„è½½å…¥ç›¸å…³çš„é…ç½®","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"spring5-èµ„æºä½¿ç”¨","url":"/2024/12/31/spring5-èµ„æºä½¿ç”¨/","content":"Beanæ“ä½œå’ŒBeanWrapperBeanWrapper å®ç°äº†å¯¹beanæ›´åŠ ç»†è‡´çš„æ“ä½œè¿™ç§æ–¹æ³•å°†ä¼šè®©beançš„å„ç§æ“ä½œæ›´åŠ å®¹æ˜“å’Œæ–¹ä¾¿,å¹¶ä¸”æä¾›äº†é«˜çº§ä½¿ç”¨æ–¹æ³• è®¾ç½®å’Œè·å–åŸºæœ¬å’ŒåµŒå¥—çš„å±æ€§è®¾ç½®å’Œè·å–å±æ€§æ˜¯é€šè¿‡ä½¿ç”¨setPropertyValue(s)å’Œ getPropertyValue(s)ä¸¤ä¸ªé‡è½½å˜é‡éƒ½æœ‰çš„æ–¹æ³•å®Œæˆçš„ã€‚ så­—ç¬¦ä¸²æ”¯æŒçš„å±æ€§è§ä¸‹ è¡¨è¾¾ è¯´æ˜ name æŒ‡ç¤ºä¸nameæ–¹æ³•getName()æˆ–isName() å’Œç›¸å¯¹åº”çš„å±æ€§setName(..) account.name æŒ‡ç¤ºå¯¹åº”äºä¾‹å¦‚æ–¹æ³•æˆ–å±æ€§nameçš„å±æ€§çš„åµŒå¥—å±æ€§accountgetAccount().setName()getAccount().getName() account[2] æŒ‡ç¤ºç´¢å¼•å±æ€§çš„ç¬¬ä¸‰ä¸ªå…ƒç´ accountã€‚ç´¢å¼•å±æ€§å¯ä»¥æ˜¯ç±»å‹çš„arrayï¼Œä¹Ÿå¯ä»¥æ˜¯listå…¶ä»–è‡ªç„¶é¡ºåºçš„é›†åˆ account[COMPANYNAME] æŒ‡ç¤ºç”±Mapå±æ€§çš„é”®COMPANYNAMEç´¢å¼•çš„åœ°å›¾æ¡ç›®çš„å€¼account ä¸‹é¢çš„ä»£ç ç‰‡æ–­å±•ç¤ºäº†å¦‚ä½•æ£€ç´¢å’Œæ“ä½œçš„ä¸€äº›å®ä¾‹åŒ–å±æ€§çš„ä¸€äº›ä¾‹å­Companieså’ŒEmployeesï¼š","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"springboot2.0-æ·±å…¥springBoot-2.0çŸ¥è¯†ç‚¹æ•´ç†","url":"/2024/12/31/springboot2-0-æ·±å…¥springBoot-2-0çŸ¥è¯†ç‚¹æ•´ç†/","content":"spring ä¸ªæ€§åŒ–é…ç½®è‡ªå®šä¹‰æ¨ªå¹…æ¯”å¦‚åœ¨classpathä¸­å†™å…¥ä¸€ä¸ª banner.txtæ–‡ä»¶springbootå°†è‡ªåŠ¨çš„å°†è¿™ä¸ªæ–‡ä»¶æ‰“å°åˆ°å¼€å§‹è¿è¡Œçš„åœ°æ–¹ banner.txt è¿˜å¯ä»¥é’ˆå¯¹javaçš„MANIFEST.MFæ–‡ä»¶è¿›è¡Œä¸ªæ€§åŒ–é…ç½®æ¯”å¦‚ï¼š ${application.formatted-version}ï¼Œ${application.version} æ‰“å°åœ¨MANIFEST.MFæ–‡ä»¶ä¸­Implementation-Version: 1.0å­—æ®µçš„1.0ç‰ˆæœ¬å·ï¼Œå¦‚æœæ˜¯å‰è€…å°†ä¼šå¸¦ä¸Švå‰ç¼€ v1.0 ${spring-boot.formatted-version}ï¼Œ${spring-boot.version} æ‰“å°springçš„ç‰ˆæœ¬å·ï¼ŒåŒæ ·å‰è€…æœ‰å‰ç¼€ ${application.title} æ‰“å°åœ¨MANIFEST.MFæ–‡ä»¶ä¸­Implementation-Title: MyAppå­—æ®µä¸­çš„MyApp spï¼šå¦‚æœè¦ä»¥ç¼–ç¨‹æ–¹å¼ç”Ÿæˆæ¨ªå¹…ï¼Œåˆ™å¯ä»¥ä½¿ç”¨SpringApplication.setBannerï¼ˆâ€¦ï¼‰æ–¹æ³•ã€‚ä½¿ç”¨org.springframework.boot.Banneræ¥å£å¹¶å®ç°æ‚¨è‡ªå·±çš„printBannerï¼ˆï¼‰æ–¹æ³•ã€‚è¿˜å¯ä»¥ä½¿ç”¨spring.main.banner-modeå±æ€§æ¥ç¡®å®šæ¨ªå¹…æ˜¯å¦å¿…é¡»åœ¨System.outï¼ˆæ§åˆ¶å°ï¼‰ä¸Šæ‰“å°ï¼Œå‘é€åˆ°é…ç½®çš„è®°å½•å™¨ï¼ˆæ—¥å¿—ï¼‰ï¼Œè¿˜æ˜¯æ ¹æœ¬ä¸ç”Ÿæˆï¼ˆå…³é—­ï¼‰ yaml æ–‡ä»¶ä¸­ä½¿ç”¨çš„æ˜¯å¦‚ä¸‹çš„é…ç½® spring boot ä¸Šå±‚å¼‚å¸¸å¤„ç†æ¨¡å—FailureAnalyzersè¿™ä¸ªæ¨¡å—ç”¨æ¥å°è£…ä¸€äº›spring å†…ç½®çš„å¼‚å¸¸é—®é¢˜ï¼Œç”¨æ¥æ˜¾ç¤ºè§£å†³æ–¹æ¡ˆï¼Œæš‚æ—¶ä¸åšæ·±å…¥çš„ç ”ç©¶ ###spring boot æ ¸å¿ƒæ³¨è§£ spring boot æ˜¯spring é›¶é…ç½®çš„å‡çº§ï¼Œé€šè¿‡å„ç§æ³¨è§£å¢å¼ºäº†springå®¹å™¨ @SpringBootApplicationè¿™ä¸ªå…¶å®æ˜¯ä¸€ä¸ªèšåˆæ¥å£ï¼Œè¿™ä¸ªæ¥å£èšåˆäº†@SpringBootConfigurationï¼ˆå’ŒConfigurationæ³¨è§£ç›¸åŒï¼‰ï¼Œ@EnableAutoConfigurationï¼Œ@ComponentScanæ³¨è§£ï¼Œå®ç°äº†è‡ªåŠ¨åŒ–é…ç½®ç­‰åŠŸèƒ½ï¼ŒåŒæ ·å¯ä»¥å®ç°è‡ªå·±çš„æ–¹æ³•æ¥å®ç°è‡ªåŠ¨åŒ–é…ç½® @Configurationspring boot é¼“åŠ±ä½¿ç”¨javaé…ç½®ç±»çš„é…ç½®æ–¹æ³•ï¼Œå¦‚æœä¸€å®šè¦ä½¿ç”¨xmlçš„é…ç½®ï¼Œä¹ŸåŒæ ·å»ºè®®ä½¿ç”¨@Configurationæ³¨è§£å¹¶åŠ ä¸Šä¸‹é¢çš„æ³¨è§£ @ImportResource è¿™ä¸ªæ³¨è§£æ³¨è§£åœ¨javaç±»ä¸Šé¢ï¼Œé€šè¿‡importResourceçš„valueæˆ–è€…locationsæŒ‡å®šï¼Œæ–‡ä»¶çš„è·¯å¾„ï¼Œreaderæ˜¯ä¸€ä¸ªè§£æå™¨ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œé˜…è¯»å™¨å°†é€‚åº”æŒ‡å®šçš„èµ„æºè·¯å¾„ï¼šâ€œ.groovyâ€æ–‡ä»¶å°†ä½¿ç”¨GroovyBeanDefinitionReaderè¿›è¡Œå¤„ç†; è€Œæ‰€æœ‰å…¶ä»–èµ„æºå°†ä½¿ç”¨XmlBeanDefinitionReaderè¿›è¡Œå¤„ç†ã€‚ @Enable* ç³»åˆ—æ³¨è§£@Enable* ç³»åˆ—æ³¨è§£æ˜¯springbootå®ç°è‡ªåŠ¨åŒ–é…ç½®çš„æ ¸å¿ƒæ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•å°†è‡ªåŠ¨çš„å°†ç›¸å…³çš„éœ€è¦é…ç½®çš„æ–¹æ³•è¿›è¡Œé…ç½® å®˜æ–¹æ–‡æ¡£ä¸­ä»‹ç»çš„ï¼Œspringboot çš„è‡ªåŠ¨åŒ–é…ç½®æ˜¯éä¾µå…¥çš„æ–¹å¼ï¼Œè‡ªå·±å®ç°çš„æ–¹æ³•å°†ä¼šè¦†ç›–ç³»ç»Ÿå®ç°çš„æ–¹æ³•ã€‚å¦‚æœæƒ³è¦çŸ¥é“springbootåº”ç”¨äº†ä»€ä¹ˆè‡ªåŠ¨åŒ–é…ç½®ï¼Œè¯·ä½¿ç”¨debugæ¨¡å¼è¿è¡Œspringbootï¼Œå¹¶ä¸”æ‰“å°å‡ºspringbootçš„é…ç½®è°ƒç”¨æ—¥å¿— @EnableAutoConfiguration 2. @ComponentScanå¹¶ä¸æ˜¯springbootç‰¹æœ‰çš„æ¥å£ï¼Œåº”ä¸ºspringboot éœ€è¦springé›¶é…ç½®ç›¸å…³çš„åŠŸèƒ½ï¼Œæ‰€ä»¥è®°å½•åœ¨è¿™é‡Œï¼Œå¦‚æœæ²¡æœ‰å‚æ•°å°†ä¼šé€šè¿‡è¿™ä¸ªæ–¹æ³•ä½œä¸ºè·Ÿè·¯å¾„å‘ä¸‹æœç´¢è‡ªåŠ¨åŒ–é…ç½®çš„ç›¸å…³ä¿¡æ¯ @Import({ MyConfig.class, MyAnotherConfig.class })è¿™ä¸ªæ³¨è§£å¯ä»¥è‡ªå®šä¹‰é…ç½®éœ€è¦çš„é…ç½®ç±»ï¼Œä»è€Œå®ç°è‡ªå®šä¹‰ç±»ä¼¼@springbootapplicationæ³¨è§£","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"springboot2.0-æ·±å…¥springBoot-@Enablexxxæ³¨è§£å’Œ@importæ³¨è§£è§£æƒ‘","url":"/2024/12/31/springboot2-0-æ·±å…¥springBoot--Enablexxxæ³¨è§£å’Œ-importæ³¨è§£è§£æƒ‘/","content":"æ·±å…¥springBoot-@Enable***æ³¨è§£å’Œ@importæ³¨è§£è§£æƒ‘spring bootçš„è‡ªåŠ¨é…ç½®åŠŸèƒ½ç›¸å½“å¼ºæ‚ï¼Œå…¶å¼ºæ‚çš„æ›´æœ¬åœ¨äºæä¾›äº†Eable*** è¿™ç§è‡ªåŠ¨åŒ–é…ç½®ï¼Œä¹‹å‰çš„åšå®¢ï¼Œç®€è¦åˆ†æå¦‚ä½•è‡ªå®šä¹‰starterï¼Œè¿™é‡Œå¯¹ä»–è¿›è¡Œä¸€ä¸‹è¡¥å…… é¦–å…ˆæˆ‘ä»¬è§‚å¯Ÿ@SpringBootæ³¨è§£è¿™ä¸ªæ³¨è§£æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œå¥¹æä¾›è‡ªåŠ¨åŒ–é…ç½®çš„æ³¨è§£æ˜¯@EableAutoConfigurationæ³¨è§£ ç±»ä¼¼EableAutoConfigurationè¿™æ ·çš„@Eable***æ³¨è§£ï¼Œéƒ½ä¼šä½¿ç”¨@Importæ³¨è§£å¯¼å…¥ä¸€å†™è‡ªåŠ¨åŒ–é…ç½®beanï¼Œè®²ä¸€äº›è‡ªåŠ¨åŒ–é…ç½®ç±»è¿›è¡Œè‡ªåŠ¨å¯¼å…¥ @Importæ³¨è§£å¯¼å…¥é…ç½®æ–¹å¼çš„ä¸‰ç§ç±»å‹ ç¬¬ä¸€ç±»ï¼šç›´æ¥å¯¼å…¥é…ç½®ç±» ç›´æ¥å¯¼å…¥é…ç½®ç±»SchedulingConfigurationï¼Œè¿™ä¸ªç±»æ³¨è§£äº†@Configurationï¼Œä¸”æ³¨å†Œäº†ä¸€ä¸ªscheduledAnnotationProcessorçš„Bean ç¬¬äºŒç±»ï¼šä¾æ®æ¡ä»¶é€‰æ‹©é…ç½®ç±» AsyncConfigurationSelectoré€šè¿‡æ¡ä»¶æ¥é€‰æ‹©éœ€è¦å¯¼å…¥çš„é…ç½®ç±»ï¼Œ AsyncConfigurationSelectorçš„æ ¹æ¥å£ä¸ºImportSelectorï¼Œè¿™ä¸ªæ¥å£éœ€è¦é‡å†™selectImportsæ–¹æ³•ï¼Œåœ¨æ­¤æ–¹æ³•å†…è¿›è¡Œäº‹å…ˆæ¡ä»¶åˆ¤æ–­ã€‚ AdviceMode adviceMode å°±æ˜¯ è°ƒç”¨æ³¨è§£ä¸­çš„AdivceMode è‹¥adviceModeä¸ºPORXYï¼Œåˆ™è¿”å›ProxyAsyncConfigurationè¿™ä¸ªé…ç½®ç±»ã€‚ è‹¥activeModeä¸ºASPECTJï¼Œåˆ™è¿”å›AspectJAsyncConfigurationé…ç½®ç±»ã€‚ ç¬¬ä¸‰ç±»ï¼šåŠ¨æ€æ³¨å†ŒBean AspectJAutoProxyRegistrar å®ç°äº†ImportBeanDefinitionRegistraræ¥å£ï¼ŒImportBeanDefinitionRegistrarçš„ä½œç”¨æ˜¯åœ¨è¿è¡Œæ—¶è‡ªåŠ¨æ·»åŠ Beanåˆ°å·²æœ‰çš„é…ç½®ç±»ï¼Œé€šè¿‡é‡å†™æ–¹æ³•ï¼š å…¶ä¸­ï¼ŒAnnotationMetadataå‚æ•°ç”¨æ¥è·å¾—å½“å‰é…ç½®ç±»ä¸Šçš„æ³¨è§£ï¼›BeanDefinittionRegistryå‚æ•°ç”¨æ¥æ³¨å†ŒBeanã€‚","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"springboot2.0-æ·±å…¥springBoot-Mybatisæ•´åˆå’Œåˆ†æ","url":"/2024/12/31/springboot2-0-æ·±å…¥springBoot-Mybatisæ•´åˆå’Œåˆ†æ/","content":"æ·±å…¥springBoot-Mybatisæ•´åˆå’Œåˆ†æä¹‹å‰åšè¿‡springBootæ¡†æ¶çš„è‡ªå®šä¹‰starteré…ç½®ï¼Œè¿™æ¬¡é€šè¿‡é…ç½®springbootå’ŒMybatisï¼Œæ·±å…¥æºç åœ¨è§£æä¸€ä¸‹ springå’Œmybatis æ•´åˆæ‰€éœ€è¦çš„ç›¸å…³çš„å„ç§ç±» SqlSessionFactoryBean SqlSessionFactory sqlSessionTemplate MapperFactoryBean MapperScannerConfigurer ç°åœ¨æŸ¥çœ‹ä¸€äº›spring-mybatisçš„starerç›¸å…³çš„config æ€»ç»“ï¼šå‘ç°ç›¸å…³çš„å…³é”®ç±»éƒ½è¢«è‡ªåŠ¨åŠ è½½äº† æŸ¥çœ‹mybatis Properties å‚æ•°é…ç½®ç±» æ€»ç»“ï¼šä¼ å…¥çš„å‚æ•°å°±ä½¿ç”¨xmlæ–‡ä»¶éœ€è¦ä¼ å…¥çš„å‚æ•°ï¼Œåªä¸è¿‡åœ¨ä½¿ç”¨sporingbootçš„æ—¶å€™ä½¿ç”¨soring.ymlé…ç½®æ–‡ä»¶çš„æ˜æ˜æ–¹å¼å‘ç”Ÿæ”¹å˜ æ•´åˆå®ä¾‹ è¿è¡Œç±» service dao å’Œ bean ç±» pom.xml mybatis configå’Œmappper yamlæ–‡ä»¶ å¼•ç”³ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨springçš„åŸç”Ÿbeanè¿›è¡Œç›¸å…³çš„é…ç½® åªéœ€è¦åœ¨æ³¨è§£ä¸ŠåŠ ä¸Š@ImportResource ï¼Œå¹¶åœ¨å…¶ä¸­å¼•å…¥è‡ªå·±éœ€è¦çš„xmlæ–‡ä»¶å°±è¡Œ bean.xml æ•°æ®åº“é…ç½®æ–‡ä»¶","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"springboot2.0-æ·±å…¥springBoot-å…¥é—¨","url":"/2024/12/31/springboot2-0-æ·±å…¥springBoot-å…¥é—¨/","content":"æ·±å…¥springBoot-å…¥é—¨å¼•ç”³ï¼šSpring Bootæ˜¯ç”±Pivotalå›¢é˜Ÿæä¾›çš„å…¨æ–°æ¡†æ¶ï¼Œå…¶è®¾è®¡ç›®çš„æ˜¯ç”¨æ¥ç®€åŒ–æ–°Springåº”ç”¨çš„åˆå§‹æ­å»ºä»¥åŠå¼€å‘è¿‡ç¨‹ã€‚è¯¥æ¡†æ¶ä½¿ç”¨äº†ç‰¹å®šçš„æ–¹å¼æ¥è¿›è¡Œé…ç½®ï¼Œä»è€Œä½¿å¼€å‘äººå‘˜ä¸å†éœ€è¦å®šä¹‰æ ·æ¿åŒ–çš„é…ç½®ã€‚ç”¨æˆ‘çš„è¯æ¥ç†è§£ï¼Œå°±æ˜¯spring bootå…¶å®ä¸æ˜¯ä»€ä¹ˆæ–°çš„æ¡†æ¶ï¼Œå®ƒé»˜è®¤é…ç½®äº†å¾ˆå¤šæ¡†æ¶çš„ä½¿ç”¨æ–¹å¼ï¼Œå°±åƒmavenæ•´åˆäº†æ‰€æœ‰çš„jaråŒ…ï¼Œspring bootæ•´åˆäº†æ‰€æœ‰çš„æ¡†æ¶ï¼ˆä¸çŸ¥é“è¿™æ ·æ¯”å–»æ˜¯å¦åˆé€‚ï¼‰ã€‚ æ ¸å¿ƒæ³¨è§£@SpringBootApplication @SpringBootApplicationæ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œæ•´åˆäº†@EnableAutoConfigurationï¼Œ@ComponentScanï¼Œ@Configurationï¼Œå…¶ä¸­@EnableAutoConfigurationä¼šæ‰«æåŒ…è¿›è¡Œç›¸å…³çš„javabeançš„é…ç½®ç­‰ æ ·ä¾‹ springbootçš„é…ç½®æ–‡ä»¶ï¼ˆapplication.properties or applicatin.yamlï¼‰åœ¨springbootä¸­å¯ä»¥æŒ‡å®š @PropertySource æ³¨è§£è¿›è¡Œæ‰‹åŠ¨å¯¼å…¥spring booté…ç½®çš„æ–‡ä»¶ï¼ˆé…ç½®æ–‡ä»¶åœ°å€æ•°ç»„ï¼‰ æ­¤å¤–@PropertySourceæ³¨è§£è¿˜èƒ½å’Œ@Value å’Œ @ConfigureProperties æ³¨è§£é…åˆä½¿ç”¨ï¼Œä¸ºå…ƒç´ æ·»åŠ å±æ€§ï¼Œï¼Œï¼ˆspringbootåœ¨å¯åŠ¨çš„æ—¶å€™å°†ä¼šè‡ªåŠ¨çš„æ·»åŠ application.propertieså’Œapplication.yamlé…ç½®æ–‡ä»¶ï¼‰ æ³¨æ„ï¼šå’Œ@valueè¿ç”¨ï¼Œåªç”¨SPElLè¡¨è¾¾å¼è¿›è¡Œå±æ€§çš„è‡ªåŠ¨è£…è½½ æ³¨æ„ï¼šå’Œ@ConfigurationPropertiesè¿ç”¨ æ³¨æ„è¦æä¾›getå’Œsetæ–¹æ³• æ³¨è§£ä½œç”¨æ˜¯è‡ªåŠ¨çš„å¯¼å…¥ springbootçš„é…ç½®æ–‡ä»¶ï¼ˆspring.propertiesæˆ–è€…spring.ymlï¼‰ä¸­çš„ç›¸å…³å±æ€§ spring boot è½½å…¥ bean.xmlé…ç½®æ–‡ä»¶sring boot æºè‡ªäº spring è‡ªç„¶ä¹Ÿèƒ½ä½¿ç”¨springåŸç”Ÿçš„ç›¸å…³é…ç½®æ–‡ä»¶ ä½¿ç”¨ImportResourceï¼ˆ{â€œclasspath:xxx.xmlâ€}ï¼‰ è‡ªåŠ¨çš„å¯¼å…¥ç›¸å…³çš„å„ç§é…ç½®æ–‡å®‰ spring boot éwebé¡¹ç›®å¯åŠ¨spring boot å¯åŠ¨æ–¹å¼æ˜¯ä½¿ç”¨SpringApplication.run(SpringbootmybatisApplication.class, args); è¿›è¡Œå¯åŠ¨ å½“ä½¿ç”¨è‡ªå·±çš„é€»è¾‘çš„æ—¶å€™ï¼Œéœ€è¦å®ç°CommandLineRunner æ¥å£å¹¶åœ¨runæ–¹æ³•ä¸­è¿›è¡Œç›¸å…³é€»è¾‘çš„ç¼–å†™ spring boot è‡ªåŠ¨åŒ–é…ç½®æ ‡ç­¾spring boot ä¾¿æ·å¡å¿«åº¦çš„æ ¹æœ¬åŸå› æ˜¯å› ä¸ºspring boot æä¾›è‡ªåŠ¨åŒ–çš„Eableæ ‡ç­¾ï¼Œ å’ŒåŠ¨æ€å¤„ç†@configurationé…ç½®ç±»é…ç½®çš„@conditionç›¸å…³æ³¨è§£ enable***ç±» @EnableConfigurationPropertiesï¼šå…³è”ä½¿ç”¨@ConfigurationPropertiesæ³¨è§£çš„ç±»ï¼Œç„¶è¿™ä¸ªç±»å¯ä»¥è¿›è¡Œåˆå§‹åŒ–å¹¶ä¸”å¯¼å…¥å®¹å™¨ä¸­ï¼Œä¸€èˆ¬ç”¨åœ¨è‡ªå®šä¹‰starer @EnableAutoConfigurationï¼šå¸Œæœ›é€šè¿‡ä¹‹å‰æ·»åŠ çš„jarä¾èµ–æ¥å®ç° è‡ªåŠ¨çš„é…ç½®ä½ çš„Spring Application. æ¯”å¦‚, å¦‚æœ HSQLDB åœ¨ä½ çš„ classpathä¸­, è€Œä¸”ä½ æ²¡æœ‰é…ç½®ä»»ä½•æ•°æ®åº“ç›¸å…³çš„bean,è¿™æ—¶æˆ‘ä»¬ä¼šè‡ªåŠ¨é…ç½®ä¸€ä¸ªå†…å­˜æ•°æ®åº“. ä½ åªèƒ½åŠ ä¸€ä¸ª @EnableAutoConfiguration æ³¨è§£. é€šå¸¸å»ºè®®åŠ åœ¨ä¸» @Configuration ç±»ä¸Š. æ³¨æ„äº†æŸ¥çœ‹æºä»£ç å¯ä»¥çŸ¥é“ï¼Œè¿™ä¸ªæ³¨è§£ç»„åˆç±» @importæ³¨è§£ï¼Œimportä¸€ä¸ªEnableAutoConfigurationImportSelector.classç±»ï¼Œè¿™ä¸ªç±»å®ç°äº†importæ¥å£ä¸­çš„import selectImports æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥è¿”å›ä¸€ä¸ª class.getClassName() æ•°ç»„ï¼Œç”¨æ¥å°†ç›¸å…³çš„beanå¯¼å…¥è¿›classä¸­ @EnableAspectJAutoProxyï¼š å¯åŠ¨springè‡ªåŠ¨aop ç›¸å½“ä¸€xmlæ–‡ä»¶ä¸­çš„aop:aspectj-autoproxy è®©@Aspectjæ³¨è§£ç”Ÿæ•ˆ @EnableSchedulingå’Œ@EnableAsync è§åšå®¢spring5æ¡†æ¶çŸ¥è¯†æ•´ç†-å¤šçº¿ç¨‹å’Œå®šæ—¶å™¨ æ³¨æ„ï¼šEnableAsync æ³¨è§£çš„configrutionç±»å¯ä»¥å®ç°ä¸€ä¸ªAsyncconfigæ¥å£å¹¶ä¸”å®ç° æ¥å£å®ç°ç±»ï¼Œè¿”å›ä¸€ä¸ªæ•°æ®è¿æ¥æ± Exeturor @EnableTransactionManagementå¼€èµ·è‡ªåŠ¨åŒ–äº‹åŠ¡é…ç½®<tx:annotation-driven transaction-manager&#x3D;â€myTransactionMamagerâ€&#x2F;> @Transactional æ ‡ç­¾æä¾›æ”¯æŒ conditionç±» ç»“åˆ configuurationæ³¨è§£å°½å¿ƒç»„åˆåˆ¤æ–­ç›¸å…³çš„é…ç½®æ˜¯å¦æœ‰æ•ˆ ConditionalOnBean å½“å­˜åœ¨æŒ‡å®šçš„cbeançš„æ—¶å€™ç”Ÿæ•ˆ ConditionalOnClass å½“å­˜åœ¨æŒ‡å®šçš„class æ–‡ä»¶æ˜¯ç”Ÿæ•ˆ ConditionalOnMissBean å½“ä¸å­˜åœ¨æŒ‡å®šçš„ beançš„æ—¶å€™ç”Ÿæ•ˆ ConditionalOnMissClass å½“ä¸å­˜åœ¨æŒ‡å®šçš„class æ—¶ç”Ÿæ•ˆ ConditionalOnExpression å½“ä½¿ç”¨çš„SpElè¡¨è¾¾æ˜¯trueçš„æ—¶å€™æ‰èƒ½è¿›è¡Œä½¿ç”¨ ConditionalOnJava æŒ‡å®šjavaç‰ˆæœ¬è¿›è¡Œé…ç½® ConditionalOnProperty å½“springboot å­˜åœ¨æŒ‡å®šçš„ç›¸å…³é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§çš„æ—¶å€™è¿›è¡Œç›¸å…³çš„é…ç½® ConditionalOnresource å½“æŒ‡å®šçš„èµ„æºå­˜åœ¨çš„æ—¶å€™è¿›è¡Œç›¸å…³çš„é…ç½® @ConditionalOnSingleCandidate å½“å‰çš„ç±»åœ¨å®¹å™¨ä¸­åªç”¨ä¸€ä¸ªçš„æ—¶å€™æ‰§è¡Œï¼Œ springbootçš„ä¾‹å­æ˜¯åŠ è½½äº‹åŠ¡æ§åˆ¶å™¨çš„æ—¶å€™è¿›è¡Œç›¸å…³çš„æ“ä½œ conditionä¾‹å­å’Œåˆ†æè§æ·±å…¥springBoot-è‡ªåŠ¨é…ç½®åŸç†å’Œæ‰‹åŠ¨å®ç°","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"springboot2.0-æ·±å…¥springBoot-è‡ªåŠ¨é…ç½®åŸç†å’Œæ‰‹åŠ¨å®ç°","url":"/2024/12/31/springboot2-0-æ·±å…¥springBoot-è‡ªåŠ¨é…ç½®åŸç†å’Œæ‰‹åŠ¨å®ç°/","content":"æ·±å…¥springBoot-è‡ªåŠ¨é…ç½®åŸç†å’Œæ‰‹åŠ¨å®ç°è¿™é‡Œæ·±å…¥çš„åˆ†æä¸€ä¸‹ä¸ºä»€ä¹ˆspring boot å¯ä»¥è¿›è¡Œ ç®€å•åŒ–é…ç½®, å¦‚ä½•è¿›è¡Œæ‰‹åŠ¨é…ç½® springå¦‚ä½•è¿›è¡Œç›¸å…³çš„é…ç½®springBootçš„è‡ªåŠ¨é…ç½®ä¸€èˆ¬é…ç½®çš„æºç åŒ…æ˜¯æ”¾ç½®åœ¨springboot-Autoconfig.jaråŒ…ä¸‹é¢çš„ åœ¨springbootè¿›è¡Œè¿è¡Œçš„æ—¶å€™ï¼Œ@SpringBootæ³¨è§£æä¾›äº†è‡ªåŠ¨å¯¼å…¥é…ç½®çš„@EableAutoConfiguration æ³¨è§£ æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ³¨è§£çš„æºä»£ç  åˆ†ææºä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œæ³¨è§£ä¸­ä½¿ç”¨äº†Importæ³¨è§£å°†EnableAutoConfigurationImportSelector.classè¿™ä¸ªç±»è¿›è¡Œè¿è¡Œï¼Œè¿™ä¸ªç±»å°†ä¼šè‡ªåŠ¨çš„æ£€æµ‹META&#x2F;spring.factoriesæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸­å£°æ˜äº†ç›¸å…³çš„å„ç§é…ç½® ä¸Šé¢æ–‡ä»¶ä¸­çš„å„é…ç½®ç±»ä¸­éƒ½ä¼šå‘ç°åœ¨springbootä¸­å£°æ˜çš„å„ç§é…ç½®æ³¨è§£ ï¼ˆåœ¨autoconfigure.configåŒ…ä¸‹é¢ï¼‰å¦‚@ConditionalOnProperty @ConditionalOnMissingBean åˆ†æä¸€ä¸‹æœ€åä¸€ä¸ªæ³¨è§£ å‘ç°ä½¿ç”¨OnWebApplicationCondition.class è¿™ä¸ªç±» ï¼Œæ‰¾ä¸€ä¸‹è¿™ä¸ªç±» è¿™ä¸ªç±»å°±æ˜¯å®ç°äº†conditionæ¥å£çš„æ ¹æœ¬ç±»å‹ æ€»ç»“ï¼šå¦‚æœè¦å®ç°è‡ªå®šé…ç½®ï¼Œå¹¶å°†è¿™ä¸ªé…ç½®å¥½çš„ç±»ä¹‹å‰ä½¿ç”¨conditionå„ç§åˆ¤æ–­æ–¹æ³•åŠä½ æƒ³å—¯åˆ¤æ–­ï¼Œç„¶åæ”¾å…¥spring.factoriesæ–‡ä»¶ä¸­å°±è¡Œï¼ˆæ³¨æ„é…ç½®ç±»å°±æ˜¯ä¸€ä¸ªä½¿ç”¨@configurationæ³¨è§£è¿›è¡Œæ ‡è®°é…ç½®ç±»-ä¹Ÿå°±æ˜¯è¯´ï¼ŒspringBootæ¡†æ¶ä½¿ç”¨è¿™ä¸ªé…ç½®ç±»è¿›è¡Œè‡ªåŠ¨èŠ±é…ç½®ï¼Œå¹¶å°†é…ç½®ç±»ä¸­çš„ç›¸å…³Beanæ–‡ä»¶æå–å‡ºæ¥æ”¾å…¥å…¬å…±å‘½åç©ºé—´ï¼‰ æ‰‹åŠ¨å®ç°ä¸€ä¸ªstarterå®ç°ä¸€ä¸ªstarterå…³é”®çš„ä¸€éƒ¨å°±æ˜¯è¦å®ç°configç±» å‚æ•°å¯¼å…¥ç±»ï¼šä½¿ç”¨è¿™ä¸ªç±»å°±æ˜¯ä¸ºäº†åœ¨ä¸Šé¢çš„ç”Ÿæˆbeançš„ç¯èŠ‚ä¸­åŠ¨æ€çš„è¿›è¡Œå¯¼å…¥ç›¸å…³çš„å‚æ•° ç”Ÿæˆçš„javabean ï¼Œ åœ¨springbootä¸­å®ç°åŠ¨æ€çš„èº«æˆç›¸å…³çš„å„ç§é…ç½®å‚æ•°æ³¨å…¥ç±»å‹,æ³¨æ„è¿™ä¸ªä½¿ç”¨äº†@ConfiguurationProperties æ³¨è§£çš„è¿™ä¸ªç±» ï¼Œè¿™ä¸ªç±»ä¸å•å•æä¾›äº†å±æ€§çš„è‡ªåŠ¨æ³¨å…¥åŠŸèƒ½è¿˜æä¾›äº†ï¼Œå¯¹å¤–é¢æš´éœ²é…ç½®æ–‡ä»¶ä¿¡æ¯çš„åŠŸèƒ½ æ¥ä¸‹æ¥å°±å¯ä»¥åœ¨ä½¿ç”¨mavenæ‰“åŒ…æˆjaråŒ…ï¼Œè¿›è¡Œå‘å¸ƒï¼Œæ³¨æ„å‘ç‚¹ï¼Œå¿…é¡»æ‰“æˆjaråŒ…ï¼Œå…¶æ¬¡è¦å…³é—­spring bootçš„mavenæ’ä»¶ï¼Œå› ä¸ºè¿™ä¸ªæ’ä»¶ä¼šå¼ºåˆ¶å°† å¿…æœ‰è¦å­˜åœ¨mainæ–¹æ³•å¦åˆ™å°†ä¼šå¯¼è‡´ç›¸å…³çš„mvn installå¤±è´¥ å…¶ä»–ç±»å°½å¿ƒå¼•ç”¨ï¼šé€šè¿‡ä¸Šé¢çš„åˆ†ææˆ‘ä»¬å·²ç»çŸ¥é“ç±»ï¼Œspring boot è¿›è¡Œç›¸å…³çš„é…ç½®çš„æ—¶å€™å…¶å®æ˜¯é€šè¿‡ä¸€ä¸ªspring.factories é…ç½®æ–‡ä»¶è¿›è¡Œç›¸å…³çš„é…ç½®çš„ï¼Œæ‰€ä»¥ï¼Œå½“æˆ‘ä»¬è¿›è¡Œè‡ªå®šä¸€é…ç½®çš„æ—¶å€™éœ€åœ¨resouceæ–‡ä»¶å¤¹ä¸‹æ–°å»ºMETE-INF&#x2F;spring.factories æ–‡ä»¶ï¼Œå¯¼å…¥è‡ªå·±å°½å¿ƒçš„ç›¸å…³é…ç½® å…¶ä»–classç±»","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"springboot2.0-æ·±å…¥springboot-å¯¼å…¥èµ„æºæ–‡ä»¶å¢å¼º","url":"/2024/12/31/springboot2-0-æ·±å…¥springboot-å¯¼å…¥èµ„æºæ–‡ä»¶å¢å¼º/","content":"æ·±å…¥springboot-å¯¼å…¥èµ„æºæ–‡ä»¶å¢å¼ºspring boot é€šè¿‡æ³¨è§£çš„æ–¹æ³•å°†å„ç§å±æ€§é€šè¿‡è‡ªåŠ¨åŒ–çš„å½¢å¼åŠ è½½è¿›javabeanä¸­ï¼Œç®€åŒ–æ“ä½œã€‚ é…ç½®æ–‡ä»¶ @ConfigurationPropertiesæ³¨è§£å°†ä¼šå¯¹ è‡ªåŠ¨æ³¨å…¥ç›¸å…³é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§çœå» å‰ç¼€è‡ªåŠ¨çš„æ³¨å…¥åˆ°ç›¸å…³çš„é…ç½®æ–‡ä»¶ä¸­ å‡çº§ç‰ˆæ³¨è§£ @EnableConfigurationProperties(MyconfigProperties.class) ä¸€èˆ¬ç»“åˆ @configurationæ³¨è§£ä½¿ç”¨ â€”-å°†æŒ‡å®šçš„ç±»ä¼¼ä¸Šé¢javabeançš„bean è‡ªåŠ¨å®Œæˆå±æ€§æ³¨å…¥åŠŸèƒ½","date":"2024-12-31","categories":["java"],"tags":["spring"]},{"title":"undertow-servletæ”¯æŒ","url":"/2024/12/31/undertow-servletæ”¯æŒ/","content":"undertow æ˜¯é€šè¿‡äº†servlet 4.0 è®¤è¯çš„æœåŠ¡å™¨åœ¨æœ¬è´¨ä¸Šæ˜¯æ”¯æŒservletæ ‡å‡†çš„","date":"2024-12-31","categories":["java"],"tags":["undertow"]},{"title":"undertow-xnio","url":"/2024/12/31/undertow-xnio/","content":"underttow æ˜¯redhat å¼€å‘çš„é«˜æ€§èƒ½æœåŠ¡å™¨ï¼Œå…·æœ‰jettyçš„æ˜“æ‰©å±•å’Œnetty é«˜æ€§èƒ½ï¼Œä¹‹å‰é˜…è¯»è¿‡éƒ¨åˆ†undertowçš„æºä»£ç ï¼Œå‘ç°undertowåœ°æˆçš„å¼‚æ­¥æ¡†æ¶ä½¿ç”¨çš„æ˜¯xnio(å¹¶ä¸æ˜¯netty) è¿™é‡Œè®°å½•ä¸€ä¸‹undertow æœ€åº•å±‚xnioçš„ä½¿ç”¨æ–¹æ³• XNIOæœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼š Channelï¼Œæ˜¯ä¼ è¾“ç®¡é“çš„æŠ½è±¡æ¦‚å¿µï¼Œåœ¨NIOçš„Channelä¸Šè¿›è¡Œçš„æ‰©å±•åŠ å¼ºï¼Œä½¿ç”¨ChannelListener APIè¿›è¡Œäº‹ä»¶é€šçŸ¥ã€‚åœ¨åˆ›å»ºChannelæ—¶ï¼Œå°±èµ‹äºˆIOçº¿ç¨‹ï¼Œç”¨äºæ‰§è¡Œæ‰€æœ‰çš„ChannelListenerå›è°ƒæ–¹æ³•ã€‚ åŒºåˆ†IOçº¿ç¨‹å’Œå·¥ä½œçº¿ç¨‹ï¼Œåˆ›å»ºä¸€ä¸ªå·¥ä½œçº¿ç¨‹æ± å¯ä»¥ç”¨æ¥æ‰§è¡Œé˜»å¡ä»»åŠ¡ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéé˜»å¡çš„Handlerç”±IOçº¿ç¨‹æ‰§è¡Œï¼Œè€Œé˜»å¡ä»»åŠ¡æ¯”å¦‚Servletåˆ™è¢«è°ƒåº¦åˆ°å·¥ä½œçº¿ç¨‹æ± æ‰§è¡Œã€‚è¿™æ ·å°±å¾ˆå¥½çš„åŒºåˆ†äº†é˜»å¡å’Œéé˜»å¡çš„ä¸¤ç§æƒ…å½¢ã€‚ (è¿™ä¸€ç‚¹å’Œnettyå¾ˆç±»ä¼¼) å¼•ç”³ï¼šæˆ‘ä»¬çŸ¥é“NIOçš„åŸºæœ¬è¦æ±‚æ˜¯ä¸é˜»å¡å½“å‰çº¿ç¨‹çš„æ‰§è¡Œï¼Œå¯¹äºéé˜»å¡è¯·æ±‚çš„ç»“æœï¼Œå¯ä»¥ç”¨ä¸¤ç§æ–¹å¼è·å¾—ï¼šä¸€ç§æ˜¯å¯¹äºè¯·æ±‚å¾ˆå¿«è¿”å›ä¸€ä¸ªå¼•ç”¨ï¼ˆå¦‚JDKä¸­Futureï¼ŒXNIOä¸­ç§°ä¸ºIoFutureï¼Œå…¶ä¸­å¾ˆå¤šæ–¹æ³•æ˜¯ç±»ä¼¼çš„ï¼‰ï¼Œè¿‡ä¸€æ®µæ—¶é—´å†æŸ¥è¯¢ç»“æœï¼›è¿˜æœ‰ä¸€ç§æ˜¯å½“ç»“æœå°±ç»ªæ—¶ï¼Œè°ƒç”¨äº‹å…ˆæ³¨å†Œçš„å›è°ƒæ–¹æ³•æ¥é€šçŸ¥ï¼ˆå¦‚NIO2çš„CompletionHandlerï¼ŒXNIOçš„ChannelListenerï¼‰ é‡è¦æ¦‚å¿µï¼š åœ¨xnioä¸­ï¼Œæœ‰å‡ ä¸ªè¯å‡ºç°é¢‘ç‡å¾ˆé«˜ï¼ŒSourceè¡¨ç¤ºä¿¡æ¯æºå¤´ï¼ŒSinkæ˜¯ä¿¡æ¯ç›®çš„åœ°ï¼ŒConduitæ˜¯æºå¤´åˆ°ç›®çš„åœ°ç®¡é“çš„æŠ½è±¡ã€‚ ä¸€ä¸ªä¾‹å­æŸ¥çœ‹ä¸€ä¸‹ 2018: ps - xnioworker æ–¹æ³•ä¸­çš„ connectStream å’Œ createStreamServer å·²ç»è¢«æ ‡è®°ä¸ºè¿‡æ—¶, å»ºè®®é‡‡ç”¨","date":"2024-12-31","categories":["java"],"tags":["undertow"]},{"title":"undertow-æ¶æ„è§£æ","url":"/2024/12/31/undertow-æ¶æ„è§£æ/","content":"undertow æ˜¯åœ¨å›½å¤–è¯„æµ‹ç½‘ç«™techempower ä¸­è¯„æµ‹æ’è¡Œå¤´10é«˜æ€§èƒ½æ¡†æ¶,åŒæ—¶ä¹Ÿæ˜¯spring boot å¯ä»¥ä½¿ç”¨çš„webå®¹å™¨ä¹‹ä¸€. è¿™é‡Œè®°å½•ä¸€ä¸‹undertowçš„å­¦ä¹ å’Œä½¿ç”¨çš„è®°å½• åŸºç¡€åˆ—å­ ç®€å•æœåŠ¡å™¨æ„å»ºå’Œæ‰‹åŠ¨æœåŠ¡èµ·æ„å»º ç®€å•æœåŠ¡å™¨æ„å»º å…¶å®é€šè¿‡æºä»£ç å¯çŸ¥ï¼Œç®€å•æœåŠ¡å™¨æ„å»ºå…¶å®ç›¸å½“äºä½¿ç”¨äº†é»˜è®¤å€¼çš„å¤æ‚æœåŠ¡å™¨æ„å»º æ‰‹åŠ¨ç»„è£…æœåŠ¡å™¨ è¿™é‡Œå…¶å®æ˜¯è‡ªå·±æ‰‹åŠ¨äº†è®¾ç½®äº†undertow(xnio)ä½“ç³»ä¸­å„ç§ç»„ä»¶, å…·ä½“çš„å„ä¸ªæ­¥éª¤çš„æ„ä¹‰å¦‚ä¸‹ åˆ›å»ºä¸€ä¸ªXNIOå·¥ä½œè€…ã€‚æ­¤workerç®¡ç†æœåŠ¡å™¨çš„IOå’ŒWorkerçº¿ç¨‹ã€‚ åˆ›å»ºXNIO SSLå®ä¾‹ï¼ˆå¯é€‰ï¼Œä»…åœ¨ä½¿ç”¨HTTPSæ—¶æ‰éœ€è¦ï¼‰ åˆ›å»ºç›¸å…³Undertowä¾¦å¬å™¨ç±»çš„å®ä¾‹ ä½¿ç”¨XNIOæ‰“å¼€æœåŠ¡å™¨å¥—æ¥å­—å¹¶è®¾ç½®å…¶acceptä¾¦å¬å™¨ undertowçš„æ¶æ„è®¾è®¡é¦–å…ˆè¯´æ˜ä¸€ä¸‹undertwoçš„æ¶æ„éå¸¸ç®€å•,å¤§è‡´æ‹†åˆ†æˆå¦‚ä¸‹çš„å‡ ä¸ªéƒ¨åˆ† xnioå±‚ è¿™ä¸ªæ˜¯undertow åº•å±‚ä½¿ç”¨çš„nioæ¡†æ¶,æ¯”nettyæ›´åŠ çš„è½»é‡çº§ ç®¡ç†IOå’Œå·¥ä½œçº¿ç¨‹ åœ¨undertow ä½“ç³»ç»Ÿä¸­å¯ä»¥æ‰‹åŠ¨è®¾ç½®ThreadPool è€Œä¸é€‚ç”¨javaè‡ªå·±çº¿ç¨‹æ±  channel API å’Œ Listeners undertow æ˜¯åŸºäº java çš„nio, channel api æœ¬è´¨ä¸Šå…¶å®æ˜¯ nioé€šé“çš„ä¸€ç§å°è£….listenersåœ¨undertowä¸­æœ€ä¸ºchannel apiçš„ç›‘å¬è¡¨ç¤º,channel apiå°†listeneræ„Ÿå…´è¶£çš„è¯·æ±‚æ´¾å‘åˆ°listenerä¸­è¿›è¡Œå¤„ç† Undertowé™„å¸¦5ä¸ªä¸åŒçš„ç›‘å¬å™¨ï¼šHTTP &#x2F; 1.1,HTTPS,AJP,HTTP &#x2F; 2 å¤„ç†ç¨‹åº handle è¿™ä¸ªæ–¹æ³•ä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦å®ç°çš„æ–¹æ³•, è¡¨ç¤ºæ¥å—åˆ°è¯·æ±‚åè¿›è¡Œå¤„ç†æ—¶çš„å¤„ç†æ–¹æ³• undertow ä¸€äº›å‚æ•°æ§åˆ¶ xnio ä¸»å¹²å‚æ•° è¿™ä¸ªæ–¹æ³•çš„å‚æ•°ä¸»è¦æ˜¯åœ¨ listenerå‚æ•° è¿™ä¸ªå‚æ•°æ˜¯ç”¨æ¥é…ç½®listenerçš„å„ç§å„ç§é…ç½®ä¿¡æ¯çš„å‚æ•°ä¸»è¦åœ¨ undertow çš„ç”Ÿå‘½å‘¨æœŸçš„äº¤æ¢ç»“æŸè¯·æ±‚ç”Ÿå‘½å‘¨æœŸå½“å®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡å™¨æ—¶ï¼ŒUndertowä¼šåˆ›å»ºä¸€ä¸ªio.undertow.server.HttpServerConnectionã€‚å½“å®¢æˆ·ç«¯å‘é€è¯·æ±‚æ—¶ï¼Œå®ƒç”±Undertowè§£æå™¨è§£æï¼Œç„¶åå°†ç»“æœio.undertow.server.HttpServerExchangeä¼ é€’ç»™æ ¹å¤„ç†ç¨‹åºã€‚å½“æ ¹å¤„ç†ç¨‹åºå®Œæˆæ—¶ï¼Œå¯èƒ½ä¼šå‘ç”Ÿä»¥ä¸‹å››ç§æƒ…å†µä¹‹ä¸€ï¼š äº¤æ¢å¯ä»¥å®Œæˆ å¦‚æœè¯·æ±‚å’Œå“åº”é€šé“éƒ½å·²å®Œå…¨è¯»&#x2F;å†™ï¼Œåˆ™è®¤ä¸ºäº¤æ¢å®Œæˆã€‚å¯¹äºæ²¡æœ‰å†…å®¹çš„è¯·æ±‚ï¼ˆä¾‹å¦‚GETå’ŒHEADï¼‰ï¼Œè¯·æ±‚æ–¹è‡ªåŠ¨è¢«è§†ä¸ºå®Œå…¨è¯»å–ã€‚å½“å¤„ç†ç¨‹åºå†™å‡ºå®Œæ•´å“åº”å¹¶å…³é—­å¹¶å®Œå…¨åˆ·æ–°å“åº”é€šé“æ—¶ï¼Œè¯»å–ç«¯è¢«è§†ä¸ºå®Œæˆã€‚å¦‚æœäº¤æ˜“å·²ç»å®Œæˆï¼Œé‚£ä¹ˆåœ¨äº¤æ˜“å®Œæˆåä¸ä¼šé‡‡å–ä»»ä½•è¡ŒåŠ¨ã€‚ æ ¹å¤„ç†ç¨‹åºæ­£å¸¸è¿”å›è€Œä¸å®Œæˆäº¤æ¢ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäº¤æ¢å°†é€šè¿‡å‘¼å«å®ŒæˆHttpServerExchange.endExchange()ã€‚è¯­ä¹‰endExchange() å°†åœ¨åé¢è®¨è®ºã€‚ æ ¹å¤„ç†ç¨‹åºè¿”å›ä¸€ä¸ªException åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ500å°†è®¾ç½®å“åº”ä»£ç ï¼Œå¹¶ä¸”å°†ä½¿ç”¨ç»“æŸäº¤æ¢HttpServerExchange.endExchange()ã€‚ æ ¹å¤„ç†ç¨‹åºå¯ä»¥åœ¨HttpServerExchange.dispatch()è°ƒç”¨ä¹‹åæˆ–å¯åŠ¨å¼‚æ­¥IOä¹‹åè¿”å› åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå·²è°ƒåº¦çš„ä»»åŠ¡å°†æäº¤ç»™è°ƒåº¦æ‰§è¡Œç¨‹åºï¼Œæˆ–è€…å¦‚æœå·²åœ¨è¯·æ±‚æˆ–å“åº”é€šé“ä¸Šå¯åŠ¨äº†å¼‚æ­¥IOï¼Œåˆ™å°†å¯åŠ¨æ­¤ä»»åŠ¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäº¤æ¢å°†ä¸ä¼šå®Œæˆï¼Œå®Œæˆäº¤æ¢å®Œæˆäº¤æ¢å–å†³äºæ‚¨çš„å¼‚æ­¥ä»»åŠ¡ã€‚ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæœ€å¸¸è§çš„ç”¨é€”HttpServerExchange.dispatch()æ˜¯å°†æ‰§è¡Œä»ä¸å…è®¸é˜»å¡çš„IOçº¿ç¨‹ç§»åŠ¨åˆ°å·¥ä½œçº¿ç¨‹ï¼Œè¿™å…è®¸é˜»å¡æ“ä½œã€‚è¿™ç§æ¨¡å¼é€šå¸¸çœ‹èµ·æ¥åƒï¼š è°ƒåº¦åˆ°å·¥ä½œçº¿ç¨‹ å› ä¸ºåœ¨è°ƒç”¨å †æ ˆè¿”å›ä¹‹å‰å®é™…ä¸Šå¹¶ä¸è°ƒåº¦exchangeï¼Œæ‰€ä»¥å¯ä»¥ç¡®ä¿ä¸€æ¬¡äº¤æ¢ä¸­çš„ä¸€ä¸ªçº¿ç¨‹æ°¸è¿œä¸ä¼šæ´»åŠ¨ã€‚äº¤æ¢ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯å®ƒå¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´ä¼ é€’ï¼Œåªè¦ä¸¤ä¸ªçº¿ç¨‹ä¸ä¼šç«‹å³å°è¯•ä¿®æ”¹å®ƒï¼Œå¹¶ä¸”åœ¨ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªä¹‹é—´çš„æ“ä½œï¼ˆä¾‹å¦‚çº¿ç¨‹æ± è°ƒåº¦ï¼‰ä¹‹å‰å‘ç”Ÿçº¿ç¨‹è®¿é—®ã€‚ ç»“æŸäº¤æ¢å¦‚ä¸Šæ‰€è¿°ï¼Œä¸€æ—¦è¯·æ±‚å’Œå“åº”é€šé“éƒ½å·²å…³é—­å¹¶åˆ·æ–°ï¼Œåˆ™è®¤ä¸ºäº¤æ¢å·²å®Œæˆã€‚ æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥é€šè¿‡å®Œå…¨è¯»å–è¯·æ±‚é€šé“ è°ƒç”¨shutdownWrites()å“åº”é€šé“ç„¶ååˆ·æ–°å®ƒ é€šè¿‡è°ƒç”¨æ¥ç»“æŸäº¤æ¢HttpServerExchange.endExchange()ã€‚ å½“endExchange()è°ƒç”¨æ—¶ï¼ŒUndertowå°†æ£€æŸ¥æ˜¯å¦å·²ç”Ÿæˆå†…å®¹ï¼Œå¦‚æœå·²ç”Ÿæˆï¼Œåˆ™å®ƒå°†ç®€å•åœ°æ¶ˆè€—è¯·æ±‚é€šé“ï¼Œå¹¶å…³é—­å¹¶åˆ·æ–°å“åº”é€šé“ã€‚å¦‚æœæ²¡æœ‰ï¼Œå¹¶ä¸”åœ¨äº¤æ¢æœºä¸Šæ³¨å†Œäº†ä»»ä½•é»˜è®¤å“åº”ä¾¦å¬å™¨ï¼Œé‚£ä¹ˆUndertowå°†ä¸ºæ¯ä¸ªäººæä¾›ç”Ÿæˆé»˜è®¤å“åº”çš„æœºä¼šã€‚æ­¤æœºåˆ¶æ˜¯ç”Ÿæˆé»˜è®¤é”™è¯¯é¡µé¢çš„æ–¹å¼ã€‚ endExchange() ä¼šåœ¨å†…éƒ¨è°ƒç”¨ shutdownWrtiesæ–¹æ³• undertow é˜»å¡æµæ”¯æŒHttpServerExchange(undertowå¯¹ä¸€æ¬¡è¯·æ±‚çš„æŠ½è±¡) è°ƒç”¨startBlocking() è¿”å›ä¸€ä¸ªBlockingHttpServerExchange é€šè¿‡è¿™ä¸ªç±»å¯ä»¥æ­£å¸¸è°ƒç”¨HttpServerExchange.getInputStream()å’Œ HttpServerExchange.getOutputStream()å‘ä»–ä»¬å†™å…¥æ•°æ® undertow é”™è¯¯å¤„ç†æ–¹æ³•å¤„ç†å¼‚å¸¸çš„æœ€ç®€å•æ–¹æ³•æ˜¯åœ¨å¤–éƒ¨å¤„ç†ç¨‹åºä¸­æ•è·å®ƒä»¬ã€‚ä¾‹å¦‚ï¼š å“åº”ç›‘å¬å™¨undertowå› ä¸ºå„ä¸ªè¯·æ±‚éƒ½æ˜¯ä½¿ç”¨çš„å¼‚æ­¥æ“ä½œ,æ‰€æœ‰åœ¨ç›‘å¬å“åº”çš„æ—¶å€™éœ€è¦ä½¿ç”¨å¼‚æ­¥å›è°ƒçš„æ–¹æ³•æ¥è¿›è¡Œç›‘å¬æ“ä½œ å„ç§å†…ç½®handerè§ undertow å®˜æ–¹handleæ”¯æŒ undertow handle undertow servlet æ”¯æŒæš‚æ—¶ç•¥è¿‡ä»¥åæœ‰æ—¶é—´çš„æ—¶å€™å†çœ‹è¿™ä¸ªä¸é‡è¦ åªå†™ä¸€ä¸ªä¾‹å­å§","date":"2024-12-31","categories":["java"],"tags":["undertow"]},{"title":"vert.x-(1)vert.xçš„æ ¸å¿ƒè®¾è®¡å’Œä½¿ç”¨åŸåˆ™","url":"/2024/12/31/vert-x--1-vert-xçš„æ ¸å¿ƒè®¾è®¡å’Œä½¿ç”¨åŸåˆ™/","content":"vert.x çš„æ ¸å¿ƒåŠŸèƒ½ ç¼–å†™ TCP å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ ç¼–å†™æ”¯æŒ WebSocket çš„ HTTP å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ äº‹ä»¶æ€»çº¿(Event Bus) å…±äº«æ•°æ® â€”â€” æœ¬åœ°çš„Mapå’Œåˆ†å¸ƒå¼é›†ç¾¤Map å‘¨æœŸæ€§ã€å»¶è¿Ÿæ€§åŠ¨ä½œ éƒ¨ç½²å’Œæ’¤é”€ Verticle å®ä¾‹ æ•°æ®æŠ¥å¥—æ¥å­— DNSå®¢æˆ·ç«¯ æ–‡ä»¶ç³»ç»Ÿè®¿é—® é«˜å¯ç”¨æ€§ é›†ç¾¤ vert.x ä½¿ç”¨çš„ä¸‰åŸåˆ™1. æµå¼ç®€å•çš„è¯´å°±æ˜¯.x().y().z() è¿™ç§å†™æ³• 2. å›è°ƒæœ€æ ¸å¿ƒçš„ç‰¹æ€§ï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨å‡½æ•°è€Œæ˜¯ä½¿ç”¨å®šä¹‰å‡½æ•°ï¼Œç”±æ¡†æ¶æˆ–è€…ç¼–è¯‘å™¨æ¥å†³å®šä»€ä¹ˆæ—¶å€™è¿è¡Œ 3. éé˜»å¡è¿™ä¸ªæ˜¯æœ€é‡è¦çš„ï¼Œå› ä¸ºvert.x åº•å±‚ä½¿ç”¨çš„å•çº¿ç¨‹è½®è¯¢çš„æ“ä½œï¼Œå¦‚æœå°†çº¿ç¨‹é˜»å¡æ‰çš„è¯ï¼Œæ¢å›å¯¼è‡´æ‰€æœ‰çš„é€»è¾‘éƒ½åœ¨é˜»å¡ä¸­ vert.x æœ¬è´¨ä¸Šæ˜¯å¤šçº¿ç¨‹æ¿çš„eventLoop æ¨¡å¼åˆå«Multi-Reactor æ¨¡å¼ vert.x è¿è¡Œé˜»å¡ä»£ç ç¬¬ä¸€ç§æ–¹æ³•ï¼Œä½¿ç”¨vertx.executeBlocking ç¬¬äºŒç§æ–¹æ³•ä½¿ç”¨WorkerExecutor è¿™ç§æ–¹æ³•ç›¸å½“äºç”Ÿæˆä¸€ä¸ªæ–°çš„çº¿ç¨‹æ± è®©é˜»å¡çš„ä»£ç åœ¨çº¿ç¨‹ä¸­è¿è¡Œ","date":"2024-12-31","categories":["java"],"tags":["vertx"]},{"title":"vert.x-(2)ä¸€ä¸ªç®€å•çš„webæœåŠ¡å™¨","url":"/2024/12/31/vert-x--2-ä¸€ä¸ªç®€å•çš„webæœåŠ¡å™¨/","content":"vert.x çš„æ ¸å¿ƒå°±æ˜¯å¼‚æ­¥éé˜»å¡ï¼Œå¤§é‡ä½¿ç”¨äº†æµå¼è°ƒç”¨ï¼Œç›¸æ¯”è¾ƒnettyè¿˜æ˜¯éå¸¸å®¹æ˜“ä½¿ç”¨çš„ ä¹‹å‰ç”¨è¿‡undertow ç°åœ¨å‘ç°vert.x å’Œ undertow éå¸¸ç›¸åƒ , è¿™é‡Œå¯¹æ¯”ä¸€ä¸‹äºŒè€…ç¼–å†™ä¸€ä¸ªåŸºæœ¬æœåŠ¡å™¨çš„æ—¶å€™çš„ä»£ç  vert.x undertow æµç¨‹å…¶å®éå¸¸æƒ³åƒ åˆå§‹çŠ¶æ€->é…ç½®å‚æ•°->æŒ‡å®šhandle->è¿è¡Œ æ¥ä¸‹æ¥è¿è¡Œè¿™æ®µä»£ç ç„¶åè¾“å…¥æŒ‡å®šçš„urlåœ°å€å°±å¯ä»¥å®ç°æŸ¥çœ‹ç›¸åº”çš„ç»“æœäº†","date":"2024-12-31","categories":["java"],"tags":["vertx"]},{"title":"vert.x-(3)-vert.xæ ¸å¿ƒæ€æ“ä½œ","url":"/2024/12/31/vert-x--3--vert-xæ ¸å¿ƒæ€æ“ä½œ/","content":"vert.x å…¶å®åœ¨æœ¬è´¨ä¸Šå¹¶ä¸å•å•æ˜¯ä¸€ä¸ªç½‘ç»œæ¡†æ¶ï¼Œæ›´å¤šçš„æ˜¯å°è£…äº†ä¸€å±‚çš„å‡½æ•°å¼æˆ–è€…å¼‚æ­¥å›æ‰çš„æ¡†æ¶ vert.x åœ¨ä½¿ç”¨çš„æ—¶å€™è¦æ±‚ä½¿ç”¨è€…å°½é‡ä¸ä½¿ç”¨é˜»å¡çš„æ–¹æ³•ï¼Œæ”¯æŒéé˜»å¡çš„æ–¹æ³•ï¼Œè¿™äº›å…¶å®å°±æ˜¯vert.xæœ€åˆçš„è®¾è®¡å“²å­¦ ä¸€ä¸ªåŸºæœ¬åˆ—å­ï¼Œå±•ç¤ºvert.x çš„éé˜»å¡æ“ä½œ è¿™ä¸ªä¾‹å­æ˜¯ä¸€ä¸ªå®šæ—¶æ‰§è¡Œä»»åŠ¡çš„ä¾‹å­ï¼Œåé¢çš„lambleè¡¨è¾¾å¼å°±æ˜¯å›è°ƒå‡½æ•°ï¼Œä¹‹å‰è¡¨ç¤ºæ‰§è¡Œçš„æ—¶é—´é—´éš”ï¼Œè¿™ä¸ªå‡½æ•°å°†ä¼šåœ¨1000æ¯«ç§’åæ‰§è¡Œ vert.x è¿è¡Œé˜»å¡ä»£ç vert.x æä¾›ä¸¤ç§æ–¹æ³•æ¥è¿è¡Œé˜»å¡çš„ä»£ç  1. ä½¿ç”¨executeBlocking æ–¹æ³•æ¥å®ç°é˜»å¡è°ƒç”¨ æ³¨æ„é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœ executeBlocking åœ¨åŒä¸€ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒä¸­ï¼ˆå¦‚ï¼šåŒä¸€ä¸ª Verticle å®ä¾‹ï¼‰è¢«è°ƒç”¨äº†å¤šæ¬¡ï¼Œé‚£ä¹ˆè¿™äº›ä¸åŒçš„ executeBlocking ä»£ç å—ä¼š é¡ºåºæ‰§è¡Œï¼ˆä¸€ä¸ªæ¥ä¸€ä¸ªï¼‰ã€‚ è‹¥æ‚¨ä¸éœ€è¦å…³å¿ƒæ‚¨è°ƒç”¨ executeBlocking çš„é¡ºåºï¼Œå¯ä»¥å°† ordered å‚æ•°(å‡½æ•°ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°)çš„å€¼è®¾ä¸º falseã€‚è¿™æ ·ä»»ä½• executeBlocking éƒ½ä¼šåœ¨ Worker Pool ä¸­å¹¶è¡Œæ‰§è¡Œã€‚ ä½¿ç”¨ Worker Verticle å®ç°é˜»å¡ä»£ç ä¸€ä¸ª Worker Verticle å§‹ç»ˆä¼šä½¿ç”¨ Worker Pool ä¸­çš„æŸä¸ªçº¿ç¨‹æ¥æ‰§è¡Œã€‚ é»˜è®¤çš„é˜»å¡å¼ä»£ç ä¼šåœ¨ Vert.x çš„ Worker Pool ä¸­æ‰§è¡Œï¼Œé€šè¿‡ setWorkerPoolSize é…ç½®ã€‚ å¯ä»¥ä¸ºä¸åŒçš„ç”¨é€”åˆ›å»ºä¸åŒçš„æ± ï¼š Worker Executor åœ¨ä¸éœ€è¦çš„æ—¶å€™å¿…é¡»è¢«å…³é—­ï¼š å½“ä½¿ç”¨åŒä¸€ä¸ªåå­—åˆ›å»ºäº†è®¸å¤š worker æ—¶ï¼Œå®ƒä»¬å°†å…±äº«åŒä¸€ä¸ª poolã€‚å½“æ‰€æœ‰çš„ worker executor è°ƒç”¨äº† close æ–¹æ³•è¢«å…³é—­è¿‡åï¼Œå¯¹åº”çš„ worker pool ä¼šè¢«é”€æ¯ã€‚ å¦‚æœ Worker Executor åœ¨ Verticle ä¸­åˆ›å»ºï¼Œé‚£ä¹ˆ Verticle å®ä¾‹é”€æ¯çš„åŒæ—¶ Vert.x å°†ä¼šè‡ªåŠ¨å…³é—­è¿™ä¸ª Worker Executorã€‚ Worker Executor å¯ä»¥åœ¨åˆ›å»ºçš„æ—¶å€™é…ç½®ï¼š","date":"2024-12-31","categories":["java"],"tags":["vertx"]},{"title":"vert.x-(3)å»¶è¿Ÿå‡½æ•°å’Œå‘¨æœŸå‡½æ•°","url":"/2024/12/31/vert-x--3-å»¶è¿Ÿå‡½æ•°å’Œå‘¨æœŸå‡½æ•°/","content":"vert.x æä¾›äº†å»¶è¿Ÿå‡½æ•°å’Œå‘¨æœŸå‡½æ•°ä¸¤ç§åŠŸèƒ½ï¼Œæœ¬è´¨ä¸Šç›¸å½“äºä¸¤ä¸ªå®šæ—¶å™¨ åœ¨ Vert.x ä¸­,æƒ³è¦å»¶è¿Ÿä¹‹åæ‰§è¡Œæˆ–å®šæœŸæ‰§è¡Œæ“ä½œå¾ˆå¸¸è§ã€‚åœ¨ Standard Verticle(ä¹‹åä¼šè®¨è®º) ä¸­æ‚¨ä¸èƒ½ç›´æ¥è®©çº¿ç¨‹ä¼‘çœ ä»¥å¼•å…¥å»¶è¿Ÿ,å› ä¸ºå®ƒä¼šé˜»å¡ Event Loop çº¿ç¨‹ ä¸€æ¬¡æ€§è®¡æ—¶å™¨ - åªæ‰§è¡Œä¸€æ¬¡è¿™ä¸ªæ–¹æ³•åœ¨ä½¿ç”¨lambleçš„æ—¶å€™ä¼ å…¥çš„å‚æ•°æ˜¯è¿™ä¸ªå®šæ—¶å™¨çš„idï¼Œä¹‹åvertxå¯ä»¥ä½¿ç”¨è¿™ä¸ªidæ¥ç»ˆæ­¢å®šæ—¶å™¨çš„è°ƒç”¨ å¤šæ¬¡è°ƒç”¨å®šæ—¶å™¨ - è¿™ä¸ªæ–¹æ³•vert.x å°†ä¼šå‘¨æœŸæ€§çš„è°ƒç”¨lambleä¸­çš„handle ä¸¤ç§è®¡æ—¶å™¨çš„å–æ¶ˆæ“ä½œ è¿™ä¸ªæ–¹æ³•å…¶ä¸­çš„trmerIdå°±æ˜¯åœ¨å£°æ˜è®¡æ—¶å™¨çš„æ—¶å€™äº§ç”Ÿçš„idç¼–ç ","date":"2024-12-31","categories":["java"],"tags":["vertx"]},{"title":"vert.x-(4)å¸¸ç”¨ç±»æˆ–æ–¹æ³•","url":"/2024/12/31/vert-x--4-å¸¸ç”¨ç±»æˆ–æ–¹æ³•/","content":"Vertxç±»WorkerExecutorç±»Futureç±» å’Œ CompositeFuture ç±»vert.x æ”¯æŒå¹¶å‘åˆå¹¶æ“ä½œï¼Œå®ç°çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ä¸Šé¢çš„ä¸¤ä¸ªç±» ä¸€ä¸ªä¾‹å­ Futuer æè¿°çš„æ˜¯è¿™ä¸ªå¼‚æ­¥æ‰§è¡Œçš„ç»“æœçŠ¶æ€ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥å°†ä¸‹å±‚çš„å¼‚æ­¥ç›‘å¬æ–¹æ³•åœ¨ä¸Šå±‚åé¦ˆåˆ° Funtuerçš„composeæ–¹æ³•ç”¨äºé¡ºåºç»„åˆFuture å®ç°å¤šä¸ªfutuer é“¾å¼è°ƒç”¨ è¿™é‡Œä¾‹å­ä¸­ï¼Œæœ‰ä¸‰ä¸ªæ“ä½œè¢«ä¸²èµ·æ¥äº†ï¼š ä¸€ä¸ªæ–‡ä»¶è¢«åˆ›å»ºï¼ˆfut1ï¼‰ ä¸€äº›ä¸œè¥¿è¢«å†™å…¥åˆ°æ–‡ä»¶ï¼ˆfut2ï¼‰ æ–‡ä»¶è¢«ç§»èµ°ï¼ˆstartFutureï¼‰ è¿™ä¸ªæ–¹æ³•çš„å‚æ•°æœ‰ä¸¤ç§çš„å½¢å¼ åªæœ‰ä¸€ä¸ªå‡½æ•° : ä¸¤ä¸ªå‡½æ•° : CompsiteFuture æ–¹æ³•ç›‘å¬ä¼ å…¥çš„Futureç±»çš„çŠ¶æ€ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªliståˆ—è¡¨æˆ–è€…æœ€å¤šç•™ä¸ªFutureå‚æ•° CompsiteFuture æä¾›çš„æ•´ç†æ–¹æ³• any : åªè¦æœ‰ä¸€ä¸ªæˆåŠŸï¼Œä¼ å…¥ä¸‹ä¸€ä¸ªhandleä¸­çš„çŠ¶æ€å°±æ˜¯æˆåŠŸ all : å¿…é¡»å…¨éƒ¨æˆåŠŸï¼Œä¼ å…¥ä¸‹ä¸€ä¸ªhandleä¸­çš„çŠ¶æ€æ‰èƒ½æ˜¯æˆåŠŸ join : æ‰€æœ‰çš„future éƒ½æ‰§è¡Œå®Œæˆäº†æ²¡æœ‰ä¸€åœºæ— è®ºç»“æœæ˜¯å¦å¤±è´¥ï¼Œä¼ å…¥åˆ°ä¸‹ä¸€ä¸ªhandleä¸­çš„çŠ¶æ€å°±æ˜¯æˆåŠŸ vert.x VerticleVertticleæ˜¯vert.xæä¾›çš„ä¸€ä¸ªç®€å•ä¾¿æ·çš„ã€å¯æ‰©å±•çš„ã€ç±»ä¼¼ Actor Model çš„éƒ¨ç½²å’Œå¹¶å‘æ¨¡å‹æœºåˆ¶ Verticle æ˜¯ç”± Vert.x éƒ¨ç½²å’Œè¿è¡Œçš„ä»£ç å—ã€‚é»˜è®¤æƒ…å†µä¸€ä¸ª Vert.x å®ä¾‹ç»´æŠ¤äº†Nï¼ˆé»˜è®¤æƒ…å†µä¸‹N &#x3D; CPUæ ¸æ•° x 2ï¼‰ä¸ª Event Loop çº¿ç¨‹ã€‚Verticle å®ä¾‹å¯ä½¿ç”¨ä»»æ„ Vert.x æ”¯æŒçš„ç¼–ç¨‹è¯­è¨€ç¼–å†™ï¼Œè€Œä¸”ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥åŒ…å«å¤šç§è¯­è¨€ç¼–å†™çš„ Verticleã€‚ å¯ä»¥å°† Verticle æƒ³æˆ Actor Model ä¸­çš„ Actorã€‚ ä¸€ä¸ªåº”ç”¨ç¨‹åºé€šå¸¸æ˜¯ç”±åœ¨åŒä¸€ä¸ª Vert.x å®ä¾‹ä¸­åŒæ—¶è¿è¡Œçš„è®¸å¤š Verticle å®ä¾‹ç»„åˆè€Œæˆã€‚ä¸åŒçš„ Verticle å®ä¾‹é€šè¿‡å‘ Event Bus ä¸Šå‘é€æ¶ˆæ¯æ¥ç›¸äº’é€šä¿¡ã€‚","date":"2024-12-31","categories":["java"],"tags":["vertx"]},{"title":"vert.x-ä½“ç³»(1)-åŸºæœ¬ä½¿ç”¨æ–¹æ³•","url":"/2024/12/31/vert-x-ä½“ç³»-1--åŸºæœ¬ä½¿ç”¨æ–¹æ³•/","content":"vert.xæ ¸å¿ƒåŠŸèƒ½ ç¼–å†™ TCP å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ ç¼–å†™æ”¯æŒ WebSocket çš„ HTTP å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ äº‹ä»¶æ€»çº¿(Event Bus) å…±äº«æ•°æ® â€”â€” æœ¬åœ°çš„Mapå’Œåˆ†å¸ƒå¼é›†ç¾¤Map å‘¨æœŸæ€§ã€å»¶è¿Ÿæ€§åŠ¨ä½œ éƒ¨ç½²å’Œæ’¤é”€ Verticle å®ä¾‹ æ•°æ®æŠ¥å¥—æ¥å­— DNSå®¢æˆ·ç«¯ æ–‡ä»¶ç³»ç»Ÿè®¿é—® é«˜å¯ç”¨æ€§ é›†ç¾¤ å…¶å®vertxçš„æœ€æ ¸å¿ƒçš„ä¸œè¥¿å°±æ˜¯å¼‚æ­¥å’Œéé˜»å¡ ps:é™¤äº†æå°‘æ•°ä¾‹å¤–ï¼ˆå³æŸäº›æ–‡ä»¶ç³»ç»Ÿæ“ä½œä»¥â€™Syncâ€™ç»“å°¾ï¼‰ï¼ŒVert.xä¸­çš„æ‰€æœ‰APIéƒ½ä¸ä¼šé˜»å¡è°ƒç”¨çº¿ç¨‹ã€‚ vert.xä½¿ç”¨æ–¹æ³• vert.xçš„ä½¿ç”¨å…¶å®éå¸¸ç®€å•,ä½¿ç”¨å·¥å‚æ–¹æ³•æ—¢å¯ä»¥åˆ›å»ºä¸€ä¸ªvertå®ä¾‹ ps: æˆ‘ä»¬å¯ä»¥ä½¿ç”¨VertxOptionsæ–¹æ³•åˆ›å»ºä¸€ä¸ªverté…ç½®çš„å‚æ•°. vert.xçš„ä¸€äº›åŸºæœ¬çš„ä½¿ç”¨æ–¹æ³• ps:é™¤äº†æå°‘æ•°ä¾‹å¤–ï¼ˆå³æŸäº›æ–‡ä»¶ç³»ç»Ÿæ“ä½œä»¥â€™Syncâ€™ç»“å°¾ï¼‰ï¼ŒVert.xä¸­çš„æ‰€æœ‰APIéƒ½ä¸ä¼šé˜»å¡è°ƒç”¨çº¿ç¨‹ã€‚","date":"2024-12-31","categories":["java"],"tags":["vertx"]},{"title":"vert.x-ä½“ç³»(2)-eventloop","url":"/2024/12/31/vert-x-ä½“ç³»-2--eventloop/","content":"ç®€å•çš„è¯´æ˜ä¸€ä¸‹vert.x eventLoopçš„ç›¸å…³ä¿¡æ¯Vert.xä½¿ç”¨äº†Reactoræ¨¡å‹ï¼Œé€šè¿‡Event drivençš„æ–¹å¼ï¼Œå°†Eventsåˆ†å‘åˆ°handlersä¸­è¿›è¡Œå¤„ç†ï¼Œä»»ä½•eventéƒ½ä¸ä¼šé˜»å¡Eventloopçº¿ç¨‹ï¼Œè¿™æ ·Eventloopçº¿ç¨‹å¯ä»¥ä¸€ç›´ä¿æŒé«˜é€Ÿåˆ†å‘Eventsçš„é€Ÿåº¦ã€‚ å‡è®¾åœ¨åŒä¸€æ—¶é—´æœ‰å¾ˆå¤šHTTPè¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ï¼ŒEventloopä¼šå°†æ¯ä¸€ä¸ªhttp requeståˆ†å‘åˆ°handlerä¸­å¤„ç†ï¼Œæ¯”å¦‚æœ‰10Kä¸ªRequests,å‡è®¾æœåŠ¡å™¨æƒ³åœ¨1så†…å¤„ç†è¿™äº›requestsï¼Œé‚£ä¹ˆå¹³å‡ç®—ä¸‹æ¥Eventloopå¿…é¡»èƒ½åœ¨0.1mså†…åˆ†å‘å®Œæ¯ä¸ªeventï¼Œä¸€æ—¦Eventloopè¢«é˜»å¡ï¼Œæ•´ä¸ªæœåŠ¡å™¨ååé‡éƒ½ä¼šå—åˆ°æå¤§å½±å“ã€‚ æ‰€ä»¥Eventloopç»å¯¹ä¸åº”è¯¥è¢«é˜»å¡ä½ï¼Œæ‰€æœ‰äº¤ç»™Eventloopå»å¤„ç†çš„eventéƒ½åº”è¯¥æ˜¯non-blocking(I&#x2F;O)çš„æ–¹å¼æˆ–è€…CPUæ‰§è¡Œæ—¶é—´è¾ƒçŸ­çš„ï¼Œè¿™æ ·æ‰èƒ½ç¡®ä¿æ¯ä¸ªeventå¾—åˆ°åŠæ—¶çš„åˆ†å‘ã€‚ è€ŒVert.xä¸ä»…ä»…å®ç°äº†Reactoræ¨¡å‹ï¼Œè¿˜å®ç°äº†Multi-Reactoræ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªVertx instanceéƒ½ä¼šæœ‰å¤šä¸ªEventloopï¼Œé»˜è®¤çš„è®¾ç½®æ˜¯Eventloopæ•°é‡å¯¹åº”CPUæ ¸å¿ƒæ•°é‡ä¹˜ä»¥2ï¼Œåœ¨VertxOptionsç±»ä¸­å¯ä»¥çœ‹åˆ° å¯ä»¥é€šè¿‡setEventLoopPoolSize()æ–¹æ³•æ”¹å˜Vertxå®ä¾‹æ‹¥æœ‰Eventloopçš„æ•°é‡ã€‚ vertä½¿ç”¨çš„ä¸‰å¤§åŸåˆ™1. æµå¼ç®€å•çš„è¯´å°±æ˜¯.x().y().z() è¿™ç§å†™æ³• 2. å›è°ƒæœ€æ ¸å¿ƒçš„ç‰¹æ€§ï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨å‡½æ•°è€Œæ˜¯ä½¿ç”¨å®šä¹‰å‡½æ•°ï¼Œç”±æ¡†æ¶æˆ–è€…ç¼–è¯‘å™¨æ¥å†³å®šä»€ä¹ˆæ—¶å€™è¿è¡Œ 3. éé˜»å¡è¿™ä¸ªæ˜¯æœ€é‡è¦çš„ï¼Œå› ä¸ºvert.x åº•å±‚ä½¿ç”¨çš„å•çº¿ç¨‹è½®è¯¢çš„æ“ä½œï¼Œå¦‚æœå°†çº¿ç¨‹é˜»å¡æ‰çš„è¯ï¼Œæ¢å›å¯¼è‡´æ‰€æœ‰çš„é€»è¾‘éƒ½åœ¨é˜»å¡ä¸­ vert.x æœ¬è´¨ä¸Šæ˜¯å¤šçº¿ç¨‹æ¿çš„eventLoop æ¨¡å¼åˆå«Multi-Reactor æ¨¡å¼","date":"2024-12-31","categories":["java"],"tags":["vertx"]},{"title":"vert.x-ä½“ç³»(3)-Verticle","url":"/2024/12/31/vert-x-ä½“ç³»-3--Verticle/","content":"vert.xæä¾›çš„Verticleè¿™ç§æ–¹ä¾¿éƒ¨ç½²","date":"2024-12-31","categories":["java"],"tags":["vertx"]},{"title":"vert.x-ä½¿ç”¨(1)-åˆ›å»ºä¸€ä¸ªTCPæœåŠ¡å™¨","url":"/2024/12/31/vert-x-ä½¿ç”¨-1--åˆ›å»ºä¸€ä¸ªTCPæœåŠ¡å™¨/","content":"vert.x åˆ›å»ºä¸€ä¸ªTCPæœåŠ¡å™¨æ˜¯è¶…çº§ç®€å•çš„åˆ›å»ºä¸€ä¸ªserverç«¯æœåŠ¡å™¨ ä»è¿™ä¸ªæ–¹æ³•ä¸­å¯ä»¥çœ‹å‡ºæ¥vert.xè‡ªèº«çš„ä¸€åˆ‡çš†å¼‚æ­¥çš„ç‰¹æ€§,å…¶å®çœ‹ä¸Šé¢çš„æ³¨é‡Šåº”è¯¥å°±å¯ä»¥ç†è§£äº† åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ vert.x tcp å…¶ä»–ç‰¹æ€§1. socket æ£€ç´¢ æœ¬åœ°åœ°å€å’Œè¿œç¨‹åœ°å€vert.x æä¾›äº†ä¸¤ç§æ–¹æ³•è·å–æœ¬åœ°(æˆ‘çš„åœ°å€)å’Œè¿œç¨‹åœ°å€(å»é“¾æ¥çš„åœ°å€) 2. socket æ–‡ä»¶å¤„ç†vert.x é’ˆå¯¹æ–‡ä»¶çš„å¤„ç†æ–¹æ³•åŒæ ·éå¸¸ç®€å•ä½¿ç”¨sendfileæ–¹æ³•å°±å¯ä»¥è¿›è¡Œæ–‡ä»¶æ•°æ®çš„å‘é€äº† æ³¨æ„: è¿™ä¸ªæ–‡ä»¶çš„åœ°å€å¿…é¡»æ˜¯è¿™ä¸ªé¡¹ç›®çš„ç›¸å¯¹è·¯å¾„åœ°å€ 3. vert.x çš„tcpä½¿ç”¨çš„eventLoop,æ˜¯åœ¨ä¸€ä¸ªæ ¸å¿ƒä¸Šè¿è¡Œçš„,å¦‚æœè¦ä½¿ç”¨æ›´å¥½çš„æ€§èƒ½,è‡ªåŠ¨çš„æ‰©å±•åˆ°å¤šæ ¸å¿ƒä¸Šå»,å¯ä»¥é‡‡ç”¨ä¸€ä¸‹çš„æ–¹æ³• æœä½¿ç”¨Verticleï¼Œåˆ™å¯ä»¥ä½¿ç”¨-instanceså‘½ä»¤è¡Œä¸Šçš„é€‰é¡¹ç®€å•åœ°éƒ¨ç½²æœåŠ¡å™¨Verticleçš„æ›´å¤šå®ä¾‹ï¼š æˆ–è€…ä»¥ç¼–ç¨‹æ–¹å¼éƒ¨ç½²Verticle æ‰§è¡Œæ­¤æ“ä½œåï¼Œæ‚¨ä¼šå‘ç°echoæœåŠ¡å™¨åœ¨åŠŸèƒ½ä¸Šä¸ä»¥å‰å®Œå…¨ç›¸åŒï¼Œä½†æ‚¨çš„æœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰æ ¸å¿ƒéƒ½å¯ä»¥ä½¿ç”¨ï¼Œå¹¶ä¸”å¯ä»¥å¤„ç†æ›´å¤šå·¥ä½œã€‚ vert.x tcp çš„SSL&#x2F;TLSæ”¯æŒå¯ä»¥å°†TCPå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é…ç½®ä¸ºä½¿ç”¨ä¼ è¾“å±‚å®‰å…¨æ€§ - æ—©æœŸç‰ˆæœ¬çš„TLSç§°ä¸ºSSL åœ¨æœåŠ¡å™¨ä¸Šå¯ç”¨SSL&#x2F;TLS,å¹¶æŒ‡å®šæœåŠ¡å™¨çš„å¯†é’¥&#x2F;è¯ä¹¦ ä½¿ç”¨JDKé™„å¸¦çš„keytoolå®ç”¨ç¨‹åºç®¡ç†Javaå¯†é’¥åº“ ä½¿ç”¨å¯†é’¥æ–‡ä»¶åˆå§‹åŒ– è¯»å–å¯†é’¥å­˜å‚¨åŒºä½œä¸ºç¼“å†²åŒºå¹¶ç›´æ¥æä¾› PKCSï¼ƒ12æ ¼å¼çš„å¯†é’¥&#x2F;è¯ä¹¦ ä½¿ç”¨å¯†é’¥æ–‡ä»¶åˆå§‹åŒ– è¯»å–å¯†é’¥å­˜å‚¨åŒºä½œä¸ºç¼“å†²åŒºå¹¶ç›´æ¥æä¾› ä½¿ç”¨.pemæ–‡ä»¶åˆ†åˆ«æä¾›æœåŠ¡å™¨ç§é’¥å’Œè¯ä¹¦ ä½¿ç”¨å¯†é’¥æ–‡ä»¶åˆå§‹åŒ– è¿˜æ”¯æŒç¼“å†²åŒºé…ç½® ps:æš‚æ—¶å°±çœ‹è¿™ä¹ˆå¤šå§,æ”¹å¤©å¼€ä¸ªä¸“é¢˜ä¸“é—¨ç ”ç©¶ä¸€ä¸‹è¿™ä¸ªTSL&#x2F;SSL","date":"2024-12-31","categories":["java"],"tags":["vertx"]},{"title":"vert.x-ä½¿ç”¨(2)-åˆ›å»ºä¸€ä¸ªHTTPæœåŠ¡å™¨","url":"/2024/12/31/vert-x-ä½¿ç”¨-2--åˆ›å»ºä¸€ä¸ªHTTPæœåŠ¡å™¨/","content":"vert.x ç®€å•è¯·æ±‚å¤„ç† æ€»ç»“ä¸€ä¸‹,è¿™é‡Œè¯´çš„ç®€å•è¯·æ±‚å¤„ç†,å…¶å®å°±æ˜¯ä¸åŒ…æ‹¬è¡¨å•æäº¤å’Œæ–‡ä»¶ä¸Šä¼ çš„å¤„ç†,æ€»ç»“ä¸€ä¸‹ vert.x æä¾›äº†å‡ ç§å›è°ƒçš„ç”¨æ³• handle : æœ€åŸºæœ¬çš„è¯·æ±‚å¤„ç†æ–¹æ³•,ä¸ä¿è¯æ•°æ®å®Œæ•´ endHandlle : æœ€ç»ˆçŠ¶æ€çš„å¤„ç†å™¨,è¿™ä¸ªæ—¶å€™æ•°æ®å®Œæ•´ bodyHandle : ä¸“é—¨å¤„ç†ç®€å•ç±»å‹å¤§bodyçš„è¯·æ±‚,ç›¸å½“äºhandleå’Œendhandleé…åˆä½¿ç”¨çš„æƒ…å†µå…¶ä»–çš„å›è°ƒ loadhandle : è¡¨å•æ–‡ä»¶ä¸Šä¸‹ä¼ é€’å¾¡ç”¨handle exceptionHandler : å¼‚å¸¸å¾¡ç”¨handle vert.x æä¾›äº†éå¸¸æ–¹ä¾¿çš„å‚æ•°å¤„ç†æ–¹æ³•,æä¾›äº†ä¸€ä¸ªç‰¹æ®Šçš„Mapâ€“MultiMap,é€šè¿‡è¿™ä¸ªæ–¹æ³•å¯ä»¥å¾ˆæ–¹ä¾¿çš„è·å–header,params,è¡¨å•(ä¸‹é¢ä¼šè¯´æ˜å)ä¸­çš„æ•°æ®,å’Œæ™®é€šmapçš„ä¸åŒç‚¹æ˜¯,MultiMapæ”¯æŒç›¸åŒçš„keyçš„æƒ…å†µ vert.x ç®€å•å“åº”å‘é€å¤„ç† çŠ¶æ€ç è®¾ç½® vert.xçš„ requestå¯¹è±¡å¯ä»¥è®¾ç½®setStatusCodeæ¥è¡¨ç¤ºå¯¹åº”çš„çŠ¶æ€ç  å†™å…¥ç›¸å…³çš„å¤´éƒ¨ä¿¡æ¯ vert.x æä¾›çš„å¾ˆæ–¹ä¾¿çš„æ¶ˆæ¯å¤´éƒ¨è°ƒç”¨ vert.x åˆ†å—httpå“åº”æ”¯æŒ vert.x çš„è¡¨å•å¤„ç†æ–¹æ³•vert.xå¦‚æœè¦å¼€å¯è¡¨å•æ”¯æŒéœ€è¦é…ç½®ä¸€äº›reqçš„ç›¸å…³å‚æ•°(é’ˆå¯¹ä½¿ç”¨äº†application&#x2F;x-www-form-urlencodedæˆ–multipart&#x2F;form-dataåè®®çš„è¡¨å•) æˆ‘ä»¬ä¹‹å‰è®¨è®ºè¿‡MultiMapæ˜¯å•¥,è¿™é‡Œä¸å¤šè¯´äº†,ä»–å°†ä¼šè‡ªåŠ¨çš„è§£æè¡¨å•ä¸­çš„å†…å®¹ vert.x çš„æ–‡ä»¶å¤„ç†æ–¹æ³• è¿”å›æ–‡ä»¶æµ vert.x coreå¹¶æ²¡æœ‰æä¾›è·¯å¾„è§£æçš„æ–¹æ³•,è¿™ä¸€ç‚¹æˆ‘ä»¬éœ€è¦è‡ªå·±æ‰‹åŠ¨æ¨¡æ‹Ÿ,è¿™ä¸€æ®µä»£ç å®ç°äº†è¾“å…¥æ–‡ä»¶åç§°è¿”å›æ–‡ä»¶æµçš„ä¿¡æ¯ æ¥å—æ–‡ä»¶ä¸Šä¼ è¯·æ±‚ vert.xæä¾›äº†ä¸€ä¸ªæ—¶é—´loadhandle ä¸“é—¨å¤„ç†æ–‡ä»¶ä¸Šä¼ æ“ä½œ vert.x å¯¹defauleæˆ–è€…gzipå‹ç¼©ä½“çš„æ”¯æŒvert.xæä¾›ä¸€ä¸ªå¼€å…³æ¥æ§åˆ¶æ˜¯å¦è§£å‹ç¼©gzipæ–¹æ³• vert.x http clientå®¢æˆ·ç«¯å¤„ç†vert.x æä¾›äº†éå¸¸æ–¹ä¾¿çš„httpè¯·æ±‚å¤„ç†å‡½æ•° vert.xåˆ›å»ºæ–°çš„httpClientå®¢æˆ·ç«¯ vert.x é€šè¿‡ä½¿ç”¨è¿™ç§æ–¹æ³•,å¯ä»¥æ›´åŠ å¿«é€Ÿå’Œä¾¿åˆ©çš„åˆå§‹åŒ–å®¢æˆ·ç«¯,å¹¶ä¸ºä»–åˆå§‹åŒ–æŒ‡å®šçš„host post urlç­‰å‚æ•° vert.xå‘é€ç®€å•æ— bodyè¯·æ±‚ vert.x ä¸ºäº†æ–¹ä¾¿å‘é€ç®€å•çš„httpè¯·æ±‚,æä¾›äº†ä¸€ç»„æ–¹æ³•æ¥å¤„ç† vert.x é’ˆå¯¹ä¸‰ç§è¯·æ±‚åšäº†ç‰¹æ®ŠåŒ–çš„å¤„ç† GET HEAD OPTIONS , è¿™ä¸‰ç§æ–¹æ³•éƒ½ä¸ä¼šå¸¦æœ‰bodyå‚æ•°,è€Œæ˜¯ç›´æ¥å‘å‡ºè¯·æ±‚ æ–¹æ³•æ‰€æœ‰å‚æ•°å¦‚ä¸‹,å…¶ä¸­host port urlç­‰å¯ä»¥çœç•¥ å‘é€ä¸€èˆ¬è¯·æ±‚ vert.x æä¾›äº†requestæ–¹æ³•ç”¨æ¥å‘é€ä¸€èˆ¬çš„è¯·æ±‚ è¿™ä¸ªå°±å¾ˆæ˜æ˜¾äº†,vert.x æä¾›äº†requestæ–¹æ³•,æˆ‘ä»¬å¯ä»¥æŒ‡å®šhttpmethod host port url ç­‰ç­‰å‚æ•° æ³¨æ„æœ€åçš„endå’Œwriteræ–¹æ³•,è¿™äº›æ–¹æ³•å’Œserverä¸­çš„ç±»ä¼¼,å°†ä¼šåœ¨bodyä¸­æ·»åŠ ç›¸å…³çš„ä¿¡æ¯æ•°æ®,å¹¶ä¸”å¿…é¡»ä½¿ç”¨äº†endæ‰ä¼šçœŸæ­£çš„å‘é€æ•°æ® httpå®¢æˆ·ç«¯æ‹†åˆ†å†™æ³• æ³¨æ„ç‚¹: å½“å†™å…¥è¯·æ±‚æ—¶ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨writeå°†å¯¼è‡´è¯·æ±‚æ ‡å¤´è¢«å†™å…¥çº¿è·¯ å®é™…å†™å…¥æ˜¯å¼‚æ­¥çš„ï¼Œå¯èƒ½åœ¨è°ƒç”¨è¿”å›åçš„æŸä¸ªæ—¶é—´æ‰ä¼šå‘ç”Ÿ å…·æœ‰è¯·æ±‚ä¸»ä½“çš„éåˆ†å—HTTPè¯·æ±‚éœ€è¦æä¾›Content-Lengthæ ‡å¤´ã€‚ å› æ­¤ï¼Œå¦‚æœæ‚¨æ²¡æœ‰ä½¿ç”¨åˆ†å—HTTPï¼Œåˆ™å¿…é¡»Content-Lengthåœ¨å†™å…¥è¯·æ±‚ä¹‹å‰è®¾ç½®æ ‡å¤´ï¼Œå¦åˆ™å°†ä¸ºæ—¶å·²æ™šã€‚ å¦‚æœæ‚¨æ­£åœ¨è°ƒç”¨endå¸¦æœ‰å­—ç¬¦ä¸²æˆ–ç¼“å†²åŒºçš„æ–¹æ³•ä¹‹ä¸€ï¼Œåˆ™Vert.xå°†Content-Lengthåœ¨å†™å…¥è¯·æ±‚ä¸»ä½“ä¹‹å‰è‡ªåŠ¨è®¡ç®—å¹¶è®¾ç½®æ ‡å¤´ã€‚ å¦‚æœæ‚¨ä½¿ç”¨HTTPåˆ†å—ï¼ŒContent-Lengthåˆ™ä¸éœ€è¦æ ‡å¤´ï¼Œå› æ­¤æ‚¨æ— éœ€é¢„å…ˆè®¡ç®—å¤§å°ã€‚ vert.x æ ‡å‡†å¤´å†™å…¥ ç¬¬ä¸€ç§æ–¹æ³•,ä½¿ç”¨headçš„Multipmapå®ç° request ç›´æ¥å†™å…¥header åˆ†å—çš„HTTPè¯·æ±‚è¿™å…è®¸HTTPè¯·æ±‚ä¸»ä½“ä»¥å—çš„å½¢å¼å†™å…¥ï¼Œå¹¶ä¸”é€šå¸¸åœ¨å¤§å‹è¯·æ±‚ä¸»ä½“æµå¼ä¼ è¾“åˆ°æœåŠ¡å™¨æ—¶ä½¿ç”¨ï¼ŒæœåŠ¡å™¨çš„å¤§å°äº‹å…ˆä¸çŸ¥é“ã€‚ æ‚¨ä½¿ç”¨HTTPå°†HTTPè¯·æ±‚ç½®äºåˆ†å—æ¨¡å¼setChunkedã€‚ åœ¨chunkedæ¨¡å¼ä¸‹ï¼Œæ¯æ¬¡è°ƒç”¨writeéƒ½ä¼šå¯¼è‡´æ–°çš„å—è¢«å†™å…¥çº¿è·¯ã€‚åœ¨åˆ†å—æ¨¡å¼ä¸‹ï¼Œæ— éœ€é¢„å…ˆè®¾ç½®Content-Lengthè¯·æ±‚ã€‚ httpè¶…æ—¶client æˆ–è€… Clientçš„Optionå¯ä»¥è®¾ç½®Timeoutè¶…æ—¶äº‹ä»¶ å®¢æˆ·ç«¯ä»¥æ–‡ä»¶å†…å®¹å‘é€è¯·æ±‚ä¿¡æ¯vert.x å¯ä»¥å°†æœ¬åœ°æ–‡ä»¶çš„å†…å®¹ä½œä¸ºè¾“å‡º,å‘é€å‡ºå» å®¢æˆ·ç«¯å¼‚å¸¸å¤„ç†vert.x æä¾›äº†ä¸€ä¸ªæ–¹æ³•å¯ä»¥å¤„ç†å®¢æˆ·ç«¯çš„å¼‚å¸¸é—®é¢˜ å®¢æˆ·ç«¯å¤„ç†å“åº” å¼•ç”³ä¸€ä¸‹:vert.xå…¶å®æœ¬è´¨ä¸Šè¿˜æ˜¯èƒ½åœ¨clientä¸­ç›´æ¥ç¼–å†™å›è°ƒå‡½æ•°çš„,æä¾›ä¸€å®šçš„ä¾¿åˆ©æ€§,æ¯”å¦‚è¿™æ · vert.x clientçš„cookieè·å– vert.x é‡å®šå‘å’Œè‡ªå®šä¹‰é‡å®šå‘ vert.xé»˜è®¤é‡å®šå‘ä½¿ç”¨æ–¹æ³• è‡ªå®šä¹‰é‡å®šå‘ è¯¥æ”¿ç­–å¤„ç†åŸå§‹HttpClientResponseæ”¶åˆ°å¹¶è¿”å›null æˆ–è€…a Futureã€‚ å½“nullè¿”å›ï¼ŒåŸæ¥çš„å“åº”è¢«å¤„ç† è¿”å›Futureæ—¶ï¼Œè¯·æ±‚å°†åœ¨æˆåŠŸå®Œæˆåå‘é€ è¿”å›futureæ—¶ï¼Œå°†åœ¨å¤±è´¥æ—¶è°ƒç”¨è¯·æ±‚ä¸­è®¾ç½®çš„å¼‚å¸¸å¤„ç†ç¨‹åº","date":"2024-12-31","categories":["java"],"tags":["vertx"]},{"title":"vert.x-ä½¿ç”¨(3)-jdbcæ•°æ®åº“æ”¯æŒ","url":"/2024/12/31/vert-x-ä½¿ç”¨-3--jdbcæ•°æ®åº“æ”¯æŒ/","content":"","date":"2024-12-31","categories":["java"],"tags":["vertx"]},{"title":"vertx","url":"/2024/12/31/vertx/","content":"Vert.x å¿«é€Ÿå…¥é—¨å’Œè¿›é˜¶ä½¿ç”¨Vert.x å¿«é€Ÿå…¥é—¨vertxç®€ä»‹ vertx çš„ç°çŠ¶å’ŒèƒŒåæ”¯æŒçš„ç»„ç»‡ vertx æ˜¯ eclipseåŸºé‡‘ä¼šçš„ä¸€ä¸ªé¡¶çº§é¡¹ç›®,ç›®å‰ç¤¾åŒºéå¸¸æ´»è·ƒ,æ˜¯åœ¨å›½å¤–éå¸¸ç«çš„ä¸€ä¸ªæ¡†æ¶ vertxçš„æ ¸å¿ƒæ€æƒ³ Reactive : äº‹ä»¶é©±åŠ¨å¼ç¼–ç¨‹æ¨¡å‹ reactiveç»„ç»‡å®£è¨€ vertxç”Ÿæ€ç³»ç»Ÿå®Œå–„ å’Œspring è¿›è¡Œå¯¹æ¯” é¡¹ç›® Spring Vertx æ ¸å¿ƒæ¡†æ¶ spring-core vertx-core Webå¼€å‘ spring-webmvc vertx-web jdbcæ¡†æ¶ spring-jdbc vertx-jdbc-client redis spring-data-redis vertx-redis-client å¾®æœåŠ¡ spring-cloud vertx-hazelcast vertxæ ¸å¿ƒåŠŸèƒ½ç‚¹1. ä½¿ç”¨reactiveæ¨¡å‹å¿«é€Ÿæ„å»ºç®€å•webåº”ç”¨vertx æ„å»ºç®€å• webåº”ç”¨åˆ†ä¸ºä¸‰æ­¥ åˆ›å»ºå¹¶é…ç½®Vertxå¯¹è±¡å®ä¾‹ åˆ›å»ºå¹¶é…ç½®HttpServerå¯¹è±¡å®ä¾‹ ä½¿ç”¨å›è°ƒæ–¹å¼ç¼–å†™ä¸šåŠ¡é€»è¾‘ä»£ç  å®Œæ•´ç¤ºä¾‹ 2. å†…ç½®å¾®æœåŠ¡&#x2F;åˆ†å¸ƒå¼æ”¯æŒEventBus eventBusç®€ä»‹ eventBus å®˜æ–¹å¯¹çš„å®šä¹‰æ˜¯vertxçš„â€ç¥ç»ç³»ç»Ÿâ€,ç”¨æ¥æ¨¡ç³Šæ‰ç³»ç»Ÿç›¸äº’è°ƒç”¨æ—¶å€™çš„å¼ºè€¦åˆ\\ç¡¬ç¼–ç çš„éƒ¨åˆ†. eventBus å°†å„ä¸ªé€»è¾‘æ¨¡å—åŒ–,å¹¶ä¸”æ”¯æŒä¸åŒè¯­è¨€ç¼–å†™çš„æ¨¡å—ç›¸äº’é€šä¿¡ event busæ”¯æŒå‘å¸ƒ&#x2F;è®¢é˜…æ¨¡å¼ï¼Œç‚¹å¯¹ç‚¹æ¨¡å¼ï¼Œå’Œè¯·æ±‚&#x2F;å“åº”æ¨¡å¼ã€‚ EventBus ä½¿ç”¨æ–¹æ³•EventBus çš„ä½¿ç”¨æ–¹æ³•éå¸¸ç®€å•,åªéœ€è¦åœ¨ä¸Šé¢å®ç°çš„ç®€å•æœåŠ¡å™¨åŠ ä¸Šå‡ è¡Œå°±å¯ä»¥å®ç°äº† EventBus æ‰©å±•åˆ°åˆ†å¸ƒå¼æ¨¡å¼Vertx å†…ç½®äº†ä¸€ä¸ªæ¥å£ClusterManager,é€šè¿‡è¿™ä¸ªæ¥å£å¯ä»¥è‡ªå·±å®ç° åˆ†å¸ƒå¼é€»è¾‘ Vertx å®˜æ–¹æä¾›äº†ä¸€ä¸ªé»˜è®¤çš„ClusterManagerå®ç° - Hazelcast Hazelcast ç®€ä»‹ Hazelcast æ˜¯ç”±Hazelcastå…¬å¸å¼€å‘å’Œç»´æŠ¤çš„å¼€æºäº§å“ï¼Œå¯ä»¥ä¸ºåŸºäºjvmç¯å¢ƒè¿è¡Œçš„å„ç§åº”ç”¨æä¾›åˆ†å¸ƒå¼é›†ç¾¤å’Œåˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡ã€‚ç±»ä¼¼golangçš„etcd,ä¸è¿‡å¯ä»¥åµŒå…¥åˆ°javaä¸­è¿è¡Œå¯ä»¥åšâ€æœåŠ¡å‘ç°æ²»ç†â€,â€åˆ†å¸ƒå¼å­˜å‚¨â€çš„åº•å±‚ä¾èµ–. Vertx åµŒå…¥ Hazelcast å®ç°åˆ†å¸ƒå¼éå¸¸ç®€å•,åªéœ€è¦åœ¨EventBusä¸Šé¢å¢åŠ å‡ è¡Œä»£ç å°±èƒ½å®ç° server client 3. æ’ä»¶åŒ–ä»£ç ç»„ç»‡æ–¹å¼vertxæ”¯æŒåŸºäºVerticleæ¥å£çš„æ–¹å¼ç»„ç»‡ä»£ç ,æ²¿ç”¨ä¸€ç§æ’ä»¶åŒ–ç¼–ç¨‹çš„æ€æƒ³,æœ€å¤§é™åº¦çš„æé«˜åŠŸèƒ½æˆ–è€…ä»£ç é€»è¾‘ç»„ç»‡è¿‡ç¨‹ä¸­çš„çµæ´»åº¦ æ’ä»¶åŒ–æ€æƒ³çš„å†å² æ’ä»¶åŒ–æ€æƒ³æœ€æ—©æ˜¯æ¥æºäºandroidå¼€å‘,æ—©æœŸçš„androidå¼€å‘å› ä¸ºandroid jvmçš„é—®é¢˜å­˜åœ¨64Kæ–¹æ³•æ•°é­”å’’-androidçš„Dalvik vmçš„å¯æ‰§è¡Œæ–‡ä»¶è§„èŒƒé™åˆ¶äº†å•ä¸ª.dexæ–‡ä»¶æœ€å¤šå¼•ç”¨çš„æ–¹æ³•æ•°æ˜¯65536ä¸ªã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜,æœ‰äººæƒ³æƒ³å‡ºäº†åˆ©ç”¨javaçƒ­éƒ¨ç½²çš„èƒ½åŠ›å¼€å‘æ’ä»¶åŒ–åŠŸèƒ½,æ”¯æŒæ’ä»¶åŒ–çš„appå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ è½½å’Œè¿è¡Œclassæ–‡ä»¶ï¼Œè¿™æ ·ä¾¿å¯ä»¥å°†appä¸­ä¸€äº›ä¸å¸¸ç”¨çš„åŠŸèƒ½æ¨¡å—åšæˆæ’ä»¶ï¼Œå‡å°äº†å®‰è£…åŒ…çš„å¤§å°å’Œå‡½æ•°æ•°é‡ , å¹¶ä¸”å®ç°äº†appåŠŸèƒ½çš„åŠ¨æ€æ‰©å±• vertx å¼•å…¥æ’ä»¶åŒ–å¼€å‘åŒæ ·éå¸¸ç®€å• å…±éœ€è¦ä¸¤éƒ¨ æ„é€ å¥½Verticleæ¥å£å®ç°ç±» VertxåŠ è½½è¿™ä¸ªå®ç°ç±» 4. åŸºäºjvmçš„å¤šè¯­è¨€æ”¯æŒvertxçš„å¤šè¯­è¨€æ”¯æŒå…¶å®ä¾èµ–äº Vertxçš„æ’ä»¶åŒ–éƒ¨ç½²å’Œjvmçš„å¤šè¯­è¨€æ”¯æŒ ä¾‹å­ groovy Verticle éƒ¨ç½² vertx åŸºç¡€éƒ¨åˆ†æ€»ç»“vertx æä¾›äº†å››å¤§ç‰¹æ€§ é«˜æ€§èƒ½ - åº•å±‚netty &#x2F; å¼‚æ­¥åŒ–ç¼–ç¨‹ EventBuså†…ç½®åˆ†å¸ƒå¼ Hazelcast Verticleæ’ä»¶åŒ– é«˜åº¦æ‰©å±•æ€§ å¤šè¯­è¨€æ”¯æŒ ä¾èµ–jvm vertxè¿›é˜¶ - å®ç”¨vertx å®ç°ä¸€ä¸ªç®€å•çš„åœ¨çº¿å‡½æ•°è¿è¡Œå¹³å°(Faaså¹³å°)ä¸€ä¸ªFaaséœ€è¦çš„ä¸œè¥¿ æ”¯æŒå‡½æ•°è¿è¡Œ åˆ†å¸ƒå¼è°ƒç”¨(å‡½æ•°åŠæœåŠ¡) å¤šè¯­è¨€æ”¯æŒ (å¤šç§è¯­è¨€ç¼–å†™å‡½æ•°) Vertx å’ŒFaas éœ€æ±‚çš„å¯¹æ¯” å‡½æ•°è¿è¡Œ - vertx Verticle å¯ä»¥å®ç° åˆ†å¸ƒå¼è°ƒç”¨ - vertx Verticle å¯ä»¥å†…ç½®çš„ä½¿ç”¨EventBuså®ç°åˆ†å¸ƒå¼ å¤šè¯­è¨€æ”¯æŒ - vertx å¤©ç„¶æ”¯æŒå¤šè¯­è¨€ å®ç° - >è½»é‡çº§å‡½æ•°è¿è¡Œæ—¶å¼•æ“","date":"2024-12-31","categories":["java"],"tags":["vertx"]},{"title":"kafka_consumer","url":"/2024/12/31/kafka_consumer/","content":"kafka consumerkafka æ¶ˆè´¹è€…ä¸æ¶ˆè´¹ç»„æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰è´Ÿè´£è®¢é˜…Kafkaä¸­çš„ä¸»é¢˜ï¼ˆTopicï¼‰ï¼Œå¹¶ä¸”ä»è®¢é˜…çš„ä¸»é¢˜ä¸Šæ‹‰å–æ¶ˆæ¯ã€‚ä¸å…¶ä»–ä¸€äº›æ¶ˆæ¯ä¸­é—´ä»¶ä¸åŒçš„æ˜¯ï¼šåœ¨Kafkaçš„æ¶ˆè´¹ç†å¿µä¸­è¿˜æœ‰ä¸€å±‚æ¶ˆè´¹ç»„ï¼ˆConsumer Groupï¼‰çš„æ¦‚å¿µï¼Œæ¯ä¸ªæ¶ˆè´¹è€…éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„æ¶ˆè´¹ç»„ã€‚å½“æ¶ˆæ¯å‘å¸ƒåˆ°ä¸»é¢˜åï¼Œåªä¼šè¢«æŠ•é€’ç»™è®¢é˜…å®ƒçš„æ¯ä¸ªæ¶ˆè´¹ç»„ä¸­çš„ä¸€ä¸ªæ¶ˆè´¹è€… kafkaè¿™å—çš„æ¨¡å‹å¤§è‡´æ˜¯è¿™ç§ç»“æ„ï¼š ä¸»é¢˜ - ç»†åˆ†æˆåˆ†åŒº -> æ¶ˆè´¹è€…ç»„è®¢é˜…ä¸»é¢˜ -> ç»„ä¸­çš„æ¶ˆè´¹è€…åˆ†åˆ«è®¢é˜… åˆ†åŒº å¯¹äºæ¶ˆæ¯ä¸­é—´ä»¶è€Œè¨€ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ¶ˆæ¯æŠ•é€’æ¨¡å¼ï¼šç‚¹å¯¹ç‚¹ï¼ˆP2Pï¼ŒPoint-to-Pointï¼‰æ¨¡å¼å’Œå‘å¸ƒ&#x2F;è®¢é˜…ï¼ˆPub&#x2F;Subï¼‰æ¨¡å¼ã€‚ ç‚¹å¯¹ç‚¹æ¨¡å¼æ˜¯åŸºäºé˜Ÿåˆ—çš„ï¼Œæ¶ˆæ¯ç”Ÿäº§è€…å‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—ï¼Œæ¶ˆæ¯æ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­æ¥æ”¶æ¶ˆæ¯ã€‚ å‘å¸ƒè®¢é˜…æ¨¡å¼å®šä¹‰äº†å¦‚ä½•å‘ä¸€ä¸ªå†…å®¹èŠ‚ç‚¹å‘å¸ƒå’Œè®¢é˜…æ¶ˆæ¯ï¼Œè¿™ä¸ªå†…å®¹èŠ‚ç‚¹ç§°ä¸ºä¸»é¢˜ï¼ˆTopicï¼‰ï¼Œä¸»é¢˜å¯ä»¥è®¤ä¸ºæ˜¯æ¶ˆæ¯ä¼ é€’çš„ä¸­ä»‹ï¼Œæ¶ˆæ¯å‘å¸ƒè€…å°†æ¶ˆæ¯å‘å¸ƒåˆ°æŸä¸ªä¸»é¢˜ï¼Œè€Œæ¶ˆæ¯è®¢é˜…è€…ä»ä¸»é¢˜ä¸­è®¢é˜…æ¶ˆæ¯ã€‚ æ¶ˆè´¹è€…å¹¶éé€»è¾‘ä¸Šçš„æ¦‚å¿µï¼Œå®ƒæ˜¯å®é™…çš„åº”ç”¨å®ä¾‹ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¿›ç¨‹ã€‚åŒä¸€ä¸ªæ¶ˆè´¹ç»„å†…çš„æ¶ˆè´¹è€…æ—¢å¯ä»¥éƒ¨ç½²åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥éƒ¨ç½²åœ¨ä¸åŒçš„æœºå™¨ä¸Šã€‚ æ¯ä¸€ä¸ªæ¶ˆè´¹ç»„éƒ½ä¼šæœ‰ä¸€ä¸ªå›ºå®šçš„åç§°ï¼Œæ¶ˆè´¹è€…åœ¨è¿›è¡Œæ¶ˆè´¹å‰éœ€è¦æŒ‡å®šå…¶æ‰€å±æ¶ˆè´¹ç»„çš„åç§°ï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡æ¶ˆè´¹è€…å®¢æˆ·ç«¯å‚æ•°group.idæ¥é…ç½®ï¼Œé»˜è®¤å€¼ä¸ºç©ºå­—ç¬¦ä¸²ã€‚ ä¸»é¢˜ä½¿å¾—æ¶ˆæ¯çš„è®¢é˜…è€…å’Œå‘å¸ƒè€…äº’ç›¸ä¿æŒç‹¬ç«‹ï¼Œä¸éœ€è¦è¿›è¡Œæ¥è§¦å³å¯ä¿è¯æ¶ˆæ¯çš„ä¼ é€’ï¼Œå‘å¸ƒ&#x2F;è®¢é˜…æ¨¡å¼åœ¨æ¶ˆæ¯çš„ä¸€å¯¹å¤šå¹¿æ’­æ—¶é‡‡ç”¨ã€‚Kafka åŒæ—¶æ”¯æŒä¸¤ç§æ¶ˆæ¯æŠ•é€’æ¨¡å¼ï¼Œè€Œè¿™æ­£æ˜¯å¾—ç›Šäºæ¶ˆè´¹è€…ä¸æ¶ˆè´¹ç»„æ¨¡å‹çš„å¥‘åˆï¼š å¦‚æœæ‰€æœ‰çš„æ¶ˆè´¹è€…éƒ½éš¶å±äºåŒä¸€ä¸ªæ¶ˆè´¹ç»„ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ¶ˆæ¯éƒ½ä¼šè¢«å‡è¡¡åœ°æŠ•é€’ç»™æ¯ä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œå³æ¯æ¡æ¶ˆæ¯åªä¼šè¢«ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†ï¼Œè¿™å°±ç›¸å½“äºç‚¹å¯¹ç‚¹æ¨¡å¼çš„åº”ç”¨ã€‚ å¦‚æœæ‰€æœ‰çš„æ¶ˆè´¹è€…éƒ½éš¶å±äºä¸åŒçš„æ¶ˆè´¹ç»„ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ¶ˆæ¯éƒ½ä¼šè¢«å¹¿æ’­ç»™æ‰€æœ‰çš„æ¶ˆè´¹è€…ï¼Œå³æ¯æ¡æ¶ˆæ¯ä¼šè¢«æ‰€æœ‰çš„æ¶ˆè´¹è€…å¤„ç†ï¼Œè¿™å°±ç›¸å½“äºå‘å¸ƒ&#x2F;è®¢é˜…æ¨¡å¼çš„åº”ç”¨ã€‚ ä¸€ä¸ªæ­£å¸¸çš„æ¶ˆè´¹é€»è¾‘éœ€è¦å…·å¤‡ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼ˆ1ï¼‰é…ç½®æ¶ˆè´¹è€…å®¢æˆ·ç«¯å‚æ•°åŠåˆ›å»ºç›¸åº”çš„æ¶ˆè´¹è€…å®ä¾‹ã€‚ï¼ˆ2ï¼‰è®¢é˜…ä¸»é¢˜ã€‚ï¼ˆ3ï¼‰æ‹‰å–æ¶ˆæ¯å¹¶æ¶ˆè´¹ã€‚ï¼ˆ4ï¼‰æäº¤æ¶ˆè´¹ä½ç§»ã€‚ï¼ˆ5ï¼‰å…³é—­æ¶ˆè´¹è€…å®ä¾‹ã€‚ é’ˆå¯¹ä¹‹å‰çš„æ¨¡å‹ ï¼Œ æˆ‘ä»¬åœ¨åˆå§‹åŒ–kafkaå¯¹åº”çš„é…ç½®çš„æ—¶å€™å°±éœ€è¦é…ç½®è¿™ä¸ªæ¶ˆè´¹è€…å¯¹åº”çš„æ¶ˆè´¹ç»„ï¼ˆå’Œå…¶ä»–è®¢é˜…è€…ç»„ç›¸åŒæˆ–è€…ä¸åŒèƒ½å†³å®šè¿™ä¸ªæ¶ˆæ¯æ˜¯å¹¿æ’­è¿˜æ˜¯ç‚¹å¯¹ç‚¹ï¼‰ kafkaä¸‰ç§ä¸åŒè®¢é˜…çŠ¶æ€é›†åˆè®¢é˜…çš„æ–¹å¼subscribeï¼ˆCollectionï¼‰æ­£åˆ™è¡¨è¾¾å¼è®¢é˜…çš„æ–¹å¼subscribeï¼ˆPatternï¼‰æŒ‡å®šåˆ†åŒºçš„è®¢é˜…æ–¹å¼assignï¼ˆCollectionï¼‰åˆ†è¡¨ä»£è¡¨äº†ä¸‰ç§ä¸åŒçš„è®¢é˜…çŠ¶æ€ï¼šAUTO_TOPICSã€AUTO_PATTERNå’ŒUSER_ASSIGNEDï¼ˆå¦‚æœæ²¡æœ‰è®¢é˜…ï¼Œé‚£ä¹ˆè®¢é˜…çŠ¶æ€ä¸ºNONEï¼‰ã€‚ USER_ASSIGNEDï¼ˆå¦‚æœæ²¡æœ‰è®¢é˜…ï¼Œé‚£ä¹ˆè®¢é˜…çŠ¶æ€ä¸ºNONEï¼‰ã€‚ç„¶è€Œè¿™ä¸‰ç§çŠ¶æ€æ˜¯äº’æ–¥çš„ï¼Œåœ¨ä¸€ä¸ªæ¶ˆè´¹è€…ä¸­åªèƒ½ä½¿ç”¨å…¶ä¸­çš„ä¸€ç§ï¼Œå¦åˆ™ä¼šæŠ¥å‡ºIllegalStateExceptionå¼‚å¸¸ é€šè¿‡ subscribeï¼ˆï¼‰æ–¹æ³•è®¢é˜…ä¸»é¢˜å…·æœ‰æ¶ˆè´¹è€…è‡ªåŠ¨å†å‡è¡¡çš„åŠŸèƒ½ï¼Œåœ¨å¤šä¸ªæ¶ˆè´¹è€…çš„æƒ…å†µä¸‹å¯ä»¥æ ¹æ®åˆ†åŒºåˆ†é…ç­–ç•¥æ¥è‡ªåŠ¨åˆ†é…å„ä¸ªæ¶ˆè´¹è€…ä¸åˆ†åŒºçš„å…³ç³»ã€‚å½“æ¶ˆè´¹ç»„å†…çš„æ¶ˆè´¹è€…å¢åŠ æˆ–å‡å°‘æ—¶ï¼Œåˆ†åŒºåˆ†é…å…³ç³»ä¼šè‡ªåŠ¨è°ƒæ•´ï¼Œä»¥å®ç°æ¶ˆè´¹è´Ÿè½½å‡è¡¡åŠæ•…éšœè‡ªåŠ¨è½¬ç§»ã€‚è€Œé€šè¿‡assignï¼ˆï¼‰æ–¹æ³•è®¢é˜…åˆ†åŒºæ—¶ï¼Œæ˜¯ä¸å…·å¤‡æ¶ˆè´¹è€…è‡ªåŠ¨å‡è¡¡çš„åŠŸèƒ½çš„ï¼Œå…¶å®è¿™ä¸€ç‚¹ä»assignï¼ˆï¼‰æ–¹æ³•çš„å‚æ•°ä¸­å°±å¯ä»¥çœ‹å‡ºç«¯å€ªï¼Œä¸¤ç§ç±»å‹çš„subscribeï¼ˆï¼‰éƒ½æœ‰ConsumerRebalanceListenerç±»å‹å‚æ•°çš„æ–¹æ³•ï¼Œè€Œassignï¼ˆï¼‰æ–¹æ³•å´æ²¡æœ‰ é›†åˆå’Œæ­£åˆ™å¯¹åº”ï¼šKafkaConsumer.subscribeï¼ˆï¼‰æ–¹æ³•åˆ†åŒºè®¢é˜…å¯¹åº”ï¼šKafkaConsumer.assginï¼ˆï¼‰æ–¹æ³• ï¼Œ è¿™ä¸ªéœ€è¦åˆ¶å®šè¿™ä¸ªé›†åˆå®šäºé‚£ä¸ªæ¶ˆæ¯çš„é‚£ä¸ªä½ç½® kafkaå®¢æˆ·ç«¯ååºåˆ—åŒ–åŒç”Ÿäº§è€… ï¼Œ è¦ä¸€ä¸€å¯¹åº” kafka æ¶ˆæ¯æ¶ˆè´¹Kafkaä¸­çš„æ¶ˆè´¹æ˜¯åŸºäºæ‹‰æ¨¡å¼çš„ã€‚æ¶ˆæ¯çš„æ¶ˆè´¹ä¸€èˆ¬æœ‰ä¸¤ç§æ¨¡å¼ï¼šæ¨æ¨¡å¼å’Œæ‹‰æ¨¡å¼ã€‚æ¨æ¨¡å¼æ˜¯æœåŠ¡ç«¯ä¸»åŠ¨å°†æ¶ˆæ¯æ¨é€ç»™æ¶ˆè´¹è€…ï¼Œè€Œæ‹‰æ¨¡å¼æ˜¯æ¶ˆè´¹è€…ä¸»åŠ¨å‘æœåŠ¡ç«¯å‘èµ·è¯·æ±‚æ¥æ‹‰å–æ¶ˆæ¯ã€‚ Kafkaä¸­çš„æ¶ˆæ¯æ¶ˆè´¹æ˜¯ä¸€ä¸ªä¸æ–­è½®è¯¢çš„è¿‡ç¨‹ï¼Œæ¶ˆè´¹è€…æ‰€è¦åšçš„å°±æ˜¯é‡å¤åœ°è°ƒç”¨pollï¼ˆï¼‰æ–¹æ³•ï¼Œè€Œpollï¼ˆï¼‰æ–¹æ³•è¿”å›çš„æ˜¯æ‰€è®¢é˜…çš„ä¸»é¢˜ï¼ˆåˆ†åŒºï¼‰ä¸Šçš„ä¸€ç»„æ¶ˆæ¯ kafka pollè¿‡ç¨‹åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¯ä»¥ç®€å•åœ°è®¤ä¸ºpollï¼ˆï¼‰æ–¹æ³•åªæ˜¯æ‹‰å–ä¸€ä¸‹æ¶ˆæ¯è€Œå·²ï¼Œä½†å°±å…¶å†…éƒ¨é€»è¾‘è€Œè¨€å¹¶ä¸ç®€å•ï¼Œå®ƒæ¶‰åŠæ¶ˆè´¹ä½ç§»ã€æ¶ˆè´¹è€…åè°ƒå™¨ã€ç»„åè°ƒå™¨ã€æ¶ˆè´¹è€…çš„é€‰ä¸¾ã€åˆ†åŒºåˆ†é…çš„åˆ†å‘ã€å†å‡è¡¡çš„é€»è¾‘ã€å¿ƒè·³ç­‰å†…å®¹ ä¸‹é¢ä¸€ä¸ªä¸€ä¸ªä»‹ç» æ¶ˆè´¹ä½ç§»å¯¹offsetåšäº†ä¸€äº›åŒºåˆ†ï¼šå¯¹äºæ¶ˆæ¯åœ¨åˆ†åŒºä¸­çš„ä½ç½®ï¼Œæˆ‘ä»¬å°†offsetç§°ä¸ºâ€œåç§»é‡â€ï¼›å¯¹äºæ¶ˆè´¹è€…æ¶ˆè´¹åˆ°çš„ä½ç½®ï¼Œå°† offset ç§°ä¸ºâ€œä½ç§»â€ï¼Œæœ‰æ—¶å€™ä¹Ÿä¼šæ›´æ˜ç¡®åœ°ç§°ä¹‹ä¸ºâ€œæ¶ˆè´¹ä½ç§»â€ åœ¨æ¯æ¬¡è°ƒç”¨pollï¼ˆï¼‰æ–¹æ³•æ—¶ï¼Œå®ƒè¿”å›çš„æ˜¯è¿˜æ²¡æœ‰è¢«æ¶ˆè´¹è¿‡çš„æ¶ˆæ¯é›†ï¼ˆå½“ç„¶è¿™ä¸ªå‰ææ˜¯æ¶ˆæ¯å·²ç»å­˜å‚¨åœ¨Kafka ä¸­äº†ï¼Œå¹¶ä¸”æš‚ä¸è€ƒè™‘å¼‚å¸¸æƒ…å†µçš„å‘ç”Ÿï¼‰ï¼Œè¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œå°±éœ€è¦è®°å½•ä¸Šä¸€æ¬¡æ¶ˆè´¹æ—¶çš„æ¶ˆè´¹ä½ç§»ã€‚å¹¶ä¸”è¿™ä¸ªæ¶ˆè´¹ä½ç§»å¿…é¡»åšæŒä¹…åŒ–ä¿å­˜ï¼Œè€Œä¸æ˜¯å•å•ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå¦åˆ™æ¶ˆè´¹è€…é‡å¯ä¹‹åå°±æ— æ³•çŸ¥æ™“ä¹‹å‰çš„æ¶ˆè´¹ä½ç§»ã€‚ åœ¨æ—§æ¶ˆè´¹è€…å®¢æˆ·ç«¯ä¸­ï¼Œæ¶ˆè´¹ä½ç§»æ˜¯å­˜å‚¨åœ¨ZooKeeperä¸­çš„ã€‚è€Œåœ¨æ–°æ¶ˆè´¹è€…å®¢æˆ·ç«¯ä¸­ï¼Œæ¶ˆè´¹ä½ç§»å­˜å‚¨åœ¨Kafkaå†…éƒ¨çš„ä¸»é¢˜__consumer_offsetsä¸­ã€‚è¿™é‡ŒæŠŠå°†æ¶ˆè´¹ä½ç§»å­˜å‚¨èµ·æ¥ï¼ˆæŒä¹…åŒ–ï¼‰çš„åŠ¨ä½œç§°ä¸ºâ€œæäº¤â€ï¼Œæ¶ˆè´¹è€…åœ¨æ¶ˆè´¹å®Œæ¶ˆæ¯ä¹‹åéœ€è¦æ‰§è¡Œæ¶ˆè´¹ä½ç§»çš„æäº¤ã€‚ å› ä¸ºkafkaçš„è®¢é˜…æœºåˆ¶ï¼Œåœ¨ä¸€ä¸ªä¸»é¢˜ä¸‹çš„ä¸€ä¸ªåˆ†åŒºåªèƒ½è¢«è®¢é˜…è¿™ä¸ªä¸»é¢˜çš„ä»»æ„æ¶ˆè´¹è€…ç»„ä¸­çš„ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ å’Œä¹‹å‰çš„HWå’ŒLEO ç±»ä¼¼ ï¼Œ è¿™é‡Œæäº¤çš„åç§»é‡å¹¶ä¸æ˜¯å½“å‰æ¶ˆè´¹ç©çš„ä½ç½®ï¼Œè€Œæ˜¯ä¸‹ä¸€ä¸ªä½ç½® åœ¨ Kafka ä¸­é»˜è®¤çš„æ¶ˆè´¹ä½ç§»çš„æäº¤æ–¹å¼æ˜¯è‡ªåŠ¨æäº¤ï¼Œè¿™ä¸ªæ˜¯å®šæœŸçš„ï¼Œæ¶ˆè´¹è€…æ¯éš”5ç§’ä¼šå°†æ‹‰å–åˆ°çš„æ¯ä¸ªåˆ†åŒºä¸­æœ€å¤§çš„æ¶ˆæ¯ä½ç§»è¿›è¡Œæäº¤ã€‚è‡ªåŠ¨ä½ç§»æäº¤çš„åŠ¨ä½œæ˜¯åœ¨pollï¼ˆï¼‰æ–¹æ³•çš„é€»è¾‘é‡Œå®Œæˆçš„ï¼Œåœ¨æ¯æ¬¡çœŸæ­£å‘æœåŠ¡ç«¯å‘èµ·æ‹‰å–è¯·æ±‚ä¹‹å‰ä¼šæ£€æŸ¥æ˜¯å¦å¯ä»¥è¿›è¡Œä½ç§»æäº¤ï¼Œå¦‚æœå¯ä»¥ï¼Œé‚£ä¹ˆå°±ä¼šæäº¤ä¸Šä¸€æ¬¡è½®è¯¢çš„ä½ç§» æ¶ˆæ¯å¼‚å¸¸çš„ä¸¤ç§æƒ…å†µ 1. é‡å¤æ¶ˆè´¹ï¼šæ¶ˆè´¹å®Œä½†æ˜¯ç»“æœå¹¶æ²¡æœ‰æäº¤ï¼Œé‡æ–°pollå¯¼è‡´é‡æ–°æ¶ˆè´¹ 2. ä¸¢å¤±ï¼šæ¶ˆè´¹ä¸­å‡ºç°å¼‚å¸¸ï¼Œç„¶åpolläº†ï¼Œå¯¼è‡´å¼‚å¸¸ä¹‹åçš„æ¶ˆæ¯æ²¡æœ‰è¢«æ¶ˆè´¹ è‡ªåŠ¨ä½ç§»æäº¤çš„æ–¹å¼åœ¨æ­£å¸¸æƒ…å†µä¸‹ä¸ä¼šå‘ç”Ÿæ¶ˆæ¯ä¸¢å¤±æˆ–é‡å¤æ¶ˆè´¹çš„ç°è±¡ï¼Œä½†æ˜¯åœ¨ç¼–ç¨‹çš„ä¸–ç•Œé‡Œå¼‚å¸¸æ— å¯é¿å…ï¼Œä¸æ­¤åŒæ—¶ï¼Œè‡ªåŠ¨ä½ç§»æäº¤ä¹Ÿæ— æ³•åšåˆ°ç²¾ç¡®çš„ä½ç§»ç®¡ç†ã€‚åœ¨Kafkaä¸­è¿˜æä¾›äº†æ‰‹åŠ¨ä½ç§»æäº¤çš„æ–¹å¼ï¼Œè¿™æ ·å¯ä»¥ä½¿å¾—å¼€å‘äººå‘˜å¯¹æ¶ˆè´¹ä½ç§»çš„ç®¡ç†æ§åˆ¶æ›´åŠ çµæ´»ã€‚åº”äº KafkaConsumer ä¸­çš„ commitSyncï¼ˆï¼‰å’ŒcommitAsyncï¼ˆï¼‰ä¸¤ç§ç±»å‹çš„æ–¹æ³•ã€‚ kafkaæ‰‹åŠ¨æ§åˆ¶æäº¤commitSyncï¼ˆï¼‰ äºé‡‡ç”¨ commitSyncï¼ˆï¼‰çš„æ— å‚æ–¹æ³•è€Œè¨€ï¼Œå®ƒæäº¤æ¶ˆè´¹ä½ç§»çš„é¢‘ç‡å’Œæ‹‰å–æ‰¹æ¬¡æ¶ˆæ¯ã€å¤„ç†æ‰¹æ¬¡æ¶ˆæ¯çš„é¢‘ç‡æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœæƒ³å¯»æ±‚æ›´ç»†ç²’åº¦çš„ã€æ›´ç²¾å‡†çš„æäº¤ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨commitSyncï¼ˆï¼‰çš„å¦ä¸€ä¸ªå«å‚æ–¹æ³• è¿™ä¸ªæ‰‹åŠ¨å‚æ•°æœ‰ä¸¤ä¸ªå€¼ ï¼Œ ä¸€ä¸ªæè¿°åˆ†ç‰‡çš„ä½ç½® ï¼Œ ä¸€ä¸ªæè¿°åç§»é‡ æˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™å¯ä»¥ä½¿ç”¨æ¶ˆæ¯ç±»ConsumerRecordçš„api ï¼Œ æ¯”å¦‚ ConsumerRecords ç±»çš„ partitionsï¼ˆï¼‰æ–¹æ³•å’Œrecordsï¼ˆTopicPartitionï¼‰æ–¹æ³•è·å–æŸä¸ªåˆ†ç‰‡ä¸­çš„æ‰€æœ‰å€¼ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨offsetæ–¹æ³•æ¥è·å–åç§»é‡ï¼Œtopicå’Œpatitionæ–¹æ³•è·å–ä¸»é¢˜å’Œåˆ†åŒº æ³¨æ„ä¸€ä¸ªç‚¹ , kafkaè¿™ä¸ªåç§»å€¼åœ¨å®¢æˆ·ç«¯æœ‰ä¸€ä»½ï¼Œåœ¨æœåŠ¡ç«¯ä¹Ÿæœ‰ä¸€ä»½çš„ï¼Œå®¢æˆ·ç«¯å¦‚æœæ²¡æœ‰é‡å¯çš„åŒ–æ˜¯ä»¥å®¢æˆ·ç«¯ä¸ºä¾æ®çš„ï¼Œå¦‚æœæœ‰é‡å¯å°†ä¼šä»¥æœåŠ¡ç«¯ä¸ºä¾æ® kafka consumer æ§åˆ¶å’Œå…³é—­KafkaConsumerä¸­ä½¿ç”¨pauseï¼ˆï¼‰å’Œresumeï¼ˆï¼‰æ–¹æ³•æ¥åˆ†åˆ«å®ç°æš‚åœæŸäº›åˆ†åŒºåœ¨æ‹‰å–æ“ä½œæ—¶è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯å’Œæ¢å¤æŸäº›åˆ†åŒºå‘å®¢æˆ·ç«¯è¿”å›æ•°æ®çš„æ“ä½œ KafkaConsumerè¿˜æä¾›äº†ä¸€ä¸ªæ— å‚çš„pausedï¼ˆï¼‰æ–¹æ³•æ¥è¿”å›è¢«æš‚åœçš„åˆ†åŒºé›†åˆï¼Œæ­¤æ–¹æ³•çš„å…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š KafkaConsumerçš„wakeupï¼ˆï¼‰æ–¹æ³•ï¼Œwakeupï¼ˆï¼‰æ–¹æ³•æ˜¯ KafkaConsumer ä¸­å”¯ä¸€å¯ä»¥ä»å…¶ä»–çº¿ç¨‹é‡Œå®‰å…¨è°ƒç”¨çš„æ–¹æ³•ï¼ˆKafkaConsumer æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥é€šè¿‡3.2.10èŠ‚äº†è§£æ›´å¤šç»†èŠ‚ï¼‰ï¼Œè°ƒç”¨wakeupï¼ˆï¼‰æ–¹æ³•åå¯ä»¥é€€å‡ºpollï¼ˆï¼‰çš„é€»è¾‘ï¼Œå¹¶æŠ›å‡º WakeupException çš„å¼‚å¸¸ï¼Œæˆ‘ä»¬ä¹Ÿä¸éœ€è¦å¤„ç†WakeupException çš„å¼‚å¸¸ï¼Œå®ƒåªæ˜¯ä¸€ç§è·³å‡ºå¾ªç¯çš„æ–¹å¼ è·³å‡ºå¾ªç¯ä»¥åä¸€å®šè¦æ˜¾å¼åœ°æ‰§è¡Œå…³é—­åŠ¨ä½œä»¥é‡Šæ”¾è¿è¡Œè¿‡ç¨‹ä¸­å ç”¨çš„å„ç§ç³»ç»Ÿèµ„æºï¼ŒåŒ…æ‹¬å†…å­˜èµ„æºã€Socketè¿æ¥ç­‰ã€‚KafkaConsumeræä¾›äº†closeï¼ˆï¼‰æ–¹æ³•æ¥å®ç°å…³é—­ï¼Œcloseï¼ˆï¼‰æ–¹æ³•æœ‰ä¸‰ç§é‡è½½æ–¹æ³•ï¼Œåˆ†åˆ«å¦‚ä¸‹ ç¬¬äºŒç§æ–¹æ³•æ˜¯é€šè¿‡ timeout å‚æ•°æ¥è®¾å®šå…³é—­æ–¹æ³•çš„æœ€é•¿æ‰§è¡Œæ—¶é—´ï¼Œæœ‰äº›å†…éƒ¨çš„å…³é—­é€»è¾‘ä¼šè€—è´¹ä¸€å®šçš„æ—¶é—´ï¼Œæ¯”å¦‚è®¾ç½®äº†è‡ªåŠ¨æäº¤æ¶ˆè´¹ä½ç§»ï¼Œè¿™é‡Œè¿˜ä¼šåšä¸€æ¬¡ä½ç§»æäº¤çš„åŠ¨ä½œï¼›è€Œç¬¬ä¸€ç§æ–¹æ³•æ²¡æœ‰ timeout å‚æ•°ï¼Œè¿™å¹¶ä¸æ„å‘³ç€ä¼šæ— é™åˆ¶åœ°ç­‰å¾…ï¼Œå®ƒå†…éƒ¨è®¾å®šäº†æœ€é•¿ç­‰å¾…æ—¶é—´ï¼ˆ30ç§’ï¼‰ï¼›ç¬¬ä¸‰ç§æ–¹æ³•å·²è¢«æ ‡è®°ä¸º@Deprecatedï¼Œå¯ä»¥ä¸è€ƒè™‘ã€‚ kafka æŒ‡å®šä½ç§»æ¶ˆè´¹æ¶ˆè´¹ä½ç§»çš„æäº¤ï¼Œæ­£æ˜¯æœ‰äº†æ¶ˆè´¹ä½ç§»çš„æŒä¹…åŒ–ï¼Œæ‰ä½¿æ¶ˆè´¹è€…åœ¨å…³é—­ã€å´©æºƒæˆ–è€…åœ¨é‡åˆ°å†å‡è¡¡çš„æ—¶å€™ï¼Œå¯ä»¥è®©æ¥æ›¿çš„æ¶ˆè´¹è€…èƒ½å¤Ÿæ ¹æ®å­˜å‚¨çš„æ¶ˆè´¹ä½ç§»ç»§ç»­è¿›è¡Œæ¶ˆè´¹ æƒ³ä¸€ä¸‹ï¼Œå½“ä¸€ä¸ªæ–°çš„æ¶ˆè´¹ç»„å»ºç«‹çš„æ—¶å€™ï¼Œå®ƒæ ¹æœ¬æ²¡æœ‰å¯ä»¥æŸ¥æ‰¾çš„æ¶ˆè´¹ä½ç§»ã€‚æˆ–è€…æ¶ˆè´¹ç»„å†…çš„ä¸€ä¸ªæ–°æ¶ˆè´¹è€…è®¢é˜…äº†ä¸€ä¸ªæ–°çš„ä¸»é¢˜ï¼Œå®ƒä¹Ÿæ²¡æœ‰å¯ä»¥æŸ¥æ‰¾çš„æ¶ˆè´¹ä½ç§»ã€‚å½“__consumer_offsetsä¸»é¢˜ä¸­æœ‰å…³è¿™ä¸ªæ¶ˆè´¹ç»„çš„ä½ç§»ä¿¡æ¯è¿‡æœŸè€Œè¢«åˆ é™¤åï¼Œå®ƒä¹Ÿæ²¡æœ‰å¯ä»¥æŸ¥æ‰¾çš„æ¶ˆè´¹ä½ç§»ã€‚ åœ¨ Kafka ä¸­æ¯å½“æ¶ˆè´¹è€…æŸ¥æ‰¾ä¸åˆ°æ‰€è®°å½•çš„æ¶ˆè´¹ä½ç§»æ—¶ï¼Œå°±ä¼šæ ¹æ®æ¶ˆè´¹è€…å®¢æˆ·ç«¯å‚æ•°auto.offset.resetçš„é…ç½®æ¥å†³å®šä»ä½•å¤„å¼€å§‹è¿›è¡Œæ¶ˆè´¹ï¼Œè¿™ä¸ªå‚æ•°çš„é»˜è®¤å€¼ä¸ºâ€œlatestâ€ï¼Œè¡¨ç¤ºä»åˆ†åŒºæœ«å°¾å¼€å§‹æ¶ˆè´¹æ¶ˆæ¯ã€‚å‚è€ƒå›¾3-9ï¼ŒæŒ‰ç…§é»˜è®¤çš„é…ç½®ï¼Œæ¶ˆè´¹è€…ä¼šä»9å¼€å§‹è¿›è¡Œæ¶ˆè´¹ï¼ˆ9æ˜¯ä¸‹ä¸€æ¡è¦å†™å…¥æ¶ˆæ¯çš„ä½ç½®ï¼‰ï¼Œæ›´åŠ ç¡®åˆ‡åœ°è¯´æ˜¯ä»9å¼€å§‹æ‹‰å–æ¶ˆæ¯ã€‚å¦‚æœå°†auto.offset.resetå‚æ•°é…ç½®ä¸ºâ€œearliestâ€ï¼Œé‚£ä¹ˆæ¶ˆè´¹è€…ä¼šä»èµ·å§‹å¤„ï¼Œä¹Ÿå°±æ˜¯0å¼€å§‹æ¶ˆè´¹ã€‚ auto.offset.resetå‚æ•°è¿˜æœ‰ä¸€ä¸ªå¯é…ç½®çš„å€¼â€”â€œnoneâ€ï¼Œé…ç½®ä¸ºæ­¤å€¼å°±æ„å‘³ç€å‡ºç°æŸ¥åˆ°ä¸åˆ°æ¶ˆè´¹ä½ç§»çš„æ—¶å€™ï¼Œæ—¢ä¸ä»æœ€æ–°çš„æ¶ˆæ¯ä½ç½®å¤„å¼€å§‹æ¶ˆè´¹ï¼Œä¹Ÿä¸ä»æœ€æ—©çš„æ¶ˆæ¯ä½ç½®å¤„å¼€å§‹æ¶ˆè´¹ï¼Œæ­¤æ—¶ä¼šæŠ¥å‡ºNoOffsetForPartitionExceptionå¼‚å¸¸ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çŸ¥é“æ¶ˆæ¯çš„æ‹‰å–æ˜¯æ ¹æ®pollï¼ˆï¼‰æ–¹æ³•ä¸­çš„é€»è¾‘æ¥å¤„ç†çš„ï¼Œè¿™ä¸ªpollï¼ˆï¼‰æ–¹æ³•ä¸­çš„é€»è¾‘å¯¹äºæ™®é€šçš„å¼€å‘äººå‘˜è€Œè¨€æ˜¯ä¸€ä¸ªé»‘ç›’ï¼Œæ— æ³•ç²¾ç¡®åœ°æŒæ§å…¶æ¶ˆè´¹çš„èµ·å§‹ä½ç½®ã€‚æä¾›çš„auto.offset.reset å‚æ•°ä¹Ÿåªèƒ½åœ¨æ‰¾ä¸åˆ°æ¶ˆè´¹ä½ç§»æˆ–ä½ç§»è¶Šç•Œçš„æƒ…å†µä¸‹ç²—ç²’åº¦åœ°ä»å¼€å¤´æˆ–æœ«å°¾å¼€å§‹æ¶ˆè´¹ã€‚æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ›´ç»†ç²’åº¦çš„æŒæ§ï¼Œå¯ä»¥è®©æˆ‘ä»¬ä»ç‰¹å®šçš„ä½ç§»å¤„å¼€å§‹æ‹‰å–æ¶ˆæ¯ï¼Œè€Œ KafkaConsumer ä¸­çš„ seekï¼ˆï¼‰æ–¹æ³•æ­£å¥½æä¾›äº†è¿™ä¸ªåŠŸèƒ½ï¼Œè®©æˆ‘ä»¬å¾—ä»¥è¿½å‰æ¶ˆè´¹æˆ–å›æº¯æ¶ˆè´¹ã€‚seekï¼ˆï¼‰æ–¹æ³•çš„å…·ä½“å®šä¹‰å¦‚ä¸‹ seekï¼ˆï¼‰æ–¹æ³•ä¸­çš„å‚æ•°partitionè¡¨ç¤ºåˆ†åŒºï¼Œè€Œoffsetå‚æ•°ç”¨æ¥æŒ‡å®šä»åˆ†åŒºçš„å“ªä¸ªä½ç½®å¼€å§‹æ¶ˆè´¹ã€‚seekï¼ˆï¼‰æ–¹æ³•åªèƒ½é‡ç½®æ¶ˆè´¹è€…åˆ†é…åˆ°çš„åˆ†åŒºçš„æ¶ˆè´¹ä½ç½®ï¼Œè€Œåˆ†åŒºçš„åˆ†é…æ˜¯åœ¨ pollï¼ˆï¼‰æ–¹æ³•çš„è°ƒç”¨è¿‡ç¨‹ä¸­å®ç°çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ‰§è¡Œseekï¼ˆï¼‰æ–¹æ³•ä¹‹å‰éœ€è¦å…ˆæ‰§è¡Œä¸€æ¬¡pollï¼ˆï¼‰æ–¹æ³•ï¼Œç­‰åˆ°åˆ†é…åˆ°åˆ†åŒºä¹‹åæ‰å¯ä»¥é‡ç½®æ¶ˆè´¹ä½ç½®ã€‚ &#x2F;&#x2F;å‰©ä¸‹çš„å¦‚ä½•è®¾ç½®ç•¥ > æš‚æ—¶æ²¡æœ‰é‡åˆ°åœºæ™¯ kafkaå†å‡è¡¡","date":"2024-12-31","categories":["kafka"]},{"title":"kafka_producerå’Œå…ƒæ•°æ®","url":"/2024/12/31/kafka_producerå’Œå…ƒæ•°æ®/","content":"kafka åŸºæœ¬æ¦‚å¿µ Producerï¼šç”Ÿäº§è€…ï¼Œä¹Ÿå°±æ˜¯å‘é€æ¶ˆæ¯çš„ä¸€æ–¹ã€‚ç”Ÿäº§è€…è´Ÿè´£åˆ›å»ºæ¶ˆæ¯ï¼Œç„¶åå°†å…¶æŠ•é€’åˆ°Kafkaä¸­ Consumerï¼šæ¶ˆè´¹è€…ï¼Œä¹Ÿå°±æ˜¯æ¥æ”¶æ¶ˆæ¯çš„ä¸€æ–¹ã€‚æ¶ˆè´¹è€…è¿æ¥åˆ°Kafkaä¸Šå¹¶æ¥æ”¶æ¶ˆæ¯ï¼Œè¿›è€Œè¿›è¡Œç›¸åº”çš„ä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚ Brokerï¼šæœåŠ¡ä»£ç†èŠ‚ç‚¹ã€‚å¯¹äºKafkaè€Œè¨€ï¼ŒBrokerå¯ä»¥ç®€å•åœ°çœ‹ä½œä¸€ä¸ªç‹¬ç«‹çš„KafkaæœåŠ¡èŠ‚ç‚¹æˆ–KafkaæœåŠ¡å®ä¾‹ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ä¹Ÿå¯ä»¥å°†Brokerçœ‹ä½œä¸€å°KafkaæœåŠ¡å™¨ï¼Œå‰ææ˜¯è¿™å°æœåŠ¡å™¨ä¸Šåªéƒ¨ç½²äº†ä¸€ä¸ªKafkaå®ä¾‹ã€‚ä¸€ä¸ªæˆ–å¤šä¸ªBrokerç»„æˆäº†ä¸€ä¸ªKafkaé›†ç¾¤ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬æ›´ä¹ æƒ¯ä½¿ç”¨é¦–å­—æ¯å°å†™çš„brokeræ¥è¡¨ç¤ºæœåŠ¡ä»£ç†èŠ‚ç‚¹ã€‚ Topic: æœåŠ¡ä¸»é¢˜ ï¼Œ Kafkaä¸­çš„æ¶ˆæ¯ä»¥ä¸»é¢˜ä¸ºå•ä½è¿›è¡Œå½’ç±»ï¼Œç”Ÿäº§è€…è´Ÿè´£å°†æ¶ˆæ¯å‘é€åˆ°ç‰¹å®šçš„ä¸»é¢˜ï¼ˆå‘é€åˆ°Kafkaé›†ç¾¤ä¸­çš„æ¯ä¸€æ¡æ¶ˆæ¯éƒ½è¦æŒ‡å®šä¸€ä¸ªä¸»é¢˜ï¼‰ï¼Œè€Œæ¶ˆè´¹è€…è´Ÿè´£è®¢é˜…ä¸»é¢˜å¹¶è¿›è¡Œæ¶ˆè´¹ã€‚ Partitionï¼šä¸€ä¸ªtopicä¸­çš„ä¸»é¢˜å¯èƒ½ä¼šæœ‰å¤šä¸ªåˆ†åŒº ï¼Œ å¹¶ä¸”ä¸åŒçš„åˆ†åŒºå¯èƒ½å¹¶ä¸ä¼šåœ¨åŒä¸€ä¸ªbrokerä¸­ï¼ŒåŒä¸€ä¸»é¢˜ä¸‹çš„ä¸åŒåˆ†åŒºåŒ…å«çš„æ¶ˆæ¯æ˜¯ä¸åŒçš„ï¼Œåˆ†åŒºåœ¨å­˜å‚¨å±‚é¢å¯ä»¥çœ‹ä½œä¸€ä¸ªå¯è¿½åŠ çš„æ—¥å¿—ï¼ˆLogï¼‰æ–‡ä»¶ï¼Œæ¶ˆæ¯åœ¨è¢«è¿½åŠ åˆ°åˆ†åŒºæ—¥å¿—æ–‡ä»¶çš„æ—¶å€™éƒ½ä¼šåˆ†é…ä¸€ä¸ªç‰¹å®šçš„åç§»é‡ï¼ˆoffsetï¼‰ã€‚offsetæ˜¯æ¶ˆæ¯åœ¨åˆ†åŒºä¸­çš„å”¯ä¸€æ ‡è¯†ï¼ŒKafkaé€šè¿‡å®ƒæ¥ä¿è¯æ¶ˆæ¯åœ¨åˆ†åŒºå†…çš„é¡ºåºæ€§ï¼Œä¸è¿‡offsetå¹¶ä¸è·¨è¶Šåˆ†åŒºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒKafkaä¿è¯çš„æ˜¯åˆ†åŒºæœ‰åºè€Œä¸æ˜¯ä¸»é¢˜æœ‰åºã€‚ Replicaå’Œleader&followå‰¯æœ¬ï¼škafkaé’ˆå¯¹åˆ†åŒºæœ‰å¤šå‰¯æœ¬æœºåˆ¶å®ç°é«˜å¯ç”¨ï¼Œå¹¶ä¸”ä¿è¯å‰¯æœ¬å­˜æ”¾åœ¨ä¸åŒçš„brokerä¸­ æ³¨æ„ç‚¹ï¼š kafkaæ¶ˆè´¹è€…ä½¿ç”¨pullæ¨¡å¼æ‹‰å– ï¼Ÿé•¿è½®è¯¢ï¼Ÿ kafkaåŸºæœ¬æ¶æ„ç³»ç»Ÿæ¶æ„ åè¯æ¦‚å¿µ ARï¼ˆAssigned Replicasï¼‰ ï¼š kafkaå‰¯æœ¬ç³»ç»Ÿç»Ÿç§° ISRï¼ˆIn-Sync Replicasï¼‰ï¼š ä¸leaderå‰¯æœ¬ä¿æŒåŒæ­¥çš„å‰¯æœ¬ OSRï¼ˆOut-of-Sync Replicasï¼‰ leaderå‰¯æœ¬è´Ÿè´£ç»´æŠ¤å’Œè·Ÿè¸ªISRå’ŒOSRé›†åˆçš„followerå‰¯æœ¬çš„æ»åçŠ¶æ€ï¼Œå½“followerå‰¯æœ¬è½åå¤ªå¤šæˆ–å¤±æ•ˆæ—¶ï¼Œleaderå‰¯æœ¬ä¼šæŠŠå®ƒä»ISRé›†åˆä¸­å‰”é™¤ã€‚å¦‚æœOSRé›†åˆä¸­æœ‰followerå‰¯æœ¬â€œè¿½ä¸Šâ€äº†leaderå‰¯æœ¬ï¼Œé‚£ä¹ˆleaderå‰¯æœ¬ä¼šæŠŠå®ƒä»OSRé›†åˆè½¬ç§»è‡³ISRé›†åˆ é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“leaderå‰¯æœ¬å‘ç”Ÿæ•…éšœæ—¶ï¼Œåªæœ‰åœ¨ISRé›†åˆä¸­çš„å‰¯æœ¬æ‰æœ‰èµ„æ ¼è¢«é€‰ä¸¾ä¸ºæ–°çš„leaderï¼Œè€Œåœ¨OSRé›†åˆä¸­çš„å‰¯æœ¬åˆ™æ²¡æœ‰ä»»ä½•æœºä¼šï¼ˆä¸è¿‡è¿™ä¸ªåŸåˆ™ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹ç›¸åº”çš„å‚æ•°é…ç½®æ¥æ”¹å˜ï¼‰ LEO ï¼š LEOæ˜¯Log End Offsetçš„ç¼©å†™ï¼Œå®ƒæ ‡è¯†å½“å‰æ—¥å¿—æ–‡ä»¶ä¸­ä¸‹ä¸€æ¡å¾…å†™å…¥æ¶ˆæ¯çš„offset HW ï¼š HWæ˜¯High Watermarkçš„ç¼©å†™ï¼Œä¿—ç§°é«˜æ°´ä½ï¼Œå®ƒæ ‡è¯†äº†ä¸€ä¸ªç‰¹å®šçš„æ¶ˆæ¯åç§»é‡ï¼ˆoffsetï¼‰ï¼Œæ¶ˆè´¹è€…åªèƒ½æ‹‰å–åˆ°è¿™ä¸ªoffsetä¹‹å‰çš„æ¶ˆæ¯ã€‚ æ³¨æ„ï¼š LEOå’ŒHW éƒ½æè¿°çš„æ˜¯ä¸‹ä¸€ä¸ªèƒ½æ’å…¥æˆ–è€…èƒ½è¯»å…¥çš„ä½ç½®ï¼Œè€Œä¸æ˜¯å½“å‰ä½ç½® LEOä½ç½®çš„ç¡®å®šæ–¹æ³•æ˜¯æ¯ä¸€ä¸ªå‰¯æœ¬å½“å‰èƒ½æ’å…¥çš„ä¸‹ä¸€ä¸ªé—®é¢˜ï¼ŒHWçš„ä½ç½®æ˜¯leaderé€šè¿‡åŒæ­¥å½“å‰æ‰€æœ‰å‰¯æœ¬ä¸­æœ€å°çš„LEOæ¥å†³å®šHW kafka producerKafkaProduceråˆ›å»ºå‘é€æ¶ˆæ¯å¯¹è±¡ProducerRecord ? æš‚æ—¶çœç•¥ å‘é€æ¶ˆæ¯ä¸‰ç§ä¸»è¦æ¨¡å¼å‘åå³å¿˜ï¼ˆfire-and-forgetï¼‰ã€åŒæ­¥ï¼ˆsyncï¼‰åŠå¼‚æ­¥ï¼ˆasyncï¼‰ fire-and0forgetï¼šå‘åå³å¿˜ï¼Œå®ƒåªç®¡å¾€Kafkaä¸­å‘é€æ¶ˆæ¯è€Œå¹¶ä¸å…³å¿ƒæ¶ˆæ¯æ˜¯å¦æ­£ç¡®åˆ°è¾¾ syncï¼šä½¿ç”¨sendæ–¹æ³• é˜»å¡ç­‰å¾…Kafkaçš„å“åº” ,è¿”å›ä¸€ä¸ªFutureç±»ï¼Œç›´åˆ°æ¶ˆæ¯å‘é€æˆåŠŸï¼Œæˆ–è€…å‘ç”Ÿå¼‚å¸¸ã€‚å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œé‚£ä¹ˆå°±éœ€è¦æ•è·å¼‚å¸¸å¹¶äº¤ç”±å¤–å±‚é€»è¾‘å¤„ç† async:ä¸€èˆ¬æ˜¯åœ¨sendï¼ˆï¼‰æ–¹æ³•é‡ŒæŒ‡å®šä¸€ä¸ªCallbackçš„å›è°ƒå‡½æ•°ï¼ŒKafkaåœ¨è¿”å›å“åº”æ—¶è°ƒç”¨è¯¥å‡½æ•°æ¥å®ç°å¼‚æ­¥çš„å‘é€ç¡®è®¤ æ³¨æ„ï¼š ä½¿ç”¨producerä¹‹åè¦è°ƒç”¨closeæ–¹æ³•æ¥å…³é—­è¯·æ±‚ kafka producerå¼‚å¸¸KafkaProducerä¸­ä¸€èˆ¬ä¼šå‘ç”Ÿä¸¤ç§ç±»å‹çš„å¼‚å¸¸ï¼šå¯é‡è¯•çš„å¼‚å¸¸å’Œä¸å¯é‡è¯•çš„å¼‚å¸¸ã€‚å¸¸è§çš„å¯é‡è¯•å¼‚å¸¸æœ‰ï¼šNetworkExceptionã€LeaderNotAvailableExceptionã€UnknownTopicOrPartitionExceptionã€NotEnoughReplicasExceptionã€NotCoordinatorException ç­‰ã€‚æ¯”å¦‚NetworkException è¡¨ç¤ºç½‘ç»œå¼‚å¸¸ï¼Œè¿™ä¸ªæœ‰å¯èƒ½æ˜¯ç”±äºç½‘ç»œç¬æ—¶æ•…éšœè€Œå¯¼è‡´çš„å¼‚å¸¸ï¼Œå¯ä»¥é€šè¿‡é‡è¯•è§£å†³ï¼›åˆæ¯”å¦‚LeaderNotAvailableExceptionè¡¨ç¤ºåˆ†åŒºçš„leaderå‰¯æœ¬ä¸å¯ç”¨ï¼Œè¿™ä¸ªå¼‚å¸¸é€šå¸¸å‘ç”Ÿåœ¨leaderå‰¯æœ¬ä¸‹çº¿è€Œæ–°çš„ leader å‰¯æœ¬é€‰ä¸¾å®Œæˆä¹‹å‰ï¼Œé‡è¯•ä¹‹åå¯ä»¥é‡æ–°æ¢å¤ã€‚ ä¸å¯é‡è¯•çš„å¼‚å¸¸ï¼Œæ¯”å¦‚RecordTooLargeExceptionå¼‚å¸¸ï¼Œæš—ç¤ºäº†æ‰€å‘é€çš„æ¶ˆæ¯å¤ªå¤§ï¼ŒKafkaProducerå¯¹æ­¤ä¸ä¼šè¿›è¡Œä»»ä½•é‡è¯•ï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚ å¯¹äºå¯é‡è¯•çš„å¼‚å¸¸ï¼Œå¦‚æœé…ç½®äº† retries å‚æ•°ï¼Œé‚£ä¹ˆåªè¦åœ¨è§„å®šçš„é‡è¯•æ¬¡æ•°å†…è‡ªè¡Œæ¢å¤äº†ï¼Œå°±ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚retrieså‚æ•°çš„é»˜è®¤å€¼ä¸º0ï¼Œé…ç½®æ–¹å¼å‚è€ƒå¦‚ä¸‹ï¼š ç¤ºä¾‹ä¸­é…ç½®äº†10æ¬¡é‡è¯•ã€‚å¦‚æœé‡è¯•äº†10æ¬¡ä¹‹åè¿˜æ²¡æœ‰æ¢å¤ï¼Œé‚£ä¹ˆä»ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè¿›è€Œå‘é€çš„å¤–å±‚é€»è¾‘å°±è¦å¤„ç†è¿™äº›å¼‚å¸¸äº† producerå‘å¾€ brokerçš„è¿‡ç¨‹æ¶ˆæ¯åœ¨é€šè¿‡sendï¼ˆï¼‰æ–¹æ³•å‘å¾€brokerçš„è¿‡ç¨‹ä¸­ï¼Œæœ‰å¯èƒ½éœ€è¦ç»è¿‡æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰ã€åºåˆ—åŒ–å™¨ï¼ˆSerializerï¼‰å’Œåˆ†åŒºå™¨ï¼ˆPartitionerï¼‰çš„ä¸€ç³»åˆ—ä½œç”¨ä¹‹åæ‰èƒ½è¢«çœŸæ­£åœ°å‘å¾€ broker åˆ†åŒºå™¨: Partitioner-ç”¨äºç¡®å®šå®ƒå‘å¾€çš„åˆ†åŒºï¼Œå¦‚æœæ¶ˆæ¯ProducerRecordä¸­æŒ‡å®šäº†partitionå­—æ®µï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦åˆ†åŒºå™¨çš„ä½œç”¨ï¼Œå› ä¸ºpartitionä»£è¡¨çš„å°±æ˜¯æ‰€è¦å‘å¾€çš„åˆ†åŒºå· Kafkaä¸­æä¾›çš„é»˜è®¤åˆ†åŒºå™¨æ˜¯org.apache.kafka.clients.producer.internals.DefaultPartitionerï¼Œå®ƒå®ç°äº†org.apache.kafka.clients.producer.Partitioneræ¥å£ï¼Œè¿™ä¸ªæ¥å£ä¸­å®šä¹‰äº†2ä¸ªæ–¹æ³• å…¶ä¸­partitionï¼ˆï¼‰æ–¹æ³•ç”¨æ¥è®¡ç®—åˆ†åŒºå·ï¼Œè¿”å›å€¼ä¸ºintç±»å‹ã€‚partitionï¼ˆï¼‰æ–¹æ³•ä¸­çš„å‚æ•°åˆ†åˆ«è¡¨ç¤ºä¸»é¢˜ã€é”®ã€åºåˆ—åŒ–åçš„é”®ã€å€¼ã€åºåˆ—åŒ–åçš„å€¼ï¼Œä»¥åŠé›†ç¾¤çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œé€šè¿‡è¿™äº›ä¿¡æ¯å¯ä»¥å®ç°åŠŸèƒ½ä¸°å¯Œçš„åˆ†åŒºå™¨ã€‚closeï¼ˆï¼‰æ–¹æ³•åœ¨å…³é—­åˆ†åŒºå™¨çš„æ—¶å€™ç”¨æ¥å›æ”¶ä¸€äº›èµ„æºã€‚ åœ¨é»˜è®¤åˆ†åŒºå™¨ DefaultPartitioner çš„å®ç°ä¸­ï¼Œcloseï¼ˆï¼‰æ˜¯ç©ºæ–¹æ³•ï¼Œè€Œåœ¨ partitionï¼ˆï¼‰æ–¹æ³•ä¸­å®šä¹‰äº†ä¸»è¦çš„åˆ†åŒºåˆ†é…é€»è¾‘ã€‚å¦‚æœ key ä¸ä¸º nullï¼Œé‚£ä¹ˆé»˜è®¤çš„åˆ†åŒºå™¨ä¼šå¯¹ key è¿›è¡Œå“ˆå¸Œï¼ˆé‡‡ç”¨MurmurHash2ç®—æ³•ï¼Œå…·å¤‡é«˜è¿ç®—æ€§èƒ½åŠä½ç¢°æ’ç‡ï¼‰ï¼Œæœ€ç»ˆæ ¹æ®å¾—åˆ°çš„å“ˆå¸Œå€¼æ¥è®¡ç®—åˆ†åŒºå·ï¼Œæ‹¥æœ‰ç›¸åŒkeyçš„æ¶ˆæ¯ä¼šè¢«å†™å…¥åŒä¸€ä¸ªåˆ†åŒºã€‚å¦‚æœkeyä¸ºnullï¼Œé‚£ä¹ˆæ¶ˆæ¯å°†ä¼šä»¥è½®è¯¢çš„æ–¹å¼å‘å¾€ä¸»é¢˜å†…çš„å„ä¸ªå¯ç”¨åˆ†åŒºã€‚ æ³¨æ„ï¼šå¦‚æœ key ä¸ä¸º nullï¼Œé‚£ä¹ˆè®¡ç®—å¾—åˆ°çš„åˆ†åŒºå·ä¼šæ˜¯æ‰€æœ‰åˆ†åŒºä¸­çš„ä»»æ„ä¸€ä¸ªï¼›å¦‚æœ keyä¸ºnullï¼Œé‚£ä¹ˆè®¡ç®—å¾—åˆ°çš„åˆ†åŒºå·ä»…ä¸ºå¯ç”¨åˆ†åŒºä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œæ³¨æ„ä¸¤è€…ä¹‹é—´çš„å·®åˆ«ã€‚ åœ¨ä¸æ”¹å˜ä¸»é¢˜åˆ†åŒºæ•°é‡çš„æƒ…å†µä¸‹ï¼Œkeyä¸åˆ†åŒºä¹‹é—´çš„æ˜ å°„å¯ä»¥ä¿æŒä¸å˜ã€‚ä¸è¿‡ï¼Œä¸€æ—¦ä¸»é¢˜ä¸­å¢åŠ äº†åˆ†åŒºï¼Œé‚£ä¹ˆå°±éš¾ä»¥ä¿è¯keyä¸åˆ†åŒºä¹‹é—´çš„æ˜ å°„å…³ç³»äº†ã€‚ è‡ªå®šä¹‰åˆ†åŒºå™¨å®ç° - å’Œdefaultæ–¹æ³•ç±»ä¼¼ï¼Œåªè¦è‡ªå·±å®šä¹‰Partitioneré‡å†™ä¸€ä¸‹é‡Œé¢çš„æ¥å£å®ç°å³å¯ è¿™ä¸ªè‡ªå®šä¹‰åˆ†åŒºå™¨çš„å®ç°æ¯”è¾ƒç®€å•ï¼Œè¯»è€…ä¹Ÿå¯ä»¥æ ¹æ®è‡ªèº«ä¸šåŠ¡çš„éœ€æ±‚æ¥çµæ´»å®ç°åˆ†é…åˆ†åŒºçš„è®¡ç®—æ–¹å¼ï¼Œæ¯”å¦‚ä¸€èˆ¬å¤§å‹ç”µå•†éƒ½æœ‰å¤šä¸ªä»“åº“ï¼Œå¯ä»¥å°†ä»“åº“çš„åç§°æˆ–IDä½œä¸ºkeyæ¥çµæ´»åœ°è®°å½•å•†å“ä¿¡æ¯ã€‚ åºåˆ—åŒ–å™¨ï¼šSerializer ç”¨äºæŒ‡å®šæ¶ˆæ¯çš„åºåˆ—åŒ–æ–¹æ³• kafkaæ”¯æŒè‡ªå®šä¹‰çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œåªéœ€è¦å®ç°å¯¹åº”çš„æ¥å£å°±å¯ä»¥äº†org.apache.kafka.common.serialization.Serializer æ³¨æ„ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å¯¹åº”çš„åºåˆ—åŒ–åè®®å¿…é¡»è¦ä¸€è‡´ ç”Ÿäº§è€…æ‹¦æˆªå™¨ ç”Ÿäº§è€…æ‹¦æˆªå™¨æ—¢å¯ä»¥ç”¨æ¥åœ¨æ¶ˆæ¯å‘é€å‰åšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œæ¯”å¦‚æŒ‰ç…§æŸä¸ªè§„åˆ™è¿‡æ»¤ä¸ç¬¦åˆè¦æ±‚çš„æ¶ˆæ¯ã€ä¿®æ”¹æ¶ˆæ¯çš„å†…å®¹ç­‰ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥åœ¨å‘é€å›è°ƒé€»è¾‘å‰åšä¸€äº›å®šåˆ¶åŒ–çš„éœ€æ±‚ï¼Œæ¯”å¦‚ç»Ÿè®¡ç±»å·¥ä½œã€‚ ç”Ÿäº§è€…æ‹¦æˆªå™¨çš„ä½¿ç”¨ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œä¸»è¦æ˜¯è‡ªå®šä¹‰å®ç° org.apache.kafka.clients.producer.ProducerInterceptoræ¥å£ onSendï¼ˆï¼‰æ–¹æ³• ï¼šKafkaProduceråœ¨å°†æ¶ˆæ¯åºåˆ—åŒ–å’Œè®¡ç®—åˆ†åŒºä¹‹å‰ä¼šè°ƒç”¨ç”Ÿäº§è€…æ‹¦æˆªå™¨çš„onSendï¼ˆï¼‰æ–¹æ³•æ¥å¯¹æ¶ˆæ¯è¿›è¡Œç›¸åº”çš„å®šåˆ¶åŒ–æ“ä½œã€‚ä¸€èˆ¬æ¥è¯´æœ€å¥½ä¸è¦ä¿®æ”¹æ¶ˆæ¯ ProducerRecord çš„ topicã€key å’Œpartition ç­‰ä¿¡æ¯ï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œåˆ™éœ€ç¡®ä¿å¯¹å…¶æœ‰å‡†ç¡®çš„åˆ¤æ–­ï¼Œå¦åˆ™ä¼šä¸é¢„æƒ³çš„æ•ˆæœå‡ºç°åå·®ã€‚æ¯”å¦‚ä¿®æ”¹keyä¸ä»…ä¼šå½±å“åˆ†åŒºçš„è®¡ç®—ï¼ŒåŒæ ·ä¼šå½±å“brokerç«¯æ—¥å¿—å‹ç¼©ï¼ˆLog Compactionï¼‰çš„åŠŸèƒ½ã€‚ onAcknowledgementï¼ˆï¼‰ï¼š KafkaProducer ä¼šåœ¨æ¶ˆæ¯è¢«åº”ç­”ï¼ˆAcknowledgementï¼‰ä¹‹å‰æˆ–æ¶ˆæ¯å‘é€å¤±è´¥æ—¶è°ƒç”¨ç”Ÿäº§è€…æ‹¦æˆªå™¨çš„onAcknowledgementï¼ˆï¼‰æ–¹æ³•ï¼Œä¼˜å…ˆäºç”¨æˆ·è®¾å®šçš„ Callback ä¹‹å‰æ‰§è¡Œã€‚è¿™ä¸ªæ–¹æ³•è¿è¡Œåœ¨Producer çš„ I&#x2F;O çº¿ç¨‹ä¸­ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•ä¸­å®ç°çš„ä»£ç é€»è¾‘è¶Šç®€å•è¶Šå¥½ï¼Œå¦åˆ™ä¼šå½±å“æ¶ˆæ¯çš„å‘é€é€Ÿåº¦ã€‚ closeï¼ˆï¼‰æ–¹æ³• ï¼šä¸»è¦ç”¨äºåœ¨å…³é—­æ‹¦æˆªå™¨æ—¶æ‰§è¡Œä¸€äº›èµ„æºçš„æ¸…ç†å·¥ä½œã€‚åœ¨è¿™ 3 ä¸ªæ–¹æ³•ä¸­æŠ›å‡ºçš„å¼‚å¸¸éƒ½ä¼šè¢«æ•è·å¹¶è®°å½•åˆ°æ—¥å¿—ä¸­ï¼Œä½†å¹¶ä¸ä¼šå†å‘ä¸Šä¼ é€’ã€‚ æ³¨æ„ï¼š KafkaProducerä¸­ä¸ä»…å¯ä»¥æŒ‡å®šä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œè¿˜å¯ä»¥æŒ‡å®šå¤šä¸ªæ‹¦æˆªå™¨ä»¥å½¢æˆæ‹¦æˆªé“¾ kafka produceræ¶æ„å›¾ æ•´ä¸ªç”Ÿäº§è€…å®¢æˆ·ç«¯ç”±ä¸¤ä¸ªçº¿ç¨‹åè°ƒè¿è¡Œï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«ä¸ºä¸»çº¿ç¨‹å’ŒSenderçº¿ç¨‹ï¼ˆå‘é€çº¿ç¨‹ï¼‰ã€‚ åœ¨ä¸»çº¿ç¨‹ä¸­ç”±KafkaProduceråˆ›å»ºæ¶ˆæ¯ï¼Œç„¶åé€šè¿‡å¯èƒ½çš„æ‹¦æˆªå™¨ã€åºåˆ—åŒ–å™¨å’Œåˆ†åŒºå™¨çš„ä½œç”¨ä¹‹åç¼“å­˜åˆ°æ¶ˆæ¯ç´¯åŠ å™¨ï¼ˆRecordAccumulatorï¼Œä¹Ÿç§°ä¸ºæ¶ˆæ¯æ”¶é›†å™¨ï¼‰ä¸­ã€‚ RecordAccumulator ä¸»è¦ç”¨æ¥ç¼“å­˜æ¶ˆæ¯ä»¥ä¾¿ Sender çº¿ç¨‹å¯ä»¥æ‰¹é‡å‘é€ï¼Œè¿›è€Œå‡å°‘ç½‘ç»œä¼ è¾“çš„èµ„æºæ¶ˆè€—ä»¥æå‡æ€§èƒ½ã€‚RecordAccumulator ç¼“å­˜çš„å¤§å°å¯ä»¥é€šè¿‡ç”Ÿäº§è€…å®¢æˆ·ç«¯å‚æ•°buffer.memory é…ç½®ï¼Œé»˜è®¤å€¼ä¸º 33554432Bï¼Œå³ 32MBã€‚å¦‚æœç”Ÿäº§è€…å‘é€æ¶ˆæ¯çš„é€Ÿåº¦è¶…è¿‡å‘é€åˆ°æœåŠ¡å™¨çš„é€Ÿåº¦ï¼Œåˆ™ä¼šå¯¼è‡´ç”Ÿäº§è€…ç©ºé—´ä¸è¶³ï¼Œè¿™ä¸ªæ—¶å€™KafkaProducerçš„sendï¼ˆï¼‰æ–¹æ³•è°ƒç”¨è¦ä¹ˆè¢«é˜»å¡ï¼Œè¦ä¹ˆæŠ›å‡ºå¼‚å¸¸ï¼Œè¿™ä¸ªå–å†³äºå‚æ•°max.block.msçš„é…ç½®ï¼Œæ­¤å‚æ•°çš„é»˜è®¤å€¼ä¸º60000ï¼Œå³60ç§’ã€‚ åœ¨ RecordAccumulator çš„å†…éƒ¨ä¸ºæ¯ä¸ªåˆ†åŒºéƒ½ç»´æŠ¤äº†ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—ä¸­çš„å†…å®¹å°±æ˜¯ProducerBatchï¼Œå³ Dequeï¼œProducerBatchï¼ã€‚å†™å…¥è¿½åŠ åˆ°å°¾éƒ¨ï¼Œè¯»å–ä»å¤´éƒ¨è¯»å–ProducerBatchä¸­å¯ä»¥åŒ…å«ä¸€è‡³å¤šä¸ª ProducerRecordã€‚é€šä¿—åœ°è¯´ï¼ŒProducerRecord æ˜¯ç”Ÿäº§è€…ä¸­åˆ›å»ºçš„æ¶ˆæ¯ï¼Œè€ŒProducerBatchæ˜¯æŒ‡ä¸€ä¸ªæ¶ˆæ¯æ‰¹æ¬¡ï¼ŒProducerRecordä¼šè¢«åŒ…å«åœ¨ProducerBatchä¸­ï¼Œè¿™æ ·å¯ä»¥ä½¿å­—èŠ‚çš„ä½¿ç”¨æ›´åŠ ç´§å‡‘ã€‚ä¸æ­¤åŒæ—¶ï¼Œå°†è¾ƒå°çš„ProducerRecordæ‹¼å‡‘æˆä¸€ä¸ªè¾ƒå¤§çš„ProducerBatchï¼Œä¹Ÿå¯ä»¥å‡å°‘ç½‘ç»œè¯·æ±‚çš„æ¬¡æ•°ä»¥æå‡æ•´ä½“çš„ååé‡ æ¶ˆæ¯åœ¨ç½‘ç»œä¸Šéƒ½æ˜¯ä»¥å­—èŠ‚ï¼ˆByteï¼‰çš„å½¢å¼ä¼ è¾“çš„ï¼Œåœ¨å‘é€ä¹‹å‰éœ€è¦åˆ›å»ºä¸€å—å†…å­˜åŒºåŸŸæ¥ä¿å­˜å¯¹åº”çš„æ¶ˆæ¯ã€‚åœ¨Kafkaç”Ÿäº§è€…å®¢æˆ·ç«¯ä¸­ï¼Œé€šè¿‡java.io.ByteBufferå®ç°æ¶ˆæ¯å†…å­˜çš„åˆ›å»ºå’Œé‡Šæ”¾ã€‚ä¸è¿‡é¢‘ç¹çš„åˆ›å»ºå’Œé‡Šæ”¾æ˜¯æ¯”è¾ƒè€—è´¹èµ„æºçš„ï¼Œåœ¨RecordAccumulatorçš„å†…éƒ¨è¿˜æœ‰ä¸€ä¸ªBufferPoolï¼Œå®ƒä¸»è¦ç”¨æ¥å®ç°ByteBufferçš„å¤ç”¨ï¼Œä»¥å®ç°ç¼“å­˜çš„é«˜æ•ˆåˆ©ç”¨ã€‚ä¸è¿‡BufferPoolåªé’ˆå¯¹ç‰¹å®šå¤§å°çš„ByteBufferè¿›è¡Œç®¡ç†ï¼Œè€Œå…¶ä»–å¤§å°çš„ByteBufferä¸ä¼šç¼“å­˜è¿›BufferPoolä¸­ï¼Œè¿™ä¸ªç‰¹å®šçš„å¤§å°ç”±batch.sizeå‚æ•°æ¥æŒ‡å®šï¼Œé»˜è®¤å€¼ä¸º16384Bï¼Œå³16KBã€‚ æˆ‘ä»¬å¯ä»¥é€‚å½“åœ°è°ƒå¤§batch.sizeå‚æ•°ä»¥ä¾¿å¤šç¼“å­˜ä¸€äº›æ¶ˆæ¯ã€‚ProducerBatchçš„å¤§å°å’Œbatch.sizeå‚æ•°ä¹Ÿæœ‰ç€å¯†åˆ‡çš„å…³ç³»ã€‚å½“ä¸€æ¡æ¶ˆæ¯ï¼ˆProducerRecordï¼‰æµå…¥RecordAccumulatoræ—¶ï¼Œä¼šå…ˆå¯»æ‰¾ä¸æ¶ˆæ¯åˆ†åŒºæ‰€å¯¹åº”çš„åŒç«¯é˜Ÿåˆ—ï¼ˆå¦‚æœæ²¡æœ‰åˆ™æ–°å»ºï¼‰ï¼Œå†ä»è¿™ä¸ªåŒç«¯é˜Ÿåˆ—çš„å°¾éƒ¨è·å–ä¸€ä¸ª ProducerBatchï¼ˆå¦‚æœæ²¡æœ‰åˆ™æ–°å»ºï¼‰ï¼ŒæŸ¥çœ‹ ProducerBatch ä¸­æ˜¯å¦è¿˜å¯ä»¥å†™å…¥è¿™ä¸ª ProducerRecordï¼Œå¦‚æœå¯ä»¥åˆ™å†™å…¥ï¼Œå¦‚æœä¸å¯ä»¥åˆ™éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ProducerBatchã€‚åœ¨æ–°å»ºProducerBatchæ—¶è¯„ä¼°è¿™æ¡æ¶ˆæ¯çš„å¤§å°æ˜¯å¦è¶…è¿‡batch.sizeå‚æ•°çš„å¤§å°ï¼Œå¦‚æœä¸è¶…è¿‡ï¼Œé‚£ä¹ˆå°±ä»¥ batch.sizeå‚æ•°çš„å¤§å°æ¥åˆ›å»º ProducerBatchï¼Œè¿™æ ·åœ¨ä½¿ç”¨å®Œè¿™æ®µå†…å­˜åŒºåŸŸä¹‹åï¼Œå¯ä»¥é€šè¿‡BufferPool çš„ç®¡ç†æ¥è¿›è¡Œå¤ç”¨ï¼›å¦‚æœè¶…è¿‡ï¼Œé‚£ä¹ˆå°±ä»¥è¯„ä¼°çš„å¤§å°æ¥åˆ›å»ºProducerBatchï¼Œè¿™æ®µå†…å­˜åŒºåŸŸä¸ä¼šè¢«å¤ç”¨ã€‚ Sender çº¿ç¨‹è´Ÿè´£ä»RecordAccumulatorä¸­è·å–æ¶ˆæ¯å¹¶å°†å…¶å‘é€åˆ°Kafkaä¸­ Sender ä» RecordAccumulator ä¸­è·å–ç¼“å­˜çš„æ¶ˆæ¯ä¹‹åï¼Œä¼šè¿›ä¸€æ­¥å°†åŸæœ¬ï¼œåˆ†åŒºï¼ŒDequeï¼œProducerBatchï¼ï¼çš„ä¿å­˜å½¢å¼è½¬å˜æˆï¼œNodeï¼ŒListï¼œ ProducerBatchï¼çš„å½¢å¼ï¼Œå…¶ä¸­Nodeè¡¨ç¤ºKafkaé›†ç¾¤çš„brokerèŠ‚ç‚¹ã€‚å¯¹äºç½‘ç»œè¿æ¥æ¥è¯´ï¼Œç”Ÿäº§è€…å®¢æˆ·ç«¯æ˜¯ä¸å…·ä½“çš„brokerèŠ‚ç‚¹å»ºç«‹çš„è¿æ¥ï¼Œä¹Ÿå°±æ˜¯å‘å…·ä½“çš„ broker èŠ‚ç‚¹å‘é€æ¶ˆæ¯ï¼Œè€Œå¹¶ä¸å…³å¿ƒæ¶ˆæ¯å±äºå“ªä¸€ä¸ªåˆ†åŒºï¼›è€Œå¯¹äº KafkaProducerçš„åº”ç”¨é€»è¾‘è€Œè¨€ï¼Œæˆ‘ä»¬åªå…³æ³¨å‘å“ªä¸ªåˆ†åŒºä¸­å‘é€å“ªäº›æ¶ˆæ¯ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œéœ€è¦åšä¸€ä¸ªåº”ç”¨é€»è¾‘å±‚é¢åˆ°ç½‘ç»œI&#x2F;Oå±‚é¢çš„è½¬æ¢ã€‚ åœ¨è½¬æ¢æˆï¼œNodeï¼ŒListï¼œProducerBatchï¼ï¼çš„å½¢å¼ä¹‹åï¼ŒSender è¿˜ä¼šè¿›ä¸€æ­¥å°è£…æˆï¼œNodeï¼ŒRequestï¼çš„å½¢å¼ï¼Œè¿™æ ·å°±å¯ä»¥å°†Requestè¯·æ±‚å‘å¾€å„ä¸ªNodeäº†ï¼Œè¿™é‡Œçš„Requestæ˜¯æŒ‡Kafkaçš„å„ç§åè®®è¯·æ±‚ï¼Œå¯¹äºæ¶ˆæ¯å‘é€è€Œè¨€å°±æ˜¯æŒ‡å…·ä½“çš„ProduceRequest Senderä¸­çš„InFlightRequestsé›†åˆ è¯·æ±‚åœ¨ä»Senderçº¿ç¨‹å‘å¾€Kafkaä¹‹å‰è¿˜ä¼šä¿å­˜åˆ°InFlightRequestsä¸­ï¼ŒInFlightRequestsä¿å­˜å¯¹è±¡çš„å…·ä½“å½¢å¼ä¸º Mapï¼œNodeIdï¼ŒDequeï¼œRequestï¼ï¼ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ç¼“å­˜äº†å·²ç»å‘å‡ºå»ä½†è¿˜æ²¡æœ‰æ”¶åˆ°å“åº”çš„è¯·æ±‚ï¼ˆNodeId æ˜¯ä¸€ä¸ª String ç±»å‹ï¼Œè¡¨ç¤ºèŠ‚ç‚¹çš„ id ç¼–å·ï¼‰ã€‚ ä¸æ­¤åŒæ—¶ï¼ŒInFlightRequestsè¿˜æä¾›äº†è®¸å¤šç®¡ç†ç±»çš„æ–¹æ³•ï¼Œå¹¶ä¸”é€šè¿‡é…ç½®å‚æ•°è¿˜å¯ä»¥é™åˆ¶æ¯ä¸ªè¿æ¥ï¼ˆä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯ä¸Nodeä¹‹é—´çš„è¿æ¥ï¼‰æœ€å¤šç¼“å­˜çš„è¯·æ±‚æ•°ã€‚è¿™ä¸ªé…ç½®å‚æ•°ä¸ºmax.in.flight.requests.per.connectionï¼Œé»˜è®¤å€¼ä¸º 5ï¼Œå³æ¯ä¸ªè¿æ¥æœ€å¤šåªèƒ½ç¼“å­˜ 5 ä¸ªæœªå“åº”çš„è¯·æ±‚ï¼Œè¶…è¿‡è¯¥æ•°å€¼ä¹‹åå°±ä¸èƒ½å†å‘è¿™ä¸ªè¿æ¥å‘é€æ›´å¤šçš„è¯·æ±‚äº†ï¼Œé™¤éæœ‰ç¼“å­˜çš„è¯·æ±‚æ”¶åˆ°äº†å“åº”ï¼ˆResponseï¼‰ã€‚é€šè¿‡æ¯”è¾ƒDequeï¼œRequestï¼çš„sizeä¸è¿™ä¸ªå‚æ•°çš„å¤§å°æ¥åˆ¤æ–­å¯¹åº”çš„Nodeä¸­æ˜¯å¦å·²ç»å †ç§¯äº†å¾ˆå¤šæœªå“åº”çš„æ¶ˆæ¯ï¼Œå¦‚æœçœŸæ˜¯å¦‚æ­¤ï¼Œé‚£ä¹ˆè¯´æ˜è¿™ä¸ª Node èŠ‚ç‚¹è´Ÿè½½è¾ƒå¤§æˆ–ç½‘ç»œè¿æ¥æœ‰é—®é¢˜ï¼Œå†ç»§ç»­å‘å…¶å‘é€è¯·æ±‚ä¼šå¢å¤§è¯·æ±‚è¶…æ—¶çš„å¯èƒ½ã€‚ InFlightRequestsè¿˜å¯ä»¥è·å¾—leastLoadedNodeï¼Œå³æ‰€æœ‰Nodeä¸­è´Ÿè½½æœ€å°çš„é‚£ä¸€ä¸ªã€‚è¿™é‡Œçš„è´Ÿè½½æœ€å°æ˜¯é€šè¿‡æ¯ä¸ªNodeåœ¨InFlightRequestsä¸­è¿˜æœªç¡®è®¤çš„è¯·æ±‚å†³å®šçš„ï¼Œæœªç¡®è®¤çš„è¯·æ±‚è¶Šå¤šåˆ™è®¤ä¸ºè´Ÿè½½è¶Šå¤§ é€‰æ‹©leastLoadedNodeå‘é€è¯·æ±‚å¯ä»¥ä½¿å®ƒèƒ½å¤Ÿå°½å¿«å‘å‡ºï¼Œé¿å…å› ç½‘ç»œæ‹¥å¡ç­‰å¼‚å¸¸è€Œå½±å“æ•´ä½“çš„è¿›åº¦ã€‚leastLoadedNodeçš„æ¦‚å¿µå¯ä»¥ç”¨äºå¤šä¸ªåº”ç”¨åœºåˆï¼Œæ¯”å¦‚å…ƒæ•°æ®è¯·æ±‚ã€æ¶ˆè´¹è€…ç»„æ’­åè®®çš„äº¤äº’ã€‚ kafka å…ƒæ•°æ®KafkaProducerè¦å°†æ­¤æ¶ˆæ¯è¿½åŠ åˆ°æŒ‡å®šä¸»é¢˜çš„æŸä¸ªåˆ†åŒºæ‰€å¯¹åº”çš„leaderå‰¯æœ¬ä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦çŸ¥é“ä¸»é¢˜çš„åˆ†åŒºæ•°é‡ï¼Œç„¶åç»è¿‡è®¡ç®—å¾—å‡ºï¼ˆæˆ–è€…ç›´æ¥æŒ‡å®šï¼‰ç›®æ ‡åˆ†åŒºï¼Œä¹‹åKafkaProduceréœ€è¦çŸ¥é“ç›®æ ‡åˆ†åŒºçš„leaderå‰¯æœ¬æ‰€åœ¨çš„broker èŠ‚ç‚¹çš„åœ°å€ã€ç«¯å£ç­‰ä¿¡æ¯æ‰èƒ½å»ºç«‹è¿æ¥ï¼Œæœ€ç»ˆæ‰èƒ½å°†æ¶ˆæ¯å‘é€åˆ° Kafkaï¼Œåœ¨è¿™ä¸€è¿‡ç¨‹ä¸­æ‰€éœ€è¦çš„ä¿¡æ¯éƒ½å±äºå…ƒæ•°æ®ä¿¡æ¯ã€‚ å…ƒæ•°æ®æ˜¯æŒ‡Kafkaé›†ç¾¤çš„å…ƒæ•°æ®ï¼Œè¿™äº›å…ƒæ•°æ®å…·ä½“è®°å½•äº†é›†ç¾¤ä¸­æœ‰å“ªäº›ä¸»é¢˜ï¼Œè¿™äº›ä¸»é¢˜æœ‰å“ªäº›åˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºçš„leaderå‰¯æœ¬åˆ†é…åœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šï¼Œfollowerå‰¯æœ¬åˆ†é…åœ¨å“ªäº›èŠ‚ç‚¹ä¸Šï¼Œå“ªäº›å‰¯æœ¬åœ¨ARã€ISRç­‰é›†åˆä¸­ï¼Œé›†ç¾¤ä¸­æœ‰å“ªäº›èŠ‚ç‚¹ï¼Œæ§åˆ¶å™¨èŠ‚ç‚¹åˆæ˜¯å“ªä¸€ä¸ªç­‰ä¿¡æ¯ã€‚ å½“å®¢æˆ·ç«¯ä¸­æ²¡æœ‰éœ€è¦ä½¿ç”¨çš„å…ƒæ•°æ®ä¿¡æ¯æ—¶ï¼Œæ¯”å¦‚æ²¡æœ‰æŒ‡å®šçš„ä¸»é¢˜ä¿¡æ¯ï¼Œæˆ–è€…è¶…è¿‡metadata.max.age.ms æ—¶é—´æ²¡æœ‰æ›´æ–°å…ƒæ•°æ®éƒ½ä¼šå¼•èµ·å…ƒæ•°æ®çš„æ›´æ–°æ“ä½œã€‚å®¢æˆ·ç«¯å‚æ•°metadata.max.age.msçš„é»˜è®¤å€¼ä¸º300000ï¼Œå³5åˆ†é’Ÿã€‚å…ƒæ•°æ®çš„æ›´æ–°æ“ä½œæ˜¯åœ¨å®¢æˆ·ç«¯å†…éƒ¨è¿›è¡Œçš„ï¼Œå¯¹å®¢æˆ·ç«¯çš„å¤–éƒ¨ä½¿ç”¨è€…ä¸å¯è§ã€‚å½“éœ€è¦æ›´æ–°å…ƒæ•°æ®æ—¶ï¼Œä¼šå…ˆæŒ‘é€‰å‡ºleastLoadedNodeï¼Œç„¶åå‘è¿™ä¸ªNodeå‘é€MetadataRequestè¯·æ±‚æ¥è·å–å…·ä½“çš„å…ƒæ•°æ®ä¿¡æ¯ã€‚è¿™ä¸ªæ›´æ–°æ“ä½œæ˜¯ç”±Senderçº¿ç¨‹å‘èµ·çš„ï¼Œåœ¨åˆ›å»ºå®ŒMetadataRequestä¹‹ååŒæ ·ä¼šå­˜å…¥InFlightRequestsï¼Œä¹‹åçš„æ­¥éª¤å°±å’Œå‘é€æ¶ˆæ¯æ—¶çš„ç±»ä¼¼ã€‚å…ƒæ•°æ®è™½ç„¶ç”±Senderçº¿ç¨‹è´Ÿè´£æ›´æ–°ï¼Œä½†æ˜¯ä¸»çº¿ç¨‹ä¹Ÿéœ€è¦è¯»å–è¿™äº›ä¿¡æ¯ï¼Œè¿™é‡Œçš„æ•°æ®åŒæ­¥é€šè¿‡synchronizedå’Œfinalå…³é”®å­—æ¥ä¿éšœã€‚","date":"2024-12-31","categories":["kafka"]},{"title":"kafkaæ¶æ„è®¾è®¡å’Œå®ç°å…³é”®ç‚¹","url":"/2024/12/31/kafkaæ¶æ„è®¾è®¡å’Œå®ç°å…³é”®ç‚¹/","content":"kafka åŸºæœ¬æ¦‚å¿µ Producerï¼šç”Ÿäº§è€…ï¼Œä¹Ÿå°±æ˜¯å‘é€æ¶ˆæ¯çš„ä¸€æ–¹ã€‚ç”Ÿäº§è€…è´Ÿè´£åˆ›å»ºæ¶ˆæ¯ï¼Œç„¶åå°†å…¶æŠ•é€’åˆ°Kafkaä¸­ Consumerï¼šæ¶ˆè´¹è€…ï¼Œä¹Ÿå°±æ˜¯æ¥æ”¶æ¶ˆæ¯çš„ä¸€æ–¹ã€‚æ¶ˆè´¹è€…è¿æ¥åˆ°Kafkaä¸Šå¹¶æ¥æ”¶æ¶ˆæ¯ï¼Œè¿›è€Œè¿›è¡Œç›¸åº”çš„ä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚ Brokerï¼šæœåŠ¡ä»£ç†èŠ‚ç‚¹ã€‚å¯¹äºKafkaè€Œè¨€ï¼ŒBrokerå¯ä»¥ç®€å•åœ°çœ‹ä½œä¸€ä¸ªç‹¬ç«‹çš„KafkaæœåŠ¡èŠ‚ç‚¹æˆ–KafkaæœåŠ¡å®ä¾‹ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ä¹Ÿå¯ä»¥å°†Brokerçœ‹ä½œä¸€å°KafkaæœåŠ¡å™¨ï¼Œå‰ææ˜¯è¿™å°æœåŠ¡å™¨ä¸Šåªéƒ¨ç½²äº†ä¸€ä¸ªKafkaå®ä¾‹ã€‚ä¸€ä¸ªæˆ–å¤šä¸ªBrokerç»„æˆäº†ä¸€ä¸ªKafkaé›†ç¾¤ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬æ›´ä¹ æƒ¯ä½¿ç”¨é¦–å­—æ¯å°å†™çš„brokeræ¥è¡¨ç¤ºæœåŠ¡ä»£ç†èŠ‚ç‚¹ã€‚ Topic: æœåŠ¡ä¸»é¢˜ ï¼Œ Kafkaä¸­çš„æ¶ˆæ¯ä»¥ä¸»é¢˜ä¸ºå•ä½è¿›è¡Œå½’ç±»ï¼Œç”Ÿäº§è€…è´Ÿè´£å°†æ¶ˆæ¯å‘é€åˆ°ç‰¹å®šçš„ä¸»é¢˜ï¼ˆå‘é€åˆ°Kafkaé›†ç¾¤ä¸­çš„æ¯ä¸€æ¡æ¶ˆæ¯éƒ½è¦æŒ‡å®šä¸€ä¸ªä¸»é¢˜ï¼‰ï¼Œè€Œæ¶ˆè´¹è€…è´Ÿè´£è®¢é˜…ä¸»é¢˜å¹¶è¿›è¡Œæ¶ˆè´¹ã€‚ Partitionï¼šä¸€ä¸ªtopicä¸­çš„ä¸»é¢˜å¯èƒ½ä¼šæœ‰å¤šä¸ªåˆ†åŒº ï¼Œ å¹¶ä¸”ä¸åŒçš„åˆ†åŒºå¯èƒ½å¹¶ä¸ä¼šåœ¨åŒä¸€ä¸ªbrokerä¸­ï¼ŒåŒä¸€ä¸»é¢˜ä¸‹çš„ä¸åŒåˆ†åŒºåŒ…å«çš„æ¶ˆæ¯æ˜¯ä¸åŒçš„ï¼Œåˆ†åŒºåœ¨å­˜å‚¨å±‚é¢å¯ä»¥çœ‹ä½œä¸€ä¸ªå¯è¿½åŠ çš„æ—¥å¿—ï¼ˆLogï¼‰æ–‡ä»¶ï¼Œæ¶ˆæ¯åœ¨è¢«è¿½åŠ åˆ°åˆ†åŒºæ—¥å¿—æ–‡ä»¶çš„æ—¶å€™éƒ½ä¼šåˆ†é…ä¸€ä¸ªç‰¹å®šçš„åç§»é‡ï¼ˆoffsetï¼‰ã€‚offsetæ˜¯æ¶ˆæ¯åœ¨åˆ†åŒºä¸­çš„å”¯ä¸€æ ‡è¯†ï¼ŒKafkaé€šè¿‡å®ƒæ¥ä¿è¯æ¶ˆæ¯åœ¨åˆ†åŒºå†…çš„é¡ºåºæ€§ï¼Œä¸è¿‡offsetå¹¶ä¸è·¨è¶Šåˆ†åŒºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒKafkaä¿è¯çš„æ˜¯åˆ†åŒºæœ‰åºè€Œä¸æ˜¯ä¸»é¢˜æœ‰åºã€‚ Replicaå’Œleader&followå‰¯æœ¬ï¼škafkaé’ˆå¯¹åˆ†åŒºæœ‰å¤šå‰¯æœ¬æœºåˆ¶å®ç°é«˜å¯ç”¨ï¼Œå¹¶ä¸”ä¿è¯å‰¯æœ¬å­˜æ”¾åœ¨ä¸åŒçš„brokerä¸­ æ³¨æ„ç‚¹ï¼š kafkaæ¶ˆè´¹è€…ä½¿ç”¨pullæ¨¡å¼æ‹‰å– ï¼Ÿé•¿è½®è¯¢ï¼Ÿ kafkaåŸºæœ¬æ¶æ„ç³»ç»Ÿæ¶æ„ åè¯æ¦‚å¿µ ARï¼ˆAssigned Replicasï¼‰ ï¼š kafkaå‰¯æœ¬ç³»ç»Ÿç»Ÿç§° ISRï¼ˆIn-Sync Replicasï¼‰ï¼š ä¸leaderå‰¯æœ¬ä¿æŒåŒæ­¥çš„å‰¯æœ¬ OSRï¼ˆOut-of-Sync Replicasï¼‰ leaderå‰¯æœ¬è´Ÿè´£ç»´æŠ¤å’Œè·Ÿè¸ªISRå’ŒOSRé›†åˆçš„followerå‰¯æœ¬çš„æ»åçŠ¶æ€ï¼Œå½“followerå‰¯æœ¬è½åå¤ªå¤šæˆ–å¤±æ•ˆæ—¶ï¼Œleaderå‰¯æœ¬ä¼šæŠŠå®ƒä»ISRé›†åˆä¸­å‰”é™¤ã€‚å¦‚æœOSRé›†åˆä¸­æœ‰followerå‰¯æœ¬â€œè¿½ä¸Šâ€äº†leaderå‰¯æœ¬ï¼Œé‚£ä¹ˆleaderå‰¯æœ¬ä¼šæŠŠå®ƒä»OSRé›†åˆè½¬ç§»è‡³ISRé›†åˆ é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“leaderå‰¯æœ¬å‘ç”Ÿæ•…éšœæ—¶ï¼Œåªæœ‰åœ¨ISRé›†åˆä¸­çš„å‰¯æœ¬æ‰æœ‰èµ„æ ¼è¢«é€‰ä¸¾ä¸ºæ–°çš„leaderï¼Œè€Œåœ¨OSRé›†åˆä¸­çš„å‰¯æœ¬åˆ™æ²¡æœ‰ä»»ä½•æœºä¼šï¼ˆä¸è¿‡è¿™ä¸ªåŸåˆ™ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹ç›¸åº”çš„å‚æ•°é…ç½®æ¥æ”¹å˜ï¼‰ LEO ï¼š LEOæ˜¯Log End Offsetçš„ç¼©å†™ï¼Œå®ƒæ ‡è¯†å½“å‰æ—¥å¿—æ–‡ä»¶ä¸­ä¸‹ä¸€æ¡å¾…å†™å…¥æ¶ˆæ¯çš„offset HW ï¼š HWæ˜¯High Watermarkçš„ç¼©å†™ï¼Œä¿—ç§°é«˜æ°´ä½ï¼Œå®ƒæ ‡è¯†äº†ä¸€ä¸ªç‰¹å®šçš„æ¶ˆæ¯åç§»é‡ï¼ˆoffsetï¼‰ï¼Œæ¶ˆè´¹è€…åªèƒ½æ‹‰å–åˆ°è¿™ä¸ªoffsetä¹‹å‰çš„æ¶ˆæ¯ã€‚ æ³¨æ„ï¼š LEOå’ŒHW éƒ½æè¿°çš„æ˜¯ä¸‹ä¸€ä¸ªèƒ½æ’å…¥æˆ–è€…èƒ½è¯»å…¥çš„ä½ç½®ï¼Œè€Œä¸æ˜¯å½“å‰ä½ç½® LEOä½ç½®çš„ç¡®å®šæ–¹æ³•æ˜¯æ¯ä¸€ä¸ªå‰¯æœ¬å½“å‰èƒ½æ’å…¥çš„ä¸‹ä¸€ä¸ªé—®é¢˜ï¼ŒHWçš„ä½ç½®æ˜¯leaderé€šè¿‡åŒæ­¥å½“å‰æ‰€æœ‰å‰¯æœ¬ä¸­æœ€å°çš„LEOæ¥å†³å®šHW kafka producerKafkaProduceråˆ›å»ºå‘é€æ¶ˆæ¯å¯¹è±¡ProducerRecord ? æš‚æ—¶çœç•¥ å‘é€æ¶ˆæ¯ä¸‰ç§ä¸»è¦æ¨¡å¼å‘åå³å¿˜ï¼ˆfire-and-forgetï¼‰ã€åŒæ­¥ï¼ˆsyncï¼‰åŠå¼‚æ­¥ï¼ˆasyncï¼‰ fire-and0forgetï¼šå‘åå³å¿˜ï¼Œå®ƒåªç®¡å¾€Kafkaä¸­å‘é€æ¶ˆæ¯è€Œå¹¶ä¸å…³å¿ƒæ¶ˆæ¯æ˜¯å¦æ­£ç¡®åˆ°è¾¾ syncï¼šä½¿ç”¨sendæ–¹æ³• é˜»å¡ç­‰å¾…Kafkaçš„å“åº” ,è¿”å›ä¸€ä¸ªFutureç±»ï¼Œç›´åˆ°æ¶ˆæ¯å‘é€æˆåŠŸï¼Œæˆ–è€…å‘ç”Ÿå¼‚å¸¸ã€‚å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œé‚£ä¹ˆå°±éœ€è¦æ•è·å¼‚å¸¸å¹¶äº¤ç”±å¤–å±‚é€»è¾‘å¤„ç† async:ä¸€èˆ¬æ˜¯åœ¨sendï¼ˆï¼‰æ–¹æ³•é‡ŒæŒ‡å®šä¸€ä¸ªCallbackçš„å›è°ƒå‡½æ•°ï¼ŒKafkaåœ¨è¿”å›å“åº”æ—¶è°ƒç”¨è¯¥å‡½æ•°æ¥å®ç°å¼‚æ­¥çš„å‘é€ç¡®è®¤ æ³¨æ„ï¼š ä½¿ç”¨producerä¹‹åè¦è°ƒç”¨closeæ–¹æ³•æ¥å…³é—­è¯·æ±‚ kafka producerå¼‚å¸¸KafkaProducerä¸­ä¸€èˆ¬ä¼šå‘ç”Ÿä¸¤ç§ç±»å‹çš„å¼‚å¸¸ï¼šå¯é‡è¯•çš„å¼‚å¸¸å’Œä¸å¯é‡è¯•çš„å¼‚å¸¸ã€‚å¸¸è§çš„å¯é‡è¯•å¼‚å¸¸æœ‰ï¼šNetworkExceptionã€LeaderNotAvailableExceptionã€UnknownTopicOrPartitionExceptionã€NotEnoughReplicasExceptionã€NotCoordinatorException ç­‰ã€‚æ¯”å¦‚NetworkException è¡¨ç¤ºç½‘ç»œå¼‚å¸¸ï¼Œè¿™ä¸ªæœ‰å¯èƒ½æ˜¯ç”±äºç½‘ç»œç¬æ—¶æ•…éšœè€Œå¯¼è‡´çš„å¼‚å¸¸ï¼Œå¯ä»¥é€šè¿‡é‡è¯•è§£å†³ï¼›åˆæ¯”å¦‚LeaderNotAvailableExceptionè¡¨ç¤ºåˆ†åŒºçš„leaderå‰¯æœ¬ä¸å¯ç”¨ï¼Œè¿™ä¸ªå¼‚å¸¸é€šå¸¸å‘ç”Ÿåœ¨leaderå‰¯æœ¬ä¸‹çº¿è€Œæ–°çš„ leader å‰¯æœ¬é€‰ä¸¾å®Œæˆä¹‹å‰ï¼Œé‡è¯•ä¹‹åå¯ä»¥é‡æ–°æ¢å¤ã€‚ ä¸å¯é‡è¯•çš„å¼‚å¸¸ï¼Œæ¯”å¦‚RecordTooLargeExceptionå¼‚å¸¸ï¼Œæš—ç¤ºäº†æ‰€å‘é€çš„æ¶ˆæ¯å¤ªå¤§ï¼ŒKafkaProducerå¯¹æ­¤ä¸ä¼šè¿›è¡Œä»»ä½•é‡è¯•ï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚ å¯¹äºå¯é‡è¯•çš„å¼‚å¸¸ï¼Œå¦‚æœé…ç½®äº† retries å‚æ•°ï¼Œé‚£ä¹ˆåªè¦åœ¨è§„å®šçš„é‡è¯•æ¬¡æ•°å†…è‡ªè¡Œæ¢å¤äº†ï¼Œå°±ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚retrieså‚æ•°çš„é»˜è®¤å€¼ä¸º0ï¼Œé…ç½®æ–¹å¼å‚è€ƒå¦‚ä¸‹ï¼š ç¤ºä¾‹ä¸­é…ç½®äº†10æ¬¡é‡è¯•ã€‚å¦‚æœé‡è¯•äº†10æ¬¡ä¹‹åè¿˜æ²¡æœ‰æ¢å¤ï¼Œé‚£ä¹ˆä»ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè¿›è€Œå‘é€çš„å¤–å±‚é€»è¾‘å°±è¦å¤„ç†è¿™äº›å¼‚å¸¸äº† producerå‘å¾€ brokerçš„è¿‡ç¨‹æ¶ˆæ¯åœ¨é€šè¿‡sendï¼ˆï¼‰æ–¹æ³•å‘å¾€brokerçš„è¿‡ç¨‹ä¸­ï¼Œæœ‰å¯èƒ½éœ€è¦ç»è¿‡æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰ã€åºåˆ—åŒ–å™¨ï¼ˆSerializerï¼‰å’Œåˆ†åŒºå™¨ï¼ˆPartitionerï¼‰çš„ä¸€ç³»åˆ—ä½œç”¨ä¹‹åæ‰èƒ½è¢«çœŸæ­£åœ°å‘å¾€ broker åˆ†åŒºå™¨: Partitioner-ç”¨äºç¡®å®šå®ƒå‘å¾€çš„åˆ†åŒºï¼Œå¦‚æœæ¶ˆæ¯ProducerRecordä¸­æŒ‡å®šäº†partitionå­—æ®µï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦åˆ†åŒºå™¨çš„ä½œç”¨ï¼Œå› ä¸ºpartitionä»£è¡¨çš„å°±æ˜¯æ‰€è¦å‘å¾€çš„åˆ†åŒºå· Kafkaä¸­æä¾›çš„é»˜è®¤åˆ†åŒºå™¨æ˜¯org.apache.kafka.clients.producer.internals.DefaultPartitionerï¼Œå®ƒå®ç°äº†org.apache.kafka.clients.producer.Partitioneræ¥å£ï¼Œè¿™ä¸ªæ¥å£ä¸­å®šä¹‰äº†2ä¸ªæ–¹æ³• å…¶ä¸­partitionï¼ˆï¼‰æ–¹æ³•ç”¨æ¥è®¡ç®—åˆ†åŒºå·ï¼Œè¿”å›å€¼ä¸ºintç±»å‹ã€‚partitionï¼ˆï¼‰æ–¹æ³•ä¸­çš„å‚æ•°åˆ†åˆ«è¡¨ç¤ºä¸»é¢˜ã€é”®ã€åºåˆ—åŒ–åçš„é”®ã€å€¼ã€åºåˆ—åŒ–åçš„å€¼ï¼Œä»¥åŠé›†ç¾¤çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œé€šè¿‡è¿™äº›ä¿¡æ¯å¯ä»¥å®ç°åŠŸèƒ½ä¸°å¯Œçš„åˆ†åŒºå™¨ã€‚closeï¼ˆï¼‰æ–¹æ³•åœ¨å…³é—­åˆ†åŒºå™¨çš„æ—¶å€™ç”¨æ¥å›æ”¶ä¸€äº›èµ„æºã€‚ åœ¨é»˜è®¤åˆ†åŒºå™¨ DefaultPartitioner çš„å®ç°ä¸­ï¼Œcloseï¼ˆï¼‰æ˜¯ç©ºæ–¹æ³•ï¼Œè€Œåœ¨ partitionï¼ˆï¼‰æ–¹æ³•ä¸­å®šä¹‰äº†ä¸»è¦çš„åˆ†åŒºåˆ†é…é€»è¾‘ã€‚å¦‚æœ key ä¸ä¸º nullï¼Œé‚£ä¹ˆé»˜è®¤çš„åˆ†åŒºå™¨ä¼šå¯¹ key è¿›è¡Œå“ˆå¸Œï¼ˆé‡‡ç”¨MurmurHash2ç®—æ³•ï¼Œå…·å¤‡é«˜è¿ç®—æ€§èƒ½åŠä½ç¢°æ’ç‡ï¼‰ï¼Œæœ€ç»ˆæ ¹æ®å¾—åˆ°çš„å“ˆå¸Œå€¼æ¥è®¡ç®—åˆ†åŒºå·ï¼Œæ‹¥æœ‰ç›¸åŒkeyçš„æ¶ˆæ¯ä¼šè¢«å†™å…¥åŒä¸€ä¸ªåˆ†åŒºã€‚å¦‚æœkeyä¸ºnullï¼Œé‚£ä¹ˆæ¶ˆæ¯å°†ä¼šä»¥è½®è¯¢çš„æ–¹å¼å‘å¾€ä¸»é¢˜å†…çš„å„ä¸ªå¯ç”¨åˆ†åŒºã€‚ æ³¨æ„ï¼šå¦‚æœ key ä¸ä¸º nullï¼Œé‚£ä¹ˆè®¡ç®—å¾—åˆ°çš„åˆ†åŒºå·ä¼šæ˜¯æ‰€æœ‰åˆ†åŒºä¸­çš„ä»»æ„ä¸€ä¸ªï¼›å¦‚æœ keyä¸ºnullï¼Œé‚£ä¹ˆè®¡ç®—å¾—åˆ°çš„åˆ†åŒºå·ä»…ä¸ºå¯ç”¨åˆ†åŒºä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œæ³¨æ„ä¸¤è€…ä¹‹é—´çš„å·®åˆ«ã€‚ åœ¨ä¸æ”¹å˜ä¸»é¢˜åˆ†åŒºæ•°é‡çš„æƒ…å†µä¸‹ï¼Œkeyä¸åˆ†åŒºä¹‹é—´çš„æ˜ å°„å¯ä»¥ä¿æŒä¸å˜ã€‚ä¸è¿‡ï¼Œä¸€æ—¦ä¸»é¢˜ä¸­å¢åŠ äº†åˆ†åŒºï¼Œé‚£ä¹ˆå°±éš¾ä»¥ä¿è¯keyä¸åˆ†åŒºä¹‹é—´çš„æ˜ å°„å…³ç³»äº†ã€‚ è‡ªå®šä¹‰åˆ†åŒºå™¨å®ç° - å’Œdefaultæ–¹æ³•ç±»ä¼¼ï¼Œåªè¦è‡ªå·±å®šä¹‰Partitioneré‡å†™ä¸€ä¸‹é‡Œé¢çš„æ¥å£å®ç°å³å¯ è¿™ä¸ªè‡ªå®šä¹‰åˆ†åŒºå™¨çš„å®ç°æ¯”è¾ƒç®€å•ï¼Œè¯»è€…ä¹Ÿå¯ä»¥æ ¹æ®è‡ªèº«ä¸šåŠ¡çš„éœ€æ±‚æ¥çµæ´»å®ç°åˆ†é…åˆ†åŒºçš„è®¡ç®—æ–¹å¼ï¼Œæ¯”å¦‚ä¸€èˆ¬å¤§å‹ç”µå•†éƒ½æœ‰å¤šä¸ªä»“åº“ï¼Œå¯ä»¥å°†ä»“åº“çš„åç§°æˆ–IDä½œä¸ºkeyæ¥çµæ´»åœ°è®°å½•å•†å“ä¿¡æ¯ã€‚ åºåˆ—åŒ–å™¨ï¼šSerializer ç”¨äºæŒ‡å®šæ¶ˆæ¯çš„åºåˆ—åŒ–æ–¹æ³• kafkaæ”¯æŒè‡ªå®šä¹‰çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œåªéœ€è¦å®ç°å¯¹åº”çš„æ¥å£å°±å¯ä»¥äº†org.apache.kafka.common.serialization.Serializer æ³¨æ„ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å¯¹åº”çš„åºåˆ—åŒ–åè®®å¿…é¡»è¦ä¸€è‡´ ç”Ÿäº§è€…æ‹¦æˆªå™¨ ç”Ÿäº§è€…æ‹¦æˆªå™¨æ—¢å¯ä»¥ç”¨æ¥åœ¨æ¶ˆæ¯å‘é€å‰åšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œæ¯”å¦‚æŒ‰ç…§æŸä¸ªè§„åˆ™è¿‡æ»¤ä¸ç¬¦åˆè¦æ±‚çš„æ¶ˆæ¯ã€ä¿®æ”¹æ¶ˆæ¯çš„å†…å®¹ç­‰ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥åœ¨å‘é€å›è°ƒé€»è¾‘å‰åšä¸€äº›å®šåˆ¶åŒ–çš„éœ€æ±‚ï¼Œæ¯”å¦‚ç»Ÿè®¡ç±»å·¥ä½œã€‚ ç”Ÿäº§è€…æ‹¦æˆªå™¨çš„ä½¿ç”¨ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œä¸»è¦æ˜¯è‡ªå®šä¹‰å®ç° org.apache.kafka.clients.producer.ProducerInterceptoræ¥å£ onSendï¼ˆï¼‰æ–¹æ³• ï¼šKafkaProduceråœ¨å°†æ¶ˆæ¯åºåˆ—åŒ–å’Œè®¡ç®—åˆ†åŒºä¹‹å‰ä¼šè°ƒç”¨ç”Ÿäº§è€…æ‹¦æˆªå™¨çš„onSendï¼ˆï¼‰æ–¹æ³•æ¥å¯¹æ¶ˆæ¯è¿›è¡Œç›¸åº”çš„å®šåˆ¶åŒ–æ“ä½œã€‚ä¸€èˆ¬æ¥è¯´æœ€å¥½ä¸è¦ä¿®æ”¹æ¶ˆæ¯ ProducerRecord çš„ topicã€key å’Œpartition ç­‰ä¿¡æ¯ï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œåˆ™éœ€ç¡®ä¿å¯¹å…¶æœ‰å‡†ç¡®çš„åˆ¤æ–­ï¼Œå¦åˆ™ä¼šä¸é¢„æƒ³çš„æ•ˆæœå‡ºç°åå·®ã€‚æ¯”å¦‚ä¿®æ”¹keyä¸ä»…ä¼šå½±å“åˆ†åŒºçš„è®¡ç®—ï¼ŒåŒæ ·ä¼šå½±å“brokerç«¯æ—¥å¿—å‹ç¼©ï¼ˆLog Compactionï¼‰çš„åŠŸèƒ½ã€‚ onAcknowledgementï¼ˆï¼‰ï¼š KafkaProducer ä¼šåœ¨æ¶ˆæ¯è¢«åº”ç­”ï¼ˆAcknowledgementï¼‰ä¹‹å‰æˆ–æ¶ˆæ¯å‘é€å¤±è´¥æ—¶è°ƒç”¨ç”Ÿäº§è€…æ‹¦æˆªå™¨çš„onAcknowledgementï¼ˆï¼‰æ–¹æ³•ï¼Œä¼˜å…ˆäºç”¨æˆ·è®¾å®šçš„ Callback ä¹‹å‰æ‰§è¡Œã€‚è¿™ä¸ªæ–¹æ³•è¿è¡Œåœ¨Producer çš„ I&#x2F;O çº¿ç¨‹ä¸­ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•ä¸­å®ç°çš„ä»£ç é€»è¾‘è¶Šç®€å•è¶Šå¥½ï¼Œå¦åˆ™ä¼šå½±å“æ¶ˆæ¯çš„å‘é€é€Ÿåº¦ã€‚ closeï¼ˆï¼‰æ–¹æ³• ï¼šä¸»è¦ç”¨äºåœ¨å…³é—­æ‹¦æˆªå™¨æ—¶æ‰§è¡Œä¸€äº›èµ„æºçš„æ¸…ç†å·¥ä½œã€‚åœ¨è¿™ 3 ä¸ªæ–¹æ³•ä¸­æŠ›å‡ºçš„å¼‚å¸¸éƒ½ä¼šè¢«æ•è·å¹¶è®°å½•åˆ°æ—¥å¿—ä¸­ï¼Œä½†å¹¶ä¸ä¼šå†å‘ä¸Šä¼ é€’ã€‚ æ³¨æ„ï¼š KafkaProducerä¸­ä¸ä»…å¯ä»¥æŒ‡å®šä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œè¿˜å¯ä»¥æŒ‡å®šå¤šä¸ªæ‹¦æˆªå™¨ä»¥å½¢æˆæ‹¦æˆªé“¾ kafka produceræ¶æ„å›¾ æ•´ä¸ªç”Ÿäº§è€…å®¢æˆ·ç«¯ç”±ä¸¤ä¸ªçº¿ç¨‹åè°ƒè¿è¡Œï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«ä¸ºä¸»çº¿ç¨‹å’ŒSenderçº¿ç¨‹ï¼ˆå‘é€çº¿ç¨‹ï¼‰ã€‚ åœ¨ä¸»çº¿ç¨‹ä¸­ç”±KafkaProduceråˆ›å»ºæ¶ˆæ¯ï¼Œç„¶åé€šè¿‡å¯èƒ½çš„æ‹¦æˆªå™¨ã€åºåˆ—åŒ–å™¨å’Œåˆ†åŒºå™¨çš„ä½œç”¨ä¹‹åç¼“å­˜åˆ°æ¶ˆæ¯ç´¯åŠ å™¨ï¼ˆRecordAccumulatorï¼Œä¹Ÿç§°ä¸ºæ¶ˆæ¯æ”¶é›†å™¨ï¼‰ä¸­ã€‚ RecordAccumulator ä¸»è¦ç”¨æ¥ç¼“å­˜æ¶ˆæ¯ä»¥ä¾¿ Sender çº¿ç¨‹å¯ä»¥æ‰¹é‡å‘é€ï¼Œè¿›è€Œå‡å°‘ç½‘ç»œä¼ è¾“çš„èµ„æºæ¶ˆè€—ä»¥æå‡æ€§èƒ½ã€‚RecordAccumulator ç¼“å­˜çš„å¤§å°å¯ä»¥é€šè¿‡ç”Ÿäº§è€…å®¢æˆ·ç«¯å‚æ•°buffer.memory é…ç½®ï¼Œé»˜è®¤å€¼ä¸º 33554432Bï¼Œå³ 32MBã€‚å¦‚æœç”Ÿäº§è€…å‘é€æ¶ˆæ¯çš„é€Ÿåº¦è¶…è¿‡å‘é€åˆ°æœåŠ¡å™¨çš„é€Ÿåº¦ï¼Œåˆ™ä¼šå¯¼è‡´ç”Ÿäº§è€…ç©ºé—´ä¸è¶³ï¼Œè¿™ä¸ªæ—¶å€™KafkaProducerçš„sendï¼ˆï¼‰æ–¹æ³•è°ƒç”¨è¦ä¹ˆè¢«é˜»å¡ï¼Œè¦ä¹ˆæŠ›å‡ºå¼‚å¸¸ï¼Œè¿™ä¸ªå–å†³äºå‚æ•°max.block.msçš„é…ç½®ï¼Œæ­¤å‚æ•°çš„é»˜è®¤å€¼ä¸º60000ï¼Œå³60ç§’ã€‚ åœ¨ RecordAccumulator çš„å†…éƒ¨ä¸ºæ¯ä¸ªåˆ†åŒºéƒ½ç»´æŠ¤äº†ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—ä¸­çš„å†…å®¹å°±æ˜¯ProducerBatchï¼Œå³ Dequeï¼œProducerBatchï¼ã€‚å†™å…¥è¿½åŠ åˆ°å°¾éƒ¨ï¼Œè¯»å–ä»å¤´éƒ¨è¯»å–ProducerBatchä¸­å¯ä»¥åŒ…å«ä¸€è‡³å¤šä¸ª ProducerRecordã€‚é€šä¿—åœ°è¯´ï¼ŒProducerRecord æ˜¯ç”Ÿäº§è€…ä¸­åˆ›å»ºçš„æ¶ˆæ¯ï¼Œè€ŒProducerBatchæ˜¯æŒ‡ä¸€ä¸ªæ¶ˆæ¯æ‰¹æ¬¡ï¼ŒProducerRecordä¼šè¢«åŒ…å«åœ¨ProducerBatchä¸­ï¼Œè¿™æ ·å¯ä»¥ä½¿å­—èŠ‚çš„ä½¿ç”¨æ›´åŠ ç´§å‡‘ã€‚ä¸æ­¤åŒæ—¶ï¼Œå°†è¾ƒå°çš„ProducerRecordæ‹¼å‡‘æˆä¸€ä¸ªè¾ƒå¤§çš„ProducerBatchï¼Œä¹Ÿå¯ä»¥å‡å°‘ç½‘ç»œè¯·æ±‚çš„æ¬¡æ•°ä»¥æå‡æ•´ä½“çš„ååé‡ æ¶ˆæ¯åœ¨ç½‘ç»œä¸Šéƒ½æ˜¯ä»¥å­—èŠ‚ï¼ˆByteï¼‰çš„å½¢å¼ä¼ è¾“çš„ï¼Œåœ¨å‘é€ä¹‹å‰éœ€è¦åˆ›å»ºä¸€å—å†…å­˜åŒºåŸŸæ¥ä¿å­˜å¯¹åº”çš„æ¶ˆæ¯ã€‚åœ¨Kafkaç”Ÿäº§è€…å®¢æˆ·ç«¯ä¸­ï¼Œé€šè¿‡java.io.ByteBufferå®ç°æ¶ˆæ¯å†…å­˜çš„åˆ›å»ºå’Œé‡Šæ”¾ã€‚ä¸è¿‡é¢‘ç¹çš„åˆ›å»ºå’Œé‡Šæ”¾æ˜¯æ¯”è¾ƒè€—è´¹èµ„æºçš„ï¼Œåœ¨RecordAccumulatorçš„å†…éƒ¨è¿˜æœ‰ä¸€ä¸ªBufferPoolï¼Œå®ƒä¸»è¦ç”¨æ¥å®ç°ByteBufferçš„å¤ç”¨ï¼Œä»¥å®ç°ç¼“å­˜çš„é«˜æ•ˆåˆ©ç”¨ã€‚ä¸è¿‡BufferPoolåªé’ˆå¯¹ç‰¹å®šå¤§å°çš„ByteBufferè¿›è¡Œç®¡ç†ï¼Œè€Œå…¶ä»–å¤§å°çš„ByteBufferä¸ä¼šç¼“å­˜è¿›BufferPoolä¸­ï¼Œè¿™ä¸ªç‰¹å®šçš„å¤§å°ç”±batch.sizeå‚æ•°æ¥æŒ‡å®šï¼Œé»˜è®¤å€¼ä¸º16384Bï¼Œå³16KBã€‚ æˆ‘ä»¬å¯ä»¥é€‚å½“åœ°è°ƒå¤§batch.sizeå‚æ•°ä»¥ä¾¿å¤šç¼“å­˜ä¸€äº›æ¶ˆæ¯ã€‚ProducerBatchçš„å¤§å°å’Œbatch.sizeå‚æ•°ä¹Ÿæœ‰ç€å¯†åˆ‡çš„å…³ç³»ã€‚å½“ä¸€æ¡æ¶ˆæ¯ï¼ˆProducerRecordï¼‰æµå…¥RecordAccumulatoræ—¶ï¼Œä¼šå…ˆå¯»æ‰¾ä¸æ¶ˆæ¯åˆ†åŒºæ‰€å¯¹åº”çš„åŒç«¯é˜Ÿåˆ—ï¼ˆå¦‚æœæ²¡æœ‰åˆ™æ–°å»ºï¼‰ï¼Œå†ä»è¿™ä¸ªåŒç«¯é˜Ÿåˆ—çš„å°¾éƒ¨è·å–ä¸€ä¸ª ProducerBatchï¼ˆå¦‚æœæ²¡æœ‰åˆ™æ–°å»ºï¼‰ï¼ŒæŸ¥çœ‹ ProducerBatch ä¸­æ˜¯å¦è¿˜å¯ä»¥å†™å…¥è¿™ä¸ª ProducerRecordï¼Œå¦‚æœå¯ä»¥åˆ™å†™å…¥ï¼Œå¦‚æœä¸å¯ä»¥åˆ™éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ProducerBatchã€‚åœ¨æ–°å»ºProducerBatchæ—¶è¯„ä¼°è¿™æ¡æ¶ˆæ¯çš„å¤§å°æ˜¯å¦è¶…è¿‡batch.sizeå‚æ•°çš„å¤§å°ï¼Œå¦‚æœä¸è¶…è¿‡ï¼Œé‚£ä¹ˆå°±ä»¥ batch.sizeå‚æ•°çš„å¤§å°æ¥åˆ›å»º ProducerBatchï¼Œè¿™æ ·åœ¨ä½¿ç”¨å®Œè¿™æ®µå†…å­˜åŒºåŸŸä¹‹åï¼Œå¯ä»¥é€šè¿‡BufferPool çš„ç®¡ç†æ¥è¿›è¡Œå¤ç”¨ï¼›å¦‚æœè¶…è¿‡ï¼Œé‚£ä¹ˆå°±ä»¥è¯„ä¼°çš„å¤§å°æ¥åˆ›å»ºProducerBatchï¼Œè¿™æ®µå†…å­˜åŒºåŸŸä¸ä¼šè¢«å¤ç”¨ã€‚ Sender çº¿ç¨‹è´Ÿè´£ä»RecordAccumulatorä¸­è·å–æ¶ˆæ¯å¹¶å°†å…¶å‘é€åˆ°Kafkaä¸­ Sender ä» RecordAccumulator ä¸­è·å–ç¼“å­˜çš„æ¶ˆæ¯ä¹‹åï¼Œä¼šè¿›ä¸€æ­¥å°†åŸæœ¬ï¼œåˆ†åŒºï¼ŒDequeï¼œProducerBatchï¼ï¼çš„ä¿å­˜å½¢å¼è½¬å˜æˆï¼œNodeï¼ŒListï¼œ ProducerBatchï¼çš„å½¢å¼ï¼Œå…¶ä¸­Nodeè¡¨ç¤ºKafkaé›†ç¾¤çš„brokerèŠ‚ç‚¹ã€‚å¯¹äºç½‘ç»œè¿æ¥æ¥è¯´ï¼Œç”Ÿäº§è€…å®¢æˆ·ç«¯æ˜¯ä¸å…·ä½“çš„brokerèŠ‚ç‚¹å»ºç«‹çš„è¿æ¥ï¼Œä¹Ÿå°±æ˜¯å‘å…·ä½“çš„ broker èŠ‚ç‚¹å‘é€æ¶ˆæ¯ï¼Œè€Œå¹¶ä¸å…³å¿ƒæ¶ˆæ¯å±äºå“ªä¸€ä¸ªåˆ†åŒºï¼›è€Œå¯¹äº KafkaProducerçš„åº”ç”¨é€»è¾‘è€Œè¨€ï¼Œæˆ‘ä»¬åªå…³æ³¨å‘å“ªä¸ªåˆ†åŒºä¸­å‘é€å“ªäº›æ¶ˆæ¯ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œéœ€è¦åšä¸€ä¸ªåº”ç”¨é€»è¾‘å±‚é¢åˆ°ç½‘ç»œI&#x2F;Oå±‚é¢çš„è½¬æ¢ã€‚ åœ¨è½¬æ¢æˆï¼œNodeï¼ŒListï¼œProducerBatchï¼ï¼çš„å½¢å¼ä¹‹åï¼ŒSender è¿˜ä¼šè¿›ä¸€æ­¥å°è£…æˆï¼œNodeï¼ŒRequestï¼çš„å½¢å¼ï¼Œè¿™æ ·å°±å¯ä»¥å°†Requestè¯·æ±‚å‘å¾€å„ä¸ªNodeäº†ï¼Œè¿™é‡Œçš„Requestæ˜¯æŒ‡Kafkaçš„å„ç§åè®®è¯·æ±‚ï¼Œå¯¹äºæ¶ˆæ¯å‘é€è€Œè¨€å°±æ˜¯æŒ‡å…·ä½“çš„ProduceRequest Senderä¸­çš„InFlightRequestsé›†åˆ è¯·æ±‚åœ¨ä»Senderçº¿ç¨‹å‘å¾€Kafkaä¹‹å‰è¿˜ä¼šä¿å­˜åˆ°InFlightRequestsä¸­ï¼ŒInFlightRequestsä¿å­˜å¯¹è±¡çš„å…·ä½“å½¢å¼ä¸º Mapï¼œNodeIdï¼ŒDequeï¼œRequestï¼ï¼ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ç¼“å­˜äº†å·²ç»å‘å‡ºå»ä½†è¿˜æ²¡æœ‰æ”¶åˆ°å“åº”çš„è¯·æ±‚ï¼ˆNodeId æ˜¯ä¸€ä¸ª String ç±»å‹ï¼Œè¡¨ç¤ºèŠ‚ç‚¹çš„ id ç¼–å·ï¼‰ã€‚ ä¸æ­¤åŒæ—¶ï¼ŒInFlightRequestsè¿˜æä¾›äº†è®¸å¤šç®¡ç†ç±»çš„æ–¹æ³•ï¼Œå¹¶ä¸”é€šè¿‡é…ç½®å‚æ•°è¿˜å¯ä»¥é™åˆ¶æ¯ä¸ªè¿æ¥ï¼ˆä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯ä¸Nodeä¹‹é—´çš„è¿æ¥ï¼‰æœ€å¤šç¼“å­˜çš„è¯·æ±‚æ•°ã€‚è¿™ä¸ªé…ç½®å‚æ•°ä¸ºmax.in.flight.requests.per.connectionï¼Œé»˜è®¤å€¼ä¸º 5ï¼Œå³æ¯ä¸ªè¿æ¥æœ€å¤šåªèƒ½ç¼“å­˜ 5 ä¸ªæœªå“åº”çš„è¯·æ±‚ï¼Œè¶…è¿‡è¯¥æ•°å€¼ä¹‹åå°±ä¸èƒ½å†å‘è¿™ä¸ªè¿æ¥å‘é€æ›´å¤šçš„è¯·æ±‚äº†ï¼Œé™¤éæœ‰ç¼“å­˜çš„è¯·æ±‚æ”¶åˆ°äº†å“åº”ï¼ˆResponseï¼‰ã€‚é€šè¿‡æ¯”è¾ƒDequeï¼œRequestï¼çš„sizeä¸è¿™ä¸ªå‚æ•°çš„å¤§å°æ¥åˆ¤æ–­å¯¹åº”çš„Nodeä¸­æ˜¯å¦å·²ç»å †ç§¯äº†å¾ˆå¤šæœªå“åº”çš„æ¶ˆæ¯ï¼Œå¦‚æœçœŸæ˜¯å¦‚æ­¤ï¼Œé‚£ä¹ˆè¯´æ˜è¿™ä¸ª Node èŠ‚ç‚¹è´Ÿè½½è¾ƒå¤§æˆ–ç½‘ç»œè¿æ¥æœ‰é—®é¢˜ï¼Œå†ç»§ç»­å‘å…¶å‘é€è¯·æ±‚ä¼šå¢å¤§è¯·æ±‚è¶…æ—¶çš„å¯èƒ½ã€‚ InFlightRequestsè¿˜å¯ä»¥è·å¾—leastLoadedNodeï¼Œå³æ‰€æœ‰Nodeä¸­è´Ÿè½½æœ€å°çš„é‚£ä¸€ä¸ªã€‚è¿™é‡Œçš„è´Ÿè½½æœ€å°æ˜¯é€šè¿‡æ¯ä¸ªNodeåœ¨InFlightRequestsä¸­è¿˜æœªç¡®è®¤çš„è¯·æ±‚å†³å®šçš„ï¼Œæœªç¡®è®¤çš„è¯·æ±‚è¶Šå¤šåˆ™è®¤ä¸ºè´Ÿè½½è¶Šå¤§ é€‰æ‹©leastLoadedNodeå‘é€è¯·æ±‚å¯ä»¥ä½¿å®ƒèƒ½å¤Ÿå°½å¿«å‘å‡ºï¼Œé¿å…å› ç½‘ç»œæ‹¥å¡ç­‰å¼‚å¸¸è€Œå½±å“æ•´ä½“çš„è¿›åº¦ã€‚leastLoadedNodeçš„æ¦‚å¿µå¯ä»¥ç”¨äºå¤šä¸ªåº”ç”¨åœºåˆï¼Œæ¯”å¦‚å…ƒæ•°æ®è¯·æ±‚ã€æ¶ˆè´¹è€…ç»„æ’­åè®®çš„äº¤äº’ã€‚ kafka å…ƒæ•°æ®KafkaProducerè¦å°†æ­¤æ¶ˆæ¯è¿½åŠ åˆ°æŒ‡å®šä¸»é¢˜çš„æŸä¸ªåˆ†åŒºæ‰€å¯¹åº”çš„leaderå‰¯æœ¬ä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦çŸ¥é“ä¸»é¢˜çš„åˆ†åŒºæ•°é‡ï¼Œç„¶åç»è¿‡è®¡ç®—å¾—å‡ºï¼ˆæˆ–è€…ç›´æ¥æŒ‡å®šï¼‰ç›®æ ‡åˆ†åŒºï¼Œä¹‹åKafkaProduceréœ€è¦çŸ¥é“ç›®æ ‡åˆ†åŒºçš„leaderå‰¯æœ¬æ‰€åœ¨çš„broker èŠ‚ç‚¹çš„åœ°å€ã€ç«¯å£ç­‰ä¿¡æ¯æ‰èƒ½å»ºç«‹è¿æ¥ï¼Œæœ€ç»ˆæ‰èƒ½å°†æ¶ˆæ¯å‘é€åˆ° Kafkaï¼Œåœ¨è¿™ä¸€è¿‡ç¨‹ä¸­æ‰€éœ€è¦çš„ä¿¡æ¯éƒ½å±äºå…ƒæ•°æ®ä¿¡æ¯ã€‚ å…ƒæ•°æ®æ˜¯æŒ‡Kafkaé›†ç¾¤çš„å…ƒæ•°æ®ï¼Œè¿™äº›å…ƒæ•°æ®å…·ä½“è®°å½•äº†é›†ç¾¤ä¸­æœ‰å“ªäº›ä¸»é¢˜ï¼Œè¿™äº›ä¸»é¢˜æœ‰å“ªäº›åˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºçš„leaderå‰¯æœ¬åˆ†é…åœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šï¼Œfollowerå‰¯æœ¬åˆ†é…åœ¨å“ªäº›èŠ‚ç‚¹ä¸Šï¼Œå“ªäº›å‰¯æœ¬åœ¨ARã€ISRç­‰é›†åˆä¸­ï¼Œé›†ç¾¤ä¸­æœ‰å“ªäº›èŠ‚ç‚¹ï¼Œæ§åˆ¶å™¨èŠ‚ç‚¹åˆæ˜¯å“ªä¸€ä¸ªç­‰ä¿¡æ¯ã€‚ å½“å®¢æˆ·ç«¯ä¸­æ²¡æœ‰éœ€è¦ä½¿ç”¨çš„å…ƒæ•°æ®ä¿¡æ¯æ—¶ï¼Œæ¯”å¦‚æ²¡æœ‰æŒ‡å®šçš„ä¸»é¢˜ä¿¡æ¯ï¼Œæˆ–è€…è¶…è¿‡metadata.max.age.ms æ—¶é—´æ²¡æœ‰æ›´æ–°å…ƒæ•°æ®éƒ½ä¼šå¼•èµ·å…ƒæ•°æ®çš„æ›´æ–°æ“ä½œã€‚å®¢æˆ·ç«¯å‚æ•°metadata.max.age.msçš„é»˜è®¤å€¼ä¸º300000ï¼Œå³5åˆ†é’Ÿã€‚å…ƒæ•°æ®çš„æ›´æ–°æ“ä½œæ˜¯åœ¨å®¢æˆ·ç«¯å†…éƒ¨è¿›è¡Œçš„ï¼Œå¯¹å®¢æˆ·ç«¯çš„å¤–éƒ¨ä½¿ç”¨è€…ä¸å¯è§ã€‚å½“éœ€è¦æ›´æ–°å…ƒæ•°æ®æ—¶ï¼Œä¼šå…ˆæŒ‘é€‰å‡ºleastLoadedNodeï¼Œç„¶åå‘è¿™ä¸ªNodeå‘é€MetadataRequestè¯·æ±‚æ¥è·å–å…·ä½“çš„å…ƒæ•°æ®ä¿¡æ¯ã€‚è¿™ä¸ªæ›´æ–°æ“ä½œæ˜¯ç”±Senderçº¿ç¨‹å‘èµ·çš„ï¼Œåœ¨åˆ›å»ºå®ŒMetadataRequestä¹‹ååŒæ ·ä¼šå­˜å…¥InFlightRequestsï¼Œä¹‹åçš„æ­¥éª¤å°±å’Œå‘é€æ¶ˆæ¯æ—¶çš„ç±»ä¼¼ã€‚å…ƒæ•°æ®è™½ç„¶ç”±Senderçº¿ç¨‹è´Ÿè´£æ›´æ–°ï¼Œä½†æ˜¯ä¸»çº¿ç¨‹ä¹Ÿéœ€è¦è¯»å–è¿™äº›ä¿¡æ¯ï¼Œè¿™é‡Œçš„æ•°æ®åŒæ­¥é€šè¿‡synchronizedå’Œfinalå…³é”®å­—æ¥ä¿éšœã€‚","date":"2024-12-31","categories":["kafka"]},{"title":"linux-linuxmintç­‰ubuntuç³»ç»Ÿå…¨å±€å­—ä½“ä¸ç»Ÿä¸€ï¼Œæ¥·ä½“æ— æ³•æ›´æ¢é—®é¢˜","url":"/2024/12/31/linux-linuxmintç­‰ubuntuç³»ç»Ÿå…¨å±€å­—ä½“ä¸ç»Ÿä¸€-æ¥·ä½“æ— æ³•æ›´æ¢é—®é¢˜/","content":"linux mintç­‰ubuntuç³»ç»Ÿå…¨å±€å­—ä½“ä¸ç»Ÿä¸€ï¼Œæ¥·ä½“æ— æ³•æ›´æ¢é—®é¢˜æ­¤é¡µé¢æ˜¯å…³äºæ­¤æ¥·ä½“æ— æ³•æ›´æ¢é—®é¢˜çš„ï¼Œåº”è¯¥æ˜¯ç±»ä¹Œç­å›¾ç³»ç»Ÿéƒ½ä¼šé‡åˆ°çš„é—®é¢˜: https://bugs.launchpad.net/ubuntukylin/+bug/1227034 æ–°å®‰è£…çš„Linux mint å­—ä½“æ›´æ–°äº†ä»¥åï¼Œè®¾ç½®çš„å…¨å±€å­—ä½“ä¸ç»Ÿä¸€ï¼Œéƒ¨åˆ†å­—ä½“åå°ï¼Œéƒ¨åˆ†å­—ä½“ç”šè‡³æ˜¯æ¯”è¾ƒå°çš„æ¥·ä½“ï¼Œæ¨¡ç³Šä¸æ¸…ï¼Œååˆ†å½±å“è§‚æ„Ÿå’Œä½¿ç”¨ä½“éªŒã€‚ ç»ˆç«¯ä½¿ç”¨å‘½ä»¤fc-match â€˜sans-serifâ€™å’Œfc-match â€˜serifâ€™å’Œfc-match â€˜monospaceâ€™å‡è¾“å‡ºç±»ä¼¼äºukai.ttc: â€œAR PL UKai CNâ€ â€œBookâ€å¦‚æœåˆ é™¤äº†ukaiå³æ¥·ä½“åˆ™è¾“å‡ºuming.ttc: â€œAR PL UMing CNâ€ â€œLightâ€ã€‚ç§ç§è¿¹è±¡è¡¨é¢æ˜¯&#x2F;etc&#x2F;font&#x2F;conf.dä¸­çš„æŸæ–‡ä»¶æ”¹å†™é”™è¯¯é€ æˆ.æ–°å®‰è£…çš„linuxMintåº”è¯¥å‡ä¼šå‡ºç°è¿™æ ·çš„æ¥·ä½“é”™è¯¯ã€‚ ä¸€ä¸ªç®€å•çš„è§£å†³åŠæ³•æ˜¯ç»ˆç«¯è¾“å…¥å‘½ä»¤ï¼š å®‰è£…å®Œæˆåå­—ä½“ä¼šæ”¹å˜ä¸º å¦å¤–å»ºè®®æ–°å®‰è£…çš„Mint18å…¨ä¸­æ–‡ç³»ç»Ÿï¼Œä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ¯”å¦‚kateæ‰§è¡Œ æˆ–è€… ç¼–è¾‘å…¶ä¸­çš„ä¸€ä¸ªæ–‡ä»¶å³å¯ã€‚æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼Œä»¥é…ç½®æ›´å®Œå…¨è¯¦ç»†çš„ä¸­æ–‡æœ¬åœ°æ”¯æŒ. ç„¶åæ‰§è¡Œ sudo locale-gen","date":"2024-12-31","categories":["linux"]},{"title":"linux-shadowsockæ¢¯å­","url":"/2024/12/31/linux-shadowsockæ¢¯å­/","content":"ss-server -s 149.28.211.158 -p 11098 -k woaiwo1314ya.. -m aes-128-cfb -t 3000 ex","date":"2024-12-31","categories":["linux"]},{"title":"linux-ubuntuç¯å¢ƒä¸‹php+nginxé…ç½®è¸©å‘","url":"/2024/12/31/linux-ubuntuç¯å¢ƒä¸‹php-nginxé…ç½®è¸©å‘/","content":"nginxå®‰è£…æ–¹æ³•â€”è¿›å…¥å®˜ç½‘ æŸ¥çœ‹å®˜æ–¹æ•™ç¨‹å°±å¥½äº†http://nginx.org/en/linux_packages.html#stable phpå®‰è£… ä½¿ç”¨ppaæ–¹æ³•è¿›è¡Œç›¸å…³çš„å®‰è£… æ¥ä¸‹æ¥æŒ‰ç…§ç›¸å…³çš„è§„å®šè¿›è¡Œå®‰è£…å°±å¥½å“¦nginx é…ç½® æ‰“å¼€&#x2F;etc&#x2F;nginx&#x2F; ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶ä¿®æ”¹å¦‚ä¸‹ ä¿®æ”¹php-fpm ç›¸å…³é…ç½®å¦‚ä¸‹ æ·»åŠ å¦‚ä¸‹å­—æ®µ å¼€å¯phpè°ƒè¯•æ¨¡å¼ ä¿®æ”¹fpm cliç­‰php.iniä¸­çš„å¦‚ä¸‹å­—æ®µ","date":"2024-12-31","categories":["linux"]},{"title":"rocketmq-åŸç†è®°å½•-é€šä¿¡-æ¶ˆæ¯å‘é€-æ¶ˆæ¯æ¥æ”¶","url":"/2024/12/31/rocketmq-åŸç†è®°å½•-é€šä¿¡-æ¶ˆæ¯å‘é€-æ¶ˆæ¯æ¥æ”¶/","content":"ä¸€.rocketmqæ¨¡å—æ¶æ„ rocketMQä¸­çš„å‡ ä¸ªé‡è¦çš„è§’è‰² (1)NameServer:åœ¨MQé›†ç¾¤ä¸­åšçš„æ˜¯åšå‘½åæœåŠ¡ï¼Œæ›´æ–°å’Œè·¯ç”±å‘ç° brokeræœåŠ¡ï¼›(2)Broker-Master:broker æ¶ˆæ¯ä¸»æœºæœåŠ¡å™¨ï¼›(3)Broker-Slave:broker æ¶ˆæ¯ä»æœºæœåŠ¡å™¨ï¼›(4)Producer:æ¶ˆæ¯ç”Ÿäº§è€…ï¼›(5)Consumer:æ¶ˆæ¯æ¶ˆè´¹è€…ï¼› äºŒ. rocketmq é€šä¿¡çš„è¿‡ç¨‹å’Œæ–¹æ³•RocketMQé›†ç¾¤çš„ä¸€éƒ¨åˆ†é€šä¿¡å¦‚ä¸‹: (1)Brokerå¯åŠ¨åéœ€è¦å®Œæˆä¸€æ¬¡å°†è‡ªå·±æ³¨å†Œè‡³NameServerçš„æ“ä½œï¼›éšåæ¯éš”30sæ—¶é—´å®šæœŸå‘NameServerä¸ŠæŠ¥Topicè·¯ç”±ä¿¡æ¯ï¼› (2)æ¶ˆæ¯ç”Ÿäº§è€…Producerä½œä¸ºå®¢æˆ·ç«¯å‘é€æ¶ˆæ¯æ—¶å€™ï¼Œéœ€è¦æ ¹æ®Msgçš„Topicä»æœ¬åœ°ç¼“å­˜çš„TopicPublishInfoTableè·å–è·¯ç”±ä¿¡æ¯ã€‚å¦‚æœæ²¡æœ‰åˆ™æ›´æ–°è·¯ç”±ä¿¡æ¯ä¼šä»NameServerä¸Šé‡æ–°æ‹‰å–ï¼› (3)æ¶ˆæ¯ç”Ÿäº§è€…Produceræ ¹æ®(2)ä¸­è·å–çš„è·¯ç”±ä¿¡æ¯é€‰æ‹©ä¸€ä¸ªé˜Ÿåˆ—(MessageQueue)è¿›è¡Œæ¶ˆæ¯å‘é€ï¼›Brokerä½œä¸ºæ¶ˆæ¯çš„æ¥æ”¶è€…æ”¶æ¶ˆæ¯å¹¶è½ç›˜å­˜å‚¨ï¼› ä»ä¸Šé¢(1)~(3)ä¸­å¯ä»¥çœ‹å‡ºåœ¨æ¶ˆæ¯ç”Ÿäº§è€…, Brokerå’ŒNameServerä¹‹é—´éƒ½ä¼šå‘ç”Ÿé€šä¿¡(è¿™é‡Œåªè¯´äº†MQçš„éƒ¨åˆ†é€šä¿¡)ï¼Œå› æ­¤å¦‚ä½•è®¾è®¡ä¸€ä¸ªè‰¯å¥½çš„ç½‘ç»œé€šä¿¡æ¨¡å—åœ¨MQä¸­è‡³å…³é‡è¦ï¼Œå®ƒå°†å†³å®šRocketMQé›†ç¾¤æ•´ä½“çš„æ¶ˆæ¯ä¼ è¾“èƒ½åŠ›ä¸æœ€ç»ˆçš„æ€§èƒ½ã€‚ rocketmq-remoting æ¨¡å—æ˜¯ RocketMQæ¶ˆæ¯é˜Ÿåˆ—ä¸­è´Ÿè´£ç½‘ç»œé€šä¿¡çš„æ¨¡å—ï¼Œå®ƒå‡ ä¹è¢«å…¶ä»–æ‰€æœ‰éœ€è¦ç½‘ç»œé€šä¿¡çš„æ¨¡å—(è¯¸å¦‚rocketmq-clientã€rocketmq-serverã€rocketmq-namesrv)æ‰€ä¾èµ–å’Œå¼•ç”¨ã€‚ä¸ºäº†å®ç°å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´é«˜æ•ˆçš„æ•°æ®è¯·æ±‚ä¸æ¥æ”¶ï¼ŒRocketMQæ¶ˆæ¯é˜Ÿåˆ—è‡ªå®šä¹‰äº†é€šä¿¡åè®®å¹¶åœ¨Nettyçš„åŸºç¡€ä¹‹ä¸Šæ‰©å±•äº†é€šä¿¡æ¨¡å—ã€‚ ä¸‰. æ¶ˆæ¯çš„åè®®è®¾è®¡ä¸ç¼–ç è§£ç åœ¨Clientå’ŒServerä¹‹é—´å®Œæˆä¸€æ¬¡æ¶ˆæ¯å‘é€æ—¶ï¼Œéœ€è¦å¯¹å‘é€çš„æ¶ˆæ¯è¿›è¡Œä¸€ä¸ªåè®®çº¦å®šï¼Œå› æ­¤å°±æœ‰å¿…è¦è‡ªå®šä¹‰RocketMQçš„æ¶ˆæ¯åè®®ã€‚åŒæ—¶ï¼Œä¸ºäº†é«˜æ•ˆåœ°åœ¨ç½‘ç»œä¸­ä¼ è¾“æ¶ˆæ¯å’Œå¯¹æ”¶åˆ°çš„æ¶ˆæ¯è¯»å–ï¼Œå°±éœ€è¦å¯¹æ¶ˆæ¯è¿›è¡Œç¼–è§£ç ã€‚ åœ¨RocketMQä¸­ï¼ŒRemotingCommandè¿™ä¸ªç±»åœ¨æ¶ˆæ¯ä¼ è¾“è¿‡ç¨‹ä¸­å¯¹æ‰€æœ‰æ•°æ®å†…å®¹çš„å°è£…ï¼Œä¸ä½†åŒ…å«äº†æ‰€æœ‰çš„æ•°æ®ç»“æ„ï¼Œè¿˜åŒ…å«äº†ç¼–ç è§£ç æ“ä½œã€‚ RemotingCommandç±»çš„éƒ¨åˆ†æˆå‘˜å˜é‡å¦‚ä¸‹: Headerå­—æ®µ ç±»å‹ Requestè¯´æ˜ Responseè¯´æ˜ code int è¯·æ±‚æ“ä½œç ï¼Œåº”ç­”æ–¹æ ¹æ®ä¸åŒçš„è¯·æ±‚ç è¿›è¡Œä¸åŒçš„ä¸šåŠ¡å¤„ç† åº”ç­”å“åº”ç ã€‚0è¡¨ç¤ºæˆåŠŸï¼Œé0åˆ™è¡¨ç¤ºå„ç§é”™è¯¯ language LanguageCode è¯·æ±‚æ–¹å®ç°çš„è¯­è¨€ åº”ç­”æ–¹å®ç°çš„è¯­è¨€ version int è¯·æ±‚æ–¹ç¨‹åºçš„ç‰ˆæœ¬ åº”ç­”æ–¹ç¨‹åºçš„ç‰ˆæœ¬ opaque int ç›¸å½“äºreqeustIdï¼Œåœ¨åŒä¸€ä¸ªè¿æ¥ä¸Šçš„ä¸åŒè¯·æ±‚æ ‡è¯†ç ï¼Œä¸å“åº”æ¶ˆæ¯ä¸­çš„ç›¸å¯¹åº” åº”ç­”ä¸åšä¿®æ”¹ç›´æ¥è¿”å› flag int åŒºåˆ†æ˜¯æ™®é€šRPCè¿˜æ˜¯onewayRPCå¾—æ ‡å¿— åŒºåˆ†æ˜¯æ™®é€šRPCè¿˜æ˜¯onewayRPCå¾—æ ‡å¿— remark String ä¼ è¾“è‡ªå®šä¹‰æ–‡æœ¬ä¿¡æ¯ ä¼ è¾“è‡ªå®šä¹‰æ–‡æœ¬ä¿¡æ¯ extFields HashMap<String,String> è¯·æ±‚è‡ªå®šä¹‰æ‰©å±•ä¿¡æ¯ å“åº”è‡ªå®šä¹‰æ‰©å±•ä¿¡æ¯ è¿™é‡Œå±•ç¤ºä¸‹Brokerå‘NameServerå‘é€ä¸€æ¬¡å¿ƒè·³æ³¨å†Œçš„æŠ¥æ–‡: ä¸‹é¢æ¥çœ‹ä¸‹RocketMQé€šä¿¡åè®®çš„æ ¼å¼ å¯è§ä¼ è¾“å†…å®¹ä¸»è¦å¯ä»¥åˆ†ä¸ºä»¥ä¸‹4éƒ¨åˆ†: (1)æ¶ˆæ¯é•¿åº¦:æ€»é•¿åº¦ï¼Œå››ä¸ªå­—èŠ‚å­˜å‚¨ï¼Œå ç”¨ä¸€ä¸ªintç±»å‹ï¼› (2)åºåˆ—åŒ–ç±»å‹&æ¶ˆæ¯å¤´é•¿åº¦:åŒæ ·å ç”¨ä¸€ä¸ªintç±»å‹ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºåºåˆ—åŒ–ç±»å‹ï¼Œåé¢ä¸‰ä¸ªå­—èŠ‚è¡¨ç¤ºæ¶ˆæ¯å¤´é•¿åº¦ï¼› (3)æ¶ˆæ¯å¤´æ•°æ®:ç»è¿‡åºåˆ—åŒ–åçš„æ¶ˆæ¯å¤´æ•°æ®ï¼› (4)æ¶ˆæ¯ä¸»ä½“æ•°æ®:æ¶ˆæ¯ä¸»ä½“çš„äºŒè¿›åˆ¶å­—èŠ‚æ•°æ®å†…å®¹ï¼› æ¶ˆæ¯çš„ç¼–ç å’Œè§£ç åˆ†åˆ«åœ¨RemotingCommandç±»çš„encodeå’Œdecodeæ–¹æ³•ä¸­å®Œæˆ. å››. æ¶ˆæ¯é€šä¿¡æ–¹å¼å’Œé€šä¿¡æµç¨‹åœ¨RocketMQæ¶ˆæ¯é˜Ÿåˆ—ä¸­æ”¯æŒé€šä¿¡çš„æ–¹å¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§: (1)åŒæ­¥(sync) (2)å¼‚æ­¥(async) (3)å•å‘(oneway) å…¶ä¸­â€œåŒæ­¥â€é€šä¿¡æ¨¡å¼ç›¸å¯¹ç®€å•ï¼Œä¸€èˆ¬ç”¨åœ¨å‘é€å¿ƒè·³åŒ…åœºæ™¯ä¸‹ï¼Œæ— éœ€å…³æ³¨å…¶Responseã€‚æœ¬æ–‡å°†ä¸»è¦ä»‹ç»RocketMQçš„å¼‚æ­¥é€šä¿¡æµç¨‹(é™äºç¯‡å¹…ï¼Œè¯»è€…å¯ä»¥æŒ‰ç…§åŒæ ·çš„æ¨¡å¼è¿›è¡Œåˆ†æåŒæ­¥é€šä¿¡æµç¨‹) äº”. rocketMqæ¶ˆæ¯å‘é€ å¯¹äºä¸Šå›¾ä¸­å‡ ä¸ªè§’è‰²çš„è¯´æ˜: (1)NameServer:RocketMQé›†ç¾¤çš„å‘½åæœåŠ¡å™¨(ä¹Ÿå¯ä»¥è¯´æ˜¯æ³¨å†Œä¸­å¿ƒ)ï¼Œå®ƒæœ¬èº«æ˜¯æ— çŠ¶æ€çš„(å®é™…æƒ…å†µä¸‹å¯èƒ½å­˜åœ¨æ¯ä¸ªNameServerå®ä¾‹ä¸Šçš„æ•°æ®æœ‰çŸ­æš‚çš„ä¸ä¸€è‡´ç°è±¡ï¼Œä½†æ˜¯é€šè¿‡å®šæ—¶æ›´æ–°ï¼Œåœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯ä¸€è‡´çš„)ï¼Œç”¨äºç®¡ç†é›†ç¾¤çš„å…ƒæ•°æ®( ä¾‹å¦‚ï¼ŒKVé…ç½®ã€Topicã€Brokerçš„æ³¨å†Œä¿¡æ¯)ã€‚ (2)Broker(Master):RocketMQæ¶ˆæ¯ä»£ç†æœåŠ¡å™¨ä¸»èŠ‚ç‚¹ï¼Œèµ·åˆ°ä¸²è”Producerçš„æ¶ˆæ¯å‘é€å’ŒConsumerçš„æ¶ˆæ¯æ¶ˆè´¹ï¼Œå’Œå°†æ¶ˆæ¯çš„è½ç›˜å­˜å‚¨çš„ä½œç”¨ï¼› (3)Broker(Slave):RocketMQæ¶ˆæ¯ä»£ç†æœåŠ¡å™¨å¤‡ä»½èŠ‚ç‚¹ï¼Œä¸»è¦æ˜¯é€šè¿‡åŒæ­¥&#x2F;å¼‚æ­¥çš„æ–¹å¼å°†ä¸»èŠ‚ç‚¹çš„æ¶ˆæ¯åŒæ­¥è¿‡æ¥è¿›è¡Œå¤‡ä»½ï¼Œä¸ºRocketMQé›†ç¾¤çš„é«˜å¯ç”¨æ€§æä¾›ä¿éšœï¼› (4)Producer(æ¶ˆæ¯ç”Ÿäº§è€…):åœ¨è¿™é‡Œä¸ºæ™®é€šæ¶ˆæ¯çš„ç”Ÿäº§è€…ï¼Œä¸»è¦åŸºäºRocketMQ-Clientæ¨¡å—å°†æ¶ˆæ¯å‘é€è‡³RocketMQçš„ä¸»èŠ‚ç‚¹ã€‚ å¯¹äºä¸Šé¢å›¾ä¸­å‡ æ¡é€šä¿¡é“¾è·¯çš„å…³ç³»: (1)Producerä¸NamerServer:æ¯ä¸€ä¸ªProducerä¼šä¸NameServeré›†ç¾¤ä¸­çš„ä¸€ä¸ªå®ä¾‹å»ºç«‹TCPè¿æ¥ï¼Œä»è¿™ä¸ªNameServerå®ä¾‹ä¸Šæ‹‰å–Topicè·¯ç”±ä¿¡æ¯ï¼› (2)Producerå’ŒBroker:Producerä¼šå’Œå®ƒè¦å‘é€çš„topicç›¸å…³è”çš„Masterçš„Brokerä»£ç†æœåŠ¡å™¨å»ºç«‹TCPè¿æ¥ï¼Œç”¨äºå‘é€æ¶ˆæ¯ä»¥åŠå®šæ—¶çš„å¿ƒè·³ä¿¡æ¯ï¼› (3)Brokerå’ŒNamerServer:Broker(Master or Slave)å‡ä¼šå’Œæ¯ä¸€ä¸ªNameServerå®ä¾‹æ¥å»ºç«‹TCPè¿æ¥ã€‚Brokeråœ¨å¯åŠ¨çš„æ—¶å€™ä¼šæ³¨å†Œè‡ªå·±é…ç½®çš„Topicä¿¡æ¯åˆ°NameServeré›†ç¾¤çš„æ¯ä¸€å°æœºå™¨ä¸­ã€‚å³æ¯ä¸€ä¸ªNameServerå‡æœ‰è¯¥brokerçš„Topicè·¯ç”±é…ç½®ä¿¡æ¯ã€‚å…¶ä¸­ï¼ŒMasterä¸Masterä¹‹é—´æ— è¿æ¥ï¼ŒMasterä¸Slaveä¹‹é—´æœ‰è¿æ¥ï¼› å…­. rocketMQ æ¶ˆæ¯æ¶ˆè´¹MQä¸­Pullå’ŒPushçš„ä¸¤ç§æ¶ˆè´¹æ–¹å¼å¯¹äºä»»ä½•ä¸€æ¬¾æ¶ˆæ¯ä¸­é—´ä»¶è€Œè¨€ï¼Œæ¶ˆè´¹è€…å®¢æˆ·ç«¯ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ä»æ¶ˆæ¯ä¸­é—´ä»¶è·å–æ¶ˆæ¯å¹¶æ¶ˆè´¹ï¼šï¼ˆ1ï¼‰Pushæ–¹å¼ï¼šç”±æ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆMQæ¶ˆæ¯æœåŠ¡å™¨ä»£ç†ï¼‰ä¸»åŠ¨åœ°å°†æ¶ˆæ¯æ¨é€ç»™æ¶ˆè´¹è€…ï¼›é‡‡ç”¨Pushæ–¹å¼ï¼Œå¯ä»¥å°½å¯èƒ½å®æ—¶åœ°å°†æ¶ˆæ¯å‘é€ç»™æ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ã€‚ä½†æ˜¯ï¼Œåœ¨æ¶ˆè´¹è€…çš„å¤„ç†æ¶ˆæ¯çš„èƒ½åŠ›è¾ƒå¼±çš„æ—¶å€™(æ¯”å¦‚ï¼Œæ¶ˆè´¹è€…ç«¯çš„ä¸šåŠ¡ç³»ç»Ÿå¤„ç†ä¸€æ¡æ¶ˆæ¯çš„æµç¨‹æ¯”è¾ƒå¤æ‚ï¼Œå…¶ä¸­çš„è°ƒç”¨é“¾è·¯æ¯”è¾ƒå¤šå¯¼è‡´æ¶ˆè´¹æ—¶é—´æ¯”è¾ƒä¹…ã€‚æ¦‚æ‹¬èµ·æ¥åœ°è¯´å°±æ˜¯â€œæ…¢æ¶ˆè´¹é—®é¢˜â€)ï¼Œè€ŒMQä¸æ–­åœ°å‘æ¶ˆè´¹è€…Pushæ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ç«¯çš„ç¼“å†²åŒºå¯èƒ½ä¼šæº¢å‡ºï¼Œå¯¼è‡´å¼‚å¸¸ï¼›ï¼ˆ2ï¼‰Pullæ–¹å¼ï¼šç”±æ¶ˆè´¹è€…å®¢æˆ·ç«¯ä¸»åŠ¨å‘æ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆMQæ¶ˆæ¯æœåŠ¡å™¨ä»£ç†ï¼‰æ‹‰å–æ¶ˆæ¯ï¼›é‡‡ç”¨Pullæ–¹å¼ï¼Œå¦‚ä½•è®¾ç½®Pullæ¶ˆæ¯çš„é¢‘ç‡éœ€è¦é‡ç‚¹å»è€ƒè™‘ï¼Œä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼Œå¯èƒ½1åˆ†é’Ÿå†…è¿ç»­æ¥äº†1000æ¡æ¶ˆæ¯ï¼Œç„¶å2å°æ—¶å†…æ²¡æœ‰æ–°æ¶ˆæ¯äº§ç”Ÿï¼ˆæ¦‚æ‹¬èµ·æ¥è¯´å°±æ˜¯â€œæ¶ˆæ¯å»¶è¿Ÿä¸å¿™ç­‰å¾…â€ï¼‰ã€‚å¦‚æœæ¯æ¬¡Pullçš„æ—¶é—´é—´éš”æ¯”è¾ƒä¹…ï¼Œä¼šå¢åŠ æ¶ˆæ¯çš„å»¶è¿Ÿï¼Œå³æ¶ˆæ¯åˆ°è¾¾æ¶ˆè´¹è€…çš„æ—¶é—´åŠ é•¿ï¼ŒMQä¸­æ¶ˆæ¯çš„å †ç§¯é‡å˜å¤§ï¼›è‹¥æ¯æ¬¡Pullçš„æ—¶é—´é—´éš”è¾ƒçŸ­ï¼Œä½†æ˜¯åœ¨ä¸€æ®µæ—¶é—´å†…MQä¸­å¹¶æ²¡æœ‰ä»»ä½•æ¶ˆæ¯å¯ä»¥æ¶ˆè´¹ï¼Œé‚£ä¹ˆä¼šäº§ç”Ÿå¾ˆå¤šæ— æ•ˆçš„Pullè¯·æ±‚çš„RPCå¼€é”€ï¼Œå½±å“MQæ•´ä½“çš„ç½‘ç»œæ€§èƒ½ï¼›","date":"2024-12-31","categories":["mq"]},{"title":"rocketmqæ¶æ„è®¾è®¡","url":"/2024/12/31/rocketmqæ¶æ„è®¾è®¡/","content":"","date":"2024-12-31","categories":["mq"]},{"title":"mysql-jdbc-æ•°æ®åº“è¿æ¥æ± druidé…ç½®è¯¦è§£","url":"/2024/12/31/mysql-jdbc-æ•°æ®åº“è¿æ¥æ± druidé…ç½®è¯¦è§£/","content":"æ•°æ®åº“è¿æ¥æ± druidé…ç½®è¯¦è§£ druidçš„é…ç½®é¡¹è¯¦è§£ é…ç½® ç¼ºçœå€¼ è¯´æ˜ name æ—  é…ç½®è¿™ä¸ªå±æ€§çš„æ„ä¹‰åœ¨äºï¼Œå¦‚æœå­˜åœ¨å¤šä¸ªæ•°æ®æºï¼Œç›‘æ§çš„æ—¶å€™å¯ä»¥é€šè¿‡åå­—æ¥åŒºåˆ†å¼€æ¥ã€‚å¦‚æœæ²¡æœ‰é…ç½®ï¼Œå°†ä¼šç”Ÿæˆä¸€ä¸ªåå­—ï¼Œ æ ¼å¼æ˜¯ï¼šâ€DataSource-â€ + System.identityHashCode(this) dbcUrl æ—  è¿æ¥æ•°æ®åº“çš„urlï¼Œä¸åŒæ•°æ®åº“ä¸ä¸€æ ·ã€‚ä¾‹å¦‚ï¼šmysql : jdbc:mysql:&#x2F;&#x2F;10.20.153.104:3306&#x2F;druid2 oracle : jdbc:oracle:thin:@10.20.149.85:1521:ocnauto username æ—  è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·å password æ—  è¿æ¥æ•°æ®åº“çš„å¯†ç ã€‚å¦‚æœä½ ä¸å¸Œæœ›å¯†ç ç›´æ¥å†™åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ConfigFilterã€‚è¯¦ç»†çœ‹è¿™é‡Œhttps://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter driverClassName æ ¹æ®urlè‡ªåŠ¨è¯†åˆ« è¿™ä¸€é¡¹å¯é…å¯ä¸é…ï¼Œå¦‚æœä¸é…ç½®druidä¼šæ ¹æ®urlè‡ªåŠ¨è¯†åˆ«dbTypeï¼Œç„¶åé€‰æ‹©ç›¸åº”çš„driverClassName initialSize 0 åˆå§‹åŒ–æ—¶å»ºç«‹ç‰©ç†è¿æ¥çš„ä¸ªæ•°ã€‚åˆå§‹åŒ–å‘ç”Ÿåœ¨æ˜¾ç¤ºè°ƒç”¨initæ–¹æ³•ï¼Œæˆ–è€…ç¬¬ä¸€æ¬¡getConnectionæ—¶ maxActive 8 æœ€å¤§è¿æ¥æ± æ•°é‡ maxIdle 8 å·²ç»ä¸å†ä½¿ç”¨ï¼Œé…ç½®äº†ä¹Ÿæ²¡æ•ˆæœ minIdle æ—  æœ€å°è¿æ¥æ± æ•°é‡ maxWait æ—  è·å–è¿æ¥æ—¶æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œå•ä½æ¯«ç§’ã€‚é…ç½®äº†maxWaitä¹‹åï¼Œç¼ºçœå¯ç”¨å…¬å¹³é”,å¹¶å‘æ•ˆç‡ä¼šæœ‰æ‰€ä¸‹é™ï¼Œå¦‚æœéœ€è¦å¯ä»¥é€šè¿‡é…ç½®useUnfairLockå±æ€§ä¸ºtrueä½¿ç”¨éå…¬å¹³é”ã€‚ poolPreparedStatements false æ˜¯å¦ç¼“å­˜preparedStatementï¼Œä¹Ÿå°±æ˜¯PSCacheã€‚PSCacheå¯¹æ”¯æŒæ¸¸æ ‡çš„æ•°æ®åº“æ€§èƒ½æå‡å·¨å¤§ï¼Œæ¯”å¦‚è¯´oracleã€‚åœ¨mysql5.5ä»¥ä¸‹çš„ç‰ˆæœ¬ä¸­æ²¡æœ‰PSCacheåŠŸèƒ½ï¼Œå»ºè®®å…³é—­æ‰ã€‚ä½œè€…åœ¨5.5ç‰ˆæœ¬ä¸­ä½¿ç”¨PSCacheï¼Œé€šè¿‡ç›‘æ§ç•Œé¢å‘ç°PSCacheæœ‰ç¼“å­˜å‘½ä¸­ç‡è®°å½•ï¼Œè¯¥åº”è¯¥æ˜¯æ”¯æŒPSCacheã€‚ maxOpenPreparedStatements -1 è¦å¯ç”¨PSCacheï¼Œå¿…é¡»é…ç½®å¤§äº0ï¼Œå½“å¤§äº0æ—¶ï¼ŒpoolPreparedStatementsè‡ªåŠ¨è§¦å‘ä¿®æ”¹ä¸ºtrueã€‚åœ¨Druidä¸­ï¼Œä¸ä¼šå­˜åœ¨Oracleä¸‹PSCacheå ç”¨å†…å­˜è¿‡å¤šçš„é—®é¢˜ï¼Œ å¯ä»¥æŠŠè¿™ä¸ªæ•°å€¼é…ç½®å¤§ä¸€äº›ï¼Œæ¯”å¦‚è¯´100 validationQuery ç”¨æ¥æ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆçš„sqlï¼Œè¦æ±‚æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚ å¦‚æœvalidationQueryä¸ºnullï¼ŒtestOnBorrowtestOnReturnã€testWhileIdleéƒ½ä¸ä¼šå…¶ä½œç”¨ã€‚ testOnBorrow true ç”³è¯·è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½ã€‚ testOnReturn false å½’è¿˜è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½ testWhileIdle false å»ºè®®é…ç½®ä¸ºtrueï¼Œä¸å½±å“æ€§èƒ½ï¼Œå¹¶ä¸”ä¿è¯å®‰å…¨æ€§ã€‚ç”³è¯·è¿æ¥çš„æ—¶å€™æ£€æµ‹ï¼Œå¦‚æœç©ºé—²æ—¶é—´å¤§äºtimeBetweenEvictionRunsMillisï¼Œæ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆã€‚ timeBetweenEvictionRunsMillis æ—  æœ‰ä¸¤ä¸ªå«ä¹‰ï¼š 1) Destroyçº¿ç¨‹ä¼šæ£€æµ‹è¿æ¥çš„é—´éš”æ—¶é—´ 2) testWhileIdleçš„åˆ¤æ–­ä¾æ®ï¼Œè¯¦ç»†çœ‹testWhileIdleå±æ€§çš„è¯´æ˜ numTestsPerEvictionRun æ—  ä¸å†ä½¿ç”¨ï¼Œä¸€ä¸ªDruidDataSourceåªæ”¯æŒä¸€ä¸ªEvictionRun minEvictableIdleTimeMillis æ—  ä¸€ä¸ªè¿æ¥åœ¨æ± ä¸­æœ€å°çš„ç”Ÿå­˜æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ connectionInitSqls æ—  ç‰©ç†è¿æ¥åˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œçš„sql exceptionSorter æ ¹æ®dbTypeè‡ªåŠ¨è¯†åˆ« å½“æ•°æ®åº“æŠ›å‡ºä¸€äº›ä¸å¯æ¢å¤çš„å¼‚å¸¸æ—¶ï¼ŒæŠ›å¼ƒè¿æ¥ filters æ—  å±æ€§ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œé€šè¿‡åˆ«åçš„æ–¹å¼é…ç½®æ‰©å±•æ’ä»¶ï¼Œå¸¸ç”¨çš„æ’ä»¶æœ‰ï¼šç›‘æ§ç»Ÿè®¡ç”¨çš„filter:stat,æ—¥å¿—ç”¨çš„filter:log4j,é˜²å¾¡sqlæ³¨å…¥çš„filter:wall proxyFilters æ—  ç±»å‹æ˜¯List<com.alibaba.druid.filter.Filter>ï¼Œ å¦‚æœåŒæ—¶é…ç½®äº†filterså’ŒproxyFiltersï¼Œ æ˜¯ç»„åˆå…³ç³»ï¼Œå¹¶éæ›¿æ¢å…³ç³» é…ç½®ç¤ºä¾‹åœ¨springé…ç½®æ–‡ä»¶ä¸­åŠ å…¥å¦‚ä¸‹çš„é…ç½®ï¼Œè¿›è¡Œæ•°æ®åº“é“¾æ¥æ± çš„ä¿¡æ¯é…ç½® dbconfig.properties é…ç½®æ–‡ä»¶çš„é…ç½® web ç›‘æ§é¡µé¢æ§åˆ¶ï¼Œ å¯åŠ¨spring ä¹‹å å†è¿è¡Œ http://ip:port/projectName/druid/index.html.å³å¯è®¿é—®ç›‘æ§ä¿¡æ¯","date":"2024-12-31","categories":["mysql"]},{"title":"mysql-jdbc-é©±åŠ¨ä½¿ç”¨è¯¦è§£(1)åŸºæœ¬ä½¿ç”¨æ–¹æ³•","url":"/2024/12/31/mysql-jdbc-é©±åŠ¨ä½¿ç”¨è¯¦è§£-1-åŸºæœ¬ä½¿ç”¨æ–¹æ³•/","content":"java-jdbcé©±åŠ¨ä½¿ç”¨è¯¦è§£ï¼ˆä¸€ï¼‰åŸºæœ¬ä½¿ç”¨æ–¹æ³•å¤§å¤šæ•°æ—¶å€™æˆ‘éƒ½éƒ½æ˜¯ä½¿ç”¨mybatis æˆ–è€…æ•°æ®åº“é“¾æ¥æ± è¿™æ ·çš„æ¡†æ¶ï¼Œæ¸æ¸å¯¹åº•å±‚jdbcé©±åŠ¨ç¼ºå°‘ç ”ç©¶è¿™é‡Œä¸€ä¸‹æ•´ç† é©±åŠ¨é©±åŠ¨åŠ è½½ jvmåœ¨è¿è¡Œçš„æ—¶å€™ï¼Œå¿…é¡»æ‰‹åŠ¨åŠ è½½jdbcçš„é©±åŠ¨ç¨‹åºï¼Œå› ä¸ºjvmä¸ä¼šè‡ªåŠ¨å¯¼å…¥é©±åŠ¨ï¼Œå¯¼è‡´DriverManageræ— æ³•ä½¿ç”¨ Connection é“¾æ¥ å»ºç«‹å’Œæ•°æ®åº“çš„é“¾æ¥ï¼ˆjavaç¨‹åºä¸€èˆ¬ä½¿ç”¨æ•°æ®é“¾æ¥æ± ï¼Œè¿™é‡Œåªæ˜¯åšä¸€äº›åŸºæœ¬çš„ä»‹ç»ï¼‰ é“¾æ¥æ–¹æ³•ï¼šç›´æ¥è®¾ç½®æˆ–è€…ä½¿ç”¨Property åˆ›å»ºæ–¹æ³• é“¾æ¥æ§åˆ¶ é“¾æ¥çŠ¶æ€æ£€æµ‹ æ•°æ®åº“äº¤äº’ statementjdbcä¸­æœ‰ä¸‰ç§äº¤äº’æ–¹æ³• Statement ä½¿ç”¨é€šç”¨è®¿é—®æ•°æ®åº“ã€‚å½“åœ¨è¿è¡Œæ—¶ä½¿ç”¨é™æ€SQLè¯­å¥ã€‚ Statementæ¥å£ä¸èƒ½æ¥å—çš„å‚æ•°ã€‚ PreparedStatement å½“è®¡åˆ’å¤šæ¬¡ä½¿ç”¨SQLè¯­å¥ã€‚ é‚£ä¹ˆå¯ä»¥PreparedStatementæ¥å£æ¥æ”¶åœ¨è¿è¡Œæ—¶è¾“å…¥å‚æ•°ã€‚ CallableStatement å½“è¦è®¿é—®æ•°æ®åº“ä¸­çš„å­˜å‚¨è¿‡ç¨‹ä¸­ä½¿ç”¨ã€‚ CallableStatementå¯¹è±¡çš„æ¥å£è¿˜å¯ä»¥æ¥å—è¿è¡Œæ—¶è¾“å…¥å‚æ•° statementå¯¹è±¡ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨ï¼Œä¸€èˆ¬åšå¿ƒè·³æ£€æµ‹çš„æ—¶å€™ä½¿ç”¨ PreparedStatement â€” statementå‡çº§ç‰ˆå¯ä»¥ä½¿ç”¨å ä½ç¬¦ å’Œè¿›è¡Œæ‰¹å¤„ç†æ“ä½œ jdbcç»“æœé›†æ“ä½œ å£°æ˜ç»“æœé›†çš„ç±»å‹ åœ¨statementçš„ç”Ÿæˆæ–¹æ³•å¯ä»¥è¿›è¡Œå¾ˆå¤šçš„é…ç½®å‚æ•° Rstyoe RsConcurrencyéƒ½æ˜¯ResultSetä¸­æŒ‡å®šçš„ç±»å‹ ResultSetçš„ç±»å‹ RSType å¯èƒ½çš„RSTypeå¦‚ä¸‹ï¼Œå¦‚æœä¸æŒ‡å®šResultSetç±»å‹ï¼Œå°†è‡ªåŠ¨è·å¾—ä¸€ä¸ªæ˜¯TYPE_FORWARD_ONLYã€‚ Type æè¿°: ResultSet.TYPE_FORWARD_ONLY æ¸¸æ ‡åªèƒ½å‘å‰ç§»åŠ¨çš„ç»“æœé›†ã€‚ ResultSet.TYPE_SCROLL_INSENSITIVE æ¸¸æ ‡å¯ä»¥å‘å‰å’Œå‘åæ»šåŠ¨ï¼Œç»“æœé›†ä¸æ˜¯åˆ«äººå‘åˆ›å»ºç»“æœé›†åå‘ç”Ÿçš„æ•°æ®åº“æ›´æ”¹æ•æ„Ÿã€‚ ResultSet.TYPE_SCROLL_SENSITIVE. æ¸¸æ ‡å¯ä»¥å‘å‰å’Œå‘åæ»šåŠ¨ï¼Œç»“æœé›†æ˜¯åˆ«äººå‘åˆ›å»ºç»“æœé›†åå‘ç”Ÿçš„æ•°æ®åº“æ›´æ”¹æ•æ„Ÿã€‚ å¹¶å‘æ€§çš„ResultSe RSConcurrencyt å¯èƒ½çš„RSConcurrencyå¦‚ä¸‹ï¼Œå¦‚æœä¸æŒ‡å®šä»»ä½•å¹¶å‘ç±»å‹ï¼Œå°†è‡ªåŠ¨è·å¾—ä¸€ä¸ªä¸ºCONCUR_READ_ONLYã€‚ å¹¶å‘ æè¿°: ResultSet.CONCUR_READ_ONLY åˆ›å»ºç»“æœé›†åªè¯»ã€‚è¿™æ˜¯é»˜è®¤çš„ ResultSet.CONCUR_UPDATABLE åˆ›å»ºä¸€ä¸ªå¯æ›´æ–°çš„ç»“æœé›†ã€‚ ç»“æœé›†ç›¸å…³æ–¹æ³•: ä½¿ç”¨å¯æ»šåŠ¨ç»“æœé›†ç›¸å…³å±æ€§ éœ€è¦æŒ‡å®š Resultsetç›¸å…³é…ç½® å¹¶å‘æ€§ï¼ˆå¯ä¿®æ”¹ç»“æœé›†ç›¸å…³é…ç½®ï¼‰ ç»“æœé›†é€šç”¨æ–¹æ³•","date":"2024-12-31","categories":["mysql"]},{"title":"mysql-jdbc-é©±åŠ¨ä½¿ç”¨è¯¦è§£(2)æ‰¹å¤„ç†æ€§èƒ½ä¼˜åŒ–","url":"/2024/12/31/mysql-jdbc-é©±åŠ¨ä½¿ç”¨è¯¦è§£-2-æ‰¹å¤„ç†æ€§èƒ½ä¼˜åŒ–/","content":"java-jdbcé©±åŠ¨ä½¿ç”¨è¯¦è§£ï¼ˆäºŒï¼‰æ‰¹å¤„ç†æ€§èƒ½ä¼˜åŒ– åœ¨ä½¿ç”¨mysqlçš„æ—¶å€™æˆ–å¤šæˆ–å°‘ä¼šé‡è§å¤§é‡çš„æ‰¹æ“ä½œçš„æƒ…å†µè¿™é‡Œæ•´ç†ä¸€ä¸‹ç»éªŒ è¿™é‡Œæˆ‘ä»¬å¯¹ä¸‰ç§æƒ…å†µè¿›è¡Œæµ‹è¯• æ€§èƒ½ä¼˜åŒ–çš„æ–¹æ³•ï¼Œåœ¨urlè¯·æ±‚ä¸­åŠ ä¸Šè¿™äº›å‚æ•°ï¼ŒuseServerPrepStmts&#x3D;true&cachePrepStmts&#x3D;true&rewriteBatchedStatements&#x3D;true ç»„å· æ˜¯å¦å¼€èµ·æœåŠ¡ç«¯é¢„å¤„ç†å’Œé¢„å¤„ç†ç¼“å­˜ æ˜¯å¦ä½¿ç”¨äº‹åŠ¡æäº¤æ–¹æ³• æ˜¯å¦ä½¿ç”¨æ‰¹å¤„ç†æ–¹æ³• 1wï¼ˆæ¯«ç§’ï¼‰ 100wï¼ˆæ¯«ç§’ï¼‰ ç¬¬ä¸€ç»„ N N N æ·»åŠ  : 39619ï¼Œä¿®æ”¹ : 41440ï¼Œåˆ é™¤ : 39734 å¤§äºä¸€å°æ—¶ ç¬¬äºŒç»„ Y N N æ·»åŠ  : 38741ï¼Œä¿®æ”¹ : 41146ï¼Œåˆ é™¤ : 39538 å¤§äºä¸€å°æ—¶ ç¬¬ä¸‰ç»„ N Y N æ·»åŠ  : 1145ï¼Œä¿®æ”¹ : 1321ï¼Œåˆ é™¤ : 926 æ·»åŠ  : 80560ï¼Œä¿®æ”¹ : 122566ï¼Œåˆ é™¤ : 92001 ç¬¬å››ç»„ Y Y N æ·»åŠ  : 674ï¼Œä¿®æ”¹ : 1114ï¼Œåˆ é™¤ : 859 æ·»åŠ  : 76134ï¼Œä¿®æ”¹ : 116780ï¼Œåˆ é™¤ : 88954 ç¬¬äº”ç»„ N N Y æ·»åŠ  : 72ï¼Œä¿®æ”¹ : 38930ï¼Œåˆ é™¤ : 37931 å¤§äºä¸€å°æ—¶ ç¬¬å…­ç»„ Y N Y æ·»åŠ  : 112ï¼Œä¿®æ”¹ : 38409ï¼Œåˆ é™¤ : 37677 å¤§äºä¸€å°æ—¶ ç¬¬ä¸ƒç»„ N Y Y æ·»åŠ  : 54ï¼Œä¿®æ”¹ : 770ï¼Œåˆ é™¤ : 510 æ·»åŠ  : 8925ï¼Œä¿®æ”¹ : 79631ï¼Œåˆ é™¤ : 46655 ç¬¬å…«ç»„ Y Y Y æ·»åŠ  : 88ï¼Œä¿®æ”¹ : 729ï¼Œåˆ é™¤ : 444 æ·»åŠ  : 9401ï¼Œä¿®æ”¹ : 78899ï¼Œåˆ é™¤ : 47316 æµ‹è¯•ä»£ç ","date":"2024-12-31","categories":["mysql"]},{"title":"mysql-jdbc-é©±åŠ¨ä½¿ç”¨è¯¦è§£(3)å•æœºåˆ†åº“åˆ†è¡¨ä¸‹çš„æ€§èƒ½æµ‹è¯•","url":"/2024/12/31/mysql-jdbc-é©±åŠ¨ä½¿ç”¨è¯¦è§£-3-å•æœºåˆ†åº“åˆ†è¡¨ä¸‹çš„æ€§èƒ½æµ‹è¯•/","content":"java-jdbcé©±åŠ¨ä½¿ç”¨è¯¦è§£ï¼ˆä¸‰ï¼‰å•æœºåˆ†åº“åˆ†è¡¨ä¸‹çš„æ€§èƒ½æµ‹è¯•ä¸Šä¸€ç¯‡è¿›è¡Œè¿‡æµ‹è¯•ï¼Œæ‰¹å¤„ç†å’Œäº‹åŠ¡æäº¤ç»“åˆï¼Œå¯ä»¥æ˜¾è‘—çš„æå‡æ•°æ®åº“å¢åˆ æ”¹æ“ä½œçš„æ€§èƒ½ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜â€”â€”åœ¨å¤šè¡¨å’Œå¤šæ•°æ®åº“æƒ…å†µä¸‹ä½¿ç”¨å¤šçº¿ç¨‹ç¼–ç¨‹æ€§èƒ½ä¼šæå‡å¤šå°‘ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è¿›è¡Œäº†å¦‚ä¸‹çš„æµ‹è¯• æµ‹è¯•ä»£ç  æµ‹è¯•æ ·ä¾‹å’Œç»“æœ ç»„å· æ˜¯å¦æ˜¯åŒä¸€ä¸ªæ•°æ®åº“ æ˜¯å¦ä½¿ç”¨å¤šä¸ªé“¾æ¥ æ˜¯å¦ä½¿ç”¨æ‰¹å¤„ç†æ–¹æ³• 1wï¼ˆæ¯«ç§’ï¼‰ 100wï¼ˆæ¯«ç§’ï¼‰ ç¬¬ä¸€ç»„ Y N N æ·»åŠ  :42306ï¼Œä¿®æ”¹ :43521ï¼Œåˆ é™¤ :44073 å¤§äºä¸€å°æ—¶ ç¬¬äºŒç»„ N Y N æ·»åŠ  : 34137ï¼Œä¿®æ”¹ : 34215ï¼Œåˆ é™¤ : 33698 å¤§äºä¸€å°æ—¶ ç¬¬ä¸‰ç»„ Y Y N æ·»åŠ  : 34511ï¼Œä¿®æ”¹ : 34060ï¼Œåˆ é™¤ : 33970 å¤§äºä¸€å°æ—¶ ç¬¬å››ç»„ Y N Y æ·»åŠ  : 81ï¼Œä¿®æ”¹ : 724ï¼Œåˆ é™¤ : 454 æ·»åŠ  : 9504ï¼Œä¿®æ”¹ : 78451ï¼Œåˆ é™¤ : 46229 ç¬¬äº”ç»„ N Y Y æ·»åŠ  : 70ï¼Œä¿®æ”¹ : 424ï¼Œåˆ é™¤ : 276 æ·»åŠ  : 8953ï¼Œä¿®æ”¹ : 69865ï¼Œåˆ é™¤ : 40738 ç¬¬å…­ç»„ Y Y Y æ·»åŠ  :200ï¼Œä¿®æ”¹ : 595ï¼Œåˆ é™¤ : 289 æ·»åŠ  : 6119ï¼Œä¿®æ”¹ : 78899ï¼Œåˆ é™¤ : 47316 æ€»ç»“ï¼ˆç»“åˆä¸“é¢˜äºŒå’Œä¸“é¢˜ä¸‰ï¼‰å•åº“å¤šé“¾æ¥åœ¨å¤§æ•°æ®é‡ï¼ˆ100wï¼‰ä¸‹æ€§èƒ½ä¼˜åŠ¿æ˜æ˜¾ï¼Œä½†æ˜¯å¤šåº“åˆ†è¡¨åœ¨æ–°èƒ½åŒºé—´ä¸Šæ›´ä¼˜ï¼Œåˆ†è¡¨ç›¸æ¯”æ•™ä¸åˆ†è¡¨æ€§èƒ½æ›´å¥½","date":"2024-12-31","categories":["mysql"]},{"title":"mysql-jdbc-é©±åŠ¨ä½¿ç”¨è¯¦è§£(4)æµå¼è¯»å–","url":"/2024/12/31/mysql-jdbc-é©±åŠ¨ä½¿ç”¨è¯¦è§£-4-æµå¼è¯»å–/","content":"java-jdbcé©±åŠ¨ä½¿ç”¨è¯¦è§£ï¼ˆå››ï¼‰æµå¼è¯»å–mysqlé©±åŠ¨é»˜è®¤çš„è¡Œä¸ºæ˜¯éœ€è¦æŠŠæ•´ä¸ªç»“æœå…¨éƒ¨è¯»å–åˆ°å†…å­˜ä¸­æ‰å¼€å§‹å…è®¸åº”ç”¨è¯»å–ç»“æœï¼Œæ‰§è¡ŒResultSetçš„nextæ–¹æ³•æ˜¯é˜»å¡çš„ï¼ŒæœŸæœ›çš„æ–¹å¼æ˜¯æœ‰æ•°æ®å°±è®©äººä»–è¿”å›ï¼Œæ‰€ä»¥è¿™é‡Œå¼€å‘mysqlçš„æµå¼è¯»å– mysqlåˆ¤æ–­æ˜¯å¦å¼€å¯æµå¼è¯»å–ç»“æœçš„æ–¹æ³•ï¼Œæœ‰ä¸‰ä¸ªæ¡ä»¶forward-onlyï¼Œread-onlyï¼Œfatch sizeæ˜¯Integer.MIN_VALUE","date":"2024-12-31","categories":["mysql"]},{"title":"mysql-ä¿®æ”¹ç”¨æˆ·å¯†ç ","url":"/2024/12/31/mysql-ä¿®æ”¹ç”¨æˆ·å¯†ç /","content":"mysqlä¿®æ”¹ç”¨æˆ·å¯†ç  æ³¨æ„æœ‰çš„æ—¶å€™è¿˜æ˜¯æ— æ³•ä½¿ç”¨å¯†ç ç™»å…¥mysqlæ“ä½œç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªæ—¶å€™è¿˜éœ€è¦å¤„ç†userä¸­çš„pluginå‚æ•°ï¼Œè®©è¿™ä¸ªå‚æ•°å˜æˆmysql_native_password mysql 8.0 ä½¿ç”¨alter user â€˜rootâ€˜@â€™localhostâ€™ identified by â€˜è®¾ç½®çš„æ–°å¯†ç â€™ ä¿®æ”¹å¯†ç  ç”Ÿæ•ˆå’Œåˆ·æ–°","date":"2024-12-31","categories":["mysql"]},{"title":"mysql-æ•°æ®åº“åˆ›å»ºæ–°çš„ç”¨æˆ·","url":"/2024/12/31/mysql-æ•°æ®åº“åˆ›å»ºæ–°çš„ç”¨æˆ·/","content":"åˆ›å»ºç”¨æˆ·:å‘½ä»¤: è¯´æ˜:username - ä½ å°†åˆ›å»ºçš„ç”¨æˆ·å, host - æŒ‡å®šè¯¥ç”¨æˆ·åœ¨å“ªä¸ªä¸»æœºä¸Šå¯ä»¥ç™»é™†,å¦‚æœæ˜¯æœ¬åœ°ç”¨æˆ·å¯ç”¨localhost, å¦‚æœæƒ³è®©è¯¥ç”¨æˆ·å¯ä»¥ä»ä»»æ„è¿œç¨‹ä¸»æœºç™»é™†,å¯ä»¥ä½¿ç”¨é€šé…ç¬¦%. password - è¯¥ç”¨æˆ·çš„ç™»é™†å¯†ç ,å¯†ç å¯ä»¥ä¸ºç©º,å¦‚æœä¸ºç©ºåˆ™è¯¥ç”¨æˆ·å¯ä»¥ä¸éœ€è¦å¯†ç ç™»é™†æœåŠ¡å™¨. ä¾‹å­: æˆæƒ:å‘½ä»¤: è¯´æ˜: privileges - ç”¨æˆ·çš„æ“ä½œæƒé™,å¦‚SELECT , INSERT , UPDATE ç­‰(è¯¦ç»†åˆ—è¡¨è§è¯¥æ–‡æœ€åé¢).å¦‚æœè¦æˆäºˆæ‰€çš„æƒé™åˆ™ä½¿ç”¨ALL.;databasename - æ•°æ®åº“å,tablename-è¡¨å,å¦‚æœè¦æˆäºˆè¯¥ç”¨æˆ·å¯¹æ‰€æœ‰æ•°æ®åº“å’Œè¡¨çš„ç›¸åº”æ“ä½œæƒé™åˆ™å¯ç”¨è¡¨ç¤º, å¦‚.*. ä¾‹å­: æ³¨æ„:ç”¨ä»¥ä¸Šå‘½ä»¤æˆæƒçš„ç”¨æˆ·ä¸èƒ½ç»™å…¶å®ƒç”¨æˆ·æˆæƒ,å¦‚æœæƒ³è®©è¯¥ç”¨æˆ·å¯ä»¥æˆæƒ,ç”¨ä»¥ä¸‹å‘½ä»¤: æƒé™ä¿¡æ¯ç”¨userã€dbã€hostã€tables_privå’Œcolumns_privè¡¨è¢«å­˜å‚¨åœ¨MySQLæ•°æ®åº“ä¸­(å³åœ¨åä¸ºmysqlçš„æ•°æ®åº“ä¸­)ã€‚ æƒé™ åˆ— Context select Select_priv è¡¨ insert Insert_priv è¡¨ update Update_priv è¡¨ delete Delete_priv è¡¨ index Index_priv è¡¨ alter Alter_priv è¡¨ create Create_priv æ•°æ®åº“ã€è¡¨æˆ–ç´¢å¼• drop Drop_priv æ•°æ®åº“æˆ–è¡¨ grant Grant_priv æ•°æ®åº“æˆ–è¡¨ references References_priv æ•°æ®åº“æˆ–è¡¨ reload Reload_priv æœåŠ¡å™¨ç®¡ç†\\ shutdown Shutdown_priv æœåŠ¡å™¨ç®¡ç† process Process_priv æœåŠ¡å™¨ç®¡ç† file File_priv åœ¨æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å­˜å– è®¾ç½®ä¸æ›´æ”¹ç”¨æˆ·å¯†ç å‘½ä»¤: ä¾‹å­: æ’¤é”€ç”¨æˆ·æƒé™å‘½ä»¤: è¯´æ˜: privilege, databasename, tablename - åŒæˆæƒéƒ¨åˆ†.ä¾‹å­: REVOKE SELECT ON . FROM â€˜pigâ€˜@â€™%â€™;æ³¨æ„: å‡å¦‚ä½ åœ¨ç»™ç”¨æˆ·â€˜pigâ€˜@â€™%â€™æˆæƒçš„æ—¶å€™æ˜¯è¿™æ ·çš„(æˆ–ç±»ä¼¼çš„):GRANT SELECT ON test.user TO â€˜pigâ€˜@â€™%â€™, åˆ™åœ¨ä½¿ç”¨REVOKE SELECT ON . FROM â€˜pigâ€˜@â€™%â€™;å‘½ä»¤å¹¶ä¸èƒ½æ’¤é”€è¯¥ç”¨æˆ·å¯¹testæ•°æ®åº“ä¸­userè¡¨çš„SELECT æ“ä½œ.ç›¸å,å¦‚æœæˆæƒä½¿ç”¨çš„æ˜¯GRANT SELECT ON . TO â€˜pigâ€˜@â€™%â€™;åˆ™REVOKE SELECT ON test.user FROM â€˜pigâ€˜@â€™%â€™;å‘½ä»¤ä¹Ÿä¸èƒ½æ’¤é”€è¯¥ç”¨æˆ·å¯¹testæ•°æ®åº“ä¸­userè¡¨çš„Select æƒé™. å…·ä½“ä¿¡æ¯å¯ä»¥ç”¨å‘½ä»¤SHOW GRANTS FOR â€˜pigâ€˜@â€™%â€™; æŸ¥çœ‹. åˆ é™¤ç”¨æˆ·å‘½ä»¤: æŸ¥çœ‹ç”¨æˆ·çš„æˆæƒ ä»¥ä¸Šæ‰€è¿°æ˜¯å°ç¼–ç»™å¤§å®¶ä»‹ç»çš„mysql5.7åˆ›å»ºç”¨æˆ·æˆæƒåˆ é™¤ç”¨æˆ·æ’¤é”€æˆæƒï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ï¼Œå¦‚æœå¤§å®¶æœ‰ä»»ä½•ç–‘é—®è¯·ç»™æˆ‘ç•™è¨€ï¼Œå°ç¼–ä¼šåŠæ—¶å›å¤å¤§å®¶çš„ã€‚åœ¨æ­¤ä¹Ÿéå¸¸æ„Ÿè°¢å¤§å®¶å¯¹è„šæœ¬ä¹‹å®¶ç½‘ç«™çš„æ”¯æŒï¼","date":"2024-12-31","categories":["mysql"]},{"title":"mysql-æ•°æ®åº“å¸¸è§é—®é¢˜æ€»ç»“","url":"/2024/12/31/mysql-æ•°æ®åº“å¸¸è§é—®é¢˜æ€»ç»“/","content":"mysqlæ•°æ®åº“å¸¸è§é—®é¢˜æ€»ç»“ä¸»é”® è¶…é”® å€™é€‰é”® å¤–é”® ä¸» é”®ï¼šæ•°æ®åº“è¡¨ä¸­å¯¹å‚¨å­˜æ•°æ®å¯¹è±¡äºˆä»¥å”¯ä¸€å’Œå®Œæ•´æ ‡è¯†çš„æ•°æ®åˆ—æˆ–å±æ€§çš„ç»„åˆã€‚ä¸€ä¸ªæ•°æ®åˆ—åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ï¼Œä¸”ä¸»é”®çš„å–å€¼ä¸èƒ½ç¼ºå¤±ï¼Œå³ä¸èƒ½ä¸ºç©ºå€¼ï¼ˆNullï¼‰ã€‚ è¶… é”®ï¼šåœ¨å…³ç³»ä¸­èƒ½å”¯ä¸€æ ‡è¯†å…ƒç»„çš„å±æ€§é›†ç§°ä¸ºå…³ç³»æ¨¡å¼çš„è¶…é”®ã€‚ä¸€ä¸ªå±æ€§å¯ä»¥ä¸ºä½œä¸ºä¸€ä¸ªè¶…é”®ï¼Œå¤šä¸ªå±æ€§ç»„åˆåœ¨ä¸€èµ·ä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªè¶…é”®ã€‚è¶…é”®åŒ…å«å€™é€‰é”®å’Œä¸»é”®ã€‚ å€™é€‰é”®ï¼šæ˜¯æœ€å°è¶…é”®ï¼Œå³æ²¡æœ‰å†—ä½™å…ƒç´ çš„è¶…é”®ã€‚ å¤– é”®ï¼šåœ¨ä¸€ä¸ªè¡¨ä¸­å­˜åœ¨çš„å¦ä¸€ä¸ªè¡¨çš„ä¸»é”®ç§°æ­¤è¡¨çš„å¤–é”®ã€‚ æ•°æ®åº“äº‹åŠ¡çš„å››ä¸ªç‰¹æ€§åŠå«ä¹‰æ•°æ®åº“äº‹åŠ¡transanctionæ­£ç¡®æ‰§è¡Œçš„å››ä¸ªåŸºæœ¬è¦ç´ ã€‚ACID,åŸå­æ€§(Atomicity)ã€ä¸€è‡´æ€§(Correspondence)ã€éš”ç¦»æ€§(Isolation)ã€æŒä¹…æ€§(Durability)ã€‚ åŸå­æ€§:æ•´ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸å®Œæˆï¼Œä¸å¯èƒ½åœæ»åœ¨ä¸­é—´æŸä¸ªç¯èŠ‚ã€‚äº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œä¼šè¢«å›æ»šï¼ˆRollbackï¼‰åˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ï¼Œå°±åƒè¿™ä¸ªäº‹åŠ¡ä»æ¥æ²¡æœ‰æ‰§è¡Œè¿‡ä¸€æ ·ã€‚ ä¸€è‡´æ€§:åœ¨äº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œäº‹åŠ¡ç»“æŸä»¥åï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§çº¦æŸæ²¡æœ‰è¢«ç ´åã€‚ éš”ç¦»æ€§:éš”ç¦»çŠ¶æ€æ‰§è¡Œäº‹åŠ¡ï¼Œä½¿å®ƒä»¬å¥½åƒæ˜¯ç³»ç»Ÿåœ¨ç»™å®šæ—¶é—´å†…æ‰§è¡Œçš„å”¯ä¸€æ“ä½œã€‚å¦‚æœæœ‰ä¸¤ä¸ªäº‹åŠ¡ï¼Œè¿è¡Œåœ¨ç›¸åŒçš„æ—¶é—´å†…ï¼Œæ‰§è¡Œ ç›¸åŒçš„åŠŸèƒ½ï¼Œäº‹åŠ¡çš„éš”ç¦»æ€§å°†ç¡®ä¿æ¯ä¸€äº‹åŠ¡åœ¨ç³»ç»Ÿä¸­è®¤ä¸ºåªæœ‰è¯¥äº‹åŠ¡åœ¨ä½¿ç”¨ç³»ç»Ÿã€‚è¿™ç§å±æ€§æœ‰æ—¶ç§°ä¸ºä¸²è¡ŒåŒ–ï¼Œä¸ºäº†é˜²æ­¢äº‹åŠ¡æ“ä½œé—´çš„æ··æ·†ï¼Œå¿…é¡»ä¸²è¡ŒåŒ–æˆ–åºåˆ—åŒ–è¯· æ±‚ï¼Œä½¿å¾—åœ¨åŒä¸€æ—¶é—´ä»…æœ‰ä¸€ä¸ªè¯·æ±‚ç”¨äºåŒä¸€æ•°æ®ã€‚ æŒä¹…æ€§:åœ¨äº‹åŠ¡å®Œæˆä»¥åï¼Œè¯¥äº‹åŠ¡æ‰€å¯¹æ•°æ®åº“æ‰€ä½œçš„æ›´æ”¹ä¾¿æŒä¹…çš„ä¿å­˜åœ¨æ•°æ®åº“ä¹‹ä¸­ï¼Œå¹¶ä¸ä¼šè¢«å›æ»šã€‚ è§†å›¾çš„ä½œç”¨ï¼Œè§†å›¾å¯ä»¥æ›´æ”¹ä¹ˆï¼Ÿè§†å›¾æ˜¯è™šæ‹Ÿçš„è¡¨ï¼Œä¸åŒ…å«æ•°æ®çš„è¡¨ä¸ä¸€æ ·ï¼Œè§†å›¾åªåŒ…å«ä½¿ç”¨æ—¶åŠ¨æ€æ£€ç´¢æ•°æ®çš„æŸ¥è¯¢ï¼›ä¸åŒ…å«ä»»ä½•åˆ—æˆ–æ•°æ®ã€‚ä½¿ç”¨è§†å›¾å¯ä»¥ç®€åŒ–å¤æ‚çš„sqlæ“ä½œï¼Œéšè—å…·ä½“çš„ç»†èŠ‚ï¼Œä¿æŠ¤æ•°æ®ï¼›è§†å›¾åˆ›å»ºåï¼Œå¯ä»¥ä½¿ç”¨ä¸è¡¨ç›¸åŒçš„æ–¹å¼åˆ©ç”¨å®ƒä»¬ã€‚ è§†å›¾ä¸èƒ½è¢«ç´¢å¼•ï¼Œä¹Ÿä¸èƒ½æœ‰å…³è”çš„è§¦å‘å™¨æˆ–é»˜è®¤å€¼ï¼Œå¦‚æœè§†å›¾æœ¬èº«å†…æœ‰order by åˆ™å¯¹è§†å›¾å†æ¬¡order byå°†è¢«è¦†ç›–ã€‚ åˆ›å»ºè§†å›¾ sql è¯­å¥ å¯¹äºæŸäº›è§†å›¾æ¯”å¦‚æœªä½¿ç”¨è”ç»“å­æŸ¥è¯¢åˆ†ç»„èšé›†å‡½æ•°Distinct Unionç­‰ï¼Œæ˜¯å¯ä»¥å¯¹å…¶æ›´æ–°çš„ï¼Œå¯¹è§†å›¾çš„æ›´æ–°å°†å¯¹åŸºè¡¨è¿›è¡Œæ›´æ–°ï¼›ä½†æ˜¯è§†å›¾ä¸»è¦ç”¨äºç®€åŒ–æ£€ç´¢ï¼Œä¿æŠ¤æ•°æ®ï¼Œå¹¶ä¸ç”¨äºæ›´æ–°ï¼Œè€Œä¸”å¤§éƒ¨åˆ†è§†å›¾éƒ½ä¸å¯ä»¥æ›´æ–°ã€‚ ç´¢å¼•çš„å·¥ä½œåŸç†åŠå…¶ç§ç±»æ•°æ®åº“ç´¢å¼•ï¼Œæ˜¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸­ä¸€ä¸ªæ’åºçš„æ•°æ®ç»“æ„ï¼Œä»¥ååŠ©å¿«é€ŸæŸ¥è¯¢ã€æ›´æ–°æ•°æ®åº“è¡¨ä¸­æ•°æ®ã€‚ç´¢å¼•çš„å®ç°é€šå¸¸ä½¿ç”¨Bæ ‘åŠå…¶å˜ç§B+æ ‘ã€‚åœ¨æ•°æ®ä¹‹å¤–ï¼Œæ•°æ®åº“ç³»ç»Ÿè¿˜ç»´æŠ¤ç€æ»¡è¶³ç‰¹å®šæŸ¥æ‰¾ç®—æ³•çš„æ•°æ®ç»“æ„ï¼Œè¿™äº›æ•°æ®ç»“æ„ä»¥æŸç§æ–¹å¼å¼•ç”¨ï¼ˆæŒ‡å‘ï¼‰æ•°æ®ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿™äº›æ•°æ®ç»“æ„ä¸Šå®ç°é«˜çº§æŸ¥æ‰¾ç®—æ³•ã€‚è¿™ç§æ•°æ®ç»“æ„ï¼Œå°±æ˜¯ç´¢å¼•ã€‚ä¸ºè¡¨è®¾ç½®ç´¢å¼•è¦ä»˜å‡ºä»£ä»·çš„ï¼šä¸€æ˜¯å¢åŠ äº†æ•°æ®åº“çš„å­˜å‚¨ç©ºé—´ï¼ŒäºŒæ˜¯åœ¨æ’å…¥å’Œä¿®æ”¹æ•°æ®æ—¶è¦èŠ±è´¹è¾ƒå¤šçš„æ—¶é—´(å› ä¸ºç´¢å¼•ä¹Ÿè¦éšä¹‹å˜åŠ¨)ã€‚ å›¾å±•ç¤ºäº†ä¸€ç§å¯èƒ½çš„ç´¢å¼•æ–¹å¼ã€‚å·¦è¾¹æ˜¯æ•°æ®è¡¨ï¼Œä¸€å…±æœ‰ä¸¤åˆ—ä¸ƒæ¡è®°å½•ï¼Œæœ€å·¦è¾¹çš„æ˜¯æ•°æ®è®°å½•çš„ç‰©ç†åœ°å€ï¼ˆæ³¨æ„é€»è¾‘ä¸Šç›¸é‚»çš„è®°å½•åœ¨ç£ç›˜ä¸Šä¹Ÿå¹¶ä¸æ˜¯ä¸€å®šç‰©ç†ç›¸é‚»çš„ï¼‰ã€‚ä¸ºäº†åŠ å¿«Col2çš„æŸ¥æ‰¾ï¼Œå¯ä»¥ç»´æŠ¤ä¸€ä¸ªå³è¾¹æ‰€ç¤ºçš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹åˆ†åˆ«åŒ…å«ç´¢å¼•é”®å€¼å’Œä¸€ä¸ªæŒ‡å‘å¯¹åº”æ•°æ®è®°å½•ç‰©ç†åœ°å€çš„æŒ‡é’ˆï¼Œè¿™æ ·å°±å¯ä»¥è¿ç”¨äºŒå‰æŸ¥æ‰¾åœ¨O(log2n)çš„å¤æ‚åº¦å†…è·å–åˆ°ç›¸åº”æ•°æ®ã€‚ ç´¢å¼•çš„ä¼˜åŠ¿ã€åŠ£åŠ¿ã€å’Œæœ€ä½³åº”ç”¨åœºæ™¯ ç´¢å¼•æ˜¯å»ºç«‹åœ¨æ•°æ®åº“è¡¨ä¸­çš„æŸäº›åˆ—çš„ä¸Šé¢ã€‚åœ¨åˆ›å»ºç´¢å¼•çš„æ—¶å€™ï¼Œåº”è¯¥è€ƒè™‘åœ¨å“ªäº›åˆ—ä¸Šå¯ä»¥åˆ›å»ºç´¢å¼•ï¼Œåœ¨å“ªäº›åˆ—ä¸Šä¸èƒ½åˆ›å»ºç´¢å¼•ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œåº”è¯¥åœ¨è¿™äº›åˆ—ä¸Šåˆ›å»ºç´¢å¼•ï¼š åœ¨ç»å¸¸éœ€è¦æœç´¢çš„åˆ—ä¸Šï¼Œå¯ä»¥åŠ å¿«æœç´¢çš„é€Ÿåº¦ï¼› åœ¨ä½œä¸ºä¸»é”®çš„åˆ—ä¸Šï¼Œå¼ºåˆ¶è¯¥åˆ—çš„å”¯ä¸€æ€§å’Œç»„ç»‡è¡¨ä¸­æ•°æ®çš„æ’åˆ—ç»“æ„ï¼› åœ¨ç»å¸¸ç”¨åœ¨è¿æ¥çš„åˆ—ä¸Šï¼Œè¿™äº›åˆ—ä¸»è¦æ˜¯ä¸€äº›å¤–é”®ï¼Œå¯ä»¥åŠ å¿«è¿æ¥çš„é€Ÿåº¦ï¼› åœ¨ç»å¸¸éœ€è¦æ ¹æ®èŒƒå›´è¿›è¡Œæœç´¢çš„åˆ—ä¸Šåˆ›å»ºç´¢å¼•ï¼Œå› ä¸ºç´¢å¼•å·²ç»æ’åºï¼Œå…¶æŒ‡å®šçš„èŒƒå›´æ˜¯è¿ç»­çš„ï¼› åœ¨ç»å¸¸éœ€è¦æ’åºçš„åˆ—ä¸Šåˆ›å»ºç´¢å¼•ï¼Œå› ä¸ºç´¢å¼•å·²ç»æ’åºï¼Œè¿™æ ·æŸ¥è¯¢å¯ä»¥åˆ©ç”¨ç´¢å¼•çš„æ’åºï¼ŒåŠ å¿«æ’åºæŸ¥è¯¢æ—¶é—´ï¼›åœ¨ç»å¸¸ä½¿ç”¨åœ¨WHEREå­å¥ä¸­çš„åˆ—ä¸Šé¢åˆ›å»ºç´¢å¼•ï¼ŒåŠ å¿«æ¡ä»¶çš„åˆ¤æ–­é€Ÿåº¦ã€‚ å¯¹äºæœ‰äº›åˆ—ä¸åº”è¯¥åˆ›å»ºç´¢å¼•ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¸åº”è¯¥åˆ›å»ºç´¢å¼•çš„çš„è¿™äº›åˆ—å…·æœ‰ä¸‹åˆ—ç‰¹ç‚¹: å¯¹äºé‚£äº›åœ¨æŸ¥è¯¢ä¸­å¾ˆå°‘ä½¿ç”¨æˆ–è€…å‚è€ƒçš„åˆ—ä¸åº”è¯¥åˆ›å»ºç´¢å¼•ã€‚è¿™æ˜¯å› ä¸ºï¼Œæ—¢ç„¶è¿™äº›åˆ—å¾ˆå°‘ä½¿ç”¨åˆ°ï¼Œå› æ­¤æœ‰ç´¢å¼•æˆ–è€…æ— ç´¢å¼•ï¼Œå¹¶ä¸èƒ½æé«˜æŸ¥è¯¢é€Ÿåº¦ã€‚ç›¸åï¼Œç”±äºå¢åŠ äº†ç´¢å¼•ï¼Œåè€Œé™ä½äº†ç³»ç»Ÿçš„ç»´æŠ¤é€Ÿåº¦å’Œå¢å¤§äº†ç©ºé—´éœ€æ±‚ã€‚ å¯¹äºé‚£äº›åªæœ‰å¾ˆå°‘æ•°æ®å€¼çš„åˆ—ä¹Ÿä¸åº”è¯¥å¢åŠ ç´¢å¼•ã€‚è¿™æ˜¯å› ä¸ºï¼Œç”±äºè¿™äº›åˆ—çš„å–å€¼å¾ˆå°‘ï¼Œä¾‹å¦‚äººäº‹è¡¨çš„æ€§åˆ«åˆ—ï¼Œåœ¨æŸ¥è¯¢çš„ç»“æœä¸­ï¼Œç»“æœé›†çš„æ•°æ®è¡Œå äº†è¡¨ä¸­æ•°æ®è¡Œçš„å¾ˆå¤§æ¯”ä¾‹ï¼Œå³éœ€è¦åœ¨è¡¨ä¸­æœç´¢çš„æ•°æ®è¡Œçš„æ¯”ä¾‹å¾ˆå¤§ã€‚å¢åŠ ç´¢å¼•ï¼Œå¹¶ä¸èƒ½æ˜æ˜¾åŠ å¿«æ£€ç´¢é€Ÿåº¦ã€‚ å¯¹äºé‚£äº›å®šä¹‰ä¸ºtext, imageå’Œbitæ•°æ®ç±»å‹çš„åˆ—ä¸åº”è¯¥å¢åŠ ç´¢å¼•ã€‚è¿™æ˜¯å› ä¸ºï¼Œè¿™äº›åˆ—çš„æ•°æ®é‡è¦ä¹ˆç›¸å½“å¤§ï¼Œè¦ä¹ˆå–å€¼å¾ˆå°‘ã€‚ å½“ä¿®æ”¹æ€§èƒ½è¿œè¿œå¤§äºæ£€ç´¢æ€§èƒ½æ—¶ï¼Œä¸åº”è¯¥åˆ›å»ºç´¢å¼•ã€‚è¿™æ˜¯å› ä¸ºï¼Œä¿®æ”¹æ€§èƒ½å’Œæ£€ç´¢æ€§èƒ½æ˜¯äº’ç›¸çŸ›ç›¾çš„ã€‚å½“å¢åŠ ç´¢å¼•æ—¶ï¼Œä¼šæé«˜æ£€ç´¢æ€§èƒ½ï¼Œä½†æ˜¯ä¼šé™ä½ä¿®æ”¹æ€§èƒ½ã€‚å½“å‡å°‘ç´¢å¼•æ—¶ï¼Œä¼šæé«˜ä¿®æ”¹æ€§èƒ½ï¼Œé™ä½æ£€ç´¢æ€§èƒ½ã€‚å› æ­¤ï¼Œå½“ä¿®æ”¹æ€§èƒ½è¿œè¿œå¤§äºæ£€ç´¢æ€§èƒ½æ—¶ï¼Œä¸åº”è¯¥åˆ›å»ºç´¢å¼•ã€‚ ç´¢å¼•çš„ä¼˜åŠ¿ã€åŠ£åŠ¿ ä¼˜åŠ¿ï¼š åˆ›å»ºç´¢å¼•å¯ä»¥å¤§å¤§æé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚ é€šè¿‡åˆ›å»ºå”¯ä¸€æ€§ç´¢å¼•ï¼Œå¯ä»¥ä¿è¯æ•°æ®åº“è¡¨ä¸­æ¯ä¸€è¡Œæ•°æ®çš„å”¯ä¸€æ€§ã€‚å¯ä»¥å¤§å¤§åŠ å¿«æ•°æ®çš„æ£€ç´¢é€Ÿåº¦ï¼Œè¿™ä¹Ÿæ˜¯åˆ›å»ºç´¢å¼•çš„æœ€ä¸»è¦çš„åŸå› ã€‚ å¯ä»¥åŠ é€Ÿè¡¨å’Œè¡¨ä¹‹é—´çš„è¿æ¥ï¼Œç‰¹åˆ«æ˜¯åœ¨å®ç°æ•°æ®çš„å‚è€ƒå®Œæ•´æ€§æ–¹é¢ç‰¹åˆ«æœ‰æ„ä¹‰ åœ¨ä½¿ç”¨åˆ†ç»„å’Œæ’åºå­å¥è¿›è¡Œæ•°æ®æ£€ç´¢æ—¶ï¼ŒåŒæ ·å¯ä»¥æ˜¾è‘—å‡å°‘æŸ¥è¯¢ä¸­åˆ†ç»„å’Œæ’åºçš„æ—¶é—´ã€‚ é€šè¿‡ä½¿ç”¨ç´¢å¼•ï¼Œå¯ä»¥åœ¨æŸ¥è¯¢çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ä¼˜åŒ–éšè—å™¨ï¼Œæé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚ åŠ£åŠ¿ï¼š åˆ›å»ºç´¢å¼•å’Œç»´æŠ¤ç´¢å¼•è¦è€—è´¹æ—¶é—´ï¼Œè¿™ç§æ—¶é—´éšç€æ•°æ®é‡çš„å¢åŠ è€Œå¢åŠ ã€‚ ç´¢å¼•éœ€è¦å ç‰©ç†ç©ºé—´ï¼Œé™¤äº†æ•°æ®è¡¨å æ•°æ®ç©ºé—´ä¹‹å¤–ï¼Œæ¯ä¸€ä¸ªç´¢å¼•è¿˜è¦å ä¸€å®šçš„ç‰©ç†ç©ºé—´ï¼Œå¦‚æœè¦å»ºç«‹èšç°‡ç´¢å¼•ï¼Œé‚£ä¹ˆéœ€è¦çš„ç©ºé—´å°±ä¼šæ›´å¤§ã€‚ å½“å¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œå¢åŠ ã€åˆ é™¤å’Œä¿®æ”¹çš„æ—¶å€™ï¼Œç´¢å¼•ä¹Ÿè¦åŠ¨æ€çš„ç»´æŠ¤ï¼Œè¿™æ ·å°±é™ä½äº†æ•°æ®çš„ç»´æŠ¤é€Ÿåº¦ã€‚ æ ¹æ®æ•°æ®åº“çš„åŠŸèƒ½ï¼Œå¯ä»¥åœ¨æ•°æ®åº“è®¾è®¡å™¨ä¸­åˆ›å»ºä¸‰ç§ç´¢å¼•ï¼šå”¯ä¸€ç´¢å¼•ã€ä¸»é”®ç´¢å¼•å’Œèšé›†ç´¢å¼•ã€‚ å”¯ä¸€ç´¢å¼•ï¼šå”¯ä¸€ç´¢å¼•æ˜¯ä¸å…è®¸å…¶ä¸­ä»»ä½•ä¸¤è¡Œå…·æœ‰ç›¸åŒç´¢å¼•å€¼çš„ç´¢å¼•ã€‚ ä¸»é”®ç´¢å¼•ï¼šæ•°æ®åº“è¡¨ç»å¸¸æœ‰ä¸€åˆ—æˆ–åˆ—ç»„åˆï¼Œå…¶å€¼å”¯ä¸€æ ‡è¯†è¡¨ä¸­çš„æ¯ä¸€è¡Œã€‚è¯¥åˆ—ç§°ä¸ºè¡¨çš„ä¸»é”®ã€‚ åœ¨æ•°æ®åº“å…³ç³»å›¾ä¸­ä¸ºè¡¨å®šä¹‰ä¸»é”®å°†è‡ªåŠ¨åˆ›å»ºä¸»é”®ç´¢å¼•ï¼Œ- ä¸»é”®ç´¢å¼•æ˜¯å”¯ä¸€ç´¢å¼•çš„ç‰¹å®šç±»å‹ã€‚è¯¥ç´¢å¼•è¦æ±‚ä¸»é”®ä¸­çš„æ¯ä¸ªå€¼éƒ½å”¯ä¸€ã€‚å½“åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨ä¸»é”®ç´¢å¼•æ—¶ï¼Œå®ƒè¿˜å…è®¸å¯¹æ•°æ®çš„å¿«é€Ÿè®¿é—®ã€‚ èšé›†ç´¢å¼• åœ¨èšé›†ç´¢å¼•ä¸­ï¼Œè¡¨ä¸­è¡Œçš„ç‰©ç†é¡ºåºä¸é”®å€¼çš„é€»è¾‘ï¼ˆç´¢å¼•ï¼‰é¡ºåºç›¸åŒã€‚ä¸€ä¸ªè¡¨åªèƒ½åŒ…å«ä¸€ä¸ªèšé›†ç´¢å¼•ã€‚ é“¾æ¥æŸ¥è¯¢ç§ç±»ä½¿ç”¨å¤–è¿æ¥å¤–è¿æ¥åŒ…æ‹¬å·¦å‘å¤–è”æ¥ã€å³å‘å¤–è”æ¥æˆ–å®Œæ•´å¤–éƒ¨è”æ¥ å·¦è¿æ¥ï¼šleft join æˆ– left outer join å·¦å‘å¤–è”æ¥çš„ç»“æœé›†åŒ…æ‹¬ LEFT OUTER å­å¥ä¸­æŒ‡å®šçš„å·¦è¡¨çš„æ‰€æœ‰è¡Œï¼Œè€Œä¸ä»…ä»…æ˜¯è”æ¥åˆ—æ‰€åŒ¹é…çš„è¡Œã€‚å¦‚æœå·¦è¡¨çš„æŸè¡Œåœ¨å³è¡¨ä¸­æ²¡æœ‰åŒ¹é…è¡Œï¼Œåˆ™åœ¨ç›¸å…³è”çš„ç»“æœé›†è¡Œä¸­å³è¡¨çš„æ‰€æœ‰é€‰æ‹©åˆ—è¡¨åˆ—å‡ä¸ºç©ºå€¼(null)ã€‚ å³è¿æ¥ï¼šright join æˆ– right outer join å³å‘å¤–è”æ¥æ˜¯å·¦å‘å¤–è”æ¥çš„åå‘è”æ¥ã€‚å°†è¿”å›å³è¡¨çš„æ‰€æœ‰è¡Œã€‚å¦‚æœå³è¡¨çš„æŸè¡Œåœ¨å·¦è¡¨ä¸­æ²¡æœ‰åŒ¹é…è¡Œï¼Œåˆ™å°†ä¸ºå·¦è¡¨è¿”å›ç©ºå€¼ã€‚ å®Œæ•´å¤–éƒ¨è”æ¥:full join æˆ– full outer join å®Œæ•´å¤–éƒ¨è”æ¥è¿”å›å·¦è¡¨å’Œå³è¡¨ä¸­çš„æ‰€æœ‰è¡Œã€‚å½“æŸè¡Œåœ¨å¦ä¸€ä¸ªè¡¨ä¸­æ²¡æœ‰åŒ¹é…è¡Œæ—¶ï¼Œåˆ™å¦ä¸€ä¸ªè¡¨çš„é€‰æ‹©åˆ—è¡¨åˆ—åŒ…å«ç©ºå€¼ã€‚å¦‚æœè¡¨ä¹‹é—´æœ‰åŒ¹é…è¡Œï¼Œåˆ™æ•´ä¸ªç»“æœé›†è¡ŒåŒ…å«åŸºè¡¨çš„æ•°æ®å€¼ã€‚ ä½¿ç”¨å†…é“¾æ¥å†…è”æ¥æ˜¯ç”¨æ¯”è¾ƒè¿ç®—ç¬¦æ¯”è¾ƒè¦è”æ¥åˆ—çš„å€¼çš„è”æ¥ å†…è¿æ¥ï¼šjoin æˆ– inner join æ³¨æ„è¿™ä¸ªæ–¹æ³•å’Œæ™®é€šçš„from å¤šè¡¨æŸ¥è¯¢æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œå†…é“¾æ¥å¯ä»¥çœç•¥onå’Œä½¿ç”¨where ä½œä¸ºçº¦æŸ äº¤å‰è¿æ¥(å®Œå…¨)æ¦‚å¿µï¼šæ²¡æœ‰ WHEREï¼ˆæˆ–è€…onï¼‰å­å¥çš„äº¤å‰è”æ¥å°†äº§ç”Ÿè”æ¥æ‰€æ¶‰åŠçš„è¡¨çš„ç¬›å¡å°”ç§¯ã€‚ç¬¬ä¸€ä¸ªè¡¨çš„è¡Œæ•°ä¹˜ä»¥ç¬¬äºŒä¸ªè¡¨çš„è¡Œæ•°ç­‰äºç¬›å¡å°”ç§¯ç»“æœé›†çš„å¤§å°ã€‚ï¼ˆtable1å’Œtable2äº¤å‰è¿æ¥äº§ç”Ÿ3*3&#x3D;9æ¡è®°å½•ï¼‰ æ•°æ®åº“èŒƒå¼å®šä¹‰ ç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰ åœ¨ä»»ä½•ä¸€ä¸ªå…³ç³»æ•°æ®åº“ä¸­ï¼Œç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰æ˜¯å¯¹å…³ç³»æ¨¡å¼çš„åŸºæœ¬è¦æ±‚ï¼Œä¸æ»¡è¶³ç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰çš„æ•°æ®åº“å°±ä¸æ˜¯å…³ç³»æ•°æ®åº“ã€‚ æ‰€è°“ç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰æ˜¯æŒ‡æ•°æ®åº“è¡¨çš„æ¯ä¸€åˆ—éƒ½æ˜¯ä¸å¯åˆ†å‰²çš„åŸºæœ¬æ•°æ®é¡¹ï¼ŒåŒä¸€åˆ—ä¸­ä¸èƒ½æœ‰å¤šä¸ªå€¼ï¼Œå³å®ä½“ä¸­çš„æŸä¸ªå±æ€§ä¸èƒ½æœ‰å¤šä¸ªå€¼æˆ–è€…ä¸èƒ½æœ‰é‡å¤çš„å±æ€§ã€‚å¦‚æœå‡ºç°é‡å¤çš„å±æ€§ï¼Œå°±å¯èƒ½éœ€è¦å®šä¹‰ä¸€ä¸ªæ–°çš„å®ä½“ï¼Œæ–°çš„å®ä½“ç”±é‡å¤çš„å±æ€§æ„æˆï¼Œæ–°å®ä½“ä¸åŸå®ä½“ä¹‹é—´ä¸ºä¸€å¯¹å¤šå…³ç³»ã€‚åœ¨ç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰ä¸­è¡¨çš„æ¯ä¸€è¡ŒåªåŒ…å«ä¸€ä¸ªå®ä¾‹çš„ä¿¡æ¯ã€‚ç®€è€Œè¨€ä¹‹ï¼Œç¬¬ä¸€èŒƒå¼å°±æ˜¯æ— é‡å¤çš„åˆ—ã€‚ ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰ ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰æ˜¯åœ¨ç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰çš„åŸºç¡€ä¸Šå»ºç«‹èµ·æ¥çš„ï¼Œå³æ»¡è¶³ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰å¿…é¡»å…ˆæ»¡è¶³ç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰ã€‚ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰è¦æ±‚æ•°æ®åº“è¡¨ä¸­çš„æ¯ä¸ªå®ä¾‹æˆ–è¡Œå¿…é¡»å¯ä»¥è¢«æƒŸä¸€åœ°åŒºåˆ†ã€‚ä¸ºå®ç°åŒºåˆ†é€šå¸¸éœ€è¦ä¸ºè¡¨åŠ ä¸Šä¸€ä¸ªåˆ—ï¼Œä»¥å­˜å‚¨å„ä¸ªå®ä¾‹çš„æƒŸä¸€æ ‡è¯†ã€‚è¿™ä¸ªæƒŸä¸€å±æ€§åˆ—è¢«ç§°ä¸ºä¸»å…³é”®å­—æˆ–ä¸»é”®ã€ä¸»ç ã€‚ ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰è¦æ±‚å®ä½“çš„å±æ€§å®Œå…¨ä¾èµ–äºä¸»å…³é”®å­—ã€‚æ‰€è°“å®Œå…¨ä¾èµ–æ˜¯æŒ‡ä¸èƒ½å­˜åœ¨ä»…ä¾èµ–ä¸»å…³é”®å­—ä¸€éƒ¨åˆ†çš„å±æ€§ï¼Œå¦‚æœå­˜åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå±æ€§å’Œä¸»å…³é”®å­—çš„è¿™ä¸€éƒ¨åˆ†åº”è¯¥åˆ†ç¦»å‡ºæ¥å½¢æˆä¸€ä¸ªæ–°çš„å®ä½“ï¼Œæ–°å®ä½“ä¸åŸå®ä½“ä¹‹é—´æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚ä¸ºå®ç°åŒºåˆ†é€šå¸¸éœ€è¦ä¸ºè¡¨åŠ ä¸Šä¸€ä¸ªåˆ—ï¼Œä»¥å­˜å‚¨å„ä¸ªå®ä¾‹çš„æƒŸä¸€æ ‡è¯†ã€‚ç®€è€Œè¨€ä¹‹ï¼Œç¬¬äºŒèŒƒå¼å°±æ˜¯éä¸»å±æ€§ééƒ¨åˆ†ä¾èµ–äºä¸»å…³é”®å­—ã€‚ ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰ æ»¡è¶³ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰å¿…é¡»å…ˆæ»¡è¶³ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰ã€‚ç®€è€Œè¨€ä¹‹ï¼Œç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰è¦æ±‚ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ä¸åŒ…å«å·²åœ¨å…¶å®ƒè¡¨ä¸­å·²åŒ…å«çš„éä¸»å…³é”®å­—ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨ä¸€ä¸ªéƒ¨é—¨ä¿¡æ¯è¡¨ï¼Œå…¶ä¸­æ¯ä¸ªéƒ¨é—¨æœ‰éƒ¨é—¨ç¼–å·ï¼ˆdept_idï¼‰ã€éƒ¨é—¨åç§°ã€éƒ¨é—¨ç®€ä»‹ç­‰ä¿¡æ¯ã€‚é‚£ä¹ˆåœ¨å‘˜å·¥ä¿¡æ¯è¡¨ä¸­åˆ—å‡ºéƒ¨é—¨ç¼–å·åå°±ä¸èƒ½å†å°†éƒ¨é—¨åç§°ã€éƒ¨é—¨ç®€ä»‹ç­‰ä¸éƒ¨é—¨æœ‰å…³çš„ä¿¡æ¯å†åŠ å…¥å‘˜å·¥ä¿¡æ¯è¡¨ä¸­ã€‚å¦‚æœä¸å­˜åœ¨éƒ¨é—¨ä¿¡æ¯è¡¨ï¼Œåˆ™æ ¹æ®ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰ä¹Ÿåº”è¯¥æ„å»ºå®ƒï¼Œå¦åˆ™å°±ä¼šæœ‰å¤§é‡çš„æ•°æ®å†—ä½™ã€‚ç®€è€Œè¨€ä¹‹ï¼Œç¬¬ä¸‰èŒƒå¼å°±æ˜¯å±æ€§ä¸ä¾èµ–äºå…¶å®ƒéä¸»å±æ€§ã€‚ï¼ˆæˆ‘çš„ç†è§£æ˜¯æ¶ˆé™¤å†—ä½™ï¼‰","date":"2024-12-31","categories":["mysql"]},{"title":"mysql-æ•°æ®åº“å¼€å¯è¿œç¨‹ç™»å…¥æƒé™","url":"/2024/12/31/mysql-æ•°æ®åº“å¼€å¯è¿œç¨‹ç™»å…¥æƒé™/","content":"mysqlæ•°æ®åº“å¼€å¯è¿œç¨‹ç™»å…¥æƒé™æ³¨é‡Šæ‰åœ¨&#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnfï¼ˆä½¿ç”¨aptå®‰è£…åçš„é…ç½®æ–‡ä»¶ï¼‰é‡Œé¢çš„bind-address &#x3D; 127.0.0.1s ç™»å…¥çš„mysqlæ•°æ®åº“ï¼Œç»™éœ€è¦çš„ç”¨æˆ·æ·»åŠ æƒé™","date":"2024-12-31","categories":["mysql"]},{"title":"mysql-é«˜æ•ˆåˆ†é¡µæŸ¥è¯¢æ–¹æ³•","url":"/2024/12/31/mysql-é«˜æ•ˆåˆ†é¡µæŸ¥è¯¢æ–¹æ³•/","content":"åˆ†é¡µæŸ¥è¯¢åœ¨äº’è”ç½‘åº”ç”¨ä¸­éå¸¸å¸¸è§,ä½†æ˜¯æˆ‘ä»¬çœŸçš„æŠŠmysqlåˆ†é¡µæŸ¥è¯¢çš„æ€§èƒ½ä¼˜åŒ–åˆ°æé™äº†å— æ‰€ä»¥è¿™é‡Œæ€»ç»“ä¸€ä¸‹mysqlåˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–ç›¸å…³çš„é—®é¢˜","date":"2024-12-31","categories":["mysql"]},{"title":"mysqlä¸»ä»å¤åˆ¶æ¨¡å‹(master-slave)-replicationæ¨¡å¼","url":"/2024/12/31/mysqlä¸»ä»å¤åˆ¶æ¨¡å‹-master-slave--replicationæ¨¡å¼/","content":"Mysql ä¸»ä»å¤åˆ¶ replicationmysqlé›†ç¾¤æ–¹æ¡ˆæœ‰replicationå’ŒPXC replicationå’ŒPXCä¸¤ç§æ–¹æ¡ˆå†™å…¥æ•°æ®åŒæ­¥æ¯”è¾ƒï¼š replicationé‡‡ç”¨å¼‚æ­¥å¤åˆ¶ï¼Œæ— æ³•ä¿è¯æ•°æ®çš„ä¸€è‡´ã€‚ PXCé‡‡ç”¨åŒæ­¥å¤åˆ¶ï¼Œäº‹åŠ¡åœ¨é›†ç¾¤çš„æ‰€æœ‰èŠ‚ç‚¹è¦ä¹ˆåŒæ—¶æäº¤ï¼Œè¦ä¹ˆä¸æäº¤ï¼ŒPXCä½¿ç”¨çš„æ˜¯perconaï¼Œperconaæ˜¯mysqlæ”¹è¿›ç‰ˆï¼Œæ€§èƒ½æŒºå‡å¾ˆå¤§ MySQL Replicationä¸»ä»å¤åˆ¶ï¼ˆä¹Ÿç§° AB å¤åˆ¶ï¼‰å…è®¸å°†æ¥è‡ªä¸€ä¸ªMySQLæ•°æ®åº“æœåŠ¡å™¨ï¼ˆä¸»æœåŠ¡å™¨ï¼‰çš„æ•°æ®å¤åˆ¶åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªMySQLæ•°æ®åº“æœåŠ¡å™¨ï¼ˆä»æœåŠ¡å™¨) å¤åˆ¶æ˜¯å¼‚æ­¥çš„ ä»ç«™ä¸éœ€è¦æ°¸ä¹…è¿æ¥ä»¥æ¥æ”¶æ¥è‡ªä¸»ç«™çš„æ›´æ–°ã€‚ æ ¹æ®é…ç½®ï¼Œæ‚¨å¯ä»¥å¤åˆ¶æ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®åº“ï¼Œæ‰€é€‰æ•°æ®åº“ç”šè‡³é€‰å®šçš„è¡¨ã€‚ MySQLä¸»ä»å¤åˆ¶çš„ä¼˜ç‚¹åŒ…æ‹¬ï¼š æ¨ªå‘æ‰©å±•è§£å†³æ–¹æ¡ˆ - åœ¨å¤šä¸ªä»ç«™ä¹‹é—´åˆ†é…è´Ÿè½½ä»¥æé«˜æ€§èƒ½ã€‚åœ¨æ­¤ç¯å¢ƒä¸­ï¼Œæ‰€æœ‰å†™å…¥å’Œæ›´æ–°éƒ½å¿…é¡»åœ¨ä¸»æœåŠ¡å™¨ä¸Šè¿›è¡Œã€‚ä½†æ˜¯ï¼Œè¯»å–å¯ä»¥åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªä»è®¾å¤‡ä¸Šè¿›è¡Œã€‚è¯¥æ¨¡å‹å¯ä»¥æé«˜å†™å…¥æ€§èƒ½ï¼ˆå› ä¸ºä¸»è®¾å¤‡ä¸“ç”¨äºæ›´æ–°ï¼‰ï¼ŒåŒæ—¶æ˜¾ç€æé«˜äº†è¶Šæ¥è¶Šå¤šçš„ä»è®¾å¤‡çš„è¯»å–é€Ÿåº¦ã€‚ æ•°æ®å®‰å…¨æ€§ - å› ä¸ºæ•°æ®è¢«å¤åˆ¶åˆ°ä»ç«™ï¼Œå¹¶ä¸”ä»ç«™å¯ä»¥æš‚åœå¤åˆ¶è¿‡ç¨‹ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä»ç«™ä¸Šè¿è¡Œå¤‡ä»½æœåŠ¡è€Œä¸ä¼šç ´åç›¸åº”çš„ä¸»æ•°æ®ã€‚ åˆ†æ - å¯ä»¥åœ¨ä¸»æœåŠ¡å™¨ä¸Šåˆ›å»ºå®æ—¶æ•°æ®ï¼Œè€Œä¿¡æ¯åˆ†æå¯ä»¥åœ¨ä»æœåŠ¡å™¨ä¸Šè¿›è¡Œï¼Œè€Œä¸ä¼šå½±å“ä¸»æœåŠ¡å™¨çš„æ€§èƒ½ã€‚ è¿œç¨‹æ•°æ®åˆ†å‘ - æ‚¨å¯ä»¥ä½¿ç”¨å¤åˆ¶ä¸ºè¿œç¨‹ç«™ç‚¹åˆ›å»ºæ•°æ®çš„æœ¬åœ°å‰¯æœ¬ï¼Œè€Œæ— éœ€æ°¸ä¹…è®¿é—®ä¸»æœåŠ¡å™¨ã€‚ mysql ReplicationåŸç† å‰ææ˜¯ä½œä¸ºä¸»æœåŠ¡å™¨è§’è‰²çš„æ•°æ®åº“æœåŠ¡å™¨å¿…é¡»å¼€å¯äºŒè¿›åˆ¶æ—¥å¿— è¿‡ç¨‹: ä¸»æœåŠ¡å™¨ä¸Šé¢çš„ä»»ä½•ä¿®æ”¹éƒ½ä¼šé€šè¿‡è‡ªå·±çš„ I&#x2F;O tread(I&#x2F;O çº¿ç¨‹)ä¿å­˜åœ¨äºŒè¿›åˆ¶æ—¥å¿— Binary log é‡Œé¢ã€‚ ä»æœåŠ¡å™¨ä¸Šé¢ä¹Ÿå¯åŠ¨ä¸€ä¸ª I&#x2F;O threadï¼Œé€šè¿‡é…ç½®å¥½çš„ç”¨æˆ·åå’Œå¯†ç , è¿æ¥åˆ°ä¸»æœåŠ¡å™¨ä¸Šé¢è¯·æ±‚è¯»å–äºŒè¿›åˆ¶æ—¥å¿—ï¼Œç„¶åæŠŠè¯»å–åˆ°çš„äºŒè¿›åˆ¶æ—¥å¿—å†™åˆ°æœ¬åœ°çš„ä¸€ä¸ªRealy logï¼ˆä¸­ç»§æ—¥å¿—ï¼‰é‡Œé¢ã€‚ ä»æœåŠ¡å™¨ä¸Šé¢åŒæ—¶å¼€å¯ä¸€ä¸ª SQL thread å®šæ—¶æ£€æŸ¥ Realy log(è¿™ä¸ªæ–‡ä»¶ä¹Ÿæ˜¯äºŒè¿›åˆ¶çš„)ï¼Œå¦‚æœå‘ç°æœ‰æ›´æ–°ç«‹å³æŠŠæ›´æ–°çš„å†…å®¹åœ¨æœ¬æœºçš„æ•°æ®åº“ä¸Šé¢æ‰§è¡Œä¸€é. æ³¨æ„:æ¯ä¸ªä»æœåŠ¡å™¨éƒ½ä¼šæ”¶åˆ°ä¸»æœåŠ¡å™¨äºŒè¿›åˆ¶æ—¥å¿—çš„å…¨éƒ¨å†…å®¹çš„å‰¯æœ¬ã€‚ä»æœåŠ¡å™¨è®¾å¤‡è´Ÿè´£å†³å®šåº”è¯¥æ‰§è¡ŒäºŒè¿›åˆ¶æ—¥å¿—ä¸­çš„å“ªäº›è¯­å¥ã€‚é™¤éå¦è¡ŒæŒ‡å®šï¼Œå¦åˆ™ä¸»ä»äºŒè¿›åˆ¶æ—¥å¿—ä¸­çš„æ‰€æœ‰äº‹ä»¶éƒ½åœ¨ä»ç«™ä¸Šæ‰§è¡Œã€‚å¦‚æœéœ€è¦ï¼Œæ‚¨å¯ä»¥å°†ä»æœåŠ¡å™¨é…ç½®ä¸ºä»…å¤„ç†ä¸€äº›ç‰¹å®šæ•°æ®åº“æˆ–è¡¨çš„äº‹ä»¶ã€‚ é‡è¦: æ‚¨æ— æ³•å°†ä¸»æœåŠ¡å™¨é…ç½®ä¸ºä»…è®°å½•ç‰¹å®šäº‹ä»¶ã€‚ ä¸€ä¸»å¤šä»é…åˆ¶æ–¹æ³•å¦‚æœä¸€ä¸»å¤šä»çš„è¯ï¼Œè¿™æ—¶ä¸»åº“æ—¢è¦è´Ÿè´£å†™åˆè¦è´Ÿè´£ä¸ºå‡ ä¸ªä»åº“æä¾›äºŒè¿›åˆ¶æ—¥å¿—ã€‚æ­¤æ—¶å¯ä»¥ç¨åšè°ƒæ•´ï¼Œå°†äºŒè¿›åˆ¶æ—¥å¿—åªç»™æŸä¸€ä»ï¼Œè¿™ä¸€ä»å†å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—å¹¶å°†è‡ªå·±çš„äºŒè¿›åˆ¶æ—¥å¿—å†å‘ç»™å…¶å®ƒä»ã€‚æˆ–è€…æ˜¯å¹²è„†è¿™ä¸ªä»ä¸è®°å½•åªè´Ÿè´£å°†äºŒè¿›åˆ¶æ—¥å¿—è½¬å‘ç»™å…¶å®ƒä»ï¼Œè¿™æ ·æ¶æ„èµ·æ¥æ€§èƒ½å¯èƒ½è¦å¥½å¾—å¤šï¼Œè€Œä¸”æ•°æ®ä¹‹é—´çš„å»¶æ—¶åº”è¯¥ä¹Ÿç¨å¾®è¦å¥½ä¸€äº›ã€‚å·¥ä½œåŸç†å›¾å¦‚ä¸‹ï¼š å…³äºäºŒè¿›åˆ¶æ—¥å¿—mysqldå°†æ•°å­—æ‰©å±•åé™„åŠ åˆ°äºŒè¿›åˆ¶æ—¥å¿—åŸºæœ¬åç§°ä»¥ç”ŸæˆäºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶åã€‚æ¯æ¬¡æœåŠ¡å™¨åˆ›å»ºæ–°æ—¥å¿—æ–‡ä»¶æ—¶ï¼Œè¯¥æ•°å­—éƒ½ä¼šå¢åŠ ï¼Œä»è€Œåˆ›å»ºä¸€ç³»åˆ—æœ‰åºçš„æ–‡ä»¶ã€‚æ¯æ¬¡å¯åŠ¨æˆ–åˆ·æ–°æ—¥å¿—æ—¶ï¼ŒæœåŠ¡å™¨éƒ½ä¼šåœ¨ç³»åˆ—ä¸­åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚æœåŠ¡å™¨è¿˜ä¼šåœ¨å½“å‰æ—¥å¿—å¤§å°è¾¾åˆ°max_binlog_sizeå‚æ•°è®¾ç½®çš„å¤§å°åè‡ªåŠ¨åˆ›å»ºæ–°çš„äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ ã€‚äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶å¯èƒ½ä¼šæ¯”max_binlog_sizeä½¿ç”¨å¤§å‹äº‹åŠ¡æ—¶æ›´å¤§ï¼Œ å› ä¸ºäº‹åŠ¡æ˜¯ä»¥ä¸€ä¸ªéƒ¨åˆ†å†™å…¥æ–‡ä»¶ï¼Œè€Œä¸æ˜¯åœ¨æ–‡ä»¶ä¹‹é—´åˆ†å‰²ã€‚ ä¸ºäº†è·Ÿè¸ªå·²ä½¿ç”¨çš„äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ï¼Œ mysqldè¿˜åˆ›å»ºäº†ä¸€ä¸ªäºŒè¿›åˆ¶æ—¥å¿—ç´¢å¼•æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰ä½¿ç”¨çš„äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶çš„åç§°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå…·æœ‰ä¸äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ç›¸åŒçš„åŸºæœ¬åç§°ï¼Œå¹¶å¸¦æœ‰æ‰©å±•åâ€™.indexâ€™ã€‚åœ¨mysqldè¿è¡Œæ—¶ï¼Œæ‚¨ä¸åº”æ‰‹åŠ¨ç¼–è¾‘æ­¤æ–‡ä»¶ã€‚ æœ¯è¯­äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶é€šå¸¸è¡¨ç¤ºåŒ…å«æ•°æ®åº“äº‹ä»¶çš„å•ä¸ªç¼–å·æ–‡ä»¶ã€‚ æœ¯è¯­ äºŒè¿›åˆ¶æ—¥å¿— è¡¨ç¤ºå«ç¼–å·çš„äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶é›†åŠ ä¸Šç´¢å¼•æ–‡ä»¶ã€‚ SUPER æƒé™çš„ç”¨æˆ·å¯ä»¥ä½¿ç”¨SET sql_log_bin&#x3D;0è¯­å¥ç¦ç”¨å…¶å½“å‰ç¯å¢ƒä¸‹è‡ªå·±çš„è¯­å¥çš„äºŒè¿›åˆ¶æ—¥å¿—è®°å½• mysqlä¸»ä»å¤åˆ¶é…ç½®Master-Server é…ç½®ä¿®æ”¹ my.cnfé…ç½® Master ä»¥ä½¿ç”¨åŸºäºäºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ä½ç½®çš„å¤åˆ¶ï¼Œå¿…é¡»å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—è®°å½•å¹¶å»ºç«‹å”¯ä¸€çš„æœåŠ¡å™¨ID,å¦åˆ™åˆ™æ— æ³•è¿›è¡Œä¸»ä»å¤åˆ¶ã€‚ åœæ­¢MySQLæœåŠ¡ã€‚ å¼€å¯binlog ï¼Œæ¯å°è®¾ç½®ä¸åŒçš„ server-id å¯åŠ¨MySQLæœåŠ¡ ç™»å½•MySQL åˆ›å»ºç”¨æˆ·æ¯ä¸ªä»åº“ä½¿ç”¨MySQLç”¨æˆ·åå’Œå¯†ç è¿æ¥åˆ°ä¸»åº“ï¼Œå› æ­¤ä¸»åº“ä¸Šå¿…é¡»æœ‰ç”¨æˆ·å¸æˆ·ï¼Œä»åº“å¯ä»¥è¿æ¥ã€‚ä»»ä½•å¸æˆ·éƒ½å¯ä»¥ç”¨äºæ­¤æ“ä½œï¼Œåªè¦å®ƒå·²è¢«æˆäºˆ REPLICATION SLAVEæƒé™ã€‚å¯ä»¥é€‰æ‹©ä¸ºæ¯ä¸ªä»åº“åˆ›å»ºä¸åŒçš„å¸æˆ·ï¼Œæˆ–è€…æ¯ä¸ªä»åº“ä½¿ç”¨ç›¸åŒå¸æˆ·è¿æ¥åˆ°ä¸»åº“ è™½ç„¶ä¸å¿…ä¸“é—¨ä¸ºå¤åˆ¶åˆ›å»ºå¸æˆ·ï¼Œä½†åº”æ³¨æ„ï¼Œå¤åˆ¶ç”¨åˆ°çš„ç”¨æˆ·åå’Œå¯†ç ä¼šä»¥çº¯æ–‡æœ¬æ ¼å¼å­˜å‚¨åœ¨ä¸»ä¿¡æ¯å­˜å‚¨åº“æ–‡ä»¶æˆ–è¡¨ä¸­ ã€‚å› æ­¤ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„å¸æˆ·ï¼Œè¯¥å¸æˆ·åªå…·æœ‰å¤åˆ¶è¿‡ç¨‹çš„æƒé™ï¼Œä»¥å°½å¯èƒ½å‡å°‘å¯¹å…¶ä»–å¸æˆ·çš„å±å®³ã€‚ ç™»å½•MySQL Slave-Server é…ç½®ä¿®æ”¹ my.cnfåœæ­¢MySQLæœåŠ¡ã€‚ å¦‚æœè¦è®¾ç½®å¤šä¸ªä»åº“ï¼Œåˆ™æ¯ä¸ªä»åº“çš„server-idä¸ä¸»åº“å’Œå…¶ä»–ä»åº“è®¾ç½®ä¸åŒçš„å”¯ä¸€å€¼ã€‚ å¯åŠ¨MySQLæœåŠ¡ ç™»å½•MySQL é…ç½®ä¸»åº“é€šä¿¡ æŸ¥çœ‹ Master-Server ï¼Œ binlog File æ–‡ä»¶åç§°å’Œ Positionå€¼ä½ç½® å¹¶ä¸”è®°ä¸‹æ¥ è¦è®¾ç½®ä»åº“ä¸ä¸»åº“è¿›è¡Œé€šä¿¡ï¼Œè¿›è¡Œå¤åˆ¶ï¼Œä½¿ç”¨å¿…è¦çš„è¿æ¥ä¿¡æ¯é…ç½®ä»åº“åœ¨ä»åº“ä¸Šæ‰§è¡Œä»¥ä¸‹è¯­å¥ å°†é€‰é¡¹å€¼æ›¿æ¢ä¸ºä¸ç³»ç»Ÿç›¸å…³çš„å®é™…å€¼ å‚æ•°æ ¼å¼ï¼Œè¯·å‹¿æ‰§è¡Œ MASTER_LOG_POS&#x3D;0 å†™æˆ0 ä¹Ÿæ˜¯å¯ä»¥çš„ æ”¾åœ¨ä¸€è¡Œæ‰§è¡Œæ–¹ä¾¿ å¯åŠ¨ä»æœåŠ¡å™¨å¤åˆ¶çº¿ç¨‹ æŸ¥çœ‹å¤åˆ¶çŠ¶æ€ æ£€æŸ¥ä¸»ä»å¤åˆ¶é€šä¿¡çŠ¶æ€ å¿…é¡»éƒ½æ˜¯ Yes å¦‚æœä¸æ˜¯åŸå› ä¸»è¦æœ‰ä»¥ä¸‹ 4 ä¸ªæ–¹é¢ï¼š 1ã€ç½‘ç»œä¸é€š 2ã€å¯†ç ä¸å¯¹ 3ã€MASTER_LOG_POS ä¸å¯¹ ps 4ã€mysql çš„ auto.cnf server-uuid ä¸€æ ·ï¼ˆå¯èƒ½ä½ æ˜¯å¤åˆ¶çš„mysqlï¼‰ æµ‹è¯•ä¸»ä»å¤åˆ¶å¯åŠ¨MySQLæœåŠ¡ ç™»å½•MySQL åœ¨ Master-Server åˆ›å»ºæµ‹è¯•åº“ åœ¨ Slave-Server æŸ¥çœ‹æ˜¯å¦åŒæ­¥è¿‡æ¥ ä¸€äº›å‘½ä»¤ æŸ¥çœ‹ä¸»æœåŠ¡å™¨çš„è¿è¡ŒçŠ¶æ€ æŸ¥çœ‹ä»æœåŠ¡å™¨ä¸»æœºåˆ—è¡¨ è·å–binlogæ–‡ä»¶åˆ—è¡¨ åªæŸ¥çœ‹ç¬¬ä¸€ä¸ªbinlogæ–‡ä»¶çš„å†…å®¹ æŸ¥çœ‹æŒ‡å®šbinlogæ–‡ä»¶çš„å†…å®¹ å¯åŠ¨ä»åº“å¤åˆ¶çº¿ç¨‹ åœæ­¢ä»åº“å¤åˆ¶çº¿ç¨‹ å¤åˆ¶å®ç°ç»†èŠ‚åˆ†æMySQLä¸»ä»å¤åˆ¶åŠŸèƒ½ä½¿ç”¨ä¸‰ä¸ªçº¿ç¨‹å®ç°ï¼Œä¸€ä¸ªåœ¨ä¸»æœåŠ¡å™¨ä¸Šï¼Œä¸¤ä¸ªåœ¨ä»æœåŠ¡å™¨ä¸Š Binlogè½¬å‚¨çº¿ç¨‹ã€‚å½“ä»æœåŠ¡å™¨ä¸ä¸»æœåŠ¡å™¨è¿æ¥æ—¶ï¼Œä¸»æœåŠ¡å™¨ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹å°†äºŒè¿›åˆ¶æ—¥å¿—å†…å®¹å‘é€åˆ°ä»æœåŠ¡å™¨ã€‚è¯¥çº¿ç¨‹å¯ä»¥ä½¿ç”¨ è¯­å¥ SHOW PROCESSLIST(ä¸‹é¢æœ‰ç¤ºä¾‹ä»‹ç») åœ¨æœåŠ¡å™¨ sql æ§åˆ¶å°è¾“å‡ºä¸­æ ‡è¯†ä¸ºBinlog Dumpçº¿ç¨‹ã€‚ äºŒè¿›åˆ¶æ—¥å¿—è½¬å‚¨çº¿ç¨‹è·å–æœåŠ¡å™¨ä¸ŠäºŒè¿›åˆ¶æ—¥å¿—ä¸Šçš„é”ï¼Œç”¨äºè¯»å–è¦å‘é€åˆ°ä»æœåŠ¡å™¨çš„æ¯ä¸ªäº‹ä»¶ã€‚ä¸€æ—¦äº‹ä»¶è¢«è¯»å–ï¼Œå³ä½¿åœ¨å°†äº‹ä»¶å‘é€åˆ°ä»æœåŠ¡å™¨ä¹‹å‰ï¼Œé”ä¼šè¢«é‡Šæ”¾ã€‚ ä»æœåŠ¡å™¨I&#x2F;Oçº¿ç¨‹ã€‚å½“åœ¨ä»æœåŠ¡å™¨sql æ§åˆ¶å°å‘å‡º START SLAVEè¯­å¥æ—¶ï¼Œä»æœåŠ¡å™¨å°†åˆ›å»ºä¸€ä¸ªI&#x2F;Oçº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹è¿æ¥åˆ°ä¸»æœåŠ¡å™¨ï¼Œå¹¶è¦æ±‚å®ƒå‘é€è®°å½•åœ¨ä¸»æœåŠ¡å™¨ä¸Šçš„äºŒè¿›åˆ¶æ›´æ–°æ—¥å¿—ã€‚ ä»æœºI&#x2F;Oçº¿ç¨‹è¯»å–ä¸»æœåŠ¡å™¨Binlog Dumpçº¿ç¨‹å‘é€çš„æ›´æ–° ï¼ˆå‚è€ƒä¸Šé¢ Binlogè½¬å‚¨çº¿ç¨‹ ä»‹ç»ï¼‰ï¼Œå¹¶å°†å®ƒä»¬å¤åˆ¶åˆ°è‡ªå·±çš„æœ¬åœ°æ–‡ä»¶äºŒè¿›åˆ¶æ—¥å¿—ä¸­ã€‚ è¯¥çº¿ç¨‹çš„çŠ¶æ€æ˜¾ç¤ºè¯¦æƒ… Slave_IO_running åœ¨è¾“å‡ºç«¯ ä½¿ç”¨ å‘½ä»¤SHOW SLAVE STATUS ä½¿ç”¨\\Gè¯­å¥ç»ˆç»“ç¬¦,è€Œä¸æ˜¯åˆ†å·,æ˜¯ä¸ºäº†ï¼Œæ˜“è¯»çš„å‚ç›´å¸ƒå±€ è¿™ä¸ªå‘½ä»¤åœ¨ä¸Šé¢ æŸ¥çœ‹ä»æœåŠ¡å™¨çŠ¶æ€ ç”¨åˆ°è¿‡ ä»æœåŠ¡å™¨SQLçº¿ç¨‹ã€‚ä»æœåŠ¡å™¨åˆ›å»ºä¸€æ¡SQLçº¿ç¨‹æ¥è¯»å–ç”±ä¸»æœåŠ¡å™¨I&#x2F;Oçº¿ç¨‹å†™å…¥çš„äºŒçº§åˆ¶æ—¥å¿—ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­åŒ…å«çš„äº‹ä»¶ã€‚ åœ¨å‰é¢çš„æè¿°ä¸­ï¼Œæ¯ä¸ªä¸»&#x2F;ä»è¿æ¥æœ‰ä¸‰ä¸ªçº¿ç¨‹ã€‚ä¸»æœåŠ¡å™¨ä¸ºæ¯ä¸ªå½“å‰è¿æ¥çš„ä»æœåŠ¡å™¨åˆ›å»ºä¸€ä¸ªäºŒè¿›åˆ¶æ—¥å¿—è½¬å‚¨çº¿ç¨‹ï¼Œæ¯ä¸ªä»æœåŠ¡å™¨éƒ½æœ‰è‡ªå·±çš„I&#x2F;Oå’ŒSQLçº¿ç¨‹ã€‚ä»æœåŠ¡å™¨ä½¿ç”¨ä¸¤ä¸ªçº¿ç¨‹å°†è¯»å–æ›´æ–°ä¸ä¸»æœåŠ¡å™¨æ›´æ–°äº‹ä»¶ï¼Œå¹¶å°†å…¶æ‰§è¡Œä¸ºç‹¬ç«‹ä»»åŠ¡ã€‚å› æ­¤ï¼Œå¦‚æœè¯­å¥æ‰§è¡Œç¼“æ…¢ï¼Œåˆ™è¯»å–è¯­å¥çš„ä»»åŠ¡ä¸ä¼šå‡æ…¢ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä»æœåŠ¡å™¨å¼€å§‹å‡ åˆ†é’Ÿæ²¡æœ‰è¿è¡Œï¼Œæˆ–è€…å³ä½¿SQLçº¿ç¨‹è¿œè¿œè½åï¼Œå®ƒçš„I&#x2F;Oçº¿ç¨‹ä¹Ÿå¯ä»¥ä»ä¸»æœåŠ¡å™¨å»ºç«‹è¿æ¥æ—¶ï¼Œå¿«é€Ÿè·å–æ‰€æœ‰äºŒè¿›åˆ¶æ—¥å¿—å†…å®¹ã€‚ å¦‚æœä»æœåŠ¡å™¨åœ¨SQLçº¿ç¨‹æ‰§è¡Œæ‰€æœ‰è·å–çš„è¯­å¥ä¹‹å‰åœæ­¢ï¼Œåˆ™I&#x2F;Oçº¿ç¨‹è‡³å°‘è·å–å·²ç»è¯»å–åˆ°çš„å†…å®¹ï¼Œä»¥ä¾¿å°†è¯­å¥çš„å®‰å…¨å‰¯æœ¬å­˜å‚¨åœ¨è‡ªå·±çš„äºŒçº§åˆ¶æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œå‡†å¤‡ä¸‹æ¬¡æ‰§è¡Œä¸»ä»æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œç»§ç»­åŒæ­¥ã€‚ ä½¿ç”¨å‘½ä»¤ SHOW PROCESSLIST\\G å¯ä»¥æŸ¥çœ‹æœ‰å…³å¤åˆ¶çš„ä¿¡æ¯ å‘½ä»¤ SHOW FULL PROCESSLISTG åœ¨ Master ä¸»æœåŠ¡å™¨ æ‰§è¡Œçš„æ•°æ®ç¤ºä¾‹ Id: 22æ˜¯Binlog DumpæœåŠ¡è¿æ¥çš„ä»ç«™çš„å¤åˆ¶çº¿ç¨‹Host: node2:39114 æ˜¯ä»æœåŠ¡ï¼Œä¸»æœºå çº§åŠç«¯å£State: ä¿¡æ¯è¡¨ç¤ºæ‰€æœ‰æ›´æ–°éƒ½å·²åŒæ­¥å‘é€åˆ°ä»æœåŠ¡å™¨ï¼Œå¹¶ä¸”ä¸»æœåŠ¡å™¨æ­£åœ¨ç­‰å¾…æ›´å¤šæ›´æ–°å‘ç”Ÿã€‚å¦‚æœBinlog Dumpåœ¨ä¸»æœåŠ¡å™¨ä¸Šçœ‹ä¸åˆ° çº¿ç¨‹ï¼Œæ„å‘³ç€ä¸»ä»å¤åˆ¶æ²¡æœ‰é…ç½®æˆåŠŸ; ä¹Ÿå°±æ˜¯è¯´ï¼Œæ²¡æœ‰ä»æœåŠ¡å™¨è¿æ¥ä¸»æœåŠ¡å™¨ã€‚ å‘½ä»¤ SHOW PROCESSLISTG åœ¨ Slave ä»æœåŠ¡å™¨ ï¼ŒæŸ¥çœ‹ä¸¤ä¸ªçº¿ç¨‹çš„æ›´æ–°çŠ¶æ€ Id: 6æ˜¯ä¸ä¸»æœåŠ¡å™¨é€šä¿¡çš„I&#x2F;Oçº¿ç¨‹Id: 7æ˜¯æ­£åœ¨å¤„ç†å­˜å‚¨åœ¨ä¸­ç»§æ—¥å¿—ä¸­çš„æ›´æ–°çš„SQLçº¿ç¨‹ åœ¨ è¿è¡Œ SHOW PROCESSLIST å‘½ä»¤æ—¶ï¼Œä¸¤ä¸ªçº¿ç¨‹éƒ½ç©ºé—²ï¼Œç­‰å¾…è¿›ä¸€æ­¥æ›´æ–° å¦‚æœåœ¨ä¸»æœåŠ¡å™¨ä¸Šåœ¨è®¾ç½®çš„è¶…æ—¶ï¼Œæ—¶é—´å†… Binlog Dumpçº¿ç¨‹æ²¡æœ‰æ´»åŠ¨ï¼Œåˆ™ä¸»æœåŠ¡å™¨ä¼šå’Œä»æœåŠ¡å™¨æ–­å¼€è¿æ¥ã€‚è¶…æ—¶å–å†³äºçš„ æœåŠ¡å™¨ç³»ç»Ÿå˜é‡ å€¼ net_write_timeout(åœ¨ä¸­æ­¢å†™å…¥ä¹‹å‰ç­‰å¾…å—å†™å…¥è¿æ¥çš„ç§’æ•°ï¼Œé»˜è®¤10ç§’)å’Œ net_retry_count;(å¦‚æœé€šä¿¡ç«¯å£ä¸Šçš„è¯»å–æˆ–å†™å…¥ä¸­æ–­ï¼Œè¯·åœ¨é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤10æ¬¡) è®¾ç½® æœåŠ¡å™¨ç³»ç»Ÿå˜é‡ è¯¥SHOW SLAVE STATUSè¯­å¥æä¾›äº†æœ‰å…³ä»æœåŠ¡å™¨ä¸Šå¤åˆ¶å¤„ç†çš„é™„åŠ ä¿¡æ¯ã€‚è¯·å‚è§ ç¬¬16.1.7.1èŠ‚â€œæ£€æŸ¥å¤åˆ¶çŠ¶æ€â€ã€‚ å¸¸è§ä¸»ä»å¤åˆ¶é—®é¢˜å®˜æ–¹æ–‡æ¡£å¸¸è§é—®é¢˜ æè¿°msyql replication æœºåˆ¶çš„å®ç°åŸç†ï¼Œå¦‚ä½•åœ¨ä¸åœæ‰mysqlä¸»åº“çš„æƒ…å†µä¸‹ï¼Œæ¢å¤æ•°æ®ä¸ä¸€è‡´çš„slaveçš„æ•°æ®åº“èŠ‚ç‚¹ï¼ŸMySQLçš„å¤åˆ¶ï¼ˆreplicationï¼‰æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„å¤åˆ¶ï¼Œä»ä¸€ä¸ªMySQL instaceï¼ˆç§°ä¹‹ä¸ºMasterï¼‰å¤åˆ¶åˆ°å¦ä¸€ä¸ªMySQL instanceï¼ˆç§°ä¹‹Slaveï¼‰ã€‚å®ç°æ•´ä¸ªå¤åˆ¶æ“ä½œä¸»è¦ç”±ä¸‰ä¸ªè¿›ç¨‹å®Œæˆçš„ï¼Œå…¶ä¸­ä¸¤ä¸ªè¿›ç¨‹åœ¨Slaveï¼ˆSqlè¿›ç¨‹å’ŒIOè¿›ç¨‹ï¼‰ï¼Œå¦å¤–ä¸€ä¸ªè¿›ç¨‹åœ¨Masterï¼ˆIOè¿›ç¨‹ï¼‰ä¸Šã€‚ å¼•ç”¨æ–°æµªæŸä½å¤§ç‰›çš„è¯ï¼šmysqlå¤åˆ¶å°±æ˜¯ä¸€å¥è¯ï¼šåŸºäºbinlogçš„å•çº¿ç¨‹å¼‚æ­¥å¤åˆ¶è¿‡ç¨‹ã€‚MySQL Replicationå¤åˆ¶çš„åŸºæœ¬è¿‡ç¨‹å¦‚ä¸‹ï¼š1ã€Slaveä¸Šé¢çš„IOè¿›ç¨‹è¿æ¥ä¸ŠMasterï¼Œå¹¶è¯·æ±‚ä»æŒ‡å®šæ—¥å¿—æ–‡ä»¶çš„æŒ‡å®šä½ç½®ï¼ˆæˆ–è€…ä»æœ€å¼€å§‹çš„æ—¥å¿—ï¼‰ä¹‹åçš„æ—¥å¿—å†…å®¹ï¼› ä»£ç å¦‚ä¸‹: 2ã€Masteræ¥æ”¶åˆ°æ¥è‡ªSlaveçš„IOè¿›ç¨‹çš„è¯·æ±‚åï¼Œé€šè¿‡è´Ÿè´£å¤åˆ¶çš„IOè¿›ç¨‹æ ¹æ®è¯·æ±‚ä¿¡æ¯è¯»å–åˆ¶å®šæ—¥å¿—æŒ‡å®šä½ç½®ä¹‹åçš„æ—¥å¿—ä¿¡æ¯ï¼Œè¿”å›ç»™Slaveçš„IOè¿›ç¨‹ã€‚è¿”å›ä¿¡æ¯ä¸­é™¤äº†æ—¥å¿—æ‰€åŒ…å«çš„ä¿¡æ¯ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬æœ¬æ¬¡è¿”å›çš„ä¿¡æ¯å·²ç»åˆ°Masterç«¯çš„bin-logæ–‡ä»¶çš„åç§°ä»¥åŠbin-logçš„ä½ç½®ï¼› 3ã€Slaveçš„IOè¿›ç¨‹æ¥æ”¶åˆ°ä¿¡æ¯åï¼Œå°†æ¥æ”¶åˆ°çš„æ—¥å¿—å†…å®¹ä¾æ¬¡æ·»åŠ åˆ°Slaveç«¯çš„relay-logæ–‡ä»¶çš„æœ€æœ«ç«¯ï¼Œå¹¶å°†è¯»å–åˆ°çš„Masterç«¯çš„bin-logçš„æ–‡ä»¶åå’Œä½ç½®è®°å½•åˆ°master-infoæ–‡ä»¶ä¸­ï¼Œä»¥ä¾¿åœ¨ä¸‹ä¸€æ¬¡è¯»å–çš„æ—¶å€™èƒ½å¤Ÿæ¸…æ¥šçš„é«˜é€ŸMasterâ€œæˆ‘éœ€è¦ä»æŸä¸ªbin-logçš„å“ªä¸ªä½ç½®å¼€å§‹å¾€åçš„æ—¥å¿—å†…å®¹ï¼Œè¯·å‘ç»™æˆ‘â€ï¼› 4ã€Slaveçš„Sqlè¿›ç¨‹æ£€æµ‹åˆ°relay-logä¸­æ–°å¢åŠ äº†å†…å®¹åï¼Œä¼šé©¬ä¸Šè§£ærelay-logçš„å†…å®¹æˆä¸ºåœ¨Masterç«¯çœŸå®æ‰§è¡Œæ—¶å€™çš„é‚£äº›å¯æ‰§è¡Œçš„å†…å®¹ï¼Œå¹¶åœ¨è‡ªèº«æ‰§è¡Œ æ“ä½œè¿‡ç¨‹ï¼šï¼ˆ1ï¼‰ç™»é™†ä¸»æœåŠ¡å™¨ï¼ŒæŸ¥çœ‹ä¸»æœåŠ¡å™¨çš„çŠ¶æ€mysql>show master statusï¼›æ‰¾åˆ°ç°é˜¶æ®µmasterçš„æ•°æ®åç§»é‡çš„å€¼ã€‚ ï¼ˆ2ï¼‰ç™»é™†ä»æœåŠ¡å™¨ï¼Œæ‰§è¡ŒåŒæ­¥æ“ä½œã€‚mysql>stop slave;mysql > change master to ç›´æ¥å®šä½åˆ°è¿™ä¸ªå€¼å¾—ä½ç½®ï¼› è¿™é‡Œä¹Ÿå°±ç›¸å½“äºç»™slaveæŒ‡æ˜äº†ç›¸åº”çš„ä½ç½®ã€‚mysql > start slave; ï¼ˆ3ï¼‰ä»æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹çŠ¶æ€mysql > show slave status","date":"2024-12-31","categories":["mysql"]},{"title":"mysqlæ•°æ®åº“æ‹†åˆ†-å†·çƒ­åº“","url":"/2024/12/31/mysqlæ•°æ®åº“æ‹†åˆ†-å†·çƒ­åº“/","content":"æ¦‚å¿µå†·çƒ­åº“å…¶å®æ˜¯mysqlæ•°æ®åº“è¿›è¡Œæ‹†åˆ†çš„ä¸€ç§æ–¹æ³•,æ ¸å¿ƒæ€æƒ³æ˜¯å°†çƒ­ç‚¹æ•°æ®å’Œå†å²æ•°æ®åˆ†ç¦» æ‹†åˆ†åŸåˆ™æˆ‘ä»¬ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼æ¥åŒºåˆ†å†·çƒ­æ•°æ®ï¼š æŒ‰æ•°æ®åˆ›å»ºæ—¶é—´ï¼šä¸€èˆ¬æƒ…å†µæˆ‘ä»¬ä¼šä½¿ç”¨æ•°æ®çš„åˆ›å»ºæ—¶é—´æ¥åŒºåˆ†æ•°æ®å†·çƒ­ï¼ŒæŒ‰å¸¸ç†è¯´è¶Šä¹…æ—¶é—´å‰åˆ›å»ºçš„æ•°æ®è®¿é—®è¶Šå°‘ï¼Œè¿™å¯¹äºäº¤æ˜“ç±»æ•°æ®å¾ˆæ˜æ˜¾ï¼Œå¾ˆå¯èƒ½ä¸€å‘¨å†…æŸç¬”äº¤æ˜“ä¼šè¢«é¢‘ç¹æŸ¥è¯¢ï¼Œä¸€ä¸ªæœˆå†…ä¹Ÿè®¸åªæ˜¯å¶å°”æŸ¥è¯¢ï¼Œä¸‰ä¸ªæœˆåå¯èƒ½åœ¨æå¶ç„¶çš„æƒ…å†µä¸‹æ‰ä¼šè¢«ç”¨åˆ°ï¼Œæœ‰å¯èƒ½ç»å¤§å¤šæ•°æ•°æ®åœ¨å‡ ä¸ªæœˆåå†ä¹Ÿä¸ä¼šè¢«è®¿é—®åˆ°ã€‚ æŒ‰è®¿é—®çƒ­åº¦ï¼šæœ‰äº›æ•°æ®è®¿é—®é¢‘åº¦å¹¶éæŒ‰æ—¶é—´ï¼Œæ¯”å¦‚æŸä¸ªçƒ­é—¨æ–‡ç« ä¹Ÿè®¸å‘è¡¨ä¸€å¹´ä¹‹åè¿˜ä¼šæœ‰å¤§é‡çš„äººè®¿é—®ï¼Œæ–°å‘è¡¨çš„æ–‡ç« åè€Œå¾ˆå°‘æœ‰äººæµè§ˆã€‚æˆ–è€…æŸä¸ªäº‹ä»¶ä¼šå¼•å‘æŸäº›å¾ˆå°‘é˜…è¯»çš„æ–‡ç« æˆ–è€…ä¿¡æ¯åœ¨æŸä¸€ä¸ªæ—¶é—´æ®µçªç„¶å¤§é‡çš„è¢«è®¿é—®åˆ°ï¼Œè¿™æ ·å†·æ•°æ®ä¹Ÿä¼šå˜æˆçƒ­æ•°æ®ã€‚è¿™ä¸ªæ—¶å€™å†æŒ‰æ—¶é—´åŒºåˆ†å°±ä¸ç§‘å­¦äº†ï¼Œéœ€è¦æŒ‰ä¸šåŠ¡æƒ…å†µã€æ•°æ®è§„å¾‹æ¥åŒºåˆ†å†·çƒ­ã€‚","date":"2024-12-31","categories":["mysql"]},{"title":"nginx-locationæ˜ å°„åœ°å€","url":"/2024/12/31/nginx-locationæ˜ å°„åœ°å€/","content":"nginxæ˜¯ä¸€ä¸ªéå¸¸æ£’çš„webä»£ç†æœåŠ¡å™¨ï¼Œ è¿™é‡Œè®°å½•ä¸€ä¸‹nginx ä½¿ç”¨localtionå­—æ®µï¼Œæ¥è¿›è¡Œè®¿é—®æ§åˆ¶çš„å¤„ç†æ–¹æ³• locationåŒ¹é…é¡ºåº â€œ&#x3D;â€å‰ç¼€æŒ‡ä»¤åŒ¹é…ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œåˆ™åœæ­¢å…¶ä»–åŒ¹é… æ™®é€šå­—ç¬¦ä¸²æŒ‡ä»¤åŒ¹é…ï¼Œé¡ºåºæ˜¯ä»é•¿åˆ°çŸ­ï¼ŒåŒ¹é…æˆåŠŸçš„locationå¦‚æœä½¿ç”¨^~ï¼Œåˆ™åœæ­¢å…¶ä»–åŒ¹é…ï¼ˆæ­£åˆ™åŒ¹é…ï¼‰ æ­£åˆ™è¡¨è¾¾å¼æŒ‡ä»¤åŒ¹é…ï¼ŒæŒ‰ç…§é…ç½®æ–‡ä»¶é‡Œçš„é¡ºåºï¼ŒæˆåŠŸå°±åœæ­¢å…¶ä»–åŒ¹é… å¦‚æœç¬¬ä¸‰æ­¥ä¸­æœ‰åŒ¹é…æˆåŠŸï¼Œåˆ™ä½¿ç”¨è¯¥ç»“æœï¼Œå¦åˆ™ä½¿ç”¨ç¬¬äºŒæ­¥ç»“æœ æ³¨æ„ç‚¹ åŒ¹é…çš„é¡ºåºæ˜¯å…ˆåŒ¹é…æ™®é€šå­—ç¬¦ä¸²ï¼Œç„¶åå†åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ã€‚å¦å¤–æ™®é€šå­—ç¬¦ä¸²åŒ¹é…é¡ºåºæ˜¯æ ¹æ®é…ç½®ä¸­å­—ç¬¦é•¿åº¦ä»é•¿åˆ°çŸ­ï¼Œä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨æ™®é€šå­—ç¬¦ä¸²é…ç½®çš„locationé¡ºåºæ˜¯æ— å…³ç´§è¦çš„ï¼Œåæ­£æœ€ånginxä¼šæ ¹æ®é…ç½®çš„é•¿çŸ­æ¥è¿›è¡ŒåŒ¹é…ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼æŒ‰ç…§é…ç½®æ–‡ä»¶é‡Œçš„é¡ºåºæµ‹è¯•ã€‚æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ¯”é…çš„æ­£åˆ™è¡¨è¾¾å¼å°†åœæ­¢æœç´¢ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒåŒ¹é…æˆåŠŸäº†æ™®é€šå­—ç¬¦ä¸²locationåè¿˜ä¼šè¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼locationåŒ¹é…ã€‚æœ‰ä¸¤ç§æ–¹æ³•æ”¹å˜è¿™ç§è¡Œä¸ºï¼Œå…¶ä¸€å°±æ˜¯ä½¿ç”¨â€œ&#x3D;â€å‰ç¼€ï¼Œè¿™æ—¶æ‰§è¡Œçš„æ˜¯ä¸¥æ ¼åŒ¹é…ï¼Œå¹¶ä¸”åŒ¹é…æˆåŠŸåç«‹å³åœæ­¢å…¶ä»–åŒ¹é…ï¼ŒåŒæ—¶å¤„ç†è¿™ä¸ªè¯·æ±‚ï¼›å¦å¤–ä¸€ç§å°±æ˜¯ä½¿ç”¨â€œ^~â€å‰ç¼€ï¼Œå¦‚æœæŠŠè¿™ä¸ªå‰ç¼€ç”¨äºä¸€ä¸ªå¸¸è§„å­—ç¬¦ä¸²é‚£ä¹ˆå‘Šè¯‰nginx å¦‚æœè·¯å¾„åŒ¹é…é‚£ä¹ˆä¸æµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼ã€‚ åŒ¹é…æ¨¡å¼åŠé¡ºåº location &#x3D; &#x2F;uri &#x3D;å¼€å¤´è¡¨ç¤ºç²¾ç¡®åŒ¹é…ï¼Œåªæœ‰å®Œå…¨åŒ¹é…ä¸Šæ‰èƒ½ç”Ÿæ•ˆã€‚ location ^~ &#x2F;uri ^~ å¼€å¤´å¯¹URLè·¯å¾„è¿›è¡Œå‰ç¼€åŒ¹é…ï¼Œå¹¶ä¸”åœ¨æ­£åˆ™ä¹‹å‰ã€‚ location ~ pattern ~å¼€å¤´è¡¨ç¤ºåŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…ã€‚ location ~* pattern ~*å¼€å¤´è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…ã€‚ location &#x2F;uri ä¸å¸¦ä»»ä½•ä¿®é¥°ç¬¦ï¼Œä¹Ÿè¡¨ç¤ºå‰ç¼€åŒ¹é…ï¼Œä½†æ˜¯åœ¨æ­£åˆ™åŒ¹é…ä¹‹åã€‚ location &#x2F; é€šç”¨åŒ¹é…ï¼Œä»»ä½•æœªåŒ¹é…åˆ°å…¶å®ƒlocationçš„è¯·æ±‚éƒ½ä¼šåŒ¹é…åˆ°ï¼Œç›¸å½“äºswitchä¸­çš„defaultã€‚ locationä¸­çš„root å’Œaliasnginxçš„locationä¸­çš„rootå’Œalias è‹¥æŒ‰ç…§ä¸Šè¿°é…ç½®çš„è¯ï¼Œåˆ™è®¿é—®&#x2F;img&#x2F;ç›®å½•é‡Œé¢çš„æ–‡ä»¶æ—¶ï¼Œningxä¼šè‡ªåŠ¨å»&#x2F;var&#x2F;www&#x2F;image&#x2F;ç›®å½•æ‰¾æ–‡ä»¶ è‹¥æŒ‰ç…§è¿™ç§é…ç½®çš„è¯ï¼Œåˆ™è®¿é—®&#x2F;img&#x2F;ç›®å½•ä¸‹çš„æ–‡ä»¶æ—¶ï¼Œnginxä¼šå»&#x2F;var&#x2F;www&#x2F;image&#x2F;img&#x2F;ç›®å½•ä¸‹æ‰¾æ–‡ä»¶ ä¸¾ä¸€ä¸ªä¾‹å­å¦‚æœæˆ‘æƒ³æŠŠ127.0.0.1&#x2F;item ç›®å½•æ˜ å°„åˆ° &#x2F;user&#x2F;share&#x2F;htmlè·¯å¾„ä¸‹ï¼Œæˆ‘åªéœ€è¦è¿™ä¹ˆé…ç½®çš†å¯ä»¥äº†","date":"2024-12-31","categories":["nginx"]},{"title":"postgresql-å­¦ä¹ è®°å½•(1)","url":"/2024/12/31/postgresql-å­¦ä¹ è®°å½•-1-/","content":"postgresqlå­¦ä¹ è®°å½•ï¼ˆä¸€ï¼‰ä¸€.åˆæ¢postgresqlPostgreSQLæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å¼€æºå¯¹è±¡å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ(ORDBMS)ã€‚ ç”¨äºå®‰å…¨åœ°å­˜å‚¨æ•°æ®; æ”¯æŒæœ€ä½³åšæ³•ï¼Œå¹¶å…è®¸åœ¨å¤„ç†è¯·æ±‚æ—¶æ£€ç´¢å®ƒä»¬ã€‚PostgreSQL(ä¹Ÿç§°ä¸ºPost-gress-Q-L)ç”±PostgreSQLå…¨çƒå¼€å‘é›†å›¢(å…¨çƒå¿—æ„¿è€…å›¢é˜Ÿ)å¼€å‘ã€‚ å®ƒä¸å—ä»»ä½•å…¬å¸æˆ–å…¶ä»–ç§äººå®ä½“æ§åˆ¶ã€‚ å®ƒæ˜¯å¼€æºçš„ï¼Œå…¶æºä»£ç æ˜¯å…è´¹æä¾›çš„ã€‚ äºŒ.è¸©å‘postgresqlçš„å®‰è£…å•çº¯çš„å®‰è£…postgresqlæ˜¯éå¸¸å®¹æ˜“çš„æ‰“å¼€å®˜ç½‘æŒ‰ç…§æ•™ç¨‹å°±å¯ä»¥å¾ˆå®¹æ˜“çš„å®‰è£…ä¸Šå» åœ¨ &#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;pgdg.list æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹çš„è¯­å¥æ³¨æ„è¦é€‰æ‹©é€‚åˆè‡ªå·±ç³»ç»Ÿçš„ç‰ˆæœ¬,å…·ä½“è¦æ±‚çœ‹postgresqlçš„å®˜æ–¹ç½‘ç«™ è¿è¡Œå‘½ä»¤å¼€å§‹å®‰è£… ä¸‰.ä¸ºpostgresqlæ·»åŠ æ–°çš„ç”¨æˆ·å¹¶ä¸”å¼€å¯è¿œç¨‹ç™»å…¥çš„æƒé™postgresqlå’Œmysqlæœ‰ä¸€äº›å·®åˆ«,è¦æƒ³å¼€å¯è¿œç¨‹ç™»å…¥æƒé™éœ€è¦ä¿®æ”¹ä¸¤ä¸ªæ–‡ä»¶ è¾“å…¥ vi postgresql.conf ä¿®æ”¹pistgresql.confæ–‡ä»¶ ç¼–è¾‘å…¶ä¸­çš„listen_addresses å­—æ®µ å°†åŸæ¥çš„listen_addresses &#x3D; â€˜localhostâ€™ä¿®æ”¹ä¸ºlisten_addresses &#x3D; â€˜*â€™ ä¿®æ”¹æ•´ä¸ªæ–‡ä»¶å˜æˆå¦‚ä¸Šçš„æ ·å­:è¯´æ˜ä¸€ä¸‹,local è¡¨ç¤ºæœ¬åœ°ç™»å…¥çš„æƒé™ä½¿ç”¨peerè®¤è¯(æœ¬æœºä½¿ç”¨unix socketè®¤è¯:æ³¨æ„åœ¨è¿™ç§æ¨¡å¼ä¸‹,linuxç³»ç»Ÿå¿…é¡»åˆ‡æ¢åˆ°ç›¸åº”çš„ç”¨æˆ·ä¸­æ‰è¡Œ,è¿™æ ·å°±ä¸éœ€è¦ä½¿ç”¨å¯†ç è¿›è¡Œç™»å…¥äº†),hostå¤–ç½‘ä½¿ç”¨çš„æ˜¯md5è®¤è¯(å¢åŠ å®‰å…¨æƒé™)å…·ä½“ä¸ºä»€ä¹ˆè¦çœ‹ä¸€ä¸‹å…¶ä»–çš„ä¸œè¥¿:http://hi-kys.me/?p=361 é’ˆå¯¹å®‰å…¨æ€§ä¸ºpostgresqlæ·»åŠ ä¸€ä¸ªæ–°çš„ç”¨æˆ·åœ¨ä¸Šé¢çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬å·²å°†ä½¿ç”¨äº†peerè®¤è¯æ–¹æ³•å£°æ˜äº†æ‰€æœ‰çš„ç”¨æˆ·,ä¹Ÿå°±æ˜¯è¯´åªè¦linuxç³»ç»Ÿä¸­æ‹¥æœ‰å’Œpostgresqlç›¸åŒåç§°çš„ç”¨æˆ·,é‚£ä¹ˆå°†linuxåˆ‡æ¢åˆ°è¿™ä¸ªç”¨æˆ·ä¸­å°†å¯ä»¥ä¸ä½¿ç”¨å¯†ç è¿›è¡Œç™»å…¥æ•°æ®çš„æ“ä½œç¬¬ä¸€æ¬¡ä½¿ç”¨postgresqlé¦–å…ˆåˆ‡æ¢linuxç”¨æˆ· ç›´æ¥ç™»å…¥åˆ°æ•°æ®åº“ä¸­ ä»¥ä¸Šä¸¤æ­¥å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‘½ä»¤è§£å†³ åˆ›å»ºæ–°çš„ç”¨æˆ·å¹¶è®¾ç½®å¯†ç  æˆ–è€…ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ å¼•ç”³:userå’Œroleçš„åŒºåˆ«å°±æ˜¯roleæ²¡æœ‰ç™»å…¥æƒé™è€Œuseræ‹¥æœ‰ç™»å…¥æƒé™åˆ›å»ºä¸€ä¸ªæ•°æ®åº“å¹¶å…³è”åˆ°å½“å‰çš„ç”¨æˆ·ä¸Š ä»˜ç»™è¿™ä¸ªæ–°ç”¨æˆ·å…¨éƒ¨çš„æƒé™(è¿™é‡Œåªæ˜¯åšå¼€å‘ä¸è€ƒè™‘è¿›è¡Œæƒé™ç®¡ç†) ä½¿ç”¨\\duå‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹ \\qé€€å‡º æµ‹è¯•ä¸€ä¸‹ä½¿ç”¨å‘½ä»¤ æˆ–è€…ä½¿ç”¨å›¾å½¢å·¥å…·è¿›è¡Œè¿æ¥ç™»å…¥æˆåŠŸè¯æ˜é…ç½®æ­£ç¡®","date":"2024-12-31","categories":["postgresql"]},{"title":"postgresql-å­¦ä¹ è®°å½•(2)-postgresqlç”¨æˆ·æƒé™è§£æ","url":"/2024/12/31/postgresql-å­¦ä¹ è®°å½•-2--postgresqlç”¨æˆ·æƒé™è§£æ/","content":"postgresqlå­¦ä¹ è®°å½•(äºŒ)-postgresqlç”¨æˆ·æƒé™è§£æPostgreSQLæ”¯æŒçš„è®¤è¯æ–¹æ³•éå¸¸å¤šï¼Œé™¤äº†è‡ªèº«çš„å¯†ç è®¤è¯ä»¥å¤–ï¼Œè¿˜æ”¯æŒå¾ˆå¤šå…¶ä»–è®¤è¯æœåŠ¡ã€‚ è¯¦è§ https://www.postgresql.org/docs/9.6/static/auth-methods.htmlè¿™é‡Œä¸»è¦ä»‹ç»ä¸€ä¸‹identå’Œpeerç›¸å…³çš„å‘ident è®¤è¯ï¼Œå®¢æˆ·ç«¯å’Œæ•°æ®åº“å»ºç«‹TCPä¼šè¯åï¼ˆå‡è®¾ä¼šè¯çš„è¿æ¥ä¿¡æ¯æ˜¯client_ip:12345 <-> db_ip:5432ï¼‰ï¼Œæ•°æ®åº“é€šè¿‡identåè®®è¯¢é—®å®¢æˆ·ç«¯æ‰€åœ¨IPåœ°å€çš„ident server (é»˜è®¤æ˜¯113ç›‘å¬ç«¯å£)ï¼Œè¯¢é—®å†…å®¹ï¼šä½¿ç”¨client_ip:12345ç«¯å£è¿æ¥db_ip:5432çš„æ“ä½œç³»ç»Ÿç”¨æˆ·æ˜¯è°ï¼Ÿ å¦‚å›¾: åœ¨è·å–åˆ°å®¢æˆ·ç«¯çš„OSç”¨æˆ·åä¹‹åï¼ŒPostgreSQLä¼šé€šè¿‡pg_hba.confä¸­é…ç½®çš„mapåä¸pg_ident.confä¸­é…ç½®çš„æ˜ å°„å…³ç³»ï¼Œä»¥åŠå®¢æˆ·ç«¯æä¾›çš„æ•°æ®åº“ç”¨æˆ·åï¼Œåˆ¤æ–­æ˜¯å¦å…è®¸ç™»é™†æ•°æ®åº“ã€‚å¦‚å›¾ è¿™é‡Œçš„peerç›¸å…³çš„ä¸œè¥¿è§£é‡Šäº†ä¸ºä»€ä¹ˆåœ¨ä¸Šä¸€ç¯‡ä¸­è¯´ä½¿ç”¨linuxçš„åŒåç”¨æˆ·å¯ä»¥ç™»å…¥postgresqlæ•°æ®åº“","date":"2024-12-31","categories":["postgresql"]},{"title":"redis-åˆ†å¸ƒå¼é”-rediså®ç°æ–¹æ³•","url":"/2024/12/31/redis-åˆ†å¸ƒå¼é”-rediså®ç°æ–¹æ³•/","content":"åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæœ‰çš„æ—¶å€™ä¼šå‘ç”Ÿå¤šä¸ªèŠ‚ç‚¹äº‰å¤ºèµ„æºï¼Œæˆ–è€…ä¸€ä¸ªä»»åŠ¡åªèƒ½ç”±ä¸€ä¸ªèŠ‚ç‚¹è§¦å‘ï¼ˆæ¯”å¦‚åˆ†å¸ƒå¼å®šæ—¶ä»»åŠ¡ç³»ç»Ÿï¼‰ï¼Œåœ¨è¿™ä¸ªæƒ…å†µä¸‹æˆ‘ä»¬å°±è¦ç”¨åˆ°åˆ†å¸ƒå¼é”äº†ï¼Œè¿™é‡Œä½¿ç”¨redis å®ç°åˆ†å¸ƒå¼é” åˆ†å¸ƒå¼é”ä¸€èˆ¬æœ‰ä¸‰ç§å®ç°æ–¹å¼ï¼š æ•°æ®åº“ä¹è§‚é”ï¼› åŸºäºRedisçš„åˆ†å¸ƒå¼é”ï¼› åŸºäºZooKeeperçš„åˆ†å¸ƒå¼é”ã€‚ è¿™é‡Œå‚è€ƒç½‘ä¸Šçš„ç›¸å…³çš„èµ„æ–™ï¼Œè®°å½•å¦‚ä½•æ­£ç¡®åœ°å®ç°Redisåˆ†å¸ƒå¼é”ã€‚ äº’æ–¥æ€§ã€‚åœ¨ä»»æ„æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯èƒ½æŒæœ‰é”ã€‚ ä¸ä¼šå‘ç”Ÿæ­»é”ã€‚å³ä½¿æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯åœ¨æŒæœ‰é”çš„æœŸé—´å´©æºƒè€Œæ²¡æœ‰ä¸»åŠ¨è§£é”ï¼Œä¹Ÿèƒ½ä¿è¯åç»­å…¶ä»–å®¢æˆ·ç«¯èƒ½åŠ é”ã€‚ å…·æœ‰å®¹é”™æ€§ã€‚åªè¦å¤§éƒ¨åˆ†çš„RedisèŠ‚ç‚¹æ­£å¸¸è¿è¡Œï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥åŠ é”å’Œè§£é”ã€‚ è§£é“ƒè¿˜é¡»ç³»é“ƒäººã€‚åŠ é”å’Œè§£é”å¿…é¡»æ˜¯åŒä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯è‡ªå·±ä¸èƒ½æŠŠåˆ«äººåŠ çš„é”ç»™è§£äº†ã€‚ ä»£ç å®ç°-æ­£ç¡®é”ä»£ç  ä»£ç åˆ†æ è¿™é‡Œä¸»è¦ä½¿ç”¨äº†ï¼Œredisçš„setå‘½ä»¤ï¼Œæ˜ å°„åˆ°jedisä¸­å°±æ˜¯setæ–¹æ³•ï¼Œæˆ‘ä»¬åŠ é”å°±ä¸€è¡Œä»£ç ï¼šjedis.set(String key, String value, String nxxx, String expx, int time)ï¼Œè¿™ä¸ªset()æ–¹æ³•ä¸€å…±æœ‰äº”ä¸ªå½¢å‚ï¼š ç¬¬ä¸€ä¸ªä¸ºkeyï¼Œæˆ‘ä»¬ä½¿ç”¨keyæ¥å½“é”ï¼Œå› ä¸ºkeyæ˜¯å”¯ä¸€çš„ã€‚ ç¬¬äºŒä¸ªä¸ºvalueï¼Œæˆ‘ä»¬ä¼ çš„æ˜¯requestIdï¼Œå¾ˆå¤šç«¥é‹å¯èƒ½ä¸æ˜ç™½ï¼Œæœ‰keyä½œä¸ºé”ä¸å°±å¤Ÿäº†å—ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨åˆ°valueï¼ŸåŸå› å°±æ˜¯æˆ‘ä»¬åœ¨ä¸Šé¢è®²åˆ°å¯é æ€§æ—¶ï¼Œåˆ†å¸ƒå¼é”è¦æ»¡è¶³ç¬¬å››ä¸ªæ¡ä»¶è§£é“ƒè¿˜é¡»ç³»é“ƒäººï¼Œé€šè¿‡ç»™valueèµ‹å€¼ä¸ºrequestIdï¼Œæˆ‘ä»¬å°±çŸ¥é“è¿™æŠŠé”æ˜¯å“ªä¸ªè¯·æ±‚åŠ çš„äº†ï¼Œåœ¨è§£é”çš„æ—¶å€™å°±å¯ä»¥æœ‰ä¾æ®ã€‚requestIdå¯ä»¥ä½¿ç”¨UUID.randomUUID().toString()æ–¹æ³•ç”Ÿæˆã€‚ ç¬¬ä¸‰ä¸ªä¸ºnxxxï¼Œè¿™ä¸ªå‚æ•°æˆ‘ä»¬å¡«çš„æ˜¯NXï¼Œæ„æ€æ˜¯SET IF NOT EXISTï¼Œå³å½“keyä¸å­˜åœ¨æ—¶ï¼Œæˆ‘ä»¬è¿›è¡Œsetæ“ä½œï¼›è‹¥keyå·²ç»å­˜åœ¨ï¼Œåˆ™ä¸åšä»»ä½•æ“ä½œï¼› ç¬¬å››ä¸ªä¸ºexpxï¼Œè¿™ä¸ªå‚æ•°æˆ‘ä»¬ä¼ çš„æ˜¯PXï¼Œæ„æ€æ˜¯æˆ‘ä»¬è¦ç»™è¿™ä¸ªkeyåŠ ä¸€ä¸ªè¿‡æœŸçš„è®¾ç½®ï¼Œå…·ä½“æ—¶é—´ç”±ç¬¬äº”ä¸ªå‚æ•°å†³å®šã€‚ ç¬¬äº”ä¸ªä¸ºtimeï¼Œä¸ç¬¬å››ä¸ªå‚æ•°ç›¸å‘¼åº”ï¼Œä»£è¡¨keyçš„è¿‡æœŸæ—¶é—´ã€‚ è¿™é‡Œé‡ç‚¹å°±æ˜¯ä½¿ç”¨äº†setæ–¹æ³•ï¼ŒåŒæ—¶è®¾ç½®äº†NXæ¨¡å¼ï¼ˆç›¸å½“äºsetNXï¼‰å’Œè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œä¿è¯äº†å”¯ä¸€æ€§çš„é—®é¢˜ åŠ é”é”™è¯¯ä¾‹å­åˆ†æ ä½¿ç”¨jedis.setnx()å’Œjedis.expire()ç»„åˆå®ç°åŠ é” é”™è¯¯ç‚¹æ˜¯æ²¡æœ‰è€ƒè™‘åˆ°åŸå­æ€§çš„é—®é¢˜ï¼Œå½“ä½¿ç”¨jedis.setNX(xxx,xxx)ä¹‹åï¼Œå¦‚æœæœåŠ¡å™¨å‘ç”Ÿå´©æºƒå°†ä¼šå¯¼è‡´jedis.expire(xxx,xxxx)ä¸å†è¿è¡Œï¼Œå°†ä¼šå¯¼è‡´æ­»é”â€”â€“åšç³»ç»Ÿä¸€å®šè¦è€ƒè™‘åˆ°åŸå­æ€§çš„é—®é¢˜ ä½¿ç”¨valueä½œä¸ºåˆ¤æ–­è¶…æ—¶æ—¶é—´çš„ä¾æ® åˆ†æï¼šé—®é¢˜åœ¨è¿™é‡Œ 1. ç”±äºæ˜¯å®¢æˆ·ç«¯è‡ªå·±ç”Ÿæˆè¿‡æœŸæ—¶é—´ï¼Œæ‰€ä»¥éœ€è¦å¼ºåˆ¶è¦æ±‚åˆ†å¸ƒå¼ä¸‹æ¯ä¸ªå®¢æˆ·ç«¯çš„æ—¶é—´å¿…é¡»åŒæ­¥ã€‚ 2. å½“é”è¿‡æœŸçš„æ—¶å€™ï¼Œå¦‚æœå¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶æ‰§è¡Œjedis.getSet()æ–¹æ³•ï¼Œé‚£ä¹ˆè™½ç„¶æœ€ç»ˆåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯å¯ä»¥åŠ é”ï¼Œä½†æ˜¯è¿™ä¸ªå®¢æˆ·ç«¯çš„é”çš„è¿‡æœŸæ—¶é—´å¯èƒ½è¢«å…¶ä»–å®¢æˆ·ç«¯è¦†ç›–ã€‚3. é”ä¸å…·å¤‡æ‹¥æœ‰è€…æ ‡è¯†ï¼Œå³ä»»ä½•å®¢æˆ·ç«¯éƒ½å¯ä»¥è§£é”ã€‚ ä»£ç å®ç°-æ­£ç¡®è§£é”ä»£ç  åˆ†æï¼šæˆ‘ä»¬å°†Luaä»£ç ä¼ åˆ°jedis.eval()æ–¹æ³•é‡Œï¼Œå¹¶ä½¿å‚æ•°KEYS[1]èµ‹å€¼ä¸ºlockKeyï¼ŒARGV[1]èµ‹å€¼ä¸ºrequestIdã€‚eval()æ–¹æ³•æ˜¯å°†Luaä»£ç äº¤ç»™RedisæœåŠ¡ç«¯æ‰§è¡Œã€‚æºäºRedisçš„ç‰¹æ€§ï¼Œevalå‘½ä»¤è¿è¡Œluaä»£ç å¯ä»¥ä¿è¯åŸå­æ€§ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯åœ¨evalå‘½ä»¤æ‰§è¡ŒLuaä»£ç çš„æ—¶å€™ï¼ŒLuaä»£ç å°†è¢«å½“æˆä¸€ä¸ªå‘½ä»¤å»æ‰§è¡Œï¼Œå¹¶ä¸”ç›´åˆ°evalå‘½ä»¤æ‰§è¡Œå®Œæˆï¼ŒRedisæ‰ä¼šæ‰§è¡Œå…¶ä»–å‘½ä»¤ã€‚ è§£é”é”™è¯¯ä¾‹å­åˆ†æ ä¸åˆ¤æ–­è°èƒ½è§£é”-è¿ååŸåˆ™ ä¸ä¿è¯ä¸€åŸå­æ€§ï¼Œå¯èƒ½é€ æˆAè§£äº†Bçš„é”ï¼ˆæ¯”å¦‚Aè®¾ç½®äº†è¶…æ—¶æ—¶é—´ï¼Œå½“è¿è¡Œåˆ°åˆ¤æ–­çš„æ—¶å€™Aé”è¶…æ—¶å­—æ®µé‡Šæ”¾åŒæ—¶BåŠ é”äº†ï¼Œç„¶åAè¿è¡Œè¿›è¡Œè§£é”ï¼Œè§£çš„å°±æ˜¯Bçš„é”ï¼‰ æ€»ç»“ï¼šå¦‚æœä½ çš„é¡¹ç›®ä¸­Redisæ˜¯å¤šæœºéƒ¨ç½²çš„ï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•ä½¿ç”¨Redissonå®ç°åˆ†å¸ƒå¼é”ï¼Œè¿™æ˜¯Rediså®˜æ–¹æä¾›çš„Javaç»„ä»¶ã€‚åœ¨ä½¿ç”¨åˆ†å¸ƒå¼é”çš„æ—¶å€™ä¸€å®šè¦æ³¨æ„ä¹‹å‰è¯´çš„4ç§ç‰¹æ€§","date":"2024-12-31","categories":["redis"]},{"title":"redis-å‘½ä»¤-åŸºç¡€å‘½ä»¤","url":"/2024/12/31/redis-å‘½ä»¤-åŸºç¡€å‘½ä»¤/","content":"append æŒ‡å®škey çš„value å­—æ®µå¡«å……å­—ç¬¦çš„æ–¹æ³• è¯­æ³• append key add_value è¿™ä¸ªæ–¹æ³•æ—¶é—´å¤æ‚åº¦o(1) å¦‚æœkey ä¸å­˜åœ¨çš„æ—¶å€™å°†ä¼šå…ˆåˆ›å»ºkey value æ˜ å°„ valueä¸ºâ€â€ ç„¶åå†æ‰§è¡Œappend é€»è¾‘(redisåº•å±‚çš„å®ç°å¯èƒ½å¹¶ä¸æ˜¯è¿™æ ·çš„åªæ˜¯ä¸ºäº†æ–¹ä¾¿è®°å¿†) bitcount key start end é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†æ£€æŸ¥å­—ç¬¦ä¸²ä¸­åŒ…å«çš„æ‰€æœ‰å­—èŠ‚ã€‚å¯ä»¥ä»…åœ¨é€šè¿‡é™„åŠ å‚æ•°startå’Œendçš„é—´éš”ä¸­æŒ‡å®šè®¡æ•°æ“ä½œã€‚ ä¸GETRANGEå‘½ä»¤ä¸€æ ·ï¼Œstartå’Œendå¯ä»¥åŒ…å«è´Ÿå€¼ï¼Œä»¥ä¾¿ä»å­—ç¬¦ä¸²æœ«å°¾å¼€å§‹ç´¢å¼•å­—èŠ‚ï¼Œå…¶ä¸­-1æ˜¯æœ€åä¸€ä¸ªå­—èŠ‚ï¼Œ-2æ˜¯å€’æ•°ç¬¬äºŒä¸ªï¼Œä¾æ­¤ç±»æ¨ã€‚ ä¸å­˜åœ¨çš„é”®è¢«è§†ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œå› æ­¤è¯¥å‘½ä»¤å°†è¿”å›é›¶ã€‚ BITFIELD key [GET type offset] [SET type offset value] [INCRBY type offset increment] [OVERFLOW WRAP|SAT|FAIL] BITOP operation destkey key [key â€¦] BITPOS key bit [start] [end] BLPOP key [key â€¦] timeout é˜»å¡å‡ºé˜Ÿåˆ—æ–¹æ³•,è¿™æ–¹æ³•å°†ä¼šå¼¹å‡ºkeyè¿™ä¸ªåˆ—è¡¨ç¬¬ä¸€ä¸ªéç©ºå€¼,å¦‚æœkeyåˆ—è¡¨æ‰€æœ‰çš„éƒ½æ˜¯ç©ºçš„,ä¼šå°†è¯·æ±‚å µå¡ç›´åˆ°åˆ—è¡¨ä¸­å­˜åœ¨æ•°æ®,å¦‚æœè¶…è¿‡timeoutæ—¶é—´å°†ä¼šè¿”å›nil è¿”å›å€¼æ˜¯ä¸€ä¸ªåŒå…ƒç´ ä½“ 1) è¡¨ç¤ºä½¿ç”¨çš„åˆ—è¡¨ 2) è¡¨ç¤ºçš„å€¼ BRPOP key [key â€¦] timeout è¿™ä¸ªæ–¹æ³•æ˜¯BLPOPä»åˆ—è¡¨å°¾éƒ¨è·å–ä¿¡æ¯çš„å˜ä½“","date":"2024-12-31","categories":["redis"]},{"title":"redis-å‘½ä»¤-ç‰¹æ®Šå‘½ä»¤","url":"/2024/12/31/redis-å‘½ä»¤-ç‰¹æ®Šå‘½ä»¤/","content":"auth password è¯·æ±‚åœ¨å—å¯†ç ä¿æŠ¤çš„RedisæœåŠ¡å™¨ä¸­è¿›è¡Œèº«ä»½éªŒè¯ã€‚åœ¨å…è®¸å®¢æˆ·ç«¯æ‰§è¡Œå‘½ä»¤ä¹‹å‰ï¼Œå¯ä»¥æŒ‡ç¤ºRediséœ€è¦å¯†ç ã€‚è¿™æ˜¯ä½¿ç”¨requirepassé…ç½®æ–‡ä»¶ä¸­çš„æŒ‡ä»¤å®Œæˆçš„ã€‚å¦‚æœpasswordåŒ¹é…é…ç½®æ–‡ä»¶ä¸­çš„å¯†ç ï¼ŒæœåŠ¡å™¨å°†å›å¤OKçŠ¶æ€ä»£ç å¹¶å¼€å§‹æ¥å—å‘½ä»¤ã€‚å¦åˆ™ï¼Œå°†è¿”å›é”™è¯¯ï¼Œå®¢æˆ·ç«¯éœ€è¦å°è¯•æ–°å¯†ç ã€‚ BGREWRITEAOF æŒ‡ç¤ºRediså¯åŠ¨ä»…é™„åŠ æ–‡ä»¶é‡å†™è¿‡ç¨‹ã€‚é‡å†™å°†åˆ›å»ºå½“å‰ä»…é™„åŠ æ–‡ä»¶çš„å°ä¼˜åŒ–ç‰ˆæœ¬ã€‚å¦‚æœBGREWRITEAOFå¤±è´¥ï¼Œåˆ™ä¸ä¼šä¸¢å¤±ä»»ä½•æ•°æ®ï¼Œå› ä¸ºæ—§çš„AOFå°†ä¸å—å½±å“ã€‚å¦‚æœè¿˜æ²¡æœ‰åå°è¿›ç¨‹æ‰§è¡ŒæŒä¹…æ€§ï¼Œåˆ™é‡å†™å°†ä»…ç”±Redisè§¦å‘ã€‚ç‰¹åˆ«ï¼šå¦‚æœRediså­é¡¹æ­£åœ¨ç£ç›˜ä¸Šåˆ›å»ºå¿«ç…§ï¼Œåˆ™ä¼šè°ƒåº¦ AOFé‡å†™ï¼Œ ä½†åœ¨ç”ŸæˆRDBæ–‡ä»¶çš„ä¿å­˜å­é¡¹ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå¯åŠ¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒBGREWRITEAOFä»ä¼šè¿”å›OKä»£ç ï¼Œä½†ä¼šæ˜¾ç¤ºç›¸åº”çš„æ¶ˆæ¯ã€‚æ‚¨å¯ä»¥æ£€æŸ¥æ˜¯å¦å®‰æ’äº†AOFé‡å†™ï¼Œä»Redis 2.6å¼€å§‹æŸ¥çœ‹INFOå‘½ä»¤ã€‚å¦‚æœAOFé‡å†™å·²åœ¨è¿›è¡Œä¸­ï¼Œåˆ™è¯¥å‘½ä»¤å°†è¿”å›é”™è¯¯ï¼Œå¹¶ä¸”ä¸ä¼šå†å®‰æ’AOFé‡å†™ã€‚ä»Redis 2.4å¼€å§‹ï¼ŒRedisä¼šè‡ªåŠ¨è§¦å‘AOFé‡å†™ï¼Œä½† BGREWRITEAOFå‘½ä»¤å¯ä»¥éšæ—¶ç”¨äºè§¦å‘é‡å†™ BGSAVE å°†DBä¿å­˜åœ¨åå°ã€‚ç«‹å³è¿”å›OKä»£ç ã€‚Redisåˆ†å‰ï¼Œçˆ¶æ¯ç»§ç»­ä¸ºå®¢æˆ·æœåŠ¡ï¼Œå­©å­å°†æ•°æ®åº“ä¿å­˜åœ¨ç£ç›˜ä¸Šç„¶åé€€å‡ºã€‚å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨LASTSAVE å‘½ä»¤æ£€æŸ¥æ“ä½œæ˜¯å¦æˆåŠŸã€‚","date":"2024-12-31","categories":["redis"]},{"title":"rediså­¦ä¹ ç¬”è®°1-å¯¹keyçš„æ“ä½œå’Œkey-valueæ“ä½œ","url":"/2024/12/31/rediså­¦ä¹ ç¬”è®°1-å¯¹keyçš„æ“ä½œå’Œkey-valueæ“ä½œ/","content":"å¯¹é”®çš„æ“ä½œKEYSè·å¾—redisåœ¨è¿™ä¸ªå®ä¾‹çš„æ•°æ®å­—å…¸ä¸­æ‰€æœ‰çš„keyåˆ—è¡¨ æ”¯æŒ globé£æ ¼çš„é€šé…ç¬¦å®šä¹‰ ç¬¦å· å«ä¹‰ ? åŒ¹é…ä¸€ä¸ªå­—ç¬¦ * åŒ¹é…ä»»æ„ä¸ªå­—ç¬¦åŒ…æ‹¬0 [] åŒ¹é…æ‹¬å·é—´ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨-è¡¨ç¤ºèŒƒå›´ï¼Œæ¯”å¦‚[a-c] è¡¨ç¤ºåŒ¹é… a æˆ– b æˆ– c \\x è½¬è¯‘å­—ç¬¦ï¼Œæ¯”å¦‚è¦åŒ¹é…ï¼Ÿ å°±éœ€è¦ä½¿ç”¨? DELredisçš„delå‘½ä»¤å¯ä»¥åˆ é™¤ä¸€æ‰¹é”®ï¼Œå¹¶ä¸”è¿”å›åˆ é™¤çš„æ•°é‡ EXISTSåˆ¤è¯»ä¸€ä¸ªkeyæ˜¯å¦å­˜åœ¨ å¦‚æœå­˜åœ¨å°±è¿”å›1åä¹‹è¿”å›0 TYPEè¿”å›è¿™ä¸ªé”®å¯¹åº”çš„ç±»å‹è¿”å›çš„ç»“æœå¯ä»¥èƒ½æ˜¯string,list,hash,set,zset key value æ“ä½œï¼ˆvalueçš„é»˜è®¤ç±»å‹å°±æ˜¯stringï¼‰SETå’ŒGET ç›¸å½“äºå¯¹mapç±»å‹çš„æ•°æ®è¿›è¡Œå–å€¼ MGETå’ŒMSETåŒæ—¶è·å–æˆ–è€…è®¾ç½®å¤šä¸ª INCRincræ˜¯redisæä¾›çš„ä¸€ä¸ªç‰¹æ®Šçš„key valueç»“æ„ è¿™ä¸ªç»“æ„å¼ºåˆ¶å°†valueåˆ¶å®šæˆintegerç±»å‹ï¼Œæ¯æ¬¡è°ƒç”¨keyçš„æ—¶å€™ï¼Œå°†ä¼šè‡ªåŠ¨çš„å°†value+1,å¹¶ä¸”è¿”å›+1 ä¹‹åçš„ç»“æœ æ³¨æ„ incrå‘½ä»¤å¯ä»¥æ˜¯ç”¨getå’Œsetå‘½ä»¤æ¨¡æ‹Ÿï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­çš„åŸå­æ€§é—®é¢˜ï¼Œæ‰€ä»¥è¿™ç§ç´¯åŠ çš„æ–¹æ³•è¦ä½¿ç”¨incrä¿è¯åŸå­æ€§ DECRå’Œincrç›¸åï¼Œè®©value-1 INCRBYç›¸å½“äºincrå‘½ä»¤çš„è¿›åŒ–ç‰ˆè¿™ä¸ªå‘½ä»¤å¯ä»¥åˆ¶å®šæ¯æ¬¡è¿›è¡Œå åŠ çš„æ¬¡æ•° DECRBYå’ŒINCRBYç›¸åï¼Œå°†æŒ‡å®šçš„value - æŒ‡å®šå€¼ INCRBYFLOATå’Œincræ„ä¹‰ç›¸åŒï¼ŒæŒ‡å®šçš„keyå¢åŠ ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•° APPENDå‘é”®å€¼æœ«å°¾è¿½åŠ valueï¼Œå¦‚æœé”®ä¸å­˜åœ¨å°±å°†è¯¥é”®è®¾ç½®æˆvalueçš„å€¼ æ³¨æ„å¦‚æœæ’å…¥çš„valueæ‹¥æœ‰ç©ºæ ¼åˆ™éœ€è¦ä½¿ç”¨â€â€åŒ…è£¹ STRLENè·å–å­—ç¬¦ä¸²UTF-8ç¼–ç åé•¿åº¦ äºŒè¿›åˆ¶æ“ä½œGETBITå’ŒSETBITredisæä¾›çš„ä½æ“ä½œæ–¹æ³• redis ä½¿ç”¨ä½æ“ä½œçš„ä½¿ç”¨å°†ä¼šå°†valueè¿›è¡Œascillç¼–ç ï¼Œç„¶åæ“ä½œå¯¹åº”çš„äºŒè¿›åˆ¶å€¼ BITCOUNTè¿”å›æŒ‡å®škeyçš„valueä¸­1çš„ä¸ªæ•°ï¼ˆä½¿ç”¨acillç¼–ç åï¼‰ BITOPæä¾›äº†AND OR XOR NOT å››ç§ä½é€»è¾‘æ“ä½œè¿ç®—ç¬¦é€šè¿‡è¿™äº›æ–¹æ³•å¯ä»¥å¿«é€Ÿçš„å¯¹keyçš„valueè¿›è¡Œä½è¿ç®—ï¼Œ å¹¶å°†ç»“æœå‡ºå­˜åœ¨ä¸€ä¸ªæ–°çš„keyä¸­","date":"2024-12-31","categories":["redis"]},{"title":"rust-å­¦ä¹ ç¬”è®°(1)-é€šç”¨ç¼–ç¨‹æ¦‚å¿µ2","url":"/2024/12/31/rust-å­¦ä¹ ç¬”è®°-1--é€šç”¨ç¼–ç¨‹æ¦‚å¿µ2/","content":"ç‰¹æ®Šçš„å˜é‡ç±»å‹rustå˜é‡å’Œå…¶ä»–çš„ç¼–ç¨‹çš„å˜é‡ç³»ç»Ÿæ˜¯ä¸åŒçš„,åœ¨rustä¸­é»˜è®¤çš„å˜é‡éƒ½æ˜¯ä¸å¯æ”¹å˜çš„ç±»å‹ å¦‚æœè®©è¿™ä¸ªå˜é‡ç¼–ç¨‹å¯å˜ç±»å‹éœ€è¦ä½¿ç”¨ä¸€ç§ä¸ªå…³é”®å­— mut mut å…³é”®å­—èƒ½è®©è¿™ä¸ªå˜é‡å˜å¾—å¯ä»¥ä¿®æ”¹ å¸¸é‡æ‚¨ä½¿ç”¨constå…³é”®å­—è€Œä¸æ˜¯å…³é”®å­—å£°æ˜å¸¸é‡letï¼Œå¹¶ä¸”å€¼çš„ç±»å‹å¿…é¡»å¸¦æ³¨é‡Š Rustå¸¸é‡çš„å‘½åçº¦å®šæ˜¯ä½¿ç”¨æ‰€æœ‰å¤§å†™å­—æ¯åœ¨å•è¯ä¹‹é—´åŠ ä¸Šä¸‹åˆ’çº¿ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æ•°å­—æ–‡å­—ä¸­æ’å…¥ä¸‹åˆ’çº¿ä»¥æé«˜å¯è¯»æ€§ rustçš„å½±å­ç±»å‹rust æ”¯æŒå½±å­æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼ä¸‹ï¼Œå¯ä»¥å¯¹ç»Ÿä¸€ä¸ªåç§°é‡å¤çš„è¿›è¡Œèµ‹å€¼æ“ä½œ rust ç±»å‹ç³»ç»Ÿ1. åŸºæœ¬ç±»å‹å’Œjavaç›¸åŒï¼ˆåšjavaçš„æ—¶å€™å¾ˆå°‘è€ƒè™‘int å’Œlongä¹‹é—´çš„åŒºåˆ«ï¼Œå…¶å®é€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥èŠ‚çœå¤§é‡çš„å†…å­˜ï¼‰ 2. å¤åˆç±»å‹å…ƒç¥–ç±»å‹ç”¨æ‹¬å·é˜”èµ·æ¥çš„ç±»å‹ æ”¯æŒ. èµ‹å€¼å’Œè§£æèµ‹å€¼ æ•°ç»„ç±»å‹rust çš„æ•°ç»„ç±»å‹å’Œjavaç›¸åŒ åˆ›å»ºæ•°ç»„ 3ç§æ–¹æ³• rustçš„è¡¨è¾¾å¼å’Œè¯­å¥rustçš„è¯­å¥æ²¡æœ‰è¿”å›å€¼ä½†æ˜¯è¡¨è¾¾å¼æ˜¯æœ‰çš„ï¼Œè°ƒç”¨å‡½æ•°æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚è°ƒç”¨å®æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚ä½œç”¨åŸŸçš„å—{}æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚ æ§åˆ¶æµï¼ˆif elseï¼‰ä¹Ÿæ˜¯è¡¨è¾¾å¼ æ¯”å¦‚è¿™ç§èµ‹å€¼ è¾“å‡º 5 3 ä½œç”¨åŸŸä¸­çš„å˜é‡ä¸å½±å“å¤–éƒ¨çš„ æ³¨æ„ x+1 å¦‚æœæœ‰;å· å°±æ˜¯è¯­å¥ï¼Œæ²¡æœ‰å°±æ˜¯è¡¨è¾¾å¼ å‡½æ•° æ³¨æ„rustä¸æ”¯æŒå‡½æ•°é‡è½½ æ§åˆ¶æµ if else å˜é‡å‚æ•°å¿…é¡»æ˜¯boolean ç±»å‹ let if åˆ¤æ–­è¡¨è¾¾å¼ å› ä¸ºif else å¯ä»¥å˜æˆä¸€ä¸ªè¯­å¥æ‰€æœ‰ï¼Œå¯ä»¥æ˜¯æœ‰ä¸å¸¦åˆ†å·çš„è¡¨è¾¾å¼æ¥è¿”å›ç»“æœ æ³¨æ„ï¼š è¿™ç§æ–¹æ³•éœ€è¦ä¿è¯æ‰€æœ‰çš„è¿”å›ç»“æœè¦ç›¸åŒ loop ç›¸å½“äºæ­»å¾ªç¯ï¼Œä¸€èˆ¬å’Œbreak-å¯è¿”å›ç»“æœçš„breakè¿ç”¨ while å’Œjavaç›¸åŒ for å’Œpythonç±»ä¼¼ rustçš„forå¾ªç¯ä¸æ˜¯å¾ˆå¥½ç”¨ï¼Œç±»ä¼¼python ï¼Œå®˜æ–¹é¼“åŠ±è¿­ä»£å™¨æ¨¡å¼ï¼Œè²Œä¼¼è¿­ä»£å™¨æ¯”forå¾ªç¯å¼ºå¤§çš„å¤šã€‚ã€‚ã€‚ã€‚ This is an example link.","date":"2024-12-31","categories":["rust"]},{"title":"rust-å­¦ä¹ ç¬”è®°(2)-æ‰€æœ‰æƒ","url":"/2024/12/31/rust-å­¦ä¹ ç¬”è®°-2--æ‰€æœ‰æƒ/","content":"æ‰€æœ‰æƒæ˜¯Rustçš„æœ€ç‹¬ç‰¹åŠŸèƒ½ï¼Œå®ƒä½¿Rustæ— éœ€åƒåœ¾æ”¶é›†å™¨å³å¯ä¿è¯å†…å­˜å®‰å…¨ æ‰€æœ‰æƒä»¥åŠå‡ ä¸ªç›¸å…³åŠŸèƒ½ï¼šå€Ÿç”¨ï¼Œåˆ‡ç‰‡ä»¥åŠRustå¦‚ä½•åœ¨å†…å­˜ä¸­å¸ƒç½®æ•°æ® å¼•ç”³ æ ˆå’Œå † æ‰€æœ‰æƒè§„åˆ™é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ‰€æœ‰æƒè§„åˆ™ã€‚åœ¨é€šè¿‡ç¤ºä¾‹è¿›è¡Œè¯´æ˜æ—¶ï¼Œè¯·ç‰¢è®°ä»¥ä¸‹è§„åˆ™ï¼š Rustä¸­çš„æ¯ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªå˜é‡ï¼Œç§°ä¸ºå…¶æ‰€æœ‰è€…ã€‚ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚å½“æ‰€æœ‰è€…è¶…å‡ºèŒƒå›´æ—¶ï¼Œè¯¥å€¼å°†è¢«åˆ é™¤ã€‚ å¯å˜èŒƒå›´å¯ä»¥ç†è§£æˆjavaçš„ä½œç”¨åŸŸ å˜é‡å›æ”¶rustå’Œgcç¼–ç¨‹è¯­è¨€ä¸åŒï¼Œä»–ä½¿ç”¨å¯å˜èŒƒå›´æ¥æ§åˆ¶å˜é‡çš„è‡ªåŠ¨å›æ”¶ ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚è¿™ç§ä»£ç  è¿™æ˜¯ä¸€ä¸ªé—®é¢˜ï¼šå½“s2å’Œs1èµ°å‡ºå»çš„èŒƒå›´ï¼Œä»–ä»¬éƒ½å°†å°è¯•é‡Šæ”¾ç›¸åŒçš„å†…å­˜ã€‚è¿™è¢«ç§°ä¸ºåŒé‡é‡Šæ”¾é”™è¯¯ï¼Œæ˜¯æˆ‘ä»¬å‰é¢æåˆ°çš„å†…å­˜å®‰å…¨æ€§é”™è¯¯ä¹‹ä¸€ã€‚é‡Šæ”¾å†…å­˜ä¸¤æ¬¡å¯èƒ½å¯¼è‡´å†…å­˜æŸåï¼Œä»è€Œå¯èƒ½å¯¼è‡´å®‰å…¨æ¼æ´ã€‚ ä¸ºäº†ç¡®ä¿å†…å­˜å®‰å…¨ï¼Œåœ¨Rustä¸­ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä¼šå‘ç”Ÿçš„äº‹æƒ…è¿˜æœ‰ä¸€ä¸ªç»†èŠ‚ã€‚Rustè®¤ä¸ºs1ä¸å†æœ‰æ•ˆï¼Œè€Œä¸æ˜¯å°è¯•å¤åˆ¶åˆ†é…çš„å†…å­˜ æ³¨æ„è¿™ä¸ªå¾ˆé‡è¦ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨rustä¸­å¦‚æœå‘ç”Ÿäº†å·²ç»æ‹¥æœ‰çš„å˜é‡å†è¿›è¡Œèµ‹å€¼ï¼Œå¹¶ä¸”åŸæ¥çš„å€¼è¿˜æ˜¯æœ‰æ•ˆçš„é‚£ä¹ˆä¸€å®šæ˜¯copyçš„å€¼ rustå¯¹ä¸€äº›å¸¸ç”¨çš„å¯¹è±¡åœ¨è¿›è¡Œä¸Šé¢çš„æ“ä½œçš„æ—¶å€™ä¸éœ€è¦è°ƒç”¨copyæ–¹æ³•ï¼Œè¿™äº›å¯¹è±¡å¦‚ä¸‹ æ‰€æœ‰æ•´æ•°ç±»å‹ï¼Œä¾‹å¦‚u32ã€‚ å¸ƒå°”ç±»å‹ï¼Œboolå€¼trueå’Œfalseã€‚ æ‰€æœ‰æµ®ç‚¹ç±»å‹ï¼Œä¾‹å¦‚f64ã€‚ å­—ç¬¦ç±»å‹charã€‚ å…ƒç»„ï¼ˆå¦‚æœå®ƒä»¬ä»…åŒ…å«alsoçš„ç±»å‹ï¼‰Copyã€‚ä¾‹å¦‚ï¼Œ (i32, i32)æ˜¯Copyï¼Œä½†(i32, String)ä¸æ˜¯ã€‚ æ‰€æœ‰æƒå’ŒèŒèƒ½è¿™ä¸ªå¾ˆé‡è¦ ç”¨äºå°†å€¼ä¼ é€’ç»™å‡½æ•°çš„è¯­ä¹‰ç±»ä¼¼äºç”¨äºå°†å€¼åˆ†é…ç»™å˜é‡çš„è¯­ä¹‰ã€‚å°±åƒèµ‹å€¼ä¸€æ ·ï¼Œå°†å˜é‡ä¼ é€’ç»™å‡½æ•°å°†ç§»åŠ¨æˆ–å¤åˆ¶ã€‚ å‡½æ•°ä¼ å‚è¯­ä¹‰ å‡½æ•°è¿”å›å€¼è¯­ä¹‰ æ‰€æœ‰æƒåœ¨å‡½æ•°ä¸­å­˜åœ¨çš„é—®é¢˜æ‹¥æœ‰æ‰€æœ‰æƒç„¶åè¿”å›æ‰€æœ‰åŠŸèƒ½çš„æ‰€æœ‰æƒæœ‰ç‚¹ä¹å‘³ã€‚å¦‚æœæˆ‘ä»¬æƒ³è®©å‡½æ•°ä½¿ç”¨å€¼è€Œä¸æ˜¯æ‰€æœ‰æƒï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿä»¤äººéå¸¸çƒ¦æ¼çš„æ˜¯ï¼Œé™¤äº†æˆ‘ä»¬å¯èƒ½è¿˜æƒ³è¿”å›çš„å‡½æ•°ä¸»ä½“æ‰€äº§ç”Ÿçš„ä»»ä½•æ•°æ®ä¹‹å¤–ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦å†æ¬¡ä½¿ç”¨å®ƒï¼Œåˆ™è¿˜éœ€è¦å°†è¿”å›çš„ä¿¡æ¯ä¼ é€’å›å»ã€‚ å¯ä»¥ä½¿ç”¨å…ƒç»„è¿”å›å¤šä¸ªå€¼ ä¸è¿‡rustæä¾›äº†ç‰¹æ®Šçš„è¯­ä¹‰å«å‚è€ƒå’Œå€Ÿç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ å‚è€ƒå’Œå€Ÿç”¨ï¼ˆå¼•ç”¨å’Œå¯å˜å¼•ç”¨ï¼‰çªç ´æ‰€æœ‰æƒçš„é™åˆ¶ä¿®æ”¹æ–¹æ³• è¿™ç§å¼•ç”¨çš„æ–¹æ³•å…¶å®æ˜¯ä¼ ä¸€ä¸ªå¼•ç”¨åœ°å€ï¼Œä¸è¿‡æ˜¯åªè¯»çš„ å¦‚æœéœ€è¦å¯è¯»ï¼Œå°±éœ€è¦ç”¨ä¸‹é¢è¿™ç§æ–¹æ³• æ³¨æ„å¦‚æœè¿™æ ·å†™å°±ä¼šæœ‰é”™è¯¯ è¿™ä¸ªåœ¨ä¸€è¡Œæ¥å†™å°±ä¼šæœ‰é—®é¢˜ï¼Œå› ä¸ºä¸€è¡Œçš„æ—¶å€™å°±æ˜¯ä¸€ä¸ªä½œç”¨åŸŸï¼Œå¿…é¡»ä¿è¯ä¸€è‡´æ€§ å¯å˜å¼•ç”¨çš„é™åˆ¶ä½†æ˜¯å¯å˜å¼•ç”¨æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é™åˆ¶ï¼šæ‚¨åªèƒ½åœ¨ä¸€ä¸ªç‰¹å®šèŒƒå›´å†…å¯¹ä¸€ä¸ªç‰¹å®šçš„æ•°æ®è¿›è¡Œä¸€ä¸ªå¯å˜å¼•ç”¨ æ¯”å¦‚è¿™ç§ä¸¤ç§æƒ…å†µæƒ…å†µ å¦‚æœå°†r1å’Œr2 åˆ†åˆ«ç»™ä¸¤ä¸ªä¸åŒçš„çº¿ç¨‹å¯èƒ½ä¼šå‡ºç°å¾ç”¨é—®é¢˜ï¼Œç®€å•çš„è¯´å°±æ˜¯è¿™æ · ä¸¤ä¸ªæˆ–å¤šä¸ªæŒ‡é’ˆåŒæ—¶è®¿é—®ç›¸åŒçš„æ•°æ®ã€‚ è‡³å°‘æœ‰ä¸€ä¸ªæŒ‡é’ˆç”¨äºå†™å…¥æ•°æ®ã€‚ æ²¡æœ‰ç”¨äºåŒæ­¥å¯¹æ•°æ®è®¿é—®çš„æœºåˆ¶ã€‚ ä¸Šé¢çš„ä¾‹å­2 å¦‚æœå†™æˆè¿™ç§å°±æ²¡æœ‰é—®é¢˜ æ³¨æ„é—®é¢˜å°±æ˜¯åœ¨ä¸€ä¸ªèŒƒå›´å†…ä¸ä½†ä½¿ç”¨äº†ä¸å¯å˜å¼•ç”¨ï¼Œè€Œä¸”ä½¿ç”¨äº†å¯å˜å¼•ç”¨ çªç ´é™åˆ¶ä¸å¾€å¸¸ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤§æ‹¬å·åˆ›å»ºæ–°çš„èŒƒå›´ï¼Œä»è€Œå…è®¸å¤šä¸ªå¯å˜å¼•ç”¨ï¼Œè€Œä¸æ˜¯åŒæ—¶å¼•ç”¨ï¼š æ‚¬æŒ‚æŒ‡é’ˆå¤„ç† ç”±äºsæ˜¯åœ¨å†…éƒ¨åˆ›å»ºçš„dangleï¼Œå½“ä»£ç dangleå®Œæˆæ—¶ï¼Œ så°†è¢«é‡Šæ”¾ã€‚ä½†æ˜¯æˆ‘ä»¬è¯•å›¾è¿”å›å¯¹å®ƒçš„å¼•ç”¨ã€‚è¿™æ„å‘³ç€æ­¤å¼•ç”¨å°†æŒ‡å‘æ— æ•ˆStringã€‚ ä¿®æ”¹æˆè¿™æ ·å°±å¯ä»¥ç¼–è¯‘é€šè¿‡ å¦ä¸€ä¸ªçªç ´æ‰€æœ‰æƒçš„æ–¹æ³•,åˆ‡ç‰‡åˆ‡ç‰‡å…¶å®æœ¬æ˜¯ä¸Šæ˜¯è¿ç»­æ•°æ®çš„å¼•ç”¨ æ¯”å¦‚ä¸€ä¸ª æ•°ç»„ 0 1 2 3 4 5 6 å…¶ä¸­å˜é‡x æŒ‡å‘ 0 ç„¶åç”Ÿæˆxçš„åˆ‡ç‰‡ y æŒ‡å‘ 3 è¿™ä¸ªæ—¶å€™yå°±æ˜¯xçš„ä¸€éƒ¨åˆ†å¼•ç”¨ï¼Œæ³¨æ„æ‰€æœ‰çš„åˆ‡ç‰‡éƒ½æ˜¯åªè¯»çš„ä¸å¯ä»¥è¿›è¡Œä¿®æ”¹(ç±»å‹æ˜¯&str)ï¼Œç›¸å½“äºç»™ä¸Šé¢çš„arrå¼€äº†ä¸€ä¸ªå£å­å¯ä»¥çœ‹è§æ•°æ® æ³¨æ„ä¸€ä¸ªåœ°æ–¹ï¼Œå¦‚æœä»£ç è¿™æ ·å†™å°†ä¼šæŠ¥é”™ åŸå› æ—¶æ•°æ®äº§ç”Ÿäº†è„æ•°æ®ï¼Œå¤šä¸ªå¼•ç”¨åœ¨ä½¿ç”¨å‰å‘ç”Ÿäº†å˜åŒ– rust æ•°ç»„åˆ‡ç‰‡","date":"2024-12-31","categories":["rust"]},{"title":"rust-å­¦ä¹ ç¬”è®°(3)-ä½¿ç”¨ç»“æ„æ¥æ„é€ ç›¸å…³æ•°æ®","url":"/2024/12/31/rust-å­¦ä¹ ç¬”è®°-3--ä½¿ç”¨ç»“æ„æ¥æ„é€ ç›¸å…³æ•°æ®/","content":"å®šä¹‰å’Œå®ä¾‹åŒ–ç»“æ„å®šä¹‰ æ³¨æ„rustä¸­æ‰€æœ‰çš„ç»“æ„ä½“éƒ½é»˜è®¤è¢«mutæ ‡è®° å‡½æ•°åˆå§‹åŒ–struct ä½¿ç”¨å‡½æ•°çš„æ—¶å€™å¯ä»¥å¿«é€Ÿçš„å‚æ•°åç§°å’Œç»“æ„ä½“å¿«é€Ÿ å¯¹åº” ä½¿ç”¨ç»“æ„æ›´æ–°è¯­æ³•ä»å…¶ä»–å®ä¾‹åˆ›å»ºå®ä¾‹ å…¶å®æœ¬è´¨ä¸Šå°±æ˜¯ä»åˆ«çš„structä½“ä¸­è·å–ç›¸åŒçš„å€¼ï¼Œä½†æ˜¯rustæä¾›äº†ä¸€ç§å¿«é€ŸåŒç§ç±»å‹è½¬åŒ–æ–¹æ³• å­˜åœ¨ä¸€ä¸ªç–‘é—®ç‚¹ è¿™æ ·å†™æœ‰é—®é¢˜å—ï¼Œuser2.nameçš„å€¼æ˜¯å•¥ ç»“æ„ä½“æ–¹æ³•æ–¹æ³•å’Œå‡½æ•°ç±»ä¼¼ï¼Œä½†æ˜¯æ–¹æ³•ä¸å‡½æ•°çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œå®ƒä»¬æ˜¯åœ¨strucçš„ä¸Šä¸‹æ–‡ä¸­å®šä¹‰çš„ï¼Œå¹¶ä¸”å®ƒä»¬çš„ç¬¬ä¸€ä¸ªå‚æ•°å§‹ç»ˆä¸ºselfï¼Œå®ƒè¡¨ç¤ºè°ƒç”¨è¯¥æ–¹æ³•çš„structå®ä¾‹ã€‚ åœ¨Cå’ŒC ++ä¸­ï¼Œä½¿ç”¨ä¸¤ç§ä¸åŒçš„è¿ç®—ç¬¦æ¥è°ƒç”¨æ–¹æ³•ï¼š .å¦‚æœè¦ç›´æ¥åœ¨å¯¹è±¡ä¸Šè°ƒç”¨æ–¹æ³•ï¼Œå¹¶ä¸”->è¦åœ¨æŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆä¸Šè°ƒç”¨æ–¹æ³•ï¼Œåˆ™éœ€è¦å…ˆå–æ¶ˆå¼•ç”¨è¯¥æŒ‡é’ˆã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœobjectæ˜¯æŒ‡é’ˆï¼Œ object->something()åˆ™ç±»ä¼¼äº(*object).something()ã€‚ Rustæ²¡æœ‰ä¸->è¿ç®—ç¬¦ç­‰æ•ˆçš„å¯¹è±¡ã€‚ç›¸åï¼ŒRustå…·æœ‰ç§°ä¸ºè‡ªåŠ¨å¼•ç”¨å’Œå–æ¶ˆå¼•ç”¨çš„åŠŸèƒ½ã€‚è°ƒç”¨æ–¹æ³•æ˜¯Rustå°‘æ•°å…·æœ‰è¿™ç§è¡Œä¸ºçš„åœ°æ–¹ä¹‹ä¸€ã€‚ ä¸‹é¢æ˜¯å®ƒå¦‚ä½•å·¥ä½œçš„ï¼šå½“ä½ è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æœ‰object.something()é”ˆä¼šè‡ªåŠ¨æ·»åŠ &ï¼Œ&mutæˆ–*ä½¿objectè¯¥æ–¹æ³•çš„ç­¾åç›¸åŒ¹é…ã€‚æ¢å¥è¯è¯´ï¼Œä»¥ä¸‹æ˜¯ç›¸åŒçš„ï¼š ç¬¬ä¸€ä¸ªçœ‹èµ·æ¥æ›´å¹²å‡€ã€‚è¿™ç§è‡ªåŠ¨å¼•ç”¨è¡Œä¸ºè¡Œä¹‹æœ‰æ•ˆï¼Œå› ä¸ºæ–¹æ³•çš„æ¥æ”¶æ–¹å¾ˆæ˜ç¡®-çš„ç±»å‹selfã€‚ç»™å®šæ–¹æ³•çš„æ¥æ”¶è€…å’Œåç§°ï¼ŒRustå¯ä»¥æ˜ç¡®åœ°ç¡®å®šè¯¥æ–¹æ³•æ˜¯è¯»å–ï¼ˆ&selfï¼‰ï¼Œå˜å¼‚ï¼ˆ&mut selfï¼‰è¿˜æ˜¯ä½¿ç”¨ï¼ˆselfï¼‰ã€‚Rustä½¿æ–¹æ³•æ¥æ”¶è€…éšå«å€Ÿè´·è¿™ä¸€äº‹å®æ˜¯åœ¨å®è·µä¸­ä½¿æ‰€æœ‰æƒç¬¦åˆäººä½“å·¥ç¨‹å­¦çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚","date":"2024-12-31","categories":["rust"]},{"title":"rust-å­¦ä¹ ç¬”è®°(4)-æšä¸¾å’Œæ¨¡å¼åŒ¹é…","url":"/2024/12/31/rust-å­¦ä¹ ç¬”è®°-4--æšä¸¾å’Œæ¨¡å¼åŒ¹é…/","content":"rustçš„æšä¸¾ç±»å‹å…¶å®æ˜¯ä¸€ç§å®šä¹‰(javaä¸­æ›´åƒä¸€ç§å¯¹è±¡å¯ä»¥å‚¨å­˜æ•°æ®) rust ä¸­çš„æšä¸¾æ˜¯ä¸èƒ½ç»™å®šé»˜è®¤å€¼çš„,æšä¸¾çš„ç±»å‹ä¸€èˆ¬æ˜¯é€šè¿‡å’Œstructè¿ç”¨æ¥è¿›è¡Œä½¿ç”¨çš„ æšä¸¾çš„å®šä¹‰å’Œèµ‹å€¼ ä¸Šé¢çš„åˆ—å­,æˆ‘ä»¬ä½¿ç”¨äº†ç»“æ„ä½“å­˜å‚¨æ•°æ®ä½¿ç”¨æšä¸¾æ¥å®šä¹‰ç±»å‹ rustæä¾›äº†æ›´åŠ ç®€å•çš„æ–¹æ³•æ¥å®šä¹‰æšä¸¾- æšä¸¾å˜é‡ æšä¸¾å˜é‡çš„ç±»å‹æ”¯æŒrust çš„æšä¸¾å…¶å®æ”¯æŒå¤šç§ç±»å‹ ä¾‹å¦‚ï¼Œå­—ç¬¦ä¸²ï¼Œæ•°å­—ç±»å‹æˆ–ç»“æ„ã€‚æ‚¨ç”šè‡³å¯ä»¥åŒ…å«å¦ä¸€ä¸ªæšä¸¾ rust æšä¸¾å®šä¹‰é€šç”¨æ–¹æ³•rustçš„æšä¸¾å’Œstructç±»ä¼¼å¯ä»¥å®šä¹‰é€šç”¨æ–¹æ³• rustçš„Option æšä¸¾rust å®Optionæšä¸¾æ¥è§£å†³nullé—®é¢˜çš„ æ ‡å‡†åº“å®šä¹‰å¦‚ä¸‹ è¯¥Optionæšä¸¾æ˜¯éå¸¸æœ‰ç”¨ï¼Œå®ƒç”šè‡³åŒ…æ‹¬ä¸­æ‹‰å¼€åºå¹•; æ‚¨æ— éœ€å°†å…¶æ˜ç¡®çº³å…¥èŒƒå›´ã€‚æ­¤å¤–ï¼Œè¿™æ ·æ˜¯å®ƒçš„å˜ä½“ï¼šä½ å¯ä»¥ä½¿ç”¨Someå’ŒNoneç›´æ¥ä¸å¸¦Option::å‰ç¼€ã€‚è¯¥ Optionæšä¸¾ä»ç„¶åªæ˜¯ä¸€ä¸ªæ™®é€šçš„æšä¸¾ï¼Œå¹¶Some(T)å’ŒNoneç±»å‹ä»ç„¶å˜ç§Optionã€‚ æ³¨æ„:å¦‚æœä½¿ç”¨Noneè€Œä¸æ˜¯Someï¼Œåˆ™éœ€è¦å‘Šè¯‰Rust Optionæˆ‘ä»¬æ‹¥æœ‰å“ªç§ç±»å‹ ï¼Œå› ä¸ºç¼–è¯‘å™¨æ— æ³•Some é€šè¿‡ä»…æŸ¥çœ‹ä¸€ä¸ªNoneå€¼æ¥æ¨æ–­è¯¥å˜é‡å°†æ‹¥æœ‰çš„ç±»å‹ã€‚ æšä¸¾å’Œrust match è¿ç”¨Rustå…·æœ‰ä¸€ä¸ªéå¸¸å¼ºå¤§çš„æ§åˆ¶æµè¿ç®—ç¬¦matchï¼Œè¯¥è¿ç®—ç¬¦ä½¿æ‚¨å¯ä»¥å°†å€¼ä¸ä¸€ç³»åˆ—æ¨¡å¼è¿›è¡Œæ¯”è¾ƒï¼Œç„¶åæ ¹æ®åŒ¹é…çš„æ¨¡å¼æ‰§è¡Œä»£ç ã€‚æ¨¡å¼å¯ä»¥ç”±æ–‡å­—å€¼ï¼Œå˜é‡åï¼Œé€šé…ç¬¦å’Œè®¸å¤šå…¶ä»–ä¸œè¥¿ç»„æˆ æ³¨æ„ Coinæšä¸¾æœ€åä¸€ä¸ªå‚æ•°,ä½¿ç”¨ Quarteråè§£æå¯ä»¥è·å–stateä¸­å®šä¹‰çš„UsStateæšä¸¾ä¿¡æ¯ match è¯­æ³•å’Œ Optionè¿ç”¨å‡è®¾æˆ‘ä»¬è¦ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°éœ€è¦ä¸€ä¸ªOptionï¼Œå¦‚æœå†…éƒ¨æœ‰ä¸€ä¸ªå€¼ï¼Œåˆ™å°†è¯¥å€¼åŠ 1ã€‚å¦‚æœå†…éƒ¨æ²¡æœ‰å€¼ï¼Œè¯¥å‡½æ•°åº”è¿”å›è¯¥Noneå€¼ï¼Œè€Œä¸è¦å°è¯•æ‰§è¡Œä»»ä½•æ“ä½œã€‚å®ç”¨matchè¿›è¡Œæ“ä½œ æ³¨æ„: rustå¯¹someçš„å¤„ç†æ–¹æ³•å…¶å®æ˜¯ä¸€å±‚è¯­æ³•ç³–,å…ˆåè§£æsomeä¸­çš„å†…å®¹ç„¶åè¿›è¡Œå…¶ä¸­è¡¨è¾¾å¼çš„æ“ä½œ match _å ä½ç¬¦ è¯¥_æ¨¡å¼å°†åŒ¹é…ä»»ä½•å€¼ã€‚é€šè¿‡å°†å…¶æ”¾åœ¨æˆ‘ä»¬çš„å…¶ä»–æ‰‹è‡‚ä¹‹åï¼Œ _å®ƒå°†åŒ¹é…ä¹‹å‰æœªæŒ‡å®šçš„æ‰€æœ‰å¯èƒ½æƒ…å†µã€‚çš„() åªæ˜¯å•ä½å€¼ï¼Œæ‰€ä»¥ä»€ä¹ˆéƒ½ä¸ä¼šçš„å‘ç”Ÿ_æƒ…å†µã€‚ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥è¯´ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›å¯¹æœªåœ¨_å ä½ç¬¦ä¹‹å‰åˆ—å‡ºçš„æ‰€æœ‰å¯èƒ½å€¼ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚ è§£å†³match åœ¨éƒ¨åˆ†æƒ…å†µä¸‹çš„å±€é™æ€§çš„ if lef è¯­æ³•æ¯”å¦‚ æˆ‘ä»¬åªæƒ³å®ç”¨match è¡¨è¾¾å¼åœ¨ä¸€ä¸ªå•ä¸€æƒ…å†µä¸‹åšç‚¹ä»€ä¹ˆå…¶ä»–æƒ…å†µä»€ä¹ˆéƒ½ä¸åš,é‚£ä¹ˆrustéœ€è¦è¿™ä¹ˆå»å†™ è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ª_ æ¥åŒ¹é…å…¶ä»–æƒ…å†µ æ³¨æ„: rust ä¼š åˆ¤æ–­ match å¯èƒ½åŒ¹é…çš„æ‰€æœ‰æƒ…å†µ,å¦‚æœä¸æ»¡è¶³æƒ…å†µ,å°†ä¼šè‡ªåŠ¨æŠ¥é”™,è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦ ä½¿ç”¨_ æ¥åŒ¹é…æ‰€æœ‰çš„å…¶ä»–æƒ…å†µ if let è¯­æ³•æœ¬è´¨ä¸Šå…¶å®å’Œ if|else if|else ç›¸åŒçš„","date":"2024-12-31","categories":["rust"]},{"title":"rust-å­¦ä¹ ç¬”è®°(5)-rustçš„åŒ…,æ¨¡å—,è·³æ¿ç®±","url":"/2024/12/31/rust-å­¦ä¹ ç¬”è®°-5--rustçš„åŒ…-æ¨¡å—-è·³æ¿ç®±/","content":"Rustå…·æœ‰è®¸å¤šåŠŸèƒ½ï¼Œå¯è®©æ‚¨ç®¡ç†ä»£ç çš„ç»„ç»‡ï¼ŒåŒ…æ‹¬å“ªäº›ç»†èŠ‚è¢«å…¬å¼€ï¼Œå“ªäº›ç»†èŠ‚æ˜¯ç§æœ‰çš„ä»¥åŠç¨‹åºä¸­æ¯ä¸ªä½œç”¨åŸŸä¸­çš„åå­—ã€‚è¿™äº›åŠŸèƒ½ï¼ˆæœ‰æ—¶ç»Ÿç§°ä¸ºæ¨¡å—ç³»ç»Ÿï¼‰åŒ…æ‹¬ï¼š åŒ…è£…ï¼šè´§è¿åŠŸèƒ½ï¼Œå¯è®©æ‚¨æ„å»ºï¼Œæµ‹è¯•å’Œå…±äº«åŒ…è£…ç®± æ¿æ¡ç®±ï¼šäº§ç”Ÿåº“æˆ–å¯æ‰§è¡Œæ–‡ä»¶çš„æ¨¡å—æ ‘ æ¨¡å—å’Œç”¨é€”ï¼šè®©æ‚¨æ§åˆ¶è·¯å¾„çš„ç»„ç»‡ï¼ŒèŒƒå›´å’Œéšç§ è·¯å¾„ï¼šä¸€ç§å‘½åé¡¹ç›®çš„æ–¹å¼ï¼Œä¾‹å¦‚ç»“æ„ï¼Œå‡½æ•°æˆ–æ¨¡å— åŒ…è£…å’Œæ¿æ¡ç®±æ¡æ¿ç®±æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶æˆ–åº“,ä¸€ä¸ªè½¯ä»¶åŒ…åŒ…å«ä¸€ä¸ªCargo.tomlæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æè¿°äº†å¦‚ä½•æ„å»ºè¿™äº›åŒ…è£…ç®±ã€‚åŒ…è£…ç®±æ˜¯å…¶å®ƒè¯­è¨€ä¸­åº“ï¼ˆlibraryï¼‰æˆ–åŒ…ï¼ˆpackageï¼‰çš„åŒä¹‰è¯ æ¿æ¡ç®±ä¼šå°†èŒƒå›´å†…çš„ç›¸å…³åŠŸèƒ½åˆ†ç»„åœ¨ä¸€èµ·ï¼Œå› æ­¤è¯¥åŠŸèƒ½æ˜“äºåœ¨å¤šä¸ªé¡¹ç›®ä¹‹é—´å…±äº« ç®€å•çš„è®²è§£ä¸€äº›rustçš„åŒ…ç»“æ„ruståœ¨è§„èŒƒä¸­å®šä¹‰äº†ä¸¤ç§ç±»å‹ src&#x2F;main.rs å’Œ src&#x2F;lib.rs å¦‚æœè·¯å¾„ä¸­åŒ…å« src&#x2F;main.rs çš„æ—¶å€™,å°†ä¼šç”Ÿæˆä¸€ä¸ªæ‰§è¡Œçš„è€ŒäºŒè¿›åˆ¶æ–‡ä»¶å«åšåŒ…è£… å¦‚æœè·¯å¾„ä¸­åŒ…å« src&#x2F;lib.rs çš„æ—¶å€™,å°†ä¼šå½¢æˆä¸€ä¸ªå¯åŠ è½½çš„åŒ…å«åšè·³æ¿ç®± å¦‚æœæ—¢æœ‰ src&#x2F;lib.rså’Œsrc&#x2F;main.rs çš„æ—¶å€™,å°†ä¼šç”Ÿæˆä¸¤ä¸ªåŒ…,ä¸€ä¸ªåŒ…è£…ä¸€ä¸ªè·³æ¿ç®± ä¸€ä¸ªç®€å•çš„ruståŒ…ç›®å½• ä¸Šé¢çš„å…¶å®æ˜¯ä¸€ä¸ªlibåŒ…çš„è·¯å¾„ å¦‚æœæ ¹çš„cargo toml åç§°å«åšphrases,é‚£ä¹ˆä¸Šé¢çš„æ¨¡å—å±‚æ¬¡ç»“æ„å¦‚ä¸‹ å®šä¹‰æ¨¡å—rustä¸­å¯ä»¥ä½¿ç”¨mod å…³é”®å­—å®šä¹‰ä¸€ä¸ªæ¨¡å—, æ¯”å¦‚ ä¸Šé¢ä¾‹å­ä¸­çš„å®šä¹‰çš„modå…¶å®å½¢æˆäº†ä¸€ä¸ªæ¨¡å—ç´  ä»ä¸€å®šçš„ç¨‹åº¦ä¸Šè®²rustçš„å…¶å®æ˜¯ä¸€ä¸ªå¯åˆ†çº§çš„æ¨¡å—ç³»ç»Ÿ æ¨¡å—å®šä¹‰æ—¶è·¯å¾„å’Œè®¿é—®é™åˆ¶ ä¸Šé¢ä¾‹å­ä¸­æˆ‘ä»eat_at_restaurant() æ–¹æ³•ä¸­å¼•ç”¨äº†front_of_houseä½œç”¨åŸŸä¸‹çš„hostingä½œç”¨åŸŸçš„add_to_waitlist()æ–¹æ³•,ä½¿ç”¨crateè¡¨ç¤ºä»é¡¹ç›®è·Ÿè·¯å¾„çš„å¼€å§‹å‘ä¸Šæœç´¢çš„ç»å¯¹è·¯å¾„,æ²¡æœ‰å¸¦ä¸Šçš„è¡¨ç¤ºä½¿ç”¨ä»¥å½“å‰æ–‡ä»¶ä¸ºè·Ÿè·¯å¾„çš„ç»å¯¹è·¯å¾„ æ³¨æ„add_to_waitlistçš„pub å…³é”®å­—, å¦‚æœæ²¡æœ‰è¿™ä¸ªå…³é”®å­—è¡¨ç¤ºæ˜¯ç§æœ‰çš„æ–¹æ³•,åªæœ‰è‡ªå·±å’Œå­ç±»å¯ä»¥ä½¿ç”¨èƒ½","date":"2024-12-31","categories":["rust"]},{"title":"rust-å­¦ä¹ è®°å½•(1)-other","url":"/2024/12/31/rust-å­¦ä¹ è®°å½•-1--other/","content":"ps è¿™é‡Œåªæ˜¯ç®€å•çš„çºªå½•ä¸€äº›rustç›¸å…³çš„ä¸œè¥¿ å˜é‡1. ä½ç½®è¡¨è¾¾å¼å’Œå€¼è¡¨è¾¾å¼ï¼ˆå·¦å€¼å’Œå³å€¼ï¼‰ã€ä½ç½®ä¸Šä¸‹æ–‡å’Œå€¼ä¸Šä¸‹æ–‡è§„åˆ™ ï¼š å€¼è¡¨è¾¾å¼ä¸èƒ½å‡ºç°åœ¨ä½ç½®ä¸Šä¸‹æ–‡ä¸­ 2. ä¸å¯å˜ä¸å¯å˜ åœ¨ rust ä¸­ æ‰€æœ‰å˜é‡éƒ½é»˜è®¤åƒjavaçš„finalå…³é”®å­—ï¼Œæ˜¯ä¸å¯æ”¹å˜çš„å¦‚æœéœ€è¦æ”¹å˜éœ€è¦æŒ‡å®šmut å‚æ•°,è¡¨ç¤ºè¿™ä¸ªå€¼æ˜¯å¯ä»¥å˜çš„ 3. æ‰€æœ‰æƒå’Œå¼•ç”¨è¿™ä¸ªå’Œcè¯­è¨€æ˜¯ç±»ä¼¼çš„ æ‰€æœ‰æƒ > ç›´æ¥èµ‹å€¼çš„æ—¶å€™å°†ä¼šè‡ªåŠ¨çš„å°†å¯¹åº”çš„å€¼è½¬ç§»åˆ°æ–°çš„å˜é‡ä¸Šæ¥ rust å®˜æ–¹è§£é‡Šï¼šåœ¨è¯­ä¹‰ä¸Šï¼Œæ¯ä¸ªå˜é‡ç»‘å®šéƒ½æœ‰è¯¥å­˜å‚¨å•å…ƒçš„æ‰€æœ‰æƒï¼Œè¿™ç§è½¬ç§»å†…å­˜åœ°å€çš„è¡Œä¸ºå°±æ˜¯æ‰€æœ‰æƒçš„è½¬ç§»ï¼Œåœ¨rust ä¸­ç§°ä¸ºç§»åŠ¨ï¼Œä¸è½¬ç§»çš„æƒ…å†µä¸‹å…¶å®æ˜¯ä¸€ç§å¤åˆ¶è¯­ä¹‰ åœ¨æ—¥å¸¸çš„å¼€å‘ä¸­ï¼Œæœ‰æ—¶å€™å¹¶ä¸éœ€è¦è½¬ç§»æ‰€æœ‰æƒï¼Œrust æä¾›& ç¬¦å·ç›´æ¥æ“ä½œå†…å­˜åœ°å€ ä¸Šé¢çš„ä»£ç è¿™æ ·ä¿®æ”¹å°±å¯ä»¥é€šè¿‡äº† ps ï¼š çŒœæµ‹ å…¶å®åœ¨è¿™é‡Œå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œrustçš„å­—ç¬¦ä¸²æœ¬èº«å…¶å®è¿”å›çš„å°±æ˜¯ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œè€Œâ€â€.to_string() è¿”å›å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œmoveæ˜¯é’ˆå¯¹å¯¹è±¡çš„ å‡½æ•°rustçš„å‡½æ•°å…¶å®è¿˜æ˜¯å¾ˆæ ‡å‡†çš„æ²¡å•¥ç‰¹æ®Šçš„è¯­æ³• 1. å‡½æ•°å®šä¹‰ å‚æ•°ä½¿ç”¨ç±»å‹ï¼šåç§°åˆ†å‰²ï¼Œè¿”å›å€¼å†™åœ¨-> åé¢ 2. å‡½æ•°æŒ‡é’ˆrust çš„å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œå¯ä»¥å‡½æ•°åŒ–ä¼ å‚æˆ–è€…ä½œä¸ºè¿”å›å€¼ï¼ˆæ³¨æ„å‡½æ•°å‚æ•°å®šä¹‰å¿…é¡»æ˜¯å˜é‡åï¼šç±»å‹ï¼‰ 3. å‡½æ•°é—­åŒ…rust é—­åŒ…çš„ç‰¹ç‚¹ å¯ä»¥åƒå‡½æ•°ä¸€æ ·è¢«è°ƒç”¨ å¯ä»¥æ•è·ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­çš„è‡ªç”±å˜é‡ å¯ä»¥è‡ªåŠ¨æ¨æ–­è¾“å…¥å’Œè¿”å›çš„ç±»å‹ 1. é—­åŒ…ä¼ å‚ ä¸çŸ¥é“ä¸ºå•¥å‡½æ•°ä¼ å‚æ•°å‡½æ•°åç§°å¿…é¡»å¸¦ä¸Šç±»ä¼¼èŒƒå‹çš„ä¸œè¥¿ 2. é—­åŒ…è¿”å›å€¼ç„å­¦äº†ã€‚ã€‚ã€‚ã€‚ã€‚ rust çš„ CTFEæœºåˆ¶rust æ”¯æŒåœ¨ç¼–è¯‘æœŸè¿è¡Œå‡½æ•°æ¥è¿›è¡Œæ±‚å€¼æ“ä½œ fn test3()&#123; ps å¦‚æœä½¿ç”¨çš„rust2015 éœ€è¦åŠ ä¸Š rustæµç¨‹æ§åˆ¶1. if elserust æ²¡æœ‰æä¾›ä¸‰å…ƒè¡¨è¾¾å¼è¿ç®—ç¬¦ 2. where,forâ€¦in,looprust æä¾›äº†ä¸‰ç§ 3. matchrustçš„match æ¨¡å¼åŒ¹é…ç›¸å½“çš„å¼ºå¤§ï¼ŒåŒ¹é…æ˜¯åœ¨ rust ä¸­å¾ˆå¼ºçš„ä¸œè¥¿ï¼Œå¯ä»¥åŒ¹é…æ‰€æœ‰ç±»å‹ &#x3D;> åé¢è·Ÿçš„æ˜¯è¡¨è¾¾å¼ï¼Œä¸èƒ½æ˜¯è¯­å¥ (1) åŸºæœ¬å½¢å¼ç±»ä¼¼è¿™æ · (2) matchä¸­å¯ä»¥åº”ç”¨è§£æ„match ä¸­å¯ä»¥åº”ç”¨è§£æ„ ps : åŒæ ·å¯ä»¥ä½œç”¨äºç»“æ„ä½“ï¼ŒæŒ‡é’ˆï¼Œæšä¸¾ (3) å¯ä»¥åŠ ä¸Šifæ¥å®ˆå« (4) ç»‘å®šå˜é‡ if let å’Œ where let è¡¨è¾¾å¼(1) if let å’Œ match ç›¸åŒçš„åœ°æ–¹æ˜¯ (2) while letä¸ªäººæ„Ÿè§‰while let è¯­æ³•æ˜¯ä¸ºäº†ç®€åŒ–å¦‚ä¸‹çš„ä¸€ç§æ–¹æ³•ä½¿ç”¨loopå¾ªç¯çš„ä¸€ç§æ–¹æ³• rust å˜é‡ç³»ç»Ÿ(1) booleanrust çš„booleanç±»å‹å’Œå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­çš„booleanç±»å‹å…¶å®æ²¡æœ‰ä»€ä¹ˆæœ¬è´¨ä¸Šçš„åŒºåˆ« rust çš„ boolean ç±»å‹å¯ä»¥é€šè¿‡as è¿ç®—ç¬¦å¼ºåˆ¶è½¬æ¢æˆ int ç±»å‹çš„è¿ç®—ç¬¦å· (2) æ•°å­—ç±»å‹rust çš„æ•°å­—ç±»å‹å…¶å®æ˜¯æœ‰è§„å¾‹å¯å¾ªçš„ æœ‰ç¬¦å·æ•´å‹å’Œæ— ç¬¦å·æ•´å‹ u8-128 i8 - 128 æœ‰ç¬¦å·æ— ç¬¦å·åŠ¨æ€æ•´å‹ isize usize 32-64 ä½ä¹‹é—´è½®æ¢ æµ®ç‚¹ç±»å‹æ”¯æŒå•ç²¾åº¦å’ŒåŒç²¾åº¦ 0x 0o 0b å‰ç¼€åˆ†åˆ«è¡¨ç¤ºåå…­è¿›åˆ¶\\å…«è¿›åˆ¶å’Œ\\äºŒè¿›åˆ¶ (3) ç¬¦å·ç±»å‹rust çš„ç¬¦å·ç±»å‹æ˜¯ä½¿ç”¨ â€˜â€™ æ¥è¿›è¡Œå®šä¹‰çš„ æ”¯æŒunicode ç¼–ç ,å  4 ä¸ªå­—èŠ‚ char ç±»å‹å¯ä»¥ä½¿ç”¨as è¿›è¡Œæ“ä½œ, å½“ä½¿ç”¨asçš„æ—¶å€™å°†ä¼š è‡ªåŠ¨è½¬æ¢æˆi8 ç±»å‹ , æœ‰äº›ç‰¹æ®Šå­—ç¬¦å¯èƒ½ä¼šåœ¨é«˜ä½æˆªæ–­ (4) rust èŒƒå›´ç±»å‹rust æ”¯æŒä¸€ç§ç‰¹æ®Šçš„ç±»å‹å«åšèŒƒå›´ç±»å‹,æä¾›ä¸¤ç§æ–¹å¼è¡¨ç¤ºèŒƒå›´ ,(1..2)å·¦å¼€å³é—­å’Œ(1..&#x3D;2)å…¨é—­ (5) åˆ‡ç‰‡ç±»å‹rusté’ˆå¯¹æ•°ç»„æœ‰ä¸€ç§ç‰¹æ®Šçš„ç±»å‹å«åšåˆ‡ç‰‡ç±»å‹,è¿™ç§ç±»å‹å¯ä»¥å°†æ•°ç»„çš„ä¸€éƒ¨åˆ†çš„ç´¢å¼•å¼•ç”¨å‡ºæ¥ ###(6) String ç±»å‹ rust æä¾›äº†ä¸¤ç§ç±»å‹çš„å­—ç¬¦ä¸² str: æ˜¯å­—ç¬¦ä¸²åˆ‡ç‰‡è¿™ä¸ªç±»å‹æ˜¯é™æ€ç±»å‹,ä¸å¯ä¿®æ”¹,å›ºå®šé•¿åº¦ String : æ˜¯åŠ¨æ€å­—ç¬¦ä¸²ç±»å‹,å¯ä¿®æ”¹é•¿åº¦ (7) rustç‰¹æ®Šç±»å‹ å…ƒç»„ å…ƒç»„è¡¨ç¤ºä¸€ç¾¤ç‰¹æ®Šçš„æ•°æ®é›†åˆ,å¯ä»¥è¡¨ç¤ºä¸ºä¸åŒçš„ç±»å‹ æ³¨æ„ å…ƒç»„å¯ä»¥å®ç°å‡½æ•°å¤šè¿”å›å›å€¼å’Œä½¿ç”¨letè§£æ„èµ‹å€¼ å…ƒç»„ rust æ”¯æŒä¸‰ç§ç»“æ„ä½“ å…·ä½“åç»“æ„ä½“ æ³¨æ„: &self æ–¹æ³•è¡¨ç¤ºçš„æ˜¯è¿™ä¸ªç»“æ„ä½“è‡ªå·±çš„å¼•ç”¨ å…ƒç»„ç»“æ„ä½“ å•å…ƒç»“æ„ä½“","date":"2024-12-31","categories":["rust"]},{"title":"rustæ ¸å¿ƒ-æ‰€æœ‰æƒé—®é¢˜","url":"/2024/12/31/rustæ ¸å¿ƒ-æ‰€æœ‰æƒé—®é¢˜/","content":"åœ¨rustä¸­ï¼Œæ‰€æœ‰æƒæœ‰ä¸€ä¸‹çš„å‡ ä¸ªè§„åˆ™ å—çº§èŒƒå›´ä¸­ï¼Œæ‰€æœ‰æƒå‘ä¸‹ä¼ å¯¼ ä¸€ä¸ªå˜é‡åªèƒ½æ‹¥æœ‰ä»–è‡ªå·±æˆ–è€…æ¯”è‡ªå·±å°çš„ä½œç”¨åŸŸ ï¼Œ å¯ä»¥ä½¿ç”¨é¢†åŸŸè¿”å›å€¼æ‰©å±•ä½œç”¨é¢†åŸŸ ä½¿ç”¨è¡¨è¾¾å¼è¿”å›å€¼å³å¯ å…¨å±€èŒƒå›´ä¸€ä¸ªå˜é‡çš„æ‰€æœ‰æƒåªèƒ½å”¯ä¸€æŒæœ‰ ä»»ä½•ä¸€ä¸ªå˜é‡çš„æ‰€æœ‰æƒåªèƒ½æœ‰ä¸€ä¸ªå˜é‡æŒæœ‰ ä¸¾ä¸€ä¸ª rust ç§»åŠ¨çš„ä¾‹å­ å‡½æ•°èŒƒå›´ä¼ å…¥å‚æ•°å’Œè¿”å›å‚æ•°éƒ½å¯ä»¥è½¬ç§»æ‰€æœ‰æƒ å½“æ˜¯å‡½æ•°çš„æ—¶å€™ ï¼Œ å¯ä»¥åŠ¨æ€çš„è½¬ç§»å¯¹åº”çš„æ‰€æœ‰æƒï¼Œç±»ä¼¼è§„åˆ™1 ï¼Œ è°ƒç”¨å‡½æ•°çš„èŒƒå›´å¤±å»ä¼ å…¥å˜é‡çš„æ‰€æœ‰æƒ ä½¿ç”¨å¼•ç”¨å’Œåˆ†ç‰‡ç®€åŒ–æ‰€æœ‰æƒè½¬ç§»ä¸Šé¢çš„è§„åˆ™3 æˆ‘ä»¬ä¼šå‘ç°æ‰€æœ‰æƒæ¯æ¬¡ç¼–å†™çš„æ—¶å€™éƒ½éœ€è¦è€ƒè™‘è¿›æ¥ ï¼Œ è¿™æ ·å°±æœ‰å¾ˆå¤šå‡†å¤‡å·¥ä½œå»åš , rustæä¾›äº†ä¸€ä¸ªæ–¹æ³•æ¥ç®€åŒ–æ‰€æœ‰æƒè½¬ç§»é—®é¢˜ å¼•ç”¨ä¼ å‚å¯ä»¥ç®€åŒ–æ‰€æœ‰æƒè½¬ç§»ï¼Œä¿æŒè°ƒç”¨è€…æ‰€æœ‰æƒä¸å˜ å€Ÿé˜…å’Œæ™®é€šæœ¬è´¨ä¸Šä¸Šç›¸åŒ ï¼Œ åªæ˜¯ä¸ºäº†æ–¹ä¾¿å‡½æ•°åšæ‰€æœ‰æƒè½¬ç§»é™åˆ¶ è¿™æ ·ä¼šå‡ºé”™ rust ç¦æ­¢å¤šæŒ‡é’ˆå…±äº«ç›¸åŒå˜é‡ ï¼Œ å¦‚æœå­˜åœ¨ä»¥æœ€åä¸€ä¸ªä¸ºå‡† ,åªé’ˆå¯¹å¯å˜å¼•ç”¨ å¯å˜ä¸ä¸å¯å˜å¼•ç”¨ç»„åˆçš„æƒ…å†µä¸‹ï¼Œè¦ä¿è¯åœ¨ä¸å¯å˜å¼•ç”¨å®šä¹‰ä½¿ç”¨ä¹‹é—´ï¼Œä¸å­˜åœ¨æ•°æ®ä¿®æ”¹æˆ–è€…å¯å˜å¼•ç”¨å­˜åœ¨ æ³¨æ„ä¸€ä¸ªåœ°æ–¹å°±æ˜¯ push_str æœ¬èº«ä¹Ÿæ˜¯ä½¿ç”¨å€Ÿé˜… ï¼Œ å¯¹è±¡å†…å†™æ³•ï¼Œç­‰ä»·äºä¸‹é¢çš„è¿™ä¸ªé€»è¾‘ è¿™é‡Œå¼ºåˆ¶åˆ·æ–°äº†æ‰€æœ‰å…³äºaçš„å¼•ç”¨éƒ½æ˜¯ä¸ºæœ€åæ“ä½œäº†è¿™ä¸ªaçš„ä½ç½® rust å½“å‡½æ•°æœ‰å€Ÿé˜…å¹¶ä¸”è¿”å›å€¼ä¹Ÿæ˜¯å€Ÿé˜…çš„æ—¶å€™ ï¼Œ åœ¨rustä¸­è¿”å›å€¼å¿…ç„¶ä¸ºä¼ å…¥çš„å€Ÿé˜…çš„å­é›†ï¼Œè¿™æ ·ç›¸åŒç±»å‹çš„å€Ÿé˜…ä¼šè¢«è®¤ä¸ºé‡æ–°å€Ÿé˜… rustä¸èƒ½åœ¨å‡½æ•°ä¸­è¿”å›ä½†å‰ç¯å¢ƒç”Ÿæˆçš„å€Ÿé˜…ç±»å‹ ï¼Œ å› ä¸ºå€Ÿé˜…åœ¨rustä¸­æ˜¯ä¸€ä¸ªéå¸¸ç‰¹æ®Šçš„å­˜åœ¨ ï¼Œ ç”¨æ¥è§£å†³å‡½æ•°æ‰€æœ‰æƒè½¬ç§»çš„é—®é¢˜çš„ï¼Œæ‰€ä»¥rustå¯¹å€Ÿé˜…çš„èŒƒå›´æ–¹æ³•æ˜¯ï¼Œå¯¹äºå€Ÿé˜…ç”Ÿæ•ˆçš„ä½œç”¨é¢†åŸŸèŒƒå›´åªæœ‰æœ€åä¸€ä¸ªå€Ÿé˜…ç”Ÿæ•ˆ ï¼Œ ruståªæ”¯æŒé¢†åŸŸèŒƒå›´ç¼©å° ï¼Œ ä¸æ”¯æŒå‡½æ•°è¿”å›å€¼å¯¼è‡´é¢†åŸŸèŒƒå›´æ‰©å¤§ ä¸¾ä¾‹å­ï¼š ruståªæ”¯æŒé¢†åŸŸèŒƒå›´ç¼©å° ï¼Œ ä¸æ”¯æŒå‡½æ•°è¿”å›å€¼å¯¼è‡´é¢†åŸŸèŒƒå›´æ‰©å¤§ çœ‹ä¸€ä¸ªå‡½æ•°åŠ å¼•ç”¨çš„å¤æ‚ä¾‹å­ ä»¥ä¸Šçš„b c d åœ¨rustä¸­éƒ½æ˜¯è®¤ä¸ºå’Œ&mut a ä¸€æ ·çš„å¼•ç”¨ å› ä¸ºå‡½æ•°å’Œè¿”å›ä¹‹å€¼çš„ç±»å‹ç›¸åŒ ï¼Œæ‰€ä»¥æœ€ååªèƒ½æ˜¯ d rust åˆ‡ç‰‡æ³¨æ„ä¸€ä¸ªç‚¹å°±è¡Œäº† åˆ‡ç‰‡ç±»å‹ä¸å¯ä¿®æ”¹ ï¼Œ ä»å®šä¹‰åˆ°ä½¿ç”¨ä¹‹é—´å…ƒæ•°ç»„å¯¹åº”çš„åˆ‡ç‰‡èŒƒå›´ä¸å¯å˜æ›´ å¼•ç”³ > rust å¯¹åº”çš„åˆ‡ç‰‡ç±»å‹å¿…é¡»æ˜¯& å¼€å¤´çš„ï¼Œå› ä¸ºåˆ‡ç‰‡æœ¬è´¨ä¸Šä¸ºå…ƒæ•°ç»„çš„ä¸€æ®µå¼•ç”¨ï¼Œæ‰€æœ‰å¿…é¡»ç”¨æŒ‡é’ˆ","date":"2024-12-31","categories":["rust"]},{"title":"java-basev2","url":"/2024/12/31/java-basev2/","content":"js å¯¹è±¡ å£°æ˜ä¸€ä¸ªå¯¹è±¡ é’ˆå¯¹å±æ€§ç±»å‹ä¿®æ”¹ js ä¿®æ”¹è¿™äº›å±æ€§å¯ä»¥ä½¿ç”¨jsçš„ Objectã€‚definePropertyæ–¹æ³•è¿›è¡Œä¿®æ”¹ é’ˆå¯¹å±æ€§ç±»å‹çš„è¯»å– object å¯¹è±¡å±æ€§åˆå¹¶ es6 å¯¹è±¡å£°æ˜ç®€å†™æ–¹æ³• å±æ€§åç§°å¤å†™ å­—ç¬¦ä¸²ï¼ˆåŠ¨æ€ï¼‰å±æ€§ç›´æ¥èµ‹å€¼ å¿«é€Ÿå‡½æ•°å‘½å å¯¹è±¡è§£æ„ åŸå‹é“¾ ç»§æ‰¿ - å¿½ç•¥ class ç±» ç±»å£°æ˜ ç±»ä¸€èˆ¬éƒ½æ˜¯åˆå§‹åŒ–æ—¶å€™å®šä¹‰çš„ ï¼Œ ä¸æƒ³å‡½æ•°å¯ä»¥åœ¨ä»»æ„çš„ä½ç½®å®šä¹‰ï¼Œæ‰€ä»¥ç±»éœ€è¦åœ¨ä¸€å¼€å§‹å°±å®šä¹‰å¥½ ç±»æ„æˆ ç‰¹æ®Šåœ°æ–¹ï¼Œ è·å–è¡¨è¾¾å¼åç§° js ç±»å…¶å®æ˜¯ä¸€ä¸ªç‰¹æ®Šå‡½æ•°å¯¹è±¡æ˜¯ç»‘å®šæ„é€ å‡½æ•° â€“ ç»§æ‰¿ï¼Ÿ ä½¿ç”¨ç»„åˆ å¿½ç•¥ js å‡½æ•°js çš„å‡½æ•°ç°åœ¨å’Œä¸€äº›åŸºæœ¬è¯­è¨€çš„å‡½æ•°æ²¡å•¥åŒºåˆ« ï¼Œ ä¸»è¦è¦æ³¨æ„çš„åœ°æ–¹é‚£ä¸ª ç®­å¤´å‡½æ•° ç®­å¤´å‡½æ•°éœ€è¦å’Œthis å…³é”®å­—ä¸€èµ·è¯´ æ²¡æœ‰ç®­å¤´å‡½æ•°çš„æ—¶å€™ thisæ˜¯è¿è¡Œæ—¶ç¡®å®šçš„ï¼Œ å¦‚æœæœ‰ç®­å¤´å‡½æ•°ï¼Œ thisæ˜¯å£°æ˜æ—¶å€™å®šä¹‰çš„ å‡½æ•°å†…éƒ¨çš„ç‰¹æ®Šå¯¹è±¡ jsæ”¯æŒè¿™ä¸ªçš„åŸå› æ˜¯jsæ”¯æŒå‡½æ•°é‡å‘½å ï¼Œ é‡å‘½åçš„å‡½æ•°é€’å½’ä¼šæœ‰é—®é¢˜ ï¼Œ æ‰€ä»¥ä¸€èˆ¬å†…éƒ¨ä½¿ç”¨è¿™ä¸ªæ–¹æ³• new target &#x3D;> è¿™ä¸ªç”¨æ¥æ£€æµ‹å½“å‰å‡½æ•°æ˜¯ä¸æ˜¯ä½¿ç”¨new æ–¹æ³•åˆ›å»ºå¯¹è±¡äº† js å‡½æ•° apply call bind åŒºåˆ« call ã€bind ã€ apply è¿™ä¸‰ä¸ªå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°éƒ½æ˜¯ this çš„æŒ‡å‘å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°å·®åˆ«å°±æ¥äº†ï¼šcall çš„å‚æ•°æ˜¯ç›´æ¥æ”¾è¿›å»çš„ï¼Œç¬¬äºŒç¬¬ä¸‰ç¬¬ n ä¸ªå‚æ•°å…¨éƒ½ç”¨é€—å·åˆ†éš”ï¼Œç›´æ¥æ”¾åˆ°åé¢ obj.myFun.call(db,â€™æˆéƒ½â€™, â€¦ ,â€™stringâ€™ )ã€‚apply çš„æ‰€æœ‰å‚æ•°éƒ½å¿…é¡»æ”¾åœ¨ä¸€ä¸ªæ•°ç»„é‡Œé¢ä¼ è¿›å» obj.myFun.apply(db,[â€˜æˆéƒ½â€™, â€¦, â€˜stringâ€™ ])ã€‚bind é™¤äº†è¿”å›æ˜¯å‡½æ•°ä»¥å¤–ï¼Œå®ƒ çš„å‚æ•°å’Œ call ä¸€æ ·ã€‚ å‡½æ•°ä½¿ç”¨çš„æ—¶å€™éœ€è¦ç‰¹æ®Šæ³¨æ„çš„åœ°æ–¹ jså°¾è°ƒç”¨ä¼˜åŒ–ä¾‹å­-è²è–„çº³å¦¾æ•°åˆ— åŒ¿åå‡½æ•°çš„ä½œç”¨åŸŸèŒƒå›´ åŒ¿åå‡½æ•°ä¼šç»§æ‰¿çˆ¶å‡½æ•°æ‰€æœ‰å¯ä»¥è®¿é—®çš„å˜é‡ï¼ˆä½œç”¨åŸŸï¼‰ åŒ¿åå‡½æ•°æ˜¯æ°¸è¿œæ²¡æœ‰åŠæ³•è®¿é—®åˆ°å¤–éƒ¨å‡½æ•°çš„thisï¼Œ this ä¸€å®šæ˜¯å£°æ˜æ—¶å€™ç¡®è®¤çš„ çº¢åŒ…ä¹¦ 10.16 å†æ”¯æŒ","date":"2024-12-31","categories":["å‰ç«¯"],"tags":["javascript"]},{"title":"javascript-ECMAScript6ä½¿ç”¨å’Œç ”ç©¶-letå’Œcount","url":"/2024/12/31/javascript-ECMAScript6ä½¿ç”¨å’Œç ”ç©¶-letå’Œcount/","content":"ä¸€.letå…³é”®å­—ç‰¹æ€§(1)letå…³é”®å­—çš„é—­åŒ…ç‰¹æ€§ åˆ—å­ä¸€ è¾“å‡º: è¿™ä¸ªä¾‹å­å¯ä»¥ä½“ç°ç»™å‡ºletå…·æœ‰çš„ä»¥ä¸‹å‡ ä¸ªç‰¹æ€§ è‡ªé—­åŒ…æ€§:ä»ä½¿ç”¨varå’Œä½¿ç”¨letè¾“å‡ºçš„å·®å¼‚æ€§å¯ä»¥çœ‹å‡ºæ¥,forå¾ªç¯(æˆ–è€…whileå¾ªç¯)ä½¿ç”¨letçš„æ—¶å€™å€¼å°±æ˜¯è‡ªå·±å¾ªç¯æ—¶å€™çš„å€¼è€Œä¸æ˜¯æœ€ç»ˆå€¼ å—çº§ä½œç”¨äºç‹¬å æ€§:letåªæœ‰åœ¨è‡ªå·±çš„ä½œç”¨äºæ‰æœ‰æ•ˆ,ä¸Šé¢çš„ReferenceErroræŠ¥é”™å¯ä»¥ä½“ç°å‡ºæ¥,æ³¨æ„:forå¾ªç¯ä¸­è®¾ç½®å˜é‡çš„æ—¶å€™ä¹Ÿæ˜¯ä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸ(æœ‰å‘ç‚¹è§ä¸‹é¢çš„ä¾‹å­) ä¾‹å­äºŒ è¾“å‡º ç¬¬äºŒä¸ªforå¾ªç¯åªè¾“å‡º 2 æ˜¯å› ä¸º letè™½ç„¶æä¾›äº†é—­åŒ…çš„ç‰¹æ€§ä½†æ˜¯æ²¡æœ‰åœ¨æœ¬è´¨ä¸Šæ”¹å˜jsçš„ç‰¹æ€§,æ˜¯æœ‰å¾ªç¯2åœ¨åˆ°è¾¾æ—¶é—´çš„æ—¶å€™å€™è¯»å–çš„æ˜¯è‡ªå·±å—çº§ä½œç”¨åŸŸä¸­çš„letå…ƒç´ çš„å€¼ ä¾‹å­ä¸‰ è¿™ä¸ªä¾‹å­å¯ä»¥ä½“ç°ç»™å‡ºletçš„ä»¥ä¸‹å‡ ä¸ªç‰¹æ€§: letå’Œvarä¸åŒ:letä½¿ç”¨å¿…é¡»å…ˆè¿›è¡Œå£°æ˜å¦åˆ™ä¼šæŠ¥é”™,varä¼šè¾“å‡ºunderfind letå’Œvarä¸åŒ:letä¸å…è®¸å’Œvaræˆ–è€…letå˜é‡åœ¨ç›¸åŒçš„ä½œç”¨åŸŸä¸‹åŒå ä¾‹å­å››æš‚æ—¶æ€§æ­»åŒº è¾“å‡º è¿™ä¸ªä¾‹å­å¯ä»¥ä½“ç°ç»™å‡ºletçš„ä»¥ä¸‹ç‰¹æ€§:letå±æ€§åŒºåŸŸæ€§ç‹¬ç«‹,å¤–éƒ¨ä¸ä¼šå½±å“åˆ°å†…éƒ¨,å¤§å¤šæ•°å˜æˆè¯­è¨€éƒ½è¿™ä¸ªç‰¹æ€§ è¿™ä¸ªä¾‹å­å¯ä»¥ä½“ç°ç»™å‡ºletçš„ä»¥ä¸‹ç‰¹æ€§:TDZ åœ¨å˜é‡å£°æ˜å‰éƒ½ä¼šä¸èƒ½ä½¿ç”¨ åªè¦å‡ºç°ç”Ÿå‘½å‰ä½¿ç”¨äº†å˜é‡éƒ½ä¼šå‡ºç°TDZé”™è¯¯ å‘ç‚¹è®°å½• äºŒ.constå…³é”®å­—è¿™ä¸ªå…³é”®å­—çš„å·¦å³å°±æ˜¯å¸¸é‡,ä½†æ˜¯ä»–æ˜¯é”å®šå˜é‡çš„åœ°å€çš„,å…¶ä½™çš„å’Œletç›¸åŒ æ³¨æ„:å› ä¸ºæ˜¯é”å®šåœ°å€çš„æ‰€ä»¥éœ€è¦è¿›è¡Œå¯¹è±¡çš„é”å®šæ˜¯ä¸å®‰å…¨çš„(å¯¹è±¡ä¸­ä¹Ÿæœ‰æŒ‡å‘åœ°å€çš„ä¸œä¸œ) å¦‚æœè¦å®ç°é”å¯¹è±¡é‚£ä¹ˆå°±ä½¿ç”¨","date":"2024-12-31","categories":["å‰ç«¯"],"tags":["javascript"]},{"title":"javascript-ECMAScript6ä½¿ç”¨å’Œç ”ç©¶-å‡½æ•°","url":"/2024/12/31/javascript-ECMAScript6ä½¿ç”¨å’Œç ”ç©¶-å‡½æ•°/","content":"ECMAScript6ä½¿ç”¨å’Œç ”ç©¶-å‡½æ•° æ³¨æ„:å‚æ•°å˜é‡æ˜¯é»˜è®¤å£°æ˜çš„ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨letæˆ–constå†æ¬¡å£°æ˜ã€‚ä½¿ç”¨å‚æ•°é»˜è®¤å€¼æ—¶ï¼Œå‡½æ•°ä¸èƒ½æœ‰åŒåå‚æ•°ã€‚ æ³¨æ„:å‡½æ•°çš„è¡¨è¾¾å¼ä¸­å¯ä»¥æ·»åŠ ä»»æ„çš„è¡¨è¾¾å¼ é»˜è®¤å‚æ•°å¯ä»¥ä½¿ç”¨underfindè¡¥ä½ å‡½æ•°å‚æ•°å’Œä½œç”¨åŸŸçš„å‘ç‚¹ åˆ©ç”¨å‚æ•°é»˜è®¤å€¼ï¼Œå¯ä»¥æŒ‡å®šæŸä¸€ä¸ªå‚æ•°ä¸å¾—çœç•¥ï¼Œå¦‚æœçœç•¥å°±æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ å¯ä»¥å°†å‚æ•°é»˜è®¤å€¼è®¾ä¸ºundefinedï¼Œè¡¨æ˜è¿™ä¸ªå‚æ•°æ˜¯å¯ä»¥çœç•¥çš„ã€‚ ES6ä¸­å‡½æ•°çš„ä½œç”¨åŸŸåŒæ ·æ»¡è¶³ç›¸å…³çš„ç§æœ‰åŒ–çš„ç‰¹æ€§ä½†æ˜¯ä¸€å®šè¦è®°ä½,ES6åœ¨è¿™æ–¹é¢å’ŒES5çš„åŒºåˆ«æœ¬è´¨ä¸Šæ˜¯,Es6ä½¿ç”¨çš„æ˜¯å®šä¹‰çš„ä½ç½®è€ŒES5ä½¿ç”¨ç»™çš„è¿è¡Œçš„ä½ç½® ES6ä½¿ç”¨é»˜è®¤å‚æ•°è¿˜å¯ä»¥æŠ›å‡ºå¼‚å¸¸ ES6å‡çº§ç‰ˆç®­å¤´å‡½æ•° ä¸Šé¢çš„ç®­å¤´å‡½æ•°ç­‰åŒäº å¦‚æœç®­å¤´å‡½æ•°ä¸éœ€è¦å‚æ•°æˆ–éœ€è¦å¤šä¸ªå‚æ•°ï¼Œå°±ä½¿ç”¨ä¸€ä¸ªåœ†æ‹¬å·ä»£è¡¨å‚æ•°éƒ¨åˆ†ã€‚ æ³¨æ„å¦‚æœåƒç›´æ¥è¿”å›å¯¹è±¡éœ€è¦åœ¨å¯¹è±¡å¤–é¢å¥—ä¸Š() ç®­å¤´å‡½æ•°å¯ä»¥ä¸å˜é‡è§£æ„ç»“åˆä½¿ç”¨ã€‚ ç®­å¤´å‡½æ•°æœ‰å‡ ä¸ªä½¿ç”¨æ³¨æ„ç‚¹ã€‚ å‡½æ•°ä½“å†…çš„thiså¯¹è±¡ï¼Œå°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚ ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯ä»¥ä½¿ç”¨newå‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ ä¸å¯ä»¥ä½¿ç”¨argumentså¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨å‡½æ•°ä½“å†…ä¸å­˜åœ¨ã€‚å¦‚æœè¦ç”¨ï¼Œå¯ä»¥ç”¨ rest å‚æ•°ä»£æ›¿ã€‚ ä¸å¯ä»¥ä½¿ç”¨yieldå‘½ä»¤ï¼Œå› æ­¤ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œ Generator å‡½æ•°ã€‚ thisæŒ‡å‘çš„å›ºå®šåŒ–ï¼Œå¹¶ä¸æ˜¯å› ä¸ºç®­å¤´å‡½æ•°å†…éƒ¨æœ‰ç»‘å®šthisçš„æœºåˆ¶ï¼Œå®é™…åŸå› æ˜¯ç®­å¤´å‡½æ•°æ ¹æœ¬æ²¡æœ‰è‡ªå·±çš„thisï¼Œå¯¼è‡´å†…éƒ¨çš„thiså°±æ˜¯å¤–å±‚ä»£ç å—çš„thisã€‚æ­£æ˜¯å› ä¸ºå®ƒæ²¡æœ‰thisï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°ã€‚ç›¸å½“ä¸€ä¸‹é¢è¿™ç§å†™æ³• é™¤äº†thisï¼Œä»¥ä¸‹ä¸‰ä¸ªå˜é‡åœ¨ç®­å¤´å‡½æ•°ä¹‹ä¸­ä¹Ÿæ˜¯ä¸å­˜åœ¨çš„ï¼ŒæŒ‡å‘å¤–å±‚å‡½æ•°çš„å¯¹åº”å˜é‡ï¼šargumentsã€superã€new.targetã€‚ åŒå†’å·è¿ç®—ç¬¦ç®­å¤´å‡½æ•°å¯ä»¥ç»‘å®šthiså¯¹è±¡ï¼Œå¤§å¤§å‡å°‘äº†æ˜¾å¼ç»‘å®šthiså¯¹è±¡çš„å†™æ³•ï¼ˆcallã€applyã€bindï¼‰ã€‚ä½†æ˜¯ï¼Œç®­å¤´å‡½æ•°å¹¶ä¸é€‚ç”¨äºæ‰€æœ‰åœºåˆï¼Œæ‰€ä»¥ç°åœ¨æœ‰ä¸€ä¸ªææ¡ˆï¼Œæå‡ºäº†â€œå‡½æ•°ç»‘å®šâ€ï¼ˆfunction bindï¼‰è¿ç®—ç¬¦ï¼Œç”¨æ¥å–ä»£callã€applyã€bindè°ƒç”¨ã€‚ å‡½æ•°ç»‘å®šè¿ç®—ç¬¦æ˜¯å¹¶æ’çš„ä¸¤ä¸ªå†’å·ï¼ˆ::ï¼‰ï¼ŒåŒå†’å·å·¦è¾¹æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå³è¾¹æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚è¯¥è¿ç®—ç¬¦ä¼šè‡ªåŠ¨å°†å·¦è¾¹çš„å¯¹è±¡ï¼Œä½œä¸ºä¸Šä¸‹æ–‡ç¯å¢ƒï¼ˆå³thiså¯¹è±¡ï¼‰ï¼Œç»‘å®šåˆ°å³è¾¹çš„å‡½æ•°ä¸Šé¢ã€‚ å¦‚æœåŒå†’å·å·¦è¾¹ä¸ºç©ºï¼Œå³è¾¹æ˜¯ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼Œåˆ™ç­‰äºå°†è¯¥æ–¹æ³•ç»‘å®šåœ¨è¯¥å¯¹è±¡ä¸Šé¢ã€‚","date":"2024-12-31","categories":["å‰ç«¯"],"tags":["javascript"]},{"title":"javascript-ECMAScript6ä½¿ç”¨å’Œç ”ç©¶-å˜é‡çš„è§£æ„èµ‹å€¼","url":"/2024/12/31/javascript-ECMAScript6ä½¿ç”¨å’Œç ”ç©¶-å˜é‡çš„è§£æ„èµ‹å€¼/","content":"å˜é‡ç»“æ„èµ‹å€¼åœ¨pythonä¸­å…¶å®æ˜¯éå¸¸å¸¸è§çš„æŠ€æœ¯,è¿™é‡Œæ•´ç†ä¸€ä¸‹ES6çš„ç›¸å…³å˜é‡ç»“æ„èµ‹å€¼ ä¸€.é’ˆå¯¹æ•°ç»„çš„è§£æ„æ–¹æ³•(1)ä½¿ç”¨ç®€å•çš„å®ä¾‹ è¾“å‡ºç»“æœï¼š å¼•ç”³ï¼šè¿˜æœ‰ä¸€ä¸­ç‰¹æ®Šçš„æƒ…å†µæ˜¯å®ç°äº† Iterator æ¥å£ è¿™ä¸ªä¹‹åå†è¿›è¡Œè®¨è®º ä½¿ç”¨é»˜è®¤å€¼ æ³¨æ„ï¼šES6 å†…éƒ¨ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ&#x3D;&#x3D;&#x3D;ï¼‰ï¼Œåˆ¤æ–­ä¸€ä¸ªä½ç½®æ˜¯å¦æœ‰å€¼ã€‚æ‰€ä»¥ï¼Œåªæœ‰å½“ä¸€ä¸ªæ•°ç»„æˆå‘˜ä¸¥æ ¼ç­‰äºundefinedï¼Œé»˜è®¤å€¼æ‰ä¼šç”Ÿæ•ˆã€‚ (2)é’ˆå¯¹å¯¹è±¡ ä¾‹å­ è¾“å‡º æ€»ä½“ä¸Šå°±æ˜¯è¿™ä¸¤ç§å½¢å¼,å…¶å®ä¹Ÿæ˜¯å°†ä¸€äº›å˜é‡æ·»åŠ åˆ°ç©ºé—´ä¸­è€Œå·²,åªæ˜¯ä½¿ç”¨å¯¹è±¡éœ€è¦æŒ‡å®šæ˜ å°„å…³ç³»ç½¢äº†,æ·±å…¥ç†è§£è§ä¸‹ å¯¹è±¡çš„ç»„åˆèµ‹å€¼å¯ä»¥å¼•ç”¨å¤–éƒ¨å‚æ•°çš„ ä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤å€¼,é»˜è®¤å€¼ç”Ÿæ•ˆçš„æ¡ä»¶æ˜¯ï¼Œå¯¹è±¡çš„å±æ€§å€¼ä¸¥æ ¼ç­‰äºundefinedã€‚ (3)å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼ è¿˜æ”¯æŒlength (4)å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼ å‡½æ•°çš„å‚æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨è§£æ„èµ‹å€¼ã€‚ å‡½æ•°å‚æ•°çš„è§£æ„ä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤å€¼ã€‚ ä¸Šé¢ä»£ç æ˜¯ä¸ºå‡½æ•°moveçš„å‚æ•°æŒ‡å®šé»˜è®¤å€¼ï¼Œè€Œä¸æ˜¯ä¸ºå˜é‡xå’ŒyæŒ‡å®šé»˜è®¤å€¼ï¼Œæ‰€ä»¥ä¼šå¾—åˆ°ä¸å‰ä¸€ç§å†™æ³•ä¸åŒçš„ç»“æœã€‚ äºŒ.æ€»ç»“-ç”¨é€”ï¼ˆ1ï¼‰äº¤æ¢å˜é‡çš„å€¼ ä¸Šé¢ä»£ç äº¤æ¢å˜é‡xå’Œyçš„å€¼ï¼Œè¿™æ ·çš„å†™æ³•ä¸ä»…ç®€æ´ï¼Œè€Œä¸”æ˜“è¯»ï¼Œè¯­ä¹‰éå¸¸æ¸…æ™°ã€‚ ï¼ˆ2ï¼‰ä»å‡½æ•°è¿”å›å¤šä¸ªå€¼ å‡½æ•°åªèƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œå¦‚æœè¦è¿”å›å¤šä¸ªå€¼ï¼Œåªèƒ½å°†å®ƒä»¬æ”¾åœ¨æ•°ç»„æˆ–å¯¹è±¡é‡Œè¿”å›ã€‚æœ‰äº†è§£æ„èµ‹å€¼ï¼Œå–å‡ºè¿™äº›å€¼å°±éå¸¸æ–¹ä¾¿ã€‚ ï¼ˆ3ï¼‰å‡½æ•°å‚æ•°çš„å®šä¹‰ è§£æ„èµ‹å€¼å¯ä»¥æ–¹ä¾¿åœ°å°†ä¸€ç»„å‚æ•°ä¸å˜é‡åå¯¹åº”èµ·æ¥ã€‚ ï¼ˆ4ï¼‰æå– JSON æ•°æ® è§£æ„èµ‹å€¼å¯¹æå– JSON å¯¹è±¡ä¸­çš„æ•°æ®ï¼Œå°¤å…¶æœ‰ç”¨ã€‚ ä¸Šé¢ä»£ç å¯ä»¥å¿«é€Ÿæå– JSON æ•°æ®çš„å€¼ã€‚ ï¼ˆ5ï¼‰å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ æŒ‡å®šå‚æ•°çš„é»˜è®¤å€¼ï¼Œå°±é¿å…äº†åœ¨å‡½æ•°ä½“å†…éƒ¨å†å†™var foo &#x3D; config.foo || â€˜default fooâ€™;è¿™æ ·çš„è¯­å¥ã€‚ ï¼ˆ6ï¼‰éå† Map ç»“æ„ ä»»ä½•éƒ¨ç½²äº† Iterator æ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ç”¨forâ€¦ofå¾ªç¯éå†ã€‚Map ç»“æ„åŸç”Ÿæ”¯æŒ Iterator æ¥å£ï¼Œé…åˆå˜é‡çš„è§£æ„èµ‹å€¼ï¼Œè·å–é”®åå’Œé”®å€¼å°±éå¸¸æ–¹ä¾¿ã€‚ å¦‚æœåªæƒ³è·å–é”®åï¼Œæˆ–è€…åªæƒ³è·å–é”®å€¼ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ã€‚ ï¼ˆ7ï¼‰è¾“å…¥æ¨¡å—çš„æŒ‡å®šæ–¹æ³• åŠ è½½æ¨¡å—æ—¶ï¼Œå¾€å¾€éœ€è¦æŒ‡å®šè¾“å…¥å“ªäº›æ–¹æ³•ã€‚è§£æ„èµ‹å€¼ä½¿å¾—è¾“å…¥è¯­å¥éå¸¸æ¸…æ™°ã€‚","date":"2024-12-31","categories":["å‰ç«¯"],"tags":["javascript"]},{"title":"javascript-ECMAScript6ä½¿ç”¨å’Œç ”ç©¶-å—çº§ä½œç”¨åŸŸç»†èŠ‚","url":"/2024/12/31/javascript-ECMAScript6ä½¿ç”¨å’Œç ”ç©¶-å—çº§ä½œç”¨åŸŸç»†èŠ‚/","content":"å—çº§ä½œç”¨åŸŸ ES5 è§„å®šï¼Œå‡½æ•°åªèƒ½åœ¨é¡¶å±‚ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜ï¼Œä¸èƒ½åœ¨å—çº§ä½œç”¨åŸŸå£°æ˜ã€‚ ä¸Šé¢ä¸¤ç§å‡½æ•°å£°æ˜ï¼Œæ ¹æ® ES5 çš„è§„å®šéƒ½æ˜¯éæ³•çš„ã€‚ ä½†æ˜¯ï¼Œæµè§ˆå™¨æ²¡æœ‰éµå®ˆè¿™ä¸ªè§„å®šï¼Œä¸ºäº†å…¼å®¹ä»¥å‰çš„æ—§ä»£ç ï¼Œè¿˜æ˜¯æ”¯æŒåœ¨å—çº§ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜å‡½æ•°ï¼Œå› æ­¤ä¸Šé¢ä¸¤ç§æƒ…å†µå®é™…éƒ½èƒ½è¿è¡Œï¼Œä¸ä¼šæŠ¥é”™ã€‚ ES6 å¼•å…¥äº†å—çº§ä½œç”¨åŸŸï¼Œæ˜ç¡®å…è®¸åœ¨å—çº§ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜å‡½æ•°ã€‚ES6 è§„å®šï¼Œå—çº§ä½œç”¨åŸŸä¹‹ä¸­ï¼Œå‡½æ•°å£°æ˜è¯­å¥çš„è¡Œä¸ºç±»ä¼¼äºletï¼Œåœ¨å—çº§ä½œç”¨åŸŸä¹‹å¤–ä¸å¯å¼•ç”¨ã€‚ ä¸Šé¢ä»£ç åœ¨ ES5 ä¸­è¿è¡Œï¼Œä¼šå¾—åˆ°â€œI am inside!â€ï¼Œå› ä¸ºåœ¨ifå†…å£°æ˜çš„å‡½æ•°fä¼šè¢«æå‡åˆ°å‡½æ•°å¤´éƒ¨ï¼Œå®é™…è¿è¡Œçš„ä»£ç å¦‚ä¸‹ã€‚ ES6 å°±å®Œå…¨ä¸ä¸€æ ·äº†ï¼Œç†è®ºä¸Šä¼šå¾—åˆ°â€œI am outside!â€ã€‚å› ä¸ºå—çº§ä½œç”¨åŸŸå†…å£°æ˜çš„å‡½æ•°ç±»ä¼¼äºletï¼Œå¯¹ä½œç”¨åŸŸä¹‹å¤–æ²¡æœ‰å½±å“ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ çœŸçš„åœ¨ ES6 æµè§ˆå™¨ä¸­è¿è¡Œä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼Œæ˜¯ä¼šæŠ¥é”™çš„ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ åŸæ¥ï¼Œå¦‚æœæ”¹å˜äº†å—çº§ä½œç”¨åŸŸå†…å£°æ˜çš„å‡½æ•°çš„å¤„ç†è§„åˆ™ï¼Œæ˜¾ç„¶ä¼šå¯¹è€ä»£ç äº§ç”Ÿå¾ˆå¤§å½±å“ã€‚ä¸ºäº†å‡è½»å› æ­¤äº§ç”Ÿçš„ä¸å…¼å®¹é—®é¢˜ï¼ŒES6 åœ¨é™„å½• Bé‡Œé¢è§„å®šï¼Œæµè§ˆå™¨çš„å®ç°å¯ä»¥ä¸éµå®ˆä¸Šé¢çš„è§„å®šï¼Œæœ‰è‡ªå·±çš„è¡Œä¸ºæ–¹å¼ã€‚ å…è®¸åœ¨å—çº§ä½œç”¨åŸŸå†…å£°æ˜å‡½æ•°ã€‚å‡½æ•°å£°æ˜ç±»ä¼¼äºvarï¼Œå³ä¼šæå‡åˆ°å…¨å±€ä½œç”¨åŸŸæˆ–å‡½æ•°ä½œç”¨åŸŸçš„å¤´éƒ¨ã€‚ åŒæ—¶ï¼Œå‡½æ•°å£°æ˜è¿˜ä¼šæå‡åˆ°æ‰€åœ¨çš„å—çº§ä½œç”¨åŸŸçš„å¤´éƒ¨ã€‚æ³¨æ„ï¼Œä¸Šé¢ä¸‰æ¡è§„åˆ™åªå¯¹ ES6 çš„æµè§ˆå™¨å®ç°æœ‰æ•ˆï¼Œå…¶ä»–ç¯å¢ƒçš„å®ç°ä¸ç”¨éµå®ˆï¼Œè¿˜æ˜¯å°†å—çº§ä½œç”¨åŸŸçš„å‡½æ•°å£°æ˜å½“ä½œletå¤„ç†ã€‚ æ ¹æ®è¿™ä¸‰æ¡è§„åˆ™ï¼Œåœ¨æµè§ˆå™¨çš„ ES6 ç¯å¢ƒä¸­ï¼Œå—çº§ä½œç”¨åŸŸå†…å£°æ˜çš„å‡½æ•°ï¼Œè¡Œä¸ºç±»ä¼¼äºvarå£°æ˜çš„å˜é‡ã€‚ ä¸Šé¢çš„ä»£ç åœ¨ç¬¦åˆ ES6 çš„æµè§ˆå™¨ä¸­ï¼Œéƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºå®é™…è¿è¡Œçš„æ˜¯ä¸‹é¢çš„ä»£ç ã€‚ è€ƒè™‘åˆ°ç¯å¢ƒå¯¼è‡´çš„è¡Œä¸ºå·®å¼‚å¤ªå¤§ï¼Œåº”è¯¥é¿å…åœ¨å—çº§ä½œç”¨åŸŸå†…å£°æ˜å‡½æ•°ã€‚å¦‚æœç¡®å®éœ€è¦ï¼Œä¹Ÿåº”è¯¥å†™æˆå‡½æ•°è¡¨è¾¾å¼ï¼Œè€Œä¸æ˜¯å‡½æ•°å£°æ˜è¯­å¥ã€‚ å¦å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚ES6 çš„å—çº§ä½œç”¨åŸŸå…è®¸å£°æ˜å‡½æ•°çš„è§„åˆ™ï¼Œåªåœ¨ä½¿ç”¨å¤§æ‹¬å·çš„æƒ…å†µä¸‹æˆç«‹ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨å¤§æ‹¬å·ï¼Œå°±ä¼šæŠ¥é”™ã€‚","date":"2024-12-31","categories":["å‰ç«¯"],"tags":["javascript"]},{"title":"javascript-ES6-ES7-promise","url":"/2024/12/31/javascript-ES6-ES7-promise/","content":"promiseæ˜¯javascriptå¼‚æ­¥éé˜»å¡æ¡†æ¶","date":"2024-12-31","categories":["å‰ç«¯"],"tags":["javascript"]},{"title":"javascript-element-uiå­¦ä¹ ç¬”(ä¸€)","url":"/2024/12/31/javascript-element-uiå­¦ä¹ ç¬”-ä¸€-/","content":"","date":"2024-12-31","categories":["å‰ç«¯"],"tags":["javascript"]},{"title":"javascript-vueå­¦ä¹ ç¬”è®°(ä¸€)","url":"/2024/12/31/javascript-vueå­¦ä¹ ç¬”è®°-ä¸€-/","content":"è€ƒè™‘åˆ°è¦æé«˜å·¥ä½œçš„æ•ˆç‡ï¼Œé€šè¿‡è°ƒæŸ¥å‘ç°ä½¿ç”¨vueå¯ä»¥æé«˜å‰ç«¯è¿›è¡Œç¼–å†™æ—¶å€™çš„æ•ˆç‡ï¼Œæ‰€ä»¥å‡†å¤‡èŠ±è´¹ä¸¤å¤©çš„æ—¶é—´è¿›è¡Œvueçš„elementæ¡†æ¶çš„å­¦ä¹ å’Œä½¿ç”¨ å£°æ˜å¼æ¸²æŸ“å…¶å®è¿™ä¸ªå¾ˆå¥½ç†è§£å°±æ˜¯æŒ‡å®šäº†å˜é‡è®©æ¡†æ¶è‡ªåŠ¨çš„å¯¹ç›¸å…³çš„å‚æ•°é™„ä¸ŠæŒ‡å®šçš„å€¼ æ¡ä»¶ä¸å¾ªç¯vue é€šè¿‡ä½¿ç”¨v-if v-for æ ‡ç­¾å®ç°äº†å¾ªç¯æ“ä½œ v-for å¥½ç†è§£ç±»ä¼¼java ä¸­çš„for each è¡¨å•æ•°æ®åŠ¨æ€ç»‘å®šè¿™ä¸ªç‰¹æ€§é’ˆå¯¹ input textarea çš„ä½¿ç”¨v-model è¿›è¡Œæ•°æ®ç»‘å®š v-on å¯ä»¥ç»‘å®šåœ¨å¯¹è±¡ä¸­å®šä¹‰çš„å±æ€§ ç»„ä»¶åŒ–åº”ç”¨æ„å»º","date":"2024-12-31","categories":["å‰ç«¯"],"tags":["javascript"]},{"title":"javascript-ä»jsæ¥èŠèŠå¼‚æ­¥ç¼–ç¨‹","url":"/2024/12/31/javascript-ä»jsæ¥èŠèŠå¼‚æ­¥ç¼–ç¨‹/","content":"ä»jsæ¥èŠèŠå¼‚æ­¥ç¼–ç¨‹æ–‡ç« çš„ç›®çš„æ­å¼€goçš„ gorouter,c#çš„ async&#x2F;awaitç­‰ ä½¿ç”¨åŒæ­¥çš„å†™æ³•å†™å¼‚æ­¥ä»£ç çš„ç¥ç§˜é¢çº± , è¯æ˜å…¶æœ¬è´¨å°±æ˜¯ä¸€ä¸ªè¯­æ³•ç³– ä¸ºä»€ä¹ˆä½¿ç”¨jsæ¥è®²å¼‚æ­¥ç¼–ç¨‹å› ä¸ºjså¯ä»¥é€šè¿‡ç¼–ç¨‹è¯­è¨€è‡ªå·±çš„è¯­æ³•ç‰¹æ€§,å®ç°åŸç”Ÿè¯­è¨€ä¸æä¾›çš„åŒæ­¥åŒ–å¼‚æ­¥ç¼–ç¨‹ jså¼‚æ­¥æœ€åº•å±‚å†™æ³•promise promiseå‡ºå…¥çš„å›è°ƒå‡½æ•°æœ‰ä¸€å®šçš„è¦æ±‚ resolveå‡½æ•°çš„ä½œç”¨æ˜¯ï¼Œå°†Promiseå¯¹è±¡çš„çŠ¶æ€ä»â€œæœªå®Œæˆâ€å˜ä¸ºâ€œæˆåŠŸâ€ï¼ˆå³ä» pending å˜ä¸º resolvedï¼‰ï¼Œåœ¨å¼‚æ­¥æ“ä½œæˆåŠŸæ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå» rejectå‡½æ•°çš„ä½œç”¨æ˜¯ï¼Œå°†Promiseå¯¹è±¡çš„çŠ¶æ€ä»â€œæœªå®Œæˆâ€å˜ä¸ºâ€œå¤±è´¥â€ï¼ˆå³ä» pending å˜ä¸º rejectedï¼‰ï¼Œåœ¨å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œæŠ¥å‡ºçš„é”™è¯¯ï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ã€‚ Promiseå®ä¾‹ç”Ÿæˆä»¥åï¼Œå¯ä»¥ç”¨thenæ–¹æ³•åˆ†åˆ«æŒ‡å®šresolvedçŠ¶æ€å’ŒrejectedçŠ¶æ€çš„å›è°ƒå‡½æ•°(å¤„ç†è¿”å›çš„ç»“æœ)ã€‚ å¼•ç”³-æ³¨æ„: promiseå¯¹è±¡åœ¨jsä¸­éå¸¸ç‰¹æ®Š,æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ è¿™ä¸ªçš„ç»“æœæ˜¯failt å› ä¸º p2ä¸­resolveè¿”å›ä¸€ä¸ªpromiseå¯¹è±¡,è¿™ä¸ªæ“ä½œå°†ä¼šå¯¼è‡´p2çš„çŠ¶æ€å‡çº§æˆp1çš„çŠ¶æ€(æ ‡å‡†) promiseçš„thené“¾å¼å†™æ³•promise thenæ–¹æ³•å°†ä¼šè¿”å›ä¸€ä¸ªpromise,æ‰€ä»¥jsæ”¯æŒé“¾å¼å¼‚æ­¥ promise å¼‚å¸¸æ•è· è¿™ä¸ªå¼‚å¸¸æ•è·å’Œjavaç›¸åŒ,æ•è·åœ¨eventLoopä¸­äº§ç”Ÿçš„å¼‚å¸¸ æ³¨æ„ä¸€ç‚¹è¿™ä¸ªå¼‚å¸¸å’Œjavaçš„try catchæ˜¯ä¸åŒçš„,å¦‚æœäº§ç”Ÿäº†å¼‚å¸¸å°†ä¸ä¼šåœ¨ä¸»çº¿ç¨‹ä¸­æ˜¾ç¤ºå‡ºæ¥ promiseçš„finallyè¿™ä¸ªå’Œjavaçš„å¼‚å¸¸ä½“ç³»ç›¸åŒ,finally æ— å…³çŠ¶æ€,æœ€åéƒ½ä¼šæ‰§è¡Œ æ›´åŠ æ–¹ä¾¿çš„ç¼–å†™å¼‚æ­¥ä½¿ç”¨Promise.resolve(xxx) æ³¨æ„: promiseå¼‚æ­¥åŒ–ç»“æœåªèƒ½åœ¨å›è°ƒå‡½æ•°ä¸­è·å¾—,å¦‚æœå¼‚æ­¥çš„æ“ä½œå¤ªå¤š,å°†ä¼šè°ƒè‡³è°ƒç”¨é“¾è·¯è¿‡é•¿ å¦‚ä½•è§£å†³jsçš„promiseå¼‚æ­¥ç¼–ç¨‹çš„é—®é¢˜?promise å†™æ³•æœ‰ä»€ä¹ˆé—®é¢˜? â€”- è°ƒç”¨é“¾è·¯è¿‡é•¿ æ¯”å¦‚: ä½¿ç”¨promise å®ç° å¼‚æ­¥ajaxè¯·æ±‚ è°ƒç”¨é“¾å¤ªé•¿,ä¸åœçš„promiseè°ƒç”¨ jså¦‚ä½•è§£å†³å›è°ƒåœ°ç‹±â€”åŒæ­¥æ–¹æ³•å†™å¼‚æ­¥è§£å†³æ–¹æ³• ä½¿ç”¨jsçš„åç¨‹ â€“Generator generator:jsçš„ç‰¹æ®Šè¯­æ³•,ä½¿ç”¨yield å…³é”®å­—å°†å‡½æ•°åˆ†å—äº†,ç„¶åå¯ä»¥ä½¿ç”¨éå†å™¨æ‰‹åŠ¨æ§åˆ¶æ‰§è¡Œ ä¾‹å­: æœ¬è´¨ä¸Šæ˜¯å‡½æ•°åˆ†ç‰‡ jsåœ¨æ¯æ¬¡yieldçš„æ—¶å€™éƒ½ä¼šè·å¾—å½“å‰ä½ç½®çš„è¡¨è¾¾å¼,ç„¶åå†æ‰‹åŠ¨çš„åµŒå…¥å°±å¯ä»¥å®ç°åˆ†ç‰‡æ§åˆ¶çš„æ•ˆæœäº† æ€ä¹ˆç”¨generatorå®ç°å¼‚æ­¥åŒ–å‘¢ â€“ yieldé…åˆpromiseå®ç°å¼‚æ­¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–¹æ³• æƒ³è®©ä»–èƒ½å¼‚æ­¥æ‰§è¡Œ,åªè¦èƒ½è®©å‰ä¸€ä¸ªpromiseçš„ç»“æœæ˜¯ä¸‹ä¸€ä¸ªpromiseçš„è¾“å…¥å°±å¯ä»¥äº† è¿™é‡Œæœ‰ä¸¤ç§å†™æ³• å†™æ³•ä¸€é€’å½’æ–¹ç¨‹: f(æœ€ç»ˆç»“æœ) &#x3D; f(åˆ°ç›®å‰çš„ç»“æœ)+f(æ¥ä¸‹æ¥æ‰§è¡Œçš„ç»“æœ) co å·¥å…·åŒ…çš„å†™æ³• å†™æ³•äºŒé€’å½’æ–¹ç¨‹ f(æœ€ç»ˆç»“æœ) &#x3D; f(ä¹‹å‰æ‰€æœ‰çš„ç»“æœ)+f(æœ€åä¸€æ­¥çš„ç»“æœ) æ›´ç®€å•çš„æ–¹æ³• async&#x2F;awaitä¸Šé¢å¤æ‚çš„ä»£ç å¦‚æœå˜æˆasync&#x2F;awaitè¦æ€ä¹ˆåšå‘¢ å¾ˆç®€å• é€šè¿‡ä¸Šé¢çš„ä¾‹å­,æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å®async&#x2F;awaitæœ¬è´¨ä¸Šå…¶å®æ˜¯ generatorçš„ä¸€ä¸ªè¯­æ³•ç³– awaitå°±æ˜¯yield , async çš„ä½œç”¨å°±æ˜¯å°†å‡½æ•°ç¼–ç¨‹è¯­æ³•ç³– å¦‚æœèƒŒçš„è¯å¾ˆç®€ç­”ä¸¤æ¡è§„åˆ™: awaitåé¢å¿…é¡»æ˜¯promiseå‡½æ•° async æ ‡è®°è¿‡å¾—å‡½æ•°æ‰§è¡Œåè¿”å›çš„promise é€šè¿‡è¿™ç§æ–¹æ³•å°±å¯ä»¥ç®€å•çš„å®ç°å¼‚æ­¥äº†","date":"2024-12-31","categories":["å‰ç«¯"],"tags":["javascript"]},{"title":"æ€è·¯","url":"/2024/12/31/æ€è·¯/","content":"è®¾è®¡é¡µé¢çš„å±‚çº§ç»“æ„ - è™šæ‹Ÿdomæ ‘ è®¾è®¡é¡µé¢çš„æ•°æ®æµè½¬ç»“æ„ - è¿è¡Œæ€","date":"2024-12-31","categories":["å‰ç«¯"],"tags":["javascript"]},{"title":"nodejs","url":"/2024/12/31/nodejs/","content":"è„šæœ¬åŒ–è¿è¡Œnodejs å®‰è£…nodejs ï¼Œ ç„¶åç¼–å†™å¯¹åº”çš„nodejs è„šæœ¬ é€€å‡º è¿™ä¸ªæ–¹æ³•ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ç  0 æ­£å¸¸ 1 nodejs ç¯å¢ƒåˆå§‹åŒ– æ£€æµ‹ç¯å¢ƒä¿¡æ¯ webAssembly npm åŒ…ç®¡ç† package.json æ˜¯æ ¸å¿ƒ åˆå§‹åŒ–è‡ªå®šä¹‰package.json (.npm-init.js) â€œdependenciesâ€ï¼šæ‚¨çš„åº”ç”¨ç¨‹åºåœ¨ç”Ÿäº§ä¸­æ‰€éœ€çš„åŒ…ã€‚ â€œdevDependenciesâ€ï¼šåªéœ€è¦æœ¬åœ°å¼€å‘å’Œæµ‹è¯•çš„åŒ…ã€‚ npm åŒ…å®‰è£… æœ¬åœ°å®‰è£…ï¼ˆé»˜è®¤ï¼‰ï¼šå°†å†…å®¹æ”¾å…¥.&#x2F;node_moduleså½“å‰åŒ…æ ¹ç›®å½•ã€‚å…¨å±€å®‰è£…ï¼ˆå¸¦-gï¼‰ï¼šå°†ä¸œè¥¿æ”¾åœ¨ &#x2F;usr&#x2F;local æˆ–å®‰è£…èŠ‚ç‚¹çš„ä»»ä½•ä½ç½®ã€‚å¦‚æœä½ è¦å»çš„è¯ï¼Œåœ¨æœ¬åœ°å®‰è£…require()å®ƒã€‚å¦‚æœè¦åœ¨å‘½ä»¤è¡Œä¸Šè¿è¡Œå®ƒï¼Œè¯·å…¨å±€å®‰è£…å®ƒã€‚å¦‚æœä¸¤è€…éƒ½éœ€è¦ï¼Œåˆ™å°†å…¶å®‰è£…åœ¨ä¸¤ä¸ªä½ç½®ï¼Œæˆ–ä½¿ç”¨npm link. npm åŒ…æ ¼å¼æ”¯æŒ ï¼Œ æœ¬åœ°åŠ è½½ ï¼Œ ç‰ˆæœ¬æ§åˆ¶ ï¼Œ github æ§åˆ¶ å¸¸ç”¨å‘½ä»¤","date":"2024-12-31","categories":["å‰ç«¯"],"tags":["nodejs"]},{"title":"å¦‚ä½•åšä¸€æ¬¡å®Œç¾çš„å‹æµ‹","url":"/2024/12/31/å¦‚ä½•åšä¸€æ¬¡å®Œç¾çš„å‹æµ‹/","content":"å‹åŠ›æµ‹è¯•å…¶å®æœ‰çš„æ—¶å€™æ›´è€ƒéªŒäººçš„ç»éªŒ ä¸æµ‹è¯•ç›¸å…³çš„æŒ‡æ ‡ qps : æ¯ç§’æŸ¥è¯¢æ•° -> è¿™ä¸ªæŒ‡æ ‡ä¸€èˆ¬ç”¨åœ¨æ•°æ®åº“ä¸Š , ä¸è¿‡å¾ˆå¤šäººéƒ½æŠŠè¿™ä¸ªå’ŒTPSæ··æ·†,è¿™ä¸ªçŸ¥é“æ€ä¹ˆä¼šæ˜¯å°±è¡Œäº† tps : æ¯ç§’å†…çš„äº‹åŠ¡æ•° -> æ‰§è¡Œå¤šç»„æ“ä½œçš„æ€§èƒ½ -> ä¹Ÿæ˜¯æ•°æ®åº“çš„ä¸€ä¸ªæŒ‡æ ‡ , ä¸è¿‡å‘¢æˆ‘ä»¬å¯ä»¥æŠŠæˆ‘ä»¬çš„åå°æ¥å£æ“ä½œæƒ³è±¡æˆä¸€ä¸ªäº‹åŠ¡ , æ‰€ä»¥è¿™ä¸ªæŒ‡æ ‡æ˜¯æ ‡å‡†çš„ pv : åªçš„æ˜¯è°ƒç”¨æ¬¡æ•° RT : æ¥å£çš„å“åº”æ—¶é—´ cpuä½¿ç”¨ç‡ : å¤§å®¶éƒ½æ‡‚ cpu loadingæŒ‡æ•° : è¿™ä¸ªæŒ‡æ ‡æ¯”è¾ƒé‡è¦ , èƒ½åæ˜ å‡ºcpuå½“å‰çš„â€ç–²åŠ³â€ç¨‹åº¦ , å½“å‰cpuå¤„ç†ä»»åŠ¡æ•°é‡ , ä¸€èˆ¬æœ€å¤§éƒ½è¦ä¿è¯å†…æ ¸æ•°é‡*1.2ä¸€ä¸‹ å†…å­˜ : å¤§å®¶éƒ½æ‡‚ å‡ºå‘å’Œå…¥å‘æµé‡ : å¤§å®¶éƒ½æ‡‚ è¿˜æœ‰ä¸¤ä¸ªè¯ , ä½å»¶è¿Ÿå’Œé«˜åå å¦‚ä½•è·å¾—æŒ‡æ ‡ä½¿ç”¨å¸¸ç”¨çš„å‹æµ‹å·¥å…·éƒ½å¯ä»¥ , jmeterç­‰ç­‰ , è¿™ç±»æ“ä½œå·¥å…·éƒ½ä¼šå°†qps æˆ–è€… tps , RT æ•´ç†ç»Ÿè®¡å‡ºæ¥ , è¿™é‡Œå°±ä¸å±•å¼€äº† å¦‚ä½•çœŸæ­£çš„æŠŠæœºå™¨çš„æ€§èƒ½å‹å‡ºæ¥,åšä¸€æ¬¡å®Œç¾çš„å‹æµ‹ å»å‹æµ‹æ€§èƒ½çš„çœŸçš„æ˜¯ä¸€ä¸ªæŠ€æœ¯æ´» , æ˜¯ä¸€ä¸ªæ…¢æ…¢è¯•å‡ºæ¥çš„è¿‡ç¨‹ é¦–å…ˆæˆ‘ä»¬è¦åšæ€§èƒ½é¢„ä¼° é¢å¯¹ä¸€ä¸ªé›†ç¾¤ , æ€§èƒ½å¦‚ä½•åº”è¯¥æ€ä¹ˆé¢„ä¼°å‘¢? æ²¡åˆ«çš„åŠæ³• , çœ‹ç»éªŒ , é çŒœ ä½†æ˜¯ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€äº›ç®€å•çš„åŠæ³• , æ¯”å¦‚ ç”±å°é“å¤§ , é€çº§æµ‹è¯• -> ç”¨ä¸€ä¸ªå°çš„å‹åŠ›åšåˆæ¬¡é¢„ä¼° , æ…¢æ…¢é€¼è¿‘æ€§èƒ½æé™ å‚ç…§ç‰©æ³• , é€æ¸é€¼è¿‘ -> ä¸€ç»„å†…å…¬å¸å†…ç±»ä¼¼è§„æ¨¡çš„ç³»ç»Ÿ , è¿›è¡Œåˆæ¬¡é¢„ä¼° ç„å­¦ççŒœ , æ…¢æ…¢æµ‹è¯• -> æ²¡æœ‰ä»»ä½•å¯ä»¥å‚è€ƒçš„å°±ççŒœä¸€ä¸ªå§ , ç„¶åæ…¢æ…¢å»å¯»æ‰¾ åˆ¶å®šå‹åŠ›å±‚çº§å’Œå¯¹åº”çš„æŒ‡æ ‡ åœ¨å‹æµ‹è¿‡ç¨‹ä¸­æ€§èƒ½(QPS&#x2F;TPS)çš„éšç€å‹åŠ›çš„å˜åŒ–æ›²çº¿åº”è¯¥æ˜¯ä¸€ä¸ªæ³¢æµªçŠ¶çš„ æ‰¾å‡ºäº†é¢„ä¼°çš„å¹¶å‘å¤§å°ä¹‹å(ä¸€èˆ¬æ˜¯ä¸€ä¸ª5çš„å€æ•°çš„å¹¶å‘æ•°) , ä»¥è¿™ä¸ªä¸ºåŸºå‡† , å¢åŠ å¤šå°‘å¹¶å‘ , å‡å°‘å¤šå°‘å¹¶å‘ , åˆ—æˆè¡¨æ ¼ , æ³¨æ„è®°å½•å„ç§æ€§èƒ½çš„æŒ‡æ ‡ æ¯”å¦‚ : æ¥å£ å¹¶å‘æ•°é‡ å‹æµ‹æ—¶é—´ tps&#x2F;qps pv RT(min) RT(max) RT(average) RT(median) cpu loading cpu ä½¿ç”¨ç‡ goods_list 10 60s 3000 1w 1ms 30ms 15ms 20ms 6 100% ps : è¿™é‡Œå°±æœ‰ä¸€ç»Ÿè®¡å­¦çš„ä¸œè¥¿äº† , æ¯”å¦‚ä¸­ä½æ•°å’Œå¹³å‡å€¼ ,å…¶å®åœ¨å‹æµ‹çš„æ—¶å€™ä¸­ä½æ•°æ›´èƒ½ä½“ç°å‡ºRTè¿™ä¸ªæŒ‡æ ‡çš„å®é™…æ•ˆæœ æ³¨æ„ : è¿™ä¸ªå¾—å‡ºçš„æ€§èƒ½(qps&#x2F;tps)ä¿¡æ¯æœ€åè‡³å°‘æœ‰ä¸€ä¸ªä¸‹é™çš„ç»´åº¦ , æ˜¯ä¸€ä¸ªæ³¢æµªçŠ¶çš„æ•ˆæœ , è¿™æ ·æ‰èƒ½æ‰¾åˆ°æ€§èƒ½çš„æé™ æ³¨æ„ : æœ€ç»ˆæ€§èƒ½è¦ä½¿ç”¨æœ‰æ•ˆæ•°æ® , å¦‚æœRT è¶…è¿‡é™åˆ¶æˆ–è€…cpu loading è¶…è¿‡äº†é™åˆ¶ , é‚£ä¹ˆè¿™ä¸ªæ•°æ®è®¤ä¸ºä¸è¾¾æ ‡ , ä½†æ˜¯è¿™ä¸ªå¯ä»¥ç”¨ä½œç»Ÿè®¡åˆ†æ æ€§èƒ½ç“¶é¢ˆå®šä½ å½±å“æ€§èƒ½çš„åŸå› æœ‰å¤šç§ , ä¸ä¸€å®šçœŸçš„æ˜¯ç³»ç»Ÿæœ¬èº«çš„é—®é¢˜ é€šè¿‡ä¸Šé¢çš„åˆ¶å®šå‹åŠ›å±‚çº§å’Œå¯¹åº”çš„æŒ‡æ ‡ , æˆ‘ä»¬å·²ç»å¯ä»¥ç¡®å®šäº†æˆ‘ä»¬å½“å‰ç³»ç»Ÿçš„æé™æ€§èƒ½äº† , æˆ‘ä»¬ä¸ç¦æƒ³é—®è¿™äº›çœŸçš„æ˜¯æˆ‘ä»¬çš„æé™æ€§èƒ½äº†å—? å…¶å®æˆ‘ä»¬é€šè¿‡ cpu loading qps tps RT PV ç­‰å…¶å®å·²ç»èƒ½ç¡®å®šå½“å‰åœºæ™¯ä¸‹çš„ä¸€ä¸ªæœ€ä½³æ€§èƒ½äº† , æ¥å†™æ¥å°±éœ€è¦è¿›è¡Œæ€§èƒ½é—®é¢˜æ’æŸ¥è°ƒä¼˜ ç“¶é¢ˆæ’æŸ¥: æ’æŸ¥æ—¥å¿— , æ‰¾åˆ°è€—æ—¶è¿‡é•¿é€»è¾‘ , å®šä½åˆ†æ , æ¯”å¦‚java ç³»çš„ç³»ç»Ÿå¯ä»¥ä½¿ç”¨ alibaba å¼€æºçš„åœ¨çº¿æ€§èƒ½åˆ†æå·¥å…· arthas æ’æŸ¥ç½‘ç»œé—®é¢˜ : å½“ç¡®è®¤ä»£ç é€»è¾‘æ²¡æœ‰é—®é¢˜çš„æ—¶å€™ , ç½‘ç»œå»¶è¿Ÿè¿‡é«˜ä¹Ÿä¼šå½±å“qps , æ¯”å¦‚è·¨æœºæˆ¿è°ƒç”¨ç­‰ . è¿™ä¸ªæ—¶å€™éœ€è¦æ‰¾è¿ç»´åŒå­¦ååŠ©è§£å†³ , åšéƒ¨ç½²è¿ç§» , æ­å»ºä¸“ç”¨çº¿è·¯ç­‰æ–¹æ³• æœ€å cpuç“¶é¢ˆ : è¿™ä¸ªæ—¶å€™åªèƒ½é€šè¿‡åŠ æœºå™¨,å‡çº§æœºå™¨ç¡¬ä»¶èƒ½åŠ›è§£å†³ æ€§èƒ½è°ƒä¼˜ è¿™ä¸ªæ­¥éª¤å°±å¾ˆå¤šäº†, è¦é’ˆå¯¹è‡ªå·±çš„æŠ€æœ¯æ ˆè¿›è¡Œæ“ä½œ , æ¯”å¦‚ java å¯ä¿®æ”¹jvmå‚æ•° , çœ‹ä¸€ä¸‹ jvm GC , å†…å­˜çŠ¶æ€ , åˆ†åˆ«å¯¹åº”çš„è¿›è¡Œä¸€ä¸‹è°ƒä¼˜ . ps javaäº‹æƒ…çœŸå¤šâ€¦ â€¦ æ€§èƒ½ç“¶é¢ˆå®šä½-å…¶ä»–æ–¹é¢qpsä¸Šä¸å»é—®é¢˜å¯èƒ½å¹¶ä¸æ˜¯åå°çš„äº‹æƒ… , ä¸åŒç±»å‹çš„ç³»ç»Ÿé—´çš„ç›¸äº’è°ƒç”¨ä¹Ÿå¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ éšç€ç°åœ¨äº’è”ç½‘æ¶æ„çš„å‡çº§ epoll æ¨¡å¼çš„å¹¿æ³›åº”ç”¨ ,ç³»ç»Ÿä¹‹é—´çš„è°ƒç”¨ä¹Ÿå¯èƒ½æˆä¸ºæ€§èƒ½çš„ç“¶é¢ˆ ä¸¾ä¸ªä¾‹å­ ä¼ ç»Ÿjavaçº¿ç¨‹ä½“ç³»æ˜¯ä¸€ä¸ªå…¸å‹çš„ä½å»¶è¿Ÿç³»ç»Ÿ , å› ä¸ºçº¿ç¨‹æ¨¡å‹æ˜¯ç‹¬ç«‹æ‰§è¡Œçš„ä¸ä¼šæ­£å¸¸ç†æƒ³æƒ…å†µä¸‹ä¸ä¼šä¸­é€”ç»ˆæ­¢æ‰§è¡Œ(çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢) , æ‰€ä»¥è¯´ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆçš„æ—¶é—´å°±æ˜¯è¿™ä¸ªä»»åŠ¡æ‰§è¡Œåœ¨cpuä¸­çš„æœ€çŸ­æ—¶é—´. golang&#x2F;nodejsæ˜¯é«˜ååç³»ç»Ÿ , åº”ä¸ºåº•å±‚ç”¨äº†epoll æ¨¡å‹ä½¿ç”¨äº‹ä»¶è½®è¯¢ , å…¶å®æœ¬è´¨ä¸Šæ˜¯å°†å¤šä¸ªä»»åŠ¡åˆ†é…åˆ°ä¸€ä¸ªçº¿ç¨‹ä¸­å»æ‰§è¡Œ , ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œçš„æ—¶é—´è¿‘ä¼¼ç­‰äºè¿™ä¸€ä¸ªçº¿ç¨‹æ‰€æœ‰ä»»åŠ¡å®Œæˆçš„å¹³å‡æ—¶é—´ . ä¸Šé¢ä»‹ç»å®Œäº† -> å¼•å‡ºé‡ç‚¹ , ä¸Šé¢çš„ä¸¤ä¸ªç³»ç»Ÿ,å¦‚æœjavaå»è°ƒç”¨golangæˆ–è€…nodejsçš„ç­‰ç±»ä¼¼çš„ç³»ç»Ÿçš„è¯ , javaå°±ä¼šå‡ºç°æ€§èƒ½é—®é¢˜ å› ä¸ºjava åœ¨çº¿ç¨‹æ¨¡å‹ä¸‹ , è¦èƒ½ä¿è¯é«˜çš„æ€§èƒ½å¿…é¡»ä¿è¯å»¶è¿Ÿè¦è¶³å¤Ÿä½ , å¦åˆ™ä¼šå¯¼è‡´çº¿ç¨‹è¿‡å¤š,çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢é¢‘ç¹ , ç»“æœæ‹‰ä½æ•´ä¸ªæ€§èƒ½. ä½†æ˜¯golang&#x2F;nodejs åªæ˜¯ä¿è¯çš„åå qps æ²¡æœ‰ä¿è¯å»¶è¿ŸRT æ‰€ä»¥ , ä¼šå¯¼è‡´åº•å±‚æœåŠ¡æ€§èƒ½å¾ˆå¥½ååé‡é«˜ä½†æ˜¯ä¸Šå±‚æœåŠ¡æ€ä¹ˆä¼˜åŒ–éƒ½æ²¡åŠæ³•å®ç°é«˜å¹¶å‘. å¦‚ä½•è§£å†³ , java æŠ›å¼ƒçº¿ç¨‹æ¨¡å‹ä½¿ç”¨NIO , åº”ä¸ºé’ˆå¯¹ä¼šè”ç½‘åº”ç”¨åœ¨å»¶è¿Ÿå¯æ§çš„æƒ…å†µä¸‹åº”è¯¥å°½å¯èƒ½çš„è¿½æ±‚ååé‡ , ä½†æ˜¯java NIOæ¨¡å‹éœ€è¦å†™å¼‚æ­¥å›è°ƒ , ä»£ç å¾ˆç¼–å†™è¿™ä¼šå¯¼è‡´å¼€å‘æ•ˆç‡é™ä½ . æƒè¡¡ä¸‹æ¥ , åªèƒ½javaå¢åŠ æœºå™¨æ¥è§£å†³äº†. æ€§èƒ½ç“¶é¢ˆå®šä½-å‹æµ‹çš„æ—¶å€™å‹åŠ›æœºå™¨ä¹Ÿè¦æ³¨æ„ , æœ‰çš„æ—¶å€™ç“¶é¢ˆå¯èƒ½æ˜¯å‹åŠ›æœºå™¨çš„å¦‚æœæˆ‘ä»¬åªæ˜¯ä½¿ç”¨ä¸€å°å‹åŠ›æœºå™¨è¿›è¡Œå‹æµ‹æ˜¯ç‰‡é¢çš„ , å› ä¸ºç½‘ç»œçš„å¼€é”€\\å»¶è¿Ÿ ,éƒ½èƒ½å½±å“åˆ°å‹åŠ›æœºå™¨å¯¹æµ‹è¯•æœºå™¨çš„è´Ÿè½½ , ä¹Ÿå°±æ˜¯è¯´å‹åŠ›æœºåˆ°äº†ä¸Šé™ä½†æ˜¯æµ‹è¯•æœºè¿˜æ²¡æœ‰é“ è§£å†³æ–¹æ³• , ä½¿ç”¨é›†ç¾¤è¿›è¡Œå‹åŠ›æµ‹è¯• æœ€åè¿™é‡Œåªæ˜¯è®°å½•äº†å•ä¸ªä¸šåŠ¡çš„å‹æµ‹æ–¹æ³• , å…¶å®ç°åœ¨æ¶æ„ä¸­è¿˜æœ‰é’ˆå¯¹æ•´ä¸ªè°ƒç”¨é“¾è·¯çš„å‹æµ‹ å…¨é“¾è·¯å‹æµ‹ å…¶å®æ˜¯è¿™ç§å•ä¸šåŠ¡å‹æµ‹çš„èŒƒåŒ–åœºæ™¯ , éœ€è¦è°ƒåŠ¨å„ä¸ªéƒ¨é—¨ , å„ä¸ªç³»ç»Ÿçš„å¼€å‘äººå‘˜ä¸€èµ·åšæ€§èƒ½å‹æµ‹ , æŠ€æœ¯ä¸Šçš„æ“ä½œå’Œå•ä¸šåŠ¡å‹æµ‹æ˜¯ç±»ä¼¼çš„ , åªæ˜¯å¤šäº†ä¸€äº›è°ƒç”¨é“¾è·¯æ€§èƒ½æŒ‡æ ‡ , å„ä¸ªç³»ç»Ÿä¹‹é—´è°ƒç”¨çš„æ€§èƒ½è®°å½• , è¿˜æœ‰ä¸€äº›æ•…éšœæ¼”ç»ƒ . å…¶å®å…¨é“¾è·¯æ›´è€ƒéªŒæˆ‘ä»¬çš„ç»„ç»‡èƒ½åŠ›,å›¢é˜Ÿåä½œå’Œæ²Ÿé€šäº¤æµèƒ½åŠ›.","date":"2024-12-31","categories":["å›¢é˜Ÿå¼€å‘å·¥ä½œç­‰å…¶ä»–è½¯æŠ€èƒ½"]},{"title":"Devopsè¿ç»´é‡åˆ°çš„ä¸€ä¸ªåŸºç¡€é—®é¢˜-linuxç»ˆæ­¢æŒ‡ä»¤","url":"/2024/12/31/Devopsè¿ç»´é‡åˆ°çš„ä¸€ä¸ªåŸºç¡€é—®é¢˜-linuxç»ˆæ­¢æŒ‡ä»¤/","content":"å…¶å®è¿™ä¸ªä¸œè¥¿æ˜¯linuxçš„ä¸€ä¸ªä¿¡å· linux ç»“æŸä»»åŠ¡æœ‰ä¸‰ç§ä¿¡å·é‡ sigint sigterm sigkill sigint : å’Œctrl+cå…³è” , ç”¨æ¥ç»ˆæ­¢å½“å‰ç»ˆç«¯ä¸­æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ sigterm : ç›¸å½“äºkillè¿›ç¨‹ , ä¼šç»ˆæ­¢å½“å‰ç»ˆç«¯çš„åå°ä»»åŠ¡(åœ¨å½“å‰ç»ˆç«¯çš„å®ˆæŠ¤çº¿ç¨‹ä¸­çš„ä»»åŠ¡) sigkill : ç›¸å½“äºkill -9 , ä¸ä¼šå’Œsigtermä¿¡å·é‡ä¼šç­‰å¾…å½“å‰çº¿ç¨‹ç»“æŸ , è€Œæ˜¯ç›´æ¥çš„æ€æ­»å®ƒ linux ç¨‹åºè¿è¡Œæ—¶çŠ¶æ€åˆ‡æ¢ä¸€ã€&åŠ åœ¨ä¸€ä¸ªå‘½ä»¤çš„æœ€åï¼Œå¯ä»¥æŠŠè¿™ä¸ªå‘½ä»¤æ”¾åˆ°åå°æ‰§è¡Œï¼Œå¦‚watch -n 10 sh test.sh & #æ¯10såœ¨åå°æ‰§è¡Œä¸€æ¬¡test.shè„šæœ¬ äºŒã€ctrl + zå¯ä»¥å°†ä¸€ä¸ªæ­£åœ¨å‰å°æ‰§è¡Œçš„å‘½ä»¤æ”¾åˆ°åå°ï¼Œå¹¶ä¸”å¤„äºæš‚åœçŠ¶æ€ã€‚ ä¸‰ã€jobsæŸ¥çœ‹å½“å‰æœ‰å¤šå°‘åœ¨åå°è¿è¡Œçš„å‘½ä»¤jobs -lé€‰é¡¹å¯æ˜¾ç¤ºæ‰€æœ‰ä»»åŠ¡çš„PIDï¼Œjobsçš„çŠ¶æ€å¯ä»¥æ˜¯running, stopped, Terminatedã€‚ä½†æ˜¯å¦‚æœä»»åŠ¡è¢«ç»ˆæ­¢äº†ï¼ˆkillï¼‰ï¼Œshell ä»å½“å‰çš„shellç¯å¢ƒå·²çŸ¥çš„åˆ—è¡¨ä¸­åˆ é™¤ä»»åŠ¡çš„è¿›ç¨‹æ ‡è¯†ã€‚ å››ã€fgå°†åå°ä¸­çš„å‘½ä»¤è°ƒè‡³å‰å°ç»§ç»­è¿è¡Œã€‚å¦‚æœåå°ä¸­æœ‰å¤šä¸ªå‘½ä»¤ï¼Œå¯ä»¥ç”¨fg %jobnumberï¼ˆæ˜¯å‘½ä»¤ç¼–å·ï¼Œä¸æ˜¯è¿›ç¨‹å·ï¼‰å°†é€‰ä¸­çš„å‘½ä»¤è°ƒå‡ºã€‚ äº”ã€bgå°†ä¸€ä¸ªåœ¨åå°æš‚åœçš„å‘½ä»¤ï¼Œå˜æˆåœ¨åå°ç»§ç»­æ‰§è¡Œã€‚å¦‚æœåå°ä¸­æœ‰å¤šä¸ªå‘½ä»¤ï¼Œå¯ä»¥ç”¨bg %jobnumberå°†é€‰ä¸­çš„å‘½ä»¤è°ƒå‡ºã€‚ å…­ã€killæ³•å­1ï¼šé€šè¿‡jobså‘½ä»¤æŸ¥çœ‹jobå·ï¼ˆå‡è®¾ä¸ºnumï¼‰ï¼Œç„¶åæ‰§è¡Œkill %numæ³•å­2ï¼šé€šè¿‡pså‘½ä»¤æŸ¥çœ‹jobçš„è¿›ç¨‹å·ï¼ˆPIDï¼Œå‡è®¾ä¸ºpidï¼‰ï¼Œç„¶åæ‰§è¡Œkill pidå‰å°è¿›ç¨‹çš„ç»ˆæ­¢ï¼šCtrl+c ä¸ƒã€nohupå¦‚æœè®©ç¨‹åºå§‹ç»ˆåœ¨åå°æ‰§è¡Œï¼Œå³ä½¿å…³é—­å½“å‰çš„ç»ˆç«¯ä¹Ÿæ‰§è¡Œï¼ˆä¹‹å‰çš„&åšä¸åˆ°ï¼‰ï¼Œè¿™æ—¶å€™éœ€è¦nohupã€‚è¯¥å‘½ä»¤å¯ä»¥åœ¨ä½ é€€å‡ºå¸æˆ·&#x2F;å…³é—­ç»ˆç«¯ä¹‹åç»§ç»­è¿è¡Œç›¸åº”çš„è¿›ç¨‹ã€‚å…³é—­ä¸­æ–­åï¼Œåœ¨å¦ä¸€ä¸ªç»ˆç«¯jobså·²ç»æ— æ³•çœ‹åˆ°åå°è·‘å¾—ç¨‹åºäº†ï¼Œæ­¤æ—¶åˆ©ç”¨psï¼ˆè¿›ç¨‹æŸ¥çœ‹å‘½ä»¤ï¼‰ ps -aux | grep â€œtest.shâ€ #a:æ˜¾ç¤ºæ‰€æœ‰ç¨‹åº u:ä»¥ç”¨æˆ·ä¸ºä¸»çš„æ ¼å¼æ¥æ˜¾ç¤º x:æ˜¾ç¤ºæ‰€æœ‰ç¨‹åºï¼Œä¸ä»¥ç»ˆç«¯æœºæ¥åŒºåˆ†","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"dubboåˆ†æ(1)-æ’ä»¶åŒ–æ¨¡å—åŒ–èƒ½åŠ›ç±»SPIèƒ½åŠ›è®¾è®¡è§£æ","url":"/2024/12/31/dubboåˆ†æ-1--æ’ä»¶åŒ–æ¨¡å—åŒ–èƒ½åŠ›ç±»SPIèƒ½åŠ›è®¾è®¡è§£æ/","content":"åŸºäºdubbo 2.7 ç‰ˆæœ¬ éƒ½è¯´dubooçš„æ’ä»¶åŒ–æ˜¯åŸºäºspiæˆ‘å¹¶ä¸è®¤åŒç€ä¸€ä¸ªè§‚ç‚¹ã€‚ æˆ‘è®¤ä¸ºdubboæ˜¯è‡ªå·±å®ç°äº†ä¸€æ³¢spiç±»ä¼¼spring boot æ€»ç»“ï¼šdubbo å¹¶æ²¡æœ‰ä½¿ç”¨javaçš„spiè€Œæ˜¯å®ç°äº†ä¸€ç§æ›´åŠ å¼ºæ‚çš„spiæœºåˆ¶ï¼ˆè‡ªåŠ¨ç±»åŠ è½½æœºåˆ¶ï¼‰ æ ¸å¿ƒç±»ExtensionLoader dubbo è‡ªå·±å®ç°SPIæœºåˆ¶å…¶å®è¿™ä¸€å—çš„é€»è¾‘å¾ˆç®€å•,å®šä½åˆ°äº†æ ¸å¿ƒç±»ExtensionLoaderçš„ä¸¤ä¸ªæ–¹æ³•ä¸­ ç¬¬äºŒä¸ªæ ¸å¿ƒæ–¹æ³• createExtension è¿™ä¸ªæ˜¯çœŸæ­£åˆ›å»ºç±»å‹çš„æ–¹æ³• è‡ªé€‚åº”æ‰©å±•è¿™ä¸ªç±»åœ¨æ•´ä¸ªdubboä¸­ç®—æ˜¯ä¸€ä¸ªç¡¬æ ¸çš„ç±»äº†ï¼Œæ€»è®¡1000å¤šè¡Œä»£ç ï¼Œçœ‹åç§°å°±èƒ½çŸ¥é“è¿™ä¸ªç±»å…¶å®æ‰¿è½½äº†dubboæ•´ä¸ªåŠ¨æ€åŠ è½½çš„é€»è¾‘ Extensionåœ¨dubboçš„ä½¿ç”¨æ–¹æ³•ä¸€èˆ¬æ˜¯è¿™æ ·çš„ è¿™ç§æ–¹æ³•è·å–çš„æ˜¯è¿™ä¸ªç±»çš„è‡ªå®šä¹‰æ‰©å±•ä¿¡æ¯,å¹¶ä¸”å¸¦ä¸Šäº†å‚æ•°æ ¡éªŒ , æ³¨æ„å¿…é¡»æ˜¯è¢«spiæ³¨è§£æ ‡è®°çš„ç±»æ‰å¯ä»¥è¿›è¡Œä½¿ç”¨ æ ¸å¿ƒå…¶å®å°±æ˜¯ä¸¤ä¸ªæ–¹æ³•ï¼ŒgetExtensionLoaderå’ŒgetAdaptiveExtensionï¼Œå‰è€…è´Ÿè´£å®ä¾‹åŒ–ä¸€ä¸ªExtensionLoader åè€…è¿›è¡ŒåŠ¨æ€åŠ è½½ getExtensionLoaderè¿™ä¸ªæ–¹æ³•å¾ˆç®€å•ï¼Œå°±æ˜¯å°†ç±»å‹å’ŒExtensionLoderå¯¹è±¡ä¹‹é—´çš„æ˜ å°„å…³ç³»ä¸€ä¸€å¯¹åº”ï¼Œå¹¶ä¸”åˆå§‹åŒ–ExtensionLoaderå¯¹è±¡ä¸­çš„ObjectFactory ç±»å‹å¯¹è±¡å®ä¾‹åŒ–å·¥ç¨‹æ–¹æ³• getAdaptiveExtensionè¿™ä¸ªç±»å°±æ˜¯éå¸¸å¤æ‚äº†ï¼Œæˆ‘é€»è¾‘ç®€åŒ–ä¸€ä¸‹ï¼Œåªåšå…³é”®ç‚¹è®°å½• å‘ç°ä¸€ä¸ªå…³é”®æ–¹æ³•createAdaptiveExtension æœ‰ç‚¹æ¶å¿ƒäº† å…ˆçœ‹çœ‹getAdaptiveExtensionClassæ–¹æ³•å¹²å˜›äº†å§ æœ‰ä¸€ä¸ªæ–¹æ³• getExtensionClasses ï¼Œ ä¸è¿‡è¿™ä¸ªæ–¹æ³•å¾ˆé‡è¦ ï¼Œ ä¸‹é¢çš„æ‰€æœ‰çš„é€»è¾‘éƒ½æ˜¯ä¸ºäº†åŠ è½½æ‰©å±•ç±»çš„å¹¶ç¼“å­˜åœ¨è‡ªå·±çš„å†…å­˜æ•°ç»„ä¸Š ä¸çœ‹æºç äº† ï¼Œ ç›´æ¥è¯´ç»“è®º ä»ä¸€ä¸ªæŒ‡å®šçš„æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ä¸­è·å–åƒä¸‹é¢è¿™æ ·æ–‡æœ¬ å°†è¿™ä¸ªæ–‡æœ¬æ•´åˆå‡ºä¸€å¥—k v ç»“æ„çš„map æ³¨æ„ä¸€ç§æ³¨è§£å’Œä¸€ç§ç±»å‹@Adaptiveå’ŒWrapperClassï¼ˆps ä»¥å½“å‰ç±»å‹ä¸ºæ„é€ å‡½æ•°çš„ç±»ï¼‰ getAdaptiveExtensionClass æ–¹æ³•åŒæ ·åŒ…å«äº†ä¸‰ä¸ªé€»è¾‘ï¼Œå¦‚ä¸‹ï¼š è°ƒç”¨ getExtensionClasses è·å–æ‰€æœ‰çš„æ‹“å±•ç±»æ£€æŸ¥ç¼“å­˜ï¼Œè‹¥ç¼“å­˜ä¸ä¸ºç©ºï¼Œåˆ™è¿”å›ç¼“å­˜è‹¥ç¼“å­˜ä¸ºç©ºï¼Œåˆ™è°ƒç”¨ createAdaptiveExtensionClass åˆ›å»ºè‡ªé€‚åº”æ‹“å±•ç±»è¿™ä¸‰ä¸ªé€»è¾‘çœ‹èµ·æ¥å¹³æ·¡æ— å¥‡ï¼Œä¼¼ä¹æ²¡æœ‰å¤šè®²çš„å¿…è¦ã€‚ä½†æ˜¯è¿™äº›å¹³æ·¡æ— å¥‡çš„ä»£ç ä¸­éšè—äº†ç€ä¸€äº›ç»†èŠ‚ï¼Œéœ€è¦è¯´æ˜ä¸€ä¸‹ã€‚é¦–å…ˆä»ç¬¬ä¸€ä¸ªé€»è¾‘è¯´èµ·ï¼ŒgetExtensionClasses è¿™ä¸ªæ–¹æ³•ç”¨äºè·å–æŸä¸ªæ¥å£çš„æ‰€æœ‰å®ç°ç±»ã€‚æ¯”å¦‚è¯¥æ–¹æ³•å¯ä»¥è·å– Protocol æ¥å£çš„ DubboProtocolã€HttpProtocolã€InjvmProtocol ç­‰å®ç°ç±»ã€‚åœ¨è·å–å®ç°ç±»çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæŸä¸ªæŸä¸ªå®ç°ç±»è¢« Adaptive æ³¨è§£ä¿®é¥°äº†ï¼Œé‚£ä¹ˆè¯¥ç±»å°±ä¼šè¢«èµ‹å€¼ç»™ cachedAdaptiveClass å˜é‡ã€‚æ­¤æ—¶ï¼Œä¸Šé¢æ­¥éª¤ä¸­çš„ç¬¬äºŒæ­¥æ¡ä»¶æˆç«‹ï¼ˆç¼“å­˜ä¸ä¸ºç©ºï¼‰ï¼Œç›´æ¥è¿”å› cachedAdaptiveClass å³å¯ è¿˜æœ‰ä¸€ä¸ªæ–¹æ³• createAdaptiveExtensionClass è¿™ä¸ªæ–¹æ³•éå¸¸ç‰¹æ®Š , æ˜¯è‡ªåŠ¨åŒ–ç”Ÿæˆæ‰©å±•ç±»çš„å‚æ•°æ ¡éªŒç±»â€¦ æ³¨æ„è¿™é‡Œçš„ä¸€ç«¯ä»£ç â€”è‡ªåŠ¨ç”ŸæˆAdaptiveæ–¹æ³•String code &#x3D; new AdaptiveClassCodeGenerator(type, cachedDefaultName).generate();,å…¶ä¸­çš„generateè¿™ä¸€å—åº”è¯¥æ˜¯æ•´ä¸ªdubboæœ€éš¾ç†è§£çš„åœ°æ–¹äº† spiè¿™é‡Œå…¶å®å†™çš„å¹¶ä¸æ˜¯å¾ˆåˆç†ï¼Œå­˜åœ¨å¤§é‡çš„é—®é¢˜ï¼Œå…¶å®æœ¬è´¨ä¸Šdubboåœ¨ç”Ÿæˆè‡ªé€‚åº”ç±»çš„æ—¶å€™ï¼Œä¸€ä¸ªæ ¸å¿ƒå°±æ˜¯ä½¿ç”¨urlä½œä¸ºå‚æ•°ï¼Œå„ç§æ•°æ®å…¶å®éƒ½æ˜¯åœ¨urlä¸­è·å–çš„ï¼Œ ç„¶åéå† çœ‹ä¸€ä¸ªç¼–è¯‘ä¹‹åçš„ä»£ç  æ³¨æ„ä¸Šé¢çš„é€»è¾‘é‡ç‚¹å…¶å®æ˜¯ extNameè¿™ä¸ªæ–¹æ³• ï¼Œ è¿™ä¸ªæ–¹æ³•ä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆé€»è¾‘ä¸­çš„generateExtNameAssignmentç”Ÿæˆçš„ å…¶ä¸­valueæ˜¯åœ¨Adaptiveæ³¨è§£ä¸­æ ‡è®°çš„åç§°ï¼Œdubboå°†ä¼šå¯¹è¿™äº›åç§°åœ¨urlä¸­è¿›è¡Œè‡ªåŠ¨åŒ–è·å–ï¼Œå¦‚æœæ˜¯protocalç±»å‹å°†ä¼šç›´æ¥ä»urlåè®®å‚æ•°ä¸­è·å– ps æ³¨æ„ï¼Œdubboåœ¨è¿™é‡Œåšçš„å…¶å®å¹¶ä¸å¥½ ï¼Œ é€»è¾‘éå¸¸çš„æ··ä¹± ï¼Œ å…¶ä¸­æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„å‚æ•°å°±æ˜¯ExtName , ä»–çš„é»˜è®¤å€¼æ˜¯ä»AdaptiveClassCodeGeneratorçš„æ„é€ å‡½æ•°ä¸­ä¼ å…¥çš„ï¼Œå¹¶ä¸”è°ƒç”¨è¿™ä¸ªæ„é€ å‡½æ•°çš„ExtendLoadæ˜¯åœ¨åˆå§‹åŒ–ExtendLoad class çš„æ—¶å€™ï¼Œè§£æSPIæ³¨è§£ä¸­çš„å‚æ•°è¿›è¡Œé»˜è®¤æ³¨å…¥çš„ ã€‚ã€‚ã€‚ å…¶å®æ³¨æ„ï¼Œè¿™é‡Œæœ¬è´¨ä¸Šå°±æ˜¯å°è£…ä¸€å±‚ä»urlä¸­è·å–å‚æ•°ç„¶åç»™SPIå®ç°ç±»è°ƒç”¨çš„é€»è¾‘ å…¶ä»–é‡è¦æ–¹æ³•injectExtensionè·å–è¿™ä¸ªç±»ä¾èµ–çš„spiæ‰©å±•å±æ€§ , ä½¿ç”¨setæ³¨å…¥åˆ°è¿™ä¸ªç±»ä¸­ æ³¨æ„è¿™ä¸ªæ–¹æ³•ï¼Œdubboçš„é»˜è®¤objectFactoryä½¿ç”¨çš„æ˜¯ExtendsObjectFactory æ‰€ä»¥ï¼Œåªèƒ½åŠ è½½SPIçš„ç±»å‹","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"dubboåˆ†æ(2)-dubboæœåŠ¡æš´éœ²ä»£ç åˆ†æ","url":"/2024/12/31/dubboåˆ†æ-2--dubboæœåŠ¡æš´éœ²ä»£ç åˆ†æ/","content":"åŸºäºdubbo2.7 + ä¸Šä¸€ç¯‡åˆ†æäº†dubboæœ‰å…³è‡ªåŠ¨åŒ–æ‰©å±•çš„ç›¸å…³ä¿¡æ¯ï¼Œè¿™ä¸€ç‰‡æ­£å¼è¿›å…¥ä¸»é¢˜ï¼Œç ”ç©¶ä¸€ä¸‹dubboæœåŠ¡åˆå§‹åŒ–çš„è¿‡ç¨‹ åˆå§‹åŒ–ä»£ç çš„å±•ç¤º æ³¨æ„è¿™é‡Œçš„ä¸¤å— ï¼Œ ä¸€ä¸ªæ˜¯setInterfaceåˆå§‹åŒ–çš„æ˜¯å®ç°çš„æ¥å£ï¼Œå¹¶ä¸”åˆå§‹åŒ–ServiceConfigå†…éƒ¨çš„IDå€¼ä¸ºè¿™ä¸ªæ¥å£çš„åç§°ï¼Œå¦ä¸€ä¸ªçŸ³Refæ–¹æ³•ï¼Œå¯¹åº”è¿™ä¸ªæ¥å£çš„å®ç°ç±» ç„¶åé‡ç‚¹å°±æ˜¯è¿™ä¸ªDubboBootstrapç±»äº†","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"java-forkjoinæ¡†æ¶ä½¿ç”¨å’Œä¸€äº›åŸåˆ™","url":"/2024/12/31/java-forkjoinæ¡†æ¶ä½¿ç”¨å’Œä¸€äº›åŸåˆ™/","content":"å…ˆæ‰¯ä¸€æ³¢ä½¿ç”¨ ä¸¤ä¸ªdemoè§£å†³ ä½¿ç”¨RecursiveActionæ— çŠ¶æ€ä»»åŠ¡æ‹†åˆ†(æ— è¿”å›å€¼çŠ¶æ€) æ³¨æ„å‡ ä¸ªç‚¹ awaitQuiescence æ˜¯ç›‘æ§è¿™ä¸ªforkjoinæ˜¯å¦éƒ½å®Œæˆ awaitTermination æ˜¯ç›‘æ§è¿™ä¸ªforkjoinæ˜¯å¦shutdown ä½¿ç”¨executeè¡¨ç¤ºç”¨æ— è¿”å›å€¼çš„æ–¹æ³•æ¥å¤„ç†å¼‚æ­¥è¯·æ±‚ ä½¿ç”¨RecursiveTaskæœ‰çŠ¶æ€ä»»åŠ¡æŸ¥åˆ† æ³¨æ„ä¸€ä¸ªç‚¹ ä½¿ç”¨ submit å’Œ futureç±»æ¥å®ç°ç›‘æ§è¿”å›å€¼çŠ¶æ€ åŸç†è¿™é‡Œå°±ä¸è¯´äº† , ä¸»è¦æ˜¯å‡ ä¸ªç‰¹æ€§ è‡ªåŠ¨çš„çº¿ç¨‹æ‰©å±• å¾ˆå¤šçº¿ç¨‹æ± éƒ½æœ‰è¿™ç§èƒ½åŠ›,é€šè¿‡ç›‘æ§cpuæ ¸å¿ƒæ•°é‡æ¥åˆ›å»ºçº¿ç¨‹æ•°é‡ å·¥ä½œçªƒå– ç©ºé—²çš„çº¿ç¨‹å»çªƒå–å…¶ä»–å·¥ä½œçº¿ç¨‹é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ ç±»ä¼¼WorkStealingPool å¤šå·¥ä½œé˜Ÿåˆ—çº¿ç¨‹æ±  ä»»åŠ¡åˆ†ç‰‡ forkjoinæ¡†æ¶çš„æ ¸å¿ƒ","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"java-ä»javaçº¿ç¨‹æ± æ¥çœ‹javaçš„é˜»å¡é˜Ÿåˆ—","url":"/2024/12/31/java-ä»javaçº¿ç¨‹æ± æ¥çœ‹javaçš„é˜»å¡é˜Ÿåˆ—-1/","content":"ä¸€è¯´åˆ°javaçš„é˜»å¡é˜Ÿåˆ—ï¼Œæˆ‘ä»¬å°±ä¼šæƒ³åˆ°åœ¨javaçš„jdkä¸­çš„é‚£ä¹ˆå¤šçš„ç±» 1.ArrayDeque, ï¼ˆæ•°ç»„åŒç«¯é˜Ÿåˆ—ï¼‰2.PriorityQueue, ï¼ˆä¼˜å…ˆçº§é˜Ÿåˆ—ï¼‰3.ConcurrentLinkedQueue, ï¼ˆåŸºäºé“¾è¡¨çš„å¹¶å‘é˜Ÿåˆ—ï¼‰4.DelayQueue, ï¼ˆå»¶æœŸé˜»å¡é˜Ÿåˆ—ï¼‰ï¼ˆé˜»å¡é˜Ÿåˆ—å®ç°äº†BlockingQueueæ¥å£ï¼‰5.ArrayBlockingQueue, ï¼ˆåŸºäºæ•°ç»„çš„å¹¶å‘é˜»å¡é˜Ÿåˆ—ï¼‰6.LinkedBlockingQueue, ï¼ˆåŸºäºé“¾è¡¨çš„FIFOé˜»å¡é˜Ÿåˆ—ï¼‰7.LinkedBlockingDeque, ï¼ˆåŸºäºé“¾è¡¨çš„FIFOåŒç«¯é˜»å¡é˜Ÿåˆ—ï¼‰8.PriorityBlockingQueue, ï¼ˆå¸¦ä¼˜å…ˆçº§çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼‰9.SynchronousQueue ï¼ˆå¹¶å‘åŒæ­¥é˜»å¡é˜Ÿåˆ—ï¼‰ è¿™é‡Œä¸å»ç»†è¯´çš„è¿™äº›ä¸œè¥¿ï¼Œè€Œæ˜¯ä»çº¿ç¨‹æ± çš„ä¸€ä¸ªå¼‚å¸¸æ¥èŠèŠè¿™ä¸ªäº‹æƒ… æ„é€ ä¸€ä¸ªçº¿ç¨‹æ± å¼‚å¸¸ - çº¿ç¨‹æ± è¿‡è½½å¼‚å¸¸ è¿™æ®µä»£ç å¦‚æœç›´æ¥è¿è¡Œå°†ä¼šæŠ›å‡ºå¼‚å¸¸ æ€»ç»“ä¸€ä¸‹ï¼š å…¶å®è¿™ä¸ªé—®é¢˜æ˜¯åŠ å…¥çš„çº¿ç¨‹æ•°é‡å·²ç»è¶…è¿‡äº†æ•´ä¸ªçº¿ç¨‹æ± èƒ½è´Ÿè½½çš„æœ€å¤§æ•°é‡äº†ï¼ˆæ–°å»ºçº¿ç¨‹æ± çš„æ—¶å€™ä½¿ç”¨äº†æœ‰ç•Œé˜Ÿåˆ—ï¼‰ï¼Œæ‰€ä»¥æŠ›å‡ºäº†äº†å¼‚å¸¸ é¿å…çº¿ç¨‹æ± æº¢å‡ºå¼‚å¸¸ - ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—å’Œæœ‰ç•Œé˜Ÿåˆ— BlockingQueue è¿™ä¸ªæ˜¯ä¸ºäº†è§£å†³javaå¹¶å‘åŒæ­¥é—®é¢˜çš„ï¼Œæœ¬è´¨ä¸Šæ˜¯è§£å†³çº¿ç¨‹é—´æ¶ˆæ¯åŒæ­¥è€Œè®¾è®¡çš„ æœ‰ä¸€ä¸‹å‡ ä¸ªç±»ï¼š 1.DelayQueue, ï¼ˆå»¶æœŸé˜»å¡é˜Ÿåˆ—ï¼‰ï¼ˆé˜»å¡é˜Ÿåˆ—å®ç°äº†BlockingQueueæ¥å£ï¼‰ è¿™ä¸ªé˜Ÿåˆ—æ˜¯æ— ç•Œçš„ï¼Œå¹¶ä¸”æ²¡æœ‰æŒ‡å®šé•¿åº¦çš„æ„é€ æ–¹æ³•2.ArrayBlockingQueue, ï¼ˆåŸºäºæ•°ç»„çš„å¹¶å‘é˜»å¡é˜Ÿåˆ—ï¼‰ å¿…é¡»è®¾ç½®é•¿åº¦3.LinkedBlockingQueue, ï¼ˆåŸºäºé“¾è¡¨çš„FIFOé˜»å¡é˜Ÿåˆ—ï¼‰ æ²¡æœ‰æŒ‡å®šé•¿åº¦å°±æ˜¯æœ‰ç•Œçš„åä¹‹æ˜¯æœ‰ç•Œçš„4.LinkedBlockingDeque, ï¼ˆåŸºäºé“¾è¡¨çš„FIFOåŒç«¯é˜»å¡é˜Ÿåˆ—ï¼‰ æ²¡æœ‰æŒ‡å®šé•¿åº¦å°±æ˜¯æœ‰ç•Œçš„åä¹‹æ˜¯æœ‰ç•Œçš„5.PriorityBlockingQueue, ï¼ˆå¸¦ä¼˜å…ˆçº§çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼‰ è¿™ä¸ªåªèƒ½ä¼ å…¥Comperableæ¥å£çš„ç±»æ–°ï¼Œä¸æ˜¯æœ‰ç•Œçš„6.SynchronousQueue ï¼ˆå¹¶å‘åŒæ­¥é˜»å¡é˜Ÿåˆ—ï¼‰ä¸èƒ½æŒ‡å®šé•¿åº¦ï¼Œåªèƒ½ä¼ å…¥ä¸€ä¸ªå€¼ï¼Œæœ‰ç•Œ å›è¿‡æ¥çœ‹çœ‹ä¸Šé¢çš„æºç ï¼Œå…¶å®çº¿ç¨‹æ± åœ¨åŠ å…¥çº¿ç¨‹æ—¶å€™çš„é€»è¾‘æ˜¯è¿™æ ·çš„ æ„å»ºå¸¸é©»çº¿ç¨‹coreNumæŒ‡å®šï¼Œå¦‚æœè¶…è¿‡ï¼Œå»ºç«‹ä¸´æ—¶çº¿ç¨‹maxNum , è¿˜ä¸å¤Ÿï¼Œå¢åŠ åˆ°é˜Ÿåˆ—ä¸­ çº¿ç¨‹æ± åˆ¤æ–­èƒ½ä¸èƒ½å¢åŠ ä»…å¯¹åˆ—æ˜¯ä½¿ç”¨çš„é˜Ÿåˆ—çš„offsetæ–¹æ³• å¦‚æœæ˜¯æœ‰ç•Œçš„é˜Ÿåˆ—å…šå¯¹åˆ—æ»¡äº†è‡ªç„¶è¿”å›falseï¼Œå› ä¸ºæ·»åŠ ä¸è¿›å»äº†ï¼Œç„¶åå°±ä¼šæŠ›å‡ºå¼‚å¸¸ æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬åœ¨ä½¿ç”¨javaçº¿ç¨‹æ± çš„æ—¶å€™éœ€è¦åšå¥½å®¹é‡è§„åˆ’ï¼Œå¦‚æœæ— æ³•ç¡®å®šæ˜¯å¦è¶…å‡ºäº†æŒ‡å®šçš„çº¿ç¨‹æ•°é‡ï¼Œå¯ä»¥ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—ï¼Œä½†æ˜¯è¦æ³¨æ„åˆ°é˜²æ­¢å†…å­˜æ³„æ¼","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"java-ä»jsæ¥çœ‹javaçš„==æ“ä½œ","url":"/2024/12/31/java-ä»jsæ¥çœ‹javaçš„--æ“ä½œ/","content":"åœ¨é£ä¸­å‡Œä¹±â€¦ â€¦ æœ€è¿‘çœ‹äº†ä¸€ä¸ªé—®é¢˜å¦‚ä½•åœ¨jsä¸­è®©ä¸‹é¢çš„è¿™ä¸ªè¡¨è¾¾å¼è¿”å›true ç­”æ¡ˆ å…¶å®è¿™ä¸ªæ–¹æ³•æ˜¯åˆ©ç”¨äº†jsçš„è¯­æ³•è§„åˆ™, jsåº”ä¸ºæ˜¯å¼±ç±»å‹ç¼–ç¨‹è¯­è¨€,æ‰€ä»¥å®ƒçš„&#x3D;&#x3D; æ“ä½œå…¶å®æ˜¯éœ€è¦è¿›è¡Œæ•°å€¼å¯¼å‡ºçš„é»˜è®¤çš„è¿‡ç¨‹æ˜¯å…ˆvalueOf ç„¶åæ˜¯ toString javaæ˜¯ä¸æ˜¯ç±»ä¼¼çš„å‘¢?ç­”æ¡ˆæ˜¯å¦å®šçš„â€¦ javaå¯¹éåŸºæœ¬ç±»å‹ç›´æ¥ä½¿ç”¨å†…å­˜åœ°å€è¿›è¡Œæ¯”è¾ƒ å¦‚æœéœ€è¦ç‰¹æ®Šçš„æ¯”è¾ƒæ–¹æ³•,éœ€è¦é‡å†™equelæ–¹æ³•æ¥è¾¾åˆ°ç›®çš„","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"java-å¼ºå¼±è½¯è™šå››ç§å¼•ç”¨çš„ç†è§£","url":"/2024/12/31/java-å¼ºå¼±è½¯è™šå››ç§å¼•ç”¨çš„ç†è§£/","content":"java æä¾›äº†å››ç§å¼•ç”¨ç±»å‹ï¼Œå¼ºå¼•ç”¨ï¼Œå¼±å¼•ç”¨ï¼Œè½¯å¼•ç”¨ï¼Œè™šå¼•ç”¨ ï¼Œ è¿™å››ç§å¼•ç”¨åˆ†åˆ«æœ‰ä¸åŒçš„ä½œç”¨å’Œä½¿ç”¨åœºæ™¯ å¼ºå¼•ç”¨ï¼šåªè¦å¼•ç”¨å­˜åœ¨ï¼Œåƒåœ¾å›æ”¶å™¨æ°¸è¿œä¸ä¼šå›æ”¶Object obj &#x3D; new Object();&#x2F;&#x2F;å¯ç›´æ¥é€šè¿‡objå–å¾—å¯¹åº”çš„å¯¹è±¡ å¦‚obj.equels(new Object());è€Œè¿™æ · objå¯¹è±¡å¯¹åé¢new Objectçš„ä¸€ä¸ªå¼ºå¼•ç”¨ï¼Œåªæœ‰å½“objè¿™ä¸ªå¼•ç”¨è¢«é‡Šæ”¾ä¹‹åï¼Œå¯¹è±¡æ‰ä¼šè¢«é‡Šæ”¾æ‰ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ç»å¸¸æ‰€ç”¨åˆ°çš„ç¼–ç å½¢å¼ã€‚ è½¯å¼•ç”¨ï¼šéå¿…é¡»å¼•ç”¨ï¼Œå†…å­˜æº¢å‡ºä¹‹å‰è¿›è¡Œå›æ”¶ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç å®ç°Object obj &#x3D; new Object();SoftReference sf &#x3D; new SoftReference(obj);obj &#x3D; null;sf.get();&#x2F;&#x2F;æœ‰æ—¶å€™ä¼šè¿”å›nullè¿™æ—¶å€™sfæ˜¯å¯¹objçš„ä¸€ä¸ªè½¯å¼•ç”¨ï¼Œé€šè¿‡sf.get()æ–¹æ³•å¯ä»¥å–åˆ°è¿™ä¸ªå¯¹è±¡ï¼Œå½“ç„¶ï¼Œå½“è¿™ä¸ªå¯¹è±¡è¢«æ ‡è®°ä¸ºéœ€è¦å›æ”¶çš„å¯¹è±¡æ—¶ï¼Œåˆ™è¿”å›nullï¼›è½¯å¼•ç”¨ä¸»è¦ç”¨æˆ·å®ç°ç±»ä¼¼ç¼“å­˜çš„åŠŸèƒ½ï¼Œåœ¨å†…å­˜è¶³å¤Ÿçš„æƒ…å†µä¸‹ç›´æ¥é€šè¿‡è½¯å¼•ç”¨å–å€¼ï¼Œæ— éœ€ä»ç¹å¿™çš„çœŸå®æ¥æºæŸ¥è¯¢æ•°æ®ï¼Œæå‡é€Ÿåº¦ï¼›å½“å†…å­˜ä¸è¶³æ—¶ï¼Œè‡ªåŠ¨åˆ é™¤è¿™éƒ¨åˆ†ç¼“å­˜æ•°æ®ï¼Œä»çœŸæ­£çš„æ¥æºæŸ¥è¯¢è¿™äº›æ•°æ®ã€‚ å¼±å¼•ç”¨ï¼šç¬¬äºŒæ¬¡åƒåœ¾å›æ”¶æ—¶å›æ”¶ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹ä»£ç å®ç°Object obj &#x3D; new Object();WeakReference wf &#x3D; new WeakReference(obj);obj &#x3D; null;wf.get();&#x2F;&#x2F;æœ‰æ—¶å€™ä¼šè¿”å›nullwf.isEnQueued();&#x2F;&#x2F;è¿”å›æ˜¯å¦è¢«åƒåœ¾å›æ”¶å™¨æ ‡è®°ä¸ºå³å°†å›æ”¶çš„åƒåœ¾å¼±å¼•ç”¨æ˜¯åœ¨ç¬¬äºŒæ¬¡åƒåœ¾å›æ”¶æ—¶å›æ”¶ï¼ŒçŸ­æ—¶é—´å†…é€šè¿‡å¼±å¼•ç”¨å–å¯¹åº”çš„æ•°æ®ï¼Œå¯ä»¥å–åˆ°ï¼Œå½“æ‰§è¡Œè¿‡ç¬¬äºŒæ¬¡åƒåœ¾å›æ”¶æ—¶ï¼Œå°†è¿”å›nullã€‚å¼±å¼•ç”¨ä¸»è¦ç”¨äºç›‘æ§å¯¹è±¡æ˜¯å¦å·²ç»è¢«åƒåœ¾å›æ”¶å™¨æ ‡è®°ä¸ºå³å°†å›æ”¶çš„åƒåœ¾ï¼Œå¯ä»¥é€šè¿‡å¼±å¼•ç”¨çš„isEnQueuedæ–¹æ³•è¿”å›å¯¹è±¡æ˜¯å¦è¢«åƒåœ¾å›æ”¶å™¨æ ‡è®°ã€‚ è™šå¼•ç”¨ï¼š åƒåœ¾å›æ”¶æ—¶å›æ”¶ï¼Œæ— æ³•é€šè¿‡å¼•ç”¨å–åˆ°å¯¹è±¡å€¼ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹ä»£ç å®ç°Object obj &#x3D; new Object();PhantomReference pf &#x3D; new PhantomReference(obj);obj&#x3D;null;pf.get();&#x2F;&#x2F;æ°¸è¿œè¿”å›nullpf.isEnQueued();&#x2F;&#x2F;è¿”å›æ˜¯å¦ä»å†…å­˜ä¸­å·²ç»åˆ é™¤è™šå¼•ç”¨æ˜¯æ¯æ¬¡åƒåœ¾å›æ”¶çš„æ—¶å€™éƒ½ä¼šè¢«å›æ”¶ï¼Œé€šè¿‡è™šå¼•ç”¨çš„getæ–¹æ³•æ°¸è¿œè·å–åˆ°çš„æ•°æ®ä¸ºnullï¼Œå› æ­¤ä¹Ÿè¢«æˆä¸ºå¹½çµå¼•ç”¨ã€‚è™šå¼•ç”¨ä¸»è¦ç”¨äºæ£€æµ‹å¯¹è±¡æ˜¯å¦å·²ç»ä»å†…å­˜ä¸­åˆ é™¤ã€‚","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"java-æ—¶é—´å¤„ç†å¤ä»¤æ—¶å†¬ä»¤æ—¶è·¨æ—¶åŒºé—®é¢˜å¤„ç†","url":"/2024/12/31/java-æ—¶é—´å¤„ç†å¤ä»¤æ—¶å†¬ä»¤æ—¶è·¨æ—¶åŒºé—®é¢˜å¤„ç†-1/","content":"ä½œä¸ºä¸€ä¸ªæˆç†Ÿçš„ç¼–ç¨‹è¯­è¨€ï¼Œjavaè‡ªç„¶æœ‰ä¸€å †æ–¹æ³•æ¥è§£å†³çš„æ—¶é—´çš„é—®é¢˜ã€‚æœ‰çš„æ—¶å€™æˆ‘ä»¬ä¼šå› ä¸ºå¯¹javaä¸€äº›å†…ç½®çš„apiä¸æ˜¯å¤ªç†Ÿæ‚‰ï¼Œå¯¹æŸä¸ªåœºæ™¯ä¸ç†Ÿæ‚‰ï¼Œå¯¼è‡´é‡åˆ°äº†æ£˜æ‰‹çš„é—®é¢˜ã€‚æ¯”å¦‚è¿™ä¸ªåœºæ™¯å¤ä»¤æ—¶å’Œå†¬ä»¤æ—¶ å¤ä»¤æ—¶å’Œå†¬ä»¤æ—¶åœ¨åšå…¨çƒæ€§çš„åŠŸèƒ½æ—¶ç»å¯¹å°‘ä¸äº†é‡åˆ°æ—¶åŒºè½¬åŒ–ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨æ—¶é—´æˆ³+javaå†…ç½®çš„apiå°±èƒ½è§£å†³99%çš„é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœé‡åˆ°å¤ä»¤æ—¶æˆ–è€…å†¬ä»¤æ—¶çš„æ—¶å€™è¿™ä¸ªé—®é¢˜å°±å¯èƒ½å˜å¾—ä¸æ˜¯è¿™ä¹ˆå®¹æ˜“ã€‚ é¦–å…ˆè®°å½•ä¸€ä¸‹ä»€ä¹ˆæ˜¯å¤ä»¤æ—¶å’Œå†¬ä»¤æ—¶ï¼šç®€å•çš„è¯´åœ¨è¿™ä¸ªä¸–ç•Œä¸Šçš„æŸäº›å›½å®¶ä¼šè§„å®šåœ¨æŸä¸ªæ—¥æœŸå°†æœ¬å›½æ‰€åœ¨çš„æ—¶åŒºå‘ç”Ÿæ”¹å˜ï¼Œç„¶ååœ¨æŸä¸ªæ—¶é—´å°†ä»–æ”¹å›æ¥ï¼Œè¿›è¡Œæ”¹å˜çš„æ—¥æœŸå°±æ˜¯å¤ä»¤æ—¶æˆ–è€…å†¬ä»¤æ—¶ æ³¨æ„ï¼šè¿™ä¸ªæ¦‚å¿µæ·±å±‚æ¬¡çš„ä¸œè¥¿å¯ä»¥è‡ªè¡Œç”¨æœç´¢å¼•æ“æŸ¥æ‰¾ç›¸å…³å†…å®¹ï¼Œæˆ‘è¿™é‡Œæ²¡æœ‰ç”¨å…¶ä»–äººçš„é‚£ç§è§£é‡Šæ¯”å¦‚å¤ä»¤æ—¶å°±æ˜¯æŠŠè¡¨è°ƒå¿«ä¸€å°æ—¶ï¼Œè€Œæ˜¯ä½¿ç”¨ä¿®æ­£æ—¶åŒºè¿™ä¸ªæ¦‚å¿µï¼Œè¿™ä¹ˆåšæ˜¯ä¸ºäº†æ–¹ä¾¿åšä¸‹é¢çš„è§£é‡Š å¤ä»¤æ—¶å’Œå†¬ä»¤æ—¶äº§ç”Ÿçš„ä¸šåŠ¡åœºæ™¯ä¸¾ä¸ªä¾‹å­ï¼š ä¸€ä¸ªå®è¡Œäº†å¤ä»¤æ—¶å’Œå†¬ä»¤æ—¶çš„å›½å®¶åœ¨å¤ä»¤æœ‰ä¸€ä¸ªæ´»åŠ¨ï¼Œæ¯å¤©11ç‚¹åˆ°1ä¸€ç‚¹å‚åŠ ï¼Œä¸ºæœŸä¸ƒå¤©ï¼Œè€Œè¿™7å¤©æ­£å¥½è¿‡äº†ä»¤æ—¶å˜åŒ–çš„è¿™ä¸€å¤©ï¼Œ è¿™æ ·ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ å› ä¸ºè·¨è¿‡ä»¤æ—¶æ‰€ä»¥è·¨ä»¤æ—¶ä¹‹å‰ä¸€å¤©çš„12ç‚¹20åˆ†å’Œåä¸€å¤©çš„12ç‚¹20åˆ†ä¹‹é—´ç›¸éš”çš„å¹¶ä¸æ˜¯24å°æ—¶ï¼Œå› ä¸ºä»¤æ—¶çš„å˜åŒ–æºå¸¦çš„æ—¶åŒºçš„å˜åŒ–ï¼Œå› ä¸ºæ—¶åŒºå˜åŒ–äº†ï¼Œæ‰€ä»¥ç›¸åŒçš„12ç‚¹20åˆ†å¯¹åº”çš„æ¯«ç§’æ•°æ˜¯ä¸åŒçš„ï¼ˆæ¯«ç§’æ²¡æœ‰æ—¶åŒºé—®é¢˜ï¼‰æ‰€ä»¥ä¸ºæœŸä¸ƒå¤©è¿™ä¸ªè¿‡ç¨‹ä¸èƒ½ç®€å•ä½¿ç”¨+24å°æ—¶æ¥å¤„ç†äº†ï¼Œå› ä¸ºè¿™æ ·å°±å¯èƒ½å¯¼è‡´è·¨ä»¤æ—¶å‰æ˜¯11ç‚¹åˆ°1ç‚¹ï¼Œè·¨ä»¤æ—¶ä¹‹åå°±æ˜¯12ç‚¹åˆ°2ç‚¹äº† æ€ä¹ˆè§£å†³javaæä¾›äº†ä¸€ä¸ªéå¸¸ç‰›é€¼çš„api TimeZone ï¼Œä¸“é—¨ç”¨æ¥å¤„ç†æ—¶åŒºé—®é¢˜ æœ‰ä¸¤ä¸ªapi è¿™æ ·å°±å¾ˆç®€å•äº†,ä½¿ç”¨è¿™ä¸¤ä¸ªapiå¦‚æœè¿”å›çš„å€¼ä¸ç›¸ç­‰,å°±è¯´æ˜å½“å‰æ—¶é—´å¤„äºæŸä¸€ä¸ªä»¤æ—¶ä¸­ è¿›é˜¶ä¸€ä¸‹,è§£å†³ä¸€ä¸‹ä¸Šé¢çš„éœ€æ±‚,è·¨ä»¤æ—¶çš„æ—¶å€™ä¿è¯æ—¥æœŸæ˜¯+1çš„è§£é‡Šä¸€ä¸‹è¿™ä¸ªéœ€æ±‚, ç›´æ¥ç”¨ä¸€ä¸ªæœ€åŸºæœ¬çš„ä¾‹å­æ¥è¯´ æˆ‘ç”¨è¥¿ç­ç‰™å›½å®¶çš„æ—¶åŒºæ¥åšä¸€ä¸ª+24å°æ—¶çš„å¤©æ•°è¿­ä»£,ç†è®ºä¸Šåº”è¯¥è®©2019-10-26 4ç‚¹å’Œ6ç‚¹,å˜æˆ2019-10-27 4ç‚¹å’Œ6ç‚¹ä½†æ˜¯åº”ä¸ºå¤ä»¤æ—¶çš„é—®é¢˜,å…¶å®å˜æˆçš„æ˜¯æˆ2019-10-27 3ç‚¹å’Œ5ç‚¹ è·‘ä¸€ä¸‹ä¸‹é¢çš„ä»£ç  è¾“å‡º: æ‰€ä»¥ä¸èƒ½è¿™ä¹ˆåš,ç›´æ¥ä¸Šä»£ç ,å…¶å®å°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç®—æ³•é¢˜äº† ä¸Šé¢çš„ç®—æ³•ç®€å•çš„è¯´å°±æ˜¯è¡¥å¿æ—¶å·®,å½“å‰çš„æ—¶é—´å’Œä¹‹åçš„è¿›è¡Œæ¯”è¾ƒ,å¦‚æœæœ‰å·®åˆ«å°±+ä¸Šå·®è·å°±è¡Œäº† , è¿™æ ·å°±èƒ½ä¿è¯åœ¨è·¨å¤ä»¤æ—¶çš„æ—¶å€™ä¿è¯æ—¶é—´ç»Ÿä¸€","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"java-èµ„æºè·å–-æ–‡ä»¶ç³»ç»Ÿä¸­-jaråŒ…ä¸­-jaråŒ…ä¸­çš„jarä¸­","url":"/2024/12/31/java-èµ„æºè·å–-æ–‡ä»¶ç³»ç»Ÿä¸­-jaråŒ…ä¸­-jaråŒ…ä¸­çš„jarä¸­-1/","content":"ä¸€å¼€å§‹å…¶å®ç”¨è¿™ä¸ªé¢˜ç›®ä½œä¸ºæ–‡ç« çš„æ ‡é¢˜å¾ˆéš¾å—ï¼Œä½†æ˜¯æ²¡æœ‰åŠæ³•javaçš„æ–‡ä»¶è·å–å°±æ˜¯è¿™ä¹ˆè´Ÿè½½:cold_sweat: javaè·å–æ•°æ®è·å–æ–‡ä»¶ç³»ç»Ÿçš„apiè¿™ä¸ªå°±ä¸ç½—å—¦äº†ï¼Œå°±æ˜¯javaçš„æ–‡ä»¶æ“ä½œFileInputStreamç­‰ç­‰ javaå¦‚æœè·å–jarä¸­çš„æ–‡ä»¶æ€ä¹ˆåšjava æœ‰ä¸€ä¸ªç‰¹æ®Šçš„apiçš„ClassLoader.getResource()ä¸getResources() ç®€å•çš„è¯´è¿™ä¸ªapiæ˜¯å¹²å˜›çš„,åŠ è½½ç±»è·¯å¾„èµ„æºæ–‡ä»¶,ä¹Ÿå°±æ˜¯classPathä¸­çš„ä¸œè¥¿ï¼ˆä¹Ÿå°±æ˜¯å¯ä»¥æ‹¿åˆ°classpathä¸­çš„æ‰€æœ‰ä¸œè¥¿åŒ…æ‹¬jarä¸­çš„ä¸œè¥¿ï¼‰ ç›´æ¥ä¸Šæºç  æ³¨æ„ä»£ç è¿™ä¸€æ®µEnumeration urls &#x3D; getClassLoader().getResources(packageName.replace(â€œ.â€, â€œ&#x2F;â€œ)); è¿”å›å€¼çŸ³URLç±»å‹ï¼Œæ³¨æ„åœ¨javaä¸­è¿™ä¸ªurlå…¶å®æœ‰å¤šç§åè®®æ„æˆçš„ï¼Œfileå‰ç¼€è¡¨ç¤ºåœ¨classpathæ–‡ä»¶è·¯å¾„ä¸­çš„èµ„æºï¼Œè€Œjarå‰ç¼€è¡¨ç¤ºåœ¨jarä¸­çš„èµ„æº å¦‚æœæ˜¯fileå‰ç¼€çš„èµ„æº è¿™ç§æƒ…å†µä¸‹å°±å½“æˆåŸºæœ¬çš„æ–‡ä»¶æ•°æ®æµæ¥å¤„ç†å°±å¥½äº†å…¶å®å¾ˆç®€å• å¦‚æœçŸ³jarå‰ç¼€çš„èµ„æº è¿™ä¸ªåœ°æ–¹è¦æ³¨æ„ä¸€ä¸‹ï¼Œæœ‰ä¸€ä¸ªå‘ï¼Œå°±æ˜¯å¦‚æœjvmå‘ç°è¿™ä¸ªåœ°æ–¹æœ‰æˆ‘ä»¬éœ€è¦çš„èµ„æºæˆ‘ä»¬éœ€è¦é€šè¿‡JarURLConnection jarURLConnection &#x3D; (JarURLConnection) url.openConnection();è¿™ä¸ªapiæ¥è·å–èµ„æºçš„å¼•ç”¨ï¼Œä½†æ˜¯å‘¢è¿™ä¸ªå¼•ç”¨ä¼šå°†è¿™ä¸ªjarä¸­æ‰€æœ‰çš„æ–‡ä»¶éƒ½åŠ è½½è¿›æ¥ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨çš„æ—¶å€™éœ€è¦åšä¸€ä¸ªè¿‡æ»¤ã€‚ æ€»ç»“ä¸€ä¸‹ä¸Šé¢çš„ä»£ç å·²ç»å®ç°äº†ä¸€ä¸ªjava jarä¸­æ–‡ä»¶çš„æœç´¢ï¼Œç½‘ç»œä¸Šæœ‰ç±»ä¼¼çš„ä»£ç ï¼Œä½†æ˜¯å®é™…æƒ…å†µæ˜¯æœ‰ä¸€äº›bugçš„ï¼Œè¿™é‡Œæˆ‘åšäº†ä¸€äº›ä¿®æ”¹ï¼ˆå› ä¸ºæˆ‘ä»¬ä¼ å…¥çš„æ˜¯æŒ‡å®šçš„åŒ…ï¼Œä½†æ˜¯jaråŠ è½½ä¼šæŠŠæ•´ä¸ªjaræ–‡ä»¶å…¨éƒ¨åŠ è½½è¿›æ¥ï¼Œæ‰€ä»¥æˆ‘åœ¨é‡Œé¢åŠ äº†ä¸€ä¸ªè¿‡æ»¤æ“ä½œï¼‰ï¼Œç°åœ¨å·²ç»å¯ä»¥ç¨³å®šè¿è¡Œäº†ã€‚","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"java8-çº¿ç¨‹æ± é—®é¢˜-jvmgcç½®ç©ºå›æ”¶æœºåˆ¶çš„æ’æŸ¥","url":"/2024/12/31/java8-çº¿ç¨‹æ± é—®é¢˜-jvmgcç½®ç©ºå›æ”¶æœºåˆ¶çš„æ’æŸ¥/","content":"å…ˆè¯´ç»“è®º,ä¸»è§‚ä¸Š,æˆ‘ä»¬éƒ½è§‰å¾—jvmè²Œä¼¼æ˜¯åœ¨ç¡®è®¤å¯¹è±¡ä¸è¾¾çš„æ—¶å€™è¿›è¡Œå›æ”¶çš„ é—®é¢˜å°±åœ¨è¿™ä¸ªä¸å¯è¾¾ä¸Šé¢ , å®˜æ–¹çš„è§£é‡Šæ˜¯ å¯è¾¾å¯¹è±¡ (reachable object) æ˜¯å¯ä»¥ä»ä»»ä½•æ´»åŠ¨çº¿ç¨‹çš„ä»»ä½•æ½œåœ¨çš„æŒç»­è®¿é—®ä¸­çš„ä»»ä½•å¯¹è±¡ï¼›java ç¼–è¯‘å™¨æˆ–ä»£ç ç”Ÿæˆå™¨å¯èƒ½ä¼šå¯¹ä¸å†è®¿é—®çš„å¯¹è±¡æå‰ç½®ä¸º nullï¼Œä½¿å¾—å¯¹è±¡å¯ä»¥è¢«æå‰å›æ”¶ ä¹Ÿå°±æ˜¯è¯´å¯¹è±¡çš„å›æ”¶æ—¶æœºæ˜¯å¯ä»¥åœ¨å‡½æ•°æ‰§è¡Œå®Œæˆä¹‹å‰å°±è§¦å‘çš„ è¿è¡Œä¹‹åä½ ä¼šå‘ç°è¾“å‡ºçš„æ•°æ®æ˜¯è¿™æ ·çš„ ç¨‹åºå‡½æ•°åœ¨æ²¡æœ‰è¢«æ‰§è¡Œå®Œä¹‹å‰å°±è¢«gcå›æ”¶äº† è¿™æ ·å¼•å…¥ä¸€ä¸ªå¤æ‚çš„åœºæ™¯æ¯”å¦‚å¤šçº¿ç¨‹ç¯å¢ƒgcæ˜¯å¦è¿˜æ˜¯æœ‰é—®é¢˜çš„ps: è¿™ä¸ªæƒ…å†µå…¶å®æ˜¯æœ€è¿‘é‡åˆ°çš„ä¸€ä¸ªçº¿ç¨‹æ± è«åå…¶å¦™è¢«killçš„é—®é¢˜å¼•ç”³å‡ºæ¥çš„ å…ˆè´´ä¸€æ®µä»£ç  æ‰§è¡Œä¸€ä¸‹æˆ‘ä»¬ä¸Šé¢çš„å‡½æ•°ä½ ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ Executor å¯¹è±¡è¿™ä¸ªåˆ›å»ºçº¿ç¨‹çš„ç©æ„ç«Ÿç„¶è¢«å›æ”¶äº†â€¦.. è¿™ä¸ªé—®é¢˜æ˜ å°„åˆ°java jdkçš„é—®é¢˜ä¸Šçš„è¯å°±æ˜¯åœ¨jdk1.8 ä½¿ç”¨çš„æ—¶å€™ä¼šæœ‰çº¿ç¨‹æ± è«åå…¶å¦™å…³é—­çš„é—®é¢˜ , è´´ä¸€ä¸‹ä»£ç  çœ‹ä¸Šé¢çš„ä»£ç æœ‰ä¸€ä¸ª finalizeæ–¹æ³•,ä»–è°ƒç”¨äº†shutdown(); â€” æ‰€ä»¥æˆ‘ä»¬ç”¨ä¸€å¼€å§‹çš„ä»£ç æ¥æ¨¡æ‹Ÿè¿™ä¸ªjdkçš„bug è¿™é‡Œå¯¹è¿™é‡Œé¢çš„å¯¹è±¡è¿›è¡Œä¸€æ¬¡å¯è¾¾æ€§åˆ†æ å…ˆè¯´ä¸€ä¸‹java gc çš„å¯è¾¾æ€§åˆ†æçš„æµç¨‹å§â€¦ â€¦ åœ¨Javaä¸­é‡‡å–äº† å¯è¾¾æ€§åˆ†ææ³•ã€‚è¯¥æ–¹æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„â€œGC Rootsâ€å¯¹è±¡ä½œä¸ºèµ·ç‚¹è¿›è¡Œæœç´¢ï¼Œå¦‚æœåœ¨â€œGC Rootsâ€å’Œä¸€ä¸ªå¯¹è±¡ä¹‹é—´æ²¡æœ‰å¯è¾¾è·¯å¾„ï¼Œåˆ™ç§°è¯¥å¯¹è±¡æ˜¯ä¸å¯è¾¾çš„ï¼Œä¸è¿‡è¦æ³¨æ„çš„æ˜¯è¢«åˆ¤å®šä¸ºä¸å¯è¾¾çš„å¯¹è±¡ä¸ä¸€å®šå°±ä¼šæˆä¸ºå¯å›æ”¶å¯¹è±¡ã€‚è¢«åˆ¤å®šä¸ºä¸å¯è¾¾çš„å¯¹è±¡è¦æˆä¸ºå¯å›æ”¶å¯¹è±¡å¿…é¡»è‡³å°‘ç»å†ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹ï¼Œå¦‚æœåœ¨è¿™ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹ä¸­ä»ç„¶æ²¡æœ‰é€ƒè„±æˆä¸ºå¯å›æ”¶å¯¹è±¡çš„å¯èƒ½æ€§ï¼Œåˆ™åŸºæœ¬ä¸Šå°±çœŸçš„æˆä¸ºå¯å›æ”¶å¯¹è±¡äº†ã€‚ æ­¤ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³ï¼šé€šè¿‡ä¸€ç³»åˆ—ç§°ä¸ºâ€œGC Rootsâ€çš„å¯¹è±¡ä½œä¸ºèµ·å§‹ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹å‘ä¸‹æœç´¢ï¼Œæœç´¢èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºâ€œå¼•ç”¨é“¾â€ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åˆ° GC Roots æ²¡æœ‰ä»»ä½•çš„å¼•ç”¨é“¾ç›¸è¿æ—¶(ä» GC Roots åˆ°è¿™ä¸ªå¯¹è±¡ä¸å¯è¾¾)æ—¶ï¼Œè¯æ˜æ­¤å¯¹è±¡ä¸å¯ç”¨ã€‚ åœ¨Javaè¯­è¨€ä¸­ï¼Œå¯ä½œä¸ºGC Rootsçš„å¯¹è±¡åŒ…å«ä»¥ä¸‹å‡ ç§ï¼š è™šæ‹Ÿæœºæ ˆ(æ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨)ä¸­å¼•ç”¨çš„å¯¹è±¡ã€‚(å¯ä»¥ç†è§£ä¸º:å¼•ç”¨æ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨çš„æ‰€æœ‰å¯¹è±¡) æ–¹æ³•åŒºä¸­é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡(å¯ä»¥ç†è§£ä¸º:å¼•ç”¨æ–¹æ³•åŒºè¯¥é™æ€å±æ€§çš„æ‰€æœ‰å¯¹è±¡) æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡(å¯ä»¥ç†è§£ä¸º:å¼•ç”¨æ–¹æ³•åŒºä¸­å¸¸é‡çš„æ‰€æœ‰å¯¹è±¡) æœ¬åœ°æ–¹æ³•æ ˆä¸­(Nativeæ–¹æ³•)å¼•ç”¨çš„å¯¹è±¡(å¯ä»¥ç†è§£ä¸º:å¼•ç”¨Nativeæ–¹æ³•çš„æ‰€æœ‰å¯¹è±¡) å¯ä»¥ç†è§£ä¸º: (1)é¦–å…ˆç¬¬ä¸€ç§æ˜¯è™šæ‹Ÿæœºæ ˆ(çº¿ç¨‹æ ˆ)ä¸­çš„å¼•ç”¨çš„å¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨ç¨‹åºä¸­æ­£å¸¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡ä¼šåœ¨å †ä¸Šå¼€è¾Ÿä¸€å—ç©ºé—´ï¼ŒåŒæ—¶ä¼šå°†è¿™å—ç©ºé—´çš„åœ°å€ä½œä¸ºå¼•ç”¨ä¿å­˜åˆ°è™šæ‹Ÿæœºæ ˆä¸­ï¼Œå¦‚æœå¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»“æŸäº†ï¼Œé‚£ä¹ˆå¼•ç”¨å°±ä¼šä»è™šæ‹Ÿæœºæ ˆä¸­å‡ºæ ˆï¼Œå› æ­¤å¦‚æœåœ¨è™šæ‹Ÿæœºæ ˆä¸­æœ‰å¼•ç”¨ï¼Œå°±è¯´æ˜è¿™ä¸ªå¯¹è±¡è¿˜æ˜¯æœ‰ç”¨çš„ï¼Œè¿™ç§æƒ…å†µæ˜¯æœ€å¸¸è§çš„ã€‚ (2)ç¬¬äºŒç§æ˜¯æˆ‘ä»¬åœ¨ç±»ä¸­å®šä¹‰äº†å…¨å±€çš„é™æ€çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨äº†staticå…³é”®å­—ï¼Œç”±äºè™šæ‹Ÿæœºæ ˆæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œæ‰€ä»¥è¿™ç§å¯¹è±¡çš„å¼•ç”¨ä¼šä¿å­˜åœ¨å…±æœ‰çš„æ–¹æ³•åŒºä¸­ï¼Œæ˜¾ç„¶å°†æ–¹æ³•åŒºä¸­çš„é™æ€å¼•ç”¨ä½œä¸ºGC Rootsæ˜¯å¿…é¡»çš„ã€‚ (3)ç¬¬ä¸‰ç§ä¾¿æ˜¯å¸¸é‡å¼•ç”¨ï¼Œå°±æ˜¯ä½¿ç”¨äº†static finalå…³é”®å­—ï¼Œç”±äºè¿™ç§å¼•ç”¨åˆå§‹åŒ–ä¹‹åä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ–¹æ³•åŒºå¸¸é‡æ± é‡Œçš„å¼•ç”¨çš„å¯¹è±¡ä¹Ÿåº”è¯¥ä½œä¸ºGC Rootsã€‚æœ€åä¸€ç§æ˜¯åœ¨ä½¿ç”¨JNIæŠ€æœ¯æ—¶ï¼Œæœ‰æ—¶å€™å•çº¯çš„Javaä»£ç å¹¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨Javaä¸­è°ƒç”¨Cæˆ–C++çš„ä»£ç ï¼Œå› æ­¤ä¼šä½¿ç”¨nativeæ–¹æ³•ï¼ŒJVMå†…å­˜ä¸­ä¸“é—¨æœ‰ä¸€å—æœ¬åœ°æ–¹æ³•æ ˆï¼Œç”¨æ¥ä¿å­˜è¿™äº›å¯¹è±¡çš„å¼•ç”¨ï¼Œæ‰€ä»¥æœ¬åœ°æ–¹æ³•æ ˆä¸­å¼•ç”¨çš„å¯¹è±¡ä¹Ÿä¼šè¢«ä½œä¸ºGC Rootsã€‚ finalize()æ–¹æ³•æœ€ç»ˆåˆ¤å®šå¯¹è±¡æ˜¯å¦å­˜æ´»: å³ä½¿åœ¨å¯è¾¾æ€§åˆ†æç®—æ³•ä¸­ä¸å¯è¾¾çš„å¯¹è±¡ï¼Œä¹Ÿå¹¶éæ˜¯â€œéæ­»ä¸å¯â€çš„ï¼Œè¿™æ—¶å€™å®ƒä»¬æš‚æ—¶å¤„äºâ€œç¼“åˆ‘â€é˜¶æ®µï¼Œè¦çœŸæ­£å®£å‘Šä¸€ä¸ªå¯¹è±¡æ­»äº¡ï¼Œè‡³å°‘è¦ç»å†å†æ¬¡æ ‡è®°è¿‡ç¨‹ã€‚æ ‡è®°çš„å‰ææ˜¯å¯¹è±¡åœ¨è¿›è¡Œå¯è¾¾æ€§åˆ†æåå‘ç°æ²¡æœ‰ä¸GC Rootsç›¸è¿æ¥çš„å¼•ç”¨é“¾ã€‚ 1).ç¬¬ä¸€æ¬¡æ ‡è®°å¹¶è¿›è¡Œä¸€æ¬¡ç­›é€‰ã€‚ç­›é€‰çš„æ¡ä»¶æ˜¯æ­¤å¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•ã€‚å½“å¯¹è±¡æ²¡æœ‰è¦†ç›–finalizeæ–¹æ³•ï¼Œæˆ–è€…finzlizeæ–¹æ³•å·²ç»è¢«è™šæ‹Ÿæœºè°ƒç”¨è¿‡ï¼Œè™šæ‹Ÿæœºå°†è¿™ä¸¤ç§æƒ…å†µéƒ½è§†ä¸ºâ€œæ²¡æœ‰å¿…è¦æ‰§è¡Œâ€ï¼Œå¯¹è±¡è¢«å›æ”¶ã€‚ 2).ç¬¬äºŒæ¬¡æ ‡è®°å¦‚æœè¿™ä¸ªå¯¹è±¡è¢«åˆ¤å®šä¸ºæœ‰å¿…è¦æ‰§è¡Œfinalizeï¼ˆï¼‰æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°†ä¼šè¢«æ”¾ç½®åœ¨ä¸€ä¸ªåä¸ºï¼šF-Queueçš„é˜Ÿåˆ—ä¹‹ä¸­ï¼Œå¹¶åœ¨ç¨åç”±ä¸€æ¡è™šæ‹Ÿæœºè‡ªåŠ¨å»ºç«‹çš„ã€ä½ä¼˜å…ˆçº§çš„Finalizerçº¿ç¨‹å»æ‰§è¡Œã€‚è¿™é‡Œæ‰€è°“çš„â€œæ‰§è¡Œâ€æ˜¯æŒ‡è™šæ‹Ÿæœºä¼šè§¦å‘è¿™ä¸ªæ–¹æ³•ï¼Œä½†å¹¶ä¸æ‰¿è¯ºä¼šç­‰å¾…å®ƒè¿è¡Œç»“æŸã€‚è¿™æ ·åšçš„åŸå› æ˜¯ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡finalizeï¼ˆï¼‰æ–¹æ³•ä¸­æ‰§è¡Œç¼“æ…¢ï¼Œæˆ–è€…å‘ç”Ÿæ­»å¾ªç¯ï¼ˆæ›´æç«¯çš„æƒ…å†µï¼‰ï¼Œå°†å¾ˆå¯èƒ½ä¼šå¯¼è‡´F-Queueé˜Ÿåˆ—ä¸­çš„å…¶ä»–å¯¹è±¡æ°¸ä¹…å¤„äºç­‰å¾…çŠ¶æ€ï¼Œç”šè‡³å¯¼è‡´æ•´ä¸ªå†…å­˜å›æ”¶ç³»ç»Ÿå´©æºƒã€‚Finalizeï¼ˆï¼‰æ–¹æ³•æ˜¯å¯¹è±¡è„±é€ƒæ­»äº¡å‘½è¿çš„æœ€åä¸€æ¬¡æœºä¼šï¼Œç¨åGCå°†å¯¹F-Queueä¸­çš„å¯¹è±¡è¿›è¡Œç¬¬äºŒæ¬¡å°è§„æ¨¡æ ‡è®°ï¼Œå¦‚æœå¯¹è±¡è¦åœ¨finalizeï¼ˆï¼‰ä¸­æˆåŠŸæ‹¯æ•‘è‡ªå·±â€”-åªè¦é‡æ–°ä¸å¼•ç”¨é“¾ä¸Šçš„ä»»ä½•çš„ä¸€ä¸ªå¯¹è±¡å»ºç«‹å…³è”å³å¯ï¼Œè­¬å¦‚æŠŠè‡ªå·±èµ‹å€¼ç»™æŸä¸ªç±»å˜é‡æˆ–å¯¹è±¡çš„æˆå‘˜å˜é‡ï¼Œé‚£åœ¨ç¬¬äºŒæ¬¡æ ‡è®°æ—¶å®ƒå°†ç§»é™¤å‡ºâ€œå³å°†å›æ”¶â€çš„é›†åˆã€‚å¦‚æœå¯¹è±¡è¿™æ—¶å€™è¿˜æ²¡é€ƒè„±ï¼Œé‚£åŸºæœ¬ä¸Šå®ƒå°±çœŸçš„è¢«å›æ”¶äº†ã€‚ å†æ¥åˆ†æä¸Šé¢çš„é—®é¢˜åŒ¹é…gcç®—æ³•çš„(1)å·æƒ…å†µ GC routs å°†ä¼šä»¥è™šæ‹Ÿæœºæ ˆå¼•ç”¨çš„å¯¹è±¡ä¸ºæ ¹â€¦ â€¦ çœ‹mainå‡½æ•°ä¸­çš„åˆ›å»ºæ–¹æ³• ä¼šå‘ç°è¿™ä¸€è¡Œå¯¹æ‰€æœ‰çš„å¯¹è±¡æ¥è¯´éƒ½æ˜¯æ²¡æœ‰å¼•ç”¨çš„,ä¹Ÿå°±æ˜¯è¯´åœ¨è§¦å‘ä¸‹ä¸€æ¬¡gcçš„æ—¶å€™å°†ä¼šè¢«å›æ”¶,æ‰§è¡Œå…¶ä¸­çš„finillyå‡½æ•°â€¦. åè§‚jdkçš„ä»£ç ,å’Œæˆ‘ä»¬çš„ç±»ä¼¼,newSingleThreadExecutoræ–¹æ³•ç›´æ¥returnä¸€ä¸ªæ–°çš„å¯¹è±¡,å¦‚æœè¿™ä¸ªå¯¹è±¡å’Œæˆ‘ä»¬ä¾‹å­ä¸­ç”¨æ³•ç±»ä¼¼å°†ä¼šå¯¼è‡´ç±»ä¼¼çš„é—®é¢˜ é—®é¢˜æ¥äº†,å…¶å®æˆ‘ä»¬å¹¶ä¸æƒ³ç»“æŸè¿™ä¸ªExecutorå¦‚ä½•è§£å†³ ç›´æ¥å¼ºåˆ¶å¼•ç”¨å°±è¡Œäº† ä¿®æ”¹ä»£ç  å°†æ¯æ¬¡newå‡ºçš„å¯¹è±¡è¿›è¡Œç¼“å­˜,å°±èƒ½ä¿è¯ä¸ä¼šè¢«å¯è¾¾æ€§åˆ†æå‘½ä¸­,ä»è€Œä¿è¯å¸¸é©» java9+ä½¿ç”¨Reference.reachabilityFence(this);ä¿è¯try finallyä¸­çš„å¯¹è±¡å¼ºå¯è¾¾ è¿™ä¸ªæ–¹æ³•ä¿è¯äº†åªæœ‰åœ¨è°ƒç”¨äº†reachabilityFenceä¹‹å,javaçš„gcæ‰èƒ½å›æ”¶è¿™ä¸ªclass â€“ ä¼°è®¡æ˜¯javajdkçš„ä¸€äº›ç‰¹æ®Šçš„ç¼–è¯‘é€»è¾‘ä¿è¯äº†è¿™ä¸ªç‰¹æ€§â€¦â€¦.. æ¯”å¦‚è¿™ä¸ªä»£ç åœ¨java11ä¸­å°±ä¸ä¼šå‡ºé—®é¢˜äº† ä¸è¿‡è¿™ä¸ªé—®é¢˜è²Œä¼¼åœ¨java11 ä¸­è§£å†³äº†,ç›¸åŒçš„ä»£ç åœ¨java11ä¸­æ²¡æœ‰bug ä¸€è„¸è’™è”½ , å…¶å®æœ¬è´¨ä¸Šè¿˜æ˜¯jvmçš„bug jvmæ²¡æœ‰è€ƒè™‘åˆ°è¿™ç§åº”ç”¨æƒ…å†µ å…¶å®å°±æ˜¯jvmçš„ä¸€ä¸ªbug , å¯ä»¥å®ç”¨å¼ºåˆ¶å¼•ç”¨è§„é¿â€¦â€¦ å†™ä»£ç çš„æ—¶å€™ä¸è¦ä½¿ç”¨finilly","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"jdkæºç é˜…è¯»-map","url":"/2024/12/31/jdkæºç é˜…è¯»-map/","content":"é’ˆå¯¹jdk11+ mapç±»å‹æ“ä½œæœ€æ ¸å¿ƒçš„å°±æ˜¯è¿™äº›æ–¹æ³•get(),put(),contain(),computeIfAbsent(), æˆ‘ä»¬åªè§£æè¿™äº›æ–¹æ³•å¦‚ä½•å®ç° æœ‰ä¸€äº›æ ¸å¿ƒç‚¹é€»è¾‘ , resize()(æ‰©å®¹é€»è¾‘) æ•£åˆ—å€¼è®¡ç®—è·å–é€»è¾‘ mapç±»å‹æœ‰ä¸€äº›é€šç”¨çš„é€»è¾‘æ“ä½œ,ç»Ÿä¸€æ¢³ç† æœ€ä¸ºè§£æçš„mapç±»å‹æ˜¯ HashMap Hashtable TreeMap WeakHashMap LinkedHashMap ConcurrentHashMap mapç±»å‹æ•£åˆ—å€¼è®¡ç®— å…¸å‹Mapç±»å‹ hashè®¡ç®—é€»è¾‘ ä¸‹æ ‡è®¡ç®—é€»è¾‘ HashTable keyçš„hash (hash & 0x7FFFFFFF) % tab.length HashMap (h &#x3D; key.hashCode()) ^ (h >>> 16) hash&(tableé•¿åº¦-1) ConurrentHashMap (h ^ (h >>> 16)) & 0x7FFFFFFFTS hash&(tableé•¿åº¦-1) ä¸ºå•¥ & 0x7FFFFFFFTS å‘¢ , ä¸ºäº†è·å¾—ä¸€ä¸ªæ•´å½¢ æ²¡å•¥é“ç† mapç±»å‹getæ–¹æ³• hashMap mapç±»å‹putæ–¹æ³• mapç±»å‹æ‰©å¼ å› ä¸ºhashæ•£åˆ—çš„é—®é¢˜ , æ‰€æœ‰åŸºäºtableæ„å»ºçš„hashmap éƒ½æ˜¯æŒ‰ç…§2çš„Næ¬¡æ–¹è¿›è¡Œæ‰©å®¹ , ä¹‹æ‰€ä»¥æ˜¯2çš„Næ¬¡æ–¹æ˜¯æ–¹ä¾¿hashæ•£åˆ— , è®©æ•£åˆ—æ›´åŠ å‡åŒ€ hashMap çš„æ‰©å¼ é€»è¾‘ ä¸¤ä¸ªå˜é‡ , 1. DEFAULT_INITIAL_CAPACITY -> é»˜è®¤å®¹é‡ 2. threshold -> é»˜è®¤çš„é˜€å€¼(è¿™ä¸ªæ˜¯å€¼æ˜¯é»˜è®¤çš„å®¹é‡*è´Ÿè½½ç³»æ•°) ConcurrentHashMap æ‰©å¼ é€»è¾‘","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"linux-ioå’Œæ–‡ä»¶æ“ä½œè¯¦è§£","url":"/2024/12/31/linux-ioå’Œæ–‡ä»¶æ“ä½œè¯¦è§£/","content":"","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"mybatiså’Œspring","url":"/2024/12/31/mybatiså’Œspring/","content":"","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"springboot-é…ç½®åŠ è½½é¡ºåº","url":"/2024/12/31/springboot-é…ç½®åŠ è½½é¡ºåº/","content":"ä¼˜å…ˆçº§ç”±é«˜åˆ°ä½,é«˜ä¼˜å…ˆçº§è¦†ç›–ä½ä¼˜å…ˆçº§ 1.åœ¨å‘½ä»¤è¡Œä¸­ä¼ å…¥çš„å‚æ•°;2.SPRING_APPLICATION_JSON ä¸­çš„å±æ€§ã€‚SPRING_APPLICATION_JSON æ˜¯ä»¥JSON æ ¼å¼é…ç½®åœ¨ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­çš„å†…å®¹ï¼›3.java:comp&#x2F;env ä¸­çš„ JNDI å±æ€§;4.java çš„ç³»ç»Ÿå±æ€§ï¼Œå¯ä»¥é€šè¿‡System.getProperties()è·å¾—çš„å†…å®¹;5.æ“ä½œç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ã€‚6.é€šè¿‡random.*é…ç½®çš„éšæœºå±æ€§ï¼›7.ä½äºå½“å‰åº”ç”¨jaråŒ…ä¹‹å¤–ï¼Œé’ˆå¯¹ä¸åŒ{profile}ç¯å¢ƒçš„é…ç½®æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚ applicaiton-{profile}.properties æˆ–æ˜¯ yaml å®šä¹‰çš„é…ç½®æ–‡ä»¶ï¼›8.ä½äºå½“å‰åº”ç”¨jaråŒ…ä¹‹å†…ï¼Œé’ˆå¯¹ä¸åŒ{profile}ç¯å¢ƒçš„é…ç½®æ–‡ä»¶å†…å®¹ï¼Œä¾‹å¦‚ applicaiton-{profile}.properites æˆ–æ˜¯ yaml å®šä¹‰çš„é…ç½®æ–‡ä»¶ï¼›9.ä½äºå½“å‰åº”ç”¨jaråŒ…ä¹‹å¤–çš„ application.properties å’Œyamlé…ç½®å†…å®¹ï¼›10.ä½äºå½“å‰åº”ç”¨jaråŒ…ä¹‹å†…çš„ application.properties å’Œyamlé…ç½®å†…å®¹ï¼›11.åœ¨@Configrationæ³¨è§£ä¿®æ”¹çš„ç±»ä¸­ï¼Œé€šè¿‡@PropertySourceæ³¨è§£å®šä¹‰çš„å±æ€§ï¼›12.åº”ç”¨é»˜è®¤å±æ€§ï¼Œä½¿ç”¨SpringApplication.setDefaultPropertieså®šä¹‰çš„å†…å®¹ï¼›","date":"2024-12-31","categories":["æ–°åšå®¢"],"tags":["springç›¸å…³ä¸€äº›é›¶æ•£çš„ç»†èŠ‚"]},{"title":"springæœ€æ ¸å¿ƒçš„ä¸œè¥¿-springå®¹å™¨åˆå§‹åŒ–åˆ°beanåˆå§‹åŒ–çš„å…¨è¿‡ç¨‹","url":"/2024/12/31/springæœ€æ ¸å¿ƒçš„ä¸œè¥¿-springå®¹å™¨åˆå§‹åŒ–åˆ°beanåˆå§‹åŒ–çš„å…¨è¿‡ç¨‹/","content":"å¼•ç”³: å…¶å®ä¸€å¼€å§‹ä¸æƒ³å†™è¿™ç¯‡æ–‡ç« çš„ , å¥ˆä½•å‘ç°å¸‚é¢ä¸Šçš„æ–‡ç« å¤§éƒ¨åˆ†éƒ½æ˜¯ä¸€çŸ¥åŠè§£ . ç´¢æ€§æ•´ç†ä¸€ç¯‡æ–‡ç« æ–¹ä¾¿ä»¥åé˜…è¯»æŸ¥é˜… è¿™æ¬¡å°±ä¸ä¸€å¼€å§‹å°±é•¿ç¯‡å¤§è®ºäº† , å…ˆè¯´ä¸€ä¸ªé—®é¢˜ ,ä¸ºå•¥æˆ‘ä»¬è¦ç ”ç©¶spring ä¸­beançš„åˆå§‹åŒ–é¡ºåº ä¸ºå•¥ç ”ç©¶springä¸­javabeançš„åˆå§‹åŒ–é¡ºåºspring æ¡†æ¶æ˜¯ä¸ªå•¥? -> æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªIOCæ¡†æ¶,è§£å†³ä¾èµ–é—®é¢˜çš„ç©æ„ , ä¾èµ–é—®é¢˜çš„æ ¸å¿ƒæ‰¿è½½ç‚¹æ˜¯å•¥? æ˜¯å¯¹è±¡\\javabean , æ‰€ä»¥å¦‚æœæŠŠè¿™ä¸€å—ææ˜ç™½äº†,å…¶å®æ•´ä¸ªspringæ¡†æ¶å·²ç»å·®ä¸å¤šæé€å½»äº†. springä¸­beanåˆ°åº•æ˜¯å’‹åˆå§‹åŒ–çš„å•Š?å…¶å®æ‰’å¼€springçš„å¤–è¡£ , å…¶å®æœ€æ ¸å¿ƒçš„ä¸œè¥¿æ˜¯BeanFactory , springè‡ªå·±èƒ½æ‰¾åˆ°çš„æ‰€æœ‰çš„java bean å…¨åœ¨é‡Œé¢ , è¿™ä¸ªå°±æ˜¯æ•´ä¸ªspringçš„æ•°æ®ä¸­å¿ƒ å¦‚æœè®©æˆ‘è¯´springæœ€å¤§çš„æˆå°±æ˜¯ä»€ä¹ˆ , æˆ‘è®¤ä¸ºspringæœ€å¤§çš„æˆå°±å°±æ˜¯å®ç°æ•´ä¸ªå®¹å™¨ä¸­javaå¯¹è±¡é€»è¾‘çš„æ‰˜ç®¡åŠŸèƒ½ , ä¹Ÿå°±æ˜¯æˆ‘è®¤ä¸ºçš„IOC springå®¹å™¨åˆå§‹åŒ–çš„å¼€ç«¯ApplicationContext è¿™ä¸ªæ˜¯springæ•´ä¸ªjavaå¯¹è±¡ç®¡ç†è¿è¡Œçš„å¼€ç«¯,æˆ‘ç§°å®ƒä¸ºå§‹ç¥–ç§å­ç±» æ³¨æ„æ°¸è¿œè®°ä½springæ˜¯ä¸€ä¸ªåºå¤§è‡ƒè‚¿åŠŸèƒ½å¼ºå¤§çš„javaæ¡†æ¶ , æ‰€ä»¥ApplicationContextçš„å®ç°ç±»ç‰¹å¤š,æŒ‘å‡ ä¸ªé‡ç‚¹æ¥è¯´ spring boot ä¸­ä½¿ç”¨çš„ApplicationContext -> AnnotationConfigApplicationContext -> ä½¿ç”¨javaé…ç½®æ¥å®ç°å°†javabeanä¿¡æ¯æ³¨å…¥åˆ°å®¹å™¨ springä¸­æœ€å¸¸ç”¨çš„ApplicationContext -> ClassPathXmlApplicationContext -> ä½¿ç”¨xmlæ¥å°†javabeanä¿¡æ¯æ³¨å…¥åˆ°å®¹å™¨ è¿™ä¸¤ä¸ªç±»éƒ½æœ‰ç»§æ‰¿è‡ªAbstractApplication æ‰€æœ‰çš„springå¯¹è±¡åˆå§‹åŒ–çš„æ—¶å€™éƒ½ä¼šè°ƒç”¨è¿™ä¸ªé€šç”¨çš„ç±» , æ•´ä¸ªbeanåˆå§‹åŒ–,å®¹å™¨åŠ è½½ç›¸å…³çš„é€»è¾‘éƒ½æ˜¯åœ¨è¿™é‡Œé¢çš„ spring IOCè¿‡ç¨‹ä¸­æˆ‘ä»¬æœ€åº”è¯¥å…³æ³¨ä»€ä¹ˆé—®é¢˜ æˆ‘è®¤ä¸ºæ•´ä¸ªIOCè¿‡ç¨‹ä¸­æœ€åº”è¯¥å…³æ³¨çš„å°±æ˜¯è¿™ä¸¤ä¸ªé—®é¢˜ 1. beanä»€ä¹ˆæ—¶å€™åˆå§‹åŒ–çš„? æ€ä¹ˆåˆå§‹åŒ–çš„? 2. beanä¹‹é—´çš„ä¾èµ–å…³ç³»æ˜¯ä»€ä¹ˆæ—¶å€™? æ˜¯æ€ä¹ˆè§£å†³çš„? 3. ç‰¹æ®ŠçŠ¶æ€çš„javabeanæ¯”å¦‚lookupå’Œlazyæ˜¯å¦‚ä½•åšçš„ beanä»€ä¹ˆæ—¶å€™åˆå§‹åŒ–çš„springä¸­beançš„åˆå§‹åŒ–çš„è¿‡ç¨‹ ï¼Œ æˆ‘è®¤ä¸ºåˆ†ä¸ºå¦‚ä¸‹çš„å‡ ä¸ªè¿‡ç¨‹ java bean åŠ è½½è¿›å®¹å™¨ ï¼Œ å¹¶ä¸”æ ¹æ®ç±»å‹è¿›è¡Œä¸€å®šçš„åˆå§‹åŒ– å¤„ç† java beançš„ä¾èµ–å…³ç³» è¿™é‡Œæ¢³ç†ä¸€ä¸‹ä»–ä»¬çš„è¿‡ç¨‹ javabeanåŠ è½½è¿›å®¹å™¨ï¼Œ å¹¶ä¸”æ ¹æ®ç±»å‹è¿›è¡Œä¸€å®šçš„åˆå§‹åŒ–æ“ä½œ è¿™ä¸€æ­¥ä¸­ ClassPathXMLApplicationContextå’Œ AnnotationConfigApplicationContextçš„æ“ä½œæ˜¯ä¸åŒçš„ 1. ClassPathXMLApplication ClassPathApplicationContext åœ¨springä¸­å±äºå…ƒè€äº† ï¼Œ ä»–çš„ç€ä¸€å—çš„æ”¯æŒæ˜¯åœ¨AbstractApplicationContextä¸­çš„refresh()æ–¹æ³•ï¼ˆä¸‹é¢ä¼šç»™å‡ºæºç ï¼‰ä¸­å®ç°çš„ æœ€æ ¸å¿ƒçš„é€»è¾‘æ˜¯åœ¨ConfigurableListableBeanFactory beanFactory &#x3D; obtainFreshBeanFactory();è¿™ä¸€è¡Œä¸­ è¿™é‡Œå…¶å®çŸ¥é“ç»“è®ºå°±å¥½äº† ï¼Œæ²¡æœ‰å¿…è¦è¿½ç©¶ç»†èŠ‚ ï¼Œ è¿™é‡Œspringå°†ä¼šé€šè¿‡springçš„xmlæ–‡ä»¶ç”Ÿæˆä¸€ç³»åˆ—çš„javabeançš„åŒ…è£…bean -> BeanDefinition ,ç„¶åæ”¾å…¥é»˜è®¤ç”Ÿæˆçš„DefaultListableBeanFactoryä¹‹ä¸­, æ³¨æ„åœ¨springä¸­ æ‰€æœ‰çš„java beanåœ¨è§£æçš„è¿‡ç¨‹ä¸­éƒ½ä¼šå˜æˆ BeanDefinition(æœ‰äº›ç‰¹æ®Šçš„å•ä¾‹ä¸æ˜¯ç”¨BeanDefinitionå°è£…çš„) 2. AnnotionAppicationContext è¿™ä¸ªéœ€è¦é‡ç‚¹å…³æ³¨ä¸€ä¸‹ ï¼Œ è¿™ä¸ªcontextå’ŒclassPathXmLApplicationContextæœ‰ä¸€å®šçš„åŒºåˆ« , ä»–æ˜¯ç»§æ‰¿è‡ªGenericApplicationContext , GenericApplicationContextæ˜¯æ–°ä¸€ä»£springä½¿ç”¨æ³¨è§£è¿›è¡Œbeané…ç½®çš„æ ¸å¿ƒContext é¦–å…ˆæ³¨æ„ä¸‹è¿™ä¸ªApplicationContextçš„æ„é€ æ–¹æ³• AnnotatedBeanDefinitionReader å’Œ ClassPathBeanDefinitionScanner éƒ½æ˜¯åˆå§‹åŒ–ç”¨æ¥å°†ä½¿ç”¨classæˆ–è€…basePackagesåç§°åŠ è½½çš„BeanDefinitionæ³¨å†Œè¿›GenericApplicationContextçš„å·¥å…·ç±» æœ€æ ¸å¿ƒçš„æ–¹æ³•AbstractAplicationçš„refresh()æ–¹æ³• , è¿™ä¸ªæ–¹æ³•å®Œæˆäº†æ•´ä¸ªspringå£°æ˜å‘¨æœŸçš„åˆå§‹åŒ– æˆ‘ä»¬åªè¦æ³¨æ„è¿™ä¸ªæ–¹æ³• finishBeanFactoryInitialization() springæ‰€æœ‰éå†…ç½®çš„å•ä¾‹ javabeanéƒ½æ˜¯åœ¨è¿™é‡Œåˆå§‹åŒ–çš„ , ä¸»è¦æ˜¯ä¸‹é¢çš„è¿™ä¸€è¡Œ è¿™è¡Œåšäº†beanFactoryä¸­æ‰€æœ‰å•ä¾‹ javabeanåˆå§‹åŒ–å’Œä¾èµ–å¤„ç†çš„, è¿›å…¥çœ‹ä¸€ä¸‹ å…¶å®ä»–çš„æ ¸å¿ƒé€»è¾‘å°±æ˜¯åœ¨è¿™é‡Œ,é€šè¿‡ä½¿ç”¨getBeanæ–¹æ³•æ¥å°½å¿ƒåˆå§‹åŒ–çš„-> è€Œè¿™ä¸ªæ–¹æ³•åŒæ ·ä¹Ÿæ˜¯æˆ‘ä»¬æ¯æ¬¡ä½¿ç”¨ApplicationContextè·å–å¯¹è±¡çš„æ—¶å€™æ‰€éœ€è¦è°ƒç”¨çš„ç±» è¿™ä¸ªgetBeanæ–¹æ³•éå¸¸é•¿,å…¶å®æœ¬è´¨ä¸Šå°±æ˜¯å°è¯•è·å–ä¸€ä¸ªjavabean,å†…éƒ¨å®ç°äº†beançš„åˆ›å»º,ä¾èµ–ç®¡ç†ç­‰ç­‰çš„é€»è¾‘,è´´ä¸€ä¸ªå•ä¾‹æ¨¡å¼çš„æ ¸å¿ƒä»£ç å§ å¤–å±‚çš„getSingleton æ–¹æ³•è‡ªç„¶å°±æ˜¯è·å–å•ä¾‹è€Œå…¶ä¸­çš„ä¼šæ‰å°±æ˜¯å½“å•ä¾‹ä¸å­˜åœ¨çš„æ—¶å€™,è¿›è¡Œåˆ›å»ºçš„é€»è¾‘,è¿›å…¥ä¸€ä¸‹è¿™ä¸ªcreateBean è¿™é‡Œä»£ç ä¾ç„¶å¾ˆå¤šä½†æ˜¯è¿™ä¸ªç±»æœ€ç»ˆä¾èµ–å¾—äº†doCreateBeanæ–¹æ³•,æ‰€ä»¥ç›´æ¥çœ‹doCreateBeanæ–¹æ³•é‡Œæœ‰å•¥,ä½†æ˜¯è¿™é‡Œæ‰§è¡Œäº†ä¸€ä¸ªå‰ç½®å¤„ç†é€»è¾‘(postProcessBeforeInstantiation)æ–¹æ³•æ¥è¶…å‰å¤„ç†beanåˆå§‹åŒ– æ¥ä¸‹æ¥å°±æ˜¯é‡ç‚¹äº†doCreateBeanæ–¹æ³•,è§£å†³äº†å¾ªç¯å¼•ç”¨é—®é¢˜å’Œå®ç°ææ—©æ›å…‰çš„é€»è¾‘éƒ½æ˜¯åœ¨è¿™é‡Œ è¿™é‡Œæœ‰å‡ ä¸ªé‡ç‚¹ æˆ‘ä»¬çš„javabeanå±æ€§æ³¨å…¥æ˜¯åœ¨ populateBeanæ–¹æ³•ä¸­å®ç°çš„,ä»–çš„å†…éƒ¨é€»è¾‘æ˜¯ä½¿ç”¨äº†é€’å½’æ¥å¾ªç¯çš„å¡«å†²å±æ€§. è¿™é‡Œä¹Ÿå¤„ç†äº†æ„é€ å‡½æ•°ç­‰ç­‰ä¾èµ–å…³ç³». è¿™é‡Œè¦æ’ä¸€å¥AutoWriterAnnotionBeanPostProcessor AutoWriterAnnotionBeanPostProcessor , åœ¨è¿™é‡Œæœ‰ä¸€ä¸ªç‰¹æ®Šçš„å¤„ç†é€»è¾‘å¯ä»¥å€Ÿé‰´ä¸€ä¸‹ AutoWriterAnnotionBeanPostProcessor å°†éœ€è¦çš„å±æ€§,ä½¿ç”¨åå°„å¹¶å°†åå°„ç¼“å­˜äº†ä¸€ä¸‹(injectionMetadataCache) , æ¥åŠ å¿«æ€§èƒ½ ä¾èµ–å…³ç³»å¤„ç† å…¶å®çœ‹ä¸Šé¢doCreateçš„é€»è¾‘æœ‰ä¸€ä¸ªearlySingletonExposureå˜é‡, springåœ¨æ‰§è¡Œåˆ°è¿™é‡Œçš„æ—¶å€™å°†ä¼šè‡ªåŠ¨çš„å°†è¿™ä¸ªè¿˜æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–çš„ç±»(ä¹Ÿå°±æ˜¯å½“beanä¸ºå•ä¾‹ && å®¹å™¨é…ç½®å…è®¸å¾ªç¯ä¾èµ– && beanæ­£åœ¨åˆ›å»º)çš„æ—¶å€™,å°†ä¼šåœ¨BeanFactoryä¸­è®¾ç½®ç¬¬ä¸‰çº§ç¼“å­˜, keyæ˜¯å½“å‰çš„beançš„åç§°,valueæ˜¯ä¸€ä¸ªå·¥å‚æ–¹æ³• , å¾ˆç®€å•å°±æ˜¯è¿”å›å½“å‰çš„ç±» ps: spring å¦‚ä½•è§£å†³å¾ªç¯å¼•ç”¨çš„? è¿™ä¸ªå¯ä»¥çœ‹ä¸€ä¸‹springçš„getBeançš„é€»è¾‘ , å…¶ä¸­æœ‰ä¸€æ®µè¿™æ ·çš„ä»£ç  å¦‚æœç¬¬ä¸€å±‚ç¼“å­˜æ²¡æœ‰æ‰¾åˆ°,å°±ä»æ—©èµ·ç±»é‡Œæ‰¾å¦‚æœæ—©æœŸç±»é‡Œè¿˜æ²¡æœ‰,å°±ä½¿ç”¨å·¥å‚æ–¹æ³•è·å– èŠä¸€ä¸‹è¿™ä¸‰å±‚ç¼“å­˜éƒ½å¹²äº†å•¥ ç¬¬ä¸€å±‚: æ‰€æœ‰çš„åˆå§‹åŒ–å®Œæˆçš„å•ä¾‹beanæ—©æœŸçš„bean: è¢«å¾ªç¯å¼•ç”¨è§¦å‘äº†,å¹¶ä¸”è¿˜æ²¡æœ‰åˆå§‹åŒ–å®Œæˆçš„beanç¬¬ä¸‰å±‚: æ­£åœ¨è¢«åˆå§‹åŒ–çš„bean å¦‚ä½•è§£å†³å¾ªç¯å¼•ç”¨å°±å¾ˆç®€å•äº† , å¦‚æœAä¾èµ–äº†B å¹¶ä¸”Bä¾èµ–äº†A , å½“Aåˆå§‹åŒ–äº†Bçš„æ—¶å€™, Båˆå§‹åŒ–æ—¶å°†ä¼šä»ç¬¬ä¸‰å±‚å¼•ç”¨ä¸­è·å–å½“å‰çš„ææ—©æ›å…‰çš„ç±»,ä»è€Œå®ç°äº†è§£å†³å¾ªç¯å¼•ç”¨,å¹¶ä¸”springçš„å®ç°,è¿˜å®ç°äº†å¤šçº¿ç¨‹æ¨¡å¼ä¸‹ä¹Ÿå¯ä»¥è¿›è¡Œå¾ªç¯åº”ç”¨çš„é€»è¾‘ è¿˜æ²¡å®Œ,æ•´ä¸ªç”Ÿå‘½å‘¨æœŸè¿˜æ²¡æœ‰å½»åº•ææ‡‚","date":"2024-12-31","categories":["æ–°åšå®¢"],"tags":["springç›¸å…³ä¸€äº›é›¶æ•£çš„ç»†èŠ‚"]},{"title":"åˆ†å¸ƒå¼åè°ƒå’ŒåŒæ­¥","url":"/2024/12/31/åˆ†å¸ƒå¼åè°ƒå’ŒåŒæ­¥/","content":"æœ¬è´¨ä¸Šæ˜¯è®©åˆ†å¸ƒåœ¨ä¸åŒè®¡ç®—æœºä¸Šçš„ç¨‹åºå…·æœ‰â€œå›¢é˜Ÿç²¾ç¥â€ï¼Œæ¢å¥è¯è¯´å°±æ˜¯è®©ç¨‹åºé€šè¿‡åä½œå…±åŒå»è¾¾æˆä¸€ä¸ªä¸šåŠ¡ç›®æ ‡ åˆ†å¸ƒå¼äº’æ–¥å¯¹äºåŒä¸€å…±äº«èµ„æºï¼Œä¸€ä¸ªç¨‹åºæ­£åœ¨ä½¿ç”¨çš„æ—¶å€™ä¹Ÿä¸å¸Œæœ›è¢«å…¶ä»–ç¨‹åºæ‰“æ‰°ã€‚è¿™ï¼Œå°±è¦æ±‚åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªç¨‹åºèƒ½å¤Ÿè®¿é—®è¿™ç§èµ„æºã€‚ åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œï¼Œè¿™ç§æ’ä»–æ€§çš„èµ„æºè®¿é—®æ–¹å¼ï¼Œå«ä½œåˆ†å¸ƒå¼äº’æ–¥ï¼ˆDistributed Mutual Exclusionï¼‰ï¼Œè€Œè¿™ç§è¢«äº’æ–¥è®¿é—®çš„å…±äº«èµ„æºå°±å«ä½œä¸´ç•Œèµ„æºï¼ˆCritical Resourceï¼‰ã€‚ å¦‚ä½•æ‰èƒ½è®©åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œçš„ç¨‹åºäº’æ–¥åœ°è®¿é—®ä¸´ç•Œèµ„æº?ä¸‰ç§ç®—æ³•-> é›†ä¸­å¼ç®—æ³• , åˆ†å¸ƒå¼ç®—æ³• , ä»¤ç‰Œç¯ç®—æ³•é›†ä¸­å¼ç®—æ³•æˆ‘ä»¬å¼•å…¥ä¸€ä¸ªåè°ƒè€…ç¨‹åºï¼Œå¾—åˆ°ä¸€ä¸ªåˆ†å¸ƒå¼äº’æ–¥ç®—æ³•ã€‚æ¯ä¸ªç¨‹åºåœ¨éœ€è¦è®¿é—®ä¸´ç•Œèµ„æºæ—¶ï¼Œå…ˆç»™åè°ƒè€…å‘é€ä¸€ä¸ªè¯·æ±‚ã€‚å¦‚æœå½“å‰æ²¡æœ‰ç¨‹åºä½¿ç”¨è¿™ä¸ªèµ„æºï¼Œåè°ƒè€…ç›´æ¥æˆæƒè¯·æ±‚ç¨‹åºè®¿é—®ï¼›å¦åˆ™ï¼ŒæŒ‰ç…§å…ˆæ¥ååˆ°çš„é¡ºåºä¸ºè¯·æ±‚ç¨‹åºâ€œæ’ä¸€ä¸ªå·â€ã€‚å¦‚æœæœ‰ç¨‹åºä½¿ç”¨å®Œèµ„æºï¼Œåˆ™é€šçŸ¥åè°ƒè€…ï¼Œåè°ƒè€…ä»â€œæ’å·â€çš„é˜Ÿåˆ—é‡Œå–å‡ºæ’åœ¨æœ€å‰é¢çš„è¯·æ±‚ï¼Œå¹¶ç»™å®ƒå‘é€æˆæƒæ¶ˆæ¯ã€‚æ‹¿åˆ°æˆæƒæ¶ˆæ¯çš„ç¨‹åºï¼Œå¯ä»¥ç›´æ¥å»è®¿é—®ä¸´ç•Œèµ„æºã€‚ è¿™ä¸ªäº’æ–¥ç®—æ³•ï¼Œå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„é›†ä¸­å¼ç®—æ³•ï¼Œä¹Ÿå¯ä»¥å«åšä¸­å¤®æœåŠ¡å™¨ç®—æ³•ã€‚ä¹‹æ‰€ä»¥è¿™ä¹ˆç§°å‘¼ï¼Œæ˜¯å› ä¸ºåè°ƒè€…ä»£è¡¨ç€é›†ä¸­ç¨‹åºæˆ–ä¸­å¤®æœåŠ¡å™¨ã€‚ é›†ä¸­å¼ç®—æ³•çš„ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š ä»ä¸Šè¿°æµç¨‹å¯ä»¥çœ‹å‡ºï¼Œä¸€ä¸ªç¨‹åºå®Œæˆä¸€æ¬¡ä¸´ç•Œèµ„æºè®¿é—®ï¼Œéœ€è¦å¦‚ä¸‹å‡ ä¸ªæµç¨‹å’Œæ¶ˆæ¯äº¤äº’ï¼š å‘åè°ƒè€…å‘é€è¯·æ±‚æˆæƒä¿¡æ¯ï¼Œ1 æ¬¡æ¶ˆæ¯äº¤äº’ï¼› åè°ƒè€…å‘ç¨‹åºå‘æ”¾æˆæƒä¿¡æ¯ï¼Œ1 æ¬¡æ¶ˆæ¯äº¤äº’ï¼› ç¨‹åºä½¿ç”¨å®Œä¸´ç•Œèµ„æºåï¼Œå‘åè°ƒè€…å‘é€é‡Šæ”¾æˆæƒï¼Œ1 æ¬¡æ¶ˆæ¯äº¤äº’ ä¸éš¾çœ‹å‡ºï¼Œé›†ä¸­å¼ç®—æ³•çš„ä¼˜ç‚¹åœ¨äºç›´è§‚ã€ç®€å•ã€ä¿¡æ¯äº¤äº’é‡å°‘ã€æ˜“äºå®ç°ï¼Œå¹¶ä¸”æ‰€æœ‰ç¨‹åºåªéœ€å’Œåè°ƒè€…é€šä¿¡ï¼Œç¨‹åºä¹‹é—´æ— éœ€é€šä¿¡ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªç®—æ³•çš„é—®é¢˜ä¹Ÿå‡ºåœ¨äº†åè°ƒè€…èº«ä¸Š ä¸€æ–¹é¢ï¼Œåè°ƒè€…ä¼šæˆä¸ºç³»ç»Ÿçš„æ€§èƒ½ç“¶é¢ˆã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæœ‰ 100 ä¸ªç¨‹åºè¦è®¿é—®ä¸´ç•Œèµ„æºï¼Œé‚£ä¹ˆåè°ƒè€…è¦å¤„ç† 100*3&#x3D;300 æ¡æ¶ˆæ¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåè°ƒè€…å¤„ç†çš„æ¶ˆæ¯æ•°é‡ä¼šéšç€éœ€è¦è®¿é—®ä¸´ç•Œèµ„æºçš„ç¨‹åºæ•°é‡çº¿æ€§å¢åŠ ã€‚ å¦ä¸€æ–¹é¢ï¼Œå®¹æ˜“å¼•å‘å•ç‚¹æ•…éšœé—®é¢˜ã€‚åè°ƒè€…æ•…éšœï¼Œä¼šå¯¼è‡´æ‰€æœ‰çš„ç¨‹åºå‡æ— æ³•è®¿é—®ä¸´ç•Œèµ„æºï¼Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ã€‚ å› æ­¤ï¼Œåœ¨ä½¿ç”¨é›†ä¸­å¼ç®—æ³•çš„æ—¶å€™ï¼Œä¸€å®šè¦é€‰æ‹©æ€§èƒ½å¥½ã€å¯é æ€§é«˜çš„æœåŠ¡å™¨æ¥è¿è¡Œåè°ƒè€…ã€‚ åˆ†å¸ƒå¼ç®—æ³•å½“ä¸€ä¸ªç¨‹åºè¦è®¿é—®ä¸´ç•Œèµ„æºæ—¶ï¼Œå…ˆå‘ç³»ç»Ÿä¸­çš„å…¶ä»–ç¨‹åºå‘é€ä¸€æ¡è¯·æ±‚æ¶ˆæ¯ï¼Œåœ¨æ¥æ”¶åˆ°æ‰€æœ‰ç¨‹åºè¿”å›çš„åŒæ„æ¶ˆæ¯åï¼Œæ‰å¯ä»¥è®¿é—®ä¸´ç•Œèµ„æºã€‚å…¶ä¸­ï¼Œè¯·æ±‚æ¶ˆæ¯éœ€è¦åŒ…å«æ‰€è¯·æ±‚çš„èµ„æºã€è¯·æ±‚è€…çš„ IDï¼Œä»¥åŠå‘èµ·è¯·æ±‚çš„æ—¶é—´ã€‚ ç±»ä¼¼æ°‘ä¸»åå•†,åœ¨åˆ†å¸ƒå¼é¢†åŸŸä¸­ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºåˆ†å¸ƒå¼ç®—æ³•ï¼Œæˆ–è€…ä½¿ç”¨ç»„æ’­å’Œé€»è¾‘æ—¶é’Ÿçš„ç®—æ³•ã€‚ ä¸€ä¸ªç¨‹åºå®Œæˆä¸€æ¬¡ä¸´ç•Œèµ„æºçš„è®¿é—®ï¼Œéœ€è¦è¿›è¡Œå¦‚ä¸‹çš„ä¿¡æ¯äº¤äº’ï¼š å‘å…¶ä»– n-1 ä¸ªç¨‹åºå‘é€è®¿é—®ä¸´ç•Œèµ„æºçš„è¯·æ±‚ï¼Œæ€»å…±éœ€è¦ n-1 æ¬¡æ¶ˆæ¯äº¤äº’ï¼› éœ€è¦æ¥æ”¶åˆ°å…¶ä»– n-1 ä¸ªç¨‹åºå›å¤çš„åŒæ„æ¶ˆæ¯ï¼Œæ–¹å¯è®¿é—®èµ„æºï¼Œæ€»å…±éœ€è¦ n-1 æ¬¡æ¶ˆæ¯äº¤äº’ã€‚ å¯ä»¥çœ‹å‡ºï¼Œä¸€ä¸ªç¨‹åºè¦æˆåŠŸè®¿é—®ä¸´ç•Œèµ„æºï¼Œè‡³å°‘éœ€è¦ 2*(n-1) æ¬¡æ¶ˆæ¯äº¤äº’ã€‚å‡è®¾ï¼Œç°åœ¨ç³»ç»Ÿä¸­çš„ n ä¸ªç¨‹åºéƒ½è¦è®¿é—®ä¸´ç•Œèµ„æºï¼Œåˆ™ä¼šåŒæ—¶äº§ç”Ÿ 2n(n-1) æ¡æ¶ˆæ¯ã€‚æ€»ç»“æ¥è¯´ï¼Œåœ¨å¤§å‹ç³»ç»Ÿä¸­ä½¿ç”¨åˆ†å¸ƒå¼ç®—æ³•ï¼Œæ¶ˆæ¯æ•°é‡ä¼šéšç€éœ€è¦è®¿é—®ä¸´ç•Œèµ„æºçš„ç¨‹åºæ•°é‡å‘ˆæŒ‡æ•°çº§å¢åŠ ï¼Œå®¹æ˜“å¯¼è‡´é«˜æ˜‚çš„â€œæ²Ÿé€šæˆæœ¬â€ã€‚ ä»ä¸Šè¿°åˆ†æä¸éš¾çœ‹å‡ºï¼Œåˆ†å¸ƒå¼ç®—æ³•æ ¹æ®â€œå…ˆåˆ°å…ˆå¾—â€ä»¥åŠâ€œæŠ•ç¥¨å…¨ç¥¨é€šè¿‡â€çš„æœºåˆ¶ï¼Œè®©æ¯ä¸ªç¨‹åºæŒ‰æ—¶é—´é¡ºåºå…¬å¹³åœ°è®¿é—®èµ„æºï¼Œç®€å•ç²—æš´ã€æ˜“äºå®ç°ã€‚ä½†ï¼Œè¿™ä¸ªç®—æ³•å¯ç”¨æ€§å¾ˆä½ï¼Œä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªæ–¹é¢çš„åŸå› ï¼š å½“ç³»ç»Ÿå†…éœ€è¦è®¿é—®ä¸´ç•Œèµ„æºçš„ç¨‹åºå¢å¤šæ—¶ï¼Œå®¹æ˜“äº§ç”Ÿâ€œä¿¡ä»¤é£æš´â€ï¼Œä¹Ÿå°±æ˜¯ç¨‹åºæ”¶åˆ°çš„è¯·æ±‚å®Œå…¨è¶…è¿‡äº†è‡ªå·±çš„å¤„ç†èƒ½åŠ›ï¼Œè€Œå¯¼è‡´è‡ªå·±æ­£å¸¸çš„ä¸šåŠ¡æ— æ³•å¼€å±•ã€‚ ä¸€æ—¦æŸä¸€ç¨‹åºå‘ç”Ÿæ•…éšœï¼Œæ— æ³•å‘é€åŒæ„æ¶ˆæ¯ï¼Œé‚£ä¹ˆå…¶ä»–ç¨‹åºå‡å¤„åœ¨ç­‰å¾…å›å¤çš„çŠ¶æ€ä¸­ï¼Œä½¿å¾—æ•´ä¸ªç³»ç»Ÿå¤„äºåœæ»çŠ¶æ€ï¼Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ã€‚æ‰€ä»¥ï¼Œç›¸å¯¹äºé›†ä¸­å¼ç®—æ³•çš„åè°ƒè€…æ•…éšœï¼Œåˆ†å¸ƒå¼ç®—æ³•çš„å¯ç”¨æ€§æ›´ä½ã€‚ é’ˆå¯¹å¯ç”¨æ€§ä½çš„ä¸€ç§æ”¹è¿›åŠæ³•æ˜¯ï¼Œå¦‚æœæ£€æµ‹åˆ°ä¸€ä¸ªç¨‹åºæ•…éšœï¼Œåˆ™ç›´æ¥å¿½ç•¥è¿™ä¸ªç¨‹åºï¼Œæ— éœ€å†ç­‰å¾…å®ƒçš„åŒæ„æ¶ˆæ¯ã€‚è¿™å°±å¥½æ¯”åœ¨è‡ªåŠ©é¤å…ï¼Œä¸€ä¸ªäººç¦»å¼€é¤å…äº†ï¼Œé‚£ä½ åœ¨ä½¿ç”¨å’–å•¡æœºå‰ï¼Œä¹Ÿæ— éœ€å¾å¾—ä»–çš„åŒæ„ã€‚ä½†è¿™æ ·çš„è¯ï¼Œæ¯ä¸ªç¨‹åºéƒ½éœ€è¦å¯¹å…¶ä»–ç¨‹åºè¿›è¡Œæ•…éšœæ£€æµ‹ï¼Œè¿™æ— ç–‘å¸¦æ¥äº†æ›´å¤§çš„å¤æ‚æ€§ã€‚ å› æ­¤ï¼Œåˆ†å¸ƒå¼ç®—æ³•é€‚åˆèŠ‚ç‚¹æ•°ç›®å°‘ä¸”å˜åŠ¨ä¸é¢‘ç¹çš„ç³»ç»Ÿï¼Œä¸”ç”±äºæ¯ä¸ªç¨‹åºå‡éœ€é€šä¿¡äº¤äº’ï¼Œå› æ­¤é€‚åˆ P2P ç»“æ„çš„ç³»ç»Ÿã€‚æ¯”å¦‚ï¼Œè¿è¡Œåœ¨å±€åŸŸç½‘ä¸­çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œå…·æœ‰ P2P ç»“æ„çš„ç³»ç»Ÿç­‰ã€‚ é‚£ä¹ˆï¼Œåœ¨æˆ‘ä»¬å·¥ä½œä¸­ï¼Œä»€ä¹ˆæ ·çš„åœºæ™¯é€‚åˆé‡‡ç”¨åˆ†å¸ƒå¼ç®—æ³•å‘¢ï¼Ÿ Hadoop æ˜¯æˆ‘ä»¬éå¸¸ç†Ÿæ‚‰çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå…¶ä¸­çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ HDFS çš„æ–‡ä»¶ä¿®æ”¹å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„åº”ç”¨åˆ†å¸ƒå¼ç®—æ³•çš„åœºæ™¯ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¤„äºåŒä¸€ä¸ªå±€åŸŸç½‘å†…çš„è®¡ç®—æœº 1ã€2ã€3 ä¸­éƒ½æœ‰åŒä¸€ä»½æ–‡ä»¶çš„å¤‡ä»½ä¿¡æ¯ï¼Œä¸”å®ƒä»¬å¯ä»¥ç›¸äº’é€šä¿¡ã€‚è¿™ä¸ªå…±äº«æ–‡ä»¶ï¼Œå°±æ˜¯ä¸´ç•Œèµ„æºã€‚å½“è®¡ç®—æœº 1 æƒ³è¦ä¿®æ”¹å…±äº«çš„æ–‡ä»¶æ—¶ï¼Œéœ€è¦è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š è®¡ç®—æœº 1 å‘è®¡ç®—æœº 2ã€3 å‘é€æ–‡ä»¶ä¿®æ”¹è¯·æ±‚ï¼› è®¡ç®—æœº 2ã€3 å‘ç°è‡ªå·±ä¸éœ€è¦ä½¿ç”¨èµ„æºï¼Œå› æ­¤åŒæ„è®¡ç®—æœº 1 çš„è¯·æ±‚ï¼› è®¡ç®—æœº 1 æ”¶åˆ°å…¶ä»–æ‰€æœ‰è®¡ç®—æœºçš„åŒæ„æ¶ˆæ¯åï¼Œå¼€å§‹ä¿®æ”¹è¯¥æ–‡ä»¶ï¼› è®¡ç®—æœº 1 ä¿®æ”¹å®Œæˆåï¼Œå‘è®¡ç®—æœº 2ã€3 å‘é€æ–‡ä»¶ä¿®æ”¹å®Œæˆçš„æ¶ˆæ¯ï¼Œå¹¶å‘é€ä¿®æ”¹åçš„æ–‡ä»¶æ•°æ®ï¼› è®¡ç®—æœº 2 å’Œ 3 æ”¶åˆ°è®¡ç®—æœº 1 çš„æ–°æ–‡ä»¶æ•°æ®åï¼Œæ›´æ–°æœ¬åœ°çš„å¤‡ä»½æ–‡ä»¶ å½’çº³ä¸€ä¸‹ï¼šåˆ†å¸ƒå¼ç®—æ³•æ˜¯ä¸€ä¸ªâ€œå…ˆåˆ°å…ˆå¾—â€å’Œâ€œæŠ•ç¥¨å…¨ç¥¨é€šè¿‡â€çš„å…¬å¹³è®¿é—®æœºåˆ¶ï¼Œä½†é€šä¿¡æˆæœ¬è¾ƒé«˜ï¼Œå¯ç”¨æ€§ä¹Ÿæ¯”é›†ä¸­å¼ç®—æ³•ä½ï¼Œé€‚ç”¨äºä¸´ç•Œèµ„æºä½¿ç”¨é¢‘åº¦è¾ƒä½ï¼Œä¸”ç³»ç»Ÿè§„æ¨¡è¾ƒå°çš„åœºæ™¯ã€‚ ä»¤ç‰Œç¯ç®—æ³•æ‰€æœ‰ç¨‹åºæ„æˆä¸€ä¸ªç¯ç»“æ„ï¼Œä»¤ç‰ŒæŒ‰ç…§é¡ºæ—¶é’ˆï¼ˆæˆ–é€†æ—¶é’ˆï¼‰æ–¹å‘åœ¨ç¨‹åºä¹‹é—´ä¼ é€’ï¼Œæ”¶åˆ°ä»¤ç‰Œçš„ç¨‹åºæœ‰æƒè®¿é—®ä¸´ç•Œèµ„æºï¼Œè®¿é—®å®Œæˆåå°†ä»¤ç‰Œä¼ é€åˆ°ä¸‹ä¸€ä¸ªç¨‹åºï¼›è‹¥è¯¥ç¨‹åºä¸éœ€è¦è®¿é—®ä¸´ç•Œèµ„æºï¼Œåˆ™ç›´æ¥æŠŠä»¤ç‰Œä¼ é€ç»™ä¸‹ä¸€ä¸ªç¨‹åºã€‚ å› ä¸ºåœ¨ä½¿ç”¨ä¸´ç•Œèµ„æºå‰ï¼Œä¸éœ€è¦åƒåˆ†å¸ƒå¼ç®—æ³•é‚£æ ·æŒ¨ä¸ªå¾æ±‚å…¶ä»–ç¨‹åºçš„æ„è§äº†ï¼Œæ‰€ä»¥ç›¸å¯¹è€Œè¨€ï¼Œåœ¨ä»¤ç‰Œç¯ç®—æ³•é‡Œå•ä¸ªç¨‹åºå…·æœ‰æ›´é«˜çš„é€šä¿¡æ•ˆç‡ã€‚åŒæ—¶ï¼Œåœ¨ä¸€ä¸ªå‘¨æœŸå†…ï¼Œæ¯ä¸ªç¨‹åºéƒ½èƒ½è®¿é—®åˆ°ä¸´ç•Œèµ„æºï¼Œå› æ­¤ä»¤ç‰Œç¯ç®—æ³•çš„å…¬å¹³æ€§å¾ˆå¥½ã€‚ ä½†æ˜¯ï¼Œä¸ç®¡ç¯ä¸­çš„ç¨‹åºæ˜¯å¦æƒ³è¦è®¿é—®èµ„æºï¼Œéƒ½éœ€è¦æ¥æ”¶å¹¶ä¼ é€’ä»¤ç‰Œï¼Œæ‰€ä»¥ä¹Ÿä¼šå¸¦æ¥ä¸€äº›æ— æ•ˆé€šä¿¡ã€‚å‡è®¾ç³»ç»Ÿä¸­æœ‰ 100 ä¸ªç¨‹åºï¼Œé‚£ä¹ˆç¨‹åº 1 è®¿é—®å®Œèµ„æºåï¼Œå³ä½¿å…¶å®ƒ 99 ä¸ªç¨‹åºä¸éœ€è¦è®¿é—®ï¼Œä¹Ÿå¿…é¡»è¦ç­‰ä»¤ç‰Œåœ¨å…¶ä»– 99 ä¸ªç¨‹åºä¼ é€’å®Œåï¼Œæ‰èƒ½é‡æ–°è®¿é—®èµ„æºï¼Œè¿™å°±é™ä½äº†ç³»ç»Ÿçš„å®æ—¶æ€§ã€‚ å°ç»“ä¸€ä¸‹ï¼šä»¤ç‰Œç¯ç®—æ³•çš„å…¬å¹³æ€§é«˜ï¼Œåœ¨æ”¹è¿›å•ç‚¹æ•…éšœåï¼Œç¨³å®šæ€§ä¹Ÿå¾ˆé«˜ï¼Œé€‚ç”¨äºç³»ç»Ÿè§„æ¨¡è¾ƒå°ï¼Œå¹¶ä¸”ç³»ç»Ÿä¸­æ¯ä¸ªç¨‹åºä½¿ç”¨ä¸´ç•Œèµ„æºçš„é¢‘ç‡é«˜ä¸”ä½¿ç”¨æ—¶é—´æ¯”è¾ƒçŸ­çš„åœºæ™¯ã€‚ æœ‰é€‚åˆå¤§è§„æ¨¡ç³»ç»Ÿä¸­çš„åˆ†å¸ƒå¼äº’æ–¥ç®—æ³•å—?å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢æåˆ°çš„é›†ä¸­å¼ã€åˆ†å¸ƒå¼å’Œä»¤ç‰Œç¯ 3 ä¸ªäº’æ–¥ç®—æ³•ï¼Œéƒ½ä¸é€‚ç”¨äºè§„æ¨¡è¿‡å¤§ã€èŠ‚ç‚¹æ•°é‡è¿‡å¤šçš„ç³»ç»Ÿã€‚é‚£ä¹ˆï¼Œä»€ä¹ˆæ ·çš„äº’æ–¥ç®—æ³•é€‚ç”¨äºå¤§è§„æ¨¡ç³»ç»Ÿå‘¢ï¼Ÿ ç”±äºå¤§è§„æ¨¡ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œæˆ‘ä»¬å¾ˆè‡ªç„¶åœ°æƒ³åˆ°è¦ç”¨ä¸€ä¸ªç›¸å¯¹å¤æ‚çš„äº’æ–¥ç®—æ³•ã€‚æ—¶ä¸‹æœ‰ä¸€ä¸ªå¾ˆæµè¡Œçš„äº’æ–¥ç®—æ³•ï¼Œä¸¤å±‚ç»“æ„çš„åˆ†å¸ƒå¼ä»¤ç‰Œç¯ç®—æ³•ï¼ŒæŠŠæ•´ä¸ªå¹¿åŸŸç½‘ç³»ç»Ÿä¸­çš„èŠ‚ç‚¹ç»„ç»‡æˆä¸¤å±‚ç»“æ„ï¼Œå¯ä»¥ç”¨äºèŠ‚ç‚¹æ•°é‡è¾ƒå¤šçš„ç³»ç»Ÿï¼Œæˆ–è€…æ˜¯å¹¿åŸŸç½‘ç³»ç»Ÿã€‚ æˆ‘ä»¬çŸ¥é“ï¼Œå¹¿åŸŸç½‘ç”±å¤šä¸ªå±€åŸŸç½‘ç»„æˆï¼Œå› æ­¤åœ¨è¯¥ç®—æ³•ä¸­ï¼Œå±€åŸŸç½‘æ˜¯è¾ƒä½çš„å±‚æ¬¡ï¼Œå¹¿åŸŸç½‘æ˜¯è¾ƒé«˜çš„å±‚æ¬¡ã€‚æ¯ä¸ªå±€åŸŸç½‘ä¸­åŒ…å«è‹¥å¹²ä¸ªå±€éƒ¨è¿›ç¨‹å’Œä¸€ä¸ªåè°ƒè¿›ç¨‹ã€‚å±€éƒ¨è¿›ç¨‹åœ¨é€»è¾‘ä¸Šç»„æˆä¸€ä¸ªç¯å½¢ç»“æ„ï¼Œåœ¨æ¯ä¸ªç¯å½¢ç»“æ„ä¸Šæœ‰ä¸€ä¸ªå±€éƒ¨ä»¤ç‰Œ T åœ¨å±€éƒ¨è¿›ç¨‹é—´ä¼ é€’ã€‚å±€åŸŸç½‘ä¸å±€åŸŸç½‘ä¹‹é—´é€šè¿‡å„è‡ªçš„åè°ƒè¿›ç¨‹è¿›è¡Œé€šä¿¡ï¼Œè¿™äº›åè°ƒè¿›ç¨‹åŒæ ·ç»„æˆä¸€ä¸ªç¯ç»“æ„ï¼Œè¿™ä¸ªç¯å°±æ˜¯å¹¿åŸŸç½‘ä¸­çš„å…¨å±€ç¯ã€‚åœ¨è¿™ä¸ªå…¨å±€ç¯ä¸Šï¼Œæœ‰ä¸€ä¸ªå…¨å±€ä»¤ç‰Œåœ¨å¤šä¸ªåè°ƒè¿›ç¨‹é—´ä¼ é€’ã€‚æ€»ç»“ æœ¬è´¨ä¸Šå¯ä»¥å®ç”¨é›†ä¸­å¼ç®—æ³•+ä»¤ç‰Œç¯ç®—æ³•ç»„åˆæ¥å®ç°å¤§è§„æ¨¡äº’æ–¥ é›†ä¸­å¼ç®—æ³•ï¼šå¯å‚ç…§redisé›†ç¾¤é€šä¿¡æ¨¡å¼ï¼Œé€šè¿‡hash keyå°†å¤§é‡çš„è¯·æ±‚åˆ†æ•£åˆ°ä¸åŒçš„master,ä»¥å¤„ç†å¤§é‡è¯·æ±‚,æ¯ä¸ªmasterç”±å°é›†ç¾¤ä¸»ä»èŠ‚ç‚¹æ¥ä¿éšœå•ç‚¹æ•…éšœåˆ†å¸ƒå¼ç®—æ³•ï¼šåˆ†å¸ƒå¼ç®—æ³•å¯åœ¨é›†ç¾¤ä¸­è¿‡åŠæ•°åŒæ„å°±è¯†ä¸ºå…¶åŒæ„ï¼Œé™ä½é€šä¿¡æ•°ï¼Œå¦‚åˆ†å¸ƒå¼é€‰ä¸¾åœºæ™¯ä»¤ç‰Œç¯ç®—æ³•ï¼šå¯æ ¹æ®å‚ä¸è€…ä½¿ç”¨é¢‘ç‡åˆ—å‡ºæƒé‡ï¼Œç»“åˆå¹³æ»‘åŠ æƒè½®è¯¢ç®—æ³•é€‰å‡ºä¸‹ä¸€ä¸ªå‚ä¸è€… åˆ†å¸ƒå¼é€‰ä¸¾æå‡ºä¸€ä¸ªé—®é¢˜å¯¹äºä¸€ä¸ªé›†ç¾¤æ¥è¯´ï¼Œå¤šä¸ªèŠ‚ç‚¹åˆ°åº•æ˜¯æ€ä¹ˆååŒï¼Œæ€ä¹ˆç®¡ç†çš„å‘¢ã€‚æ¯”å¦‚ï¼Œæ•°æ®åº“é›†ç¾¤ï¼Œå¦‚ä½•ä¿è¯å†™å…¥çš„æ•°æ®åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½ä¸€è‡´å‘¢? ä¹Ÿè®¸ä½ ä¼šè¯´ï¼Œè¿™è¿˜ä¸ç®€å•ï¼Œé€‰ä¸€ä¸ªâ€œé¢†å¯¼â€æ¥è´Ÿè´£è°ƒåº¦å’Œç®¡ç†å…¶ä»–èŠ‚ç‚¹å°±å¯ä»¥äº†å•Šã€‚è¿™ä¸ªæƒ³æ³•ä¸€ç‚¹å„¿ä¹Ÿæ²¡é”™ã€‚è¿™ä¸ªâ€œé¢†å¯¼â€ï¼Œåœ¨åˆ†å¸ƒå¼ä¸­å«åšä¸»èŠ‚ç‚¹ï¼Œè€Œé€‰â€œé¢†å¯¼â€çš„è¿‡ç¨‹åœ¨åˆ†å¸ƒå¼é¢†åŸŸä¸­å«ä½œåˆ†å¸ƒå¼é€‰ä¸¾ã€‚ç„¶åï¼Œä½ å¯èƒ½è¿˜ä¼šé—®ï¼Œæ€ä¹ˆé€‰ä¸»å‘¢? ä¸ºä»€ä¹ˆè¿›è¡Œåˆ†å¸ƒå¼é€‰ä¸¾ä¸»èŠ‚ç‚¹ï¼Œåœ¨ä¸€ä¸ªåˆ†å¸ƒå¼é›†ç¾¤ä¸­è´Ÿè´£å¯¹å…¶ä»–èŠ‚ç‚¹çš„åè°ƒå’Œç®¡ç†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶ä»–èŠ‚ç‚¹éƒ½å¿…é¡»å¬ä»ä¸»èŠ‚ç‚¹çš„å®‰æ’ã€‚ ä¸»èŠ‚ç‚¹çš„å­˜åœ¨ï¼Œå°±å¯ä»¥ä¿è¯å…¶ä»–èŠ‚ç‚¹çš„æœ‰åºè¿è¡Œï¼Œä»¥åŠæ•°æ®åº“é›†ç¾¤ä¸­çš„å†™å…¥æ•°æ®åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„ä¸€è‡´æ€§ã€‚è¿™é‡Œçš„ä¸€è‡´æ€§æ˜¯æŒ‡ï¼Œæ•°æ®åœ¨æ¯ä¸ªé›†ç¾¤èŠ‚ç‚¹ä¸­éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¸å­˜åœ¨ä¸åŒçš„æƒ…å†µã€‚ å½“ç„¶ï¼Œå¦‚æœä¸»æ•…éšœäº†ï¼Œé›†ç¾¤å°±ä¼šå¤©ä¸‹å¤§ä¹±ï¼Œå°±å¥½æ¯”ä¸€ä¸ªå›½å®¶çš„çš‡å¸é©¾å´©äº†ï¼Œå›½å®¶å¤§ä¹±ä¸€æ ·ã€‚æ¯”å¦‚ï¼Œæ•°æ®åº“é›†ç¾¤ä¸­ä¸»èŠ‚ç‚¹æ•…éšœåï¼Œå¯èƒ½å¯¼è‡´æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„æ•°æ®ä¼šä¸ä¸€è‡´ã€‚ è¿™ï¼Œå°±åº”äº†é‚£å¥è¯â€œå›½ä¸å¯ä¸€æ—¥æ— å›â€ï¼Œå¯¹åº”åˆ°åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å°±æ˜¯â€œé›†ç¾¤ä¸å¯ä¸€åˆ»æ— ä¸»â€ã€‚æ€»ç»“æ¥è¯´ï¼Œé€‰ä¸¾çš„ä½œç”¨å°±æ˜¯é€‰å‡ºä¸€ä¸ªä¸»èŠ‚ç‚¹ï¼Œç”±å®ƒæ¥åè°ƒå’Œç®¡ç†å…¶ä»–èŠ‚ç‚¹ï¼Œä»¥ä¿è¯é›†ç¾¤æœ‰åºè¿è¡Œå’ŒèŠ‚ç‚¹é—´æ•°æ®çš„ä¸€è‡´æ€§ã€‚ åˆ†å¸ƒå¼é€‰ä¸¾ç®—æ³•ç›®å‰å¸¸è§çš„é€‰ä¸»æ–¹æ³•æœ‰åŸºäºåºå·é€‰ä¸¾çš„ç®—æ³•ï¼ˆ æ¯”å¦‚ï¼ŒBully ç®—æ³•ï¼‰ã€å¤šæ•°æ´¾ç®—æ³•ï¼ˆæ¯”å¦‚ï¼ŒRaft ç®—æ³•ã€ZAB ç®—æ³•ï¼‰ç­‰ Bully ç®—æ³•Bully ç®—æ³•æ˜¯ä¸€ç§éœ¸é“çš„é›†ç¾¤é€‰ä¸»ç®—æ³•ï¼Œä¸ºä»€ä¹ˆè¯´æ˜¯éœ¸é“å‘¢ï¼Ÿå› ä¸ºå®ƒçš„é€‰ä¸¾åŸåˆ™æ˜¯â€œé•¿è€…â€ä¸ºå¤§ï¼Œå³åœ¨æ‰€æœ‰æ´»ç€çš„èŠ‚ç‚¹ä¸­ï¼Œé€‰å– ID æœ€å¤§çš„èŠ‚ç‚¹ä½œä¸ºä¸»èŠ‚ç‚¹ã€‚ åœ¨ Bully ç®—æ³•ä¸­ï¼ŒèŠ‚ç‚¹çš„è§’è‰²æœ‰ä¸¤ç§ï¼šæ™®é€šèŠ‚ç‚¹å’Œä¸»èŠ‚ç‚¹ã€‚åˆå§‹åŒ–æ—¶ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯å¹³ç­‰çš„ï¼Œéƒ½æ˜¯æ™®é€šèŠ‚ç‚¹ï¼Œå¹¶ä¸”éƒ½æœ‰æˆä¸ºä¸»çš„æƒåˆ©ã€‚ä½†æ˜¯ï¼Œå½“é€‰ä¸»æˆåŠŸåï¼Œæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªèŠ‚ç‚¹æˆä¸ºä¸»èŠ‚ç‚¹ï¼Œå…¶ä»–æ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯æ™®é€šèŠ‚ç‚¹ã€‚å½“ä¸”ä»…å½“ä¸»èŠ‚ç‚¹æ•…éšœæˆ–ä¸å…¶ä»–èŠ‚ç‚¹å¤±å»è”ç³»åï¼Œæ‰ä¼šé‡æ–°é€‰ä¸»ã€‚ Bully ç®—æ³•åœ¨é€‰ä¸¾è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ç”¨åˆ°ä»¥ä¸‹ 3 ç§æ¶ˆæ¯ï¼š Election æ¶ˆæ¯ï¼Œç”¨äºå‘èµ·é€‰ä¸¾ï¼› Alive æ¶ˆæ¯ï¼Œå¯¹ Election æ¶ˆæ¯çš„åº”ç­”ï¼› Victory æ¶ˆæ¯ï¼Œç«é€‰æˆåŠŸçš„ä¸»èŠ‚ç‚¹å‘å…¶ä»–èŠ‚ç‚¹å‘é€çš„å®£èª“ä¸»æƒçš„æ¶ˆæ¯ã€‚ Bully ç®—æ³•é€‰ä¸¾çš„åŸåˆ™æ˜¯â€œé•¿è€…ä¸ºå¤§â€ï¼Œæ„å‘³ç€å®ƒçš„å‡è®¾æ¡ä»¶æ˜¯ï¼Œé›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹å‡çŸ¥é“å…¶ä»–èŠ‚ç‚¹çš„ IDã€‚åœ¨æ­¤å‰æä¸‹ï¼Œå…¶å…·ä½“çš„é€‰ä¸¾è¿‡ç¨‹æ˜¯ï¼š é›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹åˆ¤æ–­è‡ªå·±çš„ ID æ˜¯å¦ä¸ºå½“å‰æ´»ç€çš„èŠ‚ç‚¹ä¸­ ID æœ€å¤§çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç›´æ¥å‘å…¶ä»–èŠ‚ç‚¹å‘é€ Victory æ¶ˆæ¯ï¼Œå®£èª“è‡ªå·±çš„ä¸»æƒï¼› å¦‚æœè‡ªå·±ä¸æ˜¯å½“å‰æ´»ç€çš„èŠ‚ç‚¹ä¸­ ID æœ€å¤§çš„ï¼Œåˆ™å‘æ¯”è‡ªå·± ID å¤§çš„æ‰€æœ‰èŠ‚ç‚¹å‘é€ Election æ¶ˆæ¯ï¼Œå¹¶ç­‰å¾…å…¶ä»–èŠ‚ç‚¹çš„å›å¤ï¼› è‹¥åœ¨ç»™å®šçš„æ—¶é—´èŒƒå›´å†…ï¼Œæœ¬èŠ‚ç‚¹æ²¡æœ‰æ”¶åˆ°å…¶ä»–èŠ‚ç‚¹å›å¤çš„ Alive æ¶ˆæ¯ï¼Œåˆ™è®¤ä¸ºè‡ªå·±æˆä¸ºä¸»èŠ‚ç‚¹ï¼Œå¹¶å‘å…¶ä»–èŠ‚ç‚¹å‘é€ Victory æ¶ˆæ¯ï¼Œå®£èª“è‡ªå·±æˆä¸ºä¸»èŠ‚ç‚¹ï¼›è‹¥æ¥æ”¶åˆ°æ¥è‡ªæ¯”è‡ªå·± ID å¤§çš„èŠ‚ç‚¹çš„ Alive æ¶ˆæ¯ï¼Œåˆ™ç­‰å¾…å…¶ä»–èŠ‚ç‚¹å‘é€ Victory æ¶ˆæ¯ï¼› è‹¥æœ¬èŠ‚ç‚¹æ”¶åˆ°æ¯”è‡ªå·± ID å°çš„èŠ‚ç‚¹å‘é€çš„ Election æ¶ˆæ¯ï¼Œåˆ™å›å¤ä¸€ä¸ª Alive æ¶ˆæ¯ï¼Œå‘ŠçŸ¥å…¶ä»–èŠ‚ç‚¹ï¼Œæˆ‘æ¯”ä½ å¤§ï¼Œé‡æ–°é€‰ä¸¾ã€‚ å…¶å®Victoryå¯ä»¥ç†è§£æˆä¸€ç§ç‰¹æ®Šçš„Election ç›®å‰å·²ç»æœ‰å¾ˆå¤šå¼€æºè½¯ä»¶é‡‡ç”¨äº† Bully ç®—æ³•è¿›è¡Œé€‰ä¸»ï¼Œæ¯”å¦‚ MongoDB çš„å‰¯æœ¬é›†æ•…éšœè½¬ç§»åŠŸèƒ½ã€‚MongoDB çš„åˆ†å¸ƒå¼é€‰ä¸¾ä¸­ï¼Œé‡‡ç”¨èŠ‚ç‚¹çš„æœ€åæ“ä½œæ—¶é—´æˆ³æ¥è¡¨ç¤º IDï¼Œæ—¶é—´æˆ³æœ€æ–°çš„èŠ‚ç‚¹å…¶ ID æœ€å¤§ï¼Œä¹Ÿå°±æ˜¯è¯´æ—¶é—´æˆ³æœ€æ–°çš„ã€æ´»ç€çš„èŠ‚ç‚¹æ˜¯ä¸»èŠ‚ç‚¹ã€‚ å°ç»“ä¸€ä¸‹ã€‚Bully ç®—æ³•çš„é€‰æ‹©ç‰¹åˆ«éœ¸é“å’Œç®€å•ï¼Œè°æ´»ç€ä¸”è°çš„ ID æœ€å¤§è°å°±æ˜¯ä¸»èŠ‚ç‚¹ï¼Œå…¶ä»–èŠ‚ç‚¹å¿…é¡»æ— æ¡ä»¶æœä»ã€‚è¿™ç§ç®—æ³•çš„ä¼˜ç‚¹æ˜¯ï¼Œé€‰ä¸¾é€Ÿåº¦å¿«ã€ç®—æ³•å¤æ‚åº¦ä½ã€ç®€å•æ˜“å®ç°ã€‚ ä½†è¿™ç§ç®—æ³•çš„ç¼ºç‚¹åœ¨äºï¼Œéœ€è¦æ¯ä¸ªèŠ‚ç‚¹æœ‰å…¨å±€çš„èŠ‚ç‚¹ä¿¡æ¯ï¼Œå› æ­¤é¢å¤–ä¿¡æ¯å­˜å‚¨è¾ƒå¤šï¼›å…¶æ¬¡ï¼Œä»»æ„ä¸€ä¸ªæ¯”å½“å‰ä¸»èŠ‚ç‚¹ ID å¤§çš„æ–°èŠ‚ç‚¹æˆ–èŠ‚ç‚¹æ•…éšœåæ¢å¤åŠ å…¥é›†ç¾¤çš„æ—¶å€™ï¼Œéƒ½å¯èƒ½ä¼šè§¦å‘é‡æ–°é€‰ä¸¾ï¼Œæˆä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œå¦‚æœè¯¥èŠ‚ç‚¹é¢‘ç¹é€€å‡ºã€åŠ å…¥é›†ç¾¤ï¼Œå°±ä¼šå¯¼è‡´é¢‘ç¹åˆ‡ä¸»ã€‚ Raft ç®—æ³•Raft ç®—æ³•æ˜¯å…¸å‹çš„å¤šæ•°æ´¾æŠ•ç¥¨é€‰ä¸¾ç®—æ³•ï¼Œå…¶é€‰ä¸¾æœºåˆ¶ä¸æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­çš„æ°‘ä¸»æŠ•ç¥¨æœºåˆ¶ç±»ä¼¼ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯â€œå°‘æ•°æœä»å¤šæ•°â€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒRaft ç®—æ³•ä¸­ï¼Œè·å¾—æŠ•ç¥¨æœ€å¤šçš„èŠ‚ç‚¹æˆä¸ºä¸»ã€‚ é‡‡ç”¨ Raft ç®—æ³•é€‰ä¸¾ï¼Œé›†ç¾¤èŠ‚ç‚¹çš„è§’è‰²æœ‰ 3 ç§ï¼š åˆå§‹åŒ–æ—¶ï¼Œæ‰€æœ‰èŠ‚ç‚¹å‡ä¸º Follower çŠ¶æ€ã€‚ å¼€å§‹é€‰ä¸»æ—¶ï¼Œæ‰€æœ‰èŠ‚ç‚¹çš„çŠ¶æ€ç”± Follower è½¬åŒ–ä¸º Candidateï¼Œå¹¶å‘å…¶ä»–èŠ‚ç‚¹å‘é€é€‰ä¸¾è¯·æ±‚ã€‚ å…¶ä»–èŠ‚ç‚¹æ ¹æ®æ¥æ”¶åˆ°çš„é€‰ä¸¾è¯·æ±‚çš„å…ˆåé¡ºåºï¼Œå›å¤æ˜¯å¦åŒæ„æˆä¸ºä¸»ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ¯ä¸€è½®é€‰ä¸¾ä¸­ï¼Œä¸€ä¸ªèŠ‚ç‚¹åªèƒ½æŠ•å‡ºä¸€å¼ ç¥¨ã€‚ è‹¥å‘èµ·é€‰ä¸¾è¯·æ±‚çš„èŠ‚ç‚¹è·å¾—è¶…è¿‡ä¸€åŠçš„æŠ•ç¥¨ï¼Œåˆ™æˆä¸ºä¸»èŠ‚ç‚¹ï¼Œå…¶çŠ¶æ€è½¬åŒ–ä¸º Leaderï¼Œå…¶ä»–èŠ‚ç‚¹çš„çŠ¶æ€åˆ™ç”± Candidate é™ä¸º Followerã€‚Leader èŠ‚ç‚¹ä¸ Follower èŠ‚ç‚¹ä¹‹é—´ä¼šå®šæœŸå‘é€å¿ƒè·³åŒ…ï¼Œä»¥æ£€æµ‹ä¸»èŠ‚ç‚¹æ˜¯å¦æ´»ç€ã€‚ å½“ Leader èŠ‚ç‚¹çš„ä»»æœŸåˆ°äº†ï¼Œå³å‘ç°å…¶ä»–æœåŠ¡å™¨å¼€å§‹ä¸‹ä¸€è½®é€‰ä¸»å‘¨æœŸæ—¶ï¼ŒLeader èŠ‚ç‚¹çš„çŠ¶æ€ç”± Leader é™çº§ä¸º Followerï¼Œè¿›å…¥æ–°ä¸€è½®é€‰ä¸»ã€‚ è¯·æ³¨æ„ï¼Œæ¯ä¸€è½®é€‰ä¸¾ï¼Œæ¯ä¸ªèŠ‚ç‚¹åªèƒ½æŠ•ä¸€æ¬¡ç¥¨ã€‚è¿™ç§é€‰ä¸¾å°±ç±»ä¼¼äººå¤§ä»£è¡¨é€‰ä¸¾ï¼Œæ­£å¸¸æƒ…å†µä¸‹æ¯ä¸ªäººå¤§ä»£è¡¨éƒ½æœ‰ä¸€å®šçš„ä»»æœŸï¼Œä»»æœŸåˆ°åä¼šè§¦å‘é‡æ–°é€‰ä¸¾ï¼Œä¸”æŠ•ç¥¨è€…åªèƒ½å°†è‡ªå·±æ‰‹é‡Œå”¯ä¸€çš„ç¥¨æŠ•ç»™å…¶ä¸­ä¸€ä¸ªå€™é€‰è€…ã€‚å¯¹åº”åˆ° Raft ç®—æ³•ä¸­ï¼Œé€‰ä¸»æ˜¯å‘¨æœŸè¿›è¡Œçš„ï¼ŒåŒ…æ‹¬é€‰ä¸»å’Œä»»å€¼ä¸¤ä¸ªæ—¶é—´æ®µï¼Œé€‰ä¸»é˜¶æ®µå¯¹åº”æŠ•ç¥¨é˜¶æ®µï¼Œä»»å€¼é˜¶æ®µå¯¹åº”èŠ‚ç‚¹æˆä¸ºä¸»ä¹‹åçš„ä»»æœŸã€‚ä½†ä¹Ÿæœ‰ä¾‹å¤–çš„æ—¶å€™ï¼Œå¦‚æœä¸»èŠ‚ç‚¹æ•…éšœï¼Œä¼šç«‹é©¬å‘èµ·é€‰ä¸¾ï¼Œé‡æ–°é€‰å‡ºä¸€ä¸ªä¸»èŠ‚ç‚¹ã€‚ Google å¼€æºçš„ Kubernetesï¼Œæ“…é•¿å®¹å™¨ç®¡ç†ä¸è°ƒåº¦ï¼Œä¸ºäº†ä¿è¯å¯é æ€§ï¼Œé€šå¸¸ä¼šéƒ¨ç½² 3 ä¸ªèŠ‚ç‚¹ç”¨äºæ•°æ®å¤‡ä»½ã€‚è¿™ 3 ä¸ªèŠ‚ç‚¹ä¸­ï¼Œæœ‰ä¸€ä¸ªä¼šè¢«é€‰ä¸ºä¸»ï¼Œå…¶ä»–èŠ‚ç‚¹ä½œä¸ºå¤‡ã€‚Kubernetes çš„é€‰ä¸»é‡‡ç”¨çš„æ˜¯å¼€æºçš„ etcd ç»„ä»¶ã€‚è€Œï¼Œetcd çš„é›†ç¾¤ç®¡ç†å™¨ etcdsï¼Œæ˜¯ä¸€ä¸ªé«˜å¯ç”¨ã€å¼ºä¸€è‡´æ€§çš„æœåŠ¡å‘ç°å­˜å‚¨ä»“åº“ï¼Œå°±æ˜¯é‡‡ç”¨äº† Raft ç®—æ³•æ¥å®ç°é€‰ä¸»å’Œä¸€è‡´æ€§çš„ã€‚ å°ç»“ä¸€ä¸‹ã€‚Raft ç®—æ³•å…·æœ‰é€‰ä¸¾é€Ÿåº¦å¿«ã€ç®—æ³•å¤æ‚åº¦ä½ã€æ˜“äºå®ç°çš„ä¼˜ç‚¹ï¼›ç¼ºç‚¹æ˜¯ï¼Œå®ƒè¦æ±‚ç³»ç»Ÿå†…æ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥ç›¸äº’é€šä¿¡ï¼Œä¸”éœ€è¦è·å¾—è¿‡åŠçš„æŠ•ç¥¨æ•°æ‰èƒ½é€‰ä¸»æˆåŠŸï¼Œå› æ­¤é€šä¿¡é‡å¤§ã€‚è¯¥ç®—æ³•é€‰ä¸¾ç¨³å®šæ€§æ¯” Bully ç®—æ³•å¥½ï¼Œè¿™æ˜¯å› ä¸ºå½“æœ‰æ–°èŠ‚ç‚¹åŠ å…¥æˆ–èŠ‚ç‚¹æ•…éšœæ¢å¤åï¼Œä¼šè§¦å‘é€‰ä¸»ï¼Œä½†ä¸ä¸€å®šä¼šçœŸæ­£åˆ‡ä¸»ï¼Œé™¤éæ–°èŠ‚ç‚¹æˆ–æ•…éšœåæ¢å¤çš„èŠ‚ç‚¹è·å¾—æŠ•ç¥¨æ•°è¿‡åŠï¼Œæ‰ä¼šå¯¼è‡´åˆ‡ä¸»ã€‚ ZAB ç®—æ³•ZABï¼ˆZooKeeper Atomic Broadcastï¼‰é€‰ä¸¾ç®—æ³•æ˜¯ä¸º ZooKeeper å®ç°åˆ†å¸ƒå¼åè°ƒåŠŸèƒ½è€Œè®¾è®¡çš„ã€‚ç›¸è¾ƒäº Raft ç®—æ³•çš„æŠ•ç¥¨æœºåˆ¶ï¼ŒZAB ç®—æ³•å¢åŠ äº†é€šè¿‡èŠ‚ç‚¹ ID å’Œæ•°æ® ID ä½œä¸ºå‚è€ƒè¿›è¡Œé€‰ä¸»ï¼ŒèŠ‚ç‚¹ ID å’Œæ•°æ® ID è¶Šå¤§ï¼Œè¡¨ç¤ºæ•°æ®è¶Šæ–°ï¼Œä¼˜å…ˆæˆä¸ºä¸»ã€‚ç›¸æ¯”è¾ƒäº Raft ç®—æ³•ï¼ŒZAB ç®—æ³•å°½å¯èƒ½ä¿è¯æ•°æ®çš„æœ€æ–°æ€§ã€‚æ‰€ä»¥ï¼ŒZAB ç®—æ³•å¯ä»¥è¯´æ˜¯å¯¹ Raft ç®—æ³•çš„æ”¹è¿›ã€‚ ä½¿ç”¨ ZAB ç®—æ³•é€‰ä¸¾æ—¶ï¼Œé›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹æ‹¥æœ‰ 3 ç§è§’è‰²ï¼š Leaderï¼Œä¸»èŠ‚ç‚¹ï¼› Followerï¼Œè·Ÿéšè€…èŠ‚ç‚¹ï¼› Observerï¼Œè§‚å¯Ÿè€…ï¼Œæ— æŠ•ç¥¨æƒã€‚ é€‰ä¸¾è¿‡ç¨‹ä¸­ï¼Œé›†ç¾¤ä¸­çš„èŠ‚ç‚¹æ‹¥æœ‰ 4 ä¸ªçŠ¶æ€ï¼š Looking çŠ¶æ€ï¼Œå³é€‰ä¸¾çŠ¶æ€ã€‚å½“èŠ‚ç‚¹å¤„äºè¯¥çŠ¶æ€æ—¶ï¼Œå®ƒä¼šè®¤ä¸ºå½“å‰é›†ç¾¤ä¸­æ²¡æœ‰ Leaderï¼Œå› æ­¤è‡ªå·±è¿›å…¥é€‰ä¸¾çŠ¶æ€ã€‚ Leading çŠ¶æ€ï¼Œå³é¢†å¯¼è€…çŠ¶æ€ï¼Œè¡¨ç¤ºå·²ç»é€‰å‡ºä¸»ï¼Œä¸”å½“å‰èŠ‚ç‚¹ä¸º Leaderã€‚ Following çŠ¶æ€ï¼Œå³è·Ÿéšè€…çŠ¶æ€ï¼Œé›†ç¾¤ä¸­å·²ç»é€‰å‡ºä¸»åï¼Œå…¶ä»–éä¸»èŠ‚ç‚¹çŠ¶æ€æ›´æ–°ä¸º Followingï¼Œè¡¨ç¤ºå¯¹ Leader çš„è¿½éšã€‚ Observing çŠ¶æ€ï¼Œå³è§‚å¯Ÿè€…çŠ¶æ€ï¼Œè¡¨ç¤ºå½“å‰èŠ‚ç‚¹ä¸º Observerï¼ŒæŒè§‚æœ›æ€åº¦ï¼Œæ²¡æœ‰æŠ•ç¥¨æƒå’Œé€‰ä¸¾æƒã€‚ æŠ•ç¥¨è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ä¸‰å…ƒç»„ (server_id, server_zxID, epoch)ï¼Œå…¶ä¸­ server_id è¡¨ç¤ºæœ¬èŠ‚ç‚¹çš„å”¯ä¸€ IDï¼›server_zxID è¡¨ç¤ºæœ¬èŠ‚ç‚¹å­˜æ”¾çš„æ•°æ® IDï¼Œæ•°æ® ID è¶Šå¤§è¡¨ç¤ºæ•°æ®è¶Šæ–°ï¼Œé€‰ä¸¾æƒé‡è¶Šå¤§ï¼›epoch è¡¨ç¤ºå½“å‰é€‰å–è½®æ•°ï¼Œä¸€èˆ¬ç”¨é€»è¾‘æ—¶é’Ÿè¡¨ç¤ºã€‚ ZAB é€‰ä¸¾ç®—æ³•çš„æ ¸å¿ƒæ˜¯â€œå°‘æ•°æœä»å¤šæ•°ï¼ŒID å¤§çš„èŠ‚ç‚¹ä¼˜å…ˆæˆä¸ºä¸»â€ï¼Œå› æ­¤é€‰ä¸¾è¿‡ç¨‹ä¸­é€šè¿‡ (vote_id, vote_zxID) æ¥è¡¨æ˜æŠ•ç¥¨ç»™å“ªä¸ªèŠ‚ç‚¹ï¼Œå…¶ä¸­ vote_id è¡¨ç¤ºè¢«æŠ•ç¥¨èŠ‚ç‚¹çš„ IDï¼Œvote_zxID è¡¨ç¤ºè¢«æŠ•ç¥¨èŠ‚ç‚¹çš„æœåŠ¡å™¨ zxIDã€‚ZAB ç®—æ³•é€‰ä¸»çš„åŸåˆ™æ˜¯ï¼šserver_zxID æœ€å¤§è€…æˆä¸º Leaderï¼›è‹¥ server_zxID ç›¸åŒï¼Œåˆ™ server_id æœ€å¤§è€…æˆä¸º Leaderã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¥ 3 ä¸ª Server çš„é›†ç¾¤ä¸ºä¾‹ï¼Œæ­¤å¤„æ¯ä¸ª Server ä»£è¡¨ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸ä½ ä»‹ç» ZAB é€‰ä¸»çš„è¿‡ç¨‹ã€‚ ç¬¬ä¸€æ­¥ï¼šå½“ç³»ç»Ÿåˆšå¯åŠ¨æ—¶ï¼Œ3 ä¸ªæœåŠ¡å™¨å½“å‰æŠ•ç¥¨å‡ä¸ºç¬¬ä¸€è½®æŠ•ç¥¨ï¼Œå³ epoch&#x3D;1ï¼Œä¸” zxID å‡ä¸º 0ã€‚æ­¤æ—¶æ¯ä¸ªæœåŠ¡å™¨éƒ½æ¨é€‰è‡ªå·±ï¼Œå¹¶å°†é€‰ç¥¨ä¿¡æ¯ <epoch, vote_id, vote_zxID> å¹¿æ’­å‡ºå»ã€‚ ç¬¬äºŒæ­¥ï¼šæ ¹æ®åˆ¤æ–­è§„åˆ™ï¼Œç”±äº 3 ä¸ª Server çš„ epochã€zxID éƒ½ç›¸åŒï¼Œå› æ­¤æ¯”è¾ƒ server_idï¼Œè¾ƒå¤§è€…å³ä¸ºæ¨é€‰å¯¹è±¡ï¼Œå› æ­¤ Server 1 å’Œ Server 2 å°† vote_id æ”¹ä¸º 3ï¼Œæ›´æ–°è‡ªå·±çš„æŠ•ç¥¨ç®±å¹¶é‡æ–°å¹¿æ’­è‡ªå·±çš„æŠ•ç¥¨ã€‚ ç¬¬ä¸‰æ­¥ï¼šæ­¤æ—¶ç³»ç»Ÿå†…æ‰€æœ‰æœåŠ¡å™¨éƒ½æ¨é€‰äº† Server 3ï¼Œå› æ­¤ Server 3 å½“é€‰ Leaderï¼Œå¤„äº Leading çŠ¶æ€ï¼Œå‘å…¶ä»–æœåŠ¡å™¨å‘é€å¿ƒè·³åŒ…å¹¶ç»´æŠ¤è¿æ¥ï¼›Server1 å’Œ Server2 å¤„äº Following çŠ¶æ€ã€‚ å°ç»“ä¸€ä¸‹ã€‚ZAB ç®—æ³•æ€§èƒ½é«˜ï¼Œå¯¹ç³»ç»Ÿæ— ç‰¹æ®Šè¦æ±‚ï¼Œé‡‡ç”¨å¹¿æ’­æ–¹å¼å‘é€ä¿¡æ¯ï¼Œè‹¥èŠ‚ç‚¹ä¸­æœ‰ n ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒæ—¶å¹¿æ’­ï¼Œåˆ™é›†ç¾¤ä¸­ä¿¡æ¯é‡ä¸º n*(n-1) ä¸ªæ¶ˆæ¯ï¼Œå®¹æ˜“å‡ºç°å¹¿æ’­é£æš´ï¼›ä¸”é™¤äº†æŠ•ç¥¨ï¼Œè¿˜å¢åŠ äº†å¯¹æ¯”èŠ‚ç‚¹ ID å’Œæ•°æ® IDï¼Œè¿™å°±æ„å‘³ç€è¿˜éœ€è¦çŸ¥é“æ‰€æœ‰èŠ‚ç‚¹çš„ ID å’Œæ•°æ® IDï¼Œæ‰€ä»¥é€‰ä¸¾æ—¶é—´ç›¸å¯¹è¾ƒé•¿ã€‚ä½†è¯¥ç®—æ³•é€‰ä¸¾ç¨³å®šæ€§æ¯”è¾ƒå¥½ï¼Œå½“æœ‰æ–°èŠ‚ç‚¹åŠ å…¥æˆ–èŠ‚ç‚¹æ•…éšœæ¢å¤åï¼Œä¼šè§¦å‘é€‰ä¸»ï¼Œä½†ä¸ä¸€å®šä¼šçœŸæ­£åˆ‡ä¸»ï¼Œé™¤éæ–°èŠ‚ç‚¹æˆ–æ•…éšœåæ¢å¤çš„èŠ‚ç‚¹æ•°æ® ID å’ŒèŠ‚ç‚¹ ID æœ€å¤§ï¼Œä¸”è·å¾—æŠ•ç¥¨æ•°è¿‡åŠï¼Œæ‰ä¼šå¯¼è‡´åˆ‡ä¸»ã€‚ ä¸‰ç§é€‰ä¸¾ç®—æ³•çš„å¯¹æ¯”åˆ†æ å¼•ç”³ çŸ¥è¯†æ‰©å±•ï¼šä¸ºä»€ä¹ˆâ€œå¤šæ•°æ´¾â€é€‰ä¸»ç®—æ³•é€šå¸¸é‡‡ç”¨å¥‡æ•°èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯å¶æ•°èŠ‚ç‚¹å‘¢ï¼Ÿ å¤šæ•°æ´¾é€‰ä¸»ç®—æ³•çš„æ ¸å¿ƒæ˜¯å°‘æ•°æœä»å¤šæ•°ï¼Œè·å¾—æŠ•ç¥¨å¤šçš„èŠ‚ç‚¹èƒœå‡ºã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœç°åœ¨é‡‡ç”¨å¶æ•°èŠ‚ç‚¹é›†ç¾¤ï¼Œå½“ä¸¤ä¸ªèŠ‚ç‚¹å‡è·å¾—ä¸€åŠæŠ•ç¥¨æ—¶ï¼Œåˆ°åº•åº”è¯¥é€‰è°ä¸ºä¸»å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ— æ³•é€‰å‡ºä¸»ï¼Œå¿…é¡»é‡æ–°æŠ•ç¥¨é€‰ä¸¾ã€‚ä½†å³ä½¿é‡æ–°æŠ•ç¥¨é€‰ä¸¾ï¼Œä¸¤ä¸ªèŠ‚ç‚¹æ‹¥æœ‰ç›¸åŒæŠ•ç¥¨æ•°çš„æ¦‚ç‡ä¹Ÿä¼šå¾ˆå¤§ã€‚å› æ­¤ï¼Œå¤šæ•°æ´¾é€‰ä¸»ç®—æ³•é€šå¸¸é‡‡ç”¨å¥‡æ•°èŠ‚ç‚¹ã€‚ è¿™ï¼Œä¹Ÿæ˜¯å¤§å®¶é€šå¸¸çœ‹åˆ° ZooKeeperã€ etcdã€Kubernetes ç­‰å¼€æºè½¯ä»¶é€‰ä¸»å‡é‡‡ç”¨å¥‡æ•°èŠ‚ç‚¹çš„ä¸€ä¸ªå…³é”®åŸå› ã€‚ åˆ†å¸ƒå¼å…±è¯†ä»æœ¬è´¨ä¸Šçœ‹ï¼Œåˆ†å¸ƒå¼é€‰ä¸¾é—®é¢˜ï¼Œå…¶å®å°±æ˜¯ä¼ ç»Ÿçš„åˆ†å¸ƒå¼å…±è¯†æ–¹æ³•ï¼Œä¸»è¦æ˜¯åŸºäºå¤šæ•°æŠ•ç¥¨ç­–ç•¥å®ç°çš„ã€‚åŸºäºå¤šæ•°æŠ•ç¥¨ç­–ç•¥çš„åˆ†å¸ƒå¼é€‰ä¸¾æ–¹æ³•ï¼Œå¦‚æœç”¨äºåˆ†å¸ƒå¼åœ¨çº¿è®°è´¦ä¸€è‡´æ€§é—®é¢˜ä¸­ï¼Œé‚£ä¹ˆè®°è´¦æƒé€šå¸¸ä¼šå®Œå…¨æŒæ¡åˆ°ä¸»èŠ‚ç‚¹çš„æ‰‹é‡Œï¼Œè¿™ä½¿å¾—ä¸»èŠ‚ç‚¹éå¸¸å®¹æ˜“é€ å‡ï¼Œä¸”å­˜åœ¨æ€§èƒ½ç“¶é¢ˆ åˆ†å¸ƒå¼å…±è¯†å°±æ˜¯åœ¨å¤šä¸ªèŠ‚ç‚¹å‡å¯ç‹¬è‡ªæ“ä½œæˆ–è®°å½•çš„æƒ…å†µä¸‹ï¼Œä½¿å¾—æ‰€æœ‰èŠ‚ç‚¹é’ˆå¯¹æŸä¸ªçŠ¶æ€è¾¾æˆä¸€è‡´çš„è¿‡ç¨‹ã€‚é€šè¿‡å…±è¯†æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿å¾—åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¤šä¸ªèŠ‚ç‚¹çš„æ•°æ®è¾¾æˆä¸€è‡´ã€‚ åˆ†å¸ƒå¼å…±è¯†æŠ€æœ¯ï¼Œå°±æ˜¯åŒºå—é“¾æŠ€æœ¯å…±è¯†æœºåˆ¶çš„æ ¸å¿ƒ çŸ¥è¯†æ‰©å±•ï¼šä¸€è‡´æ€§ä¸å…±è¯†çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¸€è‡´æ€§æ˜¯æŒ‡ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´ï¼Œç»™å®šä¸€ç³»åˆ—çš„æ“ä½œï¼Œåœ¨çº¦å®šåè®®çš„ä¿éšœä¸‹ï¼Œå¯¹å¤–ç•Œå‘ˆç°çš„æ•°æ®æˆ–çŠ¶æ€æ˜¯ä¸€è‡´çš„ã€‚ å…±è¯†æ˜¯æŒ‡ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´ï¼Œå½¼æ­¤å¯¹æŸä¸ªçŠ¶æ€è¾¾æˆä¸€è‡´ç»“æœçš„è¿‡ç¨‹ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€è‡´æ€§å¼ºè°ƒçš„æ˜¯ç»“æœï¼Œå…±è¯†å¼ºè°ƒçš„æ˜¯è¾¾æˆä¸€è‡´çš„è¿‡ç¨‹ï¼Œå…±è¯†ç®—æ³•æ˜¯ä¿éšœç³»ç»Ÿæ»¡è¶³ä¸åŒç¨‹åº¦ä¸€è‡´æ€§çš„æ ¸å¿ƒæŠ€æœ¯ã€‚ åˆ†å¸ƒå¼äº‹åŠ¡ åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå°±æ˜¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è¿è¡Œçš„äº‹åŠ¡ï¼Œç”±å¤šä¸ªæœ¬åœ°äº‹åŠ¡ç»„åˆè€Œæˆ ç”µå•†å¤„ç†è®¢å•é—®é¢˜ï¼Œå°±æ˜¯å…¸å‹çš„åˆ†å¸ƒå¼äº‹åŠ¡ è¦æ·±å…¥ç†è§£åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£å®ƒçš„ç‰¹å¾ã€‚åˆ†å¸ƒå¼äº‹åŠ¡æ˜¯å¤šä¸ªäº‹åŠ¡çš„ç»„åˆï¼Œé‚£ä¹ˆäº‹åŠ¡çš„ç‰¹å¾ ACIDï¼Œä¹Ÿæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡çš„åŸºæœ¬ç‰¹å¾ï¼Œå…¶ä¸­ ACID å…·ä½“å«ä¹‰å¦‚ä¸‹ åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼Œå³äº‹åŠ¡æœ€ç»ˆçš„çŠ¶æ€åªæœ‰ä¸¤ç§ï¼Œå…¨éƒ¨æ‰§è¡ŒæˆåŠŸå’Œå…¨éƒ¨ä¸æ‰§è¡Œã€‚è‹¥å¤„ç†äº‹åŠ¡çš„ä»»ä½•ä¸€é¡¹æ“ä½œä¸æˆåŠŸï¼Œå°±ä¼šå¯¼è‡´æ•´ä¸ªäº‹åŠ¡å¤±è´¥ã€‚ä¸€æ—¦æ“ä½œå¤±è´¥ï¼Œæ‰€æœ‰æ“ä½œéƒ½ä¼šè¢«å–æ¶ˆï¼ˆå³å›æ»šï¼‰ï¼Œä½¿å¾—äº‹åŠ¡ä»¿ä½›æ²¡æœ‰è¢«æ‰§è¡Œè¿‡ä¸€æ ·ã€‚ ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼Œæ˜¯æŒ‡äº‹åŠ¡æ“ä½œå‰å’Œæ“ä½œåï¼Œæ•°æ®çš„å®Œæ•´æ€§ä¿æŒä¸€è‡´æˆ–æ»¡è¶³å®Œæ•´æ€§çº¦æŸã€‚æ¯”å¦‚ï¼Œç”¨æˆ· A å’Œç”¨æˆ· B åœ¨é“¶è¡Œåˆ†åˆ«æœ‰ 800 å…ƒå’Œ 600 å…ƒï¼Œæ€»å…± 1400 å…ƒï¼Œç”¨æˆ· A ç»™ç”¨æˆ· B è½¬è´¦ 200 å…ƒï¼Œåˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼Œä» A çš„è´¦æˆ·æ‰£é™¤ 200 å…ƒå’Œå¯¹ B çš„è´¦æˆ·å¢åŠ  200 å…ƒ ; ä¸€è‡´æ€§å°±æ˜¯è¦æ±‚ä¸Šè¿°æ­¥éª¤æ“ä½œåï¼Œæœ€åçš„ç»“æœæ˜¯ç”¨æˆ· A è¿˜æœ‰ 600 å…ƒï¼Œç”¨æˆ· B æœ‰ 800 å…ƒï¼Œæ€»å…± 1400 å…ƒï¼Œè€Œä¸ä¼šå‡ºç°ç”¨æˆ· A æ‰£é™¤äº† 200 å…ƒï¼Œä½†ç”¨æˆ· B æœªå¢åŠ çš„æƒ…å†µ (è¯¥æƒ…å†µï¼Œç”¨æˆ· A å’Œ B å‡ä¸º 600 å…ƒï¼Œæ€»å…± 1200 å…ƒ)ã€‚ éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼Œæ˜¯æŒ‡å½“ç³»ç»Ÿå†…æœ‰å¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ï¼Œå¤šä¸ªäº‹åŠ¡ä¸ä¼šç›¸äº’å¹²æ‰°ï¼Œå³ä¸€ä¸ªäº‹åŠ¡å†…éƒ¨çš„æ“ä½œåŠä½¿ç”¨çš„æ•°æ®ï¼Œå¯¹å…¶ä»–å¹¶å‘äº‹åŠ¡æ˜¯éš”ç¦»çš„ã€‚ æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼Œä¹Ÿè¢«ç§°ä¸ºæ°¸ä¹…æ€§ï¼Œæ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡å®Œæˆäº†ï¼Œé‚£ä¹ˆå®ƒå¯¹æ•°æ®åº“æ‰€åšçš„æ›´æ–°å°±è¢«æ°¸ä¹…ä¿å­˜ä¸‹æ¥äº†ã€‚å³ä½¿å‘ç”Ÿç³»ç»Ÿå´©æºƒæˆ–å®•æœºç­‰æ•…éšœï¼Œåªè¦æ•°æ®åº“èƒ½å¤Ÿé‡æ–°è¢«è®¿é—®ï¼Œé‚£ä¹ˆä¸€å®šèƒ½å¤Ÿå°†å…¶æ¢å¤åˆ°äº‹åŠ¡å®Œæˆæ—¶çš„çŠ¶æ€ã€‚ å¦‚ä½•å®ç°åˆ†å¸ƒå¼äº‹åŠ¡å®ç°åˆ†å¸ƒå¼äº‹åŠ¡æœ‰ä»¥ä¸‹ 3 ç§åŸºæœ¬æ–¹æ³•ï¼š åŸºäº XA åè®®çš„äºŒé˜¶æ®µæäº¤åè®®æ–¹æ³• ä¸‰é˜¶æ®µæäº¤åè®®æ–¹æ³• åŸºäºæ¶ˆæ¯çš„æœ€ç»ˆä¸€è‡´æ€§æ–¹æ³• å…¶ä¸­ï¼ŒåŸºäº XA åè®®çš„äºŒé˜¶æ®µæäº¤åè®®æ–¹æ³•å’Œä¸‰é˜¶æ®µæäº¤åè®®æ–¹æ³•ï¼Œé‡‡ç”¨äº†å¼ºä¸€è‡´æ€§ï¼Œéµä» ACIDï¼ŒåŸºäºæ¶ˆæ¯çš„æœ€ç»ˆä¸€è‡´æ€§æ–¹æ³•ï¼Œé‡‡ç”¨äº†æœ€ç»ˆä¸€è‡´æ€§ï¼Œéµä» BASE ç†è®º åŸºäº XA åè®®çš„äºŒé˜¶æ®µæäº¤æ–¹æ³•XA æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡åè®®ï¼Œè§„å®šäº†äº‹åŠ¡ç®¡ç†å™¨å’Œèµ„æºç®¡ç†å™¨æ¥å£ã€‚å› æ­¤ï¼ŒXA åè®®å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå³äº‹åŠ¡ç®¡ç†å™¨å’Œæœ¬åœ°èµ„æºç®¡ç†å™¨ã€‚ XA å®ç°åˆ†å¸ƒå¼äº‹åŠ¡çš„åŸç†ï¼Œå°±ç±»ä¼¼äºæˆ‘åœ¨ç¬¬ 3 ç¯‡æ–‡ç« ä¸­ä¸ä½ ä»‹ç»çš„é›†ä¸­å¼ç®—æ³•ï¼šäº‹åŠ¡ç®¡ç†å™¨ä½œä¸ºåè°ƒè€…ï¼Œè´Ÿè´£å„ä¸ªæœ¬åœ°èµ„æºçš„æäº¤å’Œå›æ»šï¼›è€Œèµ„æºç®¡ç†å™¨å°±æ˜¯åˆ†å¸ƒå¼äº‹åŠ¡çš„å‚ä¸è€…ï¼Œé€šå¸¸ç”±æ•°æ®åº“å®ç°ï¼Œæ¯”å¦‚ Oracleã€DB2 ç­‰å•†ä¸šæ•°æ®åº“éƒ½å®ç°äº† XA æ¥å£ã€‚ åŸºäº XA åè®®çš„äºŒé˜¶æ®µæäº¤æ–¹æ³•ä¸­ï¼ŒäºŒé˜¶æ®µæäº¤åè®®ï¼ˆThe two-phase commit protocolï¼Œ2PCï¼‰ï¼Œç”¨äºä¿è¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­äº‹åŠ¡æäº¤æ—¶çš„æ•°æ®ä¸€è‡´æ€§ï¼Œæ˜¯ XA åœ¨å…¨å±€äº‹åŠ¡ä¸­ç”¨äºåè°ƒå¤šä¸ªèµ„æºçš„æœºåˆ¶ã€‚ ä¸ºäº†ä¿è¯å®ƒä»¬çš„ä¸€è‡´æ€§ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªåè°ƒè€…æ¥ç®¡ç†æ‰€æœ‰çš„èŠ‚ç‚¹ï¼Œå¹¶ç¡®ä¿è¿™äº›èŠ‚ç‚¹æ­£ç¡®æäº¤æ“ä½œç»“æœï¼Œè‹¥æäº¤å¤±è´¥åˆ™æ”¾å¼ƒäº‹åŠ¡ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹ä¸¤é˜¶æ®µæäº¤åè®®çš„å…·ä½“è¿‡ç¨‹ã€‚ ä¸¤é˜¶æ®µæäº¤åè®®çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œåˆ†ä¸ºæŠ•ç¥¨ï¼ˆvotingï¼‰å’Œæäº¤ï¼ˆcommitï¼‰ä¸¤ä¸ªé˜¶æ®µã€‚ æŠ•ç¥¨ä¸ºç¬¬ä¸€é˜¶æ®µï¼Œåè°ƒè€…ï¼ˆCoordinatorï¼Œå³äº‹åŠ¡ç®¡ç†å™¨ï¼‰ä¼šå‘äº‹åŠ¡çš„å‚ä¸è€…ï¼ˆCohortï¼Œå³æœ¬åœ°èµ„æºç®¡ç†å™¨ï¼‰å‘èµ·æ‰§è¡Œæ“ä½œçš„ CanCommit è¯·æ±‚ï¼Œå¹¶ç­‰å¾…å‚ä¸è€…çš„å“åº”ã€‚å‚ä¸è€…æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šæ‰§è¡Œè¯·æ±‚ä¸­çš„äº‹åŠ¡æ“ä½œï¼Œè®°å½•æ—¥å¿—ä¿¡æ¯ä½†ä¸æäº¤ï¼Œå¾…å‚ä¸è€…æ‰§è¡ŒæˆåŠŸï¼Œåˆ™å‘åè°ƒè€…å‘é€â€œYesâ€æ¶ˆæ¯ï¼Œè¡¨ç¤ºåŒæ„æ“ä½œï¼›è‹¥ä¸æˆåŠŸï¼Œåˆ™å‘é€â€œNoâ€æ¶ˆæ¯ï¼Œè¡¨ç¤ºç»ˆæ­¢æ“ä½œã€‚ å½“æ‰€æœ‰çš„å‚ä¸è€…éƒ½è¿”å›äº†æ“ä½œç»“æœï¼ˆYes æˆ– No æ¶ˆæ¯ï¼‰åï¼Œç³»ç»Ÿè¿›å…¥äº†æäº¤é˜¶æ®µã€‚åœ¨æäº¤é˜¶æ®µï¼Œåè°ƒè€…ä¼šæ ¹æ®æ‰€æœ‰å‚ä¸è€…è¿”å›çš„ä¿¡æ¯å‘å‚ä¸è€…å‘é€ DoCommit æˆ– DoAbort æŒ‡ä»¤ï¼š è‹¥åè°ƒè€…æ”¶åˆ°çš„éƒ½æ˜¯â€œYesâ€æ¶ˆæ¯ï¼Œåˆ™å‘å‚ä¸è€…å‘é€â€œDoCommitâ€æ¶ˆæ¯ï¼Œå‚ä¸è€…ä¼šå®Œæˆå‰©ä½™çš„æ“ä½œå¹¶é‡Šæ”¾èµ„æºï¼Œç„¶åå‘åè°ƒè€…è¿”å›â€œHaveCommittedâ€æ¶ˆæ¯ï¼› å¦‚æœåè°ƒè€…æ”¶åˆ°çš„æ¶ˆæ¯ä¸­åŒ…å«â€œNoâ€æ¶ˆæ¯ï¼Œåˆ™å‘æ‰€æœ‰å‚ä¸è€…å‘é€â€œDoAbortâ€æ¶ˆæ¯ï¼Œæ­¤æ—¶å‘é€â€œYesâ€çš„å‚ä¸è€…åˆ™ä¼šæ ¹æ®ä¹‹å‰æ‰§è¡Œæ“ä½œæ—¶çš„å›æ»šæ—¥å¿—å¯¹æ“ä½œè¿›è¡Œå›æ»šï¼Œç„¶åæ‰€æœ‰å‚ä¸è€…ä¼šå‘åè°ƒè€…å‘é€â€œHaveCommittedâ€æ¶ˆæ¯ï¼› åè°ƒè€…æ¥æ”¶åˆ°â€œHaveCommittedâ€æ¶ˆæ¯ï¼Œå°±æ„å‘³ç€æ•´ä¸ªäº‹åŠ¡ç»“æŸäº† å¿…é¡»ä¿è¯å¯¹äºå•ä¸ªæœºå™¨çš„å›æ»šæ“ä½œæ˜¯å¯ä»¥å®ç°çš„æ— æ•…éšœçš„ äºŒé˜¶æ®µæäº¤çš„ç®—æ³•æ€è·¯å¯ä»¥æ¦‚æ‹¬ä¸ºï¼šåè°ƒè€…ä¸‹å‘è¯·æ±‚äº‹åŠ¡æ“ä½œï¼Œå‚ä¸è€…å°†æ“ä½œç»“æœé€šçŸ¥åè°ƒè€…ï¼Œåè°ƒè€…æ ¹æ®æ‰€æœ‰å‚ä¸è€…çš„åé¦ˆç»“æœå†³å®šå„å‚ä¸è€…æ˜¯è¦æäº¤æ“ä½œè¿˜æ˜¯æ’¤é”€æ“ä½œã€‚ è™½ç„¶åŸºäº XA çš„äºŒé˜¶æ®µæäº¤ç®—æ³•åŸºæœ¬æ»¡è¶³äº†äº‹åŠ¡çš„ ACID ç‰¹æ€§ï¼Œä½†ä¾ç„¶æœ‰äº›ä¸è¶³ åŒæ­¥é˜»å¡é—®é¢˜ï¼šäºŒé˜¶æ®µæäº¤ç®—æ³•åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰å‚ä¸èŠ‚ç‚¹éƒ½æ˜¯äº‹åŠ¡é˜»å¡å‹çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æœ¬åœ°èµ„æºç®¡ç†å™¨å æœ‰ä¸´ç•Œèµ„æºæ—¶ï¼Œå…¶ä»–èµ„æºç®¡ç†å™¨å¦‚æœè¦è®¿é—®åŒä¸€ä¸´ç•Œèµ„æºï¼Œä¼šå¤„äºé˜»å¡çŠ¶æ€ã€‚ å•ç‚¹æ•…éšœé—®é¢˜ï¼šåŸºäº XA çš„äºŒé˜¶æ®µæäº¤ç®—æ³•ç±»ä¼¼äºé›†ä¸­å¼ç®—æ³•ï¼Œä¸€æ—¦äº‹åŠ¡ç®¡ç†å™¨å‘ç”Ÿæ•…éšœï¼Œæ•´ä¸ªç³»ç»Ÿéƒ½å¤„äºåœæ»çŠ¶æ€ã€‚å°¤å…¶æ˜¯åœ¨æäº¤é˜¶æ®µï¼Œä¸€æ—¦äº‹åŠ¡ç®¡ç†å™¨å‘ç”Ÿæ•…éšœï¼Œèµ„æºç®¡ç†å™¨ä¼šç”±äºç­‰å¾…ç®¡ç†å™¨çš„æ¶ˆæ¯ï¼Œè€Œä¸€ç›´é”å®šäº‹åŠ¡èµ„æºï¼Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿè¢«é˜»å¡ã€‚ æ•°æ®ä¸ä¸€è‡´é—®é¢˜ï¼šåœ¨æäº¤é˜¶æ®µï¼Œå½“åè°ƒè€…å‘å‚ä¸è€…å‘é€ DoCommit è¯·æ±‚ä¹‹åï¼Œå¦‚æœå‘ç”Ÿäº†å±€éƒ¨ç½‘ç»œå¼‚å¸¸ï¼Œæˆ–è€…åœ¨å‘é€æäº¤è¯·æ±‚çš„è¿‡ç¨‹ä¸­åè°ƒè€…å‘ç”Ÿäº†æ•…éšœï¼Œå°±ä¼šå¯¼è‡´åªæœ‰ä¸€éƒ¨åˆ†å‚ä¸è€…æ¥æ”¶åˆ°äº†æäº¤è¯·æ±‚å¹¶æ‰§è¡Œæäº¤æ“ä½œï¼Œä½†å…¶ä»–æœªæ¥åˆ°æäº¤è¯·æ±‚çš„é‚£éƒ¨åˆ†å‚ä¸è€…åˆ™æ— æ³•æ‰§è¡Œäº‹åŠ¡æäº¤ã€‚äºæ˜¯æ•´ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¾¿å‡ºç°äº†æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚ ä¸‰é˜¶æ®µæäº¤æ–¹æ³•ä¸‰é˜¶æ®µæäº¤åè®®ï¼ˆThree-phase commit protocolï¼Œ3PCï¼‰ï¼Œæ˜¯å¯¹äºŒé˜¶æ®µæäº¤ï¼ˆ2PCï¼‰çš„æ”¹è¿›ã€‚ä¸ºäº†è§£å†³ä¸¤é˜¶æ®µæäº¤çš„åŒæ­¥é˜»å¡å’Œæ•°æ®ä¸ä¸€è‡´é—®é¢˜ï¼Œä¸‰é˜¶æ®µæäº¤å¼•å…¥äº†è¶…æ—¶æœºåˆ¶å’Œå‡†å¤‡é˜¶æ®µã€‚ åŒæ—¶åœ¨åè°ƒè€…å’Œå‚ä¸è€…ä¸­å¼•å…¥è¶…æ—¶æœºåˆ¶ã€‚å¦‚æœåè°ƒè€…æˆ–å‚ä¸è€…åœ¨è§„å®šçš„æ—¶é—´å†…æ²¡æœ‰æ¥æ”¶åˆ°æ¥è‡ªå…¶ä»–èŠ‚ç‚¹çš„å“åº”ï¼Œå°±ä¼šæ ¹æ®å½“å‰çš„çŠ¶æ€é€‰æ‹©æäº¤æˆ–è€…ç»ˆæ­¢æ•´ä¸ªäº‹åŠ¡ã€‚ åœ¨ç¬¬ä¸€é˜¶æ®µå’Œç¬¬äºŒé˜¶æ®µä¸­é—´å¼•å…¥äº†ä¸€ä¸ªå‡†å¤‡é˜¶æ®µï¼Œä¹Ÿå°±æ˜¯åœ¨æäº¤é˜¶æ®µä¹‹å‰ï¼ŒåŠ å…¥äº†ä¸€ä¸ªé¢„æäº¤é˜¶æ®µã€‚åœ¨é¢„æäº¤é˜¶æ®µæ’é™¤ä¸€äº›ä¸ä¸€è‡´çš„æƒ…å†µï¼Œä¿è¯åœ¨æœ€åæäº¤ä¹‹å‰å„å‚ä¸èŠ‚ç‚¹çš„çŠ¶æ€æ˜¯ä¸€è‡´çš„ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤äº†å¼•å…¥è¶…æ—¶æœºåˆ¶ä¹‹å¤–ï¼Œ3PC æŠŠ 2PC çš„æäº¤é˜¶æ®µä¸€åˆ†ä¸ºäºŒï¼Œè¿™æ ·ä¸‰é˜¶æ®µæäº¤åè®®å°±æœ‰ CanCommitã€PreCommitã€DoCommit ä¸‰ä¸ªé˜¶æ®µã€‚ ç¬¬ä¸€ï¼ŒCanCommit é˜¶æ®µã€‚CanCommit é˜¶æ®µä¸ 2PC çš„æŠ•ç¥¨é˜¶æ®µç±»ä¼¼ï¼šåè°ƒè€…å‘å‚ä¸è€…å‘é€è¯·æ±‚æ“ä½œï¼ˆCanCommit è¯·æ±‚ï¼‰ï¼Œè¯¢é—®å‚ä¸è€…æ˜¯å¦å¯ä»¥æ‰§è¡Œäº‹åŠ¡æäº¤æ“ä½œï¼Œç„¶åç­‰å¾…å‚ä¸è€…çš„å“åº”ï¼›å‚ä¸è€…æ”¶åˆ° CanCommit è¯·æ±‚ä¹‹åï¼Œå›å¤ Yesï¼Œè¡¨ç¤ºå¯ä»¥é¡ºåˆ©æ‰§è¡Œäº‹åŠ¡ï¼›å¦åˆ™å›å¤ Noã€‚CanCommit é˜¶æ®µä¸åŒèŠ‚ç‚¹ä¹‹é—´çš„äº‹åŠ¡è¯·æ±‚æˆåŠŸå’Œå¤±è´¥çš„æµç¨‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ ç¬¬äºŒï¼ŒPreCommit é˜¶æ®µã€‚åè°ƒè€…æ ¹æ®å‚ä¸è€…çš„å›å¤æƒ…å†µï¼Œæ¥å†³å®šæ˜¯å¦å¯ä»¥è¿›è¡Œ PreCommit æ“ä½œã€‚ å¦‚æœæ‰€æœ‰å‚ä¸è€…å›å¤çš„éƒ½æ˜¯â€œYesâ€ï¼Œé‚£ä¹ˆåè°ƒè€…å°±ä¼šæ‰§è¡Œäº‹åŠ¡çš„é¢„æ‰§è¡Œï¼š å‘é€é¢„æäº¤è¯·æ±‚ã€‚åè°ƒè€…å‘å‚ä¸è€…å‘é€ PreCommit è¯·æ±‚ï¼Œè¿›å…¥é¢„æäº¤é˜¶æ®µã€‚ äº‹åŠ¡é¢„æäº¤ã€‚å‚ä¸è€…æ¥æ”¶åˆ° PreCommit è¯·æ±‚åæ‰§è¡Œäº‹åŠ¡æ“ä½œï¼Œå¹¶å°† Undo å’Œ Redo ä¿¡æ¯è®°å½•åˆ°äº‹åŠ¡æ—¥å¿—ä¸­ã€‚ å“åº”åé¦ˆã€‚å¦‚æœå‚ä¸è€…æˆåŠŸæ‰§è¡Œäº†äº‹åŠ¡æ“ä½œï¼Œåˆ™è¿”å› ACK å“åº”ï¼ŒåŒæ—¶å¼€å§‹ç­‰å¾…æœ€ç»ˆæŒ‡ä»¤ã€‚ å‡å¦‚ä»»ä½•ä¸€ä¸ªå‚ä¸è€…å‘åè°ƒè€…å‘é€äº†â€œNoâ€æ¶ˆæ¯ï¼Œæˆ–è€…ç­‰å¾…è¶…æ—¶ä¹‹åï¼Œåè°ƒè€…éƒ½æ²¡æœ‰æ”¶åˆ°å‚ä¸è€…çš„å“åº”ï¼Œå°±æ‰§è¡Œä¸­æ–­äº‹åŠ¡çš„æ“ä½œï¼š å‘é€ä¸­æ–­è¯·æ±‚ã€‚åè°ƒè€…å‘æ‰€æœ‰å‚ä¸è€…å‘é€â€œAbortâ€æ¶ˆæ¯ã€‚ ä¸­æ–­äº‹åŠ¡ã€‚å‚ä¸è€…æ”¶åˆ°â€œAbortâ€æ¶ˆæ¯ä¹‹åï¼Œæˆ–è¶…æ—¶åä»æœªæ”¶åˆ°åè°ƒè€…çš„æ¶ˆæ¯ï¼Œæ‰§è¡Œäº‹åŠ¡çš„ä¸­æ–­æ“ä½œã€‚ ç¬¬ä¸‰ï¼ŒDoCommit é˜¶æ®µã€‚DoCmmit é˜¶æ®µè¿›è¡ŒçœŸæ­£çš„äº‹åŠ¡æäº¤ï¼Œæ ¹æ® PreCommit é˜¶æ®µåè°ƒè€…å‘é€çš„æ¶ˆæ¯ï¼Œè¿›å…¥æ‰§è¡Œæäº¤é˜¶æ®µæˆ–äº‹åŠ¡ä¸­æ–­é˜¶æ®µã€‚ æ‰§è¡Œæäº¤é˜¶æ®µï¼š å‘é€æäº¤è¯·æ±‚ã€‚åè°ƒè€…æ¥æ”¶åˆ°æ‰€æœ‰å‚ä¸è€…å‘é€çš„ Ack å“åº”ï¼Œä»é¢„æäº¤çŠ¶æ€è¿›å…¥åˆ°æäº¤çŠ¶æ€ï¼Œå¹¶å‘æ‰€æœ‰å‚ä¸è€…å‘é€ DoCommit æ¶ˆæ¯ã€‚ äº‹åŠ¡æäº¤ã€‚å‚ä¸è€…æ¥æ”¶åˆ° DoCommit æ¶ˆæ¯ä¹‹åï¼Œæ­£å¼æäº¤äº‹åŠ¡ã€‚å®Œæˆäº‹åŠ¡æäº¤ä¹‹åï¼Œé‡Šæ”¾æ‰€æœ‰é”ä½çš„èµ„æºã€‚ å“åº”åé¦ˆã€‚å‚ä¸è€…æäº¤å®Œäº‹åŠ¡ä¹‹åï¼Œå‘åè°ƒè€…å‘é€ Ack å“åº”ã€‚ å®Œæˆäº‹åŠ¡ã€‚åè°ƒè€…æ¥æ”¶åˆ°æ‰€æœ‰å‚ä¸è€…çš„ Ack å“åº”ä¹‹åï¼Œå®Œæˆäº‹åŠ¡ã€‚ äº‹åŠ¡ä¸­æ–­é˜¶æ®µï¼š å‘é€ä¸­æ–­è¯·æ±‚ã€‚åè°ƒè€…å‘æ‰€æœ‰å‚ä¸è€…å‘é€ Abort è¯·æ±‚ã€‚ äº‹åŠ¡å›æ»šã€‚å‚ä¸è€…æ¥æ”¶åˆ° Abort æ¶ˆæ¯ä¹‹åï¼Œåˆ©ç”¨å…¶åœ¨ PreCommit é˜¶æ®µè®°å½•çš„ Undo ä¿¡æ¯æ‰§è¡Œäº‹åŠ¡çš„å›æ»šæ“ä½œï¼Œå¹¶é‡Šæ”¾æ‰€æœ‰é”ä½çš„èµ„æºã€‚ åé¦ˆç»“æœã€‚å‚ä¸è€…å®Œæˆäº‹åŠ¡å›æ»šä¹‹åï¼Œå‘åè°ƒè€…å‘é€ Ack æ¶ˆæ¯ã€‚ ä¸­æ–­äº‹åŠ¡ã€‚åè°ƒè€…æ¥æ”¶åˆ°å‚ä¸è€…åé¦ˆçš„ Ack æ¶ˆæ¯ä¹‹åï¼Œæ‰§è¡Œäº‹åŠ¡çš„ä¸­æ–­ï¼Œå¹¶ç»“æŸäº‹åŠ¡ã€‚ æ‰§è¡Œé˜¶æ®µä¸åŒèŠ‚ç‚¹ä¸Šäº‹åŠ¡æ‰§è¡ŒæˆåŠŸå’Œå¤±è´¥ (äº‹åŠ¡ä¸­æ–­) çš„æµç¨‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ åœ¨ DoCommit é˜¶æ®µï¼Œå½“å‚ä¸è€…å‘åè°ƒè€…å‘é€ Ack æ¶ˆæ¯åï¼Œå¦‚æœé•¿æ—¶é—´æ²¡æœ‰å¾—åˆ°åè°ƒè€…çš„å“åº”ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå‚ä¸è€…ä¼šè‡ªåŠ¨å°†è¶…æ—¶çš„äº‹åŠ¡è¿›è¡Œæäº¤ï¼Œä¸ä¼šåƒä¸¤é˜¶æ®µæäº¤é‚£æ ·è¢«é˜»å¡ä½ã€‚ åŸºäºåˆ†å¸ƒå¼æ¶ˆæ¯çš„æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆ2PC å’Œ 3PC è¿™ä¸¤ç§æ–¹æ³•ï¼Œæœ‰ä¸¤ä¸ªå…±åŒçš„ç¼ºç‚¹ï¼Œä¸€æ˜¯éƒ½éœ€è¦é”å®šèµ„æºï¼Œé™ä½ç³»ç»Ÿæ€§èƒ½ï¼›äºŒæ˜¯ï¼Œæ²¡æœ‰è§£å†³æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚å› æ­¤ï¼Œä¾¿æœ‰äº†é€šè¿‡åˆ†å¸ƒå¼æ¶ˆæ¯æ¥ç¡®ä¿äº‹åŠ¡æœ€ç»ˆä¸€è‡´æ€§çš„æ–¹æ¡ˆã€‚ åœ¨ eBay çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„ä¸­ï¼Œæ¶æ„å¸ˆè§£å†³ä¸€è‡´æ€§é—®é¢˜çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ï¼šå°†éœ€è¦åˆ†å¸ƒå¼å¤„ç†çš„äº‹åŠ¡é€šè¿‡æ¶ˆæ¯æˆ–è€…æ—¥å¿—çš„æ–¹å¼å¼‚æ­¥æ‰§è¡Œï¼Œæ¶ˆæ¯æˆ–æ—¥å¿—å¯ä»¥å­˜åˆ°æœ¬åœ°æ–‡ä»¶ã€æ•°æ®åº“æˆ–æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œå†é€šè¿‡ä¸šåŠ¡è§„åˆ™è¿›è¡Œå¤±è´¥é‡è¯•ã€‚è¿™ä¸ªæ¡ˆä¾‹ï¼Œå°±æ˜¯ä½¿ç”¨åŸºäºåˆ†å¸ƒå¼æ¶ˆæ¯çš„æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆè§£å†³äº†åˆ†å¸ƒå¼äº‹åŠ¡çš„é—®é¢˜ã€‚ åŸºäºåˆ†å¸ƒå¼æ¶ˆæ¯çš„æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆçš„äº‹åŠ¡å¤„ç†ï¼Œå¼•å…¥äº†ä¸€ä¸ªæ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆMessage Queueï¼ŒMQï¼‰ï¼Œç”¨äºåœ¨å¤šä¸ªåº”ç”¨ä¹‹é—´è¿›è¡Œæ¶ˆæ¯ä¼ é€’ã€‚åŸºäºæ¶ˆæ¯ä¸­é—´ä»¶åå•†å¤šä¸ªèŠ‚ç‚¹åˆ†å¸ƒå¼äº‹åŠ¡æ‰§è¡Œæ“ä½œçš„ç¤ºæ„å›¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ åˆšæ€§äº‹åŠ¡ä¸æŸ”æ€§äº‹åŠ¡åœ¨è®¨è®ºäº‹åŠ¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæåˆ°åˆšæ€§äº‹åŠ¡ä¸æŸ”æ€§äº‹åŠ¡ï¼Œä½†å´å¾ˆéš¾åŒºåˆ†è¿™ä¸¤ç§äº‹åŠ¡ã€‚æ‰€ä»¥ï¼Œä»Šå¤©çš„çŸ¥è¯†æ‰©å±•å†…å®¹ï¼Œæˆ‘å°±æ¥å’Œä½ è¯´è¯´ä»€ä¹ˆæ˜¯åˆšæ€§äº‹åŠ¡ã€æŸ”æ€§äº‹åŠ¡ï¼Œä»¥åŠä¸¤è€…ä¹‹é—´æœ‰ä½•åŒºåˆ«ï¼Ÿ åˆšæ€§äº‹åŠ¡ï¼Œéµå¾ª ACID åŸåˆ™ï¼Œå…·æœ‰å¼ºä¸€è‡´æ€§ã€‚æ¯”å¦‚ï¼Œæ•°æ®åº“äº‹åŠ¡ã€‚ æŸ”æ€§äº‹åŠ¡ï¼Œå…¶å®å°±æ˜¯æ ¹æ®ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ä½¿ç”¨ä¸åŒçš„æ–¹æ³•å®ç°æœ€ç»ˆä¸€è‡´æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸šåŠ¡çš„ç‰¹æ€§åšéƒ¨åˆ†å–èˆï¼Œå®¹å¿ä¸€å®šæ—¶é—´å†…çš„æ•°æ®ä¸ä¸€è‡´ã€‚ æ€»ç»“æ¥è®²ï¼Œä¸åˆšæ€§äº‹åŠ¡ä¸åŒï¼ŒæŸ”æ€§äº‹åŠ¡å…è®¸ä¸€å®šæ—¶é—´å†…ï¼Œä¸åŒèŠ‚ç‚¹çš„æ•°æ®ä¸ä¸€è‡´ï¼Œä½†è¦æ±‚æœ€ç»ˆä¸€è‡´ã€‚è€ŒæŸ”æ€§äº‹åŠ¡çš„æœ€ç»ˆä¸€è‡´æ€§ï¼Œéµå¾ªçš„æ˜¯ BASE ç†è®ºã€‚ BASE ç†è®ºBASE ç†è®ºåŒ…æ‹¬åŸºæœ¬å¯ç”¨ï¼ˆBasically Availableï¼‰ã€æŸ”æ€§çŠ¶æ€ï¼ˆSoft Stateï¼‰å’Œæœ€ç»ˆä¸€è‡´æ€§ï¼ˆEventual Consistencyï¼‰ã€‚ åŸºæœ¬å¯ç”¨ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿå‡ºç°æ•…éšœçš„æ—¶å€™ï¼Œå…è®¸æŸå¤±ä¸€éƒ¨åˆ†åŠŸèƒ½çš„å¯ç”¨æ€§ã€‚æ¯”å¦‚ï¼ŒæŸäº›ç”µå•† 618 å¤§ä¿ƒçš„æ—¶å€™ï¼Œä¼šå¯¹ä¸€äº›éæ ¸å¿ƒé“¾è·¯çš„åŠŸèƒ½è¿›è¡Œé™çº§å¤„ç†ã€‚ æŸ”æ€§çŠ¶æ€ï¼šåœ¨æŸ”æ€§äº‹åŠ¡ä¸­ï¼Œå…è®¸ç³»ç»Ÿå­˜åœ¨ä¸­é—´çŠ¶æ€ï¼Œä¸”è¿™ä¸ªä¸­é—´çŠ¶æ€ä¸ä¼šå½±å“ç³»ç»Ÿæ•´ä½“å¯ç”¨æ€§ã€‚æ¯”å¦‚ï¼Œæ•°æ®åº“è¯»å†™åˆ†ç¦»ï¼Œå†™åº“åŒæ­¥åˆ°è¯»åº“ï¼ˆä¸»åº“åŒæ­¥åˆ°ä»åº“ï¼‰ä¼šæœ‰ä¸€ä¸ªå»¶æ—¶ï¼Œå…¶å®å°±æ˜¯ä¸€ç§æŸ”æ€§çŠ¶æ€ã€‚ æœ€ç»ˆä¸€è‡´æ€§ï¼šäº‹åŠ¡åœ¨æ“ä½œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šç”±äºåŒæ­¥å»¶è¿Ÿç­‰é—®é¢˜å¯¼è‡´ä¸ä¸€è‡´ï¼Œä½†æœ€ç»ˆçŠ¶æ€ä¸‹ï¼Œæ•°æ®éƒ½æ˜¯ä¸€è‡´çš„ã€‚ å¯è§ï¼ŒBASE ç†è®ºä¸ºäº†æ”¯æŒå¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œé€šè¿‡ç‰ºç‰²å¼ºä¸€è‡´æ€§ï¼Œä¿è¯æœ€ç»ˆä¸€è‡´æ€§ï¼Œæ¥è·å¾—é«˜å¯ç”¨æ€§ï¼Œæ˜¯å¯¹ ACID åŸåˆ™çš„å¼±åŒ–ã€‚å…·ä½“åˆ°ä»Šå¤©çš„ä¸‰ç§åˆ†å¸ƒå¼äº‹åŠ¡å®ç°æ–¹å¼ï¼ŒäºŒé˜¶æ®µæäº¤ã€ä¸‰é˜¶æ®µæäº¤æ–¹æ³•ï¼Œéµå¾ªçš„æ˜¯ ACID åŸåˆ™ï¼Œè€Œæ¶ˆæ¯æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆéµå¾ªçš„å°±æ˜¯ BASE ç†è®ºã€‚ åˆ†å¸ƒå¼é”é”æ˜¯å®ç°å¤šçº¿ç¨‹åŒæ—¶è®¿é—®åŒä¸€å…±äº«èµ„æºï¼Œä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯è®¿é—®å…±äº«èµ„æºæ‰€åšçš„ä¸€ç§æ ‡è®° ä¸æ™®é€šé”ä¸åŒçš„æ˜¯ï¼Œåˆ†å¸ƒå¼é”æ˜¯æŒ‡åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œç³»ç»Ÿéƒ¨ç½²åœ¨å¤šä¸ªæœºå™¨ä¸­ï¼Œå®ç°å¤šè¿›ç¨‹åˆ†å¸ƒå¼äº’æ–¥çš„ä¸€ç§é”ã€‚ä¸ºäº†ä¿è¯å¤šä¸ªè¿›ç¨‹èƒ½çœ‹åˆ°é”ï¼Œé”è¢«å­˜åœ¨å…¬å…±å­˜å‚¨ï¼ˆæ¯”å¦‚ Redisã€Memcacheã€æ•°æ®åº“ç­‰ä¸‰æ–¹å­˜å‚¨ä¸­ï¼‰ï¼Œä»¥å®ç°å¤šä¸ªè¿›ç¨‹å¹¶å‘è®¿é—®åŒä¸€ä¸ªä¸´ç•Œèµ„æºï¼ŒåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯è®¿é—®å…±äº«èµ„æºï¼Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ã€‚ åˆ†å¸ƒå¼é”çš„ä¸‰ç§å®ç°æ–¹æ³•åŠå¯¹æ¯”æ¥ä¸‹æ¥ï¼Œæˆ‘å¸¦ä½ çœ‹çœ‹å®ç°åˆ†å¸ƒå¼é”çš„ 3 ç§ä¸»æµæ–¹æ³•ï¼Œå³ï¼š åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”ï¼Œè¿™é‡Œçš„æ•°æ®åº“æŒ‡çš„æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼› åŸºäºç¼“å­˜å®ç°åˆ†å¸ƒå¼é”ï¼› åŸºäº ZooKeeper å®ç°åˆ†å¸ƒå¼é”ã€‚ åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”å½“æˆ‘ä»¬è¦é”ä½æŸä¸ªèµ„æºæ—¶ï¼Œå°±åœ¨è¯¥è¡¨ä¸­å¢åŠ ä¸€æ¡è®°å½•ï¼Œæƒ³è¦é‡Šæ”¾é”çš„æ—¶å€™å°±åˆ é™¤è¿™æ¡è®°å½•ã€‚ åŸºäºæ•°æ®åº“å®ç°çš„åˆ†å¸ƒå¼é”ï¼Œæ˜¯æœ€å®¹æ˜“ç†è§£çš„ã€‚ä½†æ˜¯ï¼Œå› ä¸ºæ•°æ®åº“éœ€è¦è½åˆ°ç¡¬ç›˜ä¸Šï¼Œé¢‘ç¹è¯»å–æ•°æ®åº“ä¼šå¯¼è‡´ IO å¼€é”€å¤§ï¼Œå› æ­¤è¿™ç§åˆ†å¸ƒå¼é”é€‚ç”¨äºå¹¶å‘é‡ä½ï¼Œå¯¹æ€§èƒ½è¦æ±‚ä½çš„åœºæ™¯ã€‚ åŸºäºæ•°æ®åº“å®ç°çš„åˆ†å¸ƒå¼é”æ¯”è¾ƒç®€æ˜“ï¼Œç»æ‹›åœ¨äºåˆ›å»ºä¸€å¼ é”è¡¨ï¼Œä¸ºç”³è¯·è€…åœ¨é”è¡¨é‡Œå»ºç«‹ä¸€æ¡è®°å½•ï¼Œè®°å½•å»ºç«‹æˆåŠŸåˆ™è·å¾—é”ï¼Œæ¶ˆé™¤è®°å½•åˆ™é‡Šæ”¾é”ã€‚è¯¥æ–¹æ³•ä¾èµ–äºæ•°æ®åº“ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼š å•ç‚¹æ•…éšœé—®é¢˜ã€‚ä¸€æ—¦æ•°æ®åº“ä¸å¯ç”¨ï¼Œä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿå´©æºƒã€‚ æ­»é”é—®é¢˜ã€‚æ•°æ®åº“ä¸­çš„æ•°æ®æ²¡æœ‰å¤±æ•ˆæ—¶é—´ï¼Œè·å–äº†é”çš„æœåŠ¡å¦‚æœå´©æºƒäº† , æ²¡æœ‰ä¿®æ”¹æ•°æ®åº“è¡¨ä¸­çš„ä¿¡æ¯å°†ä¼šå¯¼è‡´å¼‚å¸¸ -> å¯ä»¥ä½¿ç”¨è¶…æ—¶æ—¶é—´è¿›è¡Œåˆ¤æ–­ åŸºäºç¼“å­˜å®ç°åˆ†å¸ƒå¼é”Redis é€šå¸¸å¯ä»¥ä½¿ç”¨ setnx(key, value) å‡½æ•°æ¥å®ç°åˆ†å¸ƒå¼é”ã€‚key å’Œ value å°±æ˜¯åŸºäºç¼“å­˜çš„åˆ†å¸ƒå¼é”çš„ä¸¤ä¸ªå±æ€§ï¼Œå…¶ä¸­ key è¡¨ç¤ºé” idï¼Œvalue &#x3D; currentTime + timeOutï¼Œè¡¨ç¤ºå½“å‰æ—¶é—´ + è¶…æ—¶æ—¶é—´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŸä¸ªè¿›ç¨‹è·å¾— key è¿™æŠŠé”åï¼Œå¦‚æœåœ¨ value çš„æ—¶é—´å†…æœªé‡Šæ”¾é”ï¼Œç³»ç»Ÿå°±ä¼šä¸»åŠ¨é‡Šæ”¾é”ã€‚ setnx å‡½æ•°çš„è¿”å›å€¼æœ‰ 0 å’Œ 1ï¼š è¿”å› 1ï¼Œè¯´æ˜è¯¥æœåŠ¡å™¨è·å¾—é”ï¼Œsetnx å°† key å¯¹åº”çš„ value è®¾ç½®ä¸ºå½“å‰æ—¶é—´ + é”çš„æœ‰æ•ˆæ—¶é—´ã€‚ è¿”å› 0ï¼Œè¯´æ˜å…¶ä»–æœåŠ¡å™¨å·²ç»è·å¾—äº†é”ï¼Œè¿›ç¨‹ä¸èƒ½è¿›å…¥ä¸´ç•ŒåŒºã€‚è¯¥æœåŠ¡å™¨å¯ä»¥ä¸æ–­å°è¯• setnx æ“ä½œï¼Œä»¥è·å¾—é”ã€‚ ç›¸å¯¹äºåŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”çš„æ–¹æ¡ˆæ¥è¯´ï¼ŒåŸºäºç¼“å­˜å®ç°çš„åˆ†å¸ƒå¼é”çš„ä¼˜åŠ¿è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š æ€§èƒ½æ›´å¥½ã€‚æ•°æ®è¢«å­˜æ”¾åœ¨å†…å­˜ï¼Œè€Œä¸æ˜¯ç£ç›˜ï¼Œé¿å…äº†é¢‘ç¹çš„ IO æ“ä½œã€‚ å¾ˆå¤šç¼“å­˜å¯ä»¥è·¨é›†ç¾¤éƒ¨ç½²ï¼Œé¿å…äº†å•ç‚¹æ•…éšœé—®é¢˜ã€‚ å¤šç¼“å­˜æœåŠ¡éƒ½æä¾›äº†å¯ä»¥ç”¨æ¥å®ç°åˆ†å¸ƒå¼é”çš„æ–¹æ³•ï¼Œæ¯”å¦‚ Redis çš„ setnx æ–¹æ³•ç­‰ã€‚ å¯ä»¥ç›´æ¥è®¾ç½®è¶…æ—¶æ—¶é—´æ¥æ§åˆ¶é”çš„é‡Šæ”¾ï¼Œå› ä¸ºè¿™äº›ç¼“å­˜æœåŠ¡å™¨ä¸€èˆ¬æ”¯æŒè‡ªåŠ¨åˆ é™¤è¿‡æœŸæ•°æ®ã€‚ è¿™ä¸ªæ–¹æ¡ˆçš„ä¸è¶³æ˜¯ï¼Œé€šè¿‡è¶…æ—¶æ—¶é—´æ¥æ§åˆ¶é”çš„å¤±æ•ˆæ—¶é—´ï¼Œå¹¶ä¸æ˜¯ååˆ†é è°±ï¼Œå› ä¸ºä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œæ—¶é—´å¯èƒ½æ¯”è¾ƒé•¿ï¼Œæˆ–å—ç³»ç»Ÿè¿›ç¨‹åšå†…å­˜å›æ”¶ç­‰å½±å“ï¼Œå¯¼è‡´æ—¶é—´è¶…æ—¶ï¼Œä»è€Œä¸æ­£ç¡®åœ°é‡Šæ”¾äº†é”ã€‚ åŸºäº ZooKeeper å®ç°åˆ†å¸ƒå¼é”ZooKeeper åŸºäºæ ‘å½¢æ•°æ®å­˜å‚¨ç»“æ„å®ç°åˆ†å¸ƒå¼é”ï¼Œæ¥è§£å†³å¤šä¸ªè¿›ç¨‹åŒæ—¶è®¿é—®åŒä¸€ä¸´ç•Œèµ„æºæ—¶ï¼Œæ•°æ®çš„ä¸€è‡´æ€§é—®é¢˜ã€‚ZooKeeper çš„æ ‘å½¢æ•°æ®å­˜å‚¨ç»“æ„ä¸»è¦ç”± 4 ç§èŠ‚ç‚¹æ„æˆï¼š æŒä¹…èŠ‚ç‚¹ã€‚è¿™æ˜¯é»˜è®¤çš„èŠ‚ç‚¹ç±»å‹ï¼Œä¸€ç›´å­˜åœ¨äº ZooKeeper ä¸­ã€‚ æŒä¹…é¡ºåºèŠ‚ç‚¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨åˆ›å»ºèŠ‚ç‚¹æ—¶ï¼ŒZooKeeper æ ¹æ®èŠ‚ç‚¹åˆ›å»ºçš„æ—¶é—´é¡ºåºå¯¹èŠ‚ç‚¹è¿›è¡Œç¼–å·ã€‚ ä¸´æ—¶èŠ‚ç‚¹ã€‚ä¸æŒä¹…èŠ‚ç‚¹ä¸åŒï¼Œå½“å®¢æˆ·ç«¯ä¸ ZooKeeper æ–­å¼€è¿æ¥åï¼Œè¯¥è¿›ç¨‹åˆ›å»ºçš„ä¸´æ—¶èŠ‚ç‚¹å°±ä¼šè¢«åˆ é™¤ã€‚ ä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼Œå°±æ˜¯æŒ‰æ—¶é—´é¡ºåºç¼–å·çš„ä¸´æ—¶èŠ‚ç‚¹ã€‚ æ ¹æ®å®ƒä»¬çš„ç‰¹å¾ï¼ŒZooKeeper åŸºäºä¸´æ—¶é¡ºåºèŠ‚ç‚¹å®ç°äº†åˆ†å¸ƒé”ã€‚è¿˜æ˜¯ä»¥ç”µå•†å”®å–å¹é£æœºçš„åœºæ™¯ä¸ºä¾‹ã€‚å‡è®¾ç”¨æˆ· Aã€Bã€C åŒæ—¶åœ¨ 11 æœˆ 11 æ—¥çš„é›¶ç‚¹æ•´æäº¤äº†è´­ä¹°å¹é£æœºçš„è¯·æ±‚ï¼ŒZooKeeper ä¼šé‡‡ç”¨å¦‚ä¸‹æ–¹æ³•æ¥å®ç°åˆ†å¸ƒå¼é”ï¼š åœ¨ä¸è¯¥æ–¹æ³•å¯¹åº”çš„æŒä¹…èŠ‚ç‚¹ shared_lock çš„ç›®å½•ä¸‹ï¼Œä¸ºæ¯ä¸ªè¿›ç¨‹åˆ›å»ºä¸€ä¸ªä¸´æ—¶é¡ºåºèŠ‚ç‚¹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¹é£æœºå°±æ˜¯ä¸€ä¸ªæ‹¥æœ‰ shared_lock çš„ç›®å½•ï¼Œå½“æœ‰äººä¹°å¹é£æœºæ—¶ï¼Œä¼šä¸ºä»–åˆ›å»ºä¸€ä¸ªä¸´æ—¶é¡ºåºèŠ‚ç‚¹ã€‚ æ¯ä¸ªè¿›ç¨‹è·å– shared_lock ç›®å½•ä¸‹çš„æ‰€æœ‰ä¸´æ—¶èŠ‚ç‚¹åˆ—è¡¨ï¼Œæ³¨å†Œå­èŠ‚ç‚¹å˜æ›´çš„ Watcherï¼Œå¹¶ç›‘å¬èŠ‚ç‚¹ã€‚ æ¯ä¸ªèŠ‚ç‚¹ç¡®å®šè‡ªå·±çš„ç¼–å·æ˜¯å¦æ˜¯ shared_lock ä¸‹æ‰€æœ‰å­èŠ‚ç‚¹ä¸­æœ€å°çš„ï¼Œè‹¥æœ€å°ï¼Œåˆ™è·å¾—é”ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ· A çš„è®¢å•æœ€å…ˆåˆ°æœåŠ¡å™¨ï¼Œå› æ­¤åˆ›å»ºäº†ç¼–å·ä¸º 1 çš„ä¸´æ—¶é¡ºåºèŠ‚ç‚¹ LockNode1ã€‚è¯¥èŠ‚ç‚¹çš„ç¼–å·æ˜¯æŒä¹…èŠ‚ç‚¹ç›®å½•ä¸‹æœ€å°çš„ï¼Œå› æ­¤è·å–åˆ°åˆ†å¸ƒå¼é”ï¼Œå¯ä»¥è®¿é—®ä¸´ç•Œèµ„æºï¼Œä»è€Œå¯ä»¥è´­ä¹°å¹é£æœºã€‚ è‹¥æœ¬è¿›ç¨‹å¯¹åº”çš„ä¸´æ—¶èŠ‚ç‚¹ç¼–å·ä¸æ˜¯æœ€å°çš„ï¼Œåˆ™åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š a. æœ¬è¿›ç¨‹ä¸ºè¯»è¯·æ±‚ï¼Œå¦‚æœæ¯”è‡ªå·±åºå·å°çš„èŠ‚ç‚¹ä¸­æœ‰å†™è¯·æ±‚ï¼Œåˆ™ç­‰å¾…ï¼› b. æœ¬è¿›ç¨‹ä¸ºå†™è¯·æ±‚ï¼Œå¦‚æœæ¯”è‡ªå·±åºå·å°çš„èŠ‚ç‚¹ä¸­æœ‰è¯»è¯·æ±‚ï¼Œåˆ™ç­‰å¾…ã€‚ ä¾‹å¦‚ï¼Œç”¨æˆ· B ä¹Ÿæƒ³è¦ä¹°å¹é£æœºï¼Œä½†åœ¨ä»–ä¹‹å‰ï¼Œç”¨æˆ· C æƒ³çœ‹çœ‹å¹é£æœºçš„åº“å­˜é‡ã€‚å› æ­¤ï¼Œç”¨æˆ· B åªèƒ½ç­‰ç”¨æˆ· A ä¹°å®Œå¹é£æœºã€ç”¨æˆ· C æŸ¥è¯¢å®Œåº“å­˜é‡åï¼Œæ‰èƒ½è´­ä¹°å¹é£æœºã€‚ å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨ ZooKeeper å¯ä»¥å®Œç¾è§£å†³è®¾è®¡åˆ†å¸ƒå¼é”æ—¶é‡åˆ°çš„å„ç§é—®é¢˜ï¼Œæ¯”å¦‚å•ç‚¹æ•…éšœã€ä¸å¯é‡å…¥ã€æ­»é”ç­‰é—®é¢˜ã€‚è™½ç„¶ ZooKeeper å®ç°çš„åˆ†å¸ƒå¼é”ï¼Œå‡ ä¹èƒ½æ¶µç›–æ‰€æœ‰åˆ†å¸ƒå¼é”çš„ç‰¹æ€§ï¼Œä¸”æ˜“äºå®ç°ï¼Œä½†éœ€è¦é¢‘ç¹åœ°æ·»åŠ å’Œåˆ é™¤èŠ‚ç‚¹ï¼Œæ‰€ä»¥æ€§èƒ½ä¸å¦‚åŸºäºç¼“å­˜å®ç°çš„åˆ†å¸ƒå¼é”ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„å®ç°å¤æ‚æ€§ï¼Œæ˜¯é’ˆå¯¹åŒæ ·çš„åˆ†å¸ƒå¼é”çš„å®ç°å¤æ‚æ€§ï¼Œä¸ä¹‹å‰æåˆ°çš„åŸºäºæ•°æ®åº“çš„å®ç°éå¸¸ç®€æ˜“ä¸ä¸€æ ·ã€‚åŸºäºæ•°æ®åº“å®ç°çš„åˆ†å¸ƒå¼é”å­˜åœ¨å•ç‚¹æ•…éšœå’Œæ­»é”é—®é¢˜ï¼Œä»…ä»…åˆ©ç”¨æ•°æ®åº“æŠ€æœ¯å»è§£å†³å•ç‚¹æ•…éšœå’Œæ­»é”é—®é¢˜ï¼Œæ˜¯éå¸¸å¤æ‚çš„ã€‚è€Œ ZooKeeper å·²å®šä¹‰ç›¸å…³çš„åŠŸèƒ½ç»„ä»¶ï¼Œå› æ­¤å¯ä»¥å¾ˆè½»æ˜“åœ°è§£å†³è®¾è®¡åˆ†å¸ƒå¼é”æ—¶é‡åˆ°çš„å„ç§é—®é¢˜ã€‚æ‰€ä»¥è¯´ï¼Œè¦å®ç°ä¸€ä¸ªå®Œæ•´çš„ã€æ— ä»»ä½•ç¼ºé™·çš„åˆ†å¸ƒå¼é”ï¼ŒZooKeeper æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„é€‰æ‹©ã€‚ ä»ä¸Šè¿°åˆ†æå¯çœ‹å‡ºï¼Œä¸ºäº†ç¡®ä¿åˆ†å¸ƒå¼é”çš„å¯ç”¨æ€§ï¼Œæˆ‘ä»¬åœ¨è®¾è®¡æ—¶åº”è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š äº’æ–¥æ€§ï¼Œå³åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œåˆ†å¸ƒå¼é”åº”è¯¥èƒ½ä¿è¯ä¸€ä¸ªèµ„æºæˆ–ä¸€ä¸ªæ–¹æ³•åœ¨åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªæœºå™¨çš„ä¸€ä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹æ“ä½œã€‚ å…·å¤‡é”å¤±æ•ˆæœºåˆ¶ï¼Œé˜²æ­¢æ­»é”ã€‚å³ä½¿æœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨æŒæœ‰é”çš„æœŸé—´å› ä¸ºå´©æºƒè€Œæ²¡æœ‰ä¸»åŠ¨è§£é”ï¼Œä¹Ÿèƒ½ä¿è¯åç»­å…¶ä»–è¿›ç¨‹å¯ä»¥è·å¾—é”ã€‚ å¯é‡å…¥æ€§ï¼Œå³è¿›ç¨‹æœªé‡Šæ”¾é”æ—¶ï¼Œå¯ä»¥å¤šæ¬¡è®¿é—®ä¸´ç•Œèµ„æºã€‚ æœ‰é«˜å¯ç”¨çš„è·å–é”å’Œé‡Šæ”¾é”çš„åŠŸèƒ½ï¼Œä¸”æ€§èƒ½è¦å¥½ã€‚ å¦‚ä½•è§£å†³åˆ†å¸ƒå¼é”çš„ç¾Šç¾¤æ•ˆåº”é—®é¢˜ï¼Ÿåœ¨åˆ†å¸ƒå¼é”é—®é¢˜ä¸­ï¼Œä¼šç»å¸¸é‡åˆ°ç¾Šç¾¤æ•ˆåº”ã€‚æ‰€è°“ç¾Šç¾¤æ•ˆåº”ï¼Œå°±æ˜¯åœ¨æ•´ä¸ªåˆ†å¸ƒå¼é”çš„ç«äº‰è¿‡ç¨‹ä¸­ï¼Œå¤§é‡çš„â€œWatcher é€šçŸ¥â€å’Œâ€œå­èŠ‚ç‚¹åˆ—è¡¨çš„è·å–â€æ“ä½œé‡å¤è¿è¡Œï¼Œå¹¶ä¸”å¤§å¤šæ•°èŠ‚ç‚¹çš„è¿è¡Œç»“æœéƒ½æ˜¯åˆ¤æ–­å‡ºè‡ªå·±å½“å‰å¹¶ä¸æ˜¯ç¼–å·æœ€å°çš„èŠ‚ç‚¹ï¼Œç»§ç»­ç­‰å¾…ä¸‹ä¸€æ¬¡é€šçŸ¥ï¼Œè€Œä¸æ˜¯æ‰§è¡Œä¸šåŠ¡é€»è¾‘ã€‚ è¿™ï¼Œå°±ä¼šå¯¹ ZooKeeper æœåŠ¡å™¨é€ æˆå·¨å¤§çš„æ€§èƒ½å½±å“å’Œç½‘ç»œå†²å‡»ã€‚æ›´ç”šçš„æ˜¯ï¼Œå¦‚æœåŒä¸€æ—¶é—´å¤šä¸ªèŠ‚ç‚¹å¯¹åº”çš„å®¢æˆ·ç«¯å®Œæˆäº‹åŠ¡æˆ–äº‹åŠ¡ä¸­æ–­å¼•èµ·èŠ‚ç‚¹æ¶ˆå¤±ï¼ŒZooKeeper æœåŠ¡å™¨å°±ä¼šåœ¨çŸ­æ—¶é—´å†…å‘å…¶ä»–å®¢æˆ·ç«¯å‘é€å¤§é‡çš„äº‹ä»¶é€šçŸ¥ã€‚ é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿå…·ä½“æ–¹æ³•å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥ã€‚ åœ¨ä¸è¯¥æ–¹æ³•å¯¹åº”çš„æŒä¹…èŠ‚ç‚¹çš„ç›®å½•ä¸‹ï¼Œä¸ºæ¯ä¸ªè¿›ç¨‹åˆ›å»ºä¸€ä¸ªä¸´æ—¶é¡ºåºèŠ‚ç‚¹ã€‚ æ¯ä¸ªè¿›ç¨‹è·å–æ‰€æœ‰ä¸´æ—¶èŠ‚ç‚¹åˆ—è¡¨ï¼Œå¯¹æ¯”è‡ªå·±çš„ç¼–å·æ˜¯å¦æœ€å°ï¼Œè‹¥æœ€å°ï¼Œåˆ™è·å¾—é”ã€‚ è‹¥æœ¬è¿›ç¨‹å¯¹åº”çš„ä¸´æ—¶èŠ‚ç‚¹ç¼–å·ä¸æ˜¯æœ€å°çš„ï¼Œåˆ™ç»§ç»­åˆ¤æ–­ï¼š è‹¥æœ¬è¿›ç¨‹ä¸ºè¯»è¯·æ±‚ï¼Œåˆ™å‘æ¯”è‡ªå·±åºå·å°çš„æœ€åä¸€ä¸ªå†™è¯·æ±‚èŠ‚ç‚¹æ³¨å†Œ watch ç›‘å¬ï¼Œå½“ç›‘å¬åˆ°è¯¥èŠ‚ç‚¹é‡Šæ”¾é”åï¼Œåˆ™è·å–é”ï¼› è‹¥æœ¬è¿›ç¨‹ä¸ºå†™è¯·æ±‚ï¼Œåˆ™å‘æ¯”è‡ªå·±åºå·å°çš„æœ€åä¸€ä¸ªè¯·æ±‚èŠ‚ç‚¹æ³¨å†Œ watch ç›‘å¬ï¼Œå½“ç›‘å¬åˆ°è¯¥èŠ‚ç‚¹é‡Šæ”¾é”åï¼Œè·å–é”ã€‚","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"åˆ†å¸ƒå¼è®¡ç®—","url":"/2024/12/31/åˆ†å¸ƒå¼è®¡ç®—/","content":"åˆ†å¸ƒå¼è®¡ç®—æ¨¡å¼ä¹‹MR","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"åˆ†å¸ƒå¼èµ„æºç®¡ç†ä¸è´Ÿè½½è°ƒåº¦","url":"/2024/12/31/åˆ†å¸ƒå¼èµ„æºç®¡ç†ä¸è´Ÿè½½è°ƒåº¦/","content":"åˆ†å¸ƒå¼ä½“ç³»ç»“æ„ä¹‹é›†ä¸­å¼ç»“æ„ï¼šä¸€äººåœ¨ä¸Šï¼Œä¸‡äººåœ¨ä¸‹å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬çš„è¯·æ±‚éƒ½ä¼šæ±‡æ€»åˆ°ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œç”±è¿™å°æœåŠ¡å™¨ç»Ÿä¸€åè°ƒæˆ‘ä»¬çš„è¯·æ±‚å’Œå…¶ä»–æœåŠ¡å™¨ä¹‹é—´çš„å…³ç³»ã€‚è¿™ç§ç”±ä¸€å°æœåŠ¡å™¨ç»Ÿä¸€ç®¡ç†å…¶ä»–æœåŠ¡å™¨çš„æ–¹å¼ï¼Œå°±æ˜¯åˆ†å¸ƒå¼ä½“ç³»ç»“æ„ä¸­çš„é›†ä¸­å¼ç»“æ„ï¼ˆä¹Ÿç§°ä¸º Master&#x2F;Slave æ¶æ„ï¼‰ï¼Œå…¶ä¸­ç»Ÿä¸€ç®¡ç†å…¶ä»–æœåŠ¡å™¨çš„æœåŠ¡å™¨æ˜¯ä¸»ï¼Œå…¶ä»–æœåŠ¡å™¨æ˜¯ä»ï¼Œå¯ä»¥å½¢è±¡åœ°æ¯”å–»ä¸ºâ€œä¸€äººåœ¨ä¸Šï¼Œä¸‡äººåœ¨ä¸‹â€ã€‚ é›†ä¸­å¼ç»“æ„å°±æ˜¯ï¼Œç”±ä¸€å°æˆ–å¤šå°æœåŠ¡å™¨ç»„æˆä¸­å¤®æœåŠ¡å™¨ï¼Œç³»ç»Ÿå†…çš„æ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨ä¸­å¤®æœåŠ¡å™¨ä¸­ï¼Œç³»ç»Ÿå†…æ‰€æœ‰çš„ä¸šåŠ¡ä¹Ÿå‡å…ˆç”±ä¸­å¤®æœåŠ¡å™¨å¤„ç†ã€‚å¤šä¸ªèŠ‚ç‚¹æœåŠ¡å™¨ä¸ä¸­å¤®æœåŠ¡å™¨è¿æ¥ï¼Œå¹¶å°†è‡ªå·±çš„ä¿¡æ¯æ±‡æŠ¥ç»™ä¸­å¤®æœåŠ¡å™¨ï¼Œç”±ä¸­å¤®æœåŠ¡å™¨ç»Ÿä¸€è¿›è¡Œèµ„æºå’Œä»»åŠ¡è°ƒåº¦ï¼šä¸­å¤®æœåŠ¡å™¨æ ¹æ®è¿™äº›ä¿¡æ¯ï¼Œå°†ä»»åŠ¡ä¸‹è¾¾ç»™èŠ‚ç‚¹æœåŠ¡å™¨ï¼›èŠ‚ç‚¹æœåŠ¡å™¨æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶å°†ç»“æœåé¦ˆç»™ä¸­å¤®æœåŠ¡å™¨ã€‚ é›†ä¸­å¼ç»“æ„æœ€å¤§çš„ç‰¹ç‚¹ï¼Œå°±æ˜¯éƒ¨ç½²ç»“æ„ç®€å•ã€‚è¿™æ˜¯å› ä¸ºï¼Œé›†ä¸­å¼ç³»ç»Ÿçš„ä¸­å¤®æœåŠ¡å™¨å¾€å¾€æ˜¯å¤šä¸ªå…·æœ‰è¾ƒå¼ºè®¡ç®—èƒ½åŠ›å’Œå­˜å‚¨èƒ½åŠ›çš„è®¡ç®—æœºï¼Œä¸ºæ­¤ä¸­å¤®æœåŠ¡å™¨è¿›è¡Œç»Ÿä¸€ç®¡ç†å’Œè°ƒåº¦ä»»åŠ¡æ—¶ï¼Œæ— éœ€è€ƒè™‘å¯¹ä»»åŠ¡çš„å¤šèŠ‚ç‚¹éƒ¨ç½²ï¼Œè€ŒèŠ‚ç‚¹æœåŠ¡å™¨ä¹‹é—´æ— éœ€é€šä¿¡å’Œåä½œï¼Œåªè¦ä¸ä¸­å¤®æœåŠ¡å™¨é€šä¿¡åä½œå³å¯ï¼Œå…·ä½“ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š ç»å…¸é›†ä¸­å¼ç»“æ„Borg æ˜¯ Google å†…éƒ¨ä½¿ç”¨çš„é›†ç¾¤ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨äº†å…¸å‹çš„é›†ä¸­å¼ç»“æ„ï¼Œè´Ÿè´£æäº¤ã€è°ƒåº¦ã€å¼€å§‹ã€é‡å¯å’Œç®¡ç† Google è¿è¡Œåœ¨å…¶ä¸Šçš„æ‰€æœ‰åº”ç”¨ã€‚ åœ¨ Borg ä¸­ï¼Œä¸€ä¸ªé›†ç¾¤ç§°ä¸ºä¸€ä¸ª Cellï¼Œæ¯ä¸ª Cell é‡Œé¢æœ‰ä¸€ä¸ª Leaderï¼Œç§°ä¸º BorgMasterï¼Œå³ä¸ºä¸­å¤®æœåŠ¡å™¨ï¼›å…¶ä»–æœåŠ¡å™¨ä¸ºèŠ‚ç‚¹æœåŠ¡å™¨æˆ–ä»æœåŠ¡å™¨ï¼Œè¢«ç§°ä¸º Borgletã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬ä¸€èµ·çœ‹çœ‹ BorgMasterã€‚å®ƒç”±ä¸¤ä¸ªè¿›ç¨‹ç»„æˆï¼Œä¸€ä¸ªæ˜¯ Borgmaster ä¸»è¿›ç¨‹ï¼Œä¸€ä¸ªæ˜¯ç‹¬ç«‹çš„ scheduler è¿›ç¨‹ï¼š ä¸»è¿›ç¨‹å¤„ç†å®¢æˆ·ç«¯çš„ RPC è¯·æ±‚ï¼Œæ¯”å¦‚ä»»åŠ¡çš„æ‰§è¡ŒçŠ¶æ€æ›´æ–°æˆ–è€…æŸ¥è¯¢ç­‰ï¼›åŒæ—¶ï¼Œç®¡ç†ç³»ç»Ÿä¸­æ‰€æœ‰å®ä½“çš„çŠ¶æ€ï¼ˆæ¯”å¦‚ï¼ŒæœåŠ¡å™¨ã€ä»»åŠ¡ç­‰ï¼‰ï¼Œå¹¶è´Ÿè´£å’Œ Borglet é€šä¿¡ã€‚ scheduler è¿›ç¨‹è´Ÿè´£ä»»åŠ¡è°ƒåº¦ï¼Œé€šè¿‡ä»»åŠ¡å¯¹èµ„æºçš„éœ€æ±‚ä»¥åŠå½“å‰ Borglet æ‰€åœ¨æœåŠ¡å™¨çš„èµ„æºæƒ…å†µè¿›è¡ŒåŒ¹é…ï¼Œä¸ºä»»åŠ¡å¯»æ‰¾ä¸€ä¸ªåˆé€‚çš„èŠ‚ç‚¹æœåŠ¡å™¨æ‰§è¡Œã€‚æˆ‘ä¼šåœ¨ç¬¬ 11 ç¯‡æ–‡ç« â€œåˆ†å¸ƒå¼è°ƒåº¦ä¹‹å•ä½“è°ƒåº¦ï¼šç‰©è´¨æ–‡æ˜ã€ç²¾ç¥æ–‡æ˜ä¸€æ‰‹æŠ“â€ä¸­ä¸ä½ è¯¦ç»†è®²è¿°å…·ä½“çš„è°ƒåº¦æµç¨‹ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·çœ‹çœ‹ Borgletã€‚å®ƒæ˜¯è¿è¡Œåœ¨æ¯ä¸ªèŠ‚ç‚¹æœºå™¨çš„ä¸€ä¸ª agentï¼Œè´Ÿè´£ä»»åŠ¡çš„æ‹‰èµ·ã€åœæ­¢ã€é‡å¯ç­‰ï¼Œå¹¶ç®¡ç†å’Œæœé›†æœ¬æœåŠ¡å™¨èµ„æºï¼Œå°†ä»»åŠ¡çš„çŠ¶æ€ã€æœåŠ¡å™¨çŠ¶æ€ç­‰ä¿¡æ¯ä¸ŠæŠ¥ç»™ BorgMasterã€‚è€Œ BorgMaster ä¼šå‘¨æœŸæ€§åœ°è½®è¯¢æ¯ä¸ª Borgletï¼Œä»¥è·å–èŠ‚ç‚¹æœåŠ¡å™¨çš„çŠ¶æ€å’Œèµ„æºä¿¡æ¯ç­‰ã€‚ Borg çš„æ•´ä½“æ¶æ„ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š Borg çš„ä¸»è¦ç”¨æˆ·æ˜¯ Google çš„å¼€å‘è€…ä»¥åŠè¿è¡Œ Google åº”ç”¨å’ŒæœåŠ¡çš„ç³»ç»Ÿç®¡ç†å‘˜ï¼ˆç½‘ç«™å¯é æ€§å·¥ç¨‹å¸ˆï¼Œç®€ç§° SREï¼‰ã€‚ç”¨æˆ·ä»¥ Job çš„å½¢å¼å‘ Borg æäº¤å·¥ä½œï¼Œæ¯ä¸ª Job ç”±è¿è¡Œä¸€ä¸ªæˆ–å¤šä¸ªè¿è¡Œç›¸åŒç¨‹åºçš„ Task ç»„æˆã€‚æ¯ä¸ª Job è¿è¡Œåœ¨ä¸€ä¸ª Borg Cell ä¸­ï¼Œå¹¶å°†ä¸€ç»„æœºå™¨å½“åšä¸€ä¸ªå•å…ƒè¿›è¡Œç®¡ç†ã€‚ Borg å¯ä»¥è¿è¡Œå„ç§å„æ ·çš„ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼š ç¬¬ä¸€ç±»æ˜¯é•¿æœåŠ¡ï¼Œå³é•¿æ—¶é—´è¿è¡Œä¸åœæ­¢çš„æœåŠ¡ï¼Œå¹¶ä¸”è¦æ±‚èƒ½å¤Ÿå¤„ç†çŸ­æš‚çš„ã€å»¶è¿Ÿæ•æ„Ÿçš„è¯·æ±‚ï¼ˆå»¶è¿Ÿè¦æ±‚åœ¨å‡ å¾®ç§’åˆ°å‡ ç™¾æ¯«ç§’ä¹‹é—´ï¼‰ã€‚è¿™äº›æœåŠ¡ä¸»è¦ç”¨äºé¢å‘ç»ˆç«¯ç”¨æˆ·çš„æœåŠ¡ï¼ˆæ¯”å¦‚ Gmailã€Google Docsã€Web æœç´¢ï¼‰ï¼Œä»¥åŠå†…éƒ¨çš„ä¸€äº›åŸºç¡€è®¾æ–½æœåŠ¡ï¼ˆæ¯”å¦‚ BigTableï¼‰ã€‚ ç¬¬äºŒç±»æ˜¯æ‰¹å¤„ç†ä»»åŠ¡ã€‚é€šå¸¸éœ€è¦å‡ ç§’åˆ°å‡ å¤©çš„æ—¶é—´æ¥å®Œæˆçš„æ‰¹å¤„ç† Jobï¼Œè¿™äº› Job å¯¹çŸ­æ—¶é—´çš„æ€§èƒ½æ³¢åŠ¨å¹¶ä¸æ˜¯éå¸¸æ•æ„Ÿã€‚ è¿™äº›è´Ÿè½½é€šå¸¸åœ¨ Cell ä¹‹é—´æ··åˆåˆ†å¸ƒï¼Œæ¯ä¸ª Cell éšç€ä¸»è¦ç§Ÿæˆ·ä»¥åŠæ—¶é—´çš„ä¸åŒä¼šè¿è¡Œå„ç§ä¸åŒçš„åº”ç”¨ï¼šæ‰¹å¤„ç†ç±»å‹çš„ Job æ¥äº†åˆèµ°ï¼Œè€Œè®¸å¤šé¢å‘ç»ˆç«¯ç”¨æˆ·çš„ Job åˆæœŸæœ›ä¸€ä¸ªèƒ½é•¿æ—¶é—´ä½¿ç”¨çš„æ¨¡å¼ã€‚ å¯¹äºè¿™äº›ä¸åŒçš„æœåŠ¡ï¼Œè¦æ±‚ Borg èƒ½å¾ˆå¥½åœ°å¤„ç†æ‰€æœ‰çš„æƒ…å†µã€‚Borg ä¸»è¦æœ‰ä¸‰å¤§ä¼˜ç‚¹ï¼š å¼€å‘è€…åªéœ€å…³æ³¨åº”ç”¨ï¼Œä¸éœ€è¦å…³æ³¨åº•å±‚èµ„æºç®¡ç†ã€‚å®ƒéšè—äº†èµ„æºç®¡ç†ä»¥åŠé”™è¯¯å¤„ç†ï¼Œå› æ­¤ç”¨æˆ·èƒ½é›†ä¸­ç²¾åŠ›å¼€å‘åº”ç”¨ã€‚ é«˜å¯é æ€§å’Œå¯ç”¨æ€§ï¼Œæ”¯æŒå¤šç§åº”ç”¨ã€‚ æ”¯æŒä¸Šåƒçº§æœåŠ¡å™¨çš„ç®¡ç†å’Œè¿è¡Œã€‚ Borg å¹¶ä¸æ˜¯ç¬¬ä¸€ä¸ªè§£å†³è¿™äº›é—®é¢˜çš„ç³»ç»Ÿï¼Œä½†å´æ˜¯å°‘æ•°èƒ½åœ¨è¿™ä¹ˆå¤§è§„æ¨¡å¤„ç†è¿™äº›é—®é¢˜çš„åŒæ—¶ï¼Œè¿˜èƒ½å®ç°è¿™æ ·çš„å¼¹æ€§å’Œå®Œæ•´æ€§çš„ç³»ç»Ÿä¹‹ä¸€ã€‚ KubernetesKubernetes æ˜¯ Google å¼€æºçš„å®¹å™¨é›†ç¾¤ç®¡ç†ç³»ç»Ÿï¼Œæ˜¯ Borg çš„ä¸€ä¸ªå¼€æºç‰ˆæœ¬ã€‚Kubernetes æ˜¯ç”¨äºè‡ªåŠ¨éƒ¨ç½²ã€æ‰©å±•å’Œç®¡ç†å®¹å™¨åŒ–åº”ç”¨ç¨‹åºçš„å¼€æºç³»ç»Ÿã€‚å…¶æ ¸å¿ƒæ˜¯ï¼Œåœ¨é›†ç¾¤çš„èŠ‚ç‚¹ä¸Šè¿è¡Œå®¹å™¨åŒ–åº”ç”¨ï¼Œå¯ä»¥è¿›è¡Œè‡ªåŠ¨åŒ–å®¹å™¨æ“ä½œï¼ŒåŒ…æ‹¬éƒ¨ç½²ã€è°ƒåº¦å’Œåœ¨èŠ‚ç‚¹é—´å¼¹æ€§ä¼¸ç¼©ç­‰ã€‚ Kubernetes ä¹Ÿæ˜¯å…¸å‹çš„é›†ä¸­å¼ç»“æ„ï¼Œä¸€ä¸ª Kubernetes é›†ç¾¤ï¼Œä¸»è¦ç”± Master èŠ‚ç‚¹å’Œ Worker èŠ‚ç‚¹ç»„æˆï¼Œä»¥åŠå®¢æˆ·ç«¯å‘½ä»¤è¡Œå·¥å…· kubectl å’Œå…¶ä»–é™„åŠ é¡¹ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ Master èŠ‚ç‚¹ã€‚å®ƒè¿è¡Œåœ¨ä¸­å¿ƒæœåŠ¡å™¨ä¸Šï¼ŒMaster èŠ‚ç‚¹ç”± API Serverã€Schedulerã€Cluster State Store å’Œ Control Manger Server ç»„æˆï¼Œè´Ÿè´£å¯¹é›†ç¾¤è¿›è¡Œè°ƒåº¦ç®¡ç†ã€‚ API Serverï¼šæ˜¯æ‰€æœ‰ REST å‘½ä»¤çš„å…¥å£ï¼Œè´Ÿè´£å¤„ç† REST çš„æ“ä½œï¼Œç¡®ä¿å®ƒä»¬ç”Ÿæ•ˆï¼Œå¹¶æ‰§è¡Œç›¸å…³ä¸šåŠ¡é€»è¾‘ã€‚ Schedulerï¼šæ ¹æ®å®¹å™¨éœ€è¦çš„èµ„æºä»¥åŠå½“å‰ Worker èŠ‚ç‚¹æ‰€åœ¨èŠ‚ç‚¹æœåŠ¡å™¨çš„èµ„æºä¿¡æ¯ï¼Œè‡ªåŠ¨ä¸ºå®¹å™¨é€‰æ‹©åˆé€‚çš„èŠ‚ç‚¹æœåŠ¡å™¨ã€‚ Cluster State Storeï¼šé›†ç¾¤çŠ¶æ€å­˜å‚¨ï¼Œé»˜è®¤é‡‡ç”¨ etcdï¼Œetcd æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ key-value å­˜å‚¨ï¼Œä¸»è¦ç”¨æ¥åšå…±äº«é…ç½®å’ŒæœåŠ¡å‘ç°ã€‚ Control Managerï¼šç”¨äºæ‰§è¡Œå¤§éƒ¨åˆ†çš„é›†ç¾¤å±‚æ¬¡çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ‰§è¡Œç”Ÿå‘½å‘¨æœŸåŠŸèƒ½ï¼ˆå‘½åç©ºé—´åˆ›å»ºå’Œç”Ÿå‘½å‘¨æœŸã€äº‹ä»¶åƒåœ¾æ”¶é›†ã€å·²ç»ˆæ­¢åƒåœ¾æ”¶é›†ã€çº§è”åˆ é™¤åƒåœ¾æ”¶é›†ç­‰ï¼‰å’Œ API ä¸šåŠ¡é€»è¾‘ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹ Worker èŠ‚ç‚¹å§ã€‚å®ƒä½œä¸ºçœŸæ­£çš„å·¥ä½œèŠ‚ç‚¹ï¼Œè¿è¡Œåœ¨ä»èŠ‚ç‚¹æœåŠ¡å™¨ï¼ŒåŒ…æ‹¬ kubelet å’Œ kube-proxy æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£è¿è¡Œä¸šåŠ¡åº”ç”¨çš„å®¹å™¨ã€‚ kubeletï¼šç”¨äºé€šè¿‡å‘½ä»¤è¡Œä¸ API Server è¿›è¡Œäº¤äº’ï¼Œæ ¹æ®æ¥æ”¶åˆ°çš„è¯·æ±‚å¯¹ Worker èŠ‚ç‚¹è¿›è¡Œæ“ä½œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡ä¸ API Server è¿›è¡Œé€šä¿¡ï¼Œæ¥æ”¶ Master èŠ‚ç‚¹æ ¹æ®è°ƒåº¦ç­–ç•¥å‘å‡ºçš„è¯·æ±‚æˆ–å‘½ä»¤ï¼Œåœ¨ Worker èŠ‚ç‚¹ä¸Šç®¡æ§å®¹å™¨ï¼ˆPodï¼‰ï¼Œå¹¶ç®¡æ§å®¹å™¨çš„è¿è¡ŒçŠ¶æ€ï¼ˆæ¯”å¦‚ï¼Œé‡æ–°å¯åŠ¨å‡ºç°æ•…éšœçš„ Podï¼‰ç­‰ã€‚Pod æ˜¯ Kubernetes çš„æœ€å°å·¥ä½œå•å…ƒï¼Œæ¯ä¸ª Pod åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ã€‚ kube-proxyï¼šè´Ÿè´£ä¸ºå®¹å™¨ï¼ˆPodï¼‰åˆ›å»ºç½‘ç»œä»£ç† &#x2F; è´Ÿè½½å¹³è¡¡æœåŠ¡ï¼Œä» API Server è·å–æ‰€æœ‰ Server ä¿¡æ¯ï¼Œå¹¶æ ¹æ® Server ä¿¡æ¯åˆ›å»ºä»£ç†æœåŠ¡ï¼Œè¿™ç§ä»£ç†æœåŠ¡ç§°ä¹‹ä¸º Serviceã€‚Kube-proxy ä¸»è¦è´Ÿè´£ç®¡ç† Service çš„è®¿é—®å…¥å£ï¼Œå³å®ç°é›†ç¾¤å†…çš„ Pod å®¢æˆ·ç«¯è®¿é—® Serviceï¼Œæˆ–è€…æ˜¯é›†ç¾¤å¤–è®¿é—® Serviceï¼Œå…·æœ‰ç›¸åŒæœåŠ¡çš„ä¸€ç»„ Pod å¯æŠ½è±¡ä¸ºä¸€ä¸ª Serviceã€‚æ¯ä¸ª Service éƒ½æœ‰ä¸€ä¸ªè™šæ‹Ÿ IP åœ°å€ï¼ˆVIPï¼‰å’Œç«¯å£å·ä¾›å®¢æˆ·ç«¯è®¿é—®ã€‚ Kubernetes æ¶æ„ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š å›¾ä¸­ï¼Œ Kube DNS è´Ÿè´£ä¸ºæ•´ä¸ªé›†ç¾¤æä¾› DNS æœåŠ¡ï¼›CNI æ˜¯ Container Network Interface çš„ä¸€ä¸ªæ ‡å‡†çš„é€šç”¨æ¥å£ï¼Œç”¨äºè¿æ¥å®¹å™¨ç®¡ç†ç³»ç»Ÿå’Œç½‘ç»œæ’ä»¶ã€‚ ä¸ Borg ä¸åŒçš„æ˜¯ï¼ŒKubernetes ä¸»è¦æ˜¯ä¸€ä¸ªå®¹å™¨ç¼–æ’å¼•æ“ï¼Œä¸ä»…æ”¯æŒ Dockerï¼Œè¿˜æ”¯æŒ Rocket(å¦ä¸€ç§å®¹å™¨æŠ€æœ¯)ã€‚ Kubernetes ä¹Ÿå·²ç»è¢«å¾ˆå¤šå…¬å¸é‡‡ç”¨ï¼Œæ¯”å¦‚ç½‘æ˜“äº‘ã€åä¸ºåœ¨éœ€è¦ä½¿ç”¨å®¹å™¨è¿›è¡Œèµ„æºéš”ç¦»ä»¥è¿è¡Œç›¸å…³ä¸šåŠ¡çš„åœºæ™¯ä¸‹ï¼Œé‡‡ç”¨äº†å¤§è§„æ¨¡ Kubernetes é›†ç¾¤ã€‚ åœ¨å®¹å™¨ç®¡ç†æ–¹é¢ï¼ŒKubernetes æœ‰å¾ˆå¤šä¼˜åŠ¿ã€‚ è‡ªåŠ¨åŒ–å®¹å™¨çš„éƒ¨ç½²å’Œå¤åˆ¶ã€‚Kubernetes æ‰§è¡Œå®¹å™¨ç¼–æ’ï¼Œå› æ­¤ä¸å¿…äººå·¥ç¼–å†™è¿™äº›ä»»åŠ¡çš„è„šæœ¬ã€‚ å°†å®¹å™¨ç»„ç»‡ä¸ºç»„ï¼Œå¼¹æ€§ä¼¸ç¼©ã€‚Kubernetes å¼•å…¥ Pod æœºåˆ¶ï¼ŒPod ä»£è¡¨ç€èƒ½å¤Ÿä½œä¸ºå•ä¸€åº”ç”¨ç¨‹åºåŠ ä»¥æ§åˆ¶çš„ä¸€ç»„å®¹å™¨é›†åˆã€‚é€šè¿‡ Pod æœºåˆ¶ï¼ŒKubernetes å®ç°äº†å¤šä¸ªå®¹å™¨çš„åä½œï¼Œèƒ½å¤Ÿæœ‰æ•ˆé¿å…å°†å¤ªå¤šåŠŸèƒ½é›†ä¸­åˆ°å•ä¸€å®¹å™¨é•œåƒè¿™æ ·çš„é”™è¯¯å®è·µä¸­ã€‚æ­¤å¤–ï¼Œè½¯ä»¶å¯ä»¥å‘å¤–æ‰©å±•è·¨è¶Šå¤šä¸ª Pods å®ç°åˆæ­¥éƒ¨ç½²ï¼Œä¸”ç›¸å…³éƒ¨ç½²å¯éšæ—¶è¿›è¡Œè§„æ¨¡ä¼¸ç¼©ã€‚ å®¹å™¨é—´è´Ÿè½½å‡è¡¡ã€‚Services ç”¨äºå°†å…·å¤‡ç±»ä¼¼åŠŸèƒ½çš„å¤šä¸ª Pod æ•´åˆä¸ºä¸€ç»„ï¼Œå¯è½»æ¾è¿›è¡Œé…ç½®ä»¥å®ç°å…¶å¯å‘ç°æ€§ã€å¯è§‚å¯Ÿæ€§ã€æ¨ªå‘æ‰©å±•ä»¥åŠè´Ÿè½½å‡è¡¡ã€‚ æ˜“äºç‰ˆæœ¬æ§åˆ¶ä¸æ»šåŠ¨æ›´æ–°ã€‚Kubernetes é‡‡å–â€œæ»šåŠ¨æ–¹å¼â€å®ç°ç¼–æ’ï¼Œä¸”å¯è·¨è¶Šéƒ¨ç½²èŒƒå›´å†…çš„å…¨éƒ¨ Podã€‚è¿™äº›æ»šåŠ¨æ›´æ–°å¯è¿›è¡Œç¼–æ’ï¼Œå¹¶ä»¥é¢„å®šä¹‰æ–¹å¼é…åˆå½“å‰å¯èƒ½å°šä¸å¯ç”¨çš„ Pods æ•°é‡ï¼Œä»¥åŠæš‚æ—¶å­˜åœ¨çš„é—²ç½® Pods æ•°é‡ã€‚Kubernetes åˆ©ç”¨æ–°çš„åº”ç”¨ç¨‹åºé•œåƒç‰ˆæœ¬å¯¹å·²éƒ¨ç½² Pods è¿›è¡Œæ›´æ–°ï¼Œå¹¶åœ¨å‘ç°å½“å‰ç‰ˆæœ¬å­˜åœ¨ä¸ç¨³å®šé—®é¢˜æ—¶å›æ»šè‡³æ—©æœŸéƒ¨ç½²ç‰ˆæœ¬ã€‚ Mesosç†è§£äº† Google Borg å’Œ Kubernetes çš„é›†ä¸­å¼ç»“æ„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å†çœ‹çœ‹ Apache æ——ä¸‹çš„å¼€æºåˆ†å¸ƒå¼èµ„æºç®¡ç†æ¡†æ¶ Mesos å§ã€‚å®ƒè¢«ç§°ä¸ºæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„å†…æ ¸ï¼Œæœ€åˆç”±åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡çš„ AMPLab å¼€å‘ï¼Œååœ¨ Twitter å¾—åˆ°å¹¿æ³›ä½¿ç”¨ã€‚ Mesos çš„å¼€å‘å—åˆ°äº† Borg ç³»ç»Ÿçš„å¯å‘ï¼Œä¹Ÿæ˜¯é‡‡ç”¨çš„å…¸å‹çš„é›†ä¸­å¼æ¶æ„ã€‚Mesos ä¸ Borg ä¸åŒä¹‹å¤„åœ¨äºï¼ŒBorg çš„ Master ç›´æ¥å¯¹æ¥ç”¨æˆ·åº”ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨æˆ·å¯ä»¥å‘ Borg çš„ Master ç›´æ¥è¯·æ±‚ä»»åŠ¡ã€‚ä½† Mesos ä¸å¯ä»¥ï¼ŒMesos åªè´Ÿè´£åº•å±‚èµ„æºçš„ç®¡ç†å’Œåˆ†é…ï¼Œå¹¶ä¸æ¶‰åŠå­˜å‚¨ã€ ä»»åŠ¡è°ƒåº¦ç­‰åŠŸèƒ½ï¼Œå› æ­¤ Mesos Master å¯¹æ¥çš„æ˜¯ Sparkã€Hadoopã€Marathon ç­‰æ¡†æ¶ï¼Œç”¨æˆ·çš„ä»»åŠ¡éœ€è¦æäº¤åˆ°è¿™äº›æ¡†æ¶ä¸Šã€‚ä¹Ÿæ­£å› ä¸ºæ­¤ï¼ŒMesos çš„ä»»åŠ¡è°ƒåº¦æ¡†æ¶æ˜¯åŒå±‚ç»“æ„ã€‚ åœ¨ Mesos ä¸­ï¼Œä¸€ä¸ªé›†ç¾¤åŒ…æ‹¬ Mesos Master å’Œå¤šä¸ª Mesos Agentã€‚å…¶ä¸­ï¼ŒMesos Master è¿è¡Œåœ¨ä¸­å¤®æœåŠ¡å™¨ï¼ŒMesos Agent è¿è¡Œåœ¨èŠ‚ç‚¹æœåŠ¡å™¨ä¸Šã€‚ Mesos Master è´Ÿè´£æ”¶é›†å’Œç®¡ç†æ‰€æœ‰ Agent æ‰€åœ¨æœåŠ¡å™¨çš„èµ„æºå’ŒçŠ¶æ€ï¼Œå¹¶ä¸”å¯¹æ¥ Sparkã€Hadoop ç­‰æ¡†æ¶ï¼Œå°†é›†ç¾¤ä¸­æœåŠ¡å™¨çš„èµ„æºä¿¡æ¯å‘ŠçŸ¥ç»™è¿™äº›æ¡†æ¶ï¼Œä»¥ä¾¿è¿™äº›æ¡†æ¶è¿›è¡Œä»»åŠ¡èµ„æºåŒ¹é…å’Œè°ƒåº¦ã€‚Mesos Agent è´Ÿè´£ä»»åŠ¡çš„æ‹‰èµ·ã€åœæ­¢ã€é‡å¯ç­‰ï¼Œå¹¶è´Ÿè´£æ”¶é›†æ‰€åœ¨æœåŠ¡å™¨çš„èµ„æº (æ¯”å¦‚ CPUã€å†…å­˜ç­‰) ä¿¡æ¯å’ŒçŠ¶æ€ï¼Œä¸ŠæŠ¥ç»™ Mesos Masterã€‚ Mesos Master é€šå¸¸é‡‡ç”¨ä¸€ä¸»ä¸¤å¤‡çš„æ–¹å¼ï¼Œä»¥æ–¹ä¾¿æ•…éšœå¤„ç†å’Œæ¢å¤ã€‚è€Œ Mesos Master çš„é€‰ä¸»ç­–ç•¥ï¼Œé‡‡ç”¨çš„å°±æ˜¯ ZAB ç®—æ³•ã€‚ Mesos æ¶æ„ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š å¦‚ä¸Šæ‰€è¿°ï¼ŒMesos å¯¹æ¥çš„æ˜¯æ¡†æ¶ï¼Œå¹¶ä¸”å¯ä»¥åŒæ—¶å¯¹æ¥å¤šä¸ªæ¡†æ¶ï¼Œç›®å‰å·²ç»è¢«å¾ˆå¤šå…¬å¸ä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œå›½å¤–çš„ Twitterã€Appleã€Airbnbã€Uber ç­‰ï¼Œå›½å†…çš„çˆ±å¥‡è‰ºã€å»å“ªå„¿ã€æºç¨‹ã€å½“å½“ç­‰ã€‚ è¿™äº›å…¬å¸é€‰æ‹© Mesosï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒå…·æœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼š æ•ˆç‡ã€‚Mesos å¯¹ç‰©ç†èµ„æºè¿›è¡Œäº†é€»è¾‘æŠ½è±¡ï¼Œåœ¨åº”ç”¨å±‚è€Œä¸æ˜¯ç‰©ç†å±‚åˆ†é…èµ„æºï¼Œé€šè¿‡å®¹å™¨è€Œä¸æ˜¯è™šæ‹Ÿæœºï¼ˆVMï¼‰åˆ†é…ä»»åŠ¡ã€‚å› ä¸ºåº”ç”¨ç¨‹åºçš„è°ƒåº¦å™¨çŸ¥é“å¦‚ä½•æœ€æœ‰æ•ˆåœ°åˆ©ç”¨èµ„æºï¼Œæ‰€ä»¥åœ¨åº”ç”¨å±‚åˆ†é…èµ„æºèƒ½å¤Ÿä¸ºæ¯ä¸ªåº”ç”¨ç¨‹åºçš„ç‰¹æ®Šéœ€æ±‚åšè€ƒé‡ ; è€Œé€šè¿‡å®¹å™¨åˆ†é…ä»»åŠ¡åˆ™èƒ½æ›´å¥½åœ°è¿›è¡Œâ€œè£…ç®±â€ã€‚ å¯æ‰©å±•æ€§ã€‚Mesos å¯æ‰©å±•è®¾è®¡çš„å…³é”®æ˜¯ä¸¤çº§è°ƒåº¦æ¶æ„ï¼Œå…¶ä¸­ Framework è¿›è¡Œä»»åŠ¡è°ƒåº¦ï¼ŒMesos Master è¿›è¡Œèµ„æºåˆ†é…ã€‚ç”±äº Master ä¸å¿…çŸ¥é“æ¯ç§ç±»å‹çš„åº”ç”¨ç¨‹åºèƒŒåå¤æ‚çš„è°ƒåº¦é€»è¾‘ï¼Œä¸å¿…ä¸ºæ¯ä¸ªä»»åŠ¡åšè°ƒåº¦ï¼Œå› æ­¤å¯ä»¥ç”¨éå¸¸è½»é‡çº§çš„ä»£ç å®ç°ï¼Œæ›´æ˜“äºæ‰©å±•é›†ç¾¤è§„æ¨¡ã€‚ æ¨¡å—åŒ–ã€‚æ¯æ¥å…¥ä¸€ç§æ–°çš„æ¡†æ¶ï¼ŒMaster æ— éœ€å¢åŠ æ–°çš„ä»£ç ï¼Œå¹¶ä¸” Agent æ¨¡å—å¯ä»¥å¤ç”¨ï¼Œä¸ºæ­¤å¼€å‘è€…å¯ä»¥ä¸“æ³¨äºåº”ç”¨å’Œæ¡†æ¶çš„é€‰æ‹©ã€‚è¿™ï¼Œå°±ä½¿å¾— Mesos å¯ä»¥æ”¯æŒå¤šç§æ¡†æ¶ï¼Œé€‚åº”ä¸åŒçš„åº”ç”¨åœºæ™¯ã€‚ éšç€åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºå’Œå¾®æœåŠ¡çš„æµè¡Œï¼Œè¶Šæ¥è¶Šå¤šçš„ç”¨æˆ·æ­£åœ¨å¯»æ‰¾ä¸€ç§æŠ€æœ¯ï¼Œæ¥å¸®åŠ©ä»–ä»¬ç®¡ç†è¿™äº›å¤æ‚çš„åº”ç”¨ç¨‹åºã€‚è€Œ Mesos ä¸ºæ•°æ®ä¸­å¿ƒå¸¦æ¥çš„è¿™äº›å¥½å¤„ï¼Œå°±ä½¿å¾—è¶Šæ¥è¶Šå¤šçš„äººå…³æ³¨ Mesos åŠå…¶ç›¸å…³é¡¹ç›®ã€‚ å¼•ç”³: çŸ¥è¯†æ‰©å±•ï¼šMesos æ˜¯å¦‚ä½•æ”¯æŒå®¹å™¨éƒ¨ç½²çš„ï¼ŸMesos æœ¬èº«åªè´Ÿè´£èµ„æºç®¡ç†ï¼Œä¸è´Ÿè´£ä»»åŠ¡è°ƒåº¦ã€‚ä½† Mesos å¯ä»¥å¯¹æ¥ä¸åŒçš„æ¡†æ¶ï¼ŒMesos+Marathon å¯ä»¥æ”¯æŒå®¹å™¨è°ƒåº¦å’Œéƒ¨ç½²ã€‚Marathon æ”¯æŒå®¹å™¨çš„è°ƒåº¦ï¼Œå°†å®¹å™¨éƒ¨ç½²è¯·æ±‚å‘ç»™ Mesos Masterï¼ŒMesos Master å†å°†è¯·æ±‚è½¬å‘ç»™ Mesos Agentï¼ŒMesos Agent çš„æ‰§è¡Œå™¨ä¼šå°†å®¹å™¨æ‹‰èµ·ã€‚ ç›®å‰ï¼ŒMesos+Marathon æ”¯æŒçš„å®¹å™¨ï¼Œä¸»è¦åŒ…æ‹¬ Docker å’Œ cgroupsã€‚","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜å¹¶å‘ç³»ç»Ÿ","url":"/2024/12/31/å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜å¹¶å‘ç³»ç»Ÿ/","content":"é«˜å¹¶å‘æ¶æ„è®¾è®¡éƒ½æœ‰å“ªäº›å…³é”®ç‚¹ï¼Ÿç§’æ€å…¶å®ä¸»è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæ˜¯å¹¶å‘è¯»ï¼Œä¸€ä¸ªæ˜¯å¹¶å‘å†™ å…¶å®ï¼Œç§’æ€çš„æ•´ä½“æ¶æ„å¯ä»¥æ¦‚æ‹¬ä¸ºâ€œç¨³ã€å‡†ã€å¿«â€å‡ ä¸ªå…³é”®å­— ç„¶åå°±æ˜¯â€œå‡†â€ï¼Œå°±æ˜¯ç§’æ€ 10 å° iPhoneï¼Œé‚£å°±åªèƒ½æˆäº¤ 10 å°ï¼Œå¤šä¸€å°å°‘ä¸€å°éƒ½ä¸è¡Œã€‚ä¸€æ—¦åº“å­˜ä¸å¯¹ï¼Œé‚£å¹³å°å°±è¦æ‰¿æ‹…æŸå¤±ï¼Œæ‰€ä»¥â€œå‡†â€å°±æ˜¯è¦æ±‚ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚ æœ€åå†çœ‹â€œå¿«â€ï¼Œâ€œå¿«â€å…¶å®å¾ˆå¥½ç†è§£ï¼Œå®ƒå°±æ˜¯è¯´ç³»ç»Ÿçš„æ€§èƒ½è¦è¶³å¤Ÿé«˜ï¼Œå¦åˆ™ä½ æ€ä¹ˆæ”¯æ’‘è¿™ä¹ˆå¤§çš„æµé‡å‘¢ï¼Ÿä¸å…‰æ˜¯æœåŠ¡ç«¯è¦åšæè‡´çš„æ€§èƒ½ä¼˜åŒ–ï¼Œè€Œä¸”åœ¨æ•´ä¸ªè¯·æ±‚é“¾è·¯ä¸Šéƒ½è¦åšååŒçš„ä¼˜åŒ–ï¼Œæ¯ä¸ªåœ°æ–¹å¿«ä¸€ç‚¹ï¼Œæ•´ä¸ªç³»ç»Ÿå°±å®Œç¾äº†ã€‚ æ‰€ä»¥ä»æŠ€æœ¯è§’åº¦ä¸Šçœ‹â€œç¨³ã€å‡†ã€å¿«â€ï¼Œå°±å¯¹åº”äº†æˆ‘ä»¬æ¶æ„ä¸Šçš„é«˜å¯ç”¨ã€ä¸€è‡´æ€§å’Œé«˜æ€§èƒ½çš„è¦æ±‚ï¼Œæˆ‘ä»¬çš„ä¸“æ ä¹Ÿå°†ä¸»è¦å›´ç»•è¿™å‡ ä¸ªæ–¹é¢æ¥å±•å¼€ï¼Œå…·ä½“å¦‚ä¸‹ã€‚ é«˜æ€§èƒ½ã€‚ ç§’æ€æ¶‰åŠå¤§é‡çš„å¹¶å‘è¯»å’Œå¹¶å‘å†™ï¼Œå› æ­¤æ”¯æŒé«˜å¹¶å‘è®¿é—®è¿™ç‚¹éå¸¸å…³é”®ã€‚æœ¬ä¸“æ å°†ä»è®¾è®¡æ•°æ®çš„åŠ¨é™åˆ†ç¦»æ–¹æ¡ˆã€çƒ­ç‚¹çš„å‘ç°ä¸éš”ç¦»ã€è¯·æ±‚çš„å‰Šå³°ä¸åˆ†å±‚è¿‡æ»¤ã€æœåŠ¡ç«¯çš„æè‡´ä¼˜åŒ–è¿™ 4 ä¸ªæ–¹é¢é‡ç‚¹ä»‹ç»ã€‚ ä¸€è‡´æ€§ã€‚ ç§’æ€ä¸­å•†å“å‡åº“å­˜çš„å®ç°æ–¹å¼åŒæ ·å…³é”®ã€‚å¯æƒ³è€ŒçŸ¥ï¼Œæœ‰é™æ•°é‡çš„å•†å“åœ¨åŒä¸€æ—¶åˆ»è¢«å¾ˆå¤šå€çš„è¯·æ±‚åŒæ—¶æ¥å‡åº“å­˜ï¼Œå‡åº“å­˜åˆåˆ†ä¸ºâ€œæ‹ä¸‹å‡åº“å­˜â€â€œä»˜æ¬¾å‡åº“å­˜â€ä»¥åŠé¢„æ‰£ç­‰å‡ ç§ï¼Œåœ¨å¤§å¹¶å‘æ›´æ–°çš„è¿‡ç¨‹ä¸­éƒ½è¦ä¿è¯æ•°æ®çš„å‡†ç¡®æ€§ï¼Œå…¶éš¾åº¦å¯æƒ³è€ŒçŸ¥ã€‚å› æ­¤ï¼Œæˆ‘å°†ç”¨ä¸€ç¯‡æ–‡ç« æ¥ä¸“é—¨è®²è§£å¦‚ä½•è®¾è®¡ç§’æ€å‡åº“å­˜æ–¹æ¡ˆã€‚ é«˜å¯ç”¨ã€‚ è™½ç„¶æˆ‘ä»‹ç»äº†å¾ˆå¤šæè‡´çš„ä¼˜åŒ–æ€è·¯ï¼Œä½†ç°å®ä¸­æ€»éš¾å…å‡ºç°ä¸€äº›æˆ‘ä»¬è€ƒè™‘ä¸åˆ°çš„æƒ…å†µï¼Œæ‰€ä»¥è¦ä¿è¯ç³»ç»Ÿçš„é«˜å¯ç”¨å’Œæ­£ç¡®æ€§ï¼Œæˆ‘ä»¬è¿˜è¦è®¾è®¡ä¸€ä¸ª PlanB æ¥å…œåº•ï¼Œä»¥ä¾¿åœ¨æœ€åæƒ…å†µå‘ç”Ÿæ—¶ä»ç„¶èƒ½å¤Ÿä»å®¹åº”å¯¹ã€‚ä¸“æ çš„æœ€åï¼Œæˆ‘å°†å¸¦ä½ æ€è€ƒå¯ä»¥ä»å“ªäº›ç¯èŠ‚æ¥è®¾è®¡å…œåº•æ–¹æ¡ˆã€‚ è®¾è®¡é«˜å¹¶å‘ç³»ç»Ÿæ—¶åº”è¯¥æ³¨æ„çš„5ä¸ªæ¶æ„åŸåˆ™ é«˜å¹¶å‘ç³»ç»Ÿæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ»¡è¶³å¤§å¹¶å‘ã€é«˜æ€§èƒ½å’Œé«˜å¯ç”¨çš„åˆ†å¸ƒå¼ç³»ç»Ÿ è®¾è®¡åŸåˆ™æ•°æ®æ“ä½œè¦å°½é‡å°‘ è¯·æ±‚çš„æ•°æ®èƒ½å°‘å°±å°‘ã€‚è¯·æ±‚çš„æ•°æ®åŒ…æ‹¬ä¸Šä¼ ç»™ç³»ç»Ÿçš„æ•°æ®å’Œç³»ç»Ÿè¿”å›ç»™ç”¨æˆ·çš„æ•°æ® è¿”å›çš„æ•°æ®èƒ½å°‘å°±å°‘, å‡å°‘åç«¯åºåˆ—åŒ–çš„æ—¶é—´ æ•°æ®åº“æ“ä½œèƒ½å°‘å°±å°‘ , è¿™ä¸ªå°±ä¸è¯´äº† è¯·æ±‚æ•°è¦å°½é‡å°‘è¿™ä¸ªå°±å¾ˆç›´è§‚äº† , è¯·æ±‚æ•°å°‘å¹¶å‘é‡å°±å°‘ è°ƒç”¨é“¾è·¯è¦å°½é‡çŸ­é«˜å¹¶å‘ç³»ç»Ÿ 1. è¦é™ä½ç³»ç»Ÿä¾èµ– , é˜²æ­¢å› ä¸ºä¾èµ–é€ æˆçš„å„ç§é—®é¢˜ , æé«˜å¯ç”¨æ€§ 2. é™ä½æµé‡å…¥ä¾µ , å¤§æµé‡å°½é‡éš”ç»åœ¨å¤–é¢ ä¸è¦æœ‰å•ç‚¹ç³»ç»Ÿä¸­çš„å•ç‚¹å¯ä»¥è¯´æ˜¯ç³»ç»Ÿæ¶æ„ä¸Šçš„ä¸€ä¸ªå¤§å¿Œï¼Œå› ä¸ºå•ç‚¹æ„å‘³ç€æ²¡æœ‰å¤‡ä»½ï¼Œé£é™©ä¸å¯æ§ , å…¶æ¬¡æµé‡ä¸èƒ½åˆ†å‘åƒredisè¿™ç§ä¼šæœ‰çƒ­ç‚¹æ•°æ®é—®é¢˜ ä¸€äº›åŸºæœ¬æ¡ˆä¾‹å…¶å®æ„å»ºä¸€ä¸ªé«˜å¹¶å‘ç³»ç»Ÿå¹¶æ²¡æœ‰é‚£ä¹ˆå¤æ‚ , æœ‰ä¸€ä¸‹çš„å‡ ä¸ªæ–¹æ³•å¯ä»¥æ‰›ä½æ¯”è¾ƒé«˜çš„å¹¶å‘ æŠŠé«˜å¹¶å‘ç³»ç»Ÿç‹¬ç«‹å‡ºæ¥å•ç‹¬æ‰“é€ ä¸€ä¸ªç³»ç»Ÿï¼Œè¿™æ ·å¯ä»¥æœ‰é’ˆå¯¹æ€§åœ°åšä¼˜åŒ–ï¼Œä¾‹å¦‚è¿™ä¸ªç‹¬ç«‹å‡ºæ¥çš„ç³»ç»Ÿå°±å‡å°‘äº†åº—é“ºè£…ä¿®çš„åŠŸèƒ½ï¼Œå‡å°‘äº†é¡µé¢çš„å¤æ‚åº¦ åœ¨ç³»ç»Ÿéƒ¨ç½²ä¸Šä¹Ÿç‹¬ç«‹åšä¸€ä¸ªæœºå™¨é›†ç¾¤ï¼Œè¿™æ ·ç§’æ€çš„å¤§æµé‡å°±ä¸ä¼šå½±å“åˆ°æ­£å¸¸çš„å•†å“è´­ä¹°é›†ç¾¤çš„æœºå™¨è´Ÿè½½ å°†çƒ­ç‚¹æ•°æ®ï¼ˆå¦‚åº“å­˜æ•°æ®ï¼‰å•ç‹¬æ”¾åˆ°ä¸€ä¸ªç¼“å­˜ç³»ç»Ÿä¸­ï¼Œä»¥æé«˜â€œè¯»æ€§èƒ½â€ å¢åŠ ç§’æ€ç­”é¢˜ï¼Œé˜²æ­¢æœ‰ç§’æ€å™¨æŠ¢å• ä¸€äº›æ•°æ®æ”¾å…¥cdnä¸­è¿›è¡Œç¼“å­˜ ä½¿ç”¨æœ¬åœ°ç¼“å­˜éƒ¨åˆ†æ•°æ® å¯¹ç”µå•†æ¥è¯´ç³»ç»Ÿå·®ä¸å¤šæ˜¯è¿™ç§æ ·å­ : é«˜å¹¶å‘ç³»ç»Ÿåœºæ™¯ä¼˜åŒ–1 - åŠ¨é™åˆ†ç¦»æ‰€è°“åŠ¨é™åˆ†ç¦» , å°±æ˜¯å°†ä¸€äº›ä¸å¸¸å˜åŒ– , å¯ä»¥é™æ€åŒ– , æ— çŠ¶æ€ , ä¸éœ€è¦é€»è¾‘å¤„ç†çš„ä¸€äº›å­—æ®µæ”¾åœ¨ä¸€ä¸ªä¸“é—¨çš„ç³»ç»Ÿæˆ–è€…åœ°æ–¹ , è·å–çš„æ—¶å€™ä¸éœ€è¦èµ°åç«¯ç³»ç»Ÿçš„æ–¹æ³• åŠ¨é™åˆ†ç¦»åŸåˆ™1. æŠŠé™æ€æ•°æ®ç¼“å­˜åˆ°ç¦»ç”¨æˆ·æœ€è¿‘çš„åœ°æ–¹å¸¸è§çš„å°±ä¸‰ç§ , ç”¨æˆ·æµè§ˆå™¨é‡Œã€CDN ä¸Š æˆ–è€… åœ¨æœåŠ¡ç«¯çš„ Cache ä¸­ 2. ç¼“å­˜httpé“¾æ¥ä¿¡æ¯å‡å°‘è§£æè¿‡ç¨‹Web ä»£ç†æœåŠ¡å™¨æ ¹æ®è¯·æ±‚URLæŸ¥æ‰¾ç¼“å­˜,ç›´æ¥å–å‡ºå¯¹åº”çš„ HTTP å“åº”å¤´å’Œå“åº”ä½“ç„¶åç›´æ¥è¿”å›ï¼Œè¿™ä¸ªå“åº”è¿‡ç¨‹ç®€å•å¾—è¿ HTTP åè®®éƒ½ä¸ç”¨é‡æ–°ç»„è£…ï¼Œç”šè‡³è¿ HTTP è¯·æ±‚å¤´ä¹Ÿä¸éœ€è¦è§£æ å¦‚ä½•åŠ¨é™åˆ†ç¦»æ”¹é€ é™æ€æ•°æ®å¤„ç†æ–¹æ³• URL å”¯ä¸€åŒ– : ä¸ºå•¥è¦ URL å”¯ä¸€å‘¢ï¼Ÿå‰é¢è¯´äº†æˆ‘ä»¬æ˜¯è¦ç¼“å­˜æ•´ä¸ª HTTP è¿æ¥ï¼Œé‚£ä¹ˆä»¥ä»€ä¹ˆä½œä¸º Key å‘¢ï¼Ÿå°±ä»¥ URL ä½œä¸ºç¼“å­˜çš„ Keyï¼Œä¾‹å¦‚ä»¥ id&#x3D;xxx è¿™ä¸ªæ ¼å¼è¿›è¡ŒåŒºåˆ† åˆ†ç¦»æµè§ˆè€…ç›¸å…³çš„å› ç´ ã€‚æµè§ˆè€…ç›¸å…³çš„å› ç´ åŒ…æ‹¬æ˜¯å¦å·²ç™»å½•ï¼Œä»¥åŠç™»å½•èº«ä»½ç­‰ï¼Œè¿™äº›ç›¸å…³å› ç´ æˆ‘ä»¬å¯ä»¥å•ç‹¬æ‹†åˆ†å‡ºæ¥ï¼Œé€šè¿‡åŠ¨æ€è¯·æ±‚æ¥è·å– åˆ†ç¦»æ—¶é—´å› ç´ ã€‚æœåŠ¡ç«¯è¾“å‡ºçš„æ—¶é—´ä¹Ÿé€šè¿‡åŠ¨æ€è¯·æ±‚è·å–ã€‚ å¼‚æ­¥åŒ–åœ°åŸŸå› ç´ ã€‚è¯¦æƒ…é¡µé¢ä¸Šä¸åœ°åŸŸç›¸å…³çš„å› ç´ åšæˆå¼‚æ­¥æ–¹å¼è·å–ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡åŠ¨æ€è¯·æ±‚æ–¹å¼è·å–ï¼Œåªæ˜¯è¿™é‡Œé€šè¿‡å¼‚æ­¥è·å–æ›´åˆé€‚ã€‚ å»æ‰ Cookieã€‚æœåŠ¡ç«¯è¾“å‡ºçš„é¡µé¢åŒ…å«çš„ Cookie å¯ä»¥é€šè¿‡ä»£ç è½¯ä»¶æ¥åˆ é™¤ï¼Œå¦‚ Web æœåŠ¡å™¨ Varnish å¯ä»¥é€šè¿‡ unset req.http.cookie å‘½ä»¤å»æ‰ Cookieã€‚æ³¨æ„ï¼Œè¿™é‡Œè¯´çš„å»æ‰ Cookie å¹¶ä¸æ˜¯ç”¨æˆ·ç«¯æ”¶åˆ°çš„é¡µé¢å°±ä¸å« Cookie äº†ï¼Œè€Œæ˜¯è¯´ï¼Œåœ¨ç¼“å­˜çš„é™æ€æ•°æ®ä¸­ä¸å«æœ‰ Cookie åŠ¨æ€æ•°æ®å¤„ç†æ–¹æ³•è¿™ä¸ªæ²¡æœ‰ä»€ä¹ˆå¥½åŠæ³• , åŠ¨æ€æ•°æ®ä¸€å®šä¼šå°†æµé‡æ‰“åˆ°åç«¯ , æ‰€ä»¥å°½å¯èƒ½çš„å‡å°‘è¿™éƒ¨åˆ† , å¦‚æœä¸è¡Œå°±åŠ æœºå™¨ åŠ¨é™åˆ†ç¦»çš„å‡ ç§æ¶æ„æ–¹æ¡ˆæœ‰ 3 ç§æ–¹æ¡ˆå¯é€‰ï¼š å•æœºæœ¬åœ°cacheå±‚ ç»Ÿä¸€ Cache å±‚ ä¸Š CDNã€‚ 1. å•æœºæœ¬åœ°cacheå±‚å°±æ˜¯ä½¿ç”¨å†…å­˜ç¼“å­˜æ¯”å¦‚javaçš„ehcacheç­‰ ä¼˜ç‚¹ ç¼ºç‚¹ æ— ç½‘ç»œå¼€é”€ å ç”¨å†…å­˜å¤§ ä½¿ç”¨ç®€å• åŒæ­¥æœºåˆ¶éœ€è¦ä½¿ç”¨å…¶ä»–æ–¹æ³•ä¿è¯ ç»Ÿä¸€ Cache å±‚å…¸å‹çš„å°±æ˜¯redisé›†ç¾¤ ä¼˜ç‚¹ ç¼ºç‚¹ StartFragmentå•ç‹¬ä¸€ä¸ª Cache å±‚ï¼Œå¯ä»¥å‡å°‘å¤šä¸ªåº”ç”¨æ¥å…¥æ—¶ä½¿ç”¨ Cache çš„æˆæœ¬ã€‚è¿™æ ·æ¥å…¥çš„åº”ç”¨åªè¦ç»´æŠ¤è‡ªå·±çš„ Java ç³»ç»Ÿå°±å¥½ï¼Œä¸éœ€è¦å•ç‹¬ç»´æŠ¤ Cacheï¼Œè€Œåªå…³å¿ƒå¦‚ä½•ä½¿ç”¨å³å¯ EndFragment StartFragmentCache å±‚å†…éƒ¨äº¤æ¢ç½‘ç»œæˆä¸ºç“¶é¢ˆ EndFragment StartFragmentç»Ÿä¸€ Cache çš„æ–¹æ¡ˆæ›´æ˜“äºç»´æŠ¤ï¼Œå¦‚åé¢åŠ å¼ºç›‘æ§ã€é…ç½®çš„è‡ªåŠ¨åŒ–ï¼Œåªéœ€è¦ä¸€å¥—è§£å†³æ–¹æ¡ˆå°±è¡Œï¼Œç»Ÿä¸€èµ·æ¥ç»´æŠ¤å‡çº§ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ã€‚ EndFragment StartFragmentç¼“å­˜æœåŠ¡å™¨çš„ç½‘å¡ä¹Ÿä¼šæ˜¯ç“¶é¢ˆï¼› EndFragment StartFragmentå¯ä»¥å…±äº«å†…å­˜ï¼Œæœ€å¤§åŒ–åˆ©ç”¨å†…å­˜ï¼Œä¸åŒç³»ç»Ÿä¹‹é—´çš„å†…å­˜å¯ä»¥åŠ¨æ€åˆ‡æ¢ï¼Œä»è€Œèƒ½å¤Ÿæœ‰æ•ˆåº”å¯¹å„ç§æ”»å‡»ã€‚ EndFragment StartFragmentæœºå™¨å°‘é£é™©è¾ƒå¤§ï¼ŒæŒ‚æ‰ä¸€å°å°±ä¼šå½±å“å¾ˆå¤§ä¸€éƒ¨åˆ†ç¼“å­˜æ•°æ®ã€‚ EndFragment è¦è§£å†³ä¸Šé¢è¿™äº›é—®é¢˜ï¼Œå¯ä»¥å†å¯¹ Cache åš Hash åˆ†ç»„ï¼Œå³ä¸€ç»„ Cache ç¼“å­˜çš„å†…å®¹ç›¸åŒï¼Œè¿™æ ·èƒ½å¤Ÿé¿å…çƒ­ç‚¹æ•°æ®è¿‡åº¦é›†ä¸­å¯¼è‡´æ–°çš„ç“¶é¢ˆäº§ç”Ÿã€‚ æ¯”å¦‚redis çƒ­ç‚¹æ•°æ®åˆ†ç»„ ä¸Š CDNåœ¨å°†æ•´ä¸ªç³»ç»ŸåšåŠ¨é™åˆ†ç¦»åï¼Œæˆ‘ä»¬è‡ªç„¶ä¼šæƒ³åˆ°æ›´è¿›ä¸€æ­¥çš„æ–¹æ¡ˆï¼Œå°±æ˜¯å°† Cache è¿›ä¸€æ­¥å‰ç§»åˆ° CDN ä¸Šï¼Œå› ä¸º CDN ç¦»ç”¨æˆ·æœ€è¿‘ï¼Œæ•ˆæœä¼šæ›´å¥½ æœ‰ä»¥ä¸‹å‡ ä¸ªé—®é¢˜éœ€è¦è§£å†³ å¤±æ•ˆé—®é¢˜ã€‚å‰é¢æˆ‘ä»¬ä¹Ÿæœ‰æåˆ°è¿‡ç¼“å­˜æ—¶æ•ˆçš„é—®é¢˜ï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰ç†è§£ï¼Œæˆ‘å†æ¥è§£é‡Šä¸€ä¸‹ã€‚è°ˆåˆ°é™æ€æ•°æ®æ—¶ï¼Œæˆ‘è¯´è¿‡ä¸€ä¸ªå…³é”®è¯å«â€œç›¸å¯¹ä¸å˜â€ï¼Œå®ƒçš„è¨€å¤–ä¹‹æ„æ˜¯â€œå¯èƒ½ä¼šå˜åŒ–â€ã€‚æ¯”å¦‚ä¸€ç¯‡æ–‡ç« ï¼Œç°åœ¨ä¸å˜ï¼Œä½†å¦‚æœä½ å‘ç°ä¸ªé”™åˆ«å­—ï¼Œæ˜¯ä¸æ˜¯å°±ä¼šå˜åŒ–äº†ï¼Ÿå¦‚æœä½ çš„ç¼“å­˜æ—¶æ•ˆå¾ˆé•¿ï¼Œé‚£ç”¨æˆ·ç«¯åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…çœ‹åˆ°çš„éƒ½æ˜¯é”™çš„ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªæ–¹æ¡ˆä¸­ä¹Ÿæ˜¯ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯ CDN å¯ä»¥åœ¨ç§’çº§æ—¶é—´å†…ï¼Œè®©åˆ†å¸ƒåœ¨å…¨å›½å„åœ°çš„ Cache åŒæ—¶å¤±æ•ˆï¼Œè¿™å¯¹ CDN çš„å¤±æ•ˆç³»ç»Ÿè¦æ±‚å¾ˆé«˜ å‘½ä¸­ç‡é—®é¢˜ã€‚Cache æœ€é‡è¦çš„ä¸€ä¸ªè¡¡é‡æŒ‡æ ‡å°±æ˜¯â€œé«˜å‘½ä¸­ç‡â€ï¼Œä¸ç„¶ Cache çš„å­˜åœ¨å°±å¤±å»äº†æ„ä¹‰ã€‚åŒæ ·ï¼Œå¦‚æœå°†æ•°æ®å…¨éƒ¨æ”¾åˆ°å…¨å›½çš„ CDN ä¸Šï¼Œå¿…ç„¶å¯¼è‡´ Cache åˆ†æ•£ï¼Œè€Œ Cache åˆ†æ•£åˆä¼šå¯¼è‡´è®¿é—®è¯·æ±‚å‘½ä¸­åŒä¸€ä¸ª Cache çš„å¯èƒ½æ€§é™ä½ï¼Œé‚£ä¹ˆå‘½ä¸­ç‡å°±æˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚ å‘å¸ƒæ›´æ–°é—®é¢˜ã€‚å¦‚æœä¸€ä¸ªä¸šåŠ¡ç³»ç»Ÿæ¯å‘¨éƒ½æœ‰æ—¥å¸¸ä¸šåŠ¡éœ€è¦å‘å¸ƒï¼Œé‚£ä¹ˆå‘å¸ƒç³»ç»Ÿå¿…é¡»è¶³å¤Ÿç®€æ´é«˜æ•ˆï¼Œè€Œä¸”ä½ è¿˜è¦è€ƒè™‘æœ‰é—®é¢˜æ—¶å¿«é€Ÿå›æ»šå’Œæ’æŸ¥é—®é¢˜çš„ç®€ä¾¿æ€§ã€‚ å› ä¸ºä¸Šé¢çš„è¿™äº›é—®é¢˜ , æ‰€ä»¥cdnçš„éƒ¨ç½²æ–¹æ³•ä¸€èˆ¬éƒ½æ˜¯åˆ†ç½‘ç»œåˆ†åŒºåŸŸçš„ä¸­å¿ƒåŒ–éƒ¨ç½² é«˜å¹¶å‘ç³»ç»Ÿåœºæ™¯ä¼˜åŒ–2 - å¤„ç†çƒ­ç‚¹è¦å…³æ³¨çƒ­ç‚¹é¦–å…ˆï¼Œçƒ­ç‚¹è¯·æ±‚ä¼šå¤§é‡å ç”¨æœåŠ¡å™¨å¤„ç†èµ„æºï¼Œè™½ç„¶è¿™ä¸ªçƒ­ç‚¹å¯èƒ½åªå è¯·æ±‚æ€»é‡çš„äº¿åˆ†ä¹‹ä¸€ï¼Œç„¶è€Œå´å¯èƒ½æŠ¢å  90% çš„æœåŠ¡å™¨èµ„æºï¼Œå¦‚æœè¿™ä¸ªçƒ­ç‚¹è¯·æ±‚è¿˜æ˜¯æ²¡æœ‰ä»·å€¼çš„æ— æ•ˆè¯·æ±‚ï¼Œé‚£ä¹ˆå¯¹ç³»ç»Ÿèµ„æºæ¥è¯´å®Œå…¨æ˜¯æµªè´¹ã€‚ å…¶æ¬¡ï¼Œå³ä½¿è¿™äº›çƒ­ç‚¹æ˜¯æœ‰æ•ˆçš„è¯·æ±‚ï¼Œæˆ‘ä»¬ä¹Ÿè¦è¯†åˆ«å‡ºæ¥åšé’ˆå¯¹æ€§çš„ä¼˜åŒ–ï¼Œä»è€Œç”¨æ›´ä½çš„ä»£ä»·æ¥æ”¯æ’‘è¿™äº›çƒ­ç‚¹è¯·æ±‚ çƒ­ç‚¹æ“ä½œå’Œçƒ­ç‚¹æ•°æ®æ‰€è°“â€œçƒ­ç‚¹æ“ä½œâ€ï¼Œä¾‹å¦‚å¤§é‡çš„åˆ·æ–°é¡µé¢ã€å¤§é‡çš„æ·»åŠ è´­ç‰©è½¦ã€åŒåä¸€é›¶ç‚¹å¤§é‡çš„ä¸‹å•ç­‰éƒ½å±äºæ­¤ç±»æ“ä½œã€‚å¯¹ç³»ç»Ÿæ¥è¯´ï¼Œè¿™äº›æ“ä½œå¯ä»¥æŠ½è±¡ä¸ºâ€œè¯»è¯·æ±‚â€å’Œâ€œå†™è¯·æ±‚â€ï¼Œè¿™ä¸¤ç§çƒ­ç‚¹è¯·æ±‚çš„å¤„ç†æ–¹å¼å¤§ç›¸å¾„åº­ï¼Œè¯»è¯·æ±‚çš„ä¼˜åŒ–ç©ºé—´è¦å¤§ä¸€äº›ï¼Œè€Œå†™è¯·æ±‚çš„ç“¶é¢ˆä¸€èˆ¬éƒ½åœ¨å­˜å‚¨å±‚ï¼Œä¼˜åŒ–çš„æ€è·¯å°±æ˜¯æ ¹æ® CAP ç†è®ºåšå¹³è¡¡ çƒ­ç‚¹æ•°æ®â€æ¯”è¾ƒå¥½ç†è§£ï¼Œé‚£å°±æ˜¯ç”¨æˆ·çš„çƒ­ç‚¹è¯·æ±‚å¯¹åº”çš„æ•°æ®ã€‚è€Œçƒ­ç‚¹æ•°æ®åˆåˆ†ä¸ºâ€œé™æ€çƒ­ç‚¹æ•°æ®â€å’Œâ€œåŠ¨æ€çƒ­ç‚¹æ•°æ®â€ é™æ€çƒ­ç‚¹æ•°æ®å’ŒåŠ¨æ€çƒ­ç‚¹æ•°æ®æ‰€è°“â€œé™æ€çƒ­ç‚¹æ•°æ®â€ï¼Œå°±æ˜¯èƒ½å¤Ÿæå‰é¢„æµ‹çš„çƒ­ç‚¹æ•°æ®ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å–å®¶æŠ¥åçš„æ–¹å¼æå‰ç­›é€‰å‡ºæ¥ï¼Œé€šè¿‡æŠ¥åç³»ç»Ÿå¯¹è¿™äº›çƒ­ç‚¹å•†å“è¿›è¡Œæ‰“æ ‡ã€‚å¦å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡å¤§æ•°æ®åˆ†ææ¥æå‰å‘ç°çƒ­ç‚¹å•†å“ï¼Œæ¯”å¦‚æˆ‘ä»¬åˆ†æå†å²æˆäº¤è®°å½•ã€ç”¨æˆ·çš„è´­ç‰©è½¦è®°å½•ï¼Œæ¥å‘ç°å“ªäº›å•†å“å¯èƒ½æ›´çƒ­é—¨ã€æ›´å¥½å–ï¼Œè¿™äº›éƒ½æ˜¯å¯ä»¥æå‰åˆ†æå‡ºæ¥çš„çƒ­ç‚¹ æ‰€è°“â€œåŠ¨æ€çƒ­ç‚¹æ•°æ®â€ï¼Œå°±æ˜¯ä¸èƒ½è¢«æå‰é¢„æµ‹åˆ°çš„ï¼Œç³»ç»Ÿåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¸´æ—¶äº§ç”Ÿçš„çƒ­ç‚¹ã€‚ä¾‹å¦‚ï¼Œå–å®¶åœ¨æŠ–éŸ³ä¸Šåšäº†å¹¿å‘Šï¼Œç„¶åå•†å“ä¸€ä¸‹å°±ç«äº†ï¼Œå¯¼è‡´å®ƒåœ¨çŸ­æ—¶é—´å†…è¢«å¤§é‡è´­ä¹° æˆ‘ä»¬å¦‚ä½•å¤„ç†çƒ­ç‚¹æ•°æ®å‘ç°çƒ­ç‚¹æ•°æ®çƒ­ç‚¹æ•°æ®é™æ€å‘ç°é™æ€çƒ­ç‚¹æ•°æ®å¯ä»¥é€šè¿‡å•†ä¸šæ‰‹æ®µï¼Œä¾‹å¦‚å¼ºåˆ¶è®©å–å®¶é€šè¿‡æŠ¥åå‚åŠ çš„æ–¹å¼æå‰æŠŠçƒ­ç‚¹å•†å“ç­›é€‰å‡ºæ¥ï¼Œå®ç°æ–¹å¼æ˜¯é€šè¿‡ä¸€ä¸ªè¿è¥ç³»ç»Ÿï¼ŒæŠŠå‚åŠ æ´»åŠ¨çš„å•†å“æ•°æ®è¿›è¡Œæ‰“æ ‡ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªåå°ç³»ç»Ÿå¯¹è¿™äº›çƒ­ç‚¹å•†å“è¿›è¡Œé¢„å¤„ç†ï¼Œå¦‚æå‰è¿›è¡Œç¼“å­˜ . æˆ–è€…ä½¿ç”¨æŠ€æœ¯æ‰‹æ®µæå‰é¢„æµ‹ï¼Œä¾‹å¦‚å¯¹ä¹°å®¶æ¯å¤©è®¿é—®çš„å•†å“è¿›è¡Œå¤§æ•°æ®è®¡ç®—ï¼Œç„¶åç»Ÿè®¡å‡º TOP N çš„å•†å“ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¿™äº› TOP N çš„å•†å“å°±æ˜¯çƒ­ç‚¹å•†å“ã€‚ çƒ­ç‚¹æ•°æ®åŠ¨æ€å‘ç°ä¸»è¦å¤„ç†åŠ¨æ€çƒ­ç‚¹æ•°æ®çš„ , éƒ½æ˜¯ä½¿ç”¨æŠ€æœ¯æ‰‹æ®µå®ç°çš„ æ„å»ºä¸€ä¸ªå¼‚æ­¥çš„ç³»ç»Ÿï¼Œå®ƒå¯ä»¥æ”¶é›†äº¤æ˜“é“¾è·¯ä¸Šå„ä¸ªç¯èŠ‚ä¸­çš„ä¸­é—´ä»¶äº§å“çš„çƒ­ç‚¹ Keyï¼Œå¦‚ Nginxã€ç¼“å­˜ã€RPC æœåŠ¡æ¡†æ¶ç­‰è¿™äº›ä¸­é—´ä»¶ï¼ˆä¸€äº›ä¸­é—´ä»¶äº§å“æœ¬èº«å·²ç»æœ‰çƒ­ç‚¹ç»Ÿè®¡æ¨¡å—ï¼‰ã€‚ å»ºç«‹ä¸€ä¸ªçƒ­ç‚¹ä¸ŠæŠ¥å’Œå¯ä»¥æŒ‰ç…§éœ€æ±‚è®¢é˜…çš„çƒ­ç‚¹æœåŠ¡çš„ä¸‹å‘è§„èŒƒï¼Œä¸»è¦ç›®çš„æ˜¯é€šè¿‡äº¤æ˜“é“¾è·¯ä¸Šå„ä¸ªç³»ç»Ÿï¼ˆåŒ…æ‹¬è¯¦æƒ…ã€è´­ç‰©è½¦ã€äº¤æ˜“ã€ä¼˜æƒ ã€åº“å­˜ã€ç‰©æµç­‰ï¼‰è®¿é—®çš„æ—¶é—´å·®ï¼ŒæŠŠä¸Šæ¸¸å·²ç»å‘ç°çš„çƒ­ç‚¹é€ä¼ ç»™ä¸‹æ¸¸ç³»ç»Ÿï¼Œæå‰åšå¥½ä¿æŠ¤ã€‚æ¯”å¦‚ï¼Œå¯¹äºå¤§ä¿ƒé«˜å³°æœŸï¼Œè¯¦æƒ…ç³»ç»Ÿæ˜¯æœ€æ—©çŸ¥é“çš„ï¼Œåœ¨ç»Ÿä¸€æ¥å…¥å±‚ä¸Š Nginx æ¨¡å—ç»Ÿè®¡çš„çƒ­ç‚¹ URLã€‚ å°†ä¸Šæ¸¸ç³»ç»Ÿæ”¶é›†çš„çƒ­ç‚¹æ•°æ®å‘é€åˆ°çƒ­ç‚¹æœåŠ¡å°ï¼Œç„¶åä¸‹æ¸¸ç³»ç»Ÿï¼ˆå¦‚äº¤æ˜“ç³»ç»Ÿï¼‰å°±ä¼šçŸ¥é“å“ªäº›å•†å“ä¼šè¢«é¢‘ç¹è°ƒç”¨ï¼Œç„¶ååšçƒ­ç‚¹ä¿æŠ¤ã€‚ è¿™é‡Œæˆ‘ç»™å‡ºäº†ä¸€ä¸ªå›¾ï¼Œå…¶ä¸­ç”¨æˆ·è®¿é—®å•†å“æ—¶ç»è¿‡çš„è·¯å¾„æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯ä¾èµ–å‰é¢çš„å¯¼è´­é¡µé¢ï¼ˆåŒ…æ‹¬é¦–é¡µã€æœç´¢é¡µé¢ã€å•†å“è¯¦æƒ…ã€è´­ç‰©è½¦ç­‰ï¼‰æå‰è¯†åˆ«å“ªäº›å•†å“çš„è®¿é—®é‡é«˜ï¼Œé€šè¿‡è¿™äº›ç³»ç»Ÿä¸­çš„ä¸­é—´ä»¶æ¥æ”¶é›†çƒ­ç‚¹æ•°æ®ï¼Œå¹¶è®°å½•åˆ°æ—¥å¿—ä¸­ã€‚ æˆ‘ä»¬é€šè¿‡éƒ¨ç½²åœ¨æ¯å°æœºå™¨ä¸Šçš„ Agent æŠŠæ—¥å¿—æ±‡æ€»åˆ°èšåˆå’Œåˆ†æé›†ç¾¤ä¸­ï¼Œç„¶åæŠŠç¬¦åˆä¸€å®šè§„åˆ™çš„çƒ­ç‚¹æ•°æ®ï¼Œé€šè¿‡è®¢é˜…åˆ†å‘ç³»ç»Ÿå†æ¨é€åˆ°ç›¸åº”çš„ç³»ç»Ÿä¸­ã€‚ä½ å¯ä»¥æ˜¯æŠŠçƒ­ç‚¹æ•°æ®å¡«å……åˆ° Cache ä¸­ï¼Œæˆ–è€…ç›´æ¥æ¨é€åˆ°åº”ç”¨æœåŠ¡å™¨çš„å†…å­˜ä¸­ï¼Œè¿˜å¯ä»¥å¯¹è¿™äº›æ•°æ®è¿›è¡Œæ‹¦æˆªï¼Œæ€»ä¹‹ä¸‹æ¸¸ç³»ç»Ÿå¯ä»¥è®¢é˜…è¿™äº›æ•°æ®ï¼Œç„¶åæ ¹æ®è‡ªå·±çš„éœ€æ±‚å†³å®šå¦‚ä½•å¤„ç†è¿™äº›æ•°æ®ã€‚ æ‰“é€ çƒ­ç‚¹å‘ç°ç³»ç»Ÿæ—¶ï¼Œæˆ‘æ ¹æ®ä»¥å¾€ç»éªŒæ€»ç»“äº†å‡ ç‚¹æ³¨æ„äº‹é¡¹ã€‚ è¿™ä¸ªçƒ­ç‚¹æœåŠ¡åå°æŠ“å–çƒ­ç‚¹æ•°æ®æ—¥å¿—æœ€å¥½é‡‡ç”¨å¼‚æ­¥æ–¹å¼ï¼Œå› ä¸ºâ€œå¼‚æ­¥â€ä¸€æ–¹é¢ä¾¿äºä¿è¯é€šç”¨æ€§ï¼Œå¦ä¸€æ–¹é¢åˆä¸å½±å“ä¸šåŠ¡ç³»ç»Ÿå’Œä¸­é—´ä»¶äº§å“çš„ä¸»æµç¨‹ã€‚ çƒ­ç‚¹æœåŠ¡å‘ç°å’Œä¸­é—´ä»¶è‡ªèº«çš„çƒ­ç‚¹ä¿æŠ¤æ¨¡å—å¹¶å­˜ï¼Œæ¯ä¸ªä¸­é—´ä»¶å’Œåº”ç”¨è¿˜éœ€è¦ä¿æŠ¤è‡ªå·±ã€‚çƒ­ç‚¹æœåŠ¡å°æä¾›çƒ­ç‚¹æ•°æ®çš„æ”¶é›†å’Œè®¢é˜…æœåŠ¡ï¼Œä¾¿äºæŠŠå„ä¸ªç³»ç»Ÿçš„çƒ­ç‚¹æ•°æ®é€æ˜å‡ºæ¥ã€‚ çƒ­ç‚¹å‘ç°è¦åšåˆ°æ¥è¿‘å®æ—¶ï¼ˆ3s å†…å®Œæˆçƒ­ç‚¹æ•°æ®çš„å‘ç°ï¼‰ï¼Œå› ä¸ºåªæœ‰åšåˆ°æ¥è¿‘å®æ—¶ï¼ŒåŠ¨æ€å‘ç°æ‰æœ‰æ„ä¹‰ï¼Œæ‰èƒ½å®æ—¶åœ°å¯¹ä¸‹æ¸¸ç³»ç»Ÿæä¾›ä¿æŠ¤ã€‚ å¤„ç†çƒ­ç‚¹æ•°æ®å¤„ç†çƒ­ç‚¹æ•°æ®é€šå¸¸æœ‰å‡ ç§æ€è·¯ï¼šä¸€æ˜¯ä¼˜åŒ–ï¼ŒäºŒæ˜¯é™åˆ¶ï¼Œä¸‰æ˜¯éš”ç¦»ã€‚ ä¼˜åŒ–ä¼˜åŒ–çƒ­ç‚¹æ•°æ®æœ€æœ‰æ•ˆçš„åŠæ³•å°±æ˜¯ç¼“å­˜çƒ­ç‚¹æ•°æ®ï¼Œå¦‚æœçƒ­ç‚¹æ•°æ®åšäº†åŠ¨é™åˆ†ç¦»ï¼Œé‚£ä¹ˆå¯ä»¥é•¿æœŸç¼“å­˜é™æ€æ•°æ®ã€‚ä½†æ˜¯ï¼Œç¼“å­˜çƒ­ç‚¹æ•°æ®æ›´å¤šçš„æ˜¯â€œä¸´æ—¶â€ç¼“å­˜ï¼Œå³ä¸ç®¡æ˜¯é™æ€æ•°æ®è¿˜æ˜¯åŠ¨æ€æ•°æ®ï¼Œéƒ½ç”¨ä¸€ä¸ªé˜Ÿåˆ—çŸ­æš‚åœ°ç¼“å­˜æ•°ç§’é’Ÿï¼Œç”±äºé˜Ÿåˆ—é•¿åº¦æœ‰é™ï¼Œå¯ä»¥é‡‡ç”¨ LRU æ·˜æ±°ç®—æ³•æ›¿æ¢ã€‚ é™åˆ¶é™åˆ¶æ›´å¤šçš„æ˜¯ä¸€ç§ä¿æŠ¤æœºåˆ¶ï¼Œé™åˆ¶çš„åŠæ³•ä¹Ÿæœ‰å¾ˆå¤šï¼Œä¾‹å¦‚å¯¹è¢«è®¿é—®å•†å“çš„ ID åšä¸€è‡´æ€§ Hashï¼Œç„¶åæ ¹æ® Hash åšåˆ†æ¡¶ï¼Œæ¯ä¸ªåˆ†æ¡¶è®¾ç½®ä¸€ä¸ªå¤„ç†é˜Ÿåˆ—ï¼Œè¿™æ ·å¯ä»¥æŠŠçƒ­ç‚¹å•†å“é™åˆ¶åœ¨ä¸€ä¸ªè¯·æ±‚é˜Ÿåˆ—é‡Œï¼Œé˜²æ­¢å› æŸäº›çƒ­ç‚¹å•†å“å ç”¨å¤ªå¤šçš„æœåŠ¡å™¨èµ„æºï¼Œè€Œä½¿å…¶ä»–è¯·æ±‚å§‹ç»ˆå¾—ä¸åˆ°æœåŠ¡å™¨çš„å¤„ç†èµ„æºã€‚ éš”ç¦»é«˜å¹¶å‘ç³»ç»Ÿè®¾è®¡çš„ç¬¬ä¸€ä¸ªåŸåˆ™å°±æ˜¯å°†è¿™ç§çƒ­ç‚¹æ•°æ®éš”ç¦»å‡ºæ¥ï¼Œä¸è¦è®© 1% çš„è¯·æ±‚å½±å“åˆ°å¦å¤–çš„ 99%ï¼Œéš”ç¦»å‡ºæ¥åä¹Ÿæ›´æ–¹ä¾¿å¯¹è¿™ 1% çš„è¯·æ±‚åšé’ˆå¯¹æ€§çš„ä¼˜åŒ–ã€‚ å…·ä½“åˆ°â€œç§’æ€â€ä¸šåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»¥ä¸‹å‡ ä¸ªå±‚æ¬¡å®ç°éš”ç¦»ã€‚ ä¸šåŠ¡éš”ç¦»ã€‚æŠŠç§’æ€åšæˆä¸€ç§è¥é”€æ´»åŠ¨ï¼Œå–å®¶è¦å‚åŠ ç§’æ€è¿™ç§è¥é”€æ´»åŠ¨éœ€è¦å•ç‹¬æŠ¥åï¼Œä»æŠ€æœ¯ä¸Šæ¥è¯´ï¼Œå–å®¶æŠ¥ååå¯¹æˆ‘ä»¬æ¥è¯´å°±æœ‰äº†å·²çŸ¥çƒ­ç‚¹ï¼Œå› æ­¤å¯ä»¥æå‰åšå¥½é¢„çƒ­ã€‚ ç³»ç»Ÿéš”ç¦»ã€‚ç³»ç»Ÿéš”ç¦»æ›´å¤šçš„æ˜¯è¿è¡Œæ—¶çš„éš”ç¦»ï¼Œå¯ä»¥é€šè¿‡åˆ†ç»„éƒ¨ç½²çš„æ–¹å¼å’Œå¦å¤– 99% åˆ†å¼€ã€‚ç§’æ€å¯ä»¥ç”³è¯·å•ç‹¬çš„åŸŸåï¼Œç›®çš„ä¹Ÿæ˜¯è®©è¯·æ±‚è½åˆ°ä¸åŒçš„é›†ç¾¤ä¸­ã€‚ æ•°æ®éš”ç¦»ã€‚ç§’æ€æ‰€è°ƒç”¨çš„æ•°æ®å¤§éƒ¨åˆ†éƒ½æ˜¯çƒ­ç‚¹æ•°æ®ï¼Œæ¯”å¦‚ä¼šå¯ç”¨å•ç‹¬çš„ Cache é›†ç¾¤æˆ–è€… MySQL æ•°æ®åº“æ¥æ”¾çƒ­ç‚¹æ•°æ®ï¼Œç›®çš„ä¹Ÿæ˜¯ä¸æƒ³ 0.01% çš„æ•°æ®æœ‰æœºä¼šå½±å“ 99.99% æ•°æ®ã€‚ å½“ç„¶äº†ï¼Œå®ç°éš”ç¦»æœ‰å¾ˆå¤šç§åŠæ³•ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥æŒ‰ç…§ç”¨æˆ·æ¥åŒºåˆ†ï¼Œç»™ä¸åŒçš„ç”¨æˆ·åˆ†é…ä¸åŒçš„ Cookieï¼Œåœ¨æ¥å…¥å±‚ï¼Œè·¯ç”±åˆ°ä¸åŒçš„æœåŠ¡æ¥å£ä¸­ï¼›å†æ¯”å¦‚ï¼Œä½ è¿˜å¯ä»¥åœ¨æ¥å…¥å±‚é’ˆå¯¹ URL ä¸­çš„ä¸åŒ Path æ¥è®¾ç½®é™æµç­–ç•¥ã€‚æœåŠ¡å±‚è°ƒç”¨ä¸åŒçš„æœåŠ¡æ¥å£ï¼Œä»¥åŠæ•°æ®å±‚é€šè¿‡ç»™æ•°æ®æ‰“æ ‡æ¥åŒºåˆ†ç­‰ç­‰è¿™äº›æªæ–½ï¼Œå…¶ç›®çš„éƒ½æ˜¯æŠŠå·²ç»è¯†åˆ«å‡ºæ¥çš„çƒ­ç‚¹è¯·æ±‚å’Œæ™®é€šçš„è¯·æ±‚åŒºåˆ†å¼€ é«˜å¹¶å‘ç³»ç»Ÿåœºæ™¯ä¼˜åŒ–3 - æµé‡å‰Šå³°ä¸ºä»€ä¹ˆè¦å‰Šå³°æˆ‘ä»¬çŸ¥é“æœåŠ¡å™¨çš„å¤„ç†èµ„æºæ˜¯æ’å®šçš„ï¼Œä½ ç”¨æˆ–è€…ä¸ç”¨å®ƒçš„å¤„ç†èƒ½åŠ›éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å‡ºç°å³°å€¼çš„è¯ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´å¿™åˆ°å¤„ç†ä¸è¿‡æ¥ï¼Œé—²çš„æ—¶å€™å´åˆæ²¡æœ‰ä»€ä¹ˆè¦å¤„ç†ã€‚ä½†æ˜¯ç”±äºè¦ä¿è¯æœåŠ¡è´¨é‡ï¼Œæˆ‘ä»¬çš„å¾ˆå¤šå¤„ç†èµ„æºåªèƒ½æŒ‰ç…§å¿™çš„æ—¶å€™æ¥é¢„ä¼°ï¼Œè€Œè¿™ä¼šå¯¼è‡´èµ„æºçš„ä¸€ä¸ªæµªè´¹ æµé‡å‰Šå³°çš„ä¸€äº›æ“ä½œæ€è·¯ï¼šæ’é˜Ÿã€ç­”é¢˜ã€åˆ†å±‚è¿‡æ»¤æ’é˜Ÿè¦å¯¹æµé‡è¿›è¡Œå‰Šå³°ï¼Œæœ€å®¹æ˜“æƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯ç”¨æ¶ˆæ¯é˜Ÿåˆ—æ¥ç¼“å†²ç¬æ—¶æµé‡ï¼ŒæŠŠåŒæ­¥çš„ç›´æ¥è°ƒç”¨è½¬æ¢æˆå¼‚æ­¥çš„é—´æ¥æ¨é€ï¼Œä¸­é—´é€šè¿‡ä¸€ä¸ªé˜Ÿåˆ—åœ¨ä¸€ç«¯æ‰¿æ¥ç¬æ—¶çš„æµé‡æ´ªå³°ï¼Œåœ¨å¦ä¸€ç«¯å¹³æ»‘åœ°å°†æ¶ˆæ¯æ¨é€å‡ºå» å¦‚æœæµé‡å³°å€¼æŒç»­ä¸€æ®µæ—¶é—´è¾¾åˆ°äº†æ¶ˆæ¯é˜Ÿåˆ—çš„å¤„ç†ä¸Šé™ï¼Œä¾‹å¦‚æœ¬æœºçš„æ¶ˆæ¯ç§¯å‹è¾¾åˆ°äº†å­˜å‚¨ç©ºé—´çš„ä¸Šé™ï¼Œæ¶ˆæ¯é˜Ÿåˆ—åŒæ ·ä¹Ÿä¼šè¢«å‹å®ï¼Œè¿™æ ·è™½ç„¶ä¿æŠ¤äº†ä¸‹æ¸¸çš„ç³»ç»Ÿï¼Œä½†æ˜¯å’Œç›´æ¥æŠŠè¯·æ±‚ä¸¢å¼ƒä¹Ÿæ²¡å¤šå¤§çš„åŒºåˆ« æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç±»ä¼¼çš„æ’é˜Ÿæ–¹å¼è¿˜æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ï¼š åˆ©ç”¨çº¿ç¨‹æ± åŠ é”ç­‰å¾…ä¹Ÿæ˜¯ä¸€ç§å¸¸ç”¨çš„æ’é˜Ÿæ–¹å¼ï¼› å…ˆè¿›å…ˆå‡ºã€å…ˆè¿›åå‡ºç­‰å¸¸ç”¨çš„å†…å­˜æ’é˜Ÿç®—æ³•çš„å®ç°æ–¹å¼ï¼› æŠŠè¯·æ±‚åºåˆ—åŒ–åˆ°æ–‡ä»¶ä¸­ï¼Œç„¶åå†é¡ºåºåœ°è¯»æ–‡ä»¶ï¼ˆä¾‹å¦‚åŸºäº MySQL binlog çš„åŒæ­¥æœºåˆ¶ï¼‰æ¥æ¢å¤è¯·æ±‚ç­‰æ–¹å¼ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œè¿™äº›æ–¹å¼éƒ½æœ‰ä¸€ä¸ªå…±åŒç‰¹å¾ï¼Œå°±æ˜¯æŠŠâ€œä¸€æ­¥çš„æ“ä½œâ€å˜æˆâ€œä¸¤æ­¥çš„æ“ä½œâ€ï¼Œå…¶ä¸­å¢åŠ çš„ä¸€æ­¥æ“ä½œç”¨æ¥èµ·åˆ°ç¼“å†²çš„ä½œç”¨ã€‚ ç­”é¢˜å¢åŠ ç­”é¢˜å…¶å®æœ‰å¾ˆå¤šç›®çš„ ç¬¬ä¸€ä¸ªç›®çš„æ˜¯é˜²æ­¢éƒ¨åˆ†ä¹°å®¶ä½¿ç”¨ç§’æ€å™¨åœ¨å‚åŠ ç§’æ€æ—¶ä½œå¼Š , è¿‡æ»¤æ— ç”¨è¯·æ±‚ å»¶ç¼“è¯·æ±‚ï¼Œèµ·åˆ°å¯¹è¯·æ±‚æµé‡è¿›è¡Œå‰Šå³°çš„ä½œç”¨ï¼Œä»è€Œè®©ç³»ç»Ÿèƒ½å¤Ÿæ›´å¥½åœ°æ”¯æŒç¬æ—¶çš„æµé‡é«˜å³° åˆ†å±‚è¿‡æ»¤å‰é¢ä»‹ç»çš„æ’é˜Ÿå’Œç­”é¢˜è¦ä¹ˆæ˜¯å°‘å‘è¯·æ±‚ï¼Œè¦ä¹ˆå¯¹å‘å‡ºæ¥çš„è¯·æ±‚è¿›è¡Œç¼“å†²ï¼Œè€Œé’ˆå¯¹ç§’æ€åœºæ™¯è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯å¯¹è¯·æ±‚è¿›è¡Œåˆ†å±‚è¿‡æ»¤ï¼Œä»è€Œè¿‡æ»¤æ‰ä¸€äº›æ— æ•ˆçš„è¯·æ±‚ã€‚åˆ†å±‚è¿‡æ»¤å…¶å®å°±æ˜¯é‡‡ç”¨â€œæ¼æ–—â€å¼è®¾è®¡æ¥å¤„ç†è¯·æ±‚çš„ å‡å¦‚è¯·æ±‚åˆ†åˆ«ç»è¿‡ CDNã€å‰å°è¯»ç³»ç»Ÿï¼ˆå¦‚å•†å“è¯¦æƒ…ç³»ç»Ÿï¼‰ã€åå°ç³»ç»Ÿï¼ˆå¦‚äº¤æ˜“ç³»ç»Ÿï¼‰å’Œæ•°æ®åº“è¿™å‡ å±‚ï¼Œé‚£ä¹ˆï¼š å¤§éƒ¨åˆ†æ•°æ®å’Œæµé‡åœ¨ç”¨æˆ·æµè§ˆå™¨æˆ–è€… CDN ä¸Šè·å–ï¼Œè¿™ä¸€å±‚å¯ä»¥æ‹¦æˆªå¤§éƒ¨åˆ†æ•°æ®çš„è¯»å–ï¼› ç»è¿‡ç¬¬äºŒå±‚ï¼ˆå³å‰å°ç³»ç»Ÿï¼‰æ—¶æ•°æ®ï¼ˆåŒ…æ‹¬å¼ºä¸€è‡´æ€§çš„æ•°æ®ï¼‰å°½é‡å¾—èµ° Cacheï¼Œè¿‡æ»¤ä¸€äº›æ— æ•ˆçš„è¯·æ±‚ï¼› å†åˆ°ç¬¬ä¸‰å±‚åå°ç³»ç»Ÿï¼Œä¸»è¦åšæ•°æ®çš„äºŒæ¬¡æ£€éªŒï¼Œå¯¹ç³»ç»Ÿåšå¥½ä¿æŠ¤å’Œé™æµï¼Œè¿™æ ·æ•°æ®é‡å’Œè¯·æ±‚å°±è¿›ä¸€æ­¥å‡å°‘ï¼› æœ€ååœ¨æ•°æ®å±‚å®Œæˆæ•°æ®çš„å¼ºä¸€è‡´æ€§æ ¡éªŒã€‚ åˆ†å±‚è¿‡æ»¤çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šåœ¨ä¸åŒçš„å±‚æ¬¡å°½å¯èƒ½åœ°è¿‡æ»¤æ‰æ— æ•ˆè¯·æ±‚ï¼Œè®©â€œæ¼æ–—â€æœ€æœ«ç«¯çš„æ‰æ˜¯æœ‰æ•ˆè¯·æ±‚ã€‚è€Œè¦è¾¾åˆ°è¿™ç§æ•ˆæœï¼Œæˆ‘ä»¬å°±å¿…é¡»å¯¹æ•°æ®åšåˆ†å±‚çš„æ ¡éªŒã€‚ åˆ†å±‚æ ¡éªŒçš„åŸºæœ¬åŸåˆ™æ˜¯ï¼š å°†åŠ¨æ€è¯·æ±‚çš„è¯»æ•°æ®ç¼“å­˜ï¼ˆCacheï¼‰åœ¨ Web ç«¯ï¼Œè¿‡æ»¤æ‰æ— æ•ˆçš„æ•°æ®è¯»ï¼› å¯¹è¯»æ•°æ®ä¸åšå¼ºä¸€è‡´æ€§æ ¡éªŒï¼Œå‡å°‘å› ä¸ºä¸€è‡´æ€§æ ¡éªŒäº§ç”Ÿç“¶é¢ˆçš„é—®é¢˜ï¼› å¯¹å†™æ•°æ®è¿›è¡ŒåŸºäºæ—¶é—´çš„åˆç†åˆ†ç‰‡ï¼Œè¿‡æ»¤æ‰è¿‡æœŸçš„å¤±æ•ˆè¯·æ±‚ï¼› å¯¹å†™è¯·æ±‚åšé™æµä¿æŠ¤ï¼Œå°†è¶…å‡ºç³»ç»Ÿæ‰¿è½½èƒ½åŠ›çš„è¯·æ±‚è¿‡æ»¤æ‰ï¼› å¯¹å†™æ•°æ®è¿›è¡Œå¼ºä¸€è‡´æ€§æ ¡éªŒï¼Œåªä¿ç•™æœ€åæœ‰æ•ˆçš„æ•°æ®ã€‚ åˆ†å±‚æ ¡éªŒçš„ç›®çš„æ˜¯ï¼šåœ¨è¯»ç³»ç»Ÿä¸­ï¼Œå°½é‡å‡å°‘ç”±äºä¸€è‡´æ€§æ ¡éªŒå¸¦æ¥çš„ç³»ç»Ÿç“¶é¢ˆï¼Œä½†æ˜¯å°½é‡å°†ä¸å½±å“æ€§èƒ½çš„æ£€æŸ¥æ¡ä»¶æå‰ï¼Œå¦‚ç”¨æˆ·æ˜¯å¦å…·æœ‰ç§’æ€èµ„æ ¼ã€å•†å“çŠ¶æ€æ˜¯å¦æ­£å¸¸ã€ç”¨æˆ·ç­”é¢˜æ˜¯å¦æ­£ç¡®ã€ç§’æ€æ˜¯å¦å·²ç»ç»“æŸã€æ˜¯å¦éæ³•è¯·æ±‚ã€è¥é”€ç­‰ä»·ç‰©æ˜¯å¦å……è¶³ç­‰ï¼›åœ¨å†™æ•°æ®ç³»ç»Ÿä¸­ï¼Œä¸»è¦å¯¹å†™çš„æ•°æ®ï¼ˆå¦‚â€œåº“å­˜â€ï¼‰åšä¸€è‡´æ€§æ£€æŸ¥ï¼Œæœ€ååœ¨æ•°æ®åº“å±‚ä¿è¯æ•°æ®çš„æœ€ç»ˆå‡†ç¡®æ€§ï¼ˆå¦‚â€œåº“å­˜â€ä¸èƒ½å‡ä¸ºè´Ÿæ•°ï¼‰ã€‚ é«˜å¹¶å‘ç³»ç»Ÿåœºæ™¯ä¼˜åŒ–4 - ç±»åº“å­˜æ‰£å‡åœºæ™¯åº“å­˜åœºæ™¯éå¸¸å…¸å‹ , æ˜¯é«˜å¹¶å‘æƒ…å†µä¸‹å¯¹æ•°æ®è¿›è¡Œè¯»å†™æ“ä½œçš„åœºæ™¯ å…ˆè¯´ä¸€ä¸‹åœºæ™¯ æ€»ç»“æ¥è¯´ï¼Œå‡åº“å­˜æ“ä½œä¸€èˆ¬æœ‰å¦‚ä¸‹å‡ ä¸ªæ–¹å¼ï¼š ä¸‹å•å‡åº“å­˜ï¼Œå³å½“ä¹°å®¶ä¸‹å•åï¼Œåœ¨å•†å“çš„æ€»åº“å­˜ä¸­å‡å»ä¹°å®¶è´­ä¹°æ•°é‡ã€‚ä¸‹å•å‡åº“å­˜æ˜¯æœ€ç®€å•çš„å‡åº“å­˜æ–¹å¼ï¼Œä¹Ÿæ˜¯æ§åˆ¶æœ€ç²¾ç¡®çš„ä¸€ç§ï¼Œä¸‹å•æ—¶ç›´æ¥é€šè¿‡æ•°æ®åº“çš„äº‹åŠ¡æœºåˆ¶æ§åˆ¶å•†å“åº“å­˜ï¼Œè¿™æ ·ä¸€å®šä¸ä¼šå‡ºç°è¶…å–çš„æƒ…å†µã€‚ä½†æ˜¯ä½ è¦çŸ¥é“ï¼Œæœ‰äº›äººä¸‹å®Œå•å¯èƒ½å¹¶ä¸ä¼šä»˜æ¬¾ã€‚ ä»˜æ¬¾å‡åº“å­˜ï¼Œå³ä¹°å®¶ä¸‹å•åï¼Œå¹¶ä¸ç«‹å³å‡åº“å­˜ï¼Œè€Œæ˜¯ç­‰åˆ°æœ‰ç”¨æˆ·ä»˜æ¬¾åæ‰çœŸæ­£å‡åº“å­˜ï¼Œå¦åˆ™åº“å­˜ä¸€ç›´ä¿ç•™ç»™å…¶ä»–ä¹°å®¶ã€‚ä½†å› ä¸ºä»˜æ¬¾æ—¶æ‰å‡åº“å­˜ï¼Œå¦‚æœå¹¶å‘æ¯”è¾ƒé«˜ï¼Œæœ‰å¯èƒ½å‡ºç°ä¹°å®¶ä¸‹å•åä»˜ä¸äº†æ¬¾çš„æƒ…å†µï¼Œå› ä¸ºå¯èƒ½å•†å“å·²ç»è¢«å…¶ä»–äººä¹°èµ°äº†ã€‚ é¢„æ‰£åº“å­˜ï¼Œè¿™ç§æ–¹å¼ç›¸å¯¹å¤æ‚ä¸€äº›ï¼Œä¹°å®¶ä¸‹å•åï¼Œåº“å­˜ä¸ºå…¶ä¿ç•™ä¸€å®šçš„æ—¶é—´ï¼ˆå¦‚ 10 åˆ†é’Ÿï¼‰ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œåº“å­˜å°†ä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œé‡Šæ”¾åå…¶ä»–ä¹°å®¶å°±å¯ä»¥ç»§ç»­è´­ä¹°ã€‚åœ¨ä¹°å®¶ä»˜æ¬¾å‰ï¼Œç³»ç»Ÿä¼šæ ¡éªŒè¯¥è®¢å•çš„åº“å­˜æ˜¯å¦è¿˜æœ‰ä¿ç•™ï¼šå¦‚æœæ²¡æœ‰ä¿ç•™ï¼Œåˆ™å†æ¬¡å°è¯•é¢„æ‰£ï¼›å¦‚æœåº“å­˜ä¸è¶³ï¼ˆä¹Ÿå°±æ˜¯é¢„æ‰£å¤±è´¥ï¼‰åˆ™ä¸å…è®¸ç»§ç»­ä»˜æ¬¾ï¼›å¦‚æœé¢„æ‰£æˆåŠŸï¼Œåˆ™å®Œæˆä»˜æ¬¾å¹¶å®é™…åœ°å‡å»åº“å­˜ã€‚ â€œä¸‹å•å‡åº“å­˜â€åœ¨æ•°æ®ä¸€è‡´æ€§ä¸Šï¼Œä¸»è¦å°±æ˜¯ä¿è¯å¤§å¹¶å‘è¯·æ±‚æ—¶åº“å­˜æ•°æ®ä¸èƒ½ä¸ºè´Ÿæ•°ï¼Œä¹Ÿå°±æ˜¯è¦ä¿è¯æ•°æ®åº“ä¸­çš„åº“å­˜å­—æ®µå€¼ä¸èƒ½ä¸ºè´Ÿæ•°ï¼Œä¸€èˆ¬æˆ‘ä»¬æœ‰å¤šç§è§£å†³æ–¹æ¡ˆ ä¸€ç§æ˜¯åœ¨åº”ç”¨ç¨‹åºä¸­é€šè¿‡äº‹åŠ¡æ¥åˆ¤æ–­ï¼Œå³ä¿è¯å‡ååº“å­˜ä¸èƒ½ä¸ºè´Ÿæ•°ï¼Œå¦åˆ™å°±å›æ»šï¼› ç›´æ¥è®¾ç½®æ•°æ®åº“çš„å­—æ®µæ•°æ®ä¸ºæ— ç¬¦å·æ•´æ•°ï¼Œè¿™æ ·å‡ååº“å­˜å­—æ®µå€¼å°äºé›¶æ—¶ä¼šç›´æ¥æ‰§è¡Œ SQL è¯­å¥æ¥æŠ¥é”™ å†æœ‰ä¸€ç§å°±æ˜¯ä½¿ç”¨ CASE WHEN åˆ¤æ–­è¯­å¥ï¼Œä¾‹å¦‚è¿™æ ·çš„ SQL è¯­å¥ï¼šUPDATE item SET inventory &#x3D; CASE WHEN inventory >&#x3D; xxx THEN inventory-xxx ELSE inventory END ç§’æ€å‡åº“å­˜çš„æè‡´ä¼˜åŒ–åœ¨äº¤æ˜“ç¯èŠ‚ä¸­ï¼Œâ€œåº“å­˜â€æ˜¯ä¸ªå…³é”®æ•°æ®ï¼Œä¹Ÿæ˜¯ä¸ªçƒ­ç‚¹æ•°æ®ï¼Œå› ä¸ºäº¤æ˜“çš„å„ä¸ªç¯èŠ‚ä¸­éƒ½å¯èƒ½æ¶‰åŠå¯¹åº“å­˜çš„æŸ¥è¯¢ã€‚ä½†æ˜¯ï¼Œæˆ‘åœ¨å‰é¢ä»‹ç»åˆ†å±‚è¿‡æ»¤æ—¶æåˆ°è¿‡ï¼Œç§’æ€ä¸­å¹¶ä¸éœ€è¦å¯¹åº“å­˜æœ‰ç²¾ç¡®çš„ä¸€è‡´æ€§è¯»ï¼ŒæŠŠåº“å­˜æ•°æ®æ”¾åˆ°ç¼“å­˜ï¼ˆCacheï¼‰ä¸­ï¼Œå¯ä»¥å¤§å¤§æå‡è¯»æ€§èƒ½ã€‚ è§£å†³å¤§å¹¶å‘è¯»é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨ LocalCacheï¼ˆå³åœ¨ç§’æ€ç³»ç»Ÿçš„å•æœºä¸Šç¼“å­˜å•†å“ç›¸å…³çš„æ•°æ®ï¼‰å’Œå¯¹æ•°æ®è¿›è¡Œåˆ†å±‚è¿‡æ»¤çš„æ–¹å¼ï¼Œä½†æ˜¯åƒå‡åº“å­˜è¿™ç§å¤§å¹¶å‘å†™æ— è®ºå¦‚ä½•è¿˜æ˜¯é¿å…ä¸äº†ï¼Œè¿™ä¹Ÿæ˜¯ç§’æ€åœºæ™¯ä¸‹æœ€ä¸ºæ ¸å¿ƒçš„ä¸€ä¸ªæŠ€æœ¯éš¾é¢˜ã€‚ å› æ­¤ï¼Œè¿™é‡Œæˆ‘æƒ³ä¸“é—¨æ¥è¯´ä¸€ä¸‹ç§’æ€åœºæ™¯ä¸‹å‡åº“å­˜çš„æè‡´ä¼˜åŒ–æ€è·¯ï¼ŒåŒ…æ‹¬å¦‚ä½•åœ¨ç¼“å­˜ä¸­å‡åº“å­˜ä»¥åŠå¦‚ä½•åœ¨æ•°æ®åº“ä¸­å‡åº“å­˜ã€‚ æ¯”å¦‚ä½¿ç”¨redis , å…¶å®æˆ‘ä»¬å¯ä»¥ä½¿ç”¨luaè„šæœ¬æ¥ä¿è¯ä¸€è‡´æ€§ ä½†æ˜¯ä½¿ç”¨redis æœ‰ä¸€å®šçš„å±€é™æ€§å¦‚æœä½ çš„ç§’æ€å•†å“çš„å‡åº“å­˜é€»è¾‘éå¸¸å•ä¸€ï¼Œæ¯”å¦‚æ²¡æœ‰å¤æ‚çš„ SKU åº“å­˜å’Œæ€»åº“å­˜è¿™ç§è”åŠ¨å…³ç³»,æˆ–è€…å¤šç»„skuåŒæ—¶æ‰£å‡çš„è¿™ç§ä¸æ¶‰åŠå¤æ‚äº‹åŠ¡çš„åœºæ™¯ï¼Œæˆ‘è§‰å¾—å®Œå…¨å¯ä»¥. å¦‚æœæ¶‰åŠåˆ°å¤šç»„æ‰£å‡ , å¦‚æœæœ‰æ¯”è¾ƒå¤æ‚çš„å‡åº“å­˜é€»è¾‘ï¼Œæˆ–è€…éœ€è¦ä½¿ç”¨äº‹åŠ¡ï¼Œè¿˜æ˜¯å»ºè®®å¿…é¡»åœ¨æ•°æ®åº“ä¸­å®Œæˆå‡åº“å­˜-> æˆ–è€…ç¼“å­˜æ”¯æŒäº‹åŠ¡ ç”±äº MySQL å­˜å‚¨æ•°æ®çš„ç‰¹ç‚¹ï¼ŒåŒä¸€æ•°æ®åœ¨æ•°æ®åº“é‡Œè‚¯å®šæ˜¯ä¸€è¡Œå­˜å‚¨ï¼ˆMySQLï¼‰ï¼Œå› æ­¤ä¼šæœ‰å¤§é‡çº¿ç¨‹æ¥ç«äº‰ InnoDB è¡Œé”ï¼Œè€Œå¹¶å‘åº¦è¶Šé«˜æ—¶ç­‰å¾…çº¿ç¨‹ä¼šè¶Šå¤šï¼ŒTPSï¼ˆTransaction Per Secondï¼Œå³æ¯ç§’å¤„ç†çš„æ¶ˆæ¯æ•°ï¼‰ä¼šä¸‹é™ï¼Œå“åº”æ—¶é—´ï¼ˆRTï¼‰ä¼šä¸Šå‡ï¼Œæ•°æ®åº“çš„ååé‡å°±ä¼šä¸¥é‡å—å½±å“ è¿™å°±å¯èƒ½å¼•å‘ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å•ä¸ªçƒ­ç‚¹å•†å“ä¼šå½±å“æ•´ä¸ªæ•°æ®åº“çš„æ€§èƒ½ï¼Œ å¯¼è‡´ 0.01% çš„å•†å“å½±å“ 99.99% çš„å•†å“çš„å”®å–ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸æ„¿æ„çœ‹åˆ°çš„æƒ…å†µã€‚ä¸€ä¸ªè§£å†³æ€è·¯æ˜¯éµå¾ªå‰é¢ä»‹ç»çš„åŸåˆ™è¿›è¡Œéš”ç¦»ï¼ŒæŠŠçƒ­ç‚¹å•†å“æ”¾åˆ°å•ç‹¬çš„çƒ­ç‚¹åº“ä¸­ã€‚ä½†æ˜¯è¿™æ— ç–‘ä¼šå¸¦æ¥ç»´æŠ¤ä¸Šçš„éº»çƒ¦ï¼Œæ¯”å¦‚è¦åšçƒ­ç‚¹æ•°æ®çš„åŠ¨æ€è¿ç§»ä»¥åŠå•ç‹¬çš„æ•°æ®åº“ç­‰ è€Œåˆ†ç¦»çƒ­ç‚¹å•†å“åˆ°å•ç‹¬çš„æ•°æ®åº“è¿˜æ˜¯æ²¡æœ‰è§£å†³å¹¶å‘é”çš„é—®é¢˜ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè¦è§£å†³å¹¶å‘é”çš„é—®é¢˜ï¼Œæœ‰ä¸¤ç§åŠæ³•ï¼š åº”ç”¨å±‚åšæ’é˜Ÿã€‚æŒ‰ç…§å•†å“ç»´åº¦è®¾ç½®é˜Ÿåˆ—é¡ºåºæ‰§è¡Œï¼Œè¿™æ ·èƒ½å‡å°‘åŒä¸€å°æœºå™¨å¯¹æ•°æ®åº“åŒä¸€è¡Œè®°å½•è¿›è¡Œæ“ä½œçš„å¹¶å‘åº¦ï¼ŒåŒæ—¶ä¹Ÿèƒ½æ§åˆ¶å•ä¸ªå•†å“å ç”¨æ•°æ®åº“è¿æ¥çš„æ•°é‡ï¼Œé˜²æ­¢çƒ­ç‚¹å•†å“å ç”¨å¤ªå¤šçš„æ•°æ®åº“è¿æ¥ã€‚ æ•°æ®åº“å±‚åšæ’é˜Ÿã€‚åº”ç”¨å±‚åªèƒ½åšåˆ°å•æœºçš„æ’é˜Ÿï¼Œä½†æ˜¯åº”ç”¨æœºå™¨æ•°æœ¬èº«å¾ˆå¤šï¼Œè¿™ç§æ’é˜Ÿæ–¹å¼æ§åˆ¶å¹¶å‘çš„èƒ½åŠ›ä»ç„¶æœ‰é™ï¼Œæ‰€ä»¥å¦‚æœèƒ½åœ¨æ•°æ®åº“å±‚åšå…¨å±€æ’é˜Ÿæ˜¯æœ€ç†æƒ³çš„ã€‚é˜¿é‡Œçš„æ•°æ®åº“å›¢é˜Ÿå¼€å‘äº†é’ˆå¯¹è¿™ç§ MySQL çš„ InnoDB å±‚ä¸Šçš„è¡¥ä¸ç¨‹åºï¼ˆpatchï¼‰ï¼Œå¯ä»¥åœ¨æ•°æ®åº“å±‚ä¸Šå¯¹å•è¡Œè®°å½•åšåˆ°å¹¶å‘æ’é˜Ÿã€‚ ä½ å¯èƒ½æœ‰ç–‘é—®äº†ï¼Œæ’é˜Ÿå’Œé”ç«äº‰ä¸éƒ½æ˜¯è¦ç­‰å¾…å—ï¼Œæœ‰å•¥åŒºåˆ«ï¼Ÿå¦‚æœç†Ÿæ‚‰ MySQL çš„è¯ï¼Œä½ ä¼šçŸ¥é“ InnoDB å†…éƒ¨çš„æ­»é”æ£€æµ‹ï¼Œä»¥åŠ MySQL Server å’Œ InnoDB çš„åˆ‡æ¢ä¼šæ¯”è¾ƒæ¶ˆè€—æ€§èƒ½ï¼Œæ·˜å®çš„ MySQL æ ¸å¿ƒå›¢é˜Ÿè¿˜åšäº†å¾ˆå¤šå…¶ä»–æ–¹é¢çš„ä¼˜åŒ–ï¼Œå¦‚ COMMIT_ON_SUCCESS å’Œ ROLLBACK_ON_FAIL çš„è¡¥ä¸ç¨‹åºï¼Œé…åˆåœ¨ SQL é‡Œé¢åŠ æç¤ºï¼ˆhintï¼‰ï¼Œåœ¨äº‹åŠ¡é‡Œä¸éœ€è¦ç­‰å¾…åº”ç”¨å±‚æäº¤ï¼ˆCOMMITï¼‰ï¼Œè€Œåœ¨æ•°æ®æ‰§è¡Œå®Œæœ€åä¸€æ¡ SQL åï¼Œç›´æ¥æ ¹æ® TARGET_AFFECT_ROW çš„ç»“æœè¿›è¡Œæäº¤æˆ–å›æ»šï¼Œå¯ä»¥å‡å°‘ç½‘ç»œç­‰å¾…æ—¶é—´ï¼ˆå¹³å‡çº¦ 0.7msï¼‰ã€‚æ®æˆ‘æ‰€çŸ¥ï¼Œç›®å‰é˜¿é‡Œ MySQL å›¢é˜Ÿå·²ç»å°†åŒ…å«è¿™äº›è¡¥ä¸ç¨‹åºçš„ MySQL å¼€æºã€‚å¦å¤–ï¼Œæ•°æ®æ›´æ–°é—®é¢˜é™¤äº†å‰é¢ä»‹ç»çš„çƒ­ç‚¹éš”ç¦»å’Œæ’é˜Ÿå¤„ç†ä¹‹å¤–ï¼Œè¿˜æœ‰äº›åœºæ™¯ï¼ˆå¦‚å¯¹å•†å“çš„ lastmodifytime å­—æ®µçš„ï¼‰æ›´æ–°ä¼šéå¸¸é¢‘ç¹ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹è¿™äº›å¤šæ¡ SQL æ˜¯å¯ä»¥åˆå¹¶çš„ï¼Œä¸€å®šæ—¶é—´å†…åªè¦æ‰§è¡Œæœ€åä¸€æ¡ SQL å°±è¡Œäº†ï¼Œä»¥ä¾¿å‡å°‘å¯¹æ•°æ®åº“çš„æ›´æ–°æ“ä½œã€‚ é«˜å¹¶å‘ç³»ç»Ÿåœºæ™¯ä¼˜åŒ–4 - å…œåº•æ–¹æ¡ˆé«˜å¹¶å‘ç³»ç»Ÿä¸ºäº†ä¿è¯ç³»ç»Ÿçš„é«˜å¯ç”¨ï¼Œæˆ‘ä»¬å¿…é¡»è®¾è®¡ä¸€ä¸ª Plan B æ–¹æ¡ˆæ¥å…œåº• é«˜å¯ç”¨å»ºè®¾åº”è¯¥ä»å“ªé‡Œç€æ‰‹è¯´åˆ°ç³»ç»Ÿçš„é«˜å¯ç”¨å»ºè®¾ï¼Œå®ƒå…¶å®æ˜¯ä¸€ä¸ªç³»ç»Ÿå·¥ç¨‹ï¼Œéœ€è¦è€ƒè™‘åˆ°ç³»ç»Ÿå»ºè®¾çš„å„ä¸ªé˜¶æ®µï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå…¶å®è´¯ç©¿äº†ç³»ç»Ÿå»ºè®¾çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å…·ä½“æ¥è¯´ï¼Œç³»ç»Ÿçš„é«˜å¯ç”¨å»ºè®¾æ¶‰åŠæ¶æ„é˜¶æ®µã€ç¼–ç é˜¶æ®µã€æµ‹è¯•é˜¶æ®µã€å‘å¸ƒé˜¶æ®µã€è¿è¡Œé˜¶æ®µï¼Œä»¥åŠæ•…éšœå‘ç”Ÿæ—¶ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ†åˆ«çœ‹ä¸€ä¸‹ã€‚ æ¶æ„é˜¶æ®µï¼šæ¶æ„é˜¶æ®µä¸»è¦è€ƒè™‘ç³»ç»Ÿçš„å¯æ‰©å±•æ€§å’Œå®¹é”™æ€§ï¼Œè¦é¿å…ç³»ç»Ÿå‡ºç°å•ç‚¹é—®é¢˜ã€‚ä¾‹å¦‚å¤šæœºæˆ¿å•å…ƒåŒ–éƒ¨ç½²ï¼Œå³ä½¿æŸä¸ªåŸå¸‚çš„æŸä¸ªæœºæˆ¿å‡ºç°æ•´ä½“æ•…éšœï¼Œä»ç„¶ä¸ä¼šå½±å“æ•´ä½“ç½‘ç«™çš„è¿è½¬ã€‚ ç¼–ç é˜¶æ®µï¼šç¼–ç æœ€é‡è¦çš„æ˜¯ä¿è¯ä»£ç çš„å¥å£®æ€§ï¼Œä¾‹å¦‚æ¶‰åŠè¿œç¨‹è°ƒç”¨é—®é¢˜æ—¶ï¼Œè¦è®¾ç½®åˆç†çš„è¶…æ—¶é€€å‡ºæœºåˆ¶ï¼Œé˜²æ­¢è¢«å…¶ä»–ç³»ç»Ÿæ‹–å®ï¼Œä¹Ÿè¦å¯¹è°ƒç”¨çš„è¿”å›ç»“æœé›†æœ‰é¢„æœŸï¼Œé˜²æ­¢è¿”å›çš„ç»“æœè¶…å‡ºç¨‹åºå¤„ç†èŒƒå›´ï¼Œæœ€å¸¸è§çš„åšæ³•å°±æ˜¯å¯¹é”™è¯¯å¼‚å¸¸è¿›è¡Œæ•è·ï¼Œå¯¹æ— æ³•é¢„æ–™çš„é”™è¯¯è¦æœ‰é»˜è®¤å¤„ç†ç»“æœã€‚ æµ‹è¯•é˜¶æ®µï¼šæµ‹è¯•ä¸»è¦æ˜¯ä¿è¯æµ‹è¯•ç”¨ä¾‹çš„è¦†ç›–åº¦ï¼Œä¿è¯æœ€åæƒ…å†µå‘ç”Ÿæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ç›¸åº”çš„å¤„ç†æµç¨‹ã€‚ å‘å¸ƒé˜¶æ®µï¼šå‘å¸ƒæ—¶ä¹Ÿæœ‰ä¸€äº›åœ°æ–¹éœ€è¦æ³¨æ„ï¼Œå› ä¸ºå‘å¸ƒæ—¶æœ€å®¹æ˜“å‡ºç°é”™è¯¯ï¼Œå› æ­¤è¦æœ‰ç´§æ€¥çš„å›æ»šæœºåˆ¶ã€‚ è¿è¡Œé˜¶æ®µï¼šè¿è¡Œæ—¶æ˜¯ç³»ç»Ÿçš„å¸¸æ€ï¼Œç³»ç»Ÿå¤§éƒ¨åˆ†æ—¶é—´éƒ½ä¼šå¤„äºè¿è¡Œæ€ï¼Œè¿è¡Œæ€æœ€é‡è¦çš„æ˜¯å¯¹ç³»ç»Ÿçš„ç›‘æ§è¦å‡†ç¡®åŠæ—¶ï¼Œå‘ç°é—®é¢˜èƒ½å¤Ÿå‡†ç¡®æŠ¥è­¦å¹¶ä¸”æŠ¥è­¦æ•°æ®è¦å‡†ç¡®è¯¦ç»†ï¼Œä»¥ä¾¿äºæ’æŸ¥é—®é¢˜ã€‚ æ•…éšœå‘ç”Ÿï¼šæ•…éšœå‘ç”Ÿæ—¶é¦–å…ˆæœ€é‡è¦çš„å°±æ˜¯åŠæ—¶æ­¢æŸï¼Œä¾‹å¦‚ç”±äºç¨‹åºé—®é¢˜å¯¼è‡´å•†å“ä»·æ ¼é”™è¯¯ï¼Œé‚£å°±è¦åŠæ—¶ä¸‹æ¶å•†å“æˆ–è€…å…³é—­è´­ä¹°é“¾æ¥ï¼Œé˜²æ­¢é€ æˆé‡å¤§èµ„äº§æŸå¤±ã€‚ç„¶åå°±æ˜¯è¦èƒ½å¤ŸåŠæ—¶æ¢å¤æœåŠ¡ï¼Œå¹¶å®šä½åŸå› è§£å†³é—®é¢˜ã€‚ ä¸ºä»€ä¹ˆç³»ç»Ÿçš„é«˜å¯ç”¨å»ºè®¾è¦æ”¾åˆ°æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­å…¨é¢è€ƒè™‘ï¼Ÿå› ä¸ºæˆ‘ä»¬åœ¨æ¯ä¸ªç¯èŠ‚ä¸­éƒ½å¯èƒ½çŠ¯é”™ï¼Œè€Œæœ‰äº›ç¯èŠ‚çŠ¯çš„é”™ï¼Œä½ åœ¨åé¢æ˜¯æ— æ³•å¼¥è¡¥çš„ã€‚ä¾‹å¦‚åœ¨æ¶æ„é˜¶æ®µï¼Œä½ æ²¡æœ‰æ¶ˆé™¤å•ç‚¹é—®é¢˜ï¼Œé‚£ä¹ˆç³»ç»Ÿä¸Šçº¿åï¼Œé‡åˆ°çªå‘æµé‡æŠŠå•ç‚¹ç»™æŒ‚äº†ï¼Œä½ å°±åªèƒ½å¹²çªçœ¼ï¼Œæœ‰æ—¶å€™æƒ³åŠ æœºå™¨éƒ½åŠ ä¸è¿›å»ã€‚æ‰€ä»¥é«˜å¯ç”¨å»ºè®¾æ˜¯ä¸€ä¸ªç³»ç»Ÿå·¥ç¨‹ï¼Œå¿…é¡»åœ¨æ¯ä¸ªç¯èŠ‚éƒ½åšå¥½ã€‚ é‚£ä¹ˆé’ˆå¯¹ç§’æ€ç³»ç»Ÿï¼Œæˆ‘ä»¬é‡ç‚¹ä»‹ç»åœ¨é‡åˆ°å¤§æµé‡æ—¶ï¼Œåº”è¯¥ä»å“ªäº›æ–¹é¢æ¥ä¿éšœç³»ç»Ÿçš„ç¨³å®šè¿è¡Œï¼Œæ‰€ä»¥æ›´å¤šçš„æ˜¯çœ‹å¦‚ä½•é’ˆå¯¹è¿è¡Œé˜¶æ®µè¿›è¡Œå¤„ç†ï¼Œè¿™å°±å¼•å‡ºäº†æ¥ä¸‹æ¥çš„å†…å®¹ï¼šé™çº§ã€é™æµå’Œæ‹’ç»æœåŠ¡ã€‚ é™çº§æ‰€è°“â€œé™çº§â€ï¼Œå°±æ˜¯å½“ç³»ç»Ÿçš„å®¹é‡è¾¾åˆ°ä¸€å®šç¨‹åº¦æ—¶ï¼Œé™åˆ¶æˆ–è€…å…³é—­ç³»ç»Ÿçš„æŸäº›éæ ¸å¿ƒåŠŸèƒ½ï¼Œä»è€ŒæŠŠæœ‰é™çš„èµ„æºä¿ç•™ç»™æ›´æ ¸å¿ƒçš„ä¸šåŠ¡ã€‚å®ƒæ˜¯ä¸€ä¸ªæœ‰ç›®çš„ã€æœ‰è®¡åˆ’çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæ‰€ä»¥å¯¹é™çº§æˆ‘ä»¬ä¸€èˆ¬éœ€è¦æœ‰ä¸€å¥—é¢„æ¡ˆæ¥é…åˆæ‰§è¡Œã€‚å¦‚æœæˆ‘ä»¬æŠŠå®ƒç³»ç»ŸåŒ–ï¼Œå°±å¯ä»¥é€šè¿‡é¢„æ¡ˆç³»ç»Ÿå’Œå¼€å…³ç³»ç»Ÿæ¥å®ç°é™çº§ã€‚ é™çº§æ–¹æ¡ˆå¯ä»¥è¿™æ ·è®¾è®¡ï¼šå½“ç§’æ€æµé‡è¾¾åˆ° 5w&#x2F;s æ—¶ï¼ŒæŠŠæˆäº¤è®°å½•çš„è·å–ä»å±•ç¤º 20 æ¡é™çº§åˆ°åªå±•ç¤º 5 æ¡ã€‚â€œä» 20 æ”¹åˆ° 5â€è¿™ä¸ªæ“ä½œç”±ä¸€ä¸ªå¼€å…³æ¥å®ç°ï¼Œä¹Ÿå°±æ˜¯è®¾ç½®ä¸€ä¸ªèƒ½å¤Ÿä»å¼€å…³ç³»ç»ŸåŠ¨æ€è·å–çš„ç³»ç»Ÿå‚æ•°ã€‚ è¿™é‡Œï¼Œæˆ‘ç»™å‡ºå¼€å…³ç³»ç»Ÿçš„ç¤ºæ„å›¾ã€‚å®ƒåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯å¼€å…³æ§åˆ¶å°ï¼Œå®ƒä¿å­˜äº†å¼€å…³çš„å…·ä½“é…ç½®ä¿¡æ¯ï¼Œä»¥åŠå…·ä½“æ‰§è¡Œå¼€å…³æ‰€å¯¹åº”çš„æœºå™¨åˆ—è¡¨ï¼›å¦ä¸€éƒ¨åˆ†æ˜¯æ‰§è¡Œä¸‹å‘å¼€å…³æ•°æ®çš„ Agentï¼Œä¸»è¦ä»»åŠ¡å°±æ˜¯ä¿è¯å¼€å…³è¢«æ­£ç¡®æ‰§è¡Œï¼Œå³ä½¿ç³»ç»Ÿé‡å¯åä¹Ÿä¼šç”Ÿæ•ˆã€‚ æ‰§è¡Œé™çº§æ— ç–‘æ˜¯åœ¨ç³»ç»Ÿæ€§èƒ½å’Œç”¨æˆ·ä½“éªŒä¹‹é—´é€‰æ‹©äº†å‰è€…ï¼Œé™çº§åè‚¯å®šä¼šå½±å“ä¸€éƒ¨åˆ†ç”¨æˆ·çš„ä½“éªŒï¼Œä¾‹å¦‚åœ¨åŒ 11 é›¶ç‚¹æ—¶ï¼Œå¦‚æœä¼˜æƒ åˆ¸ç³»ç»Ÿæ‰›ä¸ä½ï¼Œå¯èƒ½ä¼šä¸´æ—¶é™çº§å•†å“è¯¦æƒ…çš„ä¼˜æƒ ä¿¡æ¯å±•ç¤ºï¼ŒæŠŠæœ‰é™çš„ç³»ç»Ÿèµ„æºç”¨åœ¨ä¿éšœäº¤æ˜“ç³»ç»Ÿæ­£ç¡®å±•ç¤ºä¼˜æƒ ä¿¡æ¯ä¸Šï¼Œå³ä¿éšœç”¨æˆ·çœŸæ­£ä¸‹å•æ—¶çš„ä»·æ ¼æ˜¯æ­£ç¡®çš„ã€‚æ‰€ä»¥é™çº§çš„æ ¸å¿ƒç›®æ ‡æ˜¯ç‰ºç‰²æ¬¡è¦çš„åŠŸèƒ½å’Œç”¨æˆ·ä½“éªŒæ¥ä¿è¯æ ¸å¿ƒä¸šåŠ¡æµç¨‹çš„ç¨³å®šï¼Œæ˜¯ä¸€ä¸ªä¸å¾—å·²è€Œä¸ºä¹‹çš„ä¸¾æªã€‚ é™æµå¦‚æœè¯´é™çº§æ˜¯ç‰ºç‰²äº†ä¸€éƒ¨åˆ†æ¬¡è¦çš„åŠŸèƒ½å’Œç”¨æˆ·çš„ä½“éªŒæ•ˆæœï¼Œé‚£ä¹ˆé™æµå°±æ˜¯æ›´æç«¯çš„ä¸€ç§ä¿æŠ¤æªæ–½äº†ã€‚é™æµå°±æ˜¯å½“ç³»ç»Ÿå®¹é‡è¾¾åˆ°ç“¶é¢ˆæ—¶ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡é™åˆ¶ä¸€éƒ¨åˆ†æµé‡æ¥ä¿æŠ¤ç³»ç»Ÿï¼Œå¹¶åšåˆ°æ—¢å¯ä»¥äººå·¥æ‰§è¡Œå¼€å…³ï¼Œä¹Ÿæ”¯æŒè‡ªåŠ¨åŒ–ä¿æŠ¤çš„æªæ–½ã€‚ è¿™é‡Œï¼Œæˆ‘åŒæ ·ç»™å‡ºäº†é™æµç³»ç»Ÿçš„ç¤ºæ„å›¾ã€‚æ€»ä½“æ¥è¯´ï¼Œé™æµæ—¢å¯ä»¥æ˜¯åœ¨å®¢æˆ·ç«¯é™æµï¼Œä¹Ÿå¯ä»¥æ˜¯åœ¨æœåŠ¡ç«¯é™æµã€‚æ­¤å¤–ï¼Œé™æµçš„å®ç°æ–¹å¼æ—¢è¦æ”¯æŒ URL ä»¥åŠæ–¹æ³•çº§åˆ«çš„é™æµï¼Œä¹Ÿè¦æ”¯æŒåŸºäº QPS å’Œçº¿ç¨‹çš„é™æµã€‚ é¦–å…ˆï¼Œæˆ‘ä»¥å†…éƒ¨çš„ç³»ç»Ÿè°ƒç”¨ä¸ºä¾‹ï¼Œæ¥åˆ†åˆ«è¯´ä¸‹å®¢æˆ·ç«¯é™æµå’ŒæœåŠ¡ç«¯é™æµçš„ä¼˜ç¼ºç‚¹ã€‚ å®¢æˆ·ç«¯é™æµï¼Œå¥½å¤„å¯ä»¥é™åˆ¶è¯·æ±‚çš„å‘å‡ºï¼Œé€šè¿‡å‡å°‘å‘å‡ºæ— ç”¨è¯·æ±‚ä»è€Œå‡å°‘å¯¹ç³»ç»Ÿçš„æ¶ˆè€—ã€‚ç¼ºç‚¹å°±æ˜¯å½“å®¢æˆ·ç«¯æ¯”è¾ƒåˆ†æ•£æ—¶ï¼Œæ²¡æ³•è®¾ç½®åˆç†çš„é™æµé˜ˆå€¼ï¼šå¦‚æœé˜ˆå€¼è®¾çš„å¤ªå°ï¼Œä¼šå¯¼è‡´æœåŠ¡ç«¯æ²¡æœ‰è¾¾åˆ°ç“¶é¢ˆæ—¶å®¢æˆ·ç«¯å·²ç»è¢«é™åˆ¶ï¼›è€Œå¦‚æœè®¾çš„å¤ªå¤§ï¼Œåˆ™èµ·ä¸åˆ°é™åˆ¶çš„ä½œç”¨ã€‚ æœåŠ¡ç«¯é™æµï¼Œå¥½å¤„æ˜¯å¯ä»¥æ ¹æ®æœåŠ¡ç«¯çš„æ€§èƒ½è®¾ç½®åˆç†çš„é˜ˆå€¼ï¼Œè€Œç¼ºç‚¹å°±æ˜¯è¢«é™åˆ¶çš„è¯·æ±‚éƒ½æ˜¯æ— æ•ˆçš„è¯·æ±‚ï¼Œå¤„ç†è¿™äº›æ— æ•ˆçš„è¯·æ±‚æœ¬èº«ä¹Ÿä¼šæ¶ˆè€—æœåŠ¡å™¨èµ„æºã€‚ åœ¨é™æµçš„å®ç°æ‰‹æ®µä¸Šæ¥è®²ï¼ŒåŸºäº QPS å’Œçº¿ç¨‹æ•°çš„é™æµåº”ç”¨æœ€å¤šï¼Œæœ€å¤§ QPS å¾ˆå®¹æ˜“é€šè¿‡å‹æµ‹æå‰è·å–ï¼Œä¾‹å¦‚æˆ‘ä»¬çš„ç³»ç»Ÿæœ€é«˜æ”¯æŒ 1w QPS æ—¶ï¼Œå¯ä»¥è®¾ç½® 8000 æ¥è¿›è¡Œé™æµä¿æŠ¤ã€‚çº¿ç¨‹æ•°é™æµåœ¨å®¢æˆ·ç«¯æ¯”è¾ƒæœ‰æ•ˆï¼Œä¾‹å¦‚åœ¨è¿œç¨‹è°ƒç”¨æ—¶æˆ‘ä»¬è®¾ç½®è¿æ¥æ± çš„çº¿ç¨‹æ•°ï¼Œè¶…å‡ºè¿™ä¸ªå¹¶å‘çº¿ç¨‹è¯·æ±‚ï¼Œå°±å°†çº¿ç¨‹è¿›è¡Œæ’é˜Ÿæˆ–è€…ç›´æ¥è¶…æ—¶ä¸¢å¼ƒã€‚ é™æµæ— ç–‘ä¼šå½±å“ç”¨æˆ·çš„æ­£å¸¸è¯·æ±‚ï¼Œæ‰€ä»¥å¿…ç„¶ä¼šå¯¼è‡´ä¸€éƒ¨åˆ†ç”¨æˆ·è¯·æ±‚å¤±è´¥ï¼Œå› æ­¤åœ¨ç³»ç»Ÿå¤„ç†è¿™ç§å¼‚å¸¸æ—¶ä¸€å®šè¦è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œé˜²æ­¢å› è¢«é™æµçš„è¯·æ±‚ä¸èƒ½ fast failï¼ˆå¿«é€Ÿå¤±è´¥ï¼‰è€Œæ‹–å®ç³»ç»Ÿã€‚ æ‹’ç»æœåŠ¡å¦‚æœé™æµè¿˜ä¸èƒ½è§£å†³é—®é¢˜ï¼Œæœ€åä¸€æ‹›å°±æ˜¯ç›´æ¥æ‹’ç»æœåŠ¡äº†ã€‚ å½“ç³»ç»Ÿè´Ÿè½½è¾¾åˆ°ä¸€å®šé˜ˆå€¼æ—¶ï¼Œä¾‹å¦‚ CPU ä½¿ç”¨ç‡è¾¾åˆ° 90% æˆ–è€…ç³»ç»Ÿ load å€¼è¾¾åˆ° 2*CPU æ ¸æ•°æ—¶ï¼Œç³»ç»Ÿç›´æ¥æ‹’ç»æ‰€æœ‰è¯·æ±‚ï¼Œè¿™ç§æ–¹å¼æ˜¯æœ€æš´åŠ›ä½†ä¹Ÿæœ€æœ‰æ•ˆçš„ç³»ç»Ÿä¿æŠ¤æ–¹å¼ã€‚ä¾‹å¦‚ç§’æ€ç³»ç»Ÿï¼Œæˆ‘ä»¬åœ¨å¦‚ä¸‹å‡ ä¸ªç¯èŠ‚è®¾è®¡è¿‡è½½ä¿æŠ¤ï¼š åœ¨æœ€å‰ç«¯çš„ Nginx ä¸Šè®¾ç½®è¿‡è½½ä¿æŠ¤ï¼Œå½“æœºå™¨è´Ÿè½½è¾¾åˆ°æŸä¸ªå€¼æ—¶ç›´æ¥æ‹’ç»HTTP è¯·æ±‚å¹¶è¿”å› 503 é”™è¯¯ç ï¼Œåœ¨ Java å±‚åŒæ ·ä¹Ÿå¯ä»¥è®¾è®¡è¿‡è½½ä¿æŠ¤ã€‚ æ‹’ç»æœåŠ¡å¯ä»¥è¯´æ˜¯ä¸€ç§ä¸å¾—å·²çš„å…œåº•æ–¹æ¡ˆï¼Œç”¨ä»¥é˜²æ­¢æœ€åæƒ…å†µå‘ç”Ÿï¼Œé˜²æ­¢å› æŠŠæœåŠ¡å™¨å‹è·¨è€Œé•¿æ—¶é—´å½»åº•æ— æ³•æä¾›æœåŠ¡ã€‚åƒè¿™ç§ç³»ç»Ÿè¿‡è½½ä¿æŠ¤è™½ç„¶åœ¨è¿‡è½½æ—¶æ— æ³•æä¾›æœåŠ¡ï¼Œä½†æ˜¯ç³»ç»Ÿä»ç„¶å¯ä»¥è¿ä½œï¼Œå½“è´Ÿè½½ä¸‹é™æ—¶åˆå¾ˆå®¹æ˜“æ¢å¤ï¼Œæ‰€ä»¥æ¯ä¸ªç³»ç»Ÿå’Œæ¯ä¸ªç¯èŠ‚éƒ½åº”è¯¥è®¾ç½®è¿™ä¸ªå…œåº•æ–¹æ¡ˆï¼Œå¯¹ç³»ç»Ÿåšæœ€åæƒ…å†µä¸‹çš„ä¿æŠ¤ã€‚ æœ€å,ä»¥javaç³»ç»Ÿä¸ºä¾‹ , å¦‚ä½•æé«˜ç³»ç»Ÿæ€§èƒ½æˆ‘ä»¬è®¨è®ºçš„ä¸»è¦æ˜¯ç³»ç»ŸæœåŠ¡ç«¯æ€§èƒ½ï¼Œä¸€èˆ¬ç”¨ QPSï¼ˆQuery Per Secondï¼Œæ¯ç§’è¯·æ±‚æ•°ï¼‰æ¥è¡¡é‡ï¼Œè¿˜æœ‰ä¸€ä¸ªå½±å“å’Œ QPS ä¹Ÿæ¯æ¯ç›¸å…³ï¼Œé‚£å°±æ˜¯å“åº”æ—¶é—´ï¼ˆResponse Timeï¼ŒRTï¼‰ï¼Œå®ƒå¯ä»¥ç†è§£ä¸ºæœåŠ¡å™¨å¤„ç†å“åº”çš„è€—æ—¶æ­£å¸¸æƒ…å†µä¸‹å“åº”æ—¶é—´ï¼ˆRTï¼‰è¶ŠçŸ­ï¼Œä¸€ç§’é’Ÿå¤„ç†çš„è¯·æ±‚æ•°ï¼ˆQPSï¼‰è‡ªç„¶ä¹Ÿå°±ä¼šè¶Šå¤šï¼Œè¿™åœ¨å•çº¿ç¨‹å¤„ç†çš„æƒ…å†µä¸‹çœ‹èµ·æ¥æ˜¯çº¿æ€§çš„å…³ç³»ï¼Œå³æˆ‘ä»¬åªè¦æŠŠæ¯ä¸ªè¯·æ±‚çš„å“åº”æ—¶é—´é™åˆ°æœ€ä½ï¼Œé‚£ä¹ˆæ€§èƒ½å°±ä¼šæœ€é«˜ã€‚ä½†æ˜¯ä½ å¯èƒ½æƒ³åˆ°å“åº”æ—¶é—´æ€»æœ‰ä¸€ä¸ªæé™ï¼Œä¸å¯èƒ½æ— é™ä¸‹é™ï¼Œæ‰€ä»¥åˆå‡ºç°äº†å¦å¤–ä¸€ä¸ªç»´åº¦ï¼Œå³é€šè¿‡å¤šçº¿ç¨‹ï¼Œæ¥å¤„ç†è¯·æ±‚ã€‚è¿™æ ·ç†è®ºä¸Šå°±å˜æˆäº†â€œæ€» QPS &#x3D;ï¼ˆ1000ms &#x2F; å“åº”æ—¶é—´ï¼‰Ã— çº¿ç¨‹æ•°é‡â€ï¼Œè¿™æ ·æ€§èƒ½å°±å’Œä¸¤ä¸ªå› ç´ ç›¸å…³äº†ï¼Œä¸€ä¸ªæ˜¯ä¸€æ¬¡å“åº”çš„æœåŠ¡ç«¯è€—æ—¶ï¼Œä¸€ä¸ªæ˜¯å¤„ç†è¯·æ±‚çš„çº¿ç¨‹æ•°ã€‚ å“åº”æ—¶é—´å’ŒQPSçš„å…³ç³»å¯¹äºå¤§éƒ¨åˆ†çš„ Web ç³»ç»Ÿè€Œè¨€ï¼Œå“åº”æ—¶é—´ä¸€èˆ¬éƒ½æ˜¯ç”± CPU æ‰§è¡Œæ—¶é—´å’Œçº¿ç¨‹ç­‰å¾…æ—¶é—´ï¼ˆæ¯”å¦‚ RPCã€IO ç­‰å¾…ã€Sleepã€Wait ç­‰ï¼‰ç»„æˆï¼Œå³æœåŠ¡å™¨åœ¨å¤„ç†ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œä¸€éƒ¨åˆ†æ˜¯ CPU æœ¬èº«åœ¨åšè¿ç®—ï¼Œè¿˜æœ‰ä¸€éƒ¨åˆ†æ˜¯åœ¨å„ç§ç­‰å¾…ã€‚ ç†è§£äº†æœåŠ¡å™¨å¤„ç†è¯·æ±‚çš„é€»è¾‘ï¼Œä¼°è®¡ä½ ä¼šè¯´ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸å»å‡å°‘è¿™ç§ç­‰å¾…æ—¶é—´ã€‚å¾ˆé—æ†¾ï¼Œæ ¹æ®æˆ‘ä»¬å®é™…çš„æµ‹è¯•å‘ç°ï¼Œå‡å°‘çº¿ç¨‹ç­‰å¾…æ—¶é—´å¯¹æå‡æ€§èƒ½çš„å½±å“æ²¡æœ‰æˆ‘ä»¬æƒ³è±¡å¾—é‚£ä¹ˆå¤§ï¼Œå®ƒå¹¶ä¸æ˜¯çº¿æ€§çš„æå‡å…³ç³»ï¼Œè¿™ç‚¹åœ¨å¾ˆå¤šä»£ç†æœåŠ¡å™¨ï¼ˆProxyï¼‰ä¸Šå¯ä»¥åšéªŒè¯ã€‚ å¦‚æœä»£ç†æœåŠ¡å™¨æœ¬èº«æ²¡æœ‰ CPU æ¶ˆè€—ï¼Œæˆ‘ä»¬åœ¨æ¯æ¬¡ç»™ä»£ç†æœåŠ¡å™¨ä»£ç†çš„è¯·æ±‚åŠ ä¸ªå»¶æ—¶ï¼Œå³å¢åŠ å“åº”æ—¶é—´ï¼Œä½†æ˜¯è¿™å¯¹ä»£ç†æœåŠ¡å™¨æœ¬èº«çš„ååé‡å¹¶æ²¡æœ‰å¤šå¤§çš„å½±å“ï¼Œå› ä¸ºä»£ç†æœåŠ¡å™¨æœ¬èº«çš„èµ„æºå¹¶æ²¡æœ‰è¢«æ¶ˆè€—ï¼Œå¯ä»¥é€šè¿‡å¢åŠ ä»£ç†æœåŠ¡å™¨çš„å¤„ç†çº¿ç¨‹æ•°ï¼Œæ¥å¼¥è¡¥å“åº”æ—¶é—´å¯¹ä»£ç†æœåŠ¡å™¨çš„ QPS çš„å½±å“ã€‚ å…¶å®ï¼ŒçœŸæ­£å¯¹æ€§èƒ½æœ‰å½±å“çš„æ˜¯ CPU çš„æ‰§è¡Œæ—¶é—´ã€‚è¿™ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå› ä¸º CPU çš„æ‰§è¡ŒçœŸæ­£æ¶ˆè€—äº†æœåŠ¡å™¨çš„èµ„æºã€‚ç»è¿‡å®é™…çš„æµ‹è¯•ï¼Œå¦‚æœå‡å°‘ CPU ä¸€åŠçš„æ‰§è¡Œæ—¶é—´ï¼Œå°±å¯ä»¥å¢åŠ ä¸€å€çš„ QPSã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åº”è¯¥è‡´åŠ›äºå‡å°‘ CPU çš„æ‰§è¡Œæ—¶é—´ã€‚ çº¿ç¨‹æ•°å¯¹ QPS çš„å½±å“å•çœ‹â€œæ€» QPSâ€çš„è®¡ç®—å…¬å¼ï¼Œä½ ä¼šè§‰å¾—çº¿ç¨‹æ•°è¶Šå¤š QPS ä¹Ÿå°±ä¼šè¶Šé«˜ï¼Œä½†è¿™ä¼šä¸€ç›´æ­£ç¡®å—ï¼Ÿæ˜¾ç„¶ä¸æ˜¯ï¼Œçº¿ç¨‹æ•°ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œå› ä¸ºçº¿ç¨‹æœ¬èº«ä¹Ÿæ¶ˆè€—èµ„æºï¼Œä¹Ÿå—åˆ°å…¶ä»–å› ç´ çš„åˆ¶çº¦ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹è¶Šå¤šç³»ç»Ÿçš„çº¿ç¨‹åˆ‡æ¢æˆæœ¬å°±ä¼šè¶Šé«˜ï¼Œè€Œä¸”æ¯ä¸ªçº¿ç¨‹ä¹Ÿéƒ½ä¼šè€—è´¹ä¸€å®šå†…å­˜ã€‚ é‚£ä¹ˆï¼Œè®¾ç½®ä»€ä¹ˆæ ·çš„çº¿ç¨‹æ•°æœ€åˆç†å‘¢ï¼Ÿå…¶å®å¾ˆå¤šå¤šçº¿ç¨‹çš„åœºæ™¯éƒ½æœ‰ä¸€ä¸ªé»˜è®¤é…ç½®ï¼Œå³â€œçº¿ç¨‹æ•° &#x3D; 2 * CPU æ ¸æ•° + 1â€ã€‚é™¤å»è¿™ä¸ªé…ç½®ï¼Œè¿˜æœ‰ä¸€ä¸ªæ ¹æ®æœ€ä½³å®è·µå¾—å‡ºæ¥çš„å…¬å¼ï¼š çº¿ç¨‹æ•° &#x3D; [(çº¿ç¨‹ç­‰å¾…æ—¶é—´ + çº¿ç¨‹ CPU æ—¶é—´) &#x2F; çº¿ç¨‹ CPU æ—¶é—´] Ã— CPU æ•°é‡ &#x3D;> è¿™ä¸ªå…¬å¼çš„æ ¸å¿ƒæ€æƒ³å°±è¡Œå°†ç­‰å¾…çš„æ—¶é—´è®©ç»™å…¶ä»–çº¿ç¨‹å»å¤„ç† å½“ç„¶ï¼Œæœ€å¥½çš„åŠæ³•æ˜¯é€šè¿‡æ€§èƒ½æµ‹è¯•æ¥å‘ç°æœ€ä½³çš„çº¿ç¨‹æ•°ã€‚ å¦‚ä½•ä¼˜åŒ–ç³»ç»Ÿå¯¹ Java ç³»ç»Ÿæ¥è¯´ï¼Œå¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹å¾ˆå¤šï¼Œè¿™é‡Œæˆ‘é‡ç‚¹è¯´ä¸€ä¸‹æ¯”è¾ƒæœ‰æ•ˆçš„å‡ ç§æ‰‹æ®µï¼Œä¾›ä½ å‚è€ƒï¼Œå®ƒä»¬æ˜¯ï¼šå‡å°‘ç¼–ç ã€å‡å°‘åºåˆ—åŒ–ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ†åˆ«æ¥çœ‹ä¸€ä¸‹ã€‚ 1. å‡å°‘ç¼–ç Java çš„ç¼–ç è¿è¡Œæ¯”è¾ƒæ…¢ï¼Œè¿™æ˜¯ Java çš„ä¸€å¤§ç¡¬ä¼¤ã€‚åœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œåªè¦æ¶‰åŠå­—ç¬¦ä¸²çš„æ“ä½œï¼ˆå¦‚è¾“å…¥è¾“å‡ºæ“ä½œã€I&#x2F;O æ“ä½œï¼‰éƒ½æ¯”è¾ƒè€— CPU èµ„æºï¼Œä¸ç®¡å®ƒæ˜¯ç£ç›˜ I&#x2F;O è¿˜æ˜¯ç½‘ç»œ I&#x2F;Oï¼Œå› ä¸ºéƒ½éœ€è¦å°†å­—ç¬¦è½¬æ¢æˆå­—èŠ‚ï¼Œè€Œè¿™ä¸ªè½¬æ¢å¿…é¡»ç¼–ç ã€‚ æ¯ä¸ªå­—ç¬¦çš„ç¼–ç éƒ½éœ€è¦æŸ¥è¡¨ï¼Œè€Œè¿™ç§æŸ¥è¡¨çš„æ“ä½œéå¸¸è€—èµ„æºï¼Œæ‰€ä»¥å‡å°‘å­—ç¬¦åˆ°å­—èŠ‚æˆ–è€…ç›¸åçš„è½¬æ¢ã€å‡å°‘å­—ç¬¦ç¼–ç ä¼šéå¸¸æœ‰æˆæ•ˆã€‚å‡å°‘ç¼–ç å°±å¯ä»¥å¤§å¤§æå‡æ€§èƒ½ã€‚ é‚£ä¹ˆå¦‚ä½•æ‰èƒ½å‡å°‘ç¼–ç å‘¢ï¼Ÿä¾‹å¦‚ï¼Œç½‘é¡µè¾“å‡ºæ˜¯å¯ä»¥ç›´æ¥è¿›è¡Œæµè¾“å‡ºçš„ï¼Œå³ç”¨ resp.getOutputStream() å‡½æ•°å†™æ•°æ®ï¼ŒæŠŠä¸€äº›é™æ€çš„æ•°æ®æå‰è½¬åŒ–æˆå­—èŠ‚ï¼Œç­‰åˆ°çœŸæ­£å¾€å¤–å†™çš„æ—¶å€™å†ç›´æ¥ç”¨ OutputStream() å‡½æ•°å†™ï¼Œå°±å¯ä»¥å‡å°‘é™æ€æ•°æ®çš„ç¼–ç è½¬æ¢ã€‚æ¯”å¦‚ æŠŠé™æ€çš„å­—ç¬¦ä¸²æå‰ç¼–ç æˆå­—èŠ‚å¹¶ç¼“å­˜ï¼Œç„¶åç›´æ¥è¾“å‡ºå­—èŠ‚å†…å®¹åˆ°é¡µé¢ï¼Œä»è€Œå¤§å¤§å‡å°‘ç¼–ç çš„æ€§èƒ½æ¶ˆè€—çš„ï¼Œç½‘é¡µè¾“å‡ºçš„æ€§èƒ½æ¯”æ²¡æœ‰æå‰è¿›è¡Œå­—ç¬¦åˆ°å­—èŠ‚è½¬æ¢æ—¶æå‡äº† 30% å·¦å³ã€‚ 2. å‡å°‘åºåˆ—åŒ–åºåˆ—åŒ–ä¹Ÿæ˜¯ Java æ€§èƒ½çš„ä¸€å¤§å¤©æ•Œï¼Œå‡å°‘ Java ä¸­çš„åºåˆ—åŒ–æ“ä½œä¹Ÿèƒ½å¤§å¤§æå‡æ€§èƒ½ã€‚åˆå› ä¸ºåºåˆ—åŒ–å¾€å¾€æ˜¯å’Œç¼–ç åŒæ—¶å‘ç”Ÿçš„ï¼Œæ‰€ä»¥å‡å°‘åºåˆ—åŒ–ä¹Ÿå°±å‡å°‘äº†ç¼–ç ã€‚ åºåˆ—åŒ–å¤§éƒ¨åˆ†æ˜¯åœ¨ RPC ä¸­å‘ç”Ÿçš„ï¼Œå› æ­¤é¿å…æˆ–è€…å‡å°‘ RPC å°±å¯ä»¥å‡å°‘åºåˆ—åŒ–ï¼Œå½“ç„¶å½“å‰çš„åºåˆ—åŒ–åè®®ä¹Ÿå·²ç»åšäº†å¾ˆå¤šä¼˜åŒ–æ¥æå‡æ€§èƒ½ã€‚æœ‰ä¸€ç§æ–°çš„æ–¹æ¡ˆï¼Œå°±æ˜¯å¯ä»¥å°†å¤šä¸ªå…³è”æ€§æ¯”è¾ƒå¼ºçš„åº”ç”¨è¿›è¡Œâ€œåˆå¹¶éƒ¨ç½²â€ï¼Œè€Œå‡å°‘ä¸åŒåº”ç”¨ä¹‹é—´çš„ RPC ä¹Ÿå¯ä»¥å‡å°‘åºåˆ—åŒ–çš„æ¶ˆè€—ã€‚ æ‰€è°“â€œåˆå¹¶éƒ¨ç½²â€ï¼Œå°±æ˜¯æŠŠä¸¤ä¸ªåŸæœ¬åœ¨ä¸åŒæœºå™¨ä¸Šçš„ä¸åŒåº”ç”¨åˆå¹¶éƒ¨ç½²åˆ°ä¸€å°æœºå™¨ä¸Šï¼Œå½“ç„¶ä¸ä»…ä»…æ˜¯éƒ¨ç½²åœ¨ä¸€å°æœºå™¨ä¸Šï¼Œè¿˜è¦åœ¨åŒä¸€ä¸ª Tomcat å®¹å™¨ä¸­ï¼Œä¸”ä¸èƒ½èµ°æœ¬æœºçš„ Socketï¼Œè¿™æ ·æ‰èƒ½é¿å…åºåˆ—åŒ–çš„äº§ç”Ÿã€‚","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"æ•°æ®åº“-é‡æ–°ç†è§£æ•°æ®åº“äº‹ç‰©,éš”ç¦»çº§åˆ«","url":"/2024/12/31/æ•°æ®åº“-é‡æ–°ç†è§£æ•°æ®åº“äº‹ç‰©-éš”ç¦»çº§åˆ«/","content":"è¯´å®è¯ä¹‹å‰,çŸ¥é“æ•°æ®åº“çš„éš”ç¦»çº§åˆ«,ä½†æ˜¯éƒ½æ˜¯å±€é™åœ¨èƒŒä¸Šé¢,æ²¡æœ‰çœŸæ­£æ€è€ƒè¿‡,è¿™ä¸ªé‡æ–°æ•´ç†ä¸€ä¸‹æ•°æ®åº“éš”ç¦»çº§åˆ«çš„ä¸œè¥¿,é¡ºä¾¿å¸¦ä¸Šè‡ªå·±çš„æ€è€ƒ è€ç”Ÿé•¿è°ˆæ•°æ®åº“äº‹ç‰©å››å¤§ç‰¹æ€§â‘´ åŸå­æ€§ï¼ˆAtomicityï¼‰ åŸå­æ€§æ˜¯æŒ‡äº‹åŠ¡åŒ…å«çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šï¼Œè¿™å’Œå‰é¢ä¸¤ç¯‡åšå®¢ä»‹ç»äº‹åŠ¡çš„åŠŸèƒ½æ˜¯ä¸€æ ·çš„æ¦‚å¿µï¼Œå› æ­¤äº‹åŠ¡çš„æ“ä½œå¦‚æœæˆåŠŸå°±å¿…é¡»è¦å®Œå…¨åº”ç”¨åˆ°æ•°æ®åº“ï¼Œå¦‚æœæ“ä½œå¤±è´¥åˆ™ä¸èƒ½å¯¹æ•°æ®åº“æœ‰ä»»ä½•å½±å“ã€‚ â‘µ ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ ä¸€è‡´æ€§æ˜¯æŒ‡äº‹åŠ¡å¿…é¡»ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€å˜æ¢åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œä¹‹å‰å’Œæ‰§è¡Œä¹‹åéƒ½å¿…é¡»å¤„äºä¸€è‡´æ€§çŠ¶æ€ã€‚ æ‹¿è½¬è´¦æ¥è¯´ï¼Œå‡è®¾ç”¨æˆ·Aå’Œç”¨æˆ·Bä¸¤è€…çš„é’±åŠ èµ·æ¥ä¸€å…±æ˜¯5000ï¼Œé‚£ä¹ˆä¸ç®¡Aå’ŒBä¹‹é—´å¦‚ä½•è½¬è´¦ï¼Œè½¬å‡ æ¬¡è´¦ï¼Œäº‹åŠ¡ç»“æŸåä¸¤ä¸ªç”¨æˆ·çš„é’±ç›¸åŠ èµ·æ¥åº”è¯¥è¿˜å¾—æ˜¯5000ï¼Œè¿™å°±æ˜¯äº‹åŠ¡çš„ä¸€è‡´æ€§ã€‚ â‘¶ éš”ç¦»æ€§ï¼ˆIsolationï¼‰ éš”ç¦»æ€§æ˜¯å½“å¤šä¸ªç”¨æˆ·å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œæ¯”å¦‚æ“ä½œåŒä¸€å¼ è¡¨æ—¶ï¼Œæ•°æ®åº“ä¸ºæ¯ä¸€ä¸ªç”¨æˆ·å¼€å¯çš„äº‹åŠ¡ï¼Œä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡çš„æ“ä½œæ‰€å¹²æ‰°ï¼Œå¤šä¸ªå¹¶å‘äº‹åŠ¡ä¹‹é—´è¦ç›¸äº’éš”ç¦»ã€‚ å³è¦è¾¾åˆ°è¿™ä¹ˆä¸€ç§æ•ˆæœï¼šå¯¹äºä»»æ„ä¸¤ä¸ªå¹¶å‘çš„äº‹åŠ¡T1å’ŒT2ï¼Œåœ¨äº‹åŠ¡T1çœ‹æ¥ï¼ŒT2è¦ä¹ˆåœ¨T1å¼€å§‹ä¹‹å‰å°±å·²ç»ç»“æŸï¼Œè¦ä¹ˆåœ¨T1ç»“æŸä¹‹åæ‰å¼€å§‹ï¼Œè¿™æ ·æ¯ä¸ªäº‹åŠ¡éƒ½æ„Ÿè§‰ä¸åˆ°æœ‰å…¶ä»–äº‹åŠ¡åœ¨å¹¶å‘åœ°æ‰§è¡Œã€‚ å…³äºäº‹åŠ¡çš„éš”ç¦»æ€§æ•°æ®åº“æä¾›äº†å¤šç§éš”ç¦»çº§åˆ«ï¼Œç¨åä¼šä»‹ç»åˆ°ã€‚ â‘· æŒä¹…æ€§ï¼ˆDurabilityï¼‰ æŒä¹…æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤äº†ï¼Œé‚£ä¹ˆå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œå³ä¾¿æ˜¯åœ¨æ•°æ®åº“ç³»ç»Ÿé‡åˆ°æ•…éšœçš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä¸¢å¤±æäº¤äº‹åŠ¡çš„æ“ä½œã€‚ ä¾‹å¦‚æˆ‘ä»¬åœ¨ä½¿ç”¨JDBCæ“ä½œæ•°æ®åº“æ—¶ï¼Œåœ¨æäº¤äº‹åŠ¡æ–¹æ³•åï¼Œæç¤ºç”¨æˆ·äº‹åŠ¡æ“ä½œå®Œæˆï¼Œå½“æˆ‘ä»¬ç¨‹åºæ‰§è¡Œå®Œæˆç›´åˆ°çœ‹åˆ°æç¤ºåï¼Œå°±å¯ä»¥è®¤å®šäº‹åŠ¡ä»¥åŠæ­£ç¡®æäº¤ï¼Œå³ä½¿è¿™æ—¶å€™æ•°æ®åº“å‡ºç°äº†é—®é¢˜ï¼Œä¹Ÿå¿…é¡»è¦å°†æˆ‘ä»¬çš„äº‹åŠ¡å®Œå…¨æ‰§è¡Œå®Œæˆï¼Œå¦åˆ™å°±ä¼šé€ æˆæˆ‘ä»¬çœ‹åˆ°æç¤ºäº‹åŠ¡å¤„ç†å®Œæ¯•ï¼Œä½†æ˜¯æ•°æ®åº“å› ä¸ºæ•…éšœè€Œæ²¡æœ‰æ‰§è¡Œäº‹åŠ¡çš„é‡å¤§é”™è¯¯ã€‚ ä¸æ³¨æ„æ•°æ®åº“éš”ç¦»çº§åˆ«å°†å¯¼è‡´çš„é—®é¢˜1ï¼Œè„è¯»è„è¯»æ˜¯æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡å¤„ç†è¿‡ç¨‹é‡Œè¯»å–äº†å¦ä¸€ä¸ªæœªæäº¤çš„äº‹åŠ¡ä¸­çš„æ•°æ®ã€‚ 2ï¼Œä¸å¯é‡å¤è¯»ä¸å¯é‡å¤è¯»æ˜¯æŒ‡åœ¨å¯¹äºæ•°æ®åº“ä¸­çš„æŸä¸ªæ•°æ®ï¼Œä¸€ä¸ªäº‹åŠ¡èŒƒå›´å†…å¤šæ¬¡æŸ¥è¯¢å´è¿”å›äº†ä¸åŒçš„æ•°æ®å€¼ï¼Œè¿™æ˜¯ç”±äºåœ¨æŸ¥è¯¢é—´éš”ï¼Œè¢«å¦ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹å¹¶æäº¤äº†ã€‚ 3ï¼Œè™šè¯»(å¹»è¯»)å¹»è¯»æ˜¯äº‹åŠ¡éç‹¬ç«‹æ‰§è¡Œæ—¶å‘ç”Ÿçš„ä¸€ç§ç°è±¡ã€‚ä¾‹å¦‚äº‹åŠ¡T1å¯¹ä¸€ä¸ªè¡¨ä¸­æ‰€æœ‰çš„è¡Œçš„æŸä¸ªæ•°æ®é¡¹åšäº†ä»â€œ1â€ä¿®æ”¹ä¸ºâ€œ2â€çš„æ“ä½œï¼Œè¿™æ—¶äº‹åŠ¡T2åˆå¯¹è¿™ä¸ªè¡¨ä¸­æ’å…¥äº†ä¸€è¡Œæ•°æ®é¡¹ï¼Œè€Œè¿™ä¸ªæ•°æ®é¡¹çš„æ•°å€¼è¿˜æ˜¯ä¸ºâ€œ1â€å¹¶ä¸”æäº¤ç»™æ•°æ®åº“ã€‚è€Œæ“ä½œäº‹åŠ¡T1çš„ç”¨æˆ·å¦‚æœå†æŸ¥çœ‹åˆšåˆšä¿®æ”¹çš„æ•°æ®ï¼Œä¼šå‘ç°è¿˜æœ‰ä¸€è¡Œæ²¡æœ‰ä¿®æ”¹ï¼Œå…¶å®è¿™è¡Œæ˜¯ä»äº‹åŠ¡T2ä¸­æ·»åŠ çš„ï¼Œå°±å¥½åƒäº§ç”Ÿå¹»è§‰ä¸€æ ·ï¼Œè¿™å°±æ˜¯å‘ç”Ÿäº†å¹»è¯»ã€‚ å¹»è¯»å’Œä¸å¯é‡å¤è¯»éƒ½æ˜¯è¯»å–äº†å¦ä¸€æ¡å·²ç»æäº¤çš„äº‹åŠ¡ï¼ˆè¿™ç‚¹å°±è„è¯»ä¸åŒï¼‰ï¼Œæ‰€ä¸åŒçš„æ˜¯ä¸å¯é‡å¤è¯»æŸ¥è¯¢çš„éƒ½æ˜¯åŒä¸€ä¸ªæ•°æ®é¡¹ï¼Œè€Œå¹»è¯»é’ˆå¯¹çš„æ˜¯ä¸€æ‰¹æ•°æ®æ•´ä½“ï¼ˆæ¯”å¦‚æ•°æ®çš„ä¸ªæ•°ï¼‰ã€‚ å…¶å®æ•´ç†åˆ°è¿™é‡Œåº”è¯¥å°±å·®ä¸å¤šäº†,ä»¥ååœ¨æ·»åŠ ä¸€äº›åº•å±‚å®ç°å§","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"è®¾è®¡ä¸€ä¸ªä¼˜é›…çš„è¥é”€ç³»ç»Ÿçš„åæ€","url":"/2024/12/31/è®¾è®¡ä¸€ä¸ªä¼˜é›…çš„è¥é”€ç³»ç»Ÿçš„åæ€/","content":"è¥é”€ç³»ç»Ÿæ„å»ºå¼€å‘çš„æ ¸å¿ƒçš„æ€è·¯ -> å»è®¾è®¡æ¨¡å¼,è§„åˆ™åŒ–ä¸ºä»€ä¹ˆè¦å»è®¾è®¡æ¨¡å¼? -> è®¾è®¡æ¨¡å¼å¾ˆä¼˜ç§€,ä½†æ˜¯è®¾è®¡æ¨¡å¼æ˜¯æœ‰æé™çš„.è®¾è®¡æ¨¡å¼çš„æ—¶å€™,éœ€è¦å¯¹ç³»ç»Ÿçš„æ‰©å±•ç‚¹æœ‰å……åˆ†çš„äº†è§£æ‰èƒ½çœŸæ­£çš„å°†è®¾è®¡æ¨¡å¼è®¾è®¡å¥½ , ä½†æ˜¯ä½œä¸ºäº’è”ç½‘çš„è¥é”€ä¸šåŠ¡,å­˜åœ¨å˜åŒ–å¿«,ç©æ³•å¤š,è§„åˆ™å¤æ‚,å­˜åœ¨ç‰¹æ®Šç­‰æƒ…å†µ , å¯¼è‡´æˆ‘ä»¬å¾ˆéš¾çœŸæ­£çš„é¢„ä¼°æ‰©å±•ç‚¹åˆ°åº•åœ¨å“ªé‡Œ , å¯¼è‡´ç³»ç»Ÿè¿‡åº¦è®¾è®¡ , å¢åŠ è®¸å¤šå¤æ‚é€»è¾‘ è®¾è®¡æ¨¡å¼æ˜¯å†™æ¡†æ¶çš„æŠ€æœ¯,å¹¶ä¸æ˜¯å†™ä¸šåŠ¡çš„æŠ€æœ¯ ä¸ºä»€ä¹ˆè¦è§„åˆ™åŒ–? å…¶å®æ˜¯ä¸€ç§æƒ³æ³• , å°†å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ç®€åŒ–æˆä¸€ç§è§„åˆ™ , ä¸€ç§æµç¨‹ ps : è¿™ä¸ªä¸œè¥¿æ¯”è¾ƒæŠ½è±¡ , éœ€è¦ç»å†ä¸€å®šçš„ä¸šåŠ¡å¤æ‚åº¦æ‰èƒ½æ­£çœŸçš„ç†è§£ å¦‚ä½•ç”¨æµç¨‹åŒ–å’Œè§„åˆ™åŒ–æ¥è®¾è®¡è¥é”€ä¸­å¿ƒ1. è¥é”€ä¸­å¿ƒè§„åˆ™æ¢³ç† é€šè¿‡ä¸Šé¢çš„å„ç§æ´»åŠ¨çš„å½¢å¼,æˆ‘ä»¬çš„æ´»åŠ¨è®¡ç®—é€»è¾‘(ä¸åŒ…æ‹¬ç”¨æˆ·ç»´åº¦é™åˆ¶)å¯ä»¥æŠ½è±¡ä¸€ä¸ªè¿™ç§æ¨¡å‹ å°†æ‰€æœ‰çš„æ´»åŠ¨çš„ä¼˜æƒ ç»“æœæƒ³è±¡æˆä¸€ç§ç»“è®º , åŒ…æ‹¬ å¯¹æ´»åŠ¨å¯¹åº”çš„å•†å“å•å“çš„é‡‘é¢å½±å“ å¯¹æ´»åŠ¨å¯¹åº”çš„å•†å“ç»„åˆçš„é‡‘é¢å½±å“ å¯¹æ•´ä¸ªè®¢å•çš„é‡‘é¢å½±å“ å¯¹æ´»åŠ¨å¯¹åº”çš„å•†å“å•å“çš„é™„å±å•†å“çš„å½±å“ å¯¹æ´»åŠ¨å¯¹åº”çš„å•†å“ç»„åˆçš„é™„å±å•†å“çš„å½±å“ å¯¹æ´»åŠ¨å¯¹åº”æ•´ä¸ªè®¢å•çš„é™„å±å•†å“çš„å½±å“ å°†æ‰€æœ‰çš„æ´»åŠ¨æ¡ä»¶æƒ³è±¡æˆä¸€ç§è§„åˆ™åŒ…æ‹¬ (1) å•å•†å“,å¤šæ¢¯åº¦,ä»·æ ¼é™åˆ¶ (2) å•å•†å“,å¤šæ¢¯åº¦,æ•°é‡é™åˆ¶ (3) ä»»æ„æ•°é‡ (1) (2) é€»è¾‘è¿ç®— æŠ½è±¡æˆè¿™æ ·, ä¸€ä¸ªæ´»åŠ¨çš„è®¡ç®—æµç¨‹å°±ä¼šç®€åŒ–æˆç”±æ´»åŠ¨æ¡ä»¶åˆ°ä¼˜æƒ ç»“æœæˆ–è€…è¯´è§„åˆ™åˆ°ç»“è®ºçš„ä¸€ç§æ˜ å°„ 2. è¥é”€æ´»åŠ¨ç±»å…·ä½“çš„è®¡ç®—æµç¨‹åº”è¯¥æ€ä¹ˆåš æœ¬è´¨ä¸Šå°±æ˜¯å°†å„ä¸ªéƒ¨åˆ†åˆ†è§£ å…¶ä¸­æ¯ä¸€ä¸ªhandleéƒ½å¯ä»¥åšæ°´å¹³æ‰©å±• , æœ€å¤§é™åº¦çš„ä¿è¯é€»è¾‘çš„æ¸…æ™° è¿™å¥—ç³»ç»Ÿçš„è®¾è®¡å“²å­¦è¥é”€æœ¬èº«å¾ˆå¤æ‚ , æ‰€ä»¥æˆ‘ä»¬å°±æŠ›å¼€å¤æ‚çš„è¥é”€çš„æ´»åŠ¨ , ç”¨åŸºæœ¬çš„æ¨¡å‹å»æŠ½è±¡åŒ¹é…å®ƒ , è¿™æ ·æˆ‘ä»¬å°±èƒ½ç®€åŒ–è®¡ç®—é€»è¾‘ , å®ç°æ›´çµæ´» , æ›´ä»¥æ‰©å±•çš„è¥é”€ç³»ç»Ÿ","date":"2024-12-31","categories":["æ–°åšå®¢"]},{"title":"oauth2.0-è®¤è¯æˆæƒçš„æ·±å…¥ç†è§£","url":"/2024/12/31/oauth2-0-è®¤è¯æˆæƒçš„æ·±å…¥ç†è§£/","content":"oAuth2.0 æ˜¯ä¸€ä¸ªå¹¿æ³›åº”ç”¨çš„è®¤è¯æˆæƒæ–¹æ³• åœ¨æ•´ä¸ªoAuth2.0çš„è®¤è¯æœ‰ä»¥ä¸‹çš„å‚ä¸è€… (1)Third-party applicationï¼šç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åº,ç§°â€å®¢æˆ·ç«¯â€(client) (2)HTTP serviceï¼šHTTPæœåŠ¡æä¾›å•†,ç®€ç§°â€æœåŠ¡æä¾›å•†â€ (3)Resource Ownerï¼šèµ„æºæ‰€æœ‰è€…,ç§°â€ç”¨æˆ·â€(user). (4)User Agentï¼šç”¨æˆ·ä»£ç†,æœ¬æ–‡ä¸­å°±æ˜¯æŒ‡æµè§ˆå™¨. (5)Authorization serverï¼šè®¤è¯æœåŠ¡å™¨,å³æœåŠ¡æä¾›å•†ä¸“é—¨ç”¨æ¥å¤„ç†è®¤è¯çš„æœåŠ¡å™¨. (6)Resource serverï¼šèµ„æºæœåŠ¡å™¨,å³æœåŠ¡æä¾›å•†å­˜æ”¾ç”¨æˆ·ç”Ÿæˆçš„èµ„æºçš„æœåŠ¡å™¨.å®ƒä¸è®¤è¯æœåŠ¡å™¨,å¯ä»¥æ˜¯åŒä¸€å°æœåŠ¡å™¨,ä¹Ÿå¯ä»¥æ˜¯ä¸åŒçš„æœåŠ¡å™¨. oAuth2.0çš„å®˜æ–¹æµç¨‹æ˜¯è¿™æ ·çš„ (A)ç”¨æˆ·æ‰“å¼€å®¢æˆ·ç«¯ä»¥å,å®¢æˆ·ç«¯è¦æ±‚ç”¨æˆ·ç»™äºˆæˆæƒ. (B)ç”¨æˆ·åŒæ„ç»™äºˆå®¢æˆ·ç«¯æˆæƒ. (C)å®¢æˆ·ç«¯ä½¿ç”¨ä¸Šä¸€æ­¥è·å¾—çš„æˆæƒopenToken,å‘è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰ŒaccesssToken. (D)è®¤è¯æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯è¿›è¡Œè®¤è¯ä»¥å,ç¡®è®¤æ— è¯¯,åŒæ„å‘æ”¾ä»¤ç‰ŒaccesssToken. (E)å®¢æˆ·ç«¯ä½¿ç”¨ä»¤ç‰Œ,å‘èµ„æºæœåŠ¡å™¨ç”³è¯·è·å–èµ„æº. (F)èµ„æºæœåŠ¡å™¨ç¡®è®¤ä»¤ç‰Œæ— è¯¯,åŒæ„å‘å®¢æˆ·ç«¯å¼€æ”¾èµ„æº. å…¶å®è¿™ä¸ªç™»å…¥æµç¨‹çš„æ ¸å¿ƒå°±æ˜¯å¦‚ä½•è·å–è¿™ä¸ªaccessToken,è¿™é‡Œåˆ—ä¸€ä¸ªæ¯”è¾ƒè¯¦ç»†çš„æˆæƒæµç¨‹,åšä¸€ä¸ªæ•´ç† è¿™é‡Œè¯´æ˜ä¸€äº›å…³é”®æ­¥éª¤ ç¬¬ä¸‰æ­¥ : æˆ‘ä»¬è¿”å›æˆæƒæœåŠ¡æä¾›çš„ä¸€ä¸ªæ¥å£,è¿™é‡Œé‡ç‚¹æ˜¯è¿™ä¸ªæ¥å£ä¸­çš„å‚æ•°,æˆ‘ä»¬éœ€è¦è¿™å‡ ä¸ªé‡è¦çš„å‚æ•° åœ°å€å”¯ä¸€æ ‡è¯† : è¿™ä¸ªæ˜¯å…³è”æˆæƒåœ°å€çš„å”¯ä¸€id æˆæƒåœ°å€ : è¿™ä¸ªåœ°å€æ˜¯è¡¨æ˜æˆæƒå¹³å°åœ¨è®¤è¯é€šè¿‡å,å°†è®¤è¯çš„accessTokenè·å–codeæˆ–è€…accessToken,å‘é€åˆ°å“ªé‡Œçš„åœ°å€ status : ä¼ å…¥ä¸€ä¸ªè®¤è¯éšæœºæ•°,é˜²æ­¢csfræ”»å‡»,è¿™ç§æ–¹æ³•éœ€è¦ç¬¬ä¸‰æ–¹æœåŠ¡å™¨è‡ªå·±åšstatusæ ¡éªŒ æ³¨æ„:è¿™é‡Œè¦è¿›è¡Œç¬¬ä¸€æ¬¡æƒé™æ ¡éªŒ,æŸ¥çœ‹è¿™ä¸ªåŸŸåæœ‰æ²¡æœ‰æƒé™è¿›è¡Œè®¤è¯.æˆæƒç³»ç»Ÿåº”è¯¥æä¾›æƒé™é…ç½®çš„åŠŸèƒ½é¡µé¢ ç¬¬åæ­¥ : å¾®ä¿¡å›ä¼ accessTokenè·å–code å…¶å®æœ¬è´¨ä¸Šæˆæƒç³»ç»Ÿåœ¨è¿™ä¸€æ­¥å°±å¯ä»¥è¿”å›accessToken,ä½†æ˜¯å¾®ä¿¡è€ƒè™‘åˆ°,ç¬¬ä¸‰æ­¥å›ä¼ çš„è°ƒç”¨åœ°å€å¯èƒ½ä¼šè¢«ç¯¡æ”¹æˆ–codeè¢«å·å–(æ¯”å¦‚æ²¡æœ‰ä½¿ç”¨httpsåŠ å¯†),æ‰€ä»¥è¿™é‡Œåœ¨è§„èŒƒçš„Oauth2.0 è®¤è¯ä½“ç³»å¤–åˆæ·»åŠ ä¸€ä¸ªæµç¨‹ ä½†æ˜¯è¿˜æœ‰ä¸€ç§æƒ…å†µæ²¡æœ‰è€ƒè™‘åˆ°,å¦‚æœåœ°å€æ²¡æœ‰è¢«ç¯¡æ”¹,ä½†æ˜¯ç¬¬ä¸‰æ–¹è®¤è¯ç³»ç»Ÿçš„DNSè¢«åŠ«æŒçš„è¯,accessTokenè¿˜æ˜¯ä¼šè¢«éæ³•è·å–åˆ° æ‰€ä»¥,è¿™ä¸€æ­¥è¿˜è¦å†å¢åŠ ä¸€æ­¥éªŒè¯,å¯ä»¥å‚è€ƒhttpsçš„éªŒè¯æ–¹æ³•,æˆæƒç³»ç»Ÿå¯ä»¥å†æˆæƒçš„åŸŸä¸­å‘æ”¾å¯†é’¥æ–‡ä»¶,è¢«æˆæƒçš„ç³»ç»Ÿå¿…é¡»åœ¨æˆæƒç³»ç»Ÿç³»ç»Ÿä¸­ä¸‹è½½æˆæƒæ–‡ä»¶,æ”¾åœ¨è‡ªå·±çš„æ–‡ä»¶ç›®å½•ä¸­,å¹¶ä¸”è¢«æˆæƒç³»ç»Ÿå¿…é¡»ä¿è¯è¿™ä¸ªæ–‡ä»¶ä¸èƒ½è¢«å…¶ä»–äººéæ³•è·å¾—. è¿™æ ·æˆæƒç³»ç»Ÿåœ¨å‘æ”¾codeçš„æ—¶å€™ä¼šå…ˆè®¤è¯æœ‰æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶,å¦‚æœè¯·æ±‚åˆ°äº†è¿™ä¸ªä»¶,å°±è®¤ä¸ºè¿™ä¸ªç³»ç»Ÿæ²¡æœ‰è¢«dnsåŠ«æŒ æ³¨æ„ä¸€ç‚¹,è¿™é‡Œçš„ä¼šç”¨åˆ°é‡å®šå‘åœ°å€è¿”å›ç¬¬ä¸‰æ–¹ç³»ç»Ÿçš„ç”¨æˆ·ç™»å…¥ç•Œé¢(è¿”å›äº†æµè§ˆå™¨),æœ¬è´¨ä¸Šç™»å…¥å’Œæ³¨å†Œéœ€è¦çš„åªæ˜¯ç”¨æˆ·çš„ä¿¡æ¯,å½“ä½¿ç”¨äº†è®¤è¯ç³»ç»Ÿæä¾›çš„codeæ—¶å€™,åç«¯çš†å¯ä½¿ç”¨accessTokenæ¢å–æ¥å£è·å–ç”¨æˆ·æ–°æ¶ˆæ¯äº†,æ›´åŠ æ–¹ä¾¿çš„å®ç°é›†æˆ.(è¿™é‡Œå›è°ƒåœ°å€ä½¿ç”¨çš„æ˜¯æµè§ˆå™¨çš„åŸå› æ˜¯æ–¹ä¾¿ç¬¬ä¸‰æ–¹ç™»å…¥ç³»ç»Ÿé›†æˆ,è¿™æ ·å°±æ²¡æœ‰å¿…è¦ä½¿ç”¨é•¿è¿æ¥ä¿è¯codeå’Œç”¨æˆ·çš„ä¸€ä¸€å¯¹åº”å’Œhttpåè®®çš„å‰ç«¯æ¨é€) ç¬¬åä¸€æ­¥ : è¿™ä¸€æ­¥å…¶å®æ˜¯ç¬¬åæ­¥çš„è¿›ä¸€æ­¥è§£é‡Š æˆ‘ä»¬ä¹‹å‰è¯´çš„ç¬¬åéƒ¨çš„æ—¶å€™å·²ç»è§£å†³çš„DNSåŠ«æŒçš„é—®é¢˜äº†,æ¥ä¸‹æ¥è¦è§£å†³å°±æ˜¯codeè¢«æš´åŠ›ç ´è§£æˆ–è€…å›è°ƒurlè¢«ç¯¡æ”¹çš„é—®é¢˜ è¿™é‡Œä½¿ç”¨è¿™ç§æ–¹æ³•ä¿è¯,è¢«è®¤è¯ç³»ç»Ÿè¦ä¿è¯æ‰€æœ‰çš„è¢«è®¤è¯è®¤è¯ç³»ç»Ÿéƒ½æ‹¥æœ‰ä¸€ä¸ªç³»ç»Ÿå”¯ä¸€idå’Œå¯¹åº”çš„å”¯ä¸€å¯†ç ,è¢«è®¤è¯ç³»ç»Ÿæœ‰ä¸€å®šè¦ä¿è¯å¯†ç ä¸èƒ½æ³„éœ²å‡ºå» å½“ç”¨æˆ·åœ¨ä½¿ç”¨codeæ¢å–accessTokençš„è¿‡ç¨‹ä¸­,è¦å¸¦ä¸Šè¿™ä¸ªè¢«è®¤è¯ç³»ç»Ÿçš„å”¯ä¸€idå’Œå¯¹åº”çš„å¯†ç ,å¹¶ä¸”ç›¸äº’ä¹‹é—´çš„äº¤äº’å¿…é¡»ä½¿ç”¨HTTPSåŠ å¯†,è®¤è¯æœåŠ¡å™¨åœ¨è¿›è¡Œè®¤è¯çš„æ—¶å€™éœ€è¦æ ¡éªŒidå’Œå¯†ç æ˜¯å¦åŒ¹é…,codeå’ŒIdæ—¶å€™åŒ¹é…,å¦‚æœé€šè¿‡,è¯æ˜éªŒè¯åˆæ³•,è¿™æ ·å°±ä¿è¯ç”¨æˆ·ä¿¡æ¯ä¸æ³„éœ²","date":"2024-12-31","categories":["æ¶æ„è®¾è®¡"]},{"title":"0-æ€»çº²","url":"/2024/12/31/0-æ€»çº²/","content":"ä»€ä¹ˆæ˜¯A&#x2F;Bå®éªŒç®€å•æ¥è¯´ï¼ŒA&#x2F;Bå®éªŒå°±æ˜¯é’ˆå¯¹æƒ³è°ƒç ”çš„é—®é¢˜ï¼Œæä¾›ä¸¤ç§ä¸åŒçš„å¤‡é€‰è§£å†³æ–¹æ¡ˆï¼Œç„¶åè®©ä¸€éƒ¨åˆ†ç”¨æˆ·ä½¿ç”¨æ–¹æ¡ˆAï¼Œå¦ä¸€éƒ¨åˆ†ç”¨æˆ·ä½¿ç”¨æ–¹æ¡ˆBï¼Œæœ€ç»ˆé€šè¿‡å®éªŒæ•°æ®å¯¹æ¯”æ¥ç¡®å®šæœ€ä¼˜æ–¹æ¡ˆã€‚é€šå¸¸æˆ‘ä»¬åœ¨è¿›è¡ŒA&#x2F;Bå®éªŒçš„æ—¶å€™ï¼Œä¼šä»æ€»ä½“ç”¨æˆ·ä¸­æŠ½å–ä¸€å°éƒ¨åˆ†è¿›è¡Œå®éªŒï¼Œä¸€æ¥é˜²æ­¢äº§å“å‡ºç°bugå¹²æ‰°å¤§æ‰¹ç”¨æˆ·çš„ä½“éªŒï¼ŒäºŒæ¥é˜²æ­¢å®éªŒæ–¹æ¡ˆæ•ˆæœä¸ä½³é€ æˆå¤§èŒƒå›´çš„è´Ÿå¢é•¿ã€‚åœ¨å®éªŒæ—¶ï¼Œæˆ‘ä»¬å°†ç”¨æˆ·å®Œå…¨éšæœºåœ°åˆ†é…ç»™æ–¹æ¡ˆAå’Œæ–¹æ¡ˆBï¼Œå°½å¯èƒ½å‡è½»å®éªŒæ ·æœ¬åˆ†é…ä¸å‡å¯¹å®éªŒç»“æœé€ æˆçš„å¹²æ‰°ã€‚å½“ç„¶ï¼Œå…³äºA&#x2F;Bå®éªŒçš„å®šä¹‰ä¹Ÿæœ‰æ›´åŠ å®Œæ•´çš„ç‰ˆæœ¬ã€‚æ¯”å¦‚ç‹æ™”åšå£«ï¼ˆè€¶é²å¤§å­¦è®¡ç®—æœºç§‘å­¦åšå£«ï¼Œæ›¾åœ¨å¾®è½¯ã€è°·æ­Œç­‰å…¬å¸ä»»èŒï¼Œè¾ƒæ—©åœ°å°†A&#x2F;Bå®éªŒæ€æƒ³å¼•å…¥å›½å†…ï¼‰è®¤ä¸ºäº’è”ç½‘äº§å“è¿­ä»£å®è·µä¸­çš„A&#x2F;Bå®éªŒæ˜¯æŒ‡ï¼š ä¸ºäº†éªŒè¯ä¸€ä¸ªæ–°çš„äº§å“äº¤äº’è®¾è®¡ã€äº§å“åŠŸèƒ½æˆ–è€…ç­–ç•¥ã€ç®—æ³•çš„æ•ˆæœï¼Œåœ¨åŒä¸€æ—¶é—´æ®µï¼Œç»™å¤šç»„ç”¨æˆ·ï¼ˆä¸€èˆ¬å«åšå¯¹ç…§ç»„å’Œå®éªŒç»„ï¼Œç”¨æˆ·åˆ†ç»„æ–¹æ³•ç»Ÿè®¡ä¸Šéšæœºï¼Œä½¿å¤šç»„ç”¨æˆ·åœ¨ç»Ÿè®¡è§’åº¦æ— å·®åˆ«ï¼‰åˆ†åˆ«å±•ç¤ºä¼˜åŒ–å‰ï¼ˆå¯¹ç…§ç»„ï¼‰å’Œä¼˜åŒ–åï¼ˆå®éªŒç»„ï¼Œå¯ä»¥æœ‰å¤šç»„ï¼‰çš„äº§å“äº¤äº’è®¾è®¡ã€äº§å“åŠŸèƒ½æˆ–è€…ç­–ç•¥ã€ç®—æ³•ï¼Œå¹¶é€šè¿‡æ•°æ®åˆ†æï¼Œåˆ¤æ–­ä¼˜åŒ–å‰åçš„äº§å“äº¤äº’è®¾è®¡ã€äº§å“åŠŸèƒ½æˆ–è€…ç­–ç•¥ã€ç®—æ³•åœ¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªè¯„ä¼°æŒ‡æ ‡ä¸Šæ˜¯ç¬¦åˆé¢„æœŸçš„ä¸€ç§å®éªŒæ–¹æ³•ã€‚ å®é™…ä¸Šï¼ŒA&#x2F;Bå®éªŒæ—©å°±å¹¿æ³›åœ°åº”ç”¨äºç§‘ç ”é¢†åŸŸï¼Œæ¯”å¦‚åŒ»å­¦ç•Œä¼šä½¿ç”¨A&#x2F;Bå®éªŒæ¥åˆ¤æ–­è¯å“åœ¨æ²»ç–—æŸç§ç–¾ç—…æ—¶æ˜¯å¦çœŸçš„æœ‰æ•ˆï¼ˆå®éªŒä¸­ä¸€åŠæ‚£è€…ä¼šé¢†åˆ°è¯å“ï¼Œå¦ä¸€åŠæ‚£è€…ä¼šåœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œé¢†åˆ°ä¸è¯å“å¤–å½¢ä¸€æ ·çš„å®‰æ…°å‰‚ï¼‰ã€‚ç°å¦‚ä»Šï¼ŒA&#x2F;Bå®éªŒçš„æ€æƒ³è¢«å¼•å…¥äº’è”ç½‘é¢†åŸŸï¼Œå¹¿æ³›åœ°åº”ç”¨äºäº’è”ç½‘äº§å“çš„å¢é•¿ä¹‹ä¸­ï¼Œæˆä¸ºå¢é•¿é»‘å®¢ä»¬æ‰‹ä¸­çš„åˆ©å™¨ã€‚å¢é•¿é»‘å®¢çš„æ ¸å¿ƒåœ¨äºï¼Œèƒ½å¤Ÿåˆ©ç”¨å°èŒƒå›´çš„æ•°æ®é©±åŠ¨å¿«é€Ÿè¿­ä»£ã€å¿«é€ŸéªŒè¯ï¼Œè€Œåå†å¤§è§„æ¨¡åœ°æŠ•å…¥è¿ç”¨ã€‚é‚£ä¹ˆï¼Œå¢é•¿é»‘å®¢ä»¬å¦‚ä½•éªŒè¯è‡ªå·±çš„å‡è®¾æ˜¯å¦æœ‰åŠ©äºå¢é•¿å‘¢ï¼ŸA&#x2F;Bæµ‹è¯•å°±æ˜¯ä»–ä»¬çš„ç§˜å¯†æ­¦å™¨ã€‚å¦‚æœä½ æƒ³è¦æˆä¸ºä¸€ä¸ªå¢é•¿é»‘å®¢ï¼Œé‚£ä¹ˆA&#x2F;Bå®éªŒææ€•æ˜¯ä½ å¿…å­¦çš„æŠ€èƒ½ã€‚ ä¸ºä»€ä¹ˆè¦åšA&#x2F;Bå®éªŒæœ€æ—©é€šè¿‡å®éªŒæ€è·¯è·å–å¢é•¿çš„å…¬å¸æ˜¯è°·æ­Œã€‚è°·æ­Œåœ¨2007å¹´å°±å»ºè®¾äº†å®Œå–„çš„A&#x2F;Bå®éªŒç³»ç»Ÿï¼Œä¹‹åå®éªŒçš„é¢‘ç‡è¶Šæ¥è¶Šé«˜ã€‚ç°åœ¨è°·æ­Œæ¯ä¸ªæœˆéƒ½ä¼šä¸Šçº¿å‡ ç™¾ä¸ªA&#x2F;Bå®éªŒï¼Œè¿™äº›å®éªŒå¸®åŠ©è°·æ­Œè·å¾—æ¯ä¸ªæœˆ2%çš„å¢é•¿ã€‚ä¸è¦å°çœ‹è¿™2%ï¼Œå®é™…ä¸Šï¼Œè°·æ­Œé€šè¿‡å®ƒå¯ä»¥è·å¾—å…¨å¹´20%+çš„å¢é•¿ï¼Œå¢åŠ è¶…è¿‡10äº¿ç¾å…ƒçš„è¥æ”¶ã€‚è¿™ä¾¿æ˜¯A&#x2F;Bå®éªŒçš„åŠ›é‡ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼šFacebookçš„CEOä¼šäº²è‡ªå‚ä¸ä¼—å¤šçš„A&#x2F;Bå®éªŒï¼›LinkedinæŠŠA&#x2F;Bå®éªŒä½œä¸ºäº§å“ç ”å‘ä¸Šçº¿è¿‡ç¨‹ä¸­çš„åŸºæœ¬æµç¨‹ï¼›åœ¨å›½å†…ï¼Œä»¥æˆ‘å¸ä¸ºä»£è¡¨çš„äº’è”ç½‘å…¬å¸æœ‰ç€æµ“æµ“çš„A&#x2F;Bå®éªŒæ°›å›´â€¦â€¦ä¸ºä»€ä¹ˆäº’è”ç½‘è¡Œä¸šè¶Šæ¥è¶Šé’çA&#x2F;Bå®éªŒå‘¢ï¼Ÿäº’è”ç½‘è¡Œä¸šèµ°åˆ°ä»Šå¤©ï¼Œäººå£çº¢åˆ©å·²ç„¶ä¸åœ¨ï¼Œå¤§å¤šæ•°äº’è”ç½‘äº§å“é‡è›®ç”Ÿé•¿çš„æ—¶æœŸå·²ç»è¿‡å»ï¼Œç´§æ¥ç€åˆ°æ¥çš„æ˜¯æŠ€æœ¯çº¢åˆ©çš„æ—¶ä»£ã€‚åœ¨è¿™ä¸€æ—¶æœŸé‡Œï¼Œä¼ä¸šå¼€å§‹å…³æ³¨ç”¨æˆ·çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œç”¨æ•°æ®é©±åŠ¨è¿›è¡Œç²¾ç»†åŒ–è¿è¥ï¼Œç”¨å®éªŒçš„æ–¹å¼è¿›è¡Œç§‘å­¦å†³ç­–ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘æƒ³å¼•ç”¨æˆ‘å¸å®éªŒè¯„ä¼°ç»„åŒå­¦çš„ä¸€æ®µè¯ï¼Œæ¥é˜é‡Šæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä¸æ–­è¿›è¡ŒA&#x2F;Bå®éªŒï¼š ä¸€æ–¹é¢æˆ‘ä»¬æ— æ³•æ‰¿æ‹…ä»»ä½•ä¸€ä¸ªé”™è¯¯ç‰¹æ€§å½±å“ä¸Šäº¿ç”¨æˆ·ä½“éªŒçš„ä¸¥é‡åæœï¼Œå¦ä¸€æ–¹é¢æˆ‘ä»¬åˆå¸Œæœ›èƒ½å¤Ÿåˆ†ç¦»å¹¶é‡åŒ–æ¯ä¸ªç‰¹æ€§çš„å½±å“ã€‚è¿™å°±éœ€è¦æˆ‘ä»¬è®¾è®¡å¹¶åšæŒä½¿ç”¨ä¸€å¥—æ•°æ®é©±åŠ¨çš„æ–¹æ³•ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ä»¥è¾ƒå°çš„é£é™©å¯¹æ–°ç‰¹æ€§è¿›è¡Œè¯„ä¼°ï¼Œç§¯æè¯•é”™ç§¯ç´¯ç»éªŒï¼›å¹¶ä¸”è¿™ä¸ªæ–¹æ³•æœ‰èƒ½åŠ›æ’é™¤å…¶ä»–å› ç´ ï¼ˆå¦‚åŒæ—¶å¼€å‘çš„å…¶ä»–ç‰¹æ€§ã€æ—¶é—´å› ç´ ç­‰ï¼‰çš„å¹²æ‰°ï¼›æœ€åï¼Œé™¤äº†â€œå¥½â€™æˆ–è€…â€˜ä¸å¥½â€œï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªæ–¹æ³•ä¹Ÿèƒ½å¤Ÿç»™å‡ºå®šé‡çš„ç»“æœã€‚ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œæ™®éä½¿ç”¨çš„æ–¹æ³•æ˜¯å°æµé‡éšæœºå®éªŒï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„A&#x2F;Bå®éªŒã€‚ ï¼ˆç‰¹æ€§ï¼šå¸¸å†™åšfeatureï¼Œå¤§è‡´å¯ä»¥ç†è§£ä¸ºåŠŸèƒ½ï¼Œå°¤å…¶æ˜¯è¾ƒå°çš„åŠŸèƒ½ï¼‰åˆ©ç”¨å¤§é‡çš„å®éªŒï¼Œä¼ä¸šèƒ½å¤Ÿä¸æ–­æé«˜è‡ªå·±çš„è¯•é”™èƒ½åŠ›ã€æå‡è¯•é”™æ•ˆç‡ã€é™ä½è¯•é”™é£é™©ã€‚ä»æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ï¼Œäº’è”ç½‘ä¼ä¸šçš„å®åŠ›ä¸å…¶å®æ–½A&#x2F;Bå®éªŒçš„èƒ½åŠ›ç´§å¯†ç›¸å…³ã€‚A&#x2F;Bå®éªŒå¦‚ä½•å‚ä¸å¢é•¿æµç¨‹æ›¾æœ‰å­¦è€…æå‡ºï¼ŒA&#x2F;Bå®éªŒçš„é¢‘ç‡ä¸€å®šç¨‹åº¦ä¸Šå†³å®šç€äº’è”ç½‘ä¼ä¸šå¢é•¿çš„é€Ÿåº¦ã€‚ä¸ºäº†èƒ½å¤Ÿåœ¨æ¿€çƒˆçš„äº’è”ç½‘æˆ˜åœºä¸­æ€å‡ºä¸€æ¡è¡€è·¯ï¼Œå¢é•¿å›¢é˜Ÿéœ€è¦æ¥è¿ä¸æ–­åœ°è¿›è¡Œå®éªŒã€‚é€šå¸¸ä»–ä»¬ä¼šå›´ç»•ç›®æ ‡ï¼Œåœ¨åˆ†ææ•°æ®ã€æå‡ºæƒ³æ³•ã€è¿›è¡Œå®éªŒã€å½’çº³æ€»ç»“å‡ ä¸ªæ­¥éª¤ä¸­å¾ªç¯å¾€å¤ã€‚ A&#x2F;Bå®éªŒå¦‚ä½•å‚ä¸å¢é•¿æµç¨‹æ›¾æœ‰å­¦è€…æå‡ºï¼ŒA&#x2F;Bå®éªŒçš„é¢‘ç‡ä¸€å®šç¨‹åº¦ä¸Šå†³å®šç€äº’è”ç½‘ä¼ä¸šå¢é•¿çš„é€Ÿåº¦ã€‚ä¸ºäº†èƒ½å¤Ÿåœ¨æ¿€çƒˆçš„äº’è”ç½‘æˆ˜åœºä¸­æ€å‡ºä¸€æ¡è¡€è·¯ï¼Œå¢é•¿å›¢é˜Ÿéœ€è¦æ¥è¿ä¸æ–­åœ°è¿›è¡Œå®éªŒã€‚é€šå¸¸ä»–ä»¬ä¼šå›´ç»•ç›®æ ‡ï¼Œåœ¨åˆ†ææ•°æ®ã€æå‡ºæƒ³æ³•ã€è¿›è¡Œå®éªŒã€å½’çº³æ€»ç»“å‡ ä¸ªæ­¥éª¤ä¸­å¾ªç¯å¾€å¤ã€‚ â€” è¿™é‡Œæœ‰ä¸€ä¸ªå¾ªç¯çš„å›¾ ç›®æ ‡ï¼šåœ¨A&#x2F;Bæµ‹è¯•çš„æµç¨‹ä½“ç³»ä¸­ï¼Œå¢é•¿å›¢é˜Ÿé¦–å…ˆè¦æ˜ç¡®æƒ³è¦ä¼˜åŒ–çš„â€œç›®æ ‡â€ã€‚è¿™ç§ç›®æ ‡éœ€è¦æ˜¯å…·ä½“ã€å¯é‡åŒ–çš„ï¼Œè¿™æ ·æ‰èƒ½æ›´åŠ æ¸…æ™°åœ°è¿½è¸ªå®éªŒæ•ˆæœæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚ åˆ†ææ•°æ®ï¼šé€šè¿‡åˆ†ææ•°æ®ï¼Œå‘ç°ç°æœ‰äº§å“æŸä¸ªç¯èŠ‚ä¸­å¯èƒ½å­˜åœ¨çš„é—®é¢˜ã€‚ æå‡ºæƒ³æ³•ï¼šé’ˆå¯¹æ•°æ®åˆ†æç»“æœï¼Œæå‡ºäº§å“ä¼˜åŒ–æƒ³æ³•ï¼Œå¹¶è®¾è®¡ç›¸åº”å®éªŒæ–¹æ¡ˆã€‚åœ¨A&#x2F;Bæµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬çš„æƒ³æ³•éœ€è¦è½¬åŒ–ä¸ºâ€œå‡è®¾â€ï¼Œä¾‹å¦‚ï¼šâ€œå‡è®¾æŠŠå•†å“å”®å–é¡µé¢ä¸»è‰²è°ƒä»è“è‰²æ”¹æˆçº¢è‰²ï¼Œç”¨æˆ·è´­ä¹°ç‡ä¼šæå‡5%â€ã€‚ A&#x2F;Bå®éªŒï¼šæ ¹æ®å‡è®¾å’Œæ–¹æ¡ˆè¿›è¡Œå°æµé‡å®éªŒã€‚ å½’çº³æ€»ç»“ï¼šæ€»ç»“å®éªŒæ•°æ®å’Œç»“è®ºã€‚å¦‚æœå®éªŒç»“æœç¬¦åˆé¢„æœŸï¼Œé‚£ä¹ˆè¿…é€Ÿè¿­ä»£äº§å“ï¼ŒæŠŠä¼˜åŒ–è¿‡çš„ç‰ˆæœ¬æ¨é€è‡³å…¨éƒ¨ç”¨æˆ·ï¼Œä»¥å®ç°å¢é•¿ï¼›å¦‚æœå®éªŒç»“æœä¸ç¬¦åˆé¢„æœŸï¼Œè¿…é€Ÿæ¸…ç©ºå®éªŒä»£ç ï¼Œå›æ»šåˆ°æ—§çš„ç‰ˆæœ¬ã€‚å®éªŒè¿‡åï¼Œæ€»ç»“ç»éªŒï¼Œå¸¦ç€æ­¤æ¬¡å®éªŒçš„ç»éªŒå’Œç»“è®ºï¼Œå†è¿›å…¥ä¸‹ä¸€è½®å®éªŒé—­ç¯ä¹‹ä¸­ã€‚ å®é™…ä¸Šï¼Œæ›¾æœ‰å›½å¤–å¤§å‹äº’è”ç½‘å…¬å¸åˆ†äº«é“ï¼Œåœ¨ä»–ä»¬è¿›è¡Œçš„A&#x2F;Bå®éªŒä¸­ï¼Œåªæœ‰1&#x2F;3çš„å®éªŒä¸ºäº§å“å¸¦æ¥äº†æ­£å‘çš„æå‡ã€‚å‰äºšé©¬é€Šæ•°æ®åˆ†æå›¢é˜Ÿè´Ÿè´£äººç½—å°¼Â·ç§‘å“ˆç»´ä¹Ÿè¯´è¿‡ï¼šâ€œ60%â€”90%çš„æƒ³æ³•éƒ½æ²¡èƒ½æ”¹å–„ä»–ä»¬æƒ³æ”¹å–„çš„æŒ‡æ ‡ã€‚â€æƒ³è¦æˆä¸ºå¢é•¿é»‘å®¢ï¼Œä½ å°±è¦æ¥å—è¿™ä¸ªæ®‹é…·çš„äº‹å®â€”â€”ä½ çš„å¤§å¤šæ•°æƒ³æ³•å¹¶æ²¡æœ‰ç‰¹åˆ«å¤§çš„ä½œç”¨ã€‚ä½†æ˜¯å¦‚æœä¸åšå®éªŒï¼Œä½ æ°¸è¿œä¸ä¼šçŸ¥é“åˆ°åº•å“ªä¸€éƒ¨åˆ†æƒ³æ³•æ˜¯æœ‰ç”¨çš„ï¼Œå“ªä¸€éƒ¨åˆ†æƒ³æ³•æ˜¯æ²¡ç”¨çš„ã€‚Always be testingï¼Œæ‰æ˜¯å½“ä»Šäº’è”ç½‘å…¬å¸åº”æœ‰çš„æ€åº¦ã€‚","date":"2024-12-31","categories":["æ¶æ„è®¾è®¡"],"tags":["åˆ†æµèƒ½åŠ›"]},{"title":"å¹‚ç­‰é—®é¢˜è§£å†³æ–¹æ¡ˆæ±‡æ€»","url":"/2024/12/31/å¹‚ç­‰é—®é¢˜è§£å†³æ–¹æ¡ˆæ±‡æ€»/","content":"æ¦‚å¿µ å¹‚ç­‰ï¼ˆidempotentã€idempotenceï¼‰æ˜¯ä¸€ä¸ªæ•°å­¦ä¸è®¡ç®—æœºå­¦æ¦‚å¿µï¼Œå¸¸è§äºæŠ½è±¡ä»£æ•°ä¸­ã€‚ åœ¨ç¼–ç¨‹ä¸­ï¼Œä¸€ä¸ªå¹‚ç­‰æ“ä½œçš„ç‰¹ç‚¹æ˜¯å…¶ä»»æ„å¤šæ¬¡æ‰§è¡Œæ‰€äº§ç”Ÿçš„å½±å“å‡ä¸ä¸€æ¬¡æ‰§è¡Œçš„å½±å“ç›¸åŒã€‚å¹‚ç­‰å‡½æ•°ï¼Œæˆ–å¹‚ç­‰æ–¹æ³•ï¼Œæ˜¯æŒ‡å¯ä»¥ä½¿ç”¨ç›¸åŒå‚æ•°é‡å¤æ‰§è¡Œï¼Œå¹¶èƒ½è·å¾—ç›¸åŒç»“æœçš„å‡½æ•°ã€‚è¿™äº›å‡½æ•°ä¸ä¼šå½±å“ç³»ç»ŸçŠ¶æ€ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒé‡å¤æ‰§è¡Œä¼šå¯¹ç³»ç»Ÿé€ æˆæ”¹å˜ã€‚ä¾‹å¦‚ï¼Œâ€œgetUsername()å’ŒsetTrue()â€å‡½æ•°å°±æ˜¯ä¸€ä¸ªå¹‚ç­‰å‡½æ•°ã€‚ ç”¨é€šä¿—çš„è¯è®²ï¼šå°±æ˜¯é’ˆå¯¹ä¸€ä¸ªæ“ä½œï¼Œä¸ç®¡åšå¤šå°‘æ¬¡ï¼Œäº§ç”Ÿæ•ˆæœæˆ–è¿”å›çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ ä¸¾å‡ ä¸ªä¾‹å­ï¼š 1.æ¯”å¦‚å‰ç«¯å¯¹åŒä¸€è¡¨å•æ•°æ®çš„é‡å¤æäº¤ï¼Œåå°åº”è¯¥åªä¼šäº§ç”Ÿä¸€ä¸ªç»“æœã€‚ 2.æ¯”å¦‚æˆ‘ä»¬å‘èµ·ä¸€ç¬”ä»˜æ¬¾è¯·æ±‚ï¼Œåº”è¯¥åªæ‰£ç”¨æˆ·è´¦æˆ·ä¸€æ¬¡é’±ï¼Œå½“é‡åˆ°ç½‘ç»œé‡å‘æˆ–ç³»ç»Ÿbugé‡å‘ï¼Œä¹Ÿåº”è¯¥åªæ‰£ä¸€æ¬¡é’±ã€‚ 3.æ¯”å¦‚å‘é€æ¶ˆæ¯ï¼Œä¹Ÿåº”è¯¥åªå‘ä¸€æ¬¡ï¼ŒåŒæ ·çš„çŸ­ä¿¡å¦‚æœå¤šæ¬¡å‘ç»™ç”¨æˆ·ï¼Œç”¨æˆ·ä¼šå´©æºƒã€‚ 4.æ¯”å¦‚åˆ›å»ºä¸šåŠ¡è®¢å•ï¼Œä¸€æ¬¡ä¸šåŠ¡è¯·æ±‚åªèƒ½åˆ›å»ºä¸€ä¸ªï¼Œä¸èƒ½å‡ºç°åˆ›å»ºå¤šä¸ªè®¢å•ã€‚è¿˜æœ‰å¾ˆå¤šè¯¸å¦‚æ­¤ç±»çš„ï¼Œè¿™äº›é€»è¾‘éƒ½éœ€è¦å¹‚ç­‰çš„ç‰¹æ€§æ¥æ”¯æŒã€‚ å¹‚ç­‰æ€§é—®é¢˜æ¶‰åŠçš„åœºæ™¯çš„è§£å†³æ–¹æ¡ˆæ‰€æœ‰å¹‚ç­‰æ€§é—®é¢˜å¤„ç†çš„æ—¶å€™çš„é€šç”¨è§£å†³æ–¹æ³•-æ ‡è®°å¾ç”¨å¯¹ä¸€ç§æ“ä½œ,å¢åŠ ä¸€ä¸ªæ ‡è®°,å¦‚æœæœ‰ç›¸åŒçš„æ ‡è®°éç¬¬ä¸€æ¬¡æ“ä½œå°±ä¸è¿›è¡Œ ä¾‹å­1. æ•°æ®åº“æ“ä½œå¯ä»¥ä½¿ç”¨ç´¢å¼•æˆ‘ä»¬é’ˆå¯¹ä¸€æ¡è®°å½•ä½¿ç”¨å”¯ä¸€çš„ç´¢å¼•æˆ–è€…å”¯ä¸€ç»„åˆç´¢å¼•æ¥è¿›è¡Œå¹‚ç­‰,æ¯”å¦‚ä¸€ä¸ªè®¢å•çš„è®¢å•å· ps : è¿™ç§æƒ…å†µå…¶å®å¯¹åº”ä¸Šç±³å¨œçš„é€šç”¨æ–¹æ³•çš„è¯,å”¯ä¸€ç´¢å¼•æˆ–è€…å”¯ä¸€ç»„åˆç´¢å¼•å°±æ˜¯token å¼•ç”³:ä½¿ç”¨æ•°æ®æ“ä½œä¹Ÿå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·å®ç°å¯¹åº”çš„é€»è¾‘ 2. ä½¿ç”¨åˆ†å¸ƒå¼é”å’Œç´¢å¼•æ–¹æ³•ç±»ä¼¼,ä½¿ç”¨redisæˆ–è€…zk,åœ¨å…¶ä¸­æ·»åŠ ä¸€ä¸ªå”¯ä¸€ç´¢å¼•æ„é€ åˆ†å¸ƒå¼é”æ¥å®ç°å¹‚ç­‰ 3. å…¨å±€çŠ¶æ€æœºå¹‚ç­‰å…¶å®è¿™ä¸ªæ–¹æ³•æ˜¯ä½¿ç”¨çš„é¡ºåºæ¥ä¿è¯å¹‚ç­‰çš„,è¿™ç§åœºæ™¯åœ¨è®¢å•è½¬åŒ–çš„è¿‡ç¨‹ä¸­æ¯”è¾ƒå¸¸è§ æ¯”å¦‚,è®¢å•çš„çŠ¶æ€æ˜¯å·²ä¸‹å•->å·²æ¨ä»“->æœªå‡ºåº“->å·²å‡ºåº“ å¦‚æœç°åœ¨çŠ¶æ€æ˜¯å·²æ¨ä»“æ¥ä¸‹æ¥çš„çŠ¶æ€åº”è¯¥æ˜¯æœªå‡ºåº“,ä½†æ˜¯è¿™ä¸ªæ—¶å€™å¦‚æœç³»ç»Ÿä¼ è¿›æ¥ä¸€ä¸ªçŠ¶æ€æ˜¯å·²ä¸‹å•,è¯´æ˜ä¸æ»¡è¶³å¹‚ç­‰,è¿™ç§æƒ…å†µä¸‹å°±å¯ä»¥é€šè¿‡ä¸šåŠ¡é€»è¾‘ä¿è¯å¹‚ç­‰","date":"2024-12-31","categories":["æ¶æ„è®¾è®¡"]},{"title":"åº“å­˜é—®é¢˜å¤„ç†ä¸Šçš„ä¸€äº›æ€è€ƒ","url":"/2024/12/31/åº“å­˜é—®é¢˜å¤„ç†ä¸Šçš„ä¸€äº›æ€è€ƒ/","content":"æ€è€ƒ å¯¹äºåº“å­˜ç®¡ç†æ¥è¯´ï¼Œæœ€é‡è¦çš„åº“å­˜çš„åˆ†é…ä¸æ‰£å‡ 1ï¼‰ã€æœ€ä¼˜ä»“è°ƒåº¦é€»è¾‘å¦‚æœä¸€ç‰©ä¸€ä»“ï¼ˆä¸€ä¸ªskuåªåœ¨ä¸€ä¸ªä»“åº“æœ‰è´§ï¼‰ï¼Œè¿™ç§é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œæ‰£å‡å“åº”çš„ä»“åº“åº“å­˜å³å¯ã€‚ å®é™…ä¸Šï¼Œä¸€ä¸ªskuå¯èƒ½ä¼šåˆ†å¸ƒåœ¨å¤šä¸ªä»“åº“ä¸­ï¼Œæ­¤æ—¶éœ€è¦æ ¹æ®ç‰©æµæ—¶æ•ˆï¼Œä»“åº“ç­‰çº§å»æ‰£å‡ä»“åº“ä¸­å•†å“ã€‚ 1ã€ æŸ¥è¯¢æ—¶ï¼Œå…ˆç­›é€‰å‡ºæœ‰åº“å­˜çš„ä»“åº“ã€‚2ã€ å°†æ”¶è´§åœ°å€ä¸è¿™äº›ä»“åº“çš„ä¸€çº§é…é€åŒºåŸŸï¼ˆ24å°æ—¶åˆ°è¾¾ï¼‰åŒ¹é…ï¼Œè‹¥æ²¡æœ‰å†å»åŒ¹é…äºŒçº§åŒºåŸŸï¼ˆ2æ—¥åˆ°è¾¾ï¼‰ï¼Œä»¥æ­¤åˆ—æ¨ï¼Œç­›é€‰å‡ºæœ€ä¼˜ä»“åº“ã€‚3ã€ ç­›é€‰å‡ºåŒçº§åŒºåŸŸï¼ˆç‰©æµæ—¶æ•ˆç›¸åŒï¼‰çš„ä»“åº“åï¼Œå†æ ¹æ®ä»“åº“çš„ä¼˜å…ˆçº§è¿›è¡Œç­›é€‰4ã€ è‹¥æ‰”æœ‰å¤šä¸ªä»“åº“ï¼ˆåŒä¸€ç±»å‹çš„ä»“åº“ï¼‰å¾…é€‰ï¼Œä¾‹å¦‚ä¿å®šä»åŒ—äº¬å‘ï¼Œå’Œä»å¤©æ´¥å‘æ—¶æ•ˆç›¸åŒï¼Œå†æ ¹æ®åŒçº§ä»“åº“ä¹‹é—´çš„ä¼˜å…ˆçº§è¿›è¡Œé€‰æ‹©ï¼Œæœ€åé€‰æ‹©ä»“åº“ã€‚5ã€ é€‰æ‹©å¥½ä»“åº“ä¹‹åï¼Œè·å–ä»“åº“ä¸­çš„åº“å­˜æ•°é‡ 2ï¼‰ã€ä¸‹å•æ‰£å‡åº“å­˜ä»¥è´­ä¹°2ä¸ªå•†å“ä¸ºä¾‹ï¼š 1ã€æäº¤è®¢å•åï¼Œåˆ¤æ–­å¯é”€å”®åº“å­˜æ•°é‡æ˜¯å¦å¤Ÿï¼Œè‹¥æ— æ³•æ»¡è¶³ï¼Œåˆ™æç¤ºåº“å­˜ä¸è¶³2ã€è‹¥å¯é”€å”®åº“å­˜æ»¡è¶³æ¡ä»¶æ—¶ï¼Œå¯é”€å”®åº“å­˜å‡2ï¼Œé”å®šåº“å­˜æ•°åŠ 2ï¼ŒæˆåŠŸæäº¤è®¢å•ã€‚3ã€åœ¨ç”¨æˆ·æ”¯ä»˜ä»¥åï¼Œé”€å”®æ€»åº“å­˜å‡2ï¼Œç°è´§åº“å­˜å‡2ï¼Œé”å®šåº“å­˜å‡2ï¼Œå·²é”€å”®åº“å­˜åŠ 2ï¼Œåšå®Œè¿™ä¸€ç³»åˆ—åŠ¨ä½œä¹‹åï¼Œæ‰£å‡åº“å­˜æ‰ç®—ç»“æŸã€‚4ã€è‹¥ä¹°å®¶æ”¯ä»˜å‰å–æ¶ˆäº†è®¢å•ï¼Œåˆ™è¿”è¿˜åº“å­˜ï¼Œå¯é”€å”®åº“å­˜æ•°åŠ 2ï¼Œé”å®šåº“å­˜å‡2ã€‚ å¦‚ä½•æ­£ç¡®æ‰£å‡åº“å­˜ï¼Ÿ åˆ©ç”¨æ•°æ®åº“è¡Œé”ä¿è¯åº“å­˜çš„æ­£ç¡®æ‰£å‡ select sale_stock_num, lock_stock_num from stock where sku &#x3D; :sku update stock set sale_stock_num &#x3D; sale_stock_num -2, lock_stock_num &#x3D; lock_stock_num +2 where sale_stock_num &#x3D; :old_sale_stock_num and lock_stock_num &#x3D; old_lock_stock_num and sku &#x3D; :sku å¦‚æœæŸ¥åˆ°çš„old_sotck_numå·²ç»è¢«å…¶ä»–ç”¨æˆ·æ‰£å‡ï¼Œåˆ™update æ›´æ–°å½±å“è¡Œæ•°æ˜¯0ï¼Œæç¤º â€œåº“å­˜å­˜æ‰£å‡å¤±è´¥ï¼Œè¯·é‡è¯• â€ å¦‚æœä½¿ç”¨æ­¤ç§æ–¹å¼ï¼Œå¤§é‡ç”¨æˆ·åŒä¸€æ—¶åˆ»å¿…å°†æŸ¥åˆ°ç›¸åŒçš„åº“å­˜æ•°stock_numï¼Œåˆ™å¿…å°†æœ‰å¤§é‡ç”¨æˆ·æç¤ºåº“å­˜æ‰£å‡å¤±è´¥ã€‚ åˆ©ç”¨rediså•çº¿ç¨‹ä¿è¯åº“å­˜çš„æ­£ç¡®æ‰£å‡ å°†åº“å­˜æå‰æ”¾åˆ°redisä¸­ï¼Œ æ‰£å‡åº“å­˜çš„æ—¶å€™ï¼Œå…ˆæ‰£å‡redisï¼Œç„¶åå‘MQæ¶ˆæ¯æ›´æ–°æ•°æ®åº“ã€‚ å¦‚æœä½¿ç”¨æ­¤ç§æ–¹å¼ï¼Œå¦‚ä½•ä¿è¯rediså’Œæ•°æ®åº“ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§ã€‚","date":"2024-12-31","categories":["æ¶æ„è®¾è®¡"]},{"title":"æ¶æ„è®¾è®¡-æˆ‘çš„ä¸€ä¸ªæ”¯æŒå¼‚æ­¥æ‹‰å–æ•°æ®å’Œæœ¬åœ°ç¼“å­˜clientæ˜¯å¦‚ä½•è®¾è®¡çš„","url":"/2024/12/31/æ¶æ„è®¾è®¡-æˆ‘çš„ä¸€ä¸ªæ”¯æŒå¼‚æ­¥æ‹‰å–æ•°æ®å’Œæœ¬åœ°ç¼“å­˜clientæ˜¯å¦‚ä½•è®¾è®¡çš„/","content":"æœ€è¿‘çš„å·¥ä½œå†…å®¹æ˜¯å°è£…ä¸€ä¸ªé«˜æ€§èƒ½çš„sdkï¼Œä»¥ä¾¿å’Œæˆ‘ä»¬çš„é…ç½®ä¸­å¿ƒè¿›è¡Œäº¤äº’ï¼Œè¿™é‡Œæ•´ç†ä¸€ä¸‹æˆ‘æ˜¯å¦‚ä½•è®¾è®¡ 1. éœ€æ±‚åˆ†æ æˆ‘ä»¬è¦æ”¯æŒå’Œé…ç½®ä¸­å¿ƒçš„äº¤äº’ï¼ˆç½‘ç»œIOï¼‰ æ”¯æŒå®¢æˆ·ç«¯ç¼“å­˜åŠŸèƒ½ï¼Œå¹¶ä¸”æ”¯æŒæ–­ç”µé‡å¯ï¼ˆå†…å­˜ç¼“å­˜+æ–‡ä»¶ç¼“å­˜ï¼‰ é…ç½®ä¸­å¿ƒæ²¡æœ‰æ¨é€åŠŸèƒ½ï¼Œsdkéœ€è¦è¿›è¡Œè½®è¯¢ï¼ˆä½¿ç”¨NIOç½‘ç»œæ¨¡å‹è¿›è¡Œè½®è¯¢ï¼‰ è¿™ä¸ªç‚¹å…¶å®è®¾è®¡çš„å¹¶ä¸å¥½ï¼Œæœ€å¥½æ˜¯å¼€å¯ä¸€ä¸ªé•¿é“¾æ¥ï¼Œç”±æœåŠ¡ç«¯æ¨é€è¯·æ±‚æ˜¯æœ€ä½³å®ç°ï¼Œä½†æ˜¯å› ä¸ºé…ç½®ä¸­å¿ƒå’Œå®¢æˆ·ç«¯ä¹‹é—´æœ‰ä¸€ä¸ªä¸­é—´å±‚ï¼Œæ— æ³•å®ç°é•¿é“¾æ¥ï¼Œä¸è¿‡è¿™ä¸¤ä¸ªåœ¨å®ç°ä¸Šæ˜¯ç±»ä¼¼çš„ 2. ä»»åŠ¡åˆ†è§£ é’ˆå¯¹ç½‘ç»œIO æä¾›ä¸¤å¥—æ¨¡å‹ å½“ç¼“å­˜ä¸­æ²¡æœ‰æ‰€éœ€è¦çš„æ•°æ®çš„æ—¶å€™ï¼Œä½¿ç”¨BIOç›´æ¥è¯»æœåŠ¡ç«¯ï¼ˆç¼“å­˜å‡»ç©¿ï¼‰ å½“ç¼“å­˜çš„å­˜åœ¨çš„æ—¶å€™ï¼Œ å°†ç¼“å­˜çš„æ•°æ®æ·»åŠ åˆ°è½®è¯¢é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡å¼‚æ­¥åŒæ­¥æ›´æ–° é’ˆå¯¹ç¼“å­˜è®¾è®¡ å†…å­˜ç¼“å­˜ï¼šé™¤äº†éœ€è¦æä¾›ä¸€ä¸ªæ•°æ®ç¼“å­˜ï¼Œè¿˜éœ€è¦æä¾›ä¸€ä¸ªçŠ¶æ€åŒæ­¥é›†åˆæ¥æ ‡è®°ç¼“å­˜ä¸­æ•°æ®çš„çŠ¶æ€ï¼Œæ¯”å¦‚æ˜¯å¦è¶…æ—¶ï¼Œæ˜¯å¦æœ‰æ•ˆç­‰ é’ˆå¯¹è¿™ä¸ªæƒ…å†µæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªåŠŸèƒ½ç±»â€”çŠ¶æ€å¤„ç†ç±»ï¼Œé€šè¿‡è¿™ä¸ªç±»æ¥å¤„ç†ç¼“å­˜ä¸­çŠ¶æ€åŒæ­¥é›†åˆçš„çŠ¶æ€ï¼Œå¹¶åŒæ­¥å¤„ç†æ•°æ®ç¼“å­˜å¯¹åº”çš„çŠ¶æ€ ps : ä¸ºä»€ä¹ˆè®¾è®¡æˆæ•°æ®å’ŒçŠ¶æ€åˆ†ç¦» -> ä¸ºäº†æ›´é«˜çš„å¯æ§æ€§å’Œè§£è—• 1.å¦‚æœéœ€è¦çŠ¶æ€ç‰¹æ®Šå¤„ç†çš„æ—¶å€™åªéœ€è¦æ‹¿å‡ºçŠ¶æ€é˜Ÿåˆ—å°±å¯ä»¥è¿›è¡Œå¤„ç†äº†ä¸éœ€è¦åŠ¨ç¼“å­˜ 2. å¦‚æœçŠ¶æ€éœ€è¦æ·»åŠ å­—æ®µæˆ–è€…é€»è¾‘ï¼Œåªéœ€è¦ä¿®æ”¹å¯¹åº”çš„çŠ¶æ€é˜Ÿåˆ—å³å¯ï¼Œä¸éœ€è¦ä¿®æ”¹æ•°æ®ç¼“å­˜ æ–‡ä»¶ç¼“å­˜ï¼š è¿™ä¸ªæœ¬è´¨ä¸Šå¾ˆå†…å­˜ç¼“å­˜ç›¸ä¼¼ï¼Œåªæœ‰ä¸€ä¸ªç‚¹å°±æ˜¯å½“ä½¿ç”¨nioè¿›è¡Œæ•°æ®åŒæ­¥çš„æ—¶å€™ï¼Œnioä»ç½‘ç»œä¸­æ‹‰å–çš„æ–°æ•°æ®éœ€è¦åŒæ­¥æ›´æ–°ç¼“å­˜å’Œæ–‡ä»¶ï¼Œæ­¤æ—¶çš„æ–‡ä»¶æ“ä½œåº”è¯¥ä½¿ç”¨nioä¿è¯ä¸å µå¡ã€‚ è½®è¯¢æ–¹æ³• æˆ‘åœ¨æ¡†æ¶ä¸­ä½¿ç”¨çš„NIOç½‘ç»œæ¡†æ¶æ˜¯vert.x å…¶å®å¯ä»¥ç†è§£æˆjavaä¸­çš„promiseæ–¹æ³• è¿™é‡Œæˆ‘åšçš„è½®è¯¢é€»è¾‘å…¶å®éå¸¸ç®€å•è¿‡ç¨‹å¦‚ä¸‹ æ‹¿åˆ°éœ€è¦è¿›è¡Œè½®è¯¢é˜Ÿåˆ— forå¾ªç¯å‘èµ·NIOç½‘ç»œè¯·æ±‚ï¼Œå¹¶ä¸”å¤„ç†ç»“æœ æ›´æ–°ç¼“å­˜çŠ¶æ€ï¼ˆæ›´æ–°ç¼“å­˜ï¼Œå¤„ç†è¶…æ—¶ç­‰é—®é¢˜ï¼‰ è¿˜éœ€è¦é‚£äº›æ”¹è¿›ï¼Ÿ éœ€è¦æ·»åŠ ä¸€ä¸ªé€Ÿç‡æ§åˆ¶å™¨ï¼Œè€ƒè™‘è¿™æ ·ä¸€ä¸ªåœºæ™¯å¦‚æœè½®è¯¢å‘èµ·çš„è¯·æ±‚è¿‡å¤§ï¼Œå°†å¯èƒ½ä¼šæŠŠé…ç½®ä¸­å¿ƒæ‰“å®ï¼Œæ‰€ä»¥sdkéœ€è¦æ§åˆ¶è¯·æ±‚çš„é€Ÿç‡åŠ¨æ€çš„è°ƒæ•´qpsæ¥ä¿è¯æœåŠ¡çš„ç¨³å®šã€‚ 3. sdkæ•´ä½“çš„æ¶æ„å›¾å¦‚ä¸‹","date":"2024-12-31","categories":["æ¶æ„è®¾è®¡"]},{"title":"ç³»ç»Ÿæ¶æ„-Serverless(baas & faas)æ— æœåŠ¡å™¨è®¡ç®—","url":"/2024/12/31/ç³»ç»Ÿæ¶æ„-Serverless-baas---faas-æ— æœåŠ¡å™¨è®¡ç®—/","content":"è‡ªä»2014å¹´AWSæ¨å‡ºLambdaæœåŠ¡åï¼ŒServerlessä¸€è¯è¶Šæ¥è¶Šçƒ­ï¼Œå·²ç»æˆä¸ºä¸€ç§æ–°å‹çš„è½¯ä»¶è®¾è®¡æ¶æ„ï¼Œå³Serverless Architectureã€‚ä½œä¸ºä¸€ç§åŸç”Ÿäºå…¬å…±äº‘çš„æ¶æ„ï¼ŒServerlessæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿæ˜¯å¦èƒ½åº”ç”¨äºä¼ ç»Ÿä¼ä¸šç¨‹åºï¼Ÿæ˜¯å¦é€‚åˆç§æœ‰äº‘åœºæ™¯ï¼Ÿæ˜¯å¦åƒå¾ˆå¤šæ–‡ç« å®£ç§°çš„ä¸€æ ·ï¼Œä¼šæˆä¸ºæœªæ¥æ”¹å˜äº‘è®¡ç®—çš„ä¸­åšåŠ›é‡ï¼Ÿä½œä¸ºä¸€åäº‘è®¡ç®—è¡Œä¸šçš„è€å…µï¼Œä½œè€…æƒ³åœ¨æ­¤æ–‡ä¸­åˆ†äº«ä¸€äº›è‡ªå·±çš„è§‚ç‚¹ã€‚ ä»€ä¹ˆæ˜¯ServerlessServerlesså¹¶ä¸ç¥ç§˜ï¼Œç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­å°±å¯è®²æ˜ã€‚æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªAIåº”ç”¨ï¼Œå¯ä»¥è¯†åˆ«å‡ºå›¾ç‰‡ä¸­äººç‰©çš„äººç§ï¼Œæˆ‘ä»¬æŠŠå®ƒä½œä¸ºä¸€ç§SaaSæœåŠ¡æ¶è®¾åœ¨å…¬å…±äº‘ä¸Šæä¾›ç»™å®¢æˆ·ä½¿ç”¨ï¼Œå…¶å…¸å‹çš„åç«¯æ¶æ„è®¾è®¡å¦‚ä¸‹ï¼š åœ¨è¯¥æ¶æ„ä¸­ï¼Œæˆ‘ä»¬è´­ä¹°çš„äº‘ä¸»æœºä¸Šè¿è¡Œäº†Tomcat Web Serverï¼Œç”¨äºæ‰¿è½½Javaç¼–å†™çš„AIåº”ç”¨ã€‚ç”¨æˆ·é€šè¿‡APIä¸Šä¼ å›¾ç‰‡ã€‚å—é™äºäº‘ä¸»æœºçš„æœ¬åœ°å­˜å‚¨ç©ºé—´ï¼Œä¸ºäº†æ»¡è¶³å¤§é‡å®¢æˆ·åŒæ—¶ä¸Šä¼ å›¾ç‰‡ï¼ŒAIåº”ç”¨å®ç°äº†ä¸€ä¸ªå­˜å‚¨ç½‘å…³å°†å›¾ç‰‡å¯¼å…¥å…¬å…±äº‘çš„å¯¹è±¡å­˜å‚¨ã€‚å›¾ç‰‡å¯¼å…¥å®Œæˆåï¼ŒAIåº”ç”¨ä»å¯¹è±¡å­˜å‚¨è¯»å…¥å›¾ç‰‡è¿›è¡Œè¯†åˆ«ï¼Œå¹¶å°†ç»“æœå­˜å…¥å…¬å…±äº‘çš„æ•°æ®åº“ä¸­ï¼ˆä¾‹å¦‚RDSï¼‰ï¼Œç”¨æˆ·ä½¿ç”¨APIæŸ¥è¯¢ç»“æœã€‚ AIåº”ç”¨ä¸Šçº¿ä¸€æ®µæ—¶é—´åå—åˆ°äº†ç”¨æˆ·çš„æ¬¢è¿ï¼Œè¶Šæ¥è¶Šå¤šçš„å…¬å¸å¼€å§‹ä½¿ç”¨è¯¥æœåŠ¡ã€‚æ ¹æ®ç»Ÿè®¡æ•°æ®ï¼Œå¤§å¤šæ•°å…¬å¸åœ¨ä¸Šåˆ9ç‚¹11ç‚¹ã€ä¸‹åˆ2ç‚¹5ç‚¹é›†ä¸­ä¸Šä¼ å›¾ç‰‡ï¼Œä¸ºäº†æ»¡è¶³è¯¥æ—¶é—´æ®µçš„çªå‘è®¿é—®é‡ï¼Œæˆ‘ä»¬è®¾ç½®äº†å…¬å…±äº‘çš„ Auto-Scalingç­–ç•¥ï¼Œåœ¨è®¿é—®å¢åŠ æ—¶åŠ¨æ€åˆ›å»ºæ›´å¤šçš„äº‘ä¸»æœºæ¥å“åº”å®¢æˆ·ã€‚AIåº”ç”¨çš„æ¶æ„æ¼”åŒ–æˆï¼š åœ¨è¿™ä¸ªæ¶æ„ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åšå¦‚ä¸‹äº‹æƒ…ï¼š ç®¡ç†äº‘ä¸»æœºã€‚æˆ‘ä»¬è¦å…³å¿ƒCPUæ•°é‡ã€å†…å­˜å¤§å°ã€IPåœ°å€ç­‰ç­‰ç³»ç»Ÿçº§çš„é…ç½®ã€‚åŒæ—¶è¿˜è¦å…³å¿ƒäº‘ä¸»æœºçš„æ“ä½œç³»ç»Ÿï¼Œä¸ºéƒ¨ç½²AIåº”ç”¨æ‹Ÿå®šç­–ç•¥ã€‚æ“ä½œç³»ç»Ÿå’ŒTomcatçš„å®‰å…¨è¡¥ä¸ä¹Ÿä¸èƒ½å¿½è§†ï¼Œå¦åˆ™ç«äº‰å¯¹æ‰‹å¯èƒ½é›‡ä½£é»‘å®¢æ¥æ”»å‡»æˆ‘ä»¬çš„ç³»ç»Ÿã€‚ é…ç½®å…¬å…±äº‘çš„Auto-Scalingçš„ç­–ç•¥ï¼Œåº”å¯¹é«˜å³°æœŸçªå‘è®¿é—®é‡ã€‚ ä½¿ç”¨å…¬å…±äº‘çš„å¯¹è±¡å­˜å‚¨å’Œæ•°æ®åº“ã€‚ ç¼–å†™AIåº”ç”¨ã€‚ è¦å®Œæˆè¿™äº›å·¥ä½œï¼Œæˆ‘ä»¬æ—¢è¦å¼€å‘AIåº”ç”¨ï¼Œåˆè¦è¥è¿æ”¯æ’‘ä¸šåŠ¡ï¼ˆä¾‹å¦‚ç®¡ç†äº‘ä¸»æœºç”Ÿå‘½å‘¨æœŸã€ç®¡ç†æ“ä½œç³»ç»Ÿï¼‰ã€‚è¿™æ˜¯å½“å‰æ¶æ„çš„ç°å®ï¼šä¸º20%çš„æ ¸å¿ƒä¸šåŠ¡è¥è¿80%çš„æ”¯æ’‘ä¸šåŠ¡ã€‚ ä¸‹é¢ç”¨Serverlessæ¶æ„æ”¹å†™AIåº”ç”¨ï¼š å¤šä¸ªè¿è¡ŒAIåº”ç”¨ä»£ç çš„è¿›ç¨‹è¢«å¯åŠ¨ï¼Œå¹¶å‘å¤„ç†ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡ã€‚ åœ¨Serverlessæ¶æ„çš„AIåº”ç”¨ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦åšä¸¤ä»¶äº‹æƒ…ï¼š ä½¿ç”¨å…¬å…±äº‘çš„å¯¹è±¡å­˜å‚¨å’Œæ•°æ®åº“ã€‚ ç”¨å…¬å…±äº‘çš„Serverlessæ¡†æ¶ç¼–å†™AIåº”ç”¨ã€‚ ä¸ä¹‹å‰çš„æ¶æ„ç›¸æ¯”ï¼Œæˆ‘ä»¬ä¸å†è¥è¿äº‘ä¸»æœºã€æ“ä½œç³»ç»Ÿã€Tomcatï¼ŒåŒæ—¶ä¹Ÿä¸éœ€è¦é…ç½®Auto-Scaling Groupï¼Œå…¬å…±äº‘çš„Serverlessæ¡†æ¶ä¼šåœ¨æ¯ä¸ªå›¾ç‰‡ä¸Šä¼ å®Œæˆåå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹è¿è¡ŒAIåº”ç”¨ï¼Œè‡ªåŠ¨å®ç°æ°´å¹³æ‰©å±•ã€‚æˆ‘ä»¬ç»ˆäºåªéœ€è¦å…³å¿ƒæ ¸å¿ƒä¸šåŠ¡äº†ï¼Œç”¨Serverlessæ¡†æ¶æ”¯æŒçš„è¯­è¨€ï¼ˆä¾‹å¦‚AWS Lambdaå°±æ”¯æŒJava, Pythonå’ŒJVMç³»è¯­è¨€ï¼‰ç¼–å†™AIåº”ç”¨ï¼Œä¸€åˆ‡éæ ¸å¿ƒä¸šåŠ¡éƒ½å¤–åŒ…ç»™äº†å…¬å…±äº‘è¥è¿å•†ã€‚ æˆ‘ä»¬çš„Serverless AIåº”ç”¨ç”¨åˆ°äº†ä¸¤ç§æŠ€æœ¯ã€‚é¦–å…ˆä½¿ç”¨äº†å…¬å…±äº‘æä¾›çš„å¯¹è±¡å­˜å‚¨å’Œæ•°æ®åº“æœåŠ¡ï¼Œç»Ÿç§°ä¸ºBaaSï¼ˆBackend as a Serviceï¼Œåç«¯å³æœåŠ¡ï¼‰ã€‚å…¶æ¬¡ç”¨äº†Lambdaæ¡†æ¶ï¼Œç§°ä¸ºFaaS(Functions as a Serviceï¼Œå‡½æ•°å³æœåŠ¡)ã€‚ ä½¿ç”¨BaaSå’ŒFaaSæ˜¯Serverlessåº”ç”¨çš„åŸºæœ¬ç‰¹å¾ï¼Œç¬¦åˆè¿™ä¸¤ä¸ªåŸºæœ¬ç‰¹å¾çš„åº”ç”¨å¯ç§°ä¸ºServerlessåº”ç”¨ã€‚ æ˜¯BaaSï¼Œä¸æ˜¯PaaS AIåº”ç”¨ç”¨åˆ°äº†å¯¹è±¡å­˜å‚¨å’Œæ•°æ®åº“ï¼Œå°†æ¥æˆ–è®¸è¿˜ä¼šç”¨åˆ°æ¶ˆæ¯é˜Ÿåˆ—ã€‚ç›´è§‚æ„Ÿè§‰æ˜¯åœ¨ä½¿ç”¨PaaSï¼Œä¸ºä»€ä¹ˆè¿˜è¦é€ ä¸€ä¸ªæ–°è¯BaaSï¼ŸæŠ€æœ¯åœˆæœ‰å¤ªå¤šä»¤äººæ··æ·†çš„æœ¯è¯­äº†ã€‚ BaaSå¹¶éPaaSï¼Œå®ƒä»¬çš„åŒºåˆ«åœ¨äºï¼šPaaSéœ€è¦å‚ä¸åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒBaaSåˆ™ä»…ä»…æä¾›åº”ç”¨ä¾èµ–çš„ç¬¬ä¸‰æ–¹æœåŠ¡ã€‚å…¸å‹çš„PaaSå¹³å°éœ€è¦æä¾›æ‰‹æ®µè®©å¼€å‘è€…éƒ¨ç½²å’Œé…ç½®åº”ç”¨ï¼Œä¾‹å¦‚è‡ªåŠ¨å°†åº”ç”¨éƒ¨ç½²åˆ°Tomcatå®¹å™¨ä¸­ï¼Œå¹¶ç®¡ç†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€‚BaaSä¸åŒ…å«è¿™äº›å†…å®¹ï¼ŒBaaSåªä»¥APIçš„æ–¹å¼æä¾›åº”ç”¨ä¾èµ–çš„åç«¯æœåŠ¡ï¼Œä¾‹å¦‚æ•°æ®åº“å’Œå¯¹è±¡å­˜å‚¨ã€‚BaaSå¯ä»¥æ˜¯å…¬å…±äº‘æœåŠ¡å•†æä¾›çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç¬¬ä¸‰æ–¹å‚å•†æä¾›çš„ï¼Œä¾‹å¦‚Facebookæ”¶è´­çš„Parseå°±æ˜¯è‘—åçš„MBaaSæä¾›å•†ï¼ˆMobile Backend as a Serviceï¼‰ã€‚ä»åŠŸèƒ½ä¸Šè®²ï¼ŒBaaSå¯ä»¥çœ‹ä½œPaaSçš„ä¸€ä¸ªå­é›†ï¼Œå³æä¾›ç¬¬ä¸‰æ–¹ä¾èµ–ç»„ä»¶çš„éƒ¨åˆ†ã€‚ FaaSæ˜¯Serverlessçš„æ ¸å¿ƒ AIåº”ç”¨æœ€åˆæ˜¯ä¸€ä¸ªå…¸å‹Javaç¨‹åºï¼Œå®ƒå¯èƒ½ä½¿ç”¨Springè¿™æ ·çš„æŠ€æœ¯ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ¡†æ¶ç¡®ä¿ç¨‹åºçš„å„ä¸ªç»„ä»¶èƒ½å¤Ÿè¢«æ­£ç¡®åŠ è½½ï¼Œéœ€è¦MVCæ¥ä¿è¯REST APIè¢«æ­£ç¡®çš„Controllerå¤„ç†ã€‚AIåº”ç”¨éƒ¨ç½²åœ¨Tomcatå®¹å™¨ä¸­ï¼Œè¿è¡Œåœ¨äº‘ä¸»æœºä¸Šï¼Œ7 x 24å°æ—¶è¿è¡Œï¼Œæˆ‘ä»¬æä¾›ä¸é—´æ–­çš„æœåŠ¡ã€‚åœ¨å¤œé‡Œ12ç‚¹åˆ°æ—©æ™¨8ç‚¹ï¼Œå‡ ä¹æ²¡æœ‰ç”¨æˆ·ä½¿ç”¨ï¼Œä½†æˆ‘ä»¬è¿˜å¾—è®©å®ƒå¾…åœ¨é‚£é‡Œï¼Œé˜²æ­¢æ·±å¤œå¶å°”ä½¿ç”¨çš„ç”¨æˆ·å¾—åˆ°ä¸€ä¸ª503é”™è¯¯è€Œè¯¯ä¼šAIæœåŠ¡ä¸ç¨³å®šã€‚æˆ‘ä»¬ä¸ºè´­ä¹°çš„äº‘ä¸»æœºä»˜é’±ï¼Œå°½ç®¡ä¸€åŠçš„æ—¶é—´å®ƒçš„CPUä½¿ç”¨ç‡å‡ ä¹ä¸º0ï¼Œä½†æ²¡æœ‰å…¬å…±äº‘æ˜¯æŒ‰CPUä½¿ç”¨ç‡è®¡è´¹çš„ï¼Œä¸å·¥ä½œçš„æ—¶é—´ä¹Ÿå¾—ä»˜é’±ã€‚æˆ‘ä»¬å¿…é¡»å…³å¿ƒAuto-Scaling Groupçš„é…ç½®ï¼Œå¦‚ä½•å‡†ç¡®çš„é…ç½®Auto-Scalingç­–ç•¥æ˜¯ä¸€ä¸ªæŠ€æœ¯æ´»ï¼Œéœ€è¦é•¿æœŸçš„ç»éªŒç§¯ç´¯ï¼Œåœ¨æ—©æœŸæˆ‘ä»¬ä¸å¾—ä¸å¤šéƒ¨ç½²ä¸€äº›ç©ºé—²çš„äº‘ä¸»æœºä»¥ä¿è¯æœåŠ¡ä¸ä¼šå› Auto-Scalingçš„é…ç½®ä¸å½“è€Œæ‹¥å¡ã€‚ ç”¨Serverlessæ¶æ„æ”¹å†™äº†AIåº”ç”¨åï¼Œè¿™äº›ç—›è‹¦å°±é€šé€šæ¶ˆå¤±äº†ã€‚Springæ¡†æ¶å’ŒTomcatå»æ‰äº†ï¼Œç”¨Lambdaçš„Java SDKï¼Œåªéœ€è¦å®ç°ä¸€ä¸ªFunction Handlerå¤„ç†å›¾ç‰‡ä¸Šä¼ å®Œæˆè¿™ä¸ªäº‹ä»¶ï¼Œè¿™è·Ÿå†™ä¸€ä¸ªCallbackä¸€æ ·ç®€å•ã€‚åœ¨Function Handlerä¸­è°ƒç”¨å›¾ç‰‡è¯†åˆ«çš„ç›¸å…³é€»è¾‘ï¼Œç„¶åè°ƒç”¨æ•°æ®åº“çš„REST APIå­˜å‚¨ç»“æœã€‚ä¹Ÿä¸ç”¨æ„å»ºMVCï¼Œä¸ç”¨é…ç½®Tomcatçš„XMLæ–‡ä»¶ï¼Œæˆ‘ä»¬å°†å­˜å‚¨ç½‘å…³è¿™ä¸ªåŠŸèƒ½å®Œå…¨å»é™¤æ‰äº†ï¼Œå› ä¸ºç”¨æˆ·å¯ä»¥ç›´æ¥ä¸Šä¼ å›¾ç‰‡åˆ°å¯¹è±¡å­˜å‚¨ã€‚ AIåº”ç”¨ä¸ç”¨7 x 24å°æ—¶è¿è¡Œäº†ï¼Œæ²¡æœ‰ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡æ—¶å®ƒåªæ˜¯ä¸€ä»½ç¼–è¯‘å¥½çš„ä»£ç ã€‚å½“ç”¨æˆ·å›¾ç‰‡ä¸Šä¼ å®Œæˆæ—¶ï¼ŒFaaSä¼šä¸ºAIåº”ç”¨å¯åŠ¨ä¸€ä¸ªæ–°çš„è¿›ç¨‹æ‰§è¡Œä»£ç ã€‚è¯¥è¿›ç¨‹åœ¨ä»£ç æ‰§è¡Œå®Œæˆåè‡ªåŠ¨é”€æ¯ã€‚æˆ‘ä»¬åªéœ€ä¸ºä»£ç æ‰§è¡Œçš„è¿™å‡ åç§’é’Ÿä»˜é’±ï¼ŒèŠ‚çœäº†å¾ˆå¤šå¼€æ”¯ã€‚ æœ€åæˆ‘ä»¬æ— éœ€æ“å¿ƒAuto-Scalingçš„é—®é¢˜ï¼ŒFaaSä¼šåœ¨éœ€è¦çš„æ—¶å€™è‡ªåŠ¨æ‰©å±•ã€‚ è¿™äº›å°±æ˜¯FaaSçš„æ ¸å¿ƒï¼Œä»ä¸Šé¢çš„ä¾‹å­é‡Œé¢å¯ä»¥å½’çº³å‡ºå®ƒçš„ç‰¹ç‚¹ï¼š FaaSè¿è¡Œçš„æ˜¯åç«¯ä»£ç è€Œä¸æ˜¯æ•´ä¸ªåç«¯ç¨‹åºã€‚ä¾‹å¦‚AIåº”ç”¨ä»…ä»…åŒ…å«å¤„ç†å›¾ç‰‡ä¸Šä¼ å®Œæˆè¿™ä¸ªäº‹ä»¶çš„é€»è¾‘ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„åç«¯ç¨‹åºï¼Œè€Œæ˜¯ä¸€æ®µåç«¯ä»£ç ã€‚ ä»£ç é€šè¿‡äº‹ä»¶è§¦å‘ã€‚ç”±äºä¸å†æœ‰ä¸€ä¸ªé•¿æœŸè¿è¡Œçš„è¿›ç¨‹ç­‰å¾…æˆ–è½®è¯¢ç”¨æˆ·è¯·æ±‚ï¼Œä»£ç åªèƒ½é€šè¿‡ç‰¹æ®Šçš„äº‹ä»¶è§¦å‘ã€‚è¿™äº›äº‹ä»¶ç”±FaaSæ¡†æ¶å®šä¹‰ï¼Œä¾‹å¦‚ä¸Šä¼ æ–‡ä»¶åˆ°å¯¹è±¡å­˜å‚¨ã€æ¶ˆæ¯é˜Ÿåˆ—æ”¶åˆ°ä¸€æ¡æ–°çš„æ¶ˆæ¯ã€API Gatewayæ”¶åˆ°ä¸€ä¸ªæ–°çš„APIè¯·æ±‚ç­‰ã€‚ ä»£ç çš„ç”Ÿå‘½å‘¨æœŸå¾ˆçŸ­ã€‚ä¾‹å¦‚æˆ‘ä»¬çš„AIåº”ç”¨ï¼Œä»æ”¶åˆ°äº‹ä»¶åFunction Handlerè¢«è°ƒç”¨å¼€å§‹ï¼Œåˆ°è°ƒç”¨è¿”å›ç»“æŸï¼Œä¸ä¼šæœ‰å¸¸é©»å†…å­˜çš„è¿›ç¨‹è¿è¡Œã€‚æ­¤å¤–å…¬å…±äº‘æä¾›å•†è¿˜ä¼šé™åˆ¶ä»£ç æ‰§è¡Œçš„æ—¶é—´ï¼Œè¶…å‡ºæ—¶é—´åæ‰§è¡Œä»£ç çš„è¿›ç¨‹ä¼šè¢«å¼ºè¡Œé”€æ¯ã€‚ä¾‹å¦‚AWSçš„Lambdaå¯æ‰§è¡Œçš„æœ€é•¿æ—¶é—´ä¸º5åˆ†é’Ÿã€‚ ä»£ç å¿…é¡»åšåˆ°å½»åº•æ— çŠ¶æ€ï¼Œä¸¤æ¬¡è°ƒç”¨é—´ä¸èƒ½å…±äº«å†…å­˜çŠ¶æ€ã€‚æˆ‘ä»¬çš„AIåº”ç”¨æœ€æ—©ä½¿ç”¨äº†ä¸€ä¸ªå…¨å±€å˜é‡ç»Ÿè®¡å¤„ç†çš„å›¾ç‰‡æ•°ï¼Œæ¯å¤„ç†å®Œä¸€å¼ å›¾ç‰‡è¯¥è®¡æ•°å™¨å°±åŠ ä¸€ã€‚ä½¿ç”¨FaaSåæˆ‘ä»¬ä¸èƒ½å†ç”¨ä»»ä½•å…¨å±€å˜é‡æˆ–å†…å­˜æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚Hashmapï¼‰åœ¨è°ƒç”¨é—´å…±äº«æ•°æ®ï¼Œå› ä¸ºä»£ç è¿è¡Œåœ¨ç‹¬ç«‹çš„è¿›ç¨‹ä¸­ï¼Œæ— æ³•è®¿é—®å¯¹æ–¹çš„å†…å­˜åœ°å€ç©ºé—´ã€‚äºæ˜¯æˆ‘ä»¬å¯¹ä»£ç è¿›è¡Œäº†æ”¹é€ ï¼Œå°†å…¨å±€è®¡æ•°å™¨æ”¾åˆ°äº†å…¬å…±äº‘çš„RedisæœåŠ¡ä¸­ï¼Œè¿™ä¸ºä»£ç å¢åŠ äº†é¢å¤–çš„å¤æ‚æ€§ã€‚ æ°´å¹³æ‰©å±•ä¸å†æ˜¯éœ€è¦æ‹…å¿ƒçš„é—®é¢˜ï¼ŒFaaSä¼šä¸ºæ¯ä¸ªäº‹ä»¶å’Œè¯·æ±‚è¿è¡Œä¸€ä»½æ–°çš„ä»£ç ã€‚ åº”ç”¨çš„éƒ¨ç½²æ–¹å¼ä»ä¸Šä¼ ã€é…ç½®æ•´ä¸ªç¨‹åºå˜æˆä¸Šä¼ ä¸€ä»½æ‰“åŒ…ä»£ç çš„æ–‡ä»¶ï¼ˆä¾‹å¦‚Jaræ–‡ä»¶æˆ–ä¸€ä¸ªZipæ–‡ä»¶ï¼‰ã€‚ Serverlessä¸ºæˆ‘ä»¬å¸¦æ¥äº†ä»€ä¹ˆ å¯¹æ¯”ä¼ ç»Ÿæ¶æ„ï¼Œç”¨Serverlessæ¶æ„æ”¹å†™çš„AIåº”ç”¨å…·æœ‰æ˜¾è‘—çš„ä¼˜åŠ¿ã€‚æˆ‘ä»¬ä¸å†è¿ç»´ä»»ä½•äº‘ä¸»æœºå’Œæ“ä½œç³»ç»Ÿï¼Œç”šè‡³ä¸å†è¿ç»´Tomcatè¿™æ ·çš„Webå®¹å™¨ï¼Œåªéœ€è¦ä¸“æ³¨äºä»£ç æœ¬èº«ï¼Œæ‰€æœ‰é…ç½®ã€åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†çš„å·¥ä½œéƒ½ç”±FaaSæ¡†æ¶è´Ÿè´£ã€‚å…¬å…±äº‘çš„å‡ºç°è®©æˆ‘ä»¬ä»ç‰©ç†ç¡¬ä»¶ç®¡ç†ä¸­è§£æ”¾å‡ºæ¥ï¼ŒServerlessæ¶æ„è®©æˆ‘ä»¬è¿›ä¸€æ­¥ä»æ“ä½œç³»ç»Ÿç®¡ç†ä¸­è§£æ”¾å‡ºæ¥ï¼Œç¬¬ä¸€æ¬¡çœŸæ­£ä¸“æ³¨äºæ ¸å¿ƒä¸šåŠ¡ã€‚ ä¸šåŠ¡ä¹Ÿå˜å¾—æ›´åŠ æ•æ·äº†ã€‚æˆ‘ä»¬åªéœ€è¦ç¼–å†™æ ¸å¿ƒä¸šåŠ¡ç›¸å…³çš„ä»£ç ï¼Œä¾‹å¦‚AIåº”ç”¨ä¸­å›¾åƒè¯†åˆ«çš„éƒ¨åˆ†ã€‚æ— éœ€ç¼–å†™ä»»ä½•åŠ è½½ã€éƒ¨ç½²ã€é…ç½®åº”ç”¨çš„ä»£ç ï¼Œä¾‹å¦‚ä¸å†éœ€è¦é…ç½®systemdåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶åŠ è½½åº”ç”¨ã€‚ æ°´å¹³æ‰©å±•ä¹Ÿä¸æ˜¯é—®é¢˜ã€‚æ­£å¦‚å‰é¢åå¤æåŠçš„ï¼ŒFaaSæ¡†æ¶ä¼šä¸ºæ¯ä¸€ä¸ªäº‹ä»¶ã€æ¯ä¸€ä¸ªAPIè¯·æ±‚éƒ½å¯åŠ¨ä¸€ä»½æ–°çš„è¿›ç¨‹æ‰§è¡Œä»£ç ã€‚è¿™è·Ÿä¼ ç»Ÿåº”ç”¨çš„çº¿ç¨‹æ± æ–¹å¼ç±»ä¼¼ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½åœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ä¸­æ‰§è¡Œï¼ŒåŒºåˆ«åœ¨äºçº¿ç¨‹ä¹‹é—´å…±äº«åŒä¸€å†…å­˜åœ°å€ç©ºé—´ï¼ŒFaaSçš„è¿›ç¨‹é—´ä¸å…±äº«ä»»ä½•å†…å­˜ã€‚ä¸çº¿ç¨‹æ± æœ‰æœ€å¤§çº¿ç¨‹æ•°é™åˆ¶ç±»ä¼¼ï¼ŒFaaSæ¡†æ¶é€šå¸¸ä¹Ÿé™åˆ¶äº†æœ€å¤§è¿›ç¨‹æ•°ï¼Œä¾‹å¦‚AWS Lambdaåœ¨ä¸€ä¸ªRegioné»˜è®¤èƒ½æ‰§è¡Œçš„æœ€å¤§å¹¶å‘è°ƒç”¨æ˜¯600ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„AIåº”ç”¨æœ€å¤šèƒ½åœ¨600ä¸ªè¿›ç¨‹ä¸­åŒæ—¶æ‰§è¡Œã€‚ æœ€åï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ï¼ŒServerlessæ¶æ„ä¸ºæˆ‘ä»¬èŠ‚çœäº†å¤§é‡å¼€æ”¯ã€‚æˆ‘ä»¬åªéœ€ä¸ºAIåº”ç”¨è¿è¡Œçš„æ—¶é—´ä»˜é’±ï¼Œæ— éœ€ä¸ºåº”ç”¨ç­‰å¾…è¯·æ±‚çš„æ—¶é—´ä»˜é’±ã€‚æ°´å¹³æ‰©å±•çš„ç²’åº¦ä»åŸæ¥çš„äº‘ä¸»æœºç»†åŒ–åˆ°è¿›ç¨‹ï¼ŒèŠ‚çœäº†é¢å¤–çš„å¼€æ”¯ï¼Œä¸ç”¨å†è´­ä¹°é—²ç½®çš„äº‘ä¸»æœºæ¥æŠµæ¶ˆAuto-Scalingçš„é…ç½®ä¸ç²¾ç¡®å¸¦æ¥çš„å½±å“ã€‚ä¸šåŠ¡çš„æ•æ·æ€§æé«˜ä¹Ÿé™ä½äº†è¥è¿æˆæœ¬ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦ç²¾é€šæ“ä½œç³»ç»Ÿé…ç½®å’Œç®¡ç†çš„è¥è¿äººå‘˜ï¼Œä¸ä»…èŠ‚çœäº†äººåŠ›æˆæœ¬ï¼Œä¹ŸèŠ‚çœäº†åº”ç”¨ä»å¼€å‘åˆ°ä¸Šçº¿çš„æ—¶é—´ã€‚ Serverlessä¸æ˜¯é“¶å­å¼¹ï¼Œæ˜¯åç«¯å°ç¨‹åºçš„æœªæ¥ serverlessæ¶æ„åœ¨æŸäº›åº”ç”¨åœºæ™¯çš„ä¼˜åŠ¿å¦‚æ­¤æ˜æ˜¾ï¼Œæœ‰äº›æ”¯æŒè€…å·²ç»å¼€å§‹ç‚’ä½œå®ƒä¼šæˆä¸ºé¢ è¦†æ€§çš„äº‘è®¡ç®—æ–°æ¶æ„äº†ã€‚æŠ€æœ¯åœˆå‘æ¥å¦‚æ­¤ï¼Œä¸€äº›äººæ€»åœ¨å­œå­œä¸å€¦çš„å¯»æ‰¾åŒ…æ²»ç™¾ç—…çš„çµè¯ï¼Œå’Œè§£å†³ä¸€åˆ‡é—®é¢˜çš„é“¶å­å¼¹ã€‚â€œAll design is about tradeoffâ€ï¼ŒServerlessä¹Ÿä¸æ˜¯é“¶å­å¼¹ï¼Œå®ƒæœ‰ç‹¬ç‰¹çš„ä¼˜åŠ¿ï¼Œè€Œè¿™äº›ä¼˜åŠ¿ä¹Ÿå¸¦æ¥äº†ä¸å¯é¿å…çš„å±€é™ã€‚ ä¸ºæ¯ä¸ªäº‹ä»¶&#x2F;è¯·æ±‚å¯åŠ¨ä¸€ä¸ªå…¨æ–°çš„è¿›ç¨‹è¿è¡Œä»£ç æ˜¯FaaSçš„æ ¸å¿ƒï¼Œè¿›ç¨‹çš„å¯åŠ¨å»¶æ—¶æ˜¯Serverlessé¢ä¸´çš„ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚å–å†³äºç¼–å†™åº”ç”¨çš„è¯­è¨€ï¼Œå¯åŠ¨å»¶æ—¶å¯ä»¥æ˜¯10æ¯«ç§’ï¼ˆå¦‚ç®€å•çš„Pythonåº”ç”¨ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯1åˆ†é’Ÿï¼ˆå¤æ‚çš„Javaåº”ç”¨ï¼‰ã€‚è¿™æ ·çš„å»¶æ—¶å¯¹äºrealtimeçš„ç¨‹åºæ˜¯éš¾ä»¥æ¥å—çš„ã€‚ç›®å‰Serverlessåº”ç”¨é€šå¸¸è¿è¡Œåœ¨å…¬å…±äº‘çš„å¤šç§Ÿæˆ·ç¯å¢ƒä¸­ï¼Œå¯åŠ¨å»¶æ—¶è¿˜å—ç³»ç»Ÿè´Ÿè½½å½±å“ï¼Œå¾ˆéš¾ä¿è¯åº”ç”¨åœ¨è§„å®šæ—¶é—´å†…è¢«è¿è¡Œã€‚å…¬å…±äº‘æä¾›å•†ç›®å‰æ²¡æœ‰å¯¹Serverlessæä¾›ç›¸åº”çš„SLAä¿è¯ï¼Œç¬”è€…å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼ŒAWS Lambdaè¿˜æ²¡æœ‰ç›¸å…³çš„SLAæ¡æ¬¾ã€‚ Serverlessæ— æ³•ç”¨äºé«˜å¹¶å‘åº”ç”¨ï¼Œä¸ºæ¯ä¸ªè¯·æ±‚å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹å¼€é”€å¤ªé«˜ã€‚ä¾‹å¦‚åŒåä¸€æ”¯ä»˜å®é«˜å³°æœŸæ¯ç§’å¤„ç†çš„äº¤æ˜“æ•°ä¸º8.59ä¸‡ç¬”ï¼Œå¦‚æœä½¿ç”¨Serverlessæ¶æ„ï¼Œæ„å‘³ç€æˆ‘ä»¬çš„ç³»ç»Ÿå†…æ¯ç§’æœ‰8.59ä¸‡ä¸ªè¿›ç¨‹è¢«åˆ›å»ºåˆè¢«é”€æ¯ï¼Œè¿™æ˜¯éš¾ä»¥è´Ÿæ‹…çš„å¼€é”€ã€‚ Serverlessåº”ç”¨æ— æ³•å¸¸é©»å†…å­˜ï¼Œè¿è¡Œçš„æ—¶é—´æ˜¯å—é™çš„ã€‚å¦‚æœä½ çš„åº”ç”¨æ— æ³•åœ¨æ•°åˆ†é’Ÿå†…å®Œæˆçš„å·¥ä½œï¼Œé‚£Serverlessä¸æ˜¯ä½ çš„é€‰æ‹©ï¼Œä¾‹å¦‚AWS Lambdaç»™äºˆè¿›ç¨‹çš„æœ€é•¿è¿è¡Œæ—¶é—´æ˜¯5åˆ†é’Ÿï¼Œè¶…æ—¶åè¿›ç¨‹å°†è¢«å¼ºåˆ¶ç»ˆæ­¢ã€‚è¿™å¯¹ç¨‹åºè®¾è®¡æå‡ºäº†æŒ‘æˆ˜ï¼Œä¾‹å¦‚æˆ‘ä»¬çš„AIåº”ç”¨å¿…é¡»ä¼˜åŒ–åˆ°åœ¨5åˆ†é’Ÿå†…å®Œæˆå¤æ‚å›¾åƒçš„è¯†åˆ«ã€‚æˆ‘ä»¬ä¹Ÿä¸èƒ½ç¼–å†™æ‰§è¡Œé•¿æ—¶é—´IOæ“ä½œçš„åº”ç”¨ï¼Œä¾‹å¦‚å¯¹å¯¹è±¡å­˜å‚¨ä¸­1Tçš„æ•°æ®è¿›è¡Œå¤æ‚ç¼–ç ã€‚ Serverlessè°ƒç”¨ä¹‹é—´ä¸èƒ½å…±äº«çŠ¶æ€è®©ç¼–å†™å¤æ‚ç¨‹åºå˜å¾—æåº¦å›°éš¾ã€‚æ— çŠ¶æ€æ˜¯äº’è¿ç½‘åº”ç”¨è¿½æ±‚çš„ç›®æ ‡ï¼Œä¾‹å¦‚æ»¡è¶³â€œ12è¦ç´ â€çš„åº”ç”¨ã€‚ä½†Serverlesså°†æ— çŠ¶æ€è¿›è¡Œçš„æ›´åŠ å½»åº•ï¼Œåœ¨ä¸åŒçš„è°ƒç”¨ä¹‹é—´æ— æ³•å…±äº«å†…å­˜çŠ¶æ€ï¼Œä¾‹å¦‚ä½¿ç”¨hashmapã€‚æˆ‘ä»¬çš„AIåº”ç”¨ä¸­ç»Ÿè®¡å·²å¤„ç†å›¾ç‰‡æ€»æ•°çš„å…¨å±€è®¡æ•°å™¨åœ¨ä¼ ç»Ÿæ¶æ„ä¸­åªæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä½†åœ¨Serverlessæ¶æ„ä¸­å®ƒå˜æˆå­˜å‚¨åœ¨å†…å­˜æ•°æ®åº“ï¼ˆRedisï¼‰ä¸­çš„ä¸€æ¡è®°å½•ï¼Œæ›´æ–°æˆæœ¬ã€ä¿è¯åŸå­æ€§ç­‰å› ç´ è®©æˆ‘ä»¬çš„ç¼–ç å˜å¾—æ•°å€å¤æ‚ã€‚å¯¹äºå¤§å¤šäº‘åŸç”Ÿçš„äº’è”ç½‘åº”ç”¨æ¥è¯´ï¼Œè¿™ç§å½»åº•çš„æ— çŠ¶æ€æ¶æ„æ˜¯ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ï¼Œè€Œå¯¹äºåŠ¨è¾„æœ‰å‡ åä¸‡ã€ä¸Šç™¾ä¸‡è¡Œä»£ç çš„ã€å……æ»¡äº†çŠ¶æ€çš„ä¼ä¸šåº”ç”¨æ¥è¯´ï¼ŒServerlessçš„æ— çŠ¶æ€æ”¹é€ å‡ ä¹æ˜¯ä¸€ä¸ªæ— æ³•å®Œæˆçš„ä»»åŠ¡ã€‚ ç†Ÿç»ƒçš„å¾®æœåŠ¡çš„æ¶æ„å¸ˆï¼Œå¯¹å°†ä¸šåŠ¡æ‹†åˆ†æˆä¸€ä¸ªä¸ªå•ç‹¬çš„æœåŠ¡éå¸¸ç†Ÿæ‚‰ï¼Œä¹Ÿæœ‰ä¸å°‘çš„ç»å…¸ä¹¦ç±ï¼ˆä¾‹å¦‚ã€ŠBuilding Microservices: Designing Fine-Grained Systemsã€‹ï¼‰æŒ‡å¯¼æˆ‘ä»¬å¦‚ä½•åšã€‚ä½†å³ä½¿æ˜¯ä»–ä»¬ï¼Œåœ¨é¢å¯¹Serverlessæ¶æ„æ—¶ä¹Ÿä¼šæ„Ÿåˆ°å¤´ç—›ï¼Œå¦‚ä½•å°†ä¸šåŠ¡æ‹†åˆ†æˆæˆç™¾ä¸Šåƒä¸ªè¿è¡Œåœ¨ç‹¬ç«‹è¿›ç¨‹ã€è¿è¡Œæ—¶é—´å—é™çš„å‡½æ•°æ˜¯å·¨å¤§çš„æŒ‘æˆ˜ã€‚è€Œæ˜¯å¦éœ€è¦å¦‚æ­¤ç»†ç²’åº¦çš„æ‹†åˆ†æ˜¯éœ€è¦å›ç­”çš„ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚æœ‰äº›é—®é¢˜æˆ–è®¸å˜æˆæ— è§£éš¾é¢˜åˆæˆ–æˆæœ¬æé«˜ï¼Œä¾‹å¦‚åˆ†å¸ƒå¼æ•°æ®åº“äº‹åŠ¡ã€‚ ä¸Šé¢éƒ½æ˜¯Serverlessæ¶æ„çš„ä¸€äº›å›ºæœ‰å±€é™ï¼Œå®ƒä»¬æºäºServerlessæ¶æ„çš„ç‰¹ç‚¹ï¼Œå¾ˆéš¾éšç€æ—¶é—´çš„æ¨ç§»ã€æŠ€æœ¯çš„å®Œå–„è€Œè§£å†³ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½œä¸ºä¸€ä¸ªæ–°çš„æŠ€æœ¯ï¼ŒServerlessè¿˜é¢ä¸´ç€é›†æˆæµ‹è¯•å›°éš¾ã€Vendor Lock-inã€è°ƒè¯•ç›‘æ§å›°éš¾ã€ç‰ˆæœ¬æ§åˆ¶ç­‰è¯¸å¤šä¸è¶³ï¼Œæ¯ä¸€é¡¹éƒ½ä¼šæˆä¸ºé‡‡ç”¨Serverlessæ¶æ„çš„é˜»ç¢ã€‚ ç”±äºè¿™äº›å±€é™æ€§ï¼ŒServerlessæ¶æ„ä¸ä¼šæˆä¸ºå¤æ‚åº”ç”¨çš„æ¶æ„é¦–é€‰ï¼Œç›¸åï¼Œå®ƒåº”è¯¥æ˜¯åç«¯å°ç¨‹åºçš„æœªæ¥ã€‚ äº‘ç«¯çš„åº”ç”¨æœ‰å¤§é‡çš„å°ç¨‹åºåœºæ™¯ï¼Œä¾‹å¦‚è¯†åˆ«ä¸€å¼ å›¾ç‰‡ã€å¯¹ä¸€æ®µéŸ³é¢‘&#x2F;è§†é¢‘è¿›è¡Œç¼–è§£ç ã€å¯¹IOTè®¾å¤‡çš„è¯·æ±‚è¿”å›ä¸€å°æ®µæ•°æ®ã€å°†å®¢æˆ·æäº¤çš„å·¥å•é€šè¿‡é‚®ä»¶é€šçŸ¥å®¢æœäººå‘˜ç­‰ç­‰ã€‚è¿™äº›åŸºäºäº‹ä»¶è§¦å‘çš„å°ç¨‹åºåœ¨ä¼ ç»Ÿæ¶æ„ä¸­å®ç°èµ·æ¥æ˜¯ç›¸å¯¹å¤æ‚çš„ï¼Œä½ å¾€å¾€éœ€è¦ä¸º20%çš„æ ¸å¿ƒä¸šåŠ¡è¿è¥80%çš„æ”¯æ’‘ä¸šåŠ¡ã€‚Serverlesså®Œç¾çš„è§£å†³äº†è¿™äº›é—®é¢˜ï¼Œå®ƒå¯ä»¥æˆä¸ºå¤æ‚åº”ç”¨çš„ä¸€ç§è¡¥å……æ¶æ„ã€‚æˆ‘ä»¬å¯ä»¥å°†æ— çŠ¶æ€çš„ã€äº‹ä»¶è§¦å‘çš„ä¸šåŠ¡æ‹†åˆ†æˆServerlessåº”ç”¨ï¼Œè®©æ•´ä¸ªæ¶æ„å˜å¾—æ›´åŠ çš„ç®€æ´å’Œé«˜æ•ˆã€‚ Serverlessä¹Ÿåœ¨ä¸æ–­æ¼”å˜ï¼Œä¾‹å¦‚AWSæœ€è¿‘å¼•å…¥çš„Step Functionså°±å°è¯•è§£å†³è°ƒç”¨é—´å…±äº«çŠ¶æ€çš„é—®é¢˜ï¼Œå…¶æ•ˆæœæœ‰å¾…è§‚å¯Ÿã€‚ Serverlessä¸æ˜¯ä¼ ç»Ÿçš„PaaS Serverlessè·ŸPaaSä¹‹é—´çš„ç•Œçº¿æ¯”è¾ƒæ¨¡ç³Šï¼Œå¾ˆå¤šäººè®¤ä¸ºServerlessæ˜¯PaaSçš„ä¸€ç§ï¼Œç¬”è€…ä¹Ÿå€¾å‘äºè®¤ä¸ºServerlessæ˜¯ç‰¹æ®Šçš„PaaSå½¢æ€ã€‚ Serverlessç”±BaaSå’ŒFaaSä¸¤éƒ¨åˆ†æ„æˆï¼ŒBaaSè´Ÿè´£æä¾›ä¸šåŠ¡çš„ä¾èµ–æœåŠ¡ï¼ŒFaaSè´Ÿè´£ä¸šåŠ¡çš„éƒ¨ç½²å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œä»è¿™ä¸ªæ„ä¹‰ä¸Šæ¥çœ‹ï¼ŒServerlessçš„è§’è‰²è·ŸPaaSä¸€æ ·ã€‚ä¸ä¼ ç»ŸPaaSçš„åŒºåˆ«åœ¨äºï¼Œä¼ ç»ŸPaaSæ˜¯ä»¥ç¨‹åºä¸ºç²’åº¦ç®¡ç†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼Œè€ŒServerlessæ˜¯ä»¥å‡½æ•°ç²’åº¦ç®¡ç†åº”ç”¨ç”Ÿå‘½å‘¨æœŸã€‚ä¼ ç»ŸPaaSä¸­çš„åº”ç”¨ä¸ºå¸¸é©»å†…å­˜çš„è¿›ç¨‹ï¼Œè€ŒServerlessåº”ç”¨è¿è¡Œå®Œå³é”€æ¯ã€‚æ­¤å¤–ï¼Œä½¿ç”¨ä¼ ç»ŸPaaSï¼Œç”¨æˆ·ä»éœ€è¦å…³å¿ƒæ°´å¹³æ‰©å±•ï¼Œä¾‹å¦‚å¦‚ä½•é…ç½®Auto-Scaling Groupï¼Œä½†Serverlessæ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œæ°´å¹³æ‰©å±•æ˜¯æ¶æ„å¤©ç„¶è‡ªå¸¦çš„åŠŸèƒ½ã€‚ Serverlesså’Œå¾®æœåŠ¡ Serverlesså’Œå¾®æœåŠ¡æ²¡æœ‰ç›´æ¥å…³ç³»ï¼Œä½†ä¸¤è€…æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œä¾‹å¦‚éƒ½éœ€è¦åšä¸šåŠ¡æ‹†åˆ†ã€å¼ºè°ƒæ— çŠ¶æ€ã€å…·æœ‰æ•æ·ç‰¹æ€§ç­‰ã€‚Serverlessåœ¨å¾ˆå¤šæ–¹é¢æ¯”å¾®æœåŠ¡ç²’åº¦æ›´ç»†ï¼Œè¦æ±‚ä¹Ÿæ›´ä¸¥æ ¼ã€‚ä¾‹å¦‚å¾®æœåŠ¡ä»¥æœåŠ¡ä¸ºè¾¹ç•Œæ‹†åˆ†ä¸šåŠ¡ï¼ŒServerlessä»¥å‡½æ•°ä¸ºè¾¹ç•Œæ‹†åˆ†ä¸šåŠ¡ï¼›å¾®æœåŠ¡å¯ä»¥æœ‰è·¨è°ƒç”¨çš„å†…å­˜çŠ¶æ€å…±äº«ï¼ŒServerlessè¦æ±‚è°ƒç”¨å½»åº•æ— çŠ¶æ€ã€‚æ­¤å¤–ï¼ŒServerlessä¾èµ–BaaSæä¾›ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œè€Œå¾®æœåŠ¡å¯ä»¥è‡ªç”±é€‰æ‹©ç¬¬ä¸‰æ–¹ä¾èµ–æ¥æºï¼Œä¾‹å¦‚ä½¿ç”¨æœ¬åœ°æ­å»ºçš„ä¼ ç»Ÿä¸­é—´ä»¶æ ˆï¼ˆå¦‚æœ¬åœ°MySqlå’Œæ¶ˆæ¯æ€»çº¿ï¼‰ã€‚ Serverlesså’Œå®¹å™¨ Serverlesså’Œå®¹å™¨æ˜¯è‹¹æœå’Œæ¡”å­çš„æ¯”è¾ƒï¼Œä¸åœ¨ä¸€ä¸ªå¹³é¢ä¸Šã€‚Serverlessæ˜¯ä¸€ç§è½¯ä»¶è®¾è®¡æ¶æ„ï¼Œå®¹å™¨æ˜¯è½¯ä»¶æ¶æ„çš„æ‰¿è½½è€…ã€‚è™½ç„¶æ²¡æœ‰å…¬å¼€èµ„æ–™ï¼Œä½†æˆ‘ä»¬å¯ä»¥æ¨æµ‹ç±»ä¼¼äºAWS Lambdaè¿™æ ·çš„Serverlessæ¡†æ¶ä½¿ç”¨äº†æŸç§ç¨‹åº¦çš„å®¹å™¨æŠ€æœ¯ï¼Œå¦è€…éš¾ä»¥å®ç°è¯­è¨€æ— å…³å’Œæ¯«ç§’çº§çš„å¯åŠ¨ã€‚å°½ç®¡å·²ç»æœ‰ä¸€äº›å¼€æºé¡¹ç›®ä½¿ç”¨Dockerå®ç°Serverlessä¸­çš„FaaSéƒ¨åˆ†ï¼Œç¬”è€…ä¸è®¤ä¸ºAWS Lambdaè¿™æ ·çš„å…¬å…±Serverlessæ¡†æ¶ç›´æ¥ä½¿ç”¨äº†Dockerï¼Œä¸€å®šæ˜¯ä¸€ç§æ›´ä¸ºè½»é‡çº§ã€ä½“ç§¯æ›´å°çš„å®¹å™¨æŠ€æœ¯ï¼Œæˆ‘ä»¬æˆ–è®¸å¯ä»¥å°†å®ƒç§°ä¸ºNano-Containerã€‚ Serverlesså¯¹ç§æœ‰äº‘æœ‰æ„ä¹‰å—ï¼Ÿ å¯¹äºç§æœ‰äº‘æ¥è¯´ï¼Œç°åœ¨å°†ä¸šåŠ¡è¿å¾€Serverlessæ¶æ„è¿˜ä¸ºæ—¶è¿‡æ—©ã€‚é¦–å…ˆServerlessæ˜¯ä»å…¬å…±äº‘ä¸­æ¼”åŒ–å‡ºæ¥çš„æ–°å‹æ¶æ„ï¼Œé€‚ç”¨äºè¿è¡Œåœ¨å…¬å…±äº‘ä¸Šçš„å°ç¨‹åºã€‚è€Œç§æœ‰äº‘æ›´å¤šæ‰¿è½½çš„æ˜¯è€è€Œç¬¨é‡çš„ä¼ ç»Ÿä¸šåŠ¡ï¼Œéš¾ä»¥ç”¨Serverlessæ¶æ„æ”¹é€ ã€‚å…¶æ¬¡Serverlessä¾èµ–BaaSï¼Œåœ¨ç§æœ‰äº‘ä¸­æ­å»ºå’Œè¿ç»´BaaSæˆæœ¬éƒ½ä¸ä½ï¼Œä½¿ç”¨å…¬å…±BaaSæœåŠ¡åˆå—é™äºç½‘ç»œå¸¦å®½å’Œå»¶æ—¶ï¼Œå®¹æ˜“å¯¼è‡´ç³»ç»Ÿä¸ç¨³å®šã€‚ éšç€ä¼ä¸šåº”ç”¨çš„è¿›ä¸€æ­¥äº‘åŒ–ã€å¼€æºServerlessæ¡†æ¶çš„æˆç†Ÿï¼Œç§æœ‰äº‘çš„Devopsåœºæ™¯ä¹Ÿå¯ä»¥é‡‡ç”¨Serverlessä½œCI&#x2F;CDï¼Œä¾‹å¦‚ç›®å‰Jenkinsæ‰¿æ‹…çš„å¤§éƒ¨åˆ†å·¥ä½œéƒ½å¯ä»¥ç”¨Serverlessæ›¿ä»£ï¼Œå¦‚ç”¨FaaSæ¡†æ¶å¯¹åº”Jenkinsæœ¬èº«ï¼Œä¸Šä¼ çš„ä»£ç å¯¹åº”Jenkins Jobä¸­çš„Bashè„šæœ¬ï¼Œå°†åŸæ¥çš„Jenkins APIè§¦å‘Jobæ”¹ä¸ºè§¦å‘FaaSä¸­çš„ä»£ç ã€‚ æ€»ç»“ Serverlessä½œä¸ºä¸€ç§å…¨æ–°çš„æ¶æ„ï¼Œæ˜¯äº‘è®¡ç®—å‘å±•æ¼”åŒ–çš„å¿…ç„¶ç»“æœã€‚è¿½æ±‚æ›´ç»†ç²’åº¦çš„è®¡è´¹å•å…ƒï¼Œæ›´åŠ ä¸“æ³¨äºæ ¸å¿ƒä¸šåŠ¡ã€å°†æ”¯æ’‘ä¸šåŠ¡å¤–åŒ…ç»™åŸºç¡€è®¾æ–½æä¾›å•†æ˜¯äº‘è®¡ç®—çš„è¶‹åŠ¿ã€‚Serverlessæ¶æ„çš„ç‰¹ç‚¹ï¼Œè®©ç¼–å†™äº‹ä»¶è§¦å‘çš„åç«¯å°ç¨‹åºå˜å¾—æ›´åŠ å®¹æ˜“ã€‚åŒæ—¶å®ƒä¹Ÿæœ‰è‡ªèº«å†…åœ¨çš„å±€é™æ€§ï¼Œå¹¶ä¸é€‚åˆå¤æ‚çš„åº”ç”¨æ¶æ„ã€‚ä»ç›®å‰çš„æƒ…å†µçœ‹ï¼Œéƒ¨åˆ†é‡‡ç”¨Serverlessçš„æ··åˆæ¶æ„å¯¹å…¬å…±äº‘åº”ç”¨æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œç§æœ‰åº”ç”¨é‡‡ç”¨Serverlessè¿˜ä¸ºæ—¶è¿‡æ—©ã€‚äº‘è®¡ç®—æŠ€æœ¯æ­£åœ¨é£é€Ÿå‘å±•ï¼Œæœªæ¥è¿˜æœ‰æ— é™å¯èƒ½ã€‚","date":"2024-12-31","categories":["æ¶æ„è®¾è®¡"]},{"title":"å¯¹äºç¼–å†™ä»£ç çš„æ€è·¯çš„æ€è€ƒ","url":"/2024/12/31/å¯¹äºç¼–å†™ä»£ç çš„æ€è·¯çš„æ€è€ƒ/","content":"è®¾è®¡çš„æ¨¡å¼åœ¨å®é™…åœºæ™¯ä¸­çš„åº”ç”¨è¯´è¿™ä¸ªäº‹æƒ…çš„åŸå› æ˜¯å› ä¸ºä¹‹å‰æ¯”è¾ƒè¿·ä¿¡è®¾è®¡æ¨¡å¼çš„ï¼Œ å–œæ¬¢å»åšä¸€å®šçš„æŠ½è±¡ ä½†æ˜¯å®é™…çš„é¡¹ç›®è¿ç”¨åœºæ™¯çš„æ—¶å€™å…¶å®è®¾è®¡æ¨¡å¼çš„åº”ç”¨è¿˜æ˜¯æ¯”è¾ƒå°‘çš„ï¼Œ æ›´å¯¹çš„æ˜¯æŠ½è±¡çš„æ–¹æ³•ã€‚ è¿™é‡Œä»è®¾è®¡æ¨¡å¼å‡ºå‘ï¼Œ å½’çº³ä¸€ä¸‹æŠ½è±¡ä»£ç çš„åŸºæœ¬æ–¹æ³•å’Œé€»è¾‘ å•ä¸€èŒè´£åŸåˆ™ (Single Responsibility Principle)å¼€æ”¾-å…³é—­åŸåˆ™ (Open-Closed Principle)é‡Œæ°æ›¿æ¢åŸåˆ™ (Liskov Substitution Principle)ä¾èµ–å€’è½¬åŸåˆ™ (Dependence Inversion Principle)æ¥å£éš”ç¦»åŸåˆ™ (Interface Segregation Principle)è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆLaw Of Demeterï¼‰ç»„åˆ&#x2F;èšåˆå¤ç”¨åŸåˆ™ (Composite&#x2F;Aggregate Reuse Principle) æŠ½è±¡çš„æ—¶å€™è¦æŠŠç»†åŒ–åŠŸèƒ½ ï¼ˆæœ€å°å•ä¸€åŸåˆ™ï¼‰ä¸¾ä¸ªä¾‹å­ ï¼Œ æˆ‘ä»¬è¦æŠ½è±¡ä¸€ä¸ªåŠŸèƒ½æ˜¯æ‰“ç”µè¯ ï¼Œ æ‰“ç”µè¯çš„å…·ä½“èƒ½åŠ›åŒ…æ‹¬ ï¼Œ æ‹¨é€šç”µè¯ï¼Œå¼€å§‹é€šè¯ ï¼Œ ç»“æŸå¯¹è¯ æˆ‘ä»¬æŠ½è±¡javaçš„æ—¶å€™æœ¬èƒ½çš„æƒ³å¯ä»¥è¿›è¡Œè¿™æ ·çš„æŠ½è±¡ ä½†æ˜¯è¿™ç§å…¶å®ä¸å¥½çš„ï¼Œ æˆ‘ä»¬æ²¡æœ‰æŠ½è±¡åˆ°è·Ÿå®¶å…·ä½“çš„ç»†èŠ‚ä¸Š ã€‚ æ¯”å¦‚è¯´ï¼Œ æ‰“ç”µè¯å…¶å®å¯¹åº”è®¡ç®—æœºè€Œè¨€æ˜¯åè®®å¼€å§‹ï¼Œ è€Œç»“æŸå¯¹è¯å¯¹åº”çš„åŠŸèƒ½æ˜¯åè®®å…³é—­ ï¼Œ è€Œé€šè¿‡ä¸­å¯¹åº”çš„æ˜¯æ•°æ®ä¼ è¾“ ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ç§æ–¹æ³•åœ¨è¿›è¡ŒæŠ½è±¡ å…¶å®è¿™ä¸ªæ¯”è¾ƒä¾èµ–ç»éªŒç¨‹åº¦çš„ï¼Œå…·ä½“çš„æ‹†åˆ†çš„åˆ¤æ–­æ˜¯ä¾èµ–äºæˆ‘ä»¬è‡ªå·±ï¼Œ ä½†æ˜¯æœ‰ä¸€ä¸ªæ ¸å¿ƒç‚¹å°±æ˜¯è¦ä¿è¯æœ€å°å•ä¸€åŸåˆ™ ï¼Œ å°½å¯èƒ½çš„å½’çº³å’Œç»†åŒ–èƒ½åŠ› ï¼Œ è¿™å°±è¦æ±‚æˆ‘ä»¬å†™ä»£ç çš„æ—¶å€™éœ€è¦åšå¥½å‰æœŸè§„åˆ’å’Œå‡†å¤‡ å¼€æ”¾å…³é—­åŸåˆ™è¿™ä¸ªåŸºæœ¬ä¸Šæ²¡åŠæ³•æ»¡è¶³ ä»–æœ‰ä¸¤ä¸ªæ ¸å¿ƒç‚¹ OCP å¯ä»¥å…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§ï¼Œå¯ç»´æŠ¤æ€§ã€‚ ä¸å¯èƒ½è®©ä¸€ä¸ªç³»ç»Ÿçš„æ‰€æœ‰æ¨¡å—éƒ½æ»¡è¶³ OCP åŸåˆ™ï¼Œæˆ‘ä»¬èƒ½åšåˆ°çš„æ˜¯å°½å¯èƒ½åœ°ä¸è¦ä¿®æ”¹å·²ç»å†™å¥½çš„ä»£ç ï¼Œå·²æœ‰çš„åŠŸèƒ½ï¼Œè€Œæ˜¯å»æ‰©å±•å®ƒã€‚ é‡ç‚¹è®°ä¸€ä¸‹ä¸¤ä¸ªå·¥å‚æ–¹æ³•çš„å®ç°å§ åˆç†ä½¿ç”¨ç»§æ‰¿ - é‡Œæ°æ›¿æ¢åŸåˆ™é‡Œæ°æ›¿æ¢åŸåˆ™é€šä¿—çš„æ¥è®²å°±æ˜¯ï¼šå­ç±»å¯ä»¥æ‰©å±•çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½æ”¹å˜çˆ¶ç±»åŸæœ‰çš„åŠŸèƒ½ã€‚ è¿™ä¸ªå°±ä¸éœ€è¦å»¶ä¼¸äº† ï¼Œ ç°åœ¨çš„ç¼–ç¨‹è¯­è¨€åŸºæœ¬ä¸Šéƒ½ä¿æŒäº†è¿™ä¸ªå±æ€§ ï¼Œ åŒ…æ‹¬ç»§æ‰¿/å¤šæ€/èŒƒå‹çš„èƒ½åŠ›ã€‚ æˆ‘å¯¹äºè¿™ä¸ªçš„ç†è§£å…¶å®æœ‰ä¸¤ä¸ªæ–¹é¢ 1. å°½å¯èƒ½ä¿æŒåŠŸèƒ½çš„å”¯ä¸€å’Œç¡®å®šæ€§-ä¸€ç§ç±»å‹çš„æ–¹æ³•æˆ–è€…å¯¹è±¡ï¼Œ å…·å¤‡ç›¸åŒçš„èƒ½åŠ› 2. å°½å¯èƒ½ä¿æŒç¼–å†™ä»£ç çš„å”¯ä¸€å’Œç¡®å®šæ€§-å¯¹ç»Ÿä¸€ç§æ–¹æ³•å’Œç±»å‹æ“ä½œçš„æµç¨‹æ˜¯ç›¸åŒçš„ï¼Œ åªä¸è¿‡ä¸åŒçš„ç±»å‹ä¹‹é—´å¯èƒ½æœ‰åˆ å‡æˆ–è€…å¢åŠ  3. å°½å¯èƒ½ä¿æŒå¿ƒæ™ºç†è§£ä¸Šå”¯ä¸€æ€§å’Œç¡®å®šæ€§ - é’ˆå¯¹ä¸ç†è§£ï¼Œç³»ç»ŸåŠŸèƒ½çš„ä½¿ç”¨ä¸Šæ¥å£çš„ç±»å‹&#x2F;å¯¹è±¡æ‹¥æœ‰çš„å±æ€§éƒ½æ˜¯ç›¸åŒçš„ ä¾èµ–å€’è½¬åŸåˆ™ DIPæˆ‘ä»¬åœ¨å®ç°ç±»çš„æ—¶å€™å°½å¯èƒ½ä¸è¦åšåˆ°ç›´æ¥å¼•ç”¨ï¼Œ è€Œæ˜¯å°½å¯èƒ½çš„ä½¿ç”¨æ¥å£ï¼Œ è¿™æ ·çš„æ–¹æ³•ä¼šå¯¼è‡´æŠ½è±¡çš„å±‚çº§å’Œèƒ½åŠ›ä¸å¤Ÿåç»­ç»´æŠ¤æˆæœ¬è¿‡é«˜ ï¼Œ ä¸¾ä¸ªä¾‹å­ æ³¨æ„è¿™é‡Œï¼š å®ç°Driverç±»çš„æ—¶å€™ä¸è¦å†™å…¥driverå®ç°ç±»ï¼Œ è€Œæ˜¯è¦å†™å…¥æ¥å£ æ¥å£åˆ†ç¦»åŸåˆ™å¼ºè°ƒä¸åº”è¯¥ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£ï¼›ä¸€ä¸ªç±»å¯¹å¦ä¸€ä¸ªç±»çš„ä¾èµ–åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Šã€‚è¿™ä¸ªè§„åˆ™å’Œ ä¾èµ–å€’è½¬åŸåˆ™ ç›¸è¾…ç›¸æˆï¼Œ å¼ºè°ƒæ¥å£å¤§å°éœ€è¦åˆç† æ¯”å¦‚æ¥å£ ä¸åŒçš„å®ç°ç±»å¯èƒ½éœ€è¦çš„æ–¹æ³• æœ‰ç›¸åŒçš„å’Œä¸æƒ³åŒçš„åœ°æ–¹ï¼Œ å¯ä»¥å¯¹æ¥å£è¿›è¡Œå†æ¬¡æ‹†åˆ†ï¼Œ ç›¸åŒçš„å˜æˆä¸€ä¸ªæ¥å£ï¼Œ ä¸ç›¸åŒçš„å˜æˆå¦ä¸€ä¸ªæ¥å£ï¼Œ å®ç°æ¥å£ç®€åŒ– è¿ªç±³ç‰¹æ³•åˆ™ LODæ ¸å¿ƒç‚¹ï¼Œ ä½¿ç”¨æ–¹æ³•å¯¹å¤–æä¾›æ•°æ®è€Œä¸æ˜¯ä½¿ç”¨ç›´æ¥çš„å¼•ç”¨ï¼Œ è€Œä¸”éœ€è¦æ³¨æ„ä¸€ä¸‹å¼•ç”¨çš„å±‚çº§ï¼Œè¿ªç±³ç‰¹æ³•åˆ™åˆç§°ä¸º æœ€å°‘çŸ¥é“åŸåˆ™ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªå¯¹è±¡åº”è¯¥å¯¹å…¶å®ƒå¯¹è±¡ä¿æŒæœ€å°‘çš„äº†è§£ã€‚é€šä¿—æ¥è¯´å°±æ˜¯ï¼Œåªä¸ç›´æ¥çš„æœ‹å‹é€šä¿¡ã€‚ä¾‹å­å°±ä¸èšäº†ï¼Œ æ ¸å¿ƒç‚¹æ˜¯è¦åˆç†è§„åˆ’ç±»ã€å¯¹è±¡ã€æ–¹æ³•ä¹‹é—´çš„å…³é—­ï¼Œ ä¸è¦æƒ³ä¸åµŒå¥—å¼•ç”¨ï¼Œå±‚çº§éœ€è¦æ¸…æ™° ç»„åˆ&#x2F;èšåˆå¤ç”¨åŸåˆ™ CRPåˆç†å¤„ç†ç»„åˆå’Œæœç”¨çš„å…³ç³»ï¼Œç»„åˆä¼˜äºç»§æ‰¿ã€‚å› ä¸ºç»§æ‰¿ä¼šå¯¼è‡´å­ç±»æ— æ³•æ„ŸçŸ¥åˆ°çˆ¶ç±»çš„å˜åŒ–","date":"2024-12-31","categories":["ç³»ç»Ÿè®¾è®¡"]},{"title":"Friendship å…³äºå‹è°Š","url":"/2024/12/31/Friendship-å…³äºå‹è°Š/","content":"Friends play an important part in our lives, and although we may take the friendship for granted, we often donâ€™t clearly understand how we make friends. While we get on well with a number of people, we are usually friends with only a very few, for example, the average among students is about 6 per person. In all the cases of friendly relationships, two people like one another and enjoy being together, but beyond that, the degree of intimacy between them and the reasons for their shared interest vary enormously. As we get to know people we take into account things like age, race, economic condition, social position, and intelligence. Although these factors are not of prime importance, it is more difficult to get on with people when there is a marked difference in age and background. Some friendly relationships can be kept on argument and discussion, but it is usual for close friends to have similar ideas and beliefs, to have attitudes and interests in commonâ€”they often talk about â€œbeing on the same wavelengthâ€. It generally takes time to reach this point. And the more intimately involved people become, the more they rely on one another. People want to do friends favors and hate to break a promise. Equally, friends have to learn to put up with annoying habits and to tolerate differences of opinion. In contrast with marriage, there are no friendship ceremonies to strengthen the association between two people. But the supporting and understanding of each other that results from shared experiences and emotions does seem to create a powerful bond, which can overcome differences in background, and break down barriers of age, class or race. ç”Ÿæ´»ä¸­ï¼Œæœ‹å‹æ‰®æ¼”ç€ä¸€ä¸ªæä¸ºé‡è¦çš„è§’è‰²ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¯èƒ½æŠŠå‹è°Šè§†ä¸ºç†æ‰€å½“ç„¶ï¼Œå´é€šå¸¸å¹¶ä¸æ¸…æ¥šæœ‹å‹æ˜¯æ€ä¹ˆç»“è¯†çš„ã€‚å°½ç®¡æˆ‘ä»¬ä¸å¾ˆå¤šäººéƒ½ç›¸å¤„èæ´½ï¼Œä½†çœŸæ­£æˆä¸ºæœ‹å‹çš„å´åªæœ‰å°‘æ•°å‡ ä¸ªâ€”â€”æ¯”å¦‚ï¼Œå­¦ç”Ÿå¹³å‡æ¯äººæœ‰6ä¸ªæœ‹å‹ï¼Œå…¶ä¸­ä¸¤äººå¿—è¶£ç›¸æŠ•ï¼Œç›¸å¤„ç”šå¥½ï¼›é™¤æ­¤ä¹‹å¤–ï¼Œæœ‹å‹é—´çš„äº²å¯†ç¨‹åº¦åŠå¿—è¶£ç›¸æŠ•çš„åŸå› å¤§æœ‰ä¸åŒã€‚æˆ‘ä»¬åœ¨å½¼æ­¤ç»“è¯†æ—¶ï¼Œå¸¸ä¼šè€ƒè™‘å¯¹æ–¹çš„å¹´é¾„ï¼Œç§æ—ï¼Œç»æµæ¡ä»¶ï¼Œç¤¾ä¼šåœ°ä½å’Œèªæ˜æ‰æ™ºç­‰ã€‚å°½ç®¡è¿™äº›å› ç´ å¹¶éç‰¹åˆ«é‡è¦ï¼Œä½†å½“äººä»¬åœ¨å¹´é¾„ä¸èƒŒæ™¯æ–¹é¢å­˜åœ¨å¤ªå¤§å·®å¼‚æ—¶ï¼Œå¾€å¾€å¾ˆéš¾ç›¸å¤„ã€‚ æœ‰äº›æœ‹å‹å…³ç³»èƒ½åœ¨ç›¸äº’äº‰è®ºå’Œè®¨è®ºä¸­ç»´æŒã€‚ä½†äº²å¯†çš„æœ‹å‹é€šå¸¸æœ‰ç€ç›¸ä¼¼çš„è§‚ç‚¹å’Œä¿¡ä»°ï¼Œç›¸åŒçš„è§è§£å’Œå…´è¶£â€”â€”å°±æ˜¯å¸¸è¯´çš„â€œå¿—è¶£ç›¸æŠ•â€ï¼Œè¦è¾¾åˆ°è¿™ç§å¢ƒç•Œï¼Œä¸€èˆ¬éœ€è¦å¾ˆé•¿æ—¶é—´çš„ç£¨åˆã€‚è€Œä¸”ï¼Œå½¼æ­¤å…³ç³»è¶Šå¯†åˆ‡ï¼Œä¾èµ–æ€§å°±è¶Šå¼ºçƒˆã€‚äººä»¬æ€»å¸Œæœ›æœ‹å‹é—´äº’å¸®äº’åŠ©ï¼Œæ†æ¶èƒŒä¿¡å¼ƒä¹‰ã€‚åŒæ ·ï¼Œæœ‹å‹é—´å¿…é¡»å­¦ä¼šå®¹å¿å¯¹æ–¹çš„åä¹ æ€§ï¼Œå¹¶æ¥å—å¯¹æ–¹çš„ä¸åŒè§‚ç‚¹ã€‚ ä¸å©šå§»ç›¸åçš„æ˜¯ï¼Œå‹è°Šæ²¡æœ‰ä»ªå¼æ¥å¼ºåŒ–äºŒè€…çš„å…³ç³»ã€‚ä½†æ˜¯ï¼ŒåŸºäºåŒæ–¹å…±åŒçš„ç»å†ï¼Œæƒ…æ„Ÿè€Œäº§ç”Ÿçš„ç†è§£å’Œæ”¯æŒï¼Œèƒ½å…‹æœèƒŒæ™¯çš„å·®å¼‚ï¼Œå¹´é¾„çš„ç•Œé™ï¼Œæ‰“ç ´æ€§åˆ«ï¼Œé˜¶å±‚ä¸ç§æ—çš„å±éšœï¼ŒæŠŠäºŒäººç‰¢ç‰¢åœ°æ‹´åœ¨ä¸€èµ·ã€‚ é“¾æ¥: https://en-brief.xiao84.com/meiwen/2015/26779.html","date":"2024-12-31","categories":["è‹±è¯­"]},{"title":"ç½‘ç»œ-httpåè®®å“åº”æºä»£ç ","url":"/2024/12/31/ç½‘ç»œ-httpåè®®å“åº”æºä»£ç /","content":"æœ€ä¸ºä¸€ä¸ªä¸­å›½äºº,åœ¨è¿›è¡Œåç«¯å¼€å‘çš„æ—¶å€™,ä¸­æ–‡ä¹±ç æ˜¯æœ€é•¿é‡åˆ°çš„é—®é¢˜,è¿™æ¬¡å¥½å¥½è®°å½•ä¸€ä¸‹åœ¨httpè¯·æ±‚ä¸­æµè§ˆå™¨å’Œåå°çš„æœåŠ¡å™¨å¦‚ä½•å¤„ç†httpè¯·æ±‚ä¸­çš„æ–‡å­—ç¼–ç é—®é¢˜ é—®é¢˜å­˜åœ¨çš„æ ¹æœ¬ä½ç½®æµè§ˆå™¨å’ŒæœåŠ¡ç«¯çš„ä¸€æ¬¡httpè¯·æ±‚å¯ç†è§£ä¸ºä¸€æ¬¡å‰ç«¯è¯·æ±‚ä¸€æ¬¡åç«¯å“åº”,å°†è¿™ä¸ªè¿‡ç¨‹åˆ†è§£,æˆ‘ä»¬å°†ä¼šçœ‹åˆ°å‘ç”Ÿhttpå­—ç¬¦è½¬ç ä¸»è¦é›†ä¸­åœ¨å››ä¸ªç‚¹ æµè§ˆå™¨å‘é€æ•°æ® æœåŠ¡ç«¯è§£ææµè§ˆå™¨å‘é€æ•°æ® æœåŠ¡ç«¯è¿”å›æ•°æ® æµè§ˆå™¨å³ç³»æœåŠ¡ç«¯è¿”å›æ•°æ® ç„¶åå¼•ç”³ä¸€ç‚¹ , æ— è®ºå‰ç«¯è¿˜æ˜¯åç«¯è¿›è¡Œè½¬ç çš„æ–¹æ³•æ— éä¸¤ç§ http æ ‡ç­¾ä¸­ä½¿ç”¨çš„ æŒ‡å®šæ ¼å¼ åœ¨httpå¤´ä¸­æŒ‡å®šç›¸å…³çš„http ç¼–ç æ ¼å¼ é¦–å…ˆçœ‹çœ‹ç¬¬ä¸€ç‚¹æµè§ˆå™¨å‘é€æ•°æ® ç¼–ç æµè§ˆå™¨å‘é€è¯·æ±‚æ—¶å€™ä¸»è¦ä¸ºä¸‰ç±» url åœ°å€ è¿™ä¸ªæ—¶å€™çš„ç¼–ç å–å†³äºæµè§ˆå™¨,æµè§ˆå™¨ä½¿ç”¨ä½•ç§ç¼–ç ,å°±æ˜¯ç”¨ä½•ç§ç¼–ç  formè¡¨å• å–å†³äºé¡µé¢çš„ç¼–ç ä¹Ÿå°±æ˜¯ æ ‡ç­¾, æˆ–è€…åç«¯è¿”å›çš„contentTypeçš„chartsetå­—æ®µ æ³¨æ„å½“æ²¡æœ‰è¿™ä¸ªå­—æ®µçš„æ—¶å€™å°†ä¼šä½¿ç”¨æµè§ˆå™¨çš„é»˜è®¤ç¼–ç  ajax è¿™ä¸ªæ—¶å€™å–å†³äºè‡ªå·±å‘é€æ—¶è®¾ç½®çš„httpæŠ¥å¤´ ,å¦‚æœæ²¡æœ‰å°†ä¼šä½¿ç”¨æµè§ˆå™¨é»˜è®¤çš„ç¼–ç æ–¹å¼ æµè§ˆå™¨è§£æç¼–ç æ–¹å¼è¿™ä¸ªå°±å¾ˆç®€å•äº† è¯»å–è¯·æ±‚å¤´çš„contentType ä¸­çš„ç¼–ç æ ¼å¼å°±å¯ä»¥äº† æœåŠ¡å™¨è¿”å›æ•°æ® ç¼–ç æ§åˆ¶ä¸¤ç§æ–¹å¼ åç«¯è®¾ç½®contextType å€¼ ä¸­çš„chartsetæŒ‡å®š å‰ç«¯è§£ææ–¹å¼html æ ‡ç­¾ä¸­ æŒ‡å®š ps å¹¶æ²¡æœ‰æ³¨æ„åˆ°ä¼˜å…ˆçº§,ä»¥åæµ‹è¯•","date":"2024-12-31","categories":["è®¡ç®—æœºç½‘ç»œ"]},{"title":"ç½‘ç»œ-è¯¦è§£httpåè®®-åŸºç¡€æ¦‚å¿µ","url":"/2024/12/31/ç½‘ç»œ-è¯¦è§£httpåè®®-åŸºç¡€æ¦‚å¿µ/","content":"httpåè®®çš„åŸºæœ¬æµç¨‹ urlå’Œuri urlï¼šç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦-è¡¨ç¤ºä¸€ä¸ªç½‘ç»œåœ°å€ uriï¼šç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼Œè¡¨ç¤ºäº’è”ç½‘ä¸Šçš„ä¸€ä¸ªèµ„æºï¼Œä½¿ç”¨çš„urlæ˜¯uriçš„ä¸€éƒ¨åˆ†ï¼ˆhttpï¼‰ï¼Œå…¶ä»–ç›¸å…³çš„æ¯”å¦‚ftpç­‰ httpåè®®çš„ç‰¹ç‚¹åŸºäºè¯·æ±‚å’Œå“åº”ä¸€æ¬¡è¯·æ±‚å¿…å®šè·Ÿéšä¸€æ¬¡ç›¸åº”,æ— çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨cookieå’ŒsessionæŠ€æœ¯è®©çŠ¶æ€æœ‰å“åº” httpåè®®æ”¯æŒçš„è¯·æ±‚å¤´ http1.1æ€§èƒ½æå‡ æŒä¹…é“¾æ¥ï¼šä¹‹å‰çš„httpåè®®éƒ½æ˜¯ä¸€æ¬¡è¯·æ±‚åˆ›å»ºä¸€æ¬¡tcpé“¾æ¥ï¼Œ1.1å‡çº§ä¸ºåˆ›å»ºä¸€æ¬¡å¤šæ¬¡tcpè¯·æ±‚ ç®¡çº¿åŒ–ï¼šè®©httpè¯·æ±‚å¯ä»¥è¿›è¡Œå¼‚æ­¥æ“ä½œ httpåè®®æŠ¥æ–‡ç»“æ„ å‹ç¼©ä¼ è¾“å†…å®¹ï¼šå°†ä¼ è¾“çš„çš„æŠ¥æ–‡å®ä½“ä½¿ç”¨gzipçš„æ–¹æ³•è¿›è¡Œå‹ç¼©ç„¶ååœ¨å‘é€å‡ºå» åˆ†å—ä¼ è¾“ç¼–ç ï¼šé™ä½å‡ºé”™é‡ä¼ çš„ä»£ä»·ï¼Œä½¿ç”¨16ä½è¿›è¡Œå—æ ‡è¯†ï¼Œæœ€åä¸€ä¸ªå—æ ‡è¯†ä¸ºâ€0(CR+LF)â€ ä¸httpåä½œçš„webæœåŠ¡å™¨ï¼ˆ1ï¼‰ä»£ç† ä½œç”¨ï¼šæ¥å—è¯·æ±‚å¹¶è½¬å‘ä¸ªå“åº”çš„å…¶ä»–è¯·æ±‚ ä¼˜åŠ¿ï¼šåˆ©ç”¨ç¼“å­˜å‡å°‘å¸¦å®½ï¼Œæµé‡æ§åˆ¶ï¼Œè®¿é—®æ—¥å¿— ï¼ˆ2ï¼‰ç½‘å…³ ç›¸å½“äºå‡çº§httpè¯·æ±‚ï¼Œè½¬åŒ–æˆå…¶å®ƒåè®® ï¼ˆ3ï¼‰éš§é“ ä¸è¿›è¡Œåè®®è§£æç›´æ¥è¿›è¡Œä¿¡æ¯è½¬åŒ–","date":"2024-12-31","categories":["è®¡ç®—æœºç½‘ç»œ"]},{"title":"ç½‘ç»œ-è¯¦è§£httpåè®®-çŠ¶æ€ç å’ŒæŠ¥æ–‡ä¿¡æ¯","url":"/2024/12/31/ç½‘ç»œ-è¯¦è§£httpåè®®-çŠ¶æ€ç å’ŒæŠ¥æ–‡ä¿¡æ¯/","content":"httpçŠ¶æ€ç¢¼ 2xxè¡¨ç¤ºæˆåŠŸ 200ï¼šOK è¡¨ç¤ºæœåŠ¡å™¨æ­£å¸¸å¤„ç† 206ï¼šè¡¨ç¤ºå®¢æˆ·ç«¯è¿›è¡Œäº†èŒƒå›´è¯·æ±‚ï¼ŒæœåŠ¡è¿”å›è¡Œäº†èŒƒå›´è¯·æ±‚ 3xxé‡å®šå‘ 301ï¼šæ°¸ä¹…é‡å®šå‘ï¼Œè¡¨ç¤ºuriå·²ç»åˆ†é…äº†æ–°çš„åœ°å€ï¼Œä»¥åä½¿ç”¨è¿™ä¸ªuriè®¿é—®èµ„æº 302ï¼šä¸´æ—¶é‡å®šå‘ï¼Œè¡¨ç¤ºåªæ˜¯æš‚æ—¶çš„åˆ†é…äº†æ–°çš„åœ°å€ï¼Œæœ¬æ¬¡è¯·æ±‚ä½¿ç”¨æ–°çš„åœ°å€ 303ï¼šä¸´æ—¶é‡å®šå‘ï¼Œå’Œ302åŒºåˆ«æ—¶è¦æ±‚å®¢æˆ·ç«¯ä½¿ç”¨getæ–¹æ³•è¿›è¡Œè¯·æ±‚ 304:ä¸ºæ»¡è¶³æ¡ä»¶ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å¯ä»¥è¿›è¡Œè¯·æ±‚ï¼Œä½†æ˜¯æ²¡æœ‰æ»¡è¶³headä¸­çš„ï¼ˆif-Ã—ï¼‰ç±»å‹å­—æ®µçš„æ¡ä»¶ 4xxè¡¨ç¤ºå®¢æˆ·ç«¯é”™è¯¯ 400ï¼šè¯­æ³•é”™è¯¯ 401ï¼šéœ€è¦è¿›è¡ŒéªŒè¯ 403ï¼šè®¿é—®è¢«æ‹’ç» 404ï¼šæœåŠ¡å™¨ä¸Šæ— æ³•æ‰¾åˆ°è¢«è¯·æ±‚çš„èµ„æº 5xxæœåŠ¡å™¨é”™è¯¯ 500ï¼šæœåŠ¡å™¨æ•…éšœ 503ï¼šæœåŠ¡å™¨è¶…è´Ÿè·ï¼Œæˆ–åœæœºç»´æŠ¤ï¼ŒæœåŠ¡å™¨è¿”å›Retry-afterè¡¨ç¤ºéœ€è¦çš„æ—¶é—´ httpåè®®é¦–éƒ¨å­—æ®µçš„ä¹¦å†™æ ¼å¼ httpåè®®é€šç”¨é¦–éƒ¨å­—æ®µ cache-Controlæ ¼å¼ ä½œç”¨ï¼šæ“ä½œç¼“å­˜æœºåˆ¶ ç¼“å­˜è¯·æ±‚æŒ‡ä»¤ ç¼“å­˜å“åº”æŒ‡ä»¤ connectionæ§åˆ¶ä»£ç†è¡¨æ˜ç›¸å…³çš„å­—æ®µä¸è¢«è½¬å‘ å’Œç®¡ç†æŒä¹…é“¾æ¥ å…³é—­æŒä¹…é“¾æ¥ å¼€å¯æŒä¹…é“¾æ¥ data åˆ›å»ºæ—¶é—´çš„æŠ¥æ–‡ Trailer é¦–éƒ¨å­—æ®µTrailerä¼šäº‹å…ˆè¯´æ˜æŠ¥æ–‡ä¸»ä½“åè®°å½•äº†é‚£äº›é¦–éƒ¨å­—æ®µã€‚è¯¥é¦–éƒ¨å­—æ®µå¯åº”ç”¨åœ¨HTTP&#x2F;1.1ç‰ˆæœ¬åˆ†å—ä¼ è¾“ç¼–ç æ—¶ã€‚ Transfer-Encoding:chunk http1.1ä¸­è¡¨ç¤ºåˆ†å—è¯·æ±‚ upgradeè¡¨æ˜æ˜¯å¦æ”¯æŒæ›´åŠ é«˜çº§çš„åè®® via ä¸€èˆ¬å’Œtraceè¿ç”¨ç”¨æ¥è¿½è¸ªæœåŠ¡å™¨ä¿¡æ¯ httpåè®®è¯·æ±‚é¦–éƒ¨å­—æ®µ Acceptç­‰ authorizationå’Œproxy-authrizationè®¤è¯ç›¸å…³ï¼š401ç­‰ formä½¿ç”¨ä»£ç†çš„æ—¶å€™å‘Šè¯‰ç”µå­é‚®ç®±çš„åœ°å€ if-xxxif-matchï¼šæ¯”å¯¹matchå‚æ•°å’Œæ–‡ä»¶çš„ETagå€¼ ç›¸åŒè¿”å›200 å¦åˆ™412 if-Modified-Since:è¡¨ç¤ºè¿”å›æ–‡ä»¶çš„æœ€åæ›´æ–°åº•çº¿ï¼Œå¦‚æœæ–‡ä»¶çš„å®é™…æ›´æ–°æ—¶é—´åœ¨å­—æ®µæ—¶é—´ä¹‹å‰åˆ™å¤±è´¥åä¹‹æˆåŠŸ ï¼ˆif-unmodifed-since å’Œè¿™ä¸ªä½œç”¨ç›¸åï¼‰if-no-match:å’Œif-mathch ä½œç”¨ç›¸åï¼Œä¸åŒ¹é…çš„æ—¶å€™è¿”å›æˆåŠŸif-Rangeï¼šå¦‚æœè¯¥å­—æ®µçš„ETagå€¼æˆ–è€…æ—¶é—´ç›¸åŒå°±å…è®¸åšèŒƒå›´èµ„æºè¯·æ±‚ Max-forwardsæŒ‡å®šè½¬å‘çš„æ¬¡æ•° RangeèŒƒå›´è¿”å› TEæŒ‡å®šä¼ è¾“ç¼–ç çš„æ–¹å¼â€“ å¯ä»¥ä½¿ç”¨trailersæŒ‡å®šçš„ç›¸å…³å­—æ®µ User-Agentç”¨æˆ·çš„æµè§ˆå™¨ç›¸å…³çš„ä¿¡æ¯ httpåè®®å“åº”é¦–éƒ¨å­—æ®µ ETagèµ„æºçš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå½“ä½¿ç”¨ä¸åŒçš„è¯­è¨€ç¯å¢ƒçš„æ—¶å€™å¯èƒ½ä¼šå‡ºç°ç›¸åŒçš„uriåœ°å€ä½†æ˜¯æŒ‡å‘çš„å´æ˜¯ä¸åŒçš„èµ„æºï¼Œè¿™å°±ä½¿ç”¨ETagè¿›ä¸€æ­¥æ ‡è¯†æ‰€è¦ä½¿ç”¨çš„èµ„æº locationé…åˆ3xx è¡¨ç¤ºé‡å®šå‘çš„åœ°å€ Retry-afteræŒ‡å®šå¤šä¹…å‘µåœ¨è¿›è¡Œç›¸åº”ï¼Œé…åˆ503 serverè¡¨ç¤ºæœåŠ¡å™¨ä¿¡æ¯ Vary httpåè®®å®ä½“é¦–éƒ¨å­—æ®µ allowæŒ‡å®šæœåŠ¡å™¨æŒ‡å®šçš„uriè¯·æ±‚æ–¹æ³•GETç­‰ Content-*å®ä½“éƒ¨åˆ†çš„ç¼–ç  ExpiresæŒ‡å®šèµ„æºå¤±æ•ˆçš„æ—¥æœŸï¼Œä¼˜å…ˆçº§å°äºCache-Controlï¼šmax-age last-Modifiedè¿”å›æ–‡ä»¶æœ€ç»ˆä¿®æ”¹æ—¥æœŸ å…¶ä»–éhttp&#x2F;1.1é¦–éƒ¨cookieå’Œsetcookiecookieç›¸åº”æ ¼å¼ ç›¸å…³å­—æ®µå±æ€§ Domainï¼šåŸŸï¼Œè¡¨ç¤ºå½“å‰cookieæ‰€å±äºå“ªä¸ªåŸŸæˆ–å­åŸŸä¸‹é¢ã€‚ Pathï¼šè¡¨ç¤ºcookieçš„æ‰€å±è·¯å¾„ã€‚ Expire time&#x2F;Max-ageï¼šè¡¨ç¤ºäº†cookieçš„æœ‰æ•ˆæœŸã€‚expireçš„å€¼ï¼Œæ˜¯ä¸€ä¸ªæ—¶é—´ï¼Œè¿‡äº†è¿™ä¸ªæ—¶é—´ï¼Œè¯¥cookieå°±å¤±æ•ˆäº†ã€‚æˆ–è€…æ˜¯ç”¨max-ageæŒ‡å®šå½“å‰cookieæ˜¯åœ¨å¤šé•¿æ—¶é—´ä¹‹åè€Œå¤±æ•ˆã€‚å¦‚æœæœåŠ¡å™¨è¿”å›çš„ä¸€ä¸ªcookieï¼Œæ²¡æœ‰æŒ‡å®šå…¶expire timeï¼Œé‚£ä¹ˆè¡¨æ˜æ­¤cookieæœ‰æ•ˆæœŸåªæ˜¯å½“å‰çš„sessionï¼Œå³æ˜¯session cookieï¼Œå½“å‰sessionä¼šè¯ç»“æŸåï¼Œå°±è¿‡æœŸäº†ã€‚å¯¹åº”çš„ï¼Œå½“å…³é—­ï¼ˆæµè§ˆå™¨ä¸­ï¼‰è¯¥é¡µé¢çš„æ—¶å€™ï¼Œæ­¤cookieå°±åº”è¯¥è¢«æµè§ˆå™¨æ‰€åˆ é™¤äº†ã€‚ secureï¼šè¡¨ç¤ºè¯¥cookieåªèƒ½ç”¨httpsä¼ è¾“ã€‚ä¸€èˆ¬ç”¨äºåŒ…å«è®¤è¯ä¿¡æ¯çš„cookieï¼Œè¦æ±‚ä¼ è¾“æ­¤cookieçš„æ—¶å€™ï¼Œå¿…é¡»ç”¨httpsä¼ è¾“ã€‚ httponlyï¼šè¡¨ç¤ºæ­¤cookieå¿…é¡»ç”¨äºhttpæˆ–httpsä¼ è¾“ã€‚è¿™æ„å‘³ç€ï¼Œæµè§ˆå™¨è„šæœ¬ï¼Œæ¯”å¦‚javascriptä¸­ï¼Œæ˜¯ä¸å…è®¸è®¿é—®æ“ä½œæ­¤cookieçš„ã€‚ ä»å®¢æˆ·ç«¯å‘é€cookieç»™æœåŠ¡å™¨çš„æ—¶å€™ï¼Œæ˜¯ä¸å‘é€cookieçš„å„ä¸ªå±æ€§çš„ï¼Œè€Œåªæ˜¯å‘é€å¯¹åº”çš„åç§°å’Œå€¼ã€‚ httpé¦–éƒ¨åŸºäºç¼“å­˜ä»£ç†å’Œéç¼“å­˜ä»£ç†è¡Œä¸ºçš„åˆ†ç±» ç«¯åˆ°ç«¯é¦–éƒ¨ : è½¬æ¢è¿‡ç¨‹ä¸­ä¸èƒ½ä¸¢å¤±ï¼Œå¿…é¡»è½¬å‘çš„é¦–éƒ¨ é€è·³é¦–éƒ¨ : http1.1éœ€è¦æä¾›connectionå­—æ®µï¼Œç»è¿‡ä¸€å±‚ä»£ç†ä¹‹åå¯ä»¥ä¸è¿›è¡Œè½¬å‘","date":"2024-12-31","categories":["è®¡ç®—æœºç½‘ç»œ"]},{"title":"aouth2.0-å¯èƒ½å­˜åœ¨çš„å®‰å…¨éšæ‚£","url":"/2024/12/31/aouth2-0-å¯èƒ½å­˜åœ¨çš„å®‰å…¨éšæ‚£/","content":"å®¢æˆ·ç«¯å®‰å…¨éšæ‚£1. CSRF è·¨ç«™æ”»å‡»è§£å†³åŠæ³•ï¼š ä½¿ç”¨å”¯ä¸€çš„statusç æ¥æ ‡è®°è¯·æ±‚ æˆ‘ä»¬çŸ¥é“æœ€åŸºæœ¬çš„aouth2.0åœ¨è¿›è¡Œè®¤è¯çš„è¿‡ç¨‹ä¸­ï¼Œè®¤è¯ä¸­å¿ƒå°†ä¼šè¿”å›302headerå¤´çš„å“åº”ï¼Œé‡å®šå‘callbackåœ°å€ï¼Œå¹¶ä¸”æºå¸¦å‚æ•° ï¼Œ å¦‚æœç¬¬ä¸‰æ–¹åº”ç”¨ç›´æ¥è°ƒç”¨å®¢æˆ·ç«¯å·²ç»è®¤è¯è¿‡çš„ä¿¡æ¯çš„è¯ ï¼Œ å°†ä¼šå¯¼è‡´å‡­æ®çªƒå– è§£å†³CSRFæœ€é€šç”¨æœ‰æ•ˆçš„æ–¹æ³•æ—¶ä½¿ç”¨ä¸Šä¸‹æ–‡å‚æ•° ä»æœ¬è´¨ä¸Šæ¥è®²ä½¿ç”¨statuså‚æ•°æ˜¯å¯¹æ¯ä¸€ä¸ªhttpè¯·æ±‚åŠ ä¸Šä¸€ä¸ªå”¯ä¸€code æ¥è¯æ˜è¿™ä¸ªcodeæ˜¯åˆæ³•çš„ oauthæ ‡å‡†å…¶å®æ˜¯æ˜¯è¦æ±‚ä¸€ä¸ªcode å…¶å®æˆ‘ä»¬å¯ä»¥åˆ¶å®šå¤šä¸ªstatusæˆ–è€…ä¸€ä¸ªhash map æ¥é™ä½status ä¼ªé€ çš„å‘½ä¸­ç‡ 2. å®¢æˆ·ç«¯å‡­æ®å¤±çªƒè§£å†³åŠæ³•ï¼š åŠ¨æ€æ³¨å†Œå®¢æˆ·ç«¯ 2.1. é‡å®šå‘URLåŠ«æŒè§£å†³åŠæ³•ï¼šä½¿ç”¨å®Œå…¨åŒ¹é…çš„æ¨¡å¼æ¥è¿›è¡Œé‡å®šå‘uriæ ¡éªŒ 2.2 é€šè¿‡HTTP Referrer åè®®ï¼Œçªƒå–å¯†ç 2.3 é€šè¿‡å¼€æ”¾é‡å®šå‘å™¨ç›—å–ä»¤ç‰Œè§£å†³åŠæ³•ï¼šç¡®åˆ‡åŒ¹é… 3. æˆæƒç å¤±çªƒ4. å‡­æ®å¤±çªƒåœ¨æŸäº›æƒ…å†µä¸‹,æ”»å‡»è€…ä¹Ÿèƒ½å¤Ÿé€šè¿‡æ¶æ„æ‰‹æ®µç”¨æˆæƒç æ¢å–è®¿é—®ä»¤ç‰Œ,æˆ–è€…ä½¿ç”¨æˆæƒç è¿›è¡ŒæŸç§ CSRF æ”»å‡»ã€‚ï± ä½¿ç”¨ state å‚æ•°,è¿™æ˜¯è§„èŒƒä¸­å»ºè®®çš„(è™½ç„¶ä¸å¼ºåˆ¶è¦æ±‚) ã€‚ï± ç†è§£å¹¶æ…é‡é€‰æ‹©é€‚ç”¨äºåº”ç”¨çš„è®¸å¯ç±»å‹(æµç¨‹) ã€‚ï± éšå¼è®¸å¯ç±»å‹ä¸åº”è¯¥ç”¨åœ¨åŸç”Ÿåº”ç”¨ä¸­,å®ƒæ˜¯ä¸“é—¨ä¾›æµè§ˆå™¨å†…çš„å®¢æˆ·ç«¯ä½¿ç”¨çš„ã€‚ï± åŸç”Ÿåº”ç”¨æ— æ³•å¯¹ client_secret ä¿å¯†,é™¤éæ˜¯åœ¨åŠ¨æ€æ³¨å†Œçš„æƒ…å†µä¸‹åœ¨è¿è¡Œæ—¶é…ç½®client_secretã€‚ï± æ³¨å†Œ redirect_uri æ—¶åº”è¯¥å°½å¯èƒ½åœ°å…·ä½“ã€‚ï± å¦‚æœèƒ½é¿å…,è¯·ä¸è¦ä»¥ URI å‚æ•°çš„å½¢å¼ä¼ é€’ access_tokenã€‚ å—ä¿æŠ¤èµ„æºå®‰å…¨éšæ‚£1. xxs æ”»å‡»æœ¬è´¨ ï¼šä»æœåŠ¡ç«¯è¿”å›çš„æ•°æ®å­˜åœ¨éæ³•æ³¨å…¥çš„jsæ–‡ä»¶ è§£å†³åŠæ³• ï¼š ä½¿ç”¨context-type æ¥è¿‡æ»¤ å½“oauth2.0 åªä½¿ç”¨å‰ç«¯æµç¨‹ï¼Œå®¹æ˜“å¯¼è‡´æˆæƒç ä¸¢å¤± 2. ä»¤ç‰Œé‡æ”¾åœ¨è¿”å›ä»¤ç‰Œçš„è¿‡ç¨‹ä¸­è¢«æ‹¦æˆªçªƒå– è§£å†³åŠæ³•ï¼š ä½¿ç”¨https ä½¿ç”¨ HSTS åè®® ï¼Œ å¢åŠ Strict-Transport-Security: max-age&#x3D;31536000 å¤´éƒ¨ï¼Œå¼ºåˆ¶ä½¿ç”¨HTTPS ï¼Œ å¦‚æœä¸æ˜¯httpså°†ä¼šå¯¼è‡´å†…éƒ¨é‡å®šå‘åˆ°307 æ¥æ€»ç»“ä¸€ä¸‹ç¡®ä¿å—ä¿æŠ¤èµ„æºå®‰å…¨çš„æ–¹æ³•ã€‚ï± åœ¨å—ä¿æŠ¤èµ„æºçš„å“åº”ä¸­è¿‡æ»¤æ‰€æœ‰ä¸å¯ä¿¡çš„æ•°æ®ã€‚ï± ä¸ºæ¯ä¸ªç«¯ç‚¹é€‰æ‹©åˆé€‚çš„ Content-Typeã€‚ï± å°½å¯èƒ½åˆ©ç”¨æµè§ˆå™¨çš„é˜²æŠ¤æœºåˆ¶ä»¥åŠå®‰å…¨å¤´éƒ¨ã€‚ï± å¦‚æœèµ„æºç«¯ç‚¹è¦æ”¯æŒéšå¼è®¸å¯ç±»å‹,åˆ™è¦ä½¿ç”¨ CORSã€‚ï± é¿å…è®©å—ä¿æŠ¤èµ„æºæ”¯æŒ JSONP(å¦‚æœå¯ä»¥çš„è¯) ã€‚ï± æ€»æ˜¯å°† HTTPS ä¸ HSTS ç»“åˆä½¿ç”¨ è®¤è¯ç³»ç»Ÿå®‰å…¨1. webå¸¸è§„å®‰å…¨2. æˆæƒç åŠ«æŒé»‘å®¢å¯èƒ½ä¼šé€šè¿‡æµè§ˆå™¨ å†å²è®°å½•æ‹¦æˆªæˆ–è€…å„ç§httpç›‘å¬æ‰‹æ®µè·å¾—äº† æˆæƒçš„å›è°ƒå‡½æ•°ä¸­çš„å„ç§å‚æ•°ï¼Œæ¯”å¦‚ &#x2F;callback?code&#x3D;SyWhvRM2&state&#x3D;Lwt50DDQKUB8U7jtfLQCVGDL9cnmwHH ä¸ºäº†é˜²æ­¢è¿™ç§æ‹¦æˆªçš„æƒ…å†µ ï¼Œ oauth è§„å®šäº†ä¸€ç³»åˆ—çš„æµç¨‹æ¥å¤„ç†ä»–å®¢æˆ·ç«¯ä¸èƒ½å¤šæ¬¡ä½¿ç”¨åŒä¸€ä¸ªæˆæƒç ã€‚å¦‚æœä¸€ä¸ªå®¢æˆ·ç«¯ä½¿ç”¨äº†å·²ç»è¢«ç”¨è¿‡çš„æˆæƒç ,æˆæƒæœåŠ¡å™¨å¿…é¡»æ‹’ç»è¯¥è¯·æ±‚,å¹¶ä¸”åº”è¯¥å°½å¯èƒ½åœ°æ’¤å›ä¹‹å‰é€šè¿‡è¯¥æˆæƒç é¢å‘çš„æ‰€æœ‰ä»¤ç‰Œã€‚ 3. é‡å®šå‘ urlç¯¡æ”¹è§£å†³åŠæ³•ï¼šå®Œå…¨åŒ¹é… é‡å®šå‘url 4. é‡å®šå‘urlç¯¡æ”¹ æ¨¡æ‹Ÿæˆæƒè¿™ä¸ªæµç¨‹å¾ˆç»å…¸ï¼Œä¹‹å‰æ²¡æœ‰æƒ³åˆ° è§£å†³åŠæ³• ï¼Œ è®¤è¯æœåŠ¡å™¨éœ€è¦çŸ¥é“ä¹‹å‰çš„å›è°ƒåœ°å€ï¼Œå®¢æˆ·ç«¯åœ¨åŒæˆæƒå‡­è¯æ¢å–è®¤è¯å‡­è¯çš„æ—¶å€™éœ€è¦æ ¡éªŒ ï¼ŒäºŒè€…æ˜¯å¦ä¸€è‡´ ä¿éšœæˆæƒæœåŠ¡å™¨å®‰å…¨çš„è´£ä»»é‡å¤§,å› ä¸ºå®ƒæ˜¯æ•´ä¸ª OAuth å®‰å…¨ç”Ÿæ€ç³»ç»Ÿçš„å…³é”®ã€‚ï± æˆæƒç ä½¿ç”¨ä¸€æ¬¡ä¹‹åå°†å…¶é”€æ¯ã€‚ï± æˆæƒæœåŠ¡å™¨åº”è¯¥é‡‡ç”¨ç²¾ç¡®åŒ¹é…çš„é‡å®šå‘ URI æ ¡éªŒç®—æ³•,è¿™æ˜¯å”¯ä¸€å®‰å…¨çš„æ–¹æ³•ã€‚ï± å®Œå…¨æŒ‰ç…§ OAuth æ ¸å¿ƒè§„èŒƒæ¥å®ç°æˆæƒæœåŠ¡å™¨å¯èƒ½ä¼šå¯¼è‡´å®ƒæˆä¸ºä¸€ä¸ªå¼€æ”¾é‡å®šå‘å™¨ã€‚å¦‚æœè¿™ä¸ªé‡å®šå‘å™¨èƒ½å—åˆ°å¦¥å–„çš„ç›‘æ§,åˆ™æƒ…å†µè¿˜å¥½,ä½†ç¨æœ‰ä¸æ…åˆ™ä¼šé¢ä¸´é£é™©ã€‚ï± ç•™æ„åœ¨è¿›è¡Œé”™è¯¯æç¤ºçš„è¿‡ç¨‹ä¸­,ä¿¡æ¯æœ‰å¯èƒ½é€šè¿‡ URI ç‰‡æ®µæˆ–è€… Referrer å¤´éƒ¨é­æ³„éœ²ã€‚ Oauthä»¤ç‰Œæ¼æ´ä»¤ç‰Œä¼ªé€ ã€‚æ”»å‡»è€…å¯èƒ½ä¼šæ„é€ å‡ä»¤ç‰Œæˆ–è€…ç¯¡æ”¹å·²æœ‰çš„æœ‰æ•ˆä»¤ç‰Œ,å¯¼è‡´èµ„æºæœåŠ¡å™¨æˆäºˆå®¢æˆ·ç«¯ä¸å½“çš„è®¿é—®æƒé™ã€‚ä¾‹å¦‚,æ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªä»¤ç‰Œ,ç”¨äºè·å–ä»–æœ¬ä¸èƒ½è®¿é—®çš„ä¿¡æ¯ã€‚æˆ–è€…,æ”»å‡»è€…å¯ä»¥ç¯¡æ”¹ä»¤ç‰Œæ¥æ‰©å¤§ä»¤ç‰ŒåŸæœ¬çš„æƒé™èŒƒå›´ã€‚ï± ä»¤ç‰Œé‡æ”¾ã€‚æ”»å‡»è€…ä¼šå°è¯•ä½¿ç”¨è¿‡å»ä½¿ç”¨è¿‡å¹¶ä¸”å·²ç»è¿‡æœŸçš„æ—§ä»¤ç‰Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹,èµ„æºæœåŠ¡å™¨ä¸åº”è¯¥è¿”å›ä»»ä½•æœ‰æ•ˆçš„ä¿¡æ¯,è€Œåº”è¯¥æç¤ºé”™è¯¯ã€‚å…·ä½“æ¥è¯´æœ‰è¿™æ ·çš„æƒ…å½¢:æ”»å‡»è€…é¦–å…ˆé€šè¿‡åˆæ³•æ‰‹æ®µè·å–è®¿é—®ä»¤ç‰Œ,ç„¶ååœ¨ä»¤ç‰Œè¿‡æœŸå¾ˆä¹…ä¹‹åå†å°è¯•ä½¿ç”¨è¯¥ä»¤ç‰Œã€‚ï± ä»¤ç‰Œé‡å®šå‘ã€‚æ”»å‡»è€…å°†ç”¨äºæŸä¸€èµ„æºæœåŠ¡å™¨çš„ä»¤ç‰Œç”¨æ¥è®¿é—®å¦ä¸€èµ„æºæœåŠ¡å™¨,è€Œè¯¥èµ„æºæœåŠ¡å™¨è¯¯è®¤ä¸ºä»¤ç‰Œæœ‰æ•ˆã€‚æ­¤æƒ…å½¢æ˜¯è¿™æ ·çš„:æ”»å‡»è€…å…ˆåˆæ³•åœ°è·å–æŸä¸€ç‰¹å®šèµ„æºæœåŠ¡å™¨çš„è®¿é—®ä»¤ç‰Œ,ç„¶åå°†è¯¥ä»¤ç‰Œå‡ºç¤ºç»™å¦å¤–ä¸€ä¸ªèµ„æºæœåŠ¡å™¨ã€‚ï± ä»¤ç‰Œä¿¡æ¯æ³„éœ²ã€‚ä»¤ç‰Œå¯èƒ½ä¼šå«æœ‰ä¸€äº›å…³äºç³»ç»Ÿçš„æ•æ„Ÿä¿¡æ¯,è€Œè¿™äº›ä¿¡æ¯æ˜¯ä¸åº”è¯¥é€éœ²ç»™æ”»å‡»è€…çš„ã€‚ä¸å‰ä¸€ä¸ªé—®é¢˜ç›¸æ¯”,ä¿¡æ¯æ³„éœ²ä¼¼ä¹æ˜¯ä¸ªå°é—®é¢˜,ä½†ä»ç„¶éœ€è¦å°å¿ƒã€‚ ä¸€ç§ä¼˜åŒ–æ–¹æ³•ï¼Œä½¿ç”¨PKCEçš„å®¢æˆ·ç«¯è·å–æ–¹å¼æ¥è·å–æˆæƒç  ä½†æ­£æ˜¯è¿™æ ·çš„ç®€æ´æ€§å¯¹è´¯ç©¿ç³»ç»Ÿå§‹ç»ˆçš„ä»¤ç‰Œä¿æŠ¤æå‡ºäº†è¦æ±‚ã€‚ï± å¿…é¡»ä½¿ç”¨ TLS è¿™æ ·çš„å®‰å…¨ä¼ è¾“å±‚æœºåˆ¶æ¥ä¼ é€’è®¿é—®ä»¤ç‰Œã€‚ï± å®¢æˆ·ç«¯åº”è¯¥è¯·æ±‚å°½å¯èƒ½å°‘çš„ä¿¡æ¯(åœ¨æƒé™èŒƒå›´çš„è®¾ç½®ä¸Šå°½é‡ä¿å®ˆ) ã€‚ï± æˆæƒæœåŠ¡å™¨åº”è¯¥å­˜å‚¨è®¿é—®ä»¤ç‰Œçš„æ•£åˆ—å€¼,è€Œä¸æ˜¯ä»¤ç‰Œæ˜æ–‡ã€‚ï± æˆæƒæœåŠ¡å™¨åº”è¯¥ä¿æŒè¾ƒçŸ­çš„è®¿é—®ä»¤ç‰Œç”Ÿå‘½å‘¨æœŸ,ä»¥æœ€å°åŒ–å› å•ä¸ªä»¤ç‰Œæ³„éœ²è€Œå¯¼è‡´çš„é£é™©ã€‚ï± èµ„æºæœåŠ¡å™¨åº”è¯¥å°†è®¿é—®ä»¤ç‰Œå­˜å‚¨åœ¨ç¬æ€å†…å­˜ä¸­ã€‚ï± PKCE å¯ç”¨äºæé«˜æˆæƒç çš„å®‰å…¨æ€§ã€‚ oauth å…¶ä»–ç”Ÿæ€ç³»ç»Ÿ æºå¸¦ä¿¡æ¯çš„åŠ å¯†ä»¤ç‰Œ ä»¤ç‰Œå†…çœ","date":"2024-12-31","categories":["è½¯ä»¶å¼€å‘"],"tags":["aouth2.0"]},{"title":"uml-plantUML-æµç¨‹å›¾ç”»æ³•","url":"/2024/12/31/uml-plantUML-æµç¨‹å›¾ç”»æ³•/","content":"ä»å¤§å­¦å¼€å§‹å°±å¯¹è½¯ä»¶å·¥ç¨‹ä¸­çš„å„ç§å›¾è¡¨ç¤ºåæ„Ÿï¼Œé™¤äº†åœ¨åšæ¯•ä¸šè®¾è®¡çš„æ—¶å€™æœ‰ä¸€äº›åº”ç”¨çš„åœ°æ–¹ä¹‹å¤–ï¼Œå¹³æ—¶å¾ˆå°‘èƒ½ç”¨åˆ°ã€‚ æœ€è¿‘è€å¤§åˆ†é…ä»»åŠ¡è®©æˆ‘å»æ¢³ç†ä¸€äº›ä¸šåŠ¡çš„é€»è¾‘ï¼Œè¿™æ‰å‘ç°è½¯ä»¶å·¥ç¨‹ä¸­çš„ä¸€äº›å›¾æ˜¯éå¸¸æœ‰å¿…è¦çš„ï¼Œæ‰€ä»¥è¿™é‡Œå‡†å¤‡ç³»ç»Ÿçš„å­¦ä¹ ä¸€ä¸‹plantUMLçš„ä½¿ç”¨ plantUML æµç¨‹å›¾","date":"2024-12-31","categories":["è½¯ä»¶å¼€å‘"]},{"title":"äº›ä¸šåŠ¡ä»£ç çš„ä¸€äº›åŸåˆ™","url":"/2024/12/31/äº›ä¸šåŠ¡ä»£ç çš„ä¸€äº›åŸåˆ™/","content":"æ¥å£æ˜¯ä¸æ˜¯è¦å¹‚ç­‰ æ•°æ®åº“ update delete select ç­‰èŒƒå›´æ˜¯å¦æ­£ç¡®ï¼Œ èŒƒå›´æ˜¯å¦æ­£ç¡® å…œåº•çš„å¤„ç†æ–¹æ³•æ˜¯å¦æœ‰è¿è¡Œ - defer try catchç­‰ nilæŒ‡é’ˆå¤„ç†æ–¹æ³•æ˜¯å¦æ˜¯æ­£å¸¸çš„","date":"2024-12-31","categories":["è½¯ä»¶å¼€å‘"]},{"title":"GoFè®¾è®¡æ¨¡å¼(1)-iteratoer","url":"/2024/12/31/GoFè®¾è®¡æ¨¡å¼-1--iteratoer/","content":"GoFè®¾è®¡æ¨¡å¼-iteratoerè¿­ä»£å™¨æ¨¡å¼è¿™ä¸ªè®¾è®¡æ¨¡å¼ä¸ªäººåœ¨æ„Ÿè§‰ä¸Šæ˜¯éå¸¸å¸¸ç”¨çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œé€šè¿‡å°†æ•°æ®çš„éå†è¿‡ç¨‹å’Œä¸šåŠ¡é€»è¾‘ç»“æ„ï¼Œå¯ä»¥åœ¨éå†è¿‡ç¨‹ä¸­åˆ†è§£å‡ºä¸€äº›å…±ç”¨çš„éå†æ–¹æ³•ï¼Œæé«˜æ•ˆç‡ã€‚ åæ€ï¼šç›®å‰çš„æ„Ÿè§‰è¿­ä»£å™¨æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯å°†æ•°æ®çš„éå†å’Œå¤„ç†å’Œè°ƒç”¨è¿‡ç¨‹æ¥å¶ï¼Œå…¶åŸå› æ˜¯éå†è¿‡ç¨‹å…·æœ‰ä¸€å®šçš„é€šç”¨æ€§ï¼Œé€šè¿‡è§£è€¦å¯ä»¥æ›´åŠ æ–¹ä¾¿çš„é™ä½ä»£ç çš„é‡å¤ç‡ã€‚é‡è¦çš„æ€æƒ³è¿˜æœ‰æ•°æ®çš„æ¡¥æ¥æ–¹æ³•ï¼Œä½¿ç”¨ç»§æ‰¿æ–¹å¼è¿˜æ˜¯ä½¿ç”¨æ•°æ®å¼•ç”¨ä¼ é€’çš„æ–¹å¼ï¼Œé€šè¿‡è¿™ç§æ€æƒ³å°†ä¸šåŠ¡ç‹¬ç«‹çš„itertorå’ŒçœŸå®çš„ä¸šåŠ¡æ•°æ®bookç»„åˆèµ·æ¥ è¿­ä»£å™¨æ¨¡å¼ç±»å›¾ aggregateï¼šè¿™ä¸ªæ¥å£çš„ä½œç”¨æ˜¯ç”Ÿæˆè¿­ä»£å™¨ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°æ®çš„é›†æˆç±»éœ€è¦é›†æˆå’Œå®ç°è¿™ä¸ªæ¥å£ï¼Œä»è€Œå¯ä»¥äº§ç”Ÿè‡ªå·±çš„è¿­ä»£å™¨ iteratorï¼šè¿™ä¸ªæ¥å£å°±æ˜¯è¿­ä»£å™¨çš„æ¥å£ç±»ï¼Œå®šä¹‰äº†ä¸€ç»„è¿­ä»£å™¨é€šç”¨çš„æ–¹æ³• concreteAggregateï¼šè¿™ä¸ªä¸ºaggregateæ¥å£çš„å®ç°ç±»ï¼ˆå®é™…ä½¿ç”¨ä¸­ä¸€èˆ¬æŠŠæ•°æ®çš„é›†åˆç±»ä½œä¸ºè¿™ä¸ªç±»çš„å®ç°ï¼‰ concreteIteratorï¼šè¿™ä¸ªç±»å°±æ˜¯è¿­ä»£å™¨çš„å®ç°ç±»ï¼Œè¿™ä¸ªç±»éœ€è¦é’ˆå¯¹å…ƒç´ ç±»ï¼ˆå°±æ˜¯è¿­ä»£å‡ºæ¥çš„å…ƒç´ ï¼‰æœ‰é’ˆå¯¹æ€§çš„æ€è€ƒè¦æ€ä¹ˆè®¾è®¡ è¿­ä»£å™¨ä¾‹å­ book è¿­ä»£çš„å…ƒç´  Aggergateæ¥å£ concretaAggregate-Aggergateæ¥å£çš„å®ç°ç±» è¿™é‡Œä½¿ç”¨bookselfä½œä¸ºåˆ›å»ºè¿­ä»£å™¨çš„å®ç°ç±» iteratoræ¥å£ iteratorå®ç°ç±» ä¸»å‡½æ•° Main æ€è·¯ï¼š å…¶å®å¤§ä½“ä¸Šå’Œè¿­ä»£å™¨åŸæœ¬çš„æ€æƒ³ç›¸åŒï¼Œä½†æ˜¯åœ¨è¿™ä¸ªåœ°æ–¹ä½¿ç”¨å°†bookshefï¼ˆbookå…ƒç´ çš„å®ç°ç±»ï¼‰ä½œä¸ºaggergateçš„å®ç°ç±»ï¼Œåœ¨è°ƒç”¨çš„æ—¶å€™å°†é€šè¿‡æœ¬èº«ç”Ÿæˆè¿­ä»£å™¨ï¼Œç„¶åè¿›è¡Œè¿­ä»£åŠŸèƒ½çš„å®ç°ï¼Œæˆ‘è§‰å¾—è¿™é‡Œæ‰æ˜¯è¿­ä»£å™¨çœŸæ­£çš„éš¾ç‚¹å’Œå®ç°ç—›ç‚¹-é›†åˆå’Œè¿­ä»£å™¨çš„é€šä¿¡ã€‚ åæ€ï¼šç›®å‰çš„æ„Ÿè§‰è¿­ä»£å™¨æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯å°†æ•°æ®çš„éå†å’Œå¤„ç†å’Œè°ƒç”¨è¿‡ç¨‹æ¥å¶ï¼Œå…¶åŸå› æ˜¯éå†è¿‡ç¨‹å…·æœ‰ä¸€å®šçš„é€šç”¨æ€§ï¼Œé€šè¿‡è§£è€¦å¯ä»¥æ›´åŠ æ–¹ä¾¿çš„é™ä½ä»£ç çš„é‡å¤ç‡ã€‚é‡è¦çš„æ€æƒ³è¿˜æœ‰æ•°æ®çš„æ¡¥æ¥æ–¹æ³•ï¼Œä½¿ç”¨ç»§æ‰¿æ–¹å¼è¿˜æ˜¯ä½¿ç”¨æ•°æ®å¼•ç”¨ä¼ é€’çš„æ–¹å¼ï¼Œé€šè¿‡è¿™ç§æ€æƒ³å°†ä¸šåŠ¡ç‹¬ç«‹çš„itertorå’ŒçœŸå®çš„ä¸šåŠ¡æ•°æ®bookç»„åˆèµ·æ¥","date":"2024-12-31","categories":["è½¯ä»¶å¼€å‘"],"tags":["è®¾è®¡æ¨¡å¼"]},{"title":"GoFè®¾è®¡æ¨¡å¼(10)-strategy","url":"/2024/12/31/GoFè®¾è®¡æ¨¡å¼-10--strategy/","content":"ç­–ç•¥æ¨¡å¼è¿™ä¸ªæ¨¡å¼å’Œbridge æ¨¡å¼éå¸¸åƒï¼Œå¦‚æœè¯´åŒºåˆ«å¯èƒ½å°±æ˜¯bridgeå¼ºè°ƒçš„æ˜¯æ‰©å±•æ€§è€Œstragtegyå¼ºè°ƒä½¿ç”¨æ–¹æ³• ç­–ç•¥æ¨¡å¼ç±»å›¾ ç­–ç•¥æ¨¡å¼ä¾‹å­context ç­–ç•¥çš„ä½¿ç”¨è€… strategy å®šä¹‰çš„ç­–ç•¥æ¥å£ ç­–ç•¥æ¥å£çš„å®ç°ç±» ç­–ç•¥çš„æ•°æ®è½½ä½“ ä¸»å‡½æ•°","date":"2024-12-31","categories":["è½¯ä»¶å¼€å‘"],"tags":["è®¾è®¡æ¨¡å¼"]},{"title":"GoFè®¾è®¡æ¨¡å¼(2)-Adapter","url":"/2024/12/31/GoFè®¾è®¡æ¨¡å¼-2--Adapter/","content":"é€‚é…å™¨æ¨¡å¼è¿™ä¸ªæ¨¡å¼ä¸ªäººçš„æ„Ÿè§‰æ˜¯è§£å†³äº†ä»£ç ç‰¹æ®Šéƒ¨åˆ†å’Œé€šç”¨éƒ¨åˆ†å·®å¼‚æ€§çš„é—®é¢˜ï¼Œåœ¨å¤„ç†é€»è¾‘ä¸­æœ‰ä¸€éƒ¨åˆ†å­˜åœ¨ç›¸åŒçš„åœ°æ–¹ä½†æ˜¯æœ‰éƒ¨åˆ†åœ°æ–¹ä¸åŒçš„æ—¶å€™å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å°†ç›¸å…³çš„ä¸åŒç‚¹è¿›è¡Œè¿›ä¸€æ­¥çš„é€‚é…ä»è€Œå®ç°ä»£ç çš„å¤ç”¨ã€‚ é€‚é…å™¨æ¨¡å¼ç±»å›¾é€‚é…å™¨æ¨¡å¼åœ¨GAFä¹¦ä¸­å®šä¹‰äº†ä¸¤ç§ ä½¿ç”¨å¼•ç”¨çš„æ–¹å¼è¿›è¡Œæ„å»º ä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼è¿›è¡Œæ„å»º æ³¨æ„ï¼š ä½¿ç”¨æ¥å£å’Œä½¿ç”¨æŠ½è±¡ç±»çš„åŸå› æ˜¯å› ä¸ºjavaåªèƒ½æ”¯æŒå•ç»§æ‰¿ï¼Œå¦‚æœä¸šåŠ¡æ•°æ®å’Œé€»è¾‘æ“ä½œä¹‹é—´çš„æ•°æ®äº¤äº’ä½¿ç”¨çš„é›†æˆæ–¹æ³•è€Œä¸æ˜¯ä½¿ç”¨å¼•ç”¨çš„æ–¹å¼çš„æ—¶å€™ï¼Œå°†æœ‰å±€é™æ€§ é€‚é…å™¨æ¨¡å¼ä¾‹å­æ¥å£å’ŒæŠ½è±¡ç±» ä½¿ç”¨æ¥å£æ–¹å¼è¿›è¡Œæ„å»º ä½¿ç”¨æŠ½è±¡ç±»å®ç° å®ç°ç±» æ¥å£çš„å®ç°ç±»ï¼Œä½¿ç”¨é›†æˆè¿›è¡Œæ•°æ®æ¡¥æ¥ æŠ½è±¡ç±»çš„å®ç°ç±»ï¼Œä½¿ç”¨å¼•ç”¨è¿›è¡Œæ•°æ®æ¡¥æ¥ æ¡¥æ¥æ•°æ® mian å®ç°ç±» æ€»ç»“åæ€ï¼šé’ˆå¯¹ä¹‹å‰çš„è¿­ä»£å™¨æ¨¡å¼ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªæ¨¡å¼å¤„ç†æ–‡ç« å¼€å¤´è¯´çš„ä¸œè¥¿ï¼Œè¿˜æœ‰ä¸€ä¸ªé‡è¦çš„æ€æƒ³å°±æ˜¯ä½¿ç”¨ç»§æ‰¿è¿˜æ˜¯ä½¿ç”¨æ•°æ®å¼•ç”¨ã€‚","date":"2024-12-31","categories":["è½¯ä»¶å¼€å‘"],"tags":["è®¾è®¡æ¨¡å¼"]},{"title":"GoFè®¾è®¡æ¨¡å¼(3)-Template Method","url":"/2024/12/31/GoFè®¾è®¡æ¨¡å¼-3--Template-Method/","content":"æ¨¡æ¿æ–¹æ³•æ¨¡å¼è¿™ä¸ªè®¾è®¡æ¨¡å¼ä¸ªäººçš„æ„Ÿè§‰ï¼Œå…¶å®å®ç°äº†ä¸€ä¸ªæ ‡å‡†åŒ–çš„æµç¨‹ï¼Œå®ç°ç±»æ˜¯å®ç°æ ‡å‡†çš„ç±»ï¼Œè€Œæµç¨‹ç”±ä¸€å¼€å§‹çš„æŠ½å…ˆç±»æˆ–è€…æ¥å£å®šä¹‰äº†ï¼Œæ˜¯æ ‡å‡†çš„ç»§æ‰¿ç”¨æ³• æ¨¡æ¿æ–¹æ³•æ¨¡å¼ç±»å›¾ æ¨¡æ¿æ–¹æ³•ä¾‹å­ä½¿ç”¨æŠ½è±¡ç±»çš„æ¨¡æ¿ æŠ½è±¡ç±»çš„å®ç°ç±» char å®ç°ç±» string å®ç°ç±» main å‡½æ•°","date":"2024-12-31","categories":["è½¯ä»¶å¼€å‘"],"tags":["è®¾è®¡æ¨¡å¼"]},{"title":"GoFè®¾è®¡æ¨¡å¼(4)-Factory Method","url":"/2024/12/31/GoFè®¾è®¡æ¨¡å¼-4--Factory-Method/","content":"å·¥å‚æ–¹æ³•æ¨¡å¼è¿™ä¸ªæ¨¡å¼ä¹‹å‰çš„æ—¶å€™æ„Ÿè§‰æ¯”è¾ƒå›°éš¾ï¼Œç°åœ¨æ„Ÿè§‰è¿™ä¸ªæ¨¡å¼åŒæ ·æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œè¦æ³¨æ„ä¸€ä¸‹çš„å‡ ä¸ªæ€æƒ³ã€‚ å·¥å‚æ–¹æ³•æ¨¡å¼ä¸€å¼€å§‹çš„æ—¶å€™æ˜¯å°†å·¥å‚æ¥å£å’Œå·¥å‚ç”Ÿäº§çš„äº§å“åŒæ—¶å®šä¹‰å‡ºæ¥çš„ã€‚ å·¥å‚ç”Ÿäº§çš„ä¸œè¥¿éœ€è¦ä¼ å…¥æŒ‡å®šçš„æ•°æ®æ‰èƒ½ç”Ÿäº§å‡ºæ¥æ¯”å¦‚ä¸‹é¢ä¾‹å­ä¸­å®šä¹‰çš„IDcardç±» æ‰©å±•æ€è·¯> å…¶å®æ„Ÿè§‰è¿™ä¸ªæ¨¡å¼å…¶å®å¯ä»¥å’Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼ç»“åˆä½¿ç”¨ï¼Œåœ¨æ„å»ºäº§å“çš„è¿‡ç¨‹ä¸­ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼å¯ä»¥è¿›ä¸€æ­¥çš„è§£è€¦å’Œä¼˜åŒ–æµç¨‹ã€‚ å·¥å‚æ–¹æ³•æ¨¡å¼çš„ç±»å›¾ ä»ç±»å›¾ä¸­å¯ä»¥çœ‹å‡ºé¡¹ç›®ä¸­å·¥å‚å’Œäº§å“ä¹‹é—´çš„å…³ç³» å·¥å‚æ–¹æ³•æ¨¡å¼ä¾‹å­æ¥å£ å·¥å‚æ¥å£ äº§å“æ¥å£ æ¥å£çš„å®ç°ç±» å·¥å‚çš„å®ç°ç±» å•†å“çš„å®ç°ç±» ä¿¡æ¯è½½ä½“ è¿è¡Œä¸»å‡½æ•°","date":"2024-12-31","categories":["è½¯ä»¶å¼€å‘"],"tags":["è®¾è®¡æ¨¡å¼"]},{"title":"GoFè®¾è®¡æ¨¡å¼(5)-å•ä¾‹æ¨¡å¼","url":"/2024/12/31/GoFè®¾è®¡æ¨¡å¼-5--å•ä¾‹æ¨¡å¼/","content":"å•ä¾‹æ¨¡å¼è¿™ä¸ªæ¨¡å¼å…¶å®å¹¶ä¸éœ€è¦è¿‡å¤šçš„é˜é‡Šï¼Œé‡ç‚¹æ˜¯å¦‚ä½•æ„å»ºå¥½ä¸€ä¸ªå•ä¾‹æ¨¡å¼ï¼Œæœ€åŸºç¡€çš„ä»£ç å¦‚ä¸‹ ä»¥ä¸Šçš„æ–¹æ³•å±äºé¥¿æ±‰æ¨¡å¼ï¼šä¸€å¼€å§‹å°±ç”Ÿæˆçš„å®ä¾‹ å…¶å®å•ä¾‹æ¨¡å¼è¿˜æœ‰ä¸€ç§æ‡’åŠ è½½æ¨¡å¼-é¥¿æ±‰æ¨¡å¼ï¼Œä¸è¿‡è¿™ç§æ¨¡å¼æœ‰è®¸å¤šçš„å‘ æ‡’åŠ è½½å•ä¾‹æ¨¡å¼æœ€åŸºç¡€æ ·å¼ è¿™ç§å†™æ³•æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œæ¯”å¦‚1çº¿ç¨‹è¿è¡Œåˆ°ifè¯­å¥ä¸­2çº¿ç¨‹ä¹Ÿè¿è¡Œåˆ°ifä¸­ï¼Œä¹‹åå°†ä¼šåˆ›å»ºä¸¤ä¸ªå¯¹è±¡é€ æˆå¯¹è±¡ä¸åŒã€‚ æ·»åŠ çº¿ç¨‹å®‰å…¨çš„å•ä¾‹æ¨¡å¼ åŸºæœ¬æ€è·¯ synchronizedè§£å†³ ç¼ºç‚¹æ€§èƒ½ä½ä¸‹ synchronized 99% ä¸éœ€è¦çº¿ç¨‹åŒæ­¥ synchronizedä»£ç å—ä¼˜åŒ– æ²¡æœ‰ä½¿ç”¨å…¨å±€é”ä½†æ˜¯è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œä»£ç å—åŒæ ·éœ€è¦æ¯æ¬¡è¿è¡Œ åŒé‡é”å®¶çº¿ç¨‹å¯è§ è¿™é‡Œä½¿ç”¨ä¸¤ä¸ªif æ¥è§£å†³99%æƒ…å†µä¸‹ä¸éœ€è¦å¯¹ifè¿›è¡Œçº¿ç¨‹éš”ç¦»çš„æƒ…å†µï¼Œä½¿ç”¨volatileæ˜¯ä¸ºäº†é˜²æ­¢æŒ‡ä»¤é‡æ‹ç»­å¯¼è‡´çš„é—®é¢˜ï¼Œåˆ†æå¦‚ä¸‹ï¼š è¿™æ®µä»£ç çœ‹èµ·æ¥å¾ˆå®Œç¾ï¼Œå¾ˆå¯æƒœï¼Œå®ƒæ˜¯æœ‰é—®é¢˜ã€‚ä¸»è¦åœ¨äºinstance &#x3D; new Singleton()è¿™å¥ï¼Œè¿™å¹¶éæ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼Œäº‹å®ä¸Šåœ¨ JVM ä¸­è¿™å¥è¯å¤§æ¦‚åšäº†ä¸‹é¢ 3 ä»¶äº‹æƒ…ã€‚ ç»™ instance åˆ†é…å†…å­˜ è°ƒç”¨ Singleton çš„æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–æˆå‘˜å˜é‡ å°†instanceå¯¹è±¡æŒ‡å‘åˆ†é…çš„å†…å­˜ç©ºé—´ï¼ˆæ‰§è¡Œå®Œè¿™æ­¥ instance å°±ä¸ºé null äº†ï¼‰ ä½†æ˜¯åœ¨ JVM çš„å³æ—¶ç¼–è¯‘å™¨ä¸­å­˜åœ¨æŒ‡ä»¤é‡æ’åºçš„ä¼˜åŒ–ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸Šé¢çš„ç¬¬äºŒæ­¥å’Œç¬¬ä¸‰æ­¥çš„é¡ºåºæ˜¯ä¸èƒ½ä¿è¯çš„ï¼Œæœ€ç»ˆçš„æ‰§è¡Œé¡ºåºå¯èƒ½æ˜¯ 1-2-3 ä¹Ÿå¯èƒ½æ˜¯ 1-3-2ã€‚å¦‚æœæ˜¯åè€…ï¼Œåˆ™åœ¨ 3 æ‰§è¡Œå®Œæ¯•ã€2 æœªæ‰§è¡Œä¹‹å‰ï¼Œè¢«çº¿ç¨‹äºŒæŠ¢å äº†ï¼Œè¿™æ—¶ instance å·²ç»æ˜¯é null äº†ï¼ˆä½†å´æ²¡æœ‰åˆå§‹åŒ–ï¼‰ï¼Œæ‰€ä»¥çº¿ç¨‹äºŒä¼šç›´æ¥è¿”å› instanceï¼Œç„¶åä½¿ç”¨ï¼Œç„¶åé¡ºç†æˆç« åœ°æŠ¥é”™ã€‚ ä½¿ç”¨å†…éƒ¨é™æ€ç±» è¿™ç§å†™æ³•ä»ç„¶ä½¿ç”¨JVMæœ¬èº«æœºåˆ¶ä¿è¯äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼›ç”±äº SingletonHolder æ˜¯ç§æœ‰çš„ï¼Œé™¤äº† getInstance() ä¹‹å¤–æ²¡æœ‰åŠæ³•è®¿é—®å®ƒï¼Œå› æ­¤å®ƒæ˜¯æ‡’æ±‰å¼çš„ï¼›åŒæ—¶è¯»å–å®ä¾‹çš„æ—¶å€™ä¸ä¼šè¿›è¡ŒåŒæ­¥ï¼Œæ²¡æœ‰æ€§èƒ½ç¼ºé™·ï¼›ä¹Ÿä¸ä¾èµ– JDK ç‰ˆæœ¬ã€‚ æšä¸¾ Enumç”¨æšä¸¾å†™å•ä¾‹å®åœ¨å¤ªç®€å•äº†ï¼è¿™ä¹Ÿæ˜¯å®ƒæœ€å¤§çš„ä¼˜ç‚¹ã€‚ä¸‹é¢è¿™æ®µä»£ç å°±æ˜¯å£°æ˜æšä¸¾å®ä¾‹çš„é€šå¸¸åšæ³•ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡EasySingleton.INSTANCEæ¥è®¿é—®å®ä¾‹ï¼Œè¿™æ¯”è°ƒç”¨getInstance()æ–¹æ³•ç®€å•å¤šäº†ã€‚åˆ›å»ºæšä¸¾é»˜è®¤å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦æ‹…å¿ƒdouble checked lockingï¼Œè€Œä¸”è¿˜èƒ½é˜²æ­¢ååºåˆ—åŒ–å¯¼è‡´é‡æ–°åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚ä½†æ˜¯è¿˜æ˜¯å¾ˆå°‘çœ‹åˆ°æœ‰äººè¿™æ ·å†™ï¼Œå¯èƒ½æ˜¯å› ä¸ºä¸å¤ªç†Ÿæ‚‰å§ã€‚ æ€»ç»“ä¸€èˆ¬æ¥è¯´ï¼Œå•ä¾‹æ¨¡å¼æœ‰äº”ç§å†™æ³•ï¼šæ‡’æ±‰ã€é¥¿æ±‰ã€åŒé‡æ£€éªŒé”ã€é™æ€å†…éƒ¨ç±»ã€æšä¸¾ã€‚ä¸Šè¿°æ‰€è¯´éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„å®ç°ï¼Œæ–‡ç« å¼€å¤´ç»™å‡ºçš„ç¬¬ä¸€ç§æ–¹æ³•ä¸ç®—æ­£ç¡®çš„å†™æ³•ã€‚","date":"2024-12-31","categories":["è½¯ä»¶å¼€å‘"],"tags":["è®¾è®¡æ¨¡å¼"]},{"title":"GoFè®¾è®¡æ¨¡å¼(6)-prototype","url":"/2024/12/31/GoFè®¾è®¡æ¨¡å¼-6--prototype/","content":"åŸå‹æ¨¡å¼åŸå‹æ¨¡å¼å…¶å®æœ¬è´¨ä¸Šè§£å†³äº†å¦‚ä¸‹çš„ä¸¤ä¸ªé—®é¢˜ï¼š ç±»åç§°å’Œç±»çš„ç»‘å®šï¼Œæ— æ³•å®ç°åŠ¨æ€çš„ï¼ˆé€šè¿‡å­—ç¬¦ä¸²æˆ–è€…åç§°å¾ˆæ–¹ä¾¿çš„ï¼‰ç”Ÿæˆæƒ³è¦ç”Ÿæˆçš„ç›¸å…³ç´¯çš„å®ä¾‹ã€‚ ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£å°†ç›¸åŒç§ç±»ï¼ˆå®ç°åŒä¸€ä¸ªå€Ÿå£æˆ–è€…ç»§æ‰¿è‡ªç›¸åŒçš„ç±»çš„ç±»ï¼‰è¿›è¡Œç»Ÿä¸€çš„ç®¡ç† è‡ªæˆ‘å¼•ç”³ï¼š æ„Ÿè§‰è¿™ä¸ªæ¨¡å¼ï¼Œç›¸å½“äºå•†å“çš„ä¹°å–ï¼Œè€Œåœ†å½¢æ¨¡å¼ä¸­çš„å­—ç¬¦ä¸²å°±ç›¸å½“äºéœ€è¦é‡‘é’±ï¼ˆä¸€ç§é€šç”¨çš„å¯å…±è¯†çš„ä¸œè¥¿ï¼‰ï¼Œè€Œäº§å‡ºçš„ç±»ï¼Œå°±ç›¸å½“äºå•†å“ åŸå‹æ¨¡å¼ç±»å›¾ æ ¹æ®ä¸Šé¢æ‰€è¯´çš„æˆ‘çš„ç†è§£å¯ä»¥è¿™ä¹ˆç±»æ¯” client ç›¸å½“äºç”¨æˆ· users çš„è¿‡ç¨‹ç›¸å½“äºä»˜æ¬¾ prototypeçš„createClone ç›¸å½“äºå–è´§çš„è¿‡ç¨‹ æœ€å concretePrototypeï¼ˆprototypeï¼‰ å°±æ˜¯å•†å“ é€šè¿‡è¿™æ ·çš„åˆ†æï¼Œå…¶å®ç†è®ºä¸ŠcreateCloneå’Œprototypeåº”è¯¥æ˜¯è¦è§£è€¦çš„ä½†æ˜¯ï¼Œå› ä¸ºjavaä¸­cloneåªèƒ½è‡ªè°ƒç”¨æ‰€ä»¥é‡‡ç”¨è¿™ç§æ–¹æ³•ï¼Œå…¶å®å¯ä»¥åœ¨åˆ†è£…ä¸€å±‚è°ƒç”¨å±‚ï¼Œä¸è¿‡è¿™æ ·å°±å¢åŠ äº†å¤æ‚åº¦äº†ï¼Œè¿™é‡Œå°±ä¸å¤šè¯´äº†ã€‚ æ–¹ä¾¿ç†è§£ï¼›ä¸‹é¢æ˜¯ç¨‹åºçš„ç±»å›¾ åŸå‹æ¨¡å¼ä¾‹å­client çš„å®ç° å•†å“æ¥å£çš„å®ç° å•†å“æ¥å£çš„å®ç°ç±» ä¸»å‡½æ•°","date":"2024-12-31","categories":["è½¯ä»¶å¼€å‘"],"tags":["è®¾è®¡æ¨¡å¼"]},{"title":"GoFè®¾è®¡æ¨¡å¼(7)-Builder","url":"/2024/12/31/GoFè®¾è®¡æ¨¡å¼-7--Builder/","content":"å»ºé€ è€…æ¨¡å¼è¿™ä¸ªæ¨¡å¼åœ¨æˆ‘çš„ä¸ªäººæ„Ÿè§‰ä¸­æ„Ÿè§‰å°±åƒæ˜¯å‡çº§ç‰ˆçš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œè¿™ä¸ªæ¨¡å¼ä¸­çš„directorèµ·åˆ°äº†ç›‘æ§å’Œè°ƒç”¨å„ç§builerç±»çš„æ–¹æ³•ï¼ˆæ„Ÿè§‰ç›¸å½“äºåœ¨ï¼‰ï¼Œç„¶ååœ¨directorä¸­ç¼–å†™å¯¹åº”çš„æµç¨‹å‡½æ•°ï¼ˆconstructionï¼‰æ¥è°ƒç”¨æŒ‡å®šçš„ç›¸å…³çš„å„ç§å‡½æ•°ã€‚å’Œæ¨¡æ¿æ–¹æ³•ä¸­ä½¿ç”¨hashmapè¿›è¡Œå­—ç¬¦ä¸²åˆ°å…·ä½“clone çš„å¯¹åº”å…³ç³»ç›¸åŒï¼Œåœ¨å»ºé€ è€…æ¨¡å¼ä¸­æˆ‘ä¹Ÿä½¿ç”¨äº†HashMapè¿›è¡Œè·å–å¯¹è±¡çš„è§£è€¦ï¼Œå®ç°äº†ç»Ÿä¸€å…¥å£ å¼•ç”³: å…¶å®åœ¨directorä¸­æŒ‡å®šç›¸å…³çš„å‡½æ•°å¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ï¼Œå…¶å®å¯ä»¥å®ç°ä¸€ä¸ªæ¨¡æ¿æ¥å£ï¼Œé€šè¿‡è¿™ä¸ªæ¥å£åŠ¨æ€çš„å®ç°ç›¸å…³çš„ç­–ç•¥ï¼Œä»¥åå†æƒ³æƒ³ã€‚ å»ºé€ è€…æ¨¡å¼ç±»å›¾ å»ºé€ è€…æ¨¡å¼å®ä¾‹Director buileræ¥å£ builer å®ç°ç±» client æˆ–è€…ä¸»å‡½æ•°","date":"2024-12-31","categories":["è½¯ä»¶å¼€å‘"],"tags":["è®¾è®¡æ¨¡å¼"]},{"title":"GoFè®¾è®¡æ¨¡å¼(8)abstractFactory","url":"/2024/12/31/GoFè®¾è®¡æ¨¡å¼-8-abstractFactory/","content":"","date":"2024-12-31","categories":["è½¯ä»¶å¼€å‘"],"tags":["è®¾è®¡æ¨¡å¼"]},{"title":"GoFè®¾è®¡æ¨¡å¼(9)-Bridge","url":"/2024/12/31/GoFè®¾è®¡æ¨¡å¼-9--Bridge/","content":"æ¡¥æ¥æ¨¡å¼æ¡¥æ¥æ¨¡å¼æˆ‘çš„æ„Ÿè§‰è¿™ä¸ªæ¨¡å¼å°±æ˜¯ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼å’Œé€‚é…å™¨çš„æ¨¡å¼çš„ç»“åˆã€‚ åœ¨GoFä¹¦ä¸­ï¼Œå°†ç±»çš„æ‰©å±•åˆ†ä¸ºï¼Œç±»çš„åŠŸèƒ½å±‚æ¬¡åˆ’åˆ†å’Œç±»çš„ç»“æ„å±‚æ¬¡åˆ’åˆ† ç±»çš„åŠŸèƒ½å±‚æ¬¡åˆ’åˆ†ï¼š é€šè¿‡ç»§æ‰¿æ¥å¯¹æ·»åŠ ç›¸å…³çš„åŠŸèƒ½ï¼Œå…¶å®ä¹Ÿå°±æ˜¯å¤–éƒ¨è°ƒç”¨çš„å®é™…æ–¹æ³• ç±»çš„å®ç°å±‚æ¬¡åˆ’åˆ†ï¼šçˆ¶ç±»ï¼ˆæ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼‰ï¼Œé€šè¿‡ç»§æ‰¿å°†è¿™ä¸ªä½œä¸ºä¸€ä¸ªç‰¹æ®Šçš„å®ç°ç±»é€‚é…ä¸åŒçš„æƒ…å†µï¼Œæ¯”å¦‚è¯´ä¸€ä¸ªç±»å®šä¹‰äº†ä¸€ä¸ªæ“ä½œç³»ç»Ÿåº•å±‚çš„æ¥å£ï¼Œå…¶å­ç±»é€šè¿‡å®ç°ï¼Œæ”¯æŒäº†windownså’Œlinuxï¼Œè¿™é‡Œå°±æ˜¯ç±»çš„å®ç°å±‚æ¬¡åˆ’åˆ†ï¼Œé’ˆå¯¹ä¸åŒçš„æƒ…å†µäº‹é¡¹ä¸åŒçš„æ¥å£ã€‚ æ¡¥æ¥æ¨¡å¼æœ¬è´¨ä¸Šå°±æ˜¯å°†ç±»çš„åŠŸèƒ½å±‚æ¬¡å’Œå®ç°å±‚æ¬¡åˆ†ç¦» æ¡¥æ¥æ¨¡å¼ æ¡¥æ¥æ¨¡å¼æœ¬è´¨ä¸Šå°±æ˜¯å°†ç±»çš„åŠŸèƒ½å±‚æ¬¡å’Œå®ç°å±‚æ¬¡åˆ†ç¦» Abstractionï¼š è¿™ä¸ªç±»æä¾›çš„åŠŸèƒ½æ˜¯å¯¹å¤–çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯è¯´åŠŸèƒ½ä¸Šçš„æ‰©å±•å°±æ˜¯ä½¿ç”¨è¿™ä¸ªç±»é€šè¿‡ç»§æ‰¿æˆ–è€…å…¶ä»–çš„æ–¹æ³•å°±è¡Œæ‰©å±• Implementor ï¼š è¿™ä¸ªç±»æä¾›çš„æ˜¯åº•å±‚çš„æ“ä½œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªç±»åªèƒ½è¢«Abstractionç±»ä½¿ç”¨ã€‚ æ³¨æ„ï¼šAbstractionçš„ç›¸å…³æ–¹å‘æ˜¯ä½¿ç”¨é€‚é…å™¨æ¨¡å¼çš„æ€æƒ³è¿›è¡Œè°ƒç”¨çš„ï¼Œå…¶å®æœ¬è´¨ä¸Šæ˜¯å› ä¸ºImplementæ˜¯ä½¿ç”¨å¼•ç”¨çš„æ–¹æ³•ä¼ å…¥Abstractionç±»ä¸­çš„ï¼Œä¸è¿‡è¿™æ ·ä¹Ÿå¥½ï¼Œæ›´åŠ çš„æé«˜äº†ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ã€‚ é€‚é…å™¨æ¨¡å¼çš„ä»£ç å®ç°Abstraction åŠŸèƒ½å±‚æ¬¡çš„æ‰©å±•æ–¹æ³• Abstraction çš„ä¸¤ä¸ªå®ç°ç±»ï¼Œå®ç°ä¸åŒçš„åŠŸèƒ½ï¼ˆstartToDisplayï¼‰æ–¹æ³• Implement ç±»çš„å®ç°å±‚æ¬¡ ç±»çš„å®ç°å±‚æ¬¡çš„åŠŸèƒ½ ä¸»å‡½æ•°","date":"2024-12-31","categories":["è½¯ä»¶å¼€å‘"],"tags":["è®¾è®¡æ¨¡å¼"]},{"title":"linux ç»ˆç«¯ä½¿ç”¨ä»£ç†","url":"/2024/12/31/linux-ç»ˆç«¯ä½¿ç”¨ä»£ç†/","content":"æ ¸å¿ƒæ€æƒ³ , æ”¹å˜ç»ˆç«¯çš„ç¯å¢ƒå˜é‡ç»ˆç«¯è¾“å…¥å‘½ä»¤","date":"2024-12-31","categories":["è¿ç»´ç³»ç»Ÿ"]},{"title":"å¾®è§‚ç»æµå­¦1","url":"/2024/12/31/å¾®è§‚ç»æµå­¦1/","content":"äºšå½“å²å¯†æ–¯ , å›½å¯Œè®ºå¤§å«æå˜‰å›¾ , æ”¿æ²»ç»æµå­¦åŠèµ‹ç¨ç†è®ºé©¬æ­‡å°” , è¾¹é™…æ•ˆåº”å­¦æ´¾å’Œé©¬æ­‡å°”è¿™ç§ç†è®ºä½“ç³» ä¸­è½¬ å¼ ä¼¯ä¼¦,ç½—å®¾é€Š å„æ–­ä¸»ä¹‰ç»æµå‡¯æ©æ–¯ä¸»ä¹‰ç»æµä»·å€¼è®ºå’Œä¸€èˆ¬å‡è¡¡è®º è´§å¸æ³¨æ„å’Œç†æ€§é¢„æœŸåˆ†æ”¯å’Œæ‰©å±•(æ–°å¤å…¸ä¸»ä¹‰å’Œæ–°å‡¯æ©æ–¯ä¸»ä¹‰) å½±å“ä»·æ ¼çš„å› ç´ æœ‰ä¸€ä¸ªå¾ˆç‰¹æ®Šå°±æ˜¯æ›¿ä»£å“ä»·æ ¼ , å’Œå¥¹èƒ½è¿›è¡Œå¯¹æ¯”çš„å•†å“ä»·æ ¼","date":"2024-12-31","categories":["é€šè¯†"],"tags":["å¾®è§‚ç»æµç»æµå­¦"]},{"title":"categories","url":"/categories/index.html","content":"","date":"2026-02-18"},{"title":"about","url":"/about/index.html","content":"","date":"2025-02-22"},{"title":"tags","url":"/tags/index.html","content":"","date":"2026-02-18"}]